"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2305:(K,Y,l)=>{l.d(Y,{e:()=>M});var v=l(646),U=l(652),d=l(469),A=l(675),c=l(526),t=l(623),Z=(l(534),l(2271));class m{get wrapU(){return this._wrapU}set wrapU(K){this._wrapU=K}get wrapV(){return this._wrapV}set wrapV(K){this._wrapV=K}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(K){this._texture&&(this._texture.isCube=K)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(K){this._texture&&(this._texture.is3D=K)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(K){this._texture&&(this._texture.is2DArray=K)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(K){return void 0!==(null===K||void 0===K?void 0:K.shareDepth)}constructor(K){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=Z.d.Zero(),this._cachedBaseSize=Z.d.Zero(),this._initialSamplingMode=2,this._texture=m._IsRenderTargetWrapper(K)?K.texture:K,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(K){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(K,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var V=l(702);class M extends m{set Cj(K){this._hasAlpha!==K&&(this._hasAlpha=K,this._scene&&this._scene.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))))}get Cj(){return this._hasAlpha}set getAlphaFromRGB(K){this._getAlphaFromRGB!==K&&(this._getAlphaFromRGB=K,this._scene&&this._scene.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(K){this._coordinatesIndex!==K&&(this._coordinatesIndex=K,this._scene&&this._scene.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(K){this._coordinatesMode!==K&&(this._coordinatesMode=K,this._scene&&this._scene.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(K){this._wrapU=K}get wrapV(){return this._wrapV}set wrapV(K){this._wrapV=K}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(K){this._texture?this._texture.isCube=K:this._isCube=K}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(K){this._texture&&(this._texture.is3D=K)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(K){this._texture&&(this._texture.is2DArray=K)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(K){var Y;if(this._texture){if(this._texture._gammaSpace===K)return;this._texture._gammaSpace=K}else{if(this._gammaSpace===K)return;this._gammaSpace=K}null===(Y=this.va())||void 0===Y||Y.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(K){var Y;K!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=K),null===(Y=this.va())||void 0===Y||Y.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(K){this._texture&&(this._texture._lodGenerationOffset=K)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(K){this._texture&&(this._texture._lodGenerationScale=K)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(K){this._texture&&(this._texture._linearSpecularLOD=K)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(K){this._texture&&(this._texture._irradianceTexture=K)}get uid(){return this._uid||(this._uid=(0,t.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(K){this._onDisposeObserver&&this.Hi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Hi.add(K)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(K){let Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=M.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Hi=new d.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,K?M._IsScene(K)?this._scene=K:this._engine=K:this._scene=c.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=Y,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return A.d.IdentityReadOnly}getReflectionTextureMatrix(){return A.d.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(K){}get canRescale(){return!1}_getFromCache(K,Y,l,v,U,d){const A=this._getEngine();if(!A)return null;const c=A._getUseSRGBBuffer(!!U,Y),t=A.getLoadedTexturesCache();for(let Z=0;Z<t.length;Z++){const A=t[Z];if((void 0===U||c===A._useSRGBBuffer)&&(void 0===v||v===A.invertY)&&A.url===K&&A.generateMipMaps===!Y&&(!l||l===A.samplingMode)&&(void 0===d||d===A.isCube))return A.incrementReferences(),A}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const K=this.va();K&&K.markAllMaterialsAsDirty(1)}readPixels(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,v=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],U=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const Z=this._getEngine();if(!Z)return null;const m=this.getSize();let V=m.width,M=m.height;0!==Y&&(V/=Math.pow(2,Y),M/=Math.pow(2,Y),V=Math.round(V),M=Math.round(M)),c=Math.min(V,c),t=Math.min(M,t);try{return this._texture.isCube?Z._readTexturePixels(this._texture,c,t,K,Y,l,v,U,d,A):Z._readTexturePixels(this._texture,c,t,-1,Y,l,v,U,d,A)}catch(u){return null}}_readPixelsSync(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,v=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],U=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const d=this.getSize();let A=d.width,c=d.height;const t=this._getEngine();if(!t)return null;0!=Y&&(A/=Math.pow(2,Y),c/=Math.pow(2,Y),A=Math.round(A),c=Math.round(c));try{return this._texture.isCube?t._readTexturePixelsSync(this._texture,A,c,K,Y,l,v,U):t._readTexturePixelsSync(this._texture,A,c,-1,Y,l,v,U)}catch(Z){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const K=this._scene.textures.indexOf(this);if(K>=0&&this._scene.textures.splice(K,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const K=this._parentContainer.textures.indexOf(this);K>-1&&this._parentContainer.textures.splice(K,1),this._parentContainer=null}}this.Hi.notifyObservers(this),this.Hi.clear(),this.metadata=null,super.dispose()}serialize(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!K)return null;const Y=V.c.Serialize(this);return V.c.AppendSerializedAnimations(this,Y),Y}static WhenAllReady(K,Y){let l=K.length;if(0!==l)for(let v=0;v<K.length;v++){const U=K[v];if(U.isReady())0===--l&&Y();else{const K=U.onLoadObservable;K?K.addOnce((()=>{0===--l&&Y()})):0===--l&&Y()}}else Y()}static _IsScene(K){return"Scene"===K.getClassName()}}M.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,v.d)([(0,U.J)()],M.prototype,"uniqueId",void 0),(0,v.d)([(0,U.J)()],M.prototype,"name",void 0),(0,v.d)([(0,U.J)()],M.prototype,"metadata",void 0),(0,v.d)([(0,U.J)("Cj")],M.prototype,"_hasAlpha",void 0),(0,v.d)([(0,U.J)("getAlphaFromRGB")],M.prototype,"_getAlphaFromRGB",void 0),(0,v.d)([(0,U.J)()],M.prototype,"level",void 0),(0,v.d)([(0,U.J)("coordinatesIndex")],M.prototype,"_coordinatesIndex",void 0),(0,v.d)([(0,U.J)()],M.prototype,"optimizeUVAllocation",void 0),(0,v.d)([(0,U.J)("coordinatesMode")],M.prototype,"_coordinatesMode",void 0),(0,v.d)([(0,U.J)()],M.prototype,"wrapU",null),(0,v.d)([(0,U.J)()],M.prototype,"wrapV",null),(0,v.d)([(0,U.J)()],M.prototype,"wrapR",void 0),(0,v.d)([(0,U.J)()],M.prototype,"anisotropicFilteringLevel",void 0),(0,v.d)([(0,U.J)()],M.prototype,"isCube",null),(0,v.d)([(0,U.J)()],M.prototype,"is3D",null),(0,v.d)([(0,U.J)()],M.prototype,"is2DArray",null),(0,v.d)([(0,U.J)()],M.prototype,"gammaSpace",null),(0,v.d)([(0,U.J)()],M.prototype,"invertZ",void 0),(0,v.d)([(0,U.J)()],M.prototype,"lodLevelInAlpha",void 0),(0,v.d)([(0,U.J)()],M.prototype,"lodGenerationOffset",null),(0,v.d)([(0,U.J)()],M.prototype,"lodGenerationScale",null),(0,v.d)([(0,U.J)()],M.prototype,"linearSpecularLOD",null),(0,v.d)([(0,U.C)()],M.prototype,"irradianceTexture",null),(0,v.d)([(0,U.J)()],M.prototype,"isRenderTarget",void 0)},2299:(K,Y,l)=>{l.d(Y,{c:()=>R});var v=l(646),U=l(652),d=l(469),A=l(675),c=l(2305),t=l(619),Z=l(515),m=l(562),V=l(612),M=l(725),u=l(541);function o(K,Y){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const v=Y.width,U=Y.height;if(K instanceof Float32Array){let Y=K.byteLength/K.BYTES_PER_ELEMENT;const l=new Uint8Array(Y);for(;--Y>=0;){let v=K[Y];v<0?v=0:v>1&&(v=1),l[Y]=255*v}K=l}const d=document.createElement("canvas");d.width=v,d.height=U;const A=d.getContext("2d");if(!A)return null;const c=A.createImageData(v,U);if(c.data.set(K),A.putImageData(c,0,0),l){const K=document.createElement("canvas");K.width=v,K.height=U;const Y=K.getContext("2d");return Y?(Y.translate(0,U),Y.scale(1,-1),Y.drawImage(d,0,0),K.toDataURL("image/png")):null}return d.toDataURL("image/png")}function W(K){let Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const v=K.getInternalTexture();if(!v)return null;const U=K._readPixelsSync(Y,l);return U?o(U,K.getSize(),v.invertY):null}async function g(K){let Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const v=K.getInternalTexture();if(!v)return null;const U=await K.readPixels(Y,l);return U?o(U,K.getSize(),v.invertY):null}var J=l(800),n=l(702);class R extends c.e{static _CreateVideoTexture(K,Y,l){arguments.length>5&&void 0!==arguments[5]||R.TRILINEAR_SAMPLINGMODE;throw(0,Z.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(K){this._isBlocking=K}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(K,Y,l,v){let U,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:R.TRILINEAR_SAMPLINGMODE,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,t=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,Z=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,V=arguments.length>8&&void 0!==arguments[8]&&arguments[8],M=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,o=arguments.length>11?arguments[11]:void 0,W=arguments.length>12?arguments[12]:void 0,g=arguments.length>13?arguments[13]:void 0;super(Y),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new d.b,this._isBlocking=!0,this.name=K||"",this.url=K;let n=!1,H=null,z=!0;"object"===typeof l&&null!==l?(U=l.noMipmap??!1,v=l.invertY??!J.d,A=l.samplingMode??R.TRILINEAR_SAMPLINGMODE,c=l.X??null,t=l.onError??null,Z=l.buffer??null,V=l.deleteBuffer??!1,M=l.format,u=l.mimeType,o=l.loaderOptions,W=l.creationFlags,n=l.useSRGBBuffer??!1,H=l.internalTexture??null,z=l.gammaSpace??z):U=!!l,this._gammaSpace=z,this._noMipmap=U,this._invertY=void 0===v?!J.d:v,this._initialSamplingMode=A,this._buffer=Z,this._deleteBuffer=V,this._mimeType=u,this._loaderOptions=o,this._creationFlags=W,this._useSRGBBuffer=n,this._forcedExtension=g,M&&(this._format=M);const r=this.va(),E=this._getEngine();if(!E)return;E.onBeforeTextureInitObservable.notifyObservers(this);const y=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),c&&c(),!this.isBlocking&&r&&r.resetCachedMaterial()},T=(K,Y)=>{this._loadingError=!0,this._errorObject={message:K,exception:Y},t&&t(K,Y),R.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!H)return this._delayedOnLoad=y,void(this._delayedOnError=T);if(this._texture=H??this._getFromCache(this.url,U,A,this._invertY,n,this.isCube),this._texture)if(this._texture.isReady)m.c.SetImmediate((()=>y()));else{const K=this._texture.onLoadedObservable.add(y);this._texture.onErrorObservable.add((Y=>{var l;T(Y.message,Y.exception),null===(l=this._texture)||void 0===l||l.onLoadedObservable.remove(K)}))}else if(r&&r.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=y,this._delayedOnError=T;else{try{this._texture=E.createTexture(this.url,U,this._invertY,r,A,y,T,this._buffer,void 0,this._format,this._forcedExtension,u,o,W,n)}catch(e){throw T("error loading",e),e}V&&(this._buffer=null)}}updateURL(K){let Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(K=>K.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=K),this.url=K,this._buffer=Y,this._forcedExtension=v,this.delayLoadState=4,l&&(this._delayedOnLoad=l),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const K=this.va();K&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?m.c.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=K.getEngine().createTexture(this.url,this._noMipmap,this._invertY,K,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(K,Y,l,v){K*=this._cachedUScale,Y*=this._cachedVScale,K-=this.uRotationCenter*this._cachedUScale,Y-=this.vRotationCenter*this._cachedVScale,l-=this.wRotationCenter,A.o.TransformCoordinatesFromFloatsToRef(K,Y,l,this._rowGenerationMatrix,v),v.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,v.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,v.z+=this.wRotationCenter}getTextureMatrix(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*K===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*K,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=A.d.Zero(),this._rowGenerationMatrix=new A.d,this._t0=A.o.Zero(),this._t1=A.o.Zero(),this._t2=A.o.Zero()),A.d.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(A.d.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,A.j.Matrix[0]),A.d.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,A.j.Matrix[1]),A.d.ScalingToRef(this._cachedUScale,this._cachedVScale,0,A.j.Matrix[2]),A.d.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,A.j.Matrix[3]),A.j.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.j.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.j.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.j.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Pi(this._t0),this._t2.Pi(this._t0),A.d.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const Y=this.va();if(!Y)return this._cachedTextureMatrix;const l=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&l!==this._cachedIdentity3x2&&Y.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const K=this.va();if(!K)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==R.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===K.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=A.d.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=A.d.Zero());const Y=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case R.PLANAR_MODE:A.d.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case R.PROJECTION_MODE:{A.d.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const Y=K.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=Y.updateFlag,Y.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:A.d.IdentityToRef(this._cachedReflectionTextureMatrix)}return Y&&K.markAllMaterialsAsDirty(1,(K=>K.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const K={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return n.c.Clone((()=>new R(this._texture?this._texture.url:null,this.va(),K)),this)}serialize(){var K;const Y=this.name;R.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const l=super.serialize(R._SerializeInternalTextureUniqueId);if(!l)return null;var v;((R.SerializeBuffers||R.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(l.base64String=this._buffer,l.name=l.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?l.base64String="data:image/png;base64,"+(0,u.l)(this._buffer):(R.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(l.base64String=!this._engine||this._engine._features.supportSyncTextureRead?W(this):g(this))),l.invertY=this._invertY,l.samplingMode=this.samplingMode,l._creationFlags=this._creationFlags,l._useSRGBBuffer=this._useSRGBBuffer,R._SerializeInternalTextureUniqueId)&&(l.internalTextureUniqueId=null===(v=this._texture)||void 0===v?void 0:v.uniqueId);return l.internalTextureLabel=null===(K=this._texture)||void 0===K?void 0:K.label,l.noMipmap=this._noMipmap,this.name=Y,l}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(K,Y,l){if(K.customType){const v=V.d.Instantiate(K.customType).Parse(K,Y,l);return K.samplingMode&&v.updateSamplingMode&&v._samplingMode&&v._samplingMode!==K.samplingMode&&v.updateSamplingMode(K.samplingMode),v}if(K.isCube&&!K.isRenderTarget)return R._CubeTextureParser(K,Y,l);const v=void 0!==K.internalTextureUniqueId;if(!K.name&&!K.isRenderTarget&&!v)return null;let U;if(v){const l=Y.getEngine().getLoadedTexturesCache();for(const Y of l)if(Y.uniqueId===K.internalTextureUniqueId){U=Y;break}}const d=Y=>{if(Y&&Y._texture&&(Y._texture._cachedWrapU=null,Y._texture._cachedWrapV=null,Y._texture._cachedWrapR=null),K.samplingMode){const l=K.samplingMode;Y&&Y.samplingMode!==l&&Y.updateSamplingMode(l)}if(Y&&K.animations)for(let l=0;l<K.animations.length;l++){const v=K.animations[l],U=(0,t.c)("BABYLON.Animation");U&&Y.animations.push(U.Parse(v))}Y&&Y._texture&&(v&&!U&&Y._texture._setUniqueId(K.internalTextureUniqueId),Y._texture.label=K.internalTextureLabel)};return n.c.Parse((()=>{let v=!0;if(K.noMipmap&&(v=!1),K.mirrorPlane){const l=R._CreateMirror(K.name,K.renderTargetSize,Y,v);return l._waitingRenderList=K.renderList,l.mirrorPlane=M.d.yi(K.mirrorPlane),d(l),l}if(K.isRenderTarget){let l=null;if(K.isCube){if(Y.reflectionProbes)for(let v=0;v<Y.reflectionProbes.length;v++){const l=Y.reflectionProbes[v];if(l.name===K.name)return l.cubeTexture}}else l=R._CreateRenderTargetTexture(K.name,K.renderTargetSize,Y,v,K._creationFlags??0),l._waitingRenderList=K.renderList;return d(l),l}if(K.isVideo){const U=R._CreateVideoTexture(l+(K.url||K.name),l+(K.src||K.url),Y,v,K.invertY,K.samplingMode,K.settings||{});return d(U),U}{let A;if(K.base64String&&!U)A=R.CreateFromBase64String(K.base64String,K.base64String,Y,!v,K.invertY,K.samplingMode,(()=>{d(A)}),K._creationFlags??0,K._useSRGBBuffer??!1),A.name=K.name;else{let c;c=K.name&&(K.name.indexOf("://")>0||K.name.startsWith("data:"))?K.name:l+K.name,K.url&&(K.url.startsWith("data:")||R.UseSerializedUrlIfAny)&&(c=K.url);const t={noMipmap:!v,invertY:K.invertY,samplingMode:K.samplingMode,X:()=>{d(A)},internalTexture:U};A=new R(c,Y,t)}return A}}),K,Y)}static CreateFromBase64String(K,Y,l,v,U){let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:R.TRILINEAR_SAMPLINGMODE;return new R("data:"+Y,l,v,U,d,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,K,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(K,Y,l){let v=arguments.length>3&&void 0!==arguments[3]&&arguments[3],U=arguments.length>4?arguments[4]:void 0,d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:R.TRILINEAR_SAMPLINGMODE,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,Z=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,m=arguments.length>10?arguments[10]:void 0,V=arguments.length>11?arguments[11]:void 0;return"data:"!==K.substring(0,5)&&(K="data:"+K),new R(K,l,U,d,A,c,t,Y,v,Z,void 0,void 0,m,V)}}R.SerializeBuffers=!0,R.ForceSerializeBuffers=!1,R.OnTextureLoadErrorObservable=new d.b,R._SerializeInternalTextureUniqueId=!1,R._CubeTextureParser=(K,Y,l)=>{throw(0,Z.e)("CubeTexture")},R._CreateMirror=(K,Y,l,v)=>{throw(0,Z.e)("MirrorTexture")},R._CreateRenderTargetTexture=(K,Y,l,v,U)=>{throw(0,Z.e)("RenderTargetTexture")},R.NEAREST_SAMPLINGMODE=1,R.NEAREST_NEAREST_MIPLINEAR=8,R.BILINEAR_SAMPLINGMODE=2,R.LINEAR_LINEAR_MIPNEAREST=11,R.TRILINEAR_SAMPLINGMODE=3,R.LINEAR_LINEAR_MIPLINEAR=3,R.NEAREST_NEAREST_MIPNEAREST=4,R.NEAREST_LINEAR_MIPNEAREST=5,R.NEAREST_LINEAR_MIPLINEAR=6,R.NEAREST_LINEAR=7,R.NEAREST_NEAREST=1,R.LINEAR_NEAREST_MIPNEAREST=9,R.LINEAR_NEAREST_MIPLINEAR=10,R.LINEAR_LINEAR=2,R.LINEAR_NEAREST=12,R.EXPLICIT_MODE=0,R.SPHERICAL_MODE=1,R.PLANAR_MODE=2,R.CUBIC_MODE=3,R.PROJECTION_MODE=4,R.SKYBOX_MODE=5,R.INVCUBIC_MODE=6,R.EQUIRECTANGULAR_MODE=7,R.FIXED_EQUIRECTANGULAR_MODE=8,R.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,R.CLAMP_ADDRESSMODE=0,R.WRAP_ADDRESSMODE=1,R.MIRROR_ADDRESSMODE=2,R.UseSerializedUrlIfAny=!1,(0,v.d)([(0,U.J)()],R.prototype,"url",void 0),(0,v.d)([(0,U.J)()],R.prototype,"uOffset",void 0),(0,v.d)([(0,U.J)()],R.prototype,"vOffset",void 0),(0,v.d)([(0,U.J)()],R.prototype,"uScale",void 0),(0,v.d)([(0,U.J)()],R.prototype,"vScale",void 0),(0,v.d)([(0,U.J)()],R.prototype,"uAng",void 0),(0,v.d)([(0,U.J)()],R.prototype,"vAng",void 0),(0,v.d)([(0,U.J)()],R.prototype,"wAng",void 0),(0,v.d)([(0,U.J)()],R.prototype,"uRotationCenter",void 0),(0,v.d)([(0,U.J)()],R.prototype,"vRotationCenter",void 0),(0,v.d)([(0,U.J)()],R.prototype,"wRotationCenter",void 0),(0,v.d)([(0,U.J)()],R.prototype,"homogeneousRotationInUVTransform",void 0),(0,v.d)([(0,U.J)()],R.prototype,"isBlocking",null),(0,t.f)("BABYLON.Texture",R),n.c._TextureParser=R.Parse},2271:(K,Y,l)=>{l.d(Y,{d:()=>v});class v{constructor(K,Y){this.width=K,this.height=Y}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let K=0|this.width;return K=397*K^this.height,K}p(K){this.width=K.width,this.height=K.height}mi(K,Y){return this.width=K,this.height=Y,this}set(K,Y){return this.mi(K,Y)}multiplyByFloats(K,Y){return new v(this.width*K,this.height*Y)}clone(){return new v(this.width,this.height)}equals(K){return!!K&&(this.width===K.width&&this.height===K.height)}get surface(){return this.width*this.height}static Zero(){return new v(0,0)}add(K){return new v(this.width+K.width,this.height+K.height)}Lg(K){return new v(this.width-K.width,this.height-K.height)}scale(K){return new v(this.width*K,this.height*K)}static Lerp(K,Y,l){const U=K.width+(Y.width-K.width)*l,d=K.height+(Y.height-K.height)*l;return new v(U,d)}}}}]);