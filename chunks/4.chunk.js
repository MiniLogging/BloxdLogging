"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2323:(a,x,Q)=>{Q.d(x,{c:()=>e});var s=Q(652),h=Q(658),D=Q(493),N=Q(679),C=Q(529),R=Q(621),U=(Q(534),Q(2290));class W{get wrapU(){return this._wrapU}set wrapU(a){this._wrapU=a}get wrapV(){return this._wrapV}set wrapV(a){this._wrapV=a}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(a){this._texture&&(this._texture.isCube=a)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(a){this._texture&&(this._texture.is3D=a)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(a){this._texture&&(this._texture.is2DArray=a)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(a){return void 0!==(null===a||void 0===a?void 0:a.shareDepth)}constructor(a){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=U.c.Zero(),this._cachedBaseSize=U.c.Zero(),this._initialSamplingMode=2,this._texture=W._IsRenderTargetWrapper(a)?a.texture:a,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(a){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(a,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var v=Q(714);class e extends W{set Aj(a){this._hasAlpha!==a&&(this._hasAlpha=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))))}get Aj(){return this._hasAlpha}set getAlphaFromRGB(a){this._getAlphaFromRGB!==a&&(this._getAlphaFromRGB=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(a){this._coordinatesIndex!==a&&(this._coordinatesIndex=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(a){this._coordinatesMode!==a&&(this._coordinatesMode=a,this._scene&&this._scene.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(a){this._wrapU=a}get wrapV(){return this._wrapV}set wrapV(a){this._wrapV=a}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(a){this._texture?this._texture.isCube=a:this._isCube=a}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(a){this._texture&&(this._texture.is3D=a)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(a){this._texture&&(this._texture.is2DArray=a)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(a){var x;if(this._texture){if(this._texture._gammaSpace===a)return;this._texture._gammaSpace=a}else{if(this._gammaSpace===a)return;this._gammaSpace=a}null===(x=this.va())||void 0===x||x.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(a){var x;a!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=a),null===(x=this.va())||void 0===x||x.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(a){this._texture&&(this._texture._lodGenerationOffset=a)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(a){this._texture&&(this._texture._lodGenerationScale=a)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(a){this._texture&&(this._texture._linearSpecularLOD=a)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(a){this._texture&&(this._texture._irradianceTexture=a)}get uid(){return this._uid||(this._uid=(0,R.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(a){this._onDisposeObserver&&this.Fi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Fi.add(a)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(a){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Fi=new D.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,a?e._IsScene(a)?this._scene=a:this._engine=a:this._scene=C.d.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=x,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return N.e.IdentityReadOnly}getReflectionTextureMatrix(){return N.e.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(a){}get canRescale(){return!1}_getFromCache(a,x,Q,s,h,D){const N=this._getEngine();if(!N)return null;const C=N._getUseSRGBBuffer(!!h,x),R=N.getLoadedTexturesCache();for(let U=0;U<R.length;U++){const N=R[U];if((void 0===h||C===N._useSRGBBuffer)&&(void 0===s||s===N.invertY)&&N.url===a&&N.generateMipMaps===!x&&(!Q||Q===N.samplingMode)&&(void 0===D||D===N.isCube))return N.incrementReferences(),N}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const a=this.va();a&&a.markAllMaterialsAsDirty(1)}readPixels(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4],D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,N=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,R=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const U=this._getEngine();if(!U)return null;const W=this.getSize();let v=W.width,e=W.height;0!==x&&(v/=Math.pow(2,x),e/=Math.pow(2,x),v=Math.round(v),e=Math.round(e)),C=Math.min(v,C),R=Math.min(e,R);try{return this._texture.isCube?U._readTexturePixels(this._texture,C,R,a,x,Q,s,h,D,N):U._readTexturePixels(this._texture,C,R,-1,x,Q,s,h,D,N)}catch(p){return null}}_readPixelsSync(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const D=this.getSize();let N=D.width,C=D.height;const R=this._getEngine();if(!R)return null;0!=x&&(N/=Math.pow(2,x),C/=Math.pow(2,x),N=Math.round(N),C=Math.round(C));try{return this._texture.isCube?R._readTexturePixelsSync(this._texture,N,C,a,x,Q,s,h):R._readTexturePixelsSync(this._texture,N,C,-1,x,Q,s,h)}catch(U){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const a=this._scene.textures.indexOf(this);if(a>=0&&this._scene.textures.splice(a,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const a=this._parentContainer.textures.indexOf(this);a>-1&&this._parentContainer.textures.splice(a,1),this._parentContainer=null}}this.Fi.notifyObservers(this),this.Fi.clear(),this.metadata=null,super.dispose()}serialize(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!a)return null;const x=v.e.Serialize(this);return v.e.AppendSerializedAnimations(this,x),x}static WhenAllReady(a,x){let Q=a.length;if(0!==Q)for(let s=0;s<a.length;s++){const h=a[s];if(h.isReady())0===--Q&&x();else{const a=h.onLoadObservable;a?a.addOnce((()=>{0===--Q&&x()})):0===--Q&&x()}}else x()}static _IsScene(a){return"Scene"===a.getClassName()}}e.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,s.c)([(0,h.I)()],e.prototype,"uniqueId",void 0),(0,s.c)([(0,h.I)()],e.prototype,"name",void 0),(0,s.c)([(0,h.I)()],e.prototype,"metadata",void 0),(0,s.c)([(0,h.I)("Aj")],e.prototype,"_hasAlpha",void 0),(0,s.c)([(0,h.I)("getAlphaFromRGB")],e.prototype,"_getAlphaFromRGB",void 0),(0,s.c)([(0,h.I)()],e.prototype,"level",void 0),(0,s.c)([(0,h.I)("coordinatesIndex")],e.prototype,"_coordinatesIndex",void 0),(0,s.c)([(0,h.I)()],e.prototype,"optimizeUVAllocation",void 0),(0,s.c)([(0,h.I)("coordinatesMode")],e.prototype,"_coordinatesMode",void 0),(0,s.c)([(0,h.I)()],e.prototype,"wrapU",null),(0,s.c)([(0,h.I)()],e.prototype,"wrapV",null),(0,s.c)([(0,h.I)()],e.prototype,"wrapR",void 0),(0,s.c)([(0,h.I)()],e.prototype,"anisotropicFilteringLevel",void 0),(0,s.c)([(0,h.I)()],e.prototype,"isCube",null),(0,s.c)([(0,h.I)()],e.prototype,"is3D",null),(0,s.c)([(0,h.I)()],e.prototype,"is2DArray",null),(0,s.c)([(0,h.I)()],e.prototype,"gammaSpace",null),(0,s.c)([(0,h.I)()],e.prototype,"invertZ",void 0),(0,s.c)([(0,h.I)()],e.prototype,"lodLevelInAlpha",void 0),(0,s.c)([(0,h.I)()],e.prototype,"lodGenerationOffset",null),(0,s.c)([(0,h.I)()],e.prototype,"lodGenerationScale",null),(0,s.c)([(0,h.I)()],e.prototype,"linearSpecularLOD",null),(0,s.c)([(0,h.D)()],e.prototype,"irradianceTexture",null),(0,s.c)([(0,h.I)()],e.prototype,"isRenderTarget",void 0)},2315:(a,x,Q)=>{Q.d(x,{e:()=>y});var s=Q(652),h=Q(658),D=Q(493),N=Q(679),C=Q(2323),R=Q(619),U=Q(519),W=Q(566),v=Q(616),e=Q(742),p=Q(548);function j(a,x){let Q=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=x.width,h=x.height;if(a instanceof Float32Array){let x=a.byteLength/a.BYTES_PER_ELEMENT;const Q=new Uint8Array(x);for(;--x>=0;){let s=a[x];s<0?s=0:s>1&&(s=1),Q[x]=255*s}a=Q}const D=document.createElement("canvas");D.width=s,D.height=h;const N=D.getContext("2d");if(!N)return null;const C=N.createImageData(s,h);if(C.data.set(a),N.putImageData(C,0,0),Q){const a=document.createElement("canvas");a.width=s,a.height=h;const x=a.getContext("2d");return x?(x.translate(0,h),x.scale(1,-1),x.drawImage(D,0,0),a.toDataURL("image/png")):null}return D.toDataURL("image/png")}function H(a){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=a.getInternalTexture();if(!s)return null;const h=a._readPixelsSync(x,Q);return h?j(h,a.getSize(),s.invertY):null}async function d(a){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=a.getInternalTexture();if(!s)return null;const h=await a.readPixels(x,Q);return h?j(h,a.getSize(),s.invertY):null}var i=Q(803),Z=Q(714);class y extends C.c{static _CreateVideoTexture(a,x,Q){arguments.length>5&&void 0!==arguments[5]||y.TRILINEAR_SAMPLINGMODE;throw(0,U.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(a){this._isBlocking=a}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(a,x,Q,s){let h,N=arguments.length>4&&void 0!==arguments[4]?arguments[4]:y.TRILINEAR_SAMPLINGMODE,C=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,R=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,U=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,v=arguments.length>8&&void 0!==arguments[8]&&arguments[8],e=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0,H=arguments.length>12?arguments[12]:void 0,d=arguments.length>13?arguments[13]:void 0;super(x),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new D.e,this._isBlocking=!0,this.name=a||"",this.url=a;let Z=!1,k=null,F=!0;"object"===typeof Q&&null!==Q?(h=Q.noMipmap??!1,s=Q.invertY??!i.d,N=Q.samplingMode??y.TRILINEAR_SAMPLINGMODE,C=Q.X??null,R=Q.onError??null,U=Q.buffer??null,v=Q.deleteBuffer??!1,e=Q.format,p=Q.mimeType,j=Q.loaderOptions,H=Q.creationFlags,Z=Q.useSRGBBuffer??!1,k=Q.internalTexture??null,F=Q.gammaSpace??F):h=!!Q,this._gammaSpace=F,this._noMipmap=h,this._invertY=void 0===s?!i.d:s,this._initialSamplingMode=N,this._buffer=U,this._deleteBuffer=v,this._mimeType=p,this._loaderOptions=j,this._creationFlags=H,this._useSRGBBuffer=Z,this._forcedExtension=d,e&&(this._format=e);const g=this.va(),l=this._getEngine();if(!l)return;l.onBeforeTextureInitObservable.notifyObservers(this);const r=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),C&&C(),!this.isBlocking&&g&&g.resetCachedMaterial()},J=(a,x)=>{this._loadingError=!0,this._errorObject={message:a,exception:x},R&&R(a,x),y.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!k)return this._delayedOnLoad=r,void(this._delayedOnError=J);if(this._texture=k??this._getFromCache(this.url,h,N,this._invertY,Z,this.isCube),this._texture)if(this._texture.isReady)W.e.SetImmediate((()=>r()));else{const a=this._texture.onLoadedObservable.add(r);this._texture.onErrorObservable.add((x=>{var Q;J(x.message,x.exception),null===(Q=this._texture)||void 0===Q||Q.onLoadedObservable.remove(a)}))}else if(g&&g.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=r,this._delayedOnError=J;else{try{this._texture=l.createTexture(this.url,h,this._invertY,g,N,r,J,this._buffer,void 0,this._format,this._forcedExtension,p,j,H,Z)}catch(K){throw J("error loading",K),K}v&&(this._buffer=null)}}updateURL(a){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,Q=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(a=>a.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=a),this.url=a,this._buffer=x,this._forcedExtension=s,this.delayLoadState=4,Q&&(this._delayedOnLoad=Q),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const a=this.va();a&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?W.e.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=a.getEngine().createTexture(this.url,this._noMipmap,this._invertY,a,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(a,x,Q,s){a*=this._cachedUScale,x*=this._cachedVScale,a-=this.uRotationCenter*this._cachedUScale,x-=this.vRotationCenter*this._cachedVScale,Q-=this.wRotationCenter,N.o.TransformCoordinatesFromFloatsToRef(a,x,Q,this._rowGenerationMatrix,s),s.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,s.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,s.z+=this.wRotationCenter}getTextureMatrix(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*a===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*a,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=N.e.Zero(),this._rowGenerationMatrix=new N.e,this._t0=N.o.Zero(),this._t1=N.o.Zero(),this._t2=N.o.Zero()),N.e.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(N.e.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,N.k.Matrix[0]),N.e.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,N.k.Matrix[1]),N.e.ScalingToRef(this._cachedUScale,this._cachedVScale,0,N.k.Matrix[2]),N.e.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,N.k.Matrix[3]),N.k.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(N.k.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(N.k.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(N.k.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Ni(this._t0),this._t2.Ni(this._t0),N.e.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const x=this.va();if(!x)return this._cachedTextureMatrix;const Q=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&Q!==this._cachedIdentity3x2&&x.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const a=this.va();if(!a)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==y.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===a.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=N.e.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=N.e.Zero());const x=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case y.PLANAR_MODE:N.e.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case y.PROJECTION_MODE:{N.e.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const x=a.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=x.updateFlag,x.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:N.e.IdentityToRef(this._cachedReflectionTextureMatrix)}return x&&a.markAllMaterialsAsDirty(1,(a=>a.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const a={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return Z.e.Clone((()=>new y(this._texture?this._texture.url:null,this.va(),a)),this)}serialize(){var a;const x=this.name;y.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const Q=super.serialize(y._SerializeInternalTextureUniqueId);if(!Q)return null;var s;((y.SerializeBuffers||y.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(Q.base64String=this._buffer,Q.name=Q.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?Q.base64String="data:image/png;base64,"+(0,p.l)(this._buffer):(y.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(Q.base64String=!this._engine||this._engine._features.supportSyncTextureRead?H(this):d(this))),Q.invertY=this._invertY,Q.samplingMode=this.samplingMode,Q._creationFlags=this._creationFlags,Q._useSRGBBuffer=this._useSRGBBuffer,y._SerializeInternalTextureUniqueId)&&(Q.internalTextureUniqueId=null===(s=this._texture)||void 0===s?void 0:s.uniqueId);return Q.internalTextureLabel=null===(a=this._texture)||void 0===a?void 0:a.label,Q.noMipmap=this._noMipmap,this.name=x,Q}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(a,x,Q){if(a.customType){const s=v.e.Instantiate(a.customType).Parse(a,x,Q);return a.samplingMode&&s.updateSamplingMode&&s._samplingMode&&s._samplingMode!==a.samplingMode&&s.updateSamplingMode(a.samplingMode),s}if(a.isCube&&!a.isRenderTarget)return y._CubeTextureParser(a,x,Q);const s=void 0!==a.internalTextureUniqueId;if(!a.name&&!a.isRenderTarget&&!s)return null;let h;if(s){const Q=x.getEngine().getLoadedTexturesCache();for(const x of Q)if(x.uniqueId===a.internalTextureUniqueId){h=x;break}}const D=x=>{if(x&&x._texture&&(x._texture._cachedWrapU=null,x._texture._cachedWrapV=null,x._texture._cachedWrapR=null),a.samplingMode){const Q=a.samplingMode;x&&x.samplingMode!==Q&&x.updateSamplingMode(Q)}if(x&&a.animations)for(let Q=0;Q<a.animations.length;Q++){const s=a.animations[Q],h=(0,R.c)("BABYLON.Animation");h&&x.animations.push(h.Parse(s))}x&&x._texture&&(s&&!h&&x._texture._setUniqueId(a.internalTextureUniqueId),x._texture.label=a.internalTextureLabel)};return Z.e.Parse((()=>{let s=!0;if(a.noMipmap&&(s=!1),a.mirrorPlane){const Q=y._CreateMirror(a.name,a.renderTargetSize,x,s);return Q._waitingRenderList=a.renderList,Q.mirrorPlane=e.d.wi(a.mirrorPlane),D(Q),Q}if(a.isRenderTarget){let Q=null;if(a.isCube){if(x.reflectionProbes)for(let s=0;s<x.reflectionProbes.length;s++){const Q=x.reflectionProbes[s];if(Q.name===a.name)return Q.cubeTexture}}else Q=y._CreateRenderTargetTexture(a.name,a.renderTargetSize,x,s,a._creationFlags??0),Q._waitingRenderList=a.renderList;return D(Q),Q}if(a.isVideo){const h=y._CreateVideoTexture(Q+(a.url||a.name),Q+(a.src||a.url),x,s,a.invertY,a.samplingMode,a.settings||{});return D(h),h}{let N;if(a.base64String&&!h)N=y.CreateFromBase64String(a.base64String,a.base64String,x,!s,a.invertY,a.samplingMode,(()=>{D(N)}),a._creationFlags??0,a._useSRGBBuffer??!1),N.name=a.name;else{let C;C=a.name&&(a.name.indexOf("://")>0||a.name.startsWith("data:"))?a.name:Q+a.name,a.url&&(a.url.startsWith("data:")||y.UseSerializedUrlIfAny)&&(C=a.url);const R={noMipmap:!s,invertY:a.invertY,samplingMode:a.samplingMode,X:()=>{D(N)},internalTexture:h};N=new y(C,x,R)}return N}}),a,x)}static CreateFromBase64String(a,x,Q,s,h){let D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:y.TRILINEAR_SAMPLINGMODE;return new y("data:"+x,Q,s,h,D,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,a,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(a,x,Q){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],h=arguments.length>4?arguments[4]:void 0,D=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],N=arguments.length>6&&void 0!==arguments[6]?arguments[6]:y.TRILINEAR_SAMPLINGMODE,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,R=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,U=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,W=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0;return"data:"!==a.substring(0,5)&&(a="data:"+a),new y(a,Q,h,D,N,C,R,x,s,U,void 0,void 0,W,v)}}y.SerializeBuffers=!0,y.ForceSerializeBuffers=!1,y.OnTextureLoadErrorObservable=new D.e,y._SerializeInternalTextureUniqueId=!1,y._CubeTextureParser=(a,x,Q)=>{throw(0,U.c)("CubeTexture")},y._CreateMirror=(a,x,Q,s)=>{throw(0,U.c)("MirrorTexture")},y._CreateRenderTargetTexture=(a,x,Q,s,h)=>{throw(0,U.c)("RenderTargetTexture")},y.NEAREST_SAMPLINGMODE=1,y.NEAREST_NEAREST_MIPLINEAR=8,y.BILINEAR_SAMPLINGMODE=2,y.LINEAR_LINEAR_MIPNEAREST=11,y.TRILINEAR_SAMPLINGMODE=3,y.LINEAR_LINEAR_MIPLINEAR=3,y.NEAREST_NEAREST_MIPNEAREST=4,y.NEAREST_LINEAR_MIPNEAREST=5,y.NEAREST_LINEAR_MIPLINEAR=6,y.NEAREST_LINEAR=7,y.NEAREST_NEAREST=1,y.LINEAR_NEAREST_MIPNEAREST=9,y.LINEAR_NEAREST_MIPLINEAR=10,y.LINEAR_LINEAR=2,y.LINEAR_NEAREST=12,y.EXPLICIT_MODE=0,y.SPHERICAL_MODE=1,y.PLANAR_MODE=2,y.CUBIC_MODE=3,y.PROJECTION_MODE=4,y.SKYBOX_MODE=5,y.INVCUBIC_MODE=6,y.EQUIRECTANGULAR_MODE=7,y.FIXED_EQUIRECTANGULAR_MODE=8,y.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,y.CLAMP_ADDRESSMODE=0,y.WRAP_ADDRESSMODE=1,y.MIRROR_ADDRESSMODE=2,y.UseSerializedUrlIfAny=!1,(0,s.c)([(0,h.I)()],y.prototype,"url",void 0),(0,s.c)([(0,h.I)()],y.prototype,"uOffset",void 0),(0,s.c)([(0,h.I)()],y.prototype,"vOffset",void 0),(0,s.c)([(0,h.I)()],y.prototype,"uScale",void 0),(0,s.c)([(0,h.I)()],y.prototype,"vScale",void 0),(0,s.c)([(0,h.I)()],y.prototype,"uAng",void 0),(0,s.c)([(0,h.I)()],y.prototype,"vAng",void 0),(0,s.c)([(0,h.I)()],y.prototype,"wAng",void 0),(0,s.c)([(0,h.I)()],y.prototype,"uRotationCenter",void 0),(0,s.c)([(0,h.I)()],y.prototype,"vRotationCenter",void 0),(0,s.c)([(0,h.I)()],y.prototype,"wRotationCenter",void 0),(0,s.c)([(0,h.I)()],y.prototype,"homogeneousRotationInUVTransform",void 0),(0,s.c)([(0,h.I)()],y.prototype,"isBlocking",null),(0,R.g)("BABYLON.Texture",y),Z.e._TextureParser=y.Parse},2290:(a,x,Q)=>{Q.d(x,{c:()=>s});class s{constructor(a,x){this.width=a,this.height=x}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let a=0|this.width;return a=397*a^this.height,a}p(a){this.width=a.width,this.height=a.height}ki(a,x){return this.width=a,this.height=x,this}set(a,x){return this.ki(a,x)}multiplyByFloats(a,x){return new s(this.width*a,this.height*x)}clone(){return new s(this.width,this.height)}equals(a){return!!a&&(this.width===a.width&&this.height===a.height)}get surface(){return this.width*this.height}static Zero(){return new s(0,0)}add(a){return new s(this.width+a.width,this.height+a.height)}Ag(a){return new s(this.width-a.width,this.height-a.height)}scale(a){return new s(this.width*a,this.height*a)}static Lerp(a,x,Q){const h=a.width+(x.width-a.width)*Q,D=a.height+(x.height-a.height)*Q;return new s(h,D)}}}}]);