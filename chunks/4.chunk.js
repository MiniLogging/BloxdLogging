"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2038:(j,H,s)=>{s.d(H,{b:()=>p});var i=s(675),B=s(682),e=s(502),k=s(693),V=s(545),C=s(644),L=(s(551),s(2012));class U{get wrapU(){return this._wrapU}set wrapU(j){this._wrapU=j}get wrapV(){return this._wrapV}set wrapV(j){this._wrapV=j}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(j){this._texture&&(this._texture.isCube=j)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(j){this._texture&&(this._texture.is3D=j)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(j){this._texture&&(this._texture.is2DArray=j)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(j){return void 0!==(null===j||void 0===j?void 0:j.shareDepth)}constructor(j){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=L.d.Zero(),this._cachedBaseSize=L.d.Zero(),this._initialSamplingMode=2,this._texture=U._IsRenderTargetWrapper(j)?j.texture:j,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(j){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(j,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var x=s(714);class p extends U{set qi(j){this._hasAlpha!==j&&(this._hasAlpha=j,this._scene&&this._scene.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))))}get qi(){return this._hasAlpha}set getAlphaFromRGB(j){this._getAlphaFromRGB!==j&&(this._getAlphaFromRGB=j,this._scene&&this._scene.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(j){this._coordinatesIndex!==j&&(this._coordinatesIndex=j,this._scene&&this._scene.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(j){this._coordinatesMode!==j&&(this._coordinatesMode=j,this._scene&&this._scene.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(j){this._wrapU=j}get wrapV(){return this._wrapV}set wrapV(j){this._wrapV=j}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(j){this._texture?this._texture.isCube=j:this._isCube=j}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(j){this._texture&&(this._texture.is3D=j)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(j){this._texture&&(this._texture.is2DArray=j)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(j){var H;if(this._texture){if(this._texture._gammaSpace===j)return;this._texture._gammaSpace=j}else{if(this._gammaSpace===j)return;this._gammaSpace=j}null===(H=this.va())||void 0===H||H.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(j){var H;j!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=j),null===(H=this.va())||void 0===H||H.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(j){this._texture&&(this._texture._lodGenerationOffset=j)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(j){this._texture&&(this._texture._lodGenerationScale=j)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(j){this._texture&&(this._texture._linearSpecularLOD=j)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(j){this._texture&&(this._texture._irradianceTexture=j)}get uid(){return this._uid||(this._uid=(0,C.c)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(j){this._onDisposeObserver&&this.fk.remove(this._onDisposeObserver),this._onDisposeObserver=this.fk.add(j)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(j){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=p.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.fk=new e.d,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,j?p._IsScene(j)?this._scene=j:this._engine=j:this._scene=V.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=H,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return k.d.IdentityReadOnly}getReflectionTextureMatrix(){return k.d.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(j){}get canRescale(){return!1}_getFromCache(j,H,s,i,B,e){const k=this._getEngine();if(!k)return null;const V=k._getUseSRGBBuffer(!!B,H),C=k.getLoadedTexturesCache();for(let L=0;L<C.length;L++){const k=C[L];if((void 0===B||V===k._useSRGBBuffer)&&(void 0===i||i===k.invertY)&&k.url===j&&k.generateMipMaps===!H&&(!s||s===k.samplingMode)&&(void 0===e||e===k.isCube))return k.incrementReferences(),k}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const j=this.va();j&&j.markAllMaterialsAsDirty(1)}readPixels(){let j=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],B=arguments.length>4&&void 0!==arguments[4]&&arguments[4],e=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,k=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,C=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const L=this._getEngine();if(!L)return null;const U=this.getSize();let x=U.width,p=U.height;0!==H&&(x/=Math.pow(2,H),p/=Math.pow(2,H),x=Math.round(x),p=Math.round(p)),V=Math.min(x,V),C=Math.min(p,C);try{return this._texture.isCube?L._readTexturePixels(this._texture,V,C,j,H,s,i,B,e,k):L._readTexturePixels(this._texture,V,C,-1,H,s,i,B,e,k)}catch(a){return null}}_readPixelsSync(){let j=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],B=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const e=this.getSize();let k=e.width,V=e.height;const C=this._getEngine();if(!C)return null;0!=H&&(k/=Math.pow(2,H),V/=Math.pow(2,H),k=Math.round(k),V=Math.round(V));try{return this._texture.isCube?C._readTexturePixelsSync(this._texture,k,V,j,H,s,i,B):C._readTexturePixelsSync(this._texture,k,V,-1,H,s,i,B)}catch(L){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const j=this._scene.textures.indexOf(this);if(j>=0&&this._scene.textures.splice(j,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const j=this._parentContainer.textures.indexOf(this);j>-1&&this._parentContainer.textures.splice(j,1),this._parentContainer=null}}this.fk.notifyObservers(this),this.fk.clear(),this.metadata=null,super.dispose()}serialize(){let j=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!j)return null;const H=x.b.Serialize(this);return x.b.AppendSerializedAnimations(this,H),H}static WhenAllReady(j,H){let s=j.length;if(0!==s)for(let i=0;i<j.length;i++){const B=j[i];if(B.isReady())0===--s&&H();else{const j=B.onLoadObservable;j?j.addOnce((()=>{0===--s&&H()})):0===--s&&H()}}else H()}static _IsScene(j){return"Scene"===j.getClassName()}}p.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,i.e)([(0,B.I)()],p.prototype,"uniqueId",void 0),(0,i.e)([(0,B.I)()],p.prototype,"name",void 0),(0,i.e)([(0,B.I)()],p.prototype,"metadata",void 0),(0,i.e)([(0,B.I)("qi")],p.prototype,"_hasAlpha",void 0),(0,i.e)([(0,B.I)("getAlphaFromRGB")],p.prototype,"_getAlphaFromRGB",void 0),(0,i.e)([(0,B.I)()],p.prototype,"level",void 0),(0,i.e)([(0,B.I)("coordinatesIndex")],p.prototype,"_coordinatesIndex",void 0),(0,i.e)([(0,B.I)()],p.prototype,"optimizeUVAllocation",void 0),(0,i.e)([(0,B.I)("coordinatesMode")],p.prototype,"_coordinatesMode",void 0),(0,i.e)([(0,B.I)()],p.prototype,"wrapU",null),(0,i.e)([(0,B.I)()],p.prototype,"wrapV",null),(0,i.e)([(0,B.I)()],p.prototype,"wrapR",void 0),(0,i.e)([(0,B.I)()],p.prototype,"anisotropicFilteringLevel",void 0),(0,i.e)([(0,B.I)()],p.prototype,"isCube",null),(0,i.e)([(0,B.I)()],p.prototype,"is3D",null),(0,i.e)([(0,B.I)()],p.prototype,"is2DArray",null),(0,i.e)([(0,B.I)()],p.prototype,"gammaSpace",null),(0,i.e)([(0,B.I)()],p.prototype,"invertZ",void 0),(0,i.e)([(0,B.I)()],p.prototype,"lodLevelInAlpha",void 0),(0,i.e)([(0,B.I)()],p.prototype,"lodGenerationOffset",null),(0,i.e)([(0,B.I)()],p.prototype,"lodGenerationScale",null),(0,i.e)([(0,B.I)()],p.prototype,"linearSpecularLOD",null),(0,i.e)([(0,B.x)()],p.prototype,"irradianceTexture",null),(0,i.e)([(0,B.I)()],p.prototype,"isRenderTarget",void 0)},2030:(j,H,s)=>{s.d(H,{b:()=>o});var i=s(675),B=s(682),e=s(502),k=s(693),V=s(2038),C=s(636),L=s(533),U=s(576),x=s(631),p=s(735),a=s(562);function E(j,H){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=H.width,B=H.height;if(j instanceof Float32Array){let H=j.byteLength/j.BYTES_PER_ELEMENT;const s=new Uint8Array(H);for(;--H>=0;){let i=j[H];i<0?i=0:i>1&&(i=1),s[H]=255*i}j=s}const e=document.createElement("canvas");e.width=i,e.height=B;const k=e.getContext("2d");if(!k)return null;const V=k.createImageData(i,B);if(V.data.set(j),k.putImageData(V,0,0),s){const j=document.createElement("canvas");j.width=i,j.height=B;const H=j.getContext("2d");return H?(H.translate(0,B),H.scale(1,-1),H.drawImage(e,0,0),j.toDataURL("image/png")):null}return e.toDataURL("image/png")}function r(j){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=j.getInternalTexture();if(!i)return null;const B=j._readPixelsSync(H,s);return B?E(B,j.getSize(),i.invertY):null}async function q(j){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=j.getInternalTexture();if(!i)return null;const B=await j.readPixels(H,s);return B?E(B,j.getSize(),i.invertY):null}var J=s(815),h=s(714);class o extends V.b{static _CreateVideoTexture(j,H,s){arguments.length>5&&void 0!==arguments[5]||o.TRILINEAR_SAMPLINGMODE;throw(0,L.b)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(j){this._isBlocking=j}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(j,H,s,i){let B,k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.TRILINEAR_SAMPLINGMODE,V=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,L=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,x=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9?arguments[9]:void 0,a=arguments.length>10?arguments[10]:void 0,E=arguments.length>11?arguments[11]:void 0,r=arguments.length>12?arguments[12]:void 0,q=arguments.length>13?arguments[13]:void 0;super(H),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new e.d,this._isBlocking=!0,this.name=j||"",this.url=j;let h=!1,R=null,Y=!0;"object"===typeof s&&null!==s?(B=s.noMipmap??!1,i=s.invertY??!J.c,k=s.samplingMode??o.TRILINEAR_SAMPLINGMODE,V=s.X??null,C=s.onError??null,L=s.buffer??null,x=s.deleteBuffer??!1,p=s.format,a=s.mimeType,E=s.loaderOptions,r=s.creationFlags,h=s.useSRGBBuffer??!1,R=s.internalTexture??null,Y=s.gammaSpace??Y):B=!!s,this._gammaSpace=Y,this._noMipmap=B,this._invertY=void 0===i?!J.c:i,this._initialSamplingMode=k,this._buffer=L,this._deleteBuffer=x,this._mimeType=a,this._loaderOptions=E,this._creationFlags=r,this._useSRGBBuffer=h,this._forcedExtension=q,p&&(this._format=p);const v=this.va(),c=this._getEngine();if(!c)return;c.onBeforeTextureInitObservable.notifyObservers(this);const z=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),V&&V(),!this.isBlocking&&v&&v.resetCachedMaterial()},K=(j,H)=>{this._loadingError=!0,this._errorObject={message:j,exception:H},C&&C(j,H),o.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!R)return this._delayedOnLoad=z,void(this._delayedOnError=K);if(this._texture=R??this._getFromCache(this.url,B,k,this._invertY,h,this.isCube),this._texture)if(this._texture.isReady)U.d.SetImmediate((()=>z()));else{const j=this._texture.onLoadedObservable.add(z);this._texture.onErrorObservable.add((H=>{var s;K(H.message,H.exception),null===(s=this._texture)||void 0===s||s.onLoadedObservable.remove(j)}))}else if(v&&v.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=z,this._delayedOnError=K;else{try{this._texture=c.createTexture(this.url,B,this._invertY,v,k,z,K,this._buffer,void 0,this._format,this._forcedExtension,a,E,r,h)}catch(W){throw K("error loading",W),W}x&&(this._buffer=null)}}updateURL(j){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(j=>j.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=j),this.url=j,this._buffer=H,this._forcedExtension=i,this.delayLoadState=4,s&&(this._delayedOnLoad=s),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const j=this.va();j&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?U.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=j.getEngine().createTexture(this.url,this._noMipmap,this._invertY,j,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(j,H,s,i){j*=this._cachedUScale,H*=this._cachedVScale,j-=this.uRotationCenter*this._cachedUScale,H-=this.vRotationCenter*this._cachedVScale,s-=this.wRotationCenter,k.p.TransformCoordinatesFromFloatsToRef(j,H,s,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}getTextureMatrix(){let j=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*j===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*j,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=k.d.Zero(),this._rowGenerationMatrix=new k.d,this._t0=k.p.Zero(),this._t1=k.p.Zero(),this._t2=k.p.Zero()),k.d.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(k.d.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,k.i.Matrix[0]),k.d.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,k.i.Matrix[1]),k.d.ScalingToRef(this._cachedUScale,this._cachedVScale,0,k.i.Matrix[2]),k.d.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,k.i.Matrix[3]),k.i.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(k.i.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(k.i.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(k.i.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.ck(this._t0),this._t2.ck(this._t0),k.d.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const H=this.va();if(!H)return this._cachedTextureMatrix;const s=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&s!==this._cachedIdentity3x2&&H.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const j=this.va();if(!j)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==o.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===j.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=k.d.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=k.d.Zero());const H=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case o.PLANAR_MODE:k.d.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case o.PROJECTION_MODE:{k.d.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const H=j.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=H.updateFlag,H.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:k.d.IdentityToRef(this._cachedReflectionTextureMatrix)}return H&&j.markAllMaterialsAsDirty(1,(j=>j.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const j={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return h.b.Clone((()=>new o(this._texture?this._texture.url:null,this.va(),j)),this)}serialize(){var j;const H=this.name;o.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const s=super.serialize(o._SerializeInternalTextureUniqueId);if(!s)return null;var i;((o.SerializeBuffers||o.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(s.base64String=this._buffer,s.name=s.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?s.base64String="data:image/png;base64,"+(0,a.l)(this._buffer):(o.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(s.base64String=!this._engine||this._engine._features.supportSyncTextureRead?r(this):q(this))),s.invertY=this._invertY,s.samplingMode=this.samplingMode,s._creationFlags=this._creationFlags,s._useSRGBBuffer=this._useSRGBBuffer,o._SerializeInternalTextureUniqueId)&&(s.internalTextureUniqueId=null===(i=this._texture)||void 0===i?void 0:i.uniqueId);return s.internalTextureLabel=null===(j=this._texture)||void 0===j?void 0:j.label,s.noMipmap=this._noMipmap,this.name=H,s}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(j,H,s){if(j.customType){const i=x.b.Instantiate(j.customType).Parse(j,H,s);return j.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==j.samplingMode&&i.updateSamplingMode(j.samplingMode),i}if(j.isCube&&!j.isRenderTarget)return o._CubeTextureParser(j,H,s);const i=void 0!==j.internalTextureUniqueId;if(!j.name&&!j.isRenderTarget&&!i)return null;let B;if(i){const s=H.getEngine().getLoadedTexturesCache();for(const H of s)if(H.uniqueId===j.internalTextureUniqueId){B=H;break}}const e=H=>{if(H&&H._texture&&(H._texture._cachedWrapU=null,H._texture._cachedWrapV=null,H._texture._cachedWrapR=null),j.samplingMode){const s=j.samplingMode;H&&H.samplingMode!==s&&H.updateSamplingMode(s)}if(H&&j.animations)for(let s=0;s<j.animations.length;s++){const i=j.animations[s],B=(0,C.d)("BABYLON.Animation");B&&H.animations.push(B.Parse(i))}H&&H._texture&&(i&&!B&&H._texture._setUniqueId(j.internalTextureUniqueId),H._texture.label=j.internalTextureLabel)};return h.b.Parse((()=>{let i=!0;if(j.noMipmap&&(i=!1),j.mirrorPlane){const s=o._CreateMirror(j.name,j.renderTargetSize,H,i);return s._waitingRenderList=j.renderList,s.mirrorPlane=p.c._j(j.mirrorPlane),e(s),s}if(j.isRenderTarget){let s=null;if(j.isCube){if(H.reflectionProbes)for(let i=0;i<H.reflectionProbes.length;i++){const s=H.reflectionProbes[i];if(s.name===j.name)return s.cubeTexture}}else s=o._CreateRenderTargetTexture(j.name,j.renderTargetSize,H,i,j._creationFlags??0),s._waitingRenderList=j.renderList;return e(s),s}if(j.isVideo){const B=o._CreateVideoTexture(s+(j.url||j.name),s+(j.src||j.url),H,i,j.invertY,j.samplingMode,j.settings||{});return e(B),B}{let k;if(j.base64String&&!B)k=o.CreateFromBase64String(j.base64String,j.base64String,H,!i,j.invertY,j.samplingMode,(()=>{e(k)}),j._creationFlags??0,j._useSRGBBuffer??!1),k.name=j.name;else{let V;V=j.name&&(j.name.indexOf("://")>0||j.name.startsWith("data:"))?j.name:s+j.name,j.url&&(j.url.startsWith("data:")||o.UseSerializedUrlIfAny)&&(V=j.url);const C={noMipmap:!i,invertY:j.invertY,samplingMode:j.samplingMode,X:()=>{e(k)},internalTexture:B};k=new o(V,H,C)}return k}}),j,H)}static CreateFromBase64String(j,H,s,i,B){let e=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.TRILINEAR_SAMPLINGMODE;return new o("data:"+H,s,i,B,e,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,j,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(j,H,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],B=arguments.length>4?arguments[4]:void 0,e=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],k=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o.TRILINEAR_SAMPLINGMODE,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,C=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,L=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,U=arguments.length>10?arguments[10]:void 0,x=arguments.length>11?arguments[11]:void 0;return"data:"!==j.substring(0,5)&&(j="data:"+j),new o(j,s,B,e,k,V,C,H,i,L,void 0,void 0,U,x)}}o.SerializeBuffers=!0,o.ForceSerializeBuffers=!1,o.OnTextureLoadErrorObservable=new e.d,o._SerializeInternalTextureUniqueId=!1,o._CubeTextureParser=(j,H,s)=>{throw(0,L.b)("CubeTexture")},o._CreateMirror=(j,H,s,i)=>{throw(0,L.b)("MirrorTexture")},o._CreateRenderTargetTexture=(j,H,s,i,B)=>{throw(0,L.b)("RenderTargetTexture")},o.NEAREST_SAMPLINGMODE=1,o.NEAREST_NEAREST_MIPLINEAR=8,o.BILINEAR_SAMPLINGMODE=2,o.LINEAR_LINEAR_MIPNEAREST=11,o.TRILINEAR_SAMPLINGMODE=3,o.LINEAR_LINEAR_MIPLINEAR=3,o.NEAREST_NEAREST_MIPNEAREST=4,o.NEAREST_LINEAR_MIPNEAREST=5,o.NEAREST_LINEAR_MIPLINEAR=6,o.NEAREST_LINEAR=7,o.NEAREST_NEAREST=1,o.LINEAR_NEAREST_MIPNEAREST=9,o.LINEAR_NEAREST_MIPLINEAR=10,o.LINEAR_LINEAR=2,o.LINEAR_NEAREST=12,o.EXPLICIT_MODE=0,o.SPHERICAL_MODE=1,o.PLANAR_MODE=2,o.CUBIC_MODE=3,o.PROJECTION_MODE=4,o.SKYBOX_MODE=5,o.INVCUBIC_MODE=6,o.EQUIRECTANGULAR_MODE=7,o.FIXED_EQUIRECTANGULAR_MODE=8,o.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,o.CLAMP_ADDRESSMODE=0,o.WRAP_ADDRESSMODE=1,o.MIRROR_ADDRESSMODE=2,o.UseSerializedUrlIfAny=!1,(0,i.e)([(0,B.I)()],o.prototype,"url",void 0),(0,i.e)([(0,B.I)()],o.prototype,"uOffset",void 0),(0,i.e)([(0,B.I)()],o.prototype,"vOffset",void 0),(0,i.e)([(0,B.I)()],o.prototype,"uScale",void 0),(0,i.e)([(0,B.I)()],o.prototype,"vScale",void 0),(0,i.e)([(0,B.I)()],o.prototype,"uAng",void 0),(0,i.e)([(0,B.I)()],o.prototype,"vAng",void 0),(0,i.e)([(0,B.I)()],o.prototype,"wAng",void 0),(0,i.e)([(0,B.I)()],o.prototype,"uRotationCenter",void 0),(0,i.e)([(0,B.I)()],o.prototype,"vRotationCenter",void 0),(0,i.e)([(0,B.I)()],o.prototype,"wRotationCenter",void 0),(0,i.e)([(0,B.I)()],o.prototype,"homogeneousRotationInUVTransform",void 0),(0,i.e)([(0,B.I)()],o.prototype,"isBlocking",null),(0,C.g)("BABYLON.Texture",o),h.b._TextureParser=o.Parse},2012:(j,H,s)=>{s.d(H,{d:()=>i});class i{constructor(j,H){this.width=j,this.height=H}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let j=0|this.width;return j=397*j^this.height,j}p(j){this.width=j.width,this.height=j.height}wd(j,H){return this.width=j,this.height=H,this}set(j,H){return this.wd(j,H)}multiplyByFloats(j,H){return new i(this.width*j,this.height*H)}clone(){return new i(this.width,this.height)}equals(j){return!!j&&(this.width===j.width&&this.height===j.height)}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}add(j){return new i(this.width+j.width,this.height+j.height)}de(j){return new i(this.width-j.width,this.height-j.height)}scale(j){return new i(this.width*j,this.height*j)}static Lerp(j,H,s){const B=j.width+(H.width-j.width)*s,e=j.height+(H.height-j.height)*s;return new i(B,e)}}}}]);