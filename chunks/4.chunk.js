"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2370:(k,M,F)=>{F.d(M,{b:()=>U});var l=F(654),t=F(663),g=F(477),B=F(682),G=F(516),A=F(620),N=(F(522),F(2343));class d{get wrapU(){return this._wrapU}set wrapU(k){this._wrapU=k}get wrapV(){return this._wrapV}set wrapV(k){this._wrapV=k}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(k){this._texture&&(this._texture.isCube=k)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(k){this._texture&&(this._texture.is3D=k)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(k){this._texture&&(this._texture.is2DArray=k)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(k){return void 0!==(null===k||void 0===k?void 0:k.shareDepth)}constructor(k){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=N.e.Zero(),this._cachedBaseSize=N.e.Zero(),this._initialSamplingMode=2,this._texture=d._IsRenderTargetWrapper(k)?k.texture:k,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(k){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(k,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var L=F(716);class U extends d{set yi(k){this._hasAlpha!==k&&(this._hasAlpha=k,this._scene&&this._scene.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))))}get yi(){return this._hasAlpha}set getAlphaFromRGB(k){this._getAlphaFromRGB!==k&&(this._getAlphaFromRGB=k,this._scene&&this._scene.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(k){this._coordinatesIndex!==k&&(this._coordinatesIndex=k,this._scene&&this._scene.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(k){this._coordinatesMode!==k&&(this._coordinatesMode=k,this._scene&&this._scene.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(k){this._wrapU=k}get wrapV(){return this._wrapV}set wrapV(k){this._wrapV=k}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(k){this._texture?this._texture.isCube=k:this._isCube=k}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(k){this._texture&&(this._texture.is3D=k)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(k){this._texture&&(this._texture.is2DArray=k)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(k){var M;if(this._texture){if(this._texture._gammaSpace===k)return;this._texture._gammaSpace=k}else{if(this._gammaSpace===k)return;this._gammaSpace=k}null===(M=this.va())||void 0===M||M.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(k){var M;k!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=k),null===(M=this.va())||void 0===M||M.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(k){this._texture&&(this._texture._lodGenerationOffset=k)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(k){this._texture&&(this._texture._lodGenerationScale=k)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(k){this._texture&&(this._texture._linearSpecularLOD=k)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(k){this._texture&&(this._texture._irradianceTexture=k)}get uid(){return this._uid||(this._uid=(0,A.b)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(k){this._onDisposeObserver&&this.kk.remove(this._onDisposeObserver),this._onDisposeObserver=this.kk.add(k)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(k){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=U.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.kk=new g.c,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,k?U._IsScene(k)?this._scene=k:this._engine=k:this._scene=G.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=M,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return B.c.IdentityReadOnly}getReflectionTextureMatrix(){return B.c.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(k){}get canRescale(){return!1}_getFromCache(k,M,F,l,t,g){const B=this._getEngine();if(!B)return null;const G=B._getUseSRGBBuffer(!!t,M),A=B.getLoadedTexturesCache();for(let N=0;N<A.length;N++){const B=A[N];if((void 0===t||G===B._useSRGBBuffer)&&(void 0===l||l===B.invertY)&&B.url===k&&B.generateMipMaps===!M&&(!F||F===B.samplingMode)&&(void 0===g||g===B.isCube))return B.incrementReferences(),B}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const k=this.va();k&&k.markAllMaterialsAsDirty(1)}readPixels(){let k=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4],g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,G=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,A=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const N=this._getEngine();if(!N)return null;const d=this.getSize();let L=d.width,U=d.height;0!==M&&(L/=Math.pow(2,M),U/=Math.pow(2,M),L=Math.round(L),U=Math.round(U)),G=Math.min(L,G),A=Math.min(U,A);try{return this._texture.isCube?N._readTexturePixels(this._texture,G,A,k,M,F,l,t,g,B):N._readTexturePixels(this._texture,G,A,-1,M,F,l,t,g,B)}catch(O){return null}}_readPixelsSync(){let k=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const g=this.getSize();let B=g.width,G=g.height;const A=this._getEngine();if(!A)return null;0!=M&&(B/=Math.pow(2,M),G/=Math.pow(2,M),B=Math.round(B),G=Math.round(G));try{return this._texture.isCube?A._readTexturePixelsSync(this._texture,B,G,k,M,F,l,t):A._readTexturePixelsSync(this._texture,B,G,-1,M,F,l,t)}catch(N){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const k=this._scene.textures.indexOf(this);if(k>=0&&this._scene.textures.splice(k,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const k=this._parentContainer.textures.indexOf(this);k>-1&&this._parentContainer.textures.splice(k,1),this._parentContainer=null}}this.kk.notifyObservers(this),this.kk.clear(),this.metadata=null,super.dispose()}serialize(){let k=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!k)return null;const M=L.c.Serialize(this);return L.c.AppendSerializedAnimations(this,M),M}static WhenAllReady(k,M){let F=k.length;if(0!==F)for(let l=0;l<k.length;l++){const t=k[l];if(t.isReady())0===--F&&M();else{const k=t.onLoadObservable;k?k.addOnce((()=>{0===--F&&M()})):0===--F&&M()}}else M()}static _IsScene(k){return"Scene"===k.getClassName()}}U.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,l.d)([(0,t.E)()],U.prototype,"uniqueId",void 0),(0,l.d)([(0,t.E)()],U.prototype,"name",void 0),(0,l.d)([(0,t.E)()],U.prototype,"metadata",void 0),(0,l.d)([(0,t.E)("yi")],U.prototype,"_hasAlpha",void 0),(0,l.d)([(0,t.E)("getAlphaFromRGB")],U.prototype,"_getAlphaFromRGB",void 0),(0,l.d)([(0,t.E)()],U.prototype,"level",void 0),(0,l.d)([(0,t.E)("coordinatesIndex")],U.prototype,"_coordinatesIndex",void 0),(0,l.d)([(0,t.E)()],U.prototype,"optimizeUVAllocation",void 0),(0,l.d)([(0,t.E)("coordinatesMode")],U.prototype,"_coordinatesMode",void 0),(0,l.d)([(0,t.E)()],U.prototype,"wrapU",null),(0,l.d)([(0,t.E)()],U.prototype,"wrapV",null),(0,l.d)([(0,t.E)()],U.prototype,"wrapR",void 0),(0,l.d)([(0,t.E)()],U.prototype,"anisotropicFilteringLevel",void 0),(0,l.d)([(0,t.E)()],U.prototype,"isCube",null),(0,l.d)([(0,t.E)()],U.prototype,"is3D",null),(0,l.d)([(0,t.E)()],U.prototype,"is2DArray",null),(0,l.d)([(0,t.E)()],U.prototype,"gammaSpace",null),(0,l.d)([(0,t.E)()],U.prototype,"invertZ",void 0),(0,l.d)([(0,t.E)()],U.prototype,"lodLevelInAlpha",void 0),(0,l.d)([(0,t.E)()],U.prototype,"lodGenerationOffset",null),(0,l.d)([(0,t.E)()],U.prototype,"lodGenerationScale",null),(0,l.d)([(0,t.E)()],U.prototype,"linearSpecularLOD",null),(0,l.d)([(0,t.x)()],U.prototype,"irradianceTexture",null),(0,l.d)([(0,t.E)()],U.prototype,"isRenderTarget",void 0)},2361:(k,M,F)=>{F.d(M,{d:()=>o});var l=F(654),t=F(663),g=F(477),B=F(682),G=F(2370),A=F(613),N=F(500),d=F(546),L=F(605),U=F(730),O=F(533);function w(k,M){let F=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=M.width,t=M.height;if(k instanceof Float32Array){let M=k.byteLength/k.BYTES_PER_ELEMENT;const F=new Uint8Array(M);for(;--M>=0;){let l=k[M];l<0?l=0:l>1&&(l=1),F[M]=255*l}k=F}const g=document.createElement("canvas");g.width=l,g.height=t;const B=g.getContext("2d");if(!B)return null;const G=B.createImageData(l,t);if(G.data.set(k),B.putImageData(G,0,0),F){const k=document.createElement("canvas");k.width=l,k.height=t;const M=k.getContext("2d");return M?(M.translate(0,t),M.scale(1,-1),M.drawImage(g,0,0),k.toDataURL("image/png")):null}return g.toDataURL("image/png")}function Z(k){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=k.getInternalTexture();if(!l)return null;const t=k._readPixelsSync(M,F);return t?w(t,k.getSize(),l.invertY):null}async function R(k){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=k.getInternalTexture();if(!l)return null;const t=await k.readPixels(M,F);return t?w(t,k.getSize(),l.invertY):null}var y=F(793),m=F(716);class o extends G.b{static _CreateVideoTexture(k,M,F){arguments.length>5&&void 0!==arguments[5]||o.TRILINEAR_SAMPLINGMODE;throw(0,N.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(k){this._isBlocking=k}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(k,M,F,l){let t,B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.TRILINEAR_SAMPLINGMODE,G=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,N=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L=arguments.length>8&&void 0!==arguments[8]&&arguments[8],U=arguments.length>9?arguments[9]:void 0,O=arguments.length>10?arguments[10]:void 0,w=arguments.length>11?arguments[11]:void 0,Z=arguments.length>12?arguments[12]:void 0,R=arguments.length>13?arguments[13]:void 0;super(M),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new g.c,this._isBlocking=!0,this.name=k||"",this.url=k;let m=!1,Q=null,v=!0;"object"===typeof F&&null!==F?(t=F.noMipmap??!1,l=F.invertY??!y.b,B=F.samplingMode??o.TRILINEAR_SAMPLINGMODE,G=F.X??null,A=F.onError??null,N=F.buffer??null,L=F.deleteBuffer??!1,U=F.format,O=F.mimeType,w=F.loaderOptions,Z=F.creationFlags,m=F.useSRGBBuffer??!1,Q=F.internalTexture??null,v=F.gammaSpace??v):t=!!F,this._gammaSpace=v,this._noMipmap=t,this._invertY=void 0===l?!y.b:l,this._initialSamplingMode=B,this._buffer=N,this._deleteBuffer=L,this._mimeType=O,this._loaderOptions=w,this._creationFlags=Z,this._useSRGBBuffer=m,this._forcedExtension=R,U&&(this._format=U);const J=this.va(),n=this._getEngine();if(!n)return;n.onBeforeTextureInitObservable.notifyObservers(this);const a=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),G&&G(),!this.isBlocking&&J&&J.resetCachedMaterial()},Y=(k,M)=>{this._loadingError=!0,this._errorObject={message:k,exception:M},A&&A(k,M),o.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!Q)return this._delayedOnLoad=a,void(this._delayedOnError=Y);if(this._texture=Q??this._getFromCache(this.url,t,B,this._invertY,m,this.isCube),this._texture)if(this._texture.isReady)d.e.SetImmediate((()=>a()));else{const k=this._texture.onLoadedObservable.add(a);this._texture.onErrorObservable.add((M=>{var F;Y(M.message,M.exception),null===(F=this._texture)||void 0===F||F.onLoadedObservable.remove(k)}))}else if(J&&J.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=a,this._delayedOnError=Y;else{try{this._texture=n.createTexture(this.url,t,this._invertY,J,B,a,Y,this._buffer,void 0,this._format,this._forcedExtension,O,w,Z,m)}catch(s){throw Y("error loading",s),s}L&&(this._buffer=null)}}updateURL(k){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,F=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(k=>k.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=k),this.url=k,this._buffer=M,this._forcedExtension=l,this.delayLoadState=4,F&&(this._delayedOnLoad=F),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const k=this.va();k&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?d.e.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=k.getEngine().createTexture(this.url,this._noMipmap,this._invertY,k,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(k,M,F,l){k*=this._cachedUScale,M*=this._cachedVScale,k-=this.uRotationCenter*this._cachedUScale,M-=this.vRotationCenter*this._cachedVScale,F-=this.wRotationCenter,B.m.TransformCoordinatesFromFloatsToRef(k,M,F,this._rowGenerationMatrix,l),l.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,l.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,l.z+=this.wRotationCenter}getTextureMatrix(){let k=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*k===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*k,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=B.c.Zero(),this._rowGenerationMatrix=new B.c,this._t0=B.m.Zero(),this._t1=B.m.Zero(),this._t2=B.m.Zero()),B.c.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(B.c.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,B.i.Matrix[0]),B.c.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,B.i.Matrix[1]),B.c.ScalingToRef(this._cachedUScale,this._cachedVScale,0,B.i.Matrix[2]),B.c.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,B.i.Matrix[3]),B.i.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.i.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.i.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.i.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.hk(this._t0),this._t2.hk(this._t0),B.c.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const M=this.va();if(!M)return this._cachedTextureMatrix;const F=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&F!==this._cachedIdentity3x2&&M.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const k=this.va();if(!k)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==o.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===k.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=B.c.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=B.c.Zero());const M=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case o.PLANAR_MODE:B.c.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case o.PROJECTION_MODE:{B.c.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const M=k.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=M.updateFlag,M.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:B.c.IdentityToRef(this._cachedReflectionTextureMatrix)}return M&&k.markAllMaterialsAsDirty(1,(k=>k.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const k={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return m.c.Clone((()=>new o(this._texture?this._texture.url:null,this.va(),k)),this)}serialize(){var k;const M=this.name;o.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const F=super.serialize(o._SerializeInternalTextureUniqueId);if(!F)return null;var l;((o.SerializeBuffers||o.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(F.base64String=this._buffer,F.name=F.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?F.base64String="data:image/png;base64,"+(0,O.h)(this._buffer):(o.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(F.base64String=!this._engine||this._engine._features.supportSyncTextureRead?Z(this):R(this))),F.invertY=this._invertY,F.samplingMode=this.samplingMode,F._creationFlags=this._creationFlags,F._useSRGBBuffer=this._useSRGBBuffer,o._SerializeInternalTextureUniqueId)&&(F.internalTextureUniqueId=null===(l=this._texture)||void 0===l?void 0:l.uniqueId);return F.internalTextureLabel=null===(k=this._texture)||void 0===k?void 0:k.label,F.noMipmap=this._noMipmap,this.name=M,F}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(k,M,F){if(k.customType){const l=L.d.Instantiate(k.customType).Parse(k,M,F);return k.samplingMode&&l.updateSamplingMode&&l._samplingMode&&l._samplingMode!==k.samplingMode&&l.updateSamplingMode(k.samplingMode),l}if(k.isCube&&!k.isRenderTarget)return o._CubeTextureParser(k,M,F);const l=void 0!==k.internalTextureUniqueId;if(!k.name&&!k.isRenderTarget&&!l)return null;let t;if(l){const F=M.getEngine().getLoadedTexturesCache();for(const M of F)if(M.uniqueId===k.internalTextureUniqueId){t=M;break}}const g=M=>{if(M&&M._texture&&(M._texture._cachedWrapU=null,M._texture._cachedWrapV=null,M._texture._cachedWrapR=null),k.samplingMode){const F=k.samplingMode;M&&M.samplingMode!==F&&M.updateSamplingMode(F)}if(M&&k.animations)for(let F=0;F<k.animations.length;F++){const l=k.animations[F],t=(0,A.b)("BABYLON.Animation");t&&M.animations.push(t.Parse(l))}M&&M._texture&&(l&&!t&&M._texture._setUniqueId(k.internalTextureUniqueId),M._texture.label=k.internalTextureLabel)};return m.c.Parse((()=>{let l=!0;if(k.noMipmap&&(l=!1),k.mirrorPlane){const F=o._CreateMirror(k.name,k.renderTargetSize,M,l);return F._waitingRenderList=k.renderList,F.mirrorPlane=U.b.dk(k.mirrorPlane),g(F),F}if(k.isRenderTarget){let F=null;if(k.isCube){if(M.reflectionProbes)for(let l=0;l<M.reflectionProbes.length;l++){const F=M.reflectionProbes[l];if(F.name===k.name)return F.cubeTexture}}else F=o._CreateRenderTargetTexture(k.name,k.renderTargetSize,M,l,k._creationFlags??0),F._waitingRenderList=k.renderList;return g(F),F}if(k.isVideo){const t=o._CreateVideoTexture(F+(k.url||k.name),F+(k.src||k.url),M,l,k.invertY,k.samplingMode,k.settings||{});return g(t),t}{let B;if(k.base64String&&!t)B=o.CreateFromBase64String(k.base64String,k.base64String,M,!l,k.invertY,k.samplingMode,(()=>{g(B)}),k._creationFlags??0,k._useSRGBBuffer??!1),B.name=k.name;else{let G;G=k.name&&(k.name.indexOf("://")>0||k.name.startsWith("data:"))?k.name:F+k.name,k.url&&(k.url.startsWith("data:")||o.UseSerializedUrlIfAny)&&(G=k.url);const A={noMipmap:!l,invertY:k.invertY,samplingMode:k.samplingMode,X:()=>{g(B)},internalTexture:t};B=new o(G,M,A)}return B}}),k,M)}static CreateFromBase64String(k,M,F,l,t){let g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.TRILINEAR_SAMPLINGMODE;return new o("data:"+M,F,l,t,g,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,k,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(k,M,F){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],t=arguments.length>4?arguments[4]:void 0,g=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o.TRILINEAR_SAMPLINGMODE,G=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,A=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,N=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,d=arguments.length>10?arguments[10]:void 0,L=arguments.length>11?arguments[11]:void 0;return"data:"!==k.substring(0,5)&&(k="data:"+k),new o(k,F,t,g,B,G,A,M,l,N,void 0,void 0,d,L)}}o.SerializeBuffers=!0,o.ForceSerializeBuffers=!1,o.OnTextureLoadErrorObservable=new g.c,o._SerializeInternalTextureUniqueId=!1,o._CubeTextureParser=(k,M,F)=>{throw(0,N.c)("CubeTexture")},o._CreateMirror=(k,M,F,l)=>{throw(0,N.c)("MirrorTexture")},o._CreateRenderTargetTexture=(k,M,F,l,t)=>{throw(0,N.c)("RenderTargetTexture")},o.NEAREST_SAMPLINGMODE=1,o.NEAREST_NEAREST_MIPLINEAR=8,o.BILINEAR_SAMPLINGMODE=2,o.LINEAR_LINEAR_MIPNEAREST=11,o.TRILINEAR_SAMPLINGMODE=3,o.LINEAR_LINEAR_MIPLINEAR=3,o.NEAREST_NEAREST_MIPNEAREST=4,o.NEAREST_LINEAR_MIPNEAREST=5,o.NEAREST_LINEAR_MIPLINEAR=6,o.NEAREST_LINEAR=7,o.NEAREST_NEAREST=1,o.LINEAR_NEAREST_MIPNEAREST=9,o.LINEAR_NEAREST_MIPLINEAR=10,o.LINEAR_LINEAR=2,o.LINEAR_NEAREST=12,o.EXPLICIT_MODE=0,o.SPHERICAL_MODE=1,o.PLANAR_MODE=2,o.CUBIC_MODE=3,o.PROJECTION_MODE=4,o.SKYBOX_MODE=5,o.INVCUBIC_MODE=6,o.EQUIRECTANGULAR_MODE=7,o.FIXED_EQUIRECTANGULAR_MODE=8,o.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,o.CLAMP_ADDRESSMODE=0,o.WRAP_ADDRESSMODE=1,o.MIRROR_ADDRESSMODE=2,o.UseSerializedUrlIfAny=!1,(0,l.d)([(0,t.E)()],o.prototype,"url",void 0),(0,l.d)([(0,t.E)()],o.prototype,"uOffset",void 0),(0,l.d)([(0,t.E)()],o.prototype,"vOffset",void 0),(0,l.d)([(0,t.E)()],o.prototype,"uScale",void 0),(0,l.d)([(0,t.E)()],o.prototype,"vScale",void 0),(0,l.d)([(0,t.E)()],o.prototype,"uAng",void 0),(0,l.d)([(0,t.E)()],o.prototype,"vAng",void 0),(0,l.d)([(0,t.E)()],o.prototype,"wAng",void 0),(0,l.d)([(0,t.E)()],o.prototype,"uRotationCenter",void 0),(0,l.d)([(0,t.E)()],o.prototype,"vRotationCenter",void 0),(0,l.d)([(0,t.E)()],o.prototype,"wRotationCenter",void 0),(0,l.d)([(0,t.E)()],o.prototype,"homogeneousRotationInUVTransform",void 0),(0,l.d)([(0,t.E)()],o.prototype,"isBlocking",null),(0,A.e)("BABYLON.Texture",o),m.c._TextureParser=o.Parse},2343:(k,M,F)=>{F.d(M,{e:()=>l});class l{constructor(k,M){this.width=k,this.height=M}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let k=0|this.width;return k=397*k^this.height,k}p(k){this.width=k.width,this.height=k.height}yd(k,M){return this.width=k,this.height=M,this}set(k,M){return this.yd(k,M)}multiplyByFloats(k,M){return new l(this.width*k,this.height*M)}clone(){return new l(this.width,this.height)}equals(k){return!!k&&(this.width===k.width&&this.height===k.height)}get surface(){return this.width*this.height}static Zero(){return new l(0,0)}add(k){return new l(this.width+k.width,this.height+k.height)}fe(k){return new l(this.width-k.width,this.height-k.height)}scale(k){return new l(this.width*k,this.height*k)}static Lerp(k,M,F){const t=k.width+(M.width-k.width)*F,g=k.height+(M.height-k.height)*F;return new l(t,g)}}}}]);