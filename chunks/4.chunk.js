"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2081:(Y,d,t)=>{t.d(d,{d:()=>D});var x=t(670),C=t(673),U=t(513),y=t(686),B=t(561),W=t(641),o=(t(563),t(2055));class f{get wrapU(){return this._wrapU}set wrapU(Y){this._wrapU=Y}get wrapV(){return this._wrapV}set wrapV(Y){this._wrapV=Y}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(Y){this._texture&&(this._texture.isCube=Y)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Y){this._texture&&(this._texture.is3D=Y)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Y){this._texture&&(this._texture.is2DArray=Y)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(Y){return void 0!==(null===Y||void 0===Y?void 0:Y.shareDepth)}constructor(Y){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=o.d.Zero(),this._cachedBaseSize=o.d.Zero(),this._initialSamplingMode=2,this._texture=f._IsRenderTargetWrapper(Y)?Y.texture:Y,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(Y){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(Y,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var F=t(720);class D extends f{set wi(Y){this._hasAlpha!==Y&&(this._hasAlpha=Y,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))))}get wi(){return this._hasAlpha}set getAlphaFromRGB(Y){this._getAlphaFromRGB!==Y&&(this._getAlphaFromRGB=Y,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(Y){this._coordinatesIndex!==Y&&(this._coordinatesIndex=Y,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(Y){this._coordinatesMode!==Y&&(this._coordinatesMode=Y,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(Y){this._wrapU=Y}get wrapV(){return this._wrapV}set wrapV(Y){this._wrapV=Y}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(Y){this._texture?this._texture.isCube=Y:this._isCube=Y}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Y){this._texture&&(this._texture.is3D=Y)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Y){this._texture&&(this._texture.is2DArray=Y)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(Y){var d;if(this._texture){if(this._texture._gammaSpace===Y)return;this._texture._gammaSpace=Y}else{if(this._gammaSpace===Y)return;this._gammaSpace=Y}null===(d=this.va())||void 0===d||d.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(Y){var d;Y!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=Y),null===(d=this.va())||void 0===d||d.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(Y){this._texture&&(this._texture._lodGenerationOffset=Y)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(Y){this._texture&&(this._texture._lodGenerationScale=Y)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(Y){this._texture&&(this._texture._linearSpecularLOD=Y)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(Y){this._texture&&(this._texture._irradianceTexture=Y)}get uid(){return this._uid||(this._uid=(0,W.b)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(Y){this._onDisposeObserver&&this.lk.remove(this._onDisposeObserver),this._onDisposeObserver=this.lk.add(Y)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(Y){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=D.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.lk=new U.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,Y?D._IsScene(Y)?this._scene=Y:this._engine=Y:this._scene=B.d.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=d,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return y.b.IdentityReadOnly}getReflectionTextureMatrix(){return y.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(Y){}get canRescale(){return!1}_getFromCache(Y,d,t,x,C,U){const y=this._getEngine();if(!y)return null;const B=y._getUseSRGBBuffer(!!C,d),W=y.getLoadedTexturesCache();for(let o=0;o<W.length;o++){const y=W[o];if((void 0===C||B===y._useSRGBBuffer)&&(void 0===x||x===y.invertY)&&y.url===Y&&y.generateMipMaps===!d&&(!t||t===y.samplingMode)&&(void 0===U||U===y.isCube))return y.incrementReferences(),y}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const Y=this.va();Y&&Y.markAllMaterialsAsDirty(1)}readPixels(){let Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,x=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4],U=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,B=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,W=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const o=this._getEngine();if(!o)return null;const f=this.getSize();let F=f.width,D=f.height;0!==d&&(F/=Math.pow(2,d),D/=Math.pow(2,d),F=Math.round(F),D=Math.round(D)),B=Math.min(F,B),W=Math.min(D,W);try{return this._texture.isCube?o._readTexturePixels(this._texture,B,W,Y,d,t,x,C,U,y):o._readTexturePixels(this._texture,B,W,-1,d,t,x,C,U,y)}catch(b){return null}}_readPixelsSync(){let Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,x=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const U=this.getSize();let y=U.width,B=U.height;const W=this._getEngine();if(!W)return null;0!=d&&(y/=Math.pow(2,d),B/=Math.pow(2,d),y=Math.round(y),B=Math.round(B));try{return this._texture.isCube?W._readTexturePixelsSync(this._texture,y,B,Y,d,t,x,C):W._readTexturePixelsSync(this._texture,y,B,-1,d,t,x,C)}catch(o){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const Y=this._scene.textures.indexOf(this);if(Y>=0&&this._scene.textures.splice(Y,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const Y=this._parentContainer.textures.indexOf(this);Y>-1&&this._parentContainer.textures.splice(Y,1),this._parentContainer=null}}this.lk.notifyObservers(this),this.lk.clear(),this.metadata=null,super.dispose()}serialize(){let Y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!Y)return null;const d=F.e.Serialize(this);return F.e.AppendSerializedAnimations(this,d),d}static WhenAllReady(Y,d){let t=Y.length;if(0!==t)for(let x=0;x<Y.length;x++){const C=Y[x];if(C.isReady())0===--t&&d();else{const Y=C.onLoadObservable;Y?Y.addOnce((()=>{0===--t&&d()})):0===--t&&d()}}else d()}static _IsScene(Y){return"Scene"===Y.getClassName()}}D.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,x.e)([(0,C.P)()],D.prototype,"uniqueId",void 0),(0,x.e)([(0,C.P)()],D.prototype,"name",void 0),(0,x.e)([(0,C.P)()],D.prototype,"metadata",void 0),(0,x.e)([(0,C.P)("wi")],D.prototype,"_hasAlpha",void 0),(0,x.e)([(0,C.P)("getAlphaFromRGB")],D.prototype,"_getAlphaFromRGB",void 0),(0,x.e)([(0,C.P)()],D.prototype,"level",void 0),(0,x.e)([(0,C.P)("coordinatesIndex")],D.prototype,"_coordinatesIndex",void 0),(0,x.e)([(0,C.P)()],D.prototype,"optimizeUVAllocation",void 0),(0,x.e)([(0,C.P)("coordinatesMode")],D.prototype,"_coordinatesMode",void 0),(0,x.e)([(0,C.P)()],D.prototype,"wrapU",null),(0,x.e)([(0,C.P)()],D.prototype,"wrapV",null),(0,x.e)([(0,C.P)()],D.prototype,"wrapR",void 0),(0,x.e)([(0,C.P)()],D.prototype,"anisotropicFilteringLevel",void 0),(0,x.e)([(0,C.P)()],D.prototype,"isCube",null),(0,x.e)([(0,C.P)()],D.prototype,"is3D",null),(0,x.e)([(0,C.P)()],D.prototype,"is2DArray",null),(0,x.e)([(0,C.P)()],D.prototype,"gammaSpace",null),(0,x.e)([(0,C.P)()],D.prototype,"invertZ",void 0),(0,x.e)([(0,C.P)()],D.prototype,"lodLevelInAlpha",void 0),(0,x.e)([(0,C.P)()],D.prototype,"lodGenerationOffset",null),(0,x.e)([(0,C.P)()],D.prototype,"lodGenerationScale",null),(0,x.e)([(0,C.P)()],D.prototype,"linearSpecularLOD",null),(0,x.e)([(0,C.J)()],D.prototype,"irradianceTexture",null),(0,x.e)([(0,C.P)()],D.prototype,"isRenderTarget",void 0)},2077:(Y,d,t)=>{t.d(d,{d:()=>s});var x=t(670),C=t(673),U=t(513),y=t(686),B=t(2081),W=t(637),o=t(550),f=t(582),F=t(631),D=t(743),b=t(572);function m(Y,d){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const x=d.width,C=d.height;if(Y instanceof Float32Array){let d=Y.byteLength/Y.BYTES_PER_ELEMENT;const t=new Uint8Array(d);for(;--d>=0;){let x=Y[d];x<0?x=0:x>1&&(x=1),t[d]=255*x}Y=t}const U=document.createElement("canvas");U.width=x,U.height=C;const y=U.getContext("2d");if(!y)return null;const B=y.createImageData(x,C);if(B.data.set(Y),y.putImageData(B,0,0),t){const Y=document.createElement("canvas");Y.width=x,Y.height=C;const d=Y.getContext("2d");return d?(d.translate(0,C),d.scale(1,-1),d.drawImage(U,0,0),Y.toDataURL("image/png")):null}return U.toDataURL("image/png")}function M(Y){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const x=Y.getInternalTexture();if(!x)return null;const C=Y._readPixelsSync(d,t);return C?m(C,Y.getSize(),x.invertY):null}async function J(Y){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const x=Y.getInternalTexture();if(!x)return null;const C=await Y.readPixels(d,t);return C?m(C,Y.getSize(),x.invertY):null}var g=t(821),T=t(720);class s extends B.d{static _CreateVideoTexture(Y,d,t){arguments.length>5&&void 0!==arguments[5]||s.TRILINEAR_SAMPLINGMODE;throw(0,o.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(Y){this._isBlocking=Y}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(Y,d,t,x){let C,y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.TRILINEAR_SAMPLINGMODE,B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,W=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,F=arguments.length>8&&void 0!==arguments[8]&&arguments[8],D=arguments.length>9?arguments[9]:void 0,b=arguments.length>10?arguments[10]:void 0,m=arguments.length>11?arguments[11]:void 0,M=arguments.length>12?arguments[12]:void 0,J=arguments.length>13?arguments[13]:void 0;super(d),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new U.b,this._isBlocking=!0,this.name=Y||"",this.url=Y;let T=!1,l=null,h=!0;"object"===typeof t&&null!==t?(C=t.noMipmap??!1,x=t.invertY??!g.d,y=t.samplingMode??s.TRILINEAR_SAMPLINGMODE,B=t.X??null,W=t.onError??null,o=t.buffer??null,F=t.deleteBuffer??!1,D=t.format,b=t.mimeType,m=t.loaderOptions,M=t.creationFlags,T=t.useSRGBBuffer??!1,l=t.internalTexture??null,h=t.gammaSpace??h):C=!!t,this._gammaSpace=h,this._noMipmap=C,this._invertY=void 0===x?!g.d:x,this._initialSamplingMode=y,this._buffer=o,this._deleteBuffer=F,this._mimeType=b,this._loaderOptions=m,this._creationFlags=M,this._useSRGBBuffer=T,this._forcedExtension=J,D&&(this._format=D);const Z=this.va(),N=this._getEngine();if(!N)return;N.onBeforeTextureInitObservable.notifyObservers(this);const w=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),B&&B(),!this.isBlocking&&Z&&Z.resetCachedMaterial()},K=(Y,d)=>{this._loadingError=!0,this._errorObject={message:Y,exception:d},W&&W(Y,d),s.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!l)return this._delayedOnLoad=w,void(this._delayedOnError=K);if(this._texture=l??this._getFromCache(this.url,C,y,this._invertY,T,this.isCube),this._texture)if(this._texture.isReady)f.e.SetImmediate((()=>w()));else{const Y=this._texture.onLoadedObservable.add(w);this._texture.onErrorObservable.add((d=>{var t;K(d.message,d.exception),null===(t=this._texture)||void 0===t||t.onLoadedObservable.remove(Y)}))}else if(Z&&Z.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=w,this._delayedOnError=K;else{try{this._texture=N.createTexture(this.url,C,this._invertY,Z,y,w,K,this._buffer,void 0,this._format,this._forcedExtension,b,m,M,T)}catch(P){throw K("error loading",P),P}F&&(this._buffer=null)}}updateURL(Y){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2?arguments[2]:void 0,x=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=Y),this.url=Y,this._buffer=d,this._forcedExtension=x,this.delayLoadState=4,t&&(this._delayedOnLoad=t),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const Y=this.va();Y&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?f.e.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=Y.getEngine().createTexture(this.url,this._noMipmap,this._invertY,Y,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(Y,d,t,x){Y*=this._cachedUScale,d*=this._cachedVScale,Y-=this.uRotationCenter*this._cachedUScale,d-=this.vRotationCenter*this._cachedVScale,t-=this.wRotationCenter,y.k.TransformCoordinatesFromFloatsToRef(Y,d,t,this._rowGenerationMatrix,x),x.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,x.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,x.z+=this.wRotationCenter}getTextureMatrix(){let Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*Y===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*Y,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=y.b.Zero(),this._rowGenerationMatrix=new y.b,this._t0=y.k.Zero(),this._t1=y.k.Zero(),this._t2=y.k.Zero()),y.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(y.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,y.g.Matrix[0]),y.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,y.g.Matrix[1]),y.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,y.g.Matrix[2]),y.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,y.g.Matrix[3]),y.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(y.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(y.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(y.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.ik(this._t0),this._t2.ik(this._t0),y.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const d=this.va();if(!d)return this._cachedTextureMatrix;const t=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&t!==this._cachedIdentity3x2&&d.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const Y=this.va();if(!Y)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==s.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===Y.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=y.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=y.b.Zero());const d=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case s.PLANAR_MODE:y.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case s.PROJECTION_MODE:{y.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const d=Y.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=d.updateFlag,d.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:y.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return d&&Y.markAllMaterialsAsDirty(1,(Y=>Y.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const Y={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return T.e.Clone((()=>new s(this._texture?this._texture.url:null,this.va(),Y)),this)}serialize(){var Y;const d=this.name;s.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const t=super.serialize(s._SerializeInternalTextureUniqueId);if(!t)return null;var x;((s.SerializeBuffers||s.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(t.base64String=this._buffer,t.name=t.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?t.base64String="data:image/png;base64,"+(0,b.m)(this._buffer):(s.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(t.base64String=!this._engine||this._engine._features.supportSyncTextureRead?M(this):J(this))),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t._creationFlags=this._creationFlags,t._useSRGBBuffer=this._useSRGBBuffer,s._SerializeInternalTextureUniqueId)&&(t.internalTextureUniqueId=null===(x=this._texture)||void 0===x?void 0:x.uniqueId);return t.internalTextureLabel=null===(Y=this._texture)||void 0===Y?void 0:Y.label,t.noMipmap=this._noMipmap,this.name=d,t}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(Y,d,t){if(Y.customType){const x=F.e.Instantiate(Y.customType).Parse(Y,d,t);return Y.samplingMode&&x.updateSamplingMode&&x._samplingMode&&x._samplingMode!==Y.samplingMode&&x.updateSamplingMode(Y.samplingMode),x}if(Y.isCube&&!Y.isRenderTarget)return s._CubeTextureParser(Y,d,t);const x=void 0!==Y.internalTextureUniqueId;if(!Y.name&&!Y.isRenderTarget&&!x)return null;let C;if(x){const t=d.getEngine().getLoadedTexturesCache();for(const d of t)if(d.uniqueId===Y.internalTextureUniqueId){C=d;break}}const U=d=>{if(d&&d._texture&&(d._texture._cachedWrapU=null,d._texture._cachedWrapV=null,d._texture._cachedWrapR=null),Y.samplingMode){const t=Y.samplingMode;d&&d.samplingMode!==t&&d.updateSamplingMode(t)}if(d&&Y.animations)for(let t=0;t<Y.animations.length;t++){const x=Y.animations[t],C=(0,W.d)("BABYLON.Animation");C&&d.animations.push(C.Parse(x))}d&&d._texture&&(x&&!C&&d._texture._setUniqueId(Y.internalTextureUniqueId),d._texture.label=Y.internalTextureLabel)};return T.e.Parse((()=>{let x=!0;if(Y.noMipmap&&(x=!1),Y.mirrorPlane){const t=s._CreateMirror(Y.name,Y.renderTargetSize,d,x);return t._waitingRenderList=Y.renderList,t.mirrorPlane=D.d.ek(Y.mirrorPlane),U(t),t}if(Y.isRenderTarget){let t=null;if(Y.isCube){if(d.reflectionProbes)for(let x=0;x<d.reflectionProbes.length;x++){const t=d.reflectionProbes[x];if(t.name===Y.name)return t.cubeTexture}}else t=s._CreateRenderTargetTexture(Y.name,Y.renderTargetSize,d,x,Y._creationFlags??0),t._waitingRenderList=Y.renderList;return U(t),t}if(Y.isVideo){const C=s._CreateVideoTexture(t+(Y.url||Y.name),t+(Y.src||Y.url),d,x,Y.invertY,Y.samplingMode,Y.settings||{});return U(C),C}{let y;if(Y.base64String&&!C)y=s.CreateFromBase64String(Y.base64String,Y.base64String,d,!x,Y.invertY,Y.samplingMode,(()=>{U(y)}),Y._creationFlags??0,Y._useSRGBBuffer??!1),y.name=Y.name;else{let B;B=Y.name&&(Y.name.indexOf("://")>0||Y.name.startsWith("data:"))?Y.name:t+Y.name,Y.url&&(Y.url.startsWith("data:")||s.UseSerializedUrlIfAny)&&(B=Y.url);const W={noMipmap:!x,invertY:Y.invertY,samplingMode:Y.samplingMode,X:()=>{U(y)},internalTexture:C};y=new s(B,d,W)}return y}}),Y,d)}static CreateFromBase64String(Y,d,t,x,C){let U=arguments.length>5&&void 0!==arguments[5]?arguments[5]:s.TRILINEAR_SAMPLINGMODE;return new s("data:"+d,t,x,C,U,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Y,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(Y,d,t){let x=arguments.length>3&&void 0!==arguments[3]&&arguments[3],C=arguments.length>4?arguments[4]:void 0,U=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:s.TRILINEAR_SAMPLINGMODE,B=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,W=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,o=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,f=arguments.length>10?arguments[10]:void 0,F=arguments.length>11?arguments[11]:void 0;return"data:"!==Y.substring(0,5)&&(Y="data:"+Y),new s(Y,t,C,U,y,B,W,d,x,o,void 0,void 0,f,F)}}s.SerializeBuffers=!0,s.ForceSerializeBuffers=!1,s.OnTextureLoadErrorObservable=new U.b,s._SerializeInternalTextureUniqueId=!1,s._CubeTextureParser=(Y,d,t)=>{throw(0,o.c)("CubeTexture")},s._CreateMirror=(Y,d,t,x)=>{throw(0,o.c)("MirrorTexture")},s._CreateRenderTargetTexture=(Y,d,t,x,C)=>{throw(0,o.c)("RenderTargetTexture")},s.NEAREST_SAMPLINGMODE=1,s.NEAREST_NEAREST_MIPLINEAR=8,s.BILINEAR_SAMPLINGMODE=2,s.LINEAR_LINEAR_MIPNEAREST=11,s.TRILINEAR_SAMPLINGMODE=3,s.LINEAR_LINEAR_MIPLINEAR=3,s.NEAREST_NEAREST_MIPNEAREST=4,s.NEAREST_LINEAR_MIPNEAREST=5,s.NEAREST_LINEAR_MIPLINEAR=6,s.NEAREST_LINEAR=7,s.NEAREST_NEAREST=1,s.LINEAR_NEAREST_MIPNEAREST=9,s.LINEAR_NEAREST_MIPLINEAR=10,s.LINEAR_LINEAR=2,s.LINEAR_NEAREST=12,s.EXPLICIT_MODE=0,s.SPHERICAL_MODE=1,s.PLANAR_MODE=2,s.CUBIC_MODE=3,s.PROJECTION_MODE=4,s.SKYBOX_MODE=5,s.INVCUBIC_MODE=6,s.EQUIRECTANGULAR_MODE=7,s.FIXED_EQUIRECTANGULAR_MODE=8,s.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,s.CLAMP_ADDRESSMODE=0,s.WRAP_ADDRESSMODE=1,s.MIRROR_ADDRESSMODE=2,s.UseSerializedUrlIfAny=!1,(0,x.e)([(0,C.P)()],s.prototype,"url",void 0),(0,x.e)([(0,C.P)()],s.prototype,"uOffset",void 0),(0,x.e)([(0,C.P)()],s.prototype,"vOffset",void 0),(0,x.e)([(0,C.P)()],s.prototype,"uScale",void 0),(0,x.e)([(0,C.P)()],s.prototype,"vScale",void 0),(0,x.e)([(0,C.P)()],s.prototype,"uAng",void 0),(0,x.e)([(0,C.P)()],s.prototype,"vAng",void 0),(0,x.e)([(0,C.P)()],s.prototype,"wAng",void 0),(0,x.e)([(0,C.P)()],s.prototype,"uRotationCenter",void 0),(0,x.e)([(0,C.P)()],s.prototype,"vRotationCenter",void 0),(0,x.e)([(0,C.P)()],s.prototype,"wRotationCenter",void 0),(0,x.e)([(0,C.P)()],s.prototype,"homogeneousRotationInUVTransform",void 0),(0,x.e)([(0,C.P)()],s.prototype,"isBlocking",null),(0,W.f)("BABYLON.Texture",s),T.e._TextureParser=s.Parse},2055:(Y,d,t)=>{t.d(d,{d:()=>x});class x{constructor(Y,d){this.width=Y,this.height=d}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let Y=0|this.width;return Y=397*Y^this.height,Y}p(Y){this.width=Y.width,this.height=Y.height}md(Y,d){return this.width=Y,this.height=d,this}set(Y,d){return this.md(Y,d)}multiplyByFloats(Y,d){return new x(this.width*Y,this.height*d)}clone(){return new x(this.width,this.height)}equals(Y){return!!Y&&(this.width===Y.width&&this.height===Y.height)}get surface(){return this.width*this.height}static Zero(){return new x(0,0)}add(Y){return new x(this.width+Y.width,this.height+Y.height)}ae(Y){return new x(this.width-Y.width,this.height-Y.height)}scale(Y){return new x(this.width*Y,this.height*Y)}static Lerp(Y,d,t){const C=Y.width+(d.width-Y.width)*t,U=Y.height+(d.height-Y.height)*t;return new x(C,U)}}}}]);