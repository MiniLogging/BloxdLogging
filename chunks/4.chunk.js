"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2323:(f,z,w)=>{w.d(z,{b:()=>K});var S=w(692),C=w(699),E=w(527),F=w(720),J=w(580),x=w(668),u=(w(583),w(2302));class h{get wrapU(){return this._wrapU}set wrapU(f){this._wrapU=f}get wrapV(){return this._wrapV}set wrapV(f){this._wrapV=f}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(f){this._texture&&(this._texture.isCube=f)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(f){this._texture&&(this._texture.is3D=f)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(f){this._texture&&(this._texture.is2DArray=f)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(f){return void 0!==(null===f||void 0===f?void 0:f.shareDepth)}constructor(f){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=u.b.Zero(),this._cachedBaseSize=u.b.Zero(),this._initialSamplingMode=2,this._texture=h._IsRenderTargetWrapper(f)?f.texture:f,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(f){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(f,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var X=w(753);class K extends h{set xi(f){this._hasAlpha!==f&&(this._hasAlpha=f,this._scene&&this._scene.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))))}get xi(){return this._hasAlpha}set getAlphaFromRGB(f){this._getAlphaFromRGB!==f&&(this._getAlphaFromRGB=f,this._scene&&this._scene.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(f){this._coordinatesIndex!==f&&(this._coordinatesIndex=f,this._scene&&this._scene.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(f){this._coordinatesMode!==f&&(this._coordinatesMode=f,this._scene&&this._scene.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(f){this._wrapU=f}get wrapV(){return this._wrapV}set wrapV(f){this._wrapV=f}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(f){this._texture?this._texture.isCube=f:this._isCube=f}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(f){this._texture&&(this._texture.is3D=f)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(f){this._texture&&(this._texture.is2DArray=f)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(f){var z;if(this._texture){if(this._texture._gammaSpace===f)return;this._texture._gammaSpace=f}else{if(this._gammaSpace===f)return;this._gammaSpace=f}null===(z=this.va())||void 0===z||z.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(f){var z;f!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=f),null===(z=this.va())||void 0===z||z.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(f){this._texture&&(this._texture._lodGenerationOffset=f)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(f){this._texture&&(this._texture._lodGenerationScale=f)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(f){this._texture&&(this._texture._linearSpecularLOD=f)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(f){this._texture&&(this._texture._irradianceTexture=f)}get uid(){return this._uid||(this._uid=(0,x.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(f){this._onDisposeObserver&&this.ik.remove(this._onDisposeObserver),this._onDisposeObserver=this.ik.add(f)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(f){let z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=K.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.ik=new E.c,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,f?K._IsScene(f)?this._scene=f:this._engine=f:this._scene=J.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=z,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return F.b.IdentityReadOnly}getReflectionTextureMatrix(){return F.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(f){}get canRescale(){return!1}_getFromCache(f,z,w,S,C,E){const F=this._getEngine();if(!F)return null;const J=F._getUseSRGBBuffer(!!C,z),x=F.getLoadedTexturesCache();for(let u=0;u<x.length;u++){const F=x[u];if((void 0===C||J===F._useSRGBBuffer)&&(void 0===S||S===F.invertY)&&F.url===f&&F.generateMipMaps===!z&&(!w||w===F.samplingMode)&&(void 0===E||E===F.isCube))return F.incrementReferences(),F}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const f=this.va();f&&f.markAllMaterialsAsDirty(1)}readPixels(){let f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,S=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4],E=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,F=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,J=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,x=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const u=this._getEngine();if(!u)return null;const h=this.getSize();let X=h.width,K=h.height;0!==z&&(X/=Math.pow(2,z),K/=Math.pow(2,z),X=Math.round(X),K=Math.round(K)),J=Math.min(X,J),x=Math.min(K,x);try{return this._texture.isCube?u._readTexturePixels(this._texture,J,x,f,z,w,S,C,E,F):u._readTexturePixels(this._texture,J,x,-1,z,w,S,C,E,F)}catch(c){return null}}_readPixelsSync(){let f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,S=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const E=this.getSize();let F=E.width,J=E.height;const x=this._getEngine();if(!x)return null;0!=z&&(F/=Math.pow(2,z),J/=Math.pow(2,z),F=Math.round(F),J=Math.round(J));try{return this._texture.isCube?x._readTexturePixelsSync(this._texture,F,J,f,z,w,S,C):x._readTexturePixelsSync(this._texture,F,J,-1,z,w,S,C)}catch(u){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const f=this._scene.textures.indexOf(this);if(f>=0&&this._scene.textures.splice(f,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const f=this._parentContainer.textures.indexOf(this);f>-1&&this._parentContainer.textures.splice(f,1),this._parentContainer=null}}this.ik.notifyObservers(this),this.ik.clear(),this.metadata=null,super.dispose()}serialize(){let f=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!f)return null;const z=X.b.Serialize(this);return X.b.AppendSerializedAnimations(this,z),z}static WhenAllReady(f,z){let w=f.length;if(0!==w)for(let S=0;S<f.length;S++){const C=f[S];if(C.isReady())0===--w&&z();else{const f=C.onLoadObservable;f?f.addOnce((()=>{0===--w&&z()})):0===--w&&z()}}else z()}static _IsScene(f){return"Scene"===f.getClassName()}}K.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,S.b)([(0,C.O)()],K.prototype,"uniqueId",void 0),(0,S.b)([(0,C.O)()],K.prototype,"name",void 0),(0,S.b)([(0,C.O)()],K.prototype,"metadata",void 0),(0,S.b)([(0,C.O)("xi")],K.prototype,"_hasAlpha",void 0),(0,S.b)([(0,C.O)("getAlphaFromRGB")],K.prototype,"_getAlphaFromRGB",void 0),(0,S.b)([(0,C.O)()],K.prototype,"level",void 0),(0,S.b)([(0,C.O)("coordinatesIndex")],K.prototype,"_coordinatesIndex",void 0),(0,S.b)([(0,C.O)()],K.prototype,"optimizeUVAllocation",void 0),(0,S.b)([(0,C.O)("coordinatesMode")],K.prototype,"_coordinatesMode",void 0),(0,S.b)([(0,C.O)()],K.prototype,"wrapU",null),(0,S.b)([(0,C.O)()],K.prototype,"wrapV",null),(0,S.b)([(0,C.O)()],K.prototype,"wrapR",void 0),(0,S.b)([(0,C.O)()],K.prototype,"anisotropicFilteringLevel",void 0),(0,S.b)([(0,C.O)()],K.prototype,"isCube",null),(0,S.b)([(0,C.O)()],K.prototype,"is3D",null),(0,S.b)([(0,C.O)()],K.prototype,"is2DArray",null),(0,S.b)([(0,C.O)()],K.prototype,"gammaSpace",null),(0,S.b)([(0,C.O)()],K.prototype,"invertZ",void 0),(0,S.b)([(0,C.O)()],K.prototype,"lodLevelInAlpha",void 0),(0,S.b)([(0,C.O)()],K.prototype,"lodGenerationOffset",null),(0,S.b)([(0,C.O)()],K.prototype,"lodGenerationScale",null),(0,S.b)([(0,C.O)()],K.prototype,"linearSpecularLOD",null),(0,S.b)([(0,C.H)()],K.prototype,"irradianceTexture",null),(0,S.b)([(0,C.O)()],K.prototype,"isRenderTarget",void 0)},2321:(f,z,w)=>{w.d(z,{b:()=>V});var S=w(692),C=w(699),E=w(527),F=w(720),J=w(2323),x=w(665),u=w(568),h=w(613),X=w(663),K=w(782),c=w(592);function y(f,z){let w=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const S=z.width,C=z.height;if(f instanceof Float32Array){let z=f.byteLength/f.BYTES_PER_ELEMENT;const w=new Uint8Array(z);for(;--z>=0;){let S=f[z];S<0?S=0:S>1&&(S=1),w[z]=255*S}f=w}const E=document.createElement("canvas");E.width=S,E.height=C;const F=E.getContext("2d");if(!F)return null;const J=F.createImageData(S,C);if(J.data.set(f),F.putImageData(J,0,0),w){const f=document.createElement("canvas");f.width=S,f.height=C;const z=f.getContext("2d");return z?(z.translate(0,C),z.scale(1,-1),z.drawImage(E,0,0),f.toDataURL("image/png")):null}return E.toDataURL("image/png")}function e(f){let z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const S=f.getInternalTexture();if(!S)return null;const C=f._readPixelsSync(z,w);return C?y(C,f.getSize(),S.invertY):null}async function O(f){let z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const S=f.getInternalTexture();if(!S)return null;const C=await f.readPixels(z,w);return C?y(C,f.getSize(),S.invertY):null}var d=w(848),B=w(753);class V extends J.b{static _CreateVideoTexture(f,z,w){arguments.length>5&&void 0!==arguments[5]||V.TRILINEAR_SAMPLINGMODE;throw(0,u.d)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(f){this._isBlocking=f}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(f,z,w,S){let C,F=arguments.length>4&&void 0!==arguments[4]?arguments[4]:V.TRILINEAR_SAMPLINGMODE,J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,x=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,X=arguments.length>8&&void 0!==arguments[8]&&arguments[8],K=arguments.length>9?arguments[9]:void 0,c=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0,e=arguments.length>12?arguments[12]:void 0,O=arguments.length>13?arguments[13]:void 0;super(z),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new E.c,this._isBlocking=!0,this.name=f||"",this.url=f;let B=!1,W=null,T=!0;"object"===typeof w&&null!==w?(C=w.noMipmap??!1,S=w.invertY??!d.c,F=w.samplingMode??V.TRILINEAR_SAMPLINGMODE,J=w.X??null,x=w.onError??null,u=w.buffer??null,X=w.deleteBuffer??!1,K=w.format,c=w.mimeType,y=w.loaderOptions,e=w.creationFlags,B=w.useSRGBBuffer??!1,W=w.internalTexture??null,T=w.gammaSpace??T):C=!!w,this._gammaSpace=T,this._noMipmap=C,this._invertY=void 0===S?!d.c:S,this._initialSamplingMode=F,this._buffer=u,this._deleteBuffer=X,this._mimeType=c,this._loaderOptions=y,this._creationFlags=e,this._useSRGBBuffer=B,this._forcedExtension=O,K&&(this._format=K);const v=this.va(),D=this._getEngine();if(!D)return;D.onBeforeTextureInitObservable.notifyObservers(this);const A=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),J&&J(),!this.isBlocking&&v&&v.resetCachedMaterial()},M=(f,z)=>{this._loadingError=!0,this._errorObject={message:f,exception:z},x&&x(f,z),V.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!W)return this._delayedOnLoad=A,void(this._delayedOnError=M);if(this._texture=W??this._getFromCache(this.url,C,F,this._invertY,B,this.isCube),this._texture)if(this._texture.isReady)h.d.SetImmediate((()=>A()));else{const f=this._texture.onLoadedObservable.add(A);this._texture.onErrorObservable.add((z=>{var w;M(z.message,z.exception),null===(w=this._texture)||void 0===w||w.onLoadedObservable.remove(f)}))}else if(v&&v.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=A,this._delayedOnError=M;else{try{this._texture=D.createTexture(this.url,C,this._invertY,v,F,A,M,this._buffer,void 0,this._format,this._forcedExtension,c,y,e,B)}catch(G){throw M("error loading",G),G}X&&(this._buffer=null)}}updateURL(f){let z=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,w=arguments.length>2?arguments[2]:void 0,S=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(f=>f.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=f),this.url=f,this._buffer=z,this._forcedExtension=S,this.delayLoadState=4,w&&(this._delayedOnLoad=w),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const f=this.va();f&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?h.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=f.getEngine().createTexture(this.url,this._noMipmap,this._invertY,f,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(f,z,w,S){f*=this._cachedUScale,z*=this._cachedVScale,f-=this.uRotationCenter*this._cachedUScale,z-=this.vRotationCenter*this._cachedVScale,w-=this.wRotationCenter,F.n.TransformCoordinatesFromFloatsToRef(f,z,w,this._rowGenerationMatrix,S),S.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,S.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,S.z+=this.wRotationCenter}getTextureMatrix(){let f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*f===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*f,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=F.b.Zero(),this._rowGenerationMatrix=new F.b,this._t0=F.n.Zero(),this._t1=F.n.Zero(),this._t2=F.n.Zero()),F.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(F.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,F.j.Matrix[0]),F.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,F.j.Matrix[1]),F.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,F.j.Matrix[2]),F.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,F.j.Matrix[3]),F.j.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(F.j.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(F.j.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(F.j.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.fk(this._t0),this._t2.fk(this._t0),F.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const z=this.va();if(!z)return this._cachedTextureMatrix;const w=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&w!==this._cachedIdentity3x2&&z.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const f=this.va();if(!f)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==V.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===f.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=F.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=F.b.Zero());const z=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case V.PLANAR_MODE:F.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case V.PROJECTION_MODE:{F.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const z=f.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=z.updateFlag,z.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:F.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return z&&f.markAllMaterialsAsDirty(1,(f=>f.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const f={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return B.b.Clone((()=>new V(this._texture?this._texture.url:null,this.va(),f)),this)}serialize(){var f;const z=this.name;V.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const w=super.serialize(V._SerializeInternalTextureUniqueId);if(!w)return null;var S;((V.SerializeBuffers||V.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(w.base64String=this._buffer,w.name=w.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?w.base64String="data:image/png;base64,"+(0,c.j)(this._buffer):(V.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(w.base64String=!this._engine||this._engine._features.supportSyncTextureRead?e(this):O(this))),w.invertY=this._invertY,w.samplingMode=this.samplingMode,w._creationFlags=this._creationFlags,w._useSRGBBuffer=this._useSRGBBuffer,V._SerializeInternalTextureUniqueId)&&(w.internalTextureUniqueId=null===(S=this._texture)||void 0===S?void 0:S.uniqueId);return w.internalTextureLabel=null===(f=this._texture)||void 0===f?void 0:f.label,w.noMipmap=this._noMipmap,this.name=z,w}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(f,z,w){if(f.customType){const S=X.d.Instantiate(f.customType).Parse(f,z,w);return f.samplingMode&&S.updateSamplingMode&&S._samplingMode&&S._samplingMode!==f.samplingMode&&S.updateSamplingMode(f.samplingMode),S}if(f.isCube&&!f.isRenderTarget)return V._CubeTextureParser(f,z,w);const S=void 0!==f.internalTextureUniqueId;if(!f.name&&!f.isRenderTarget&&!S)return null;let C;if(S){const w=z.getEngine().getLoadedTexturesCache();for(const z of w)if(z.uniqueId===f.internalTextureUniqueId){C=z;break}}const E=z=>{if(z&&z._texture&&(z._texture._cachedWrapU=null,z._texture._cachedWrapV=null,z._texture._cachedWrapR=null),f.samplingMode){const w=f.samplingMode;z&&z.samplingMode!==w&&z.updateSamplingMode(w)}if(z&&f.animations)for(let w=0;w<f.animations.length;w++){const S=f.animations[w],C=(0,x.b)("BABYLON.Animation");C&&z.animations.push(C.Parse(S))}z&&z._texture&&(S&&!C&&z._texture._setUniqueId(f.internalTextureUniqueId),z._texture.label=f.internalTextureLabel)};return B.b.Parse((()=>{let S=!0;if(f.noMipmap&&(S=!1),f.mirrorPlane){const w=V._CreateMirror(f.name,f.renderTargetSize,z,S);return w._waitingRenderList=f.renderList,w.mirrorPlane=K.e.ck(f.mirrorPlane),E(w),w}if(f.isRenderTarget){let w=null;if(f.isCube){if(z.reflectionProbes)for(let S=0;S<z.reflectionProbes.length;S++){const w=z.reflectionProbes[S];if(w.name===f.name)return w.cubeTexture}}else w=V._CreateRenderTargetTexture(f.name,f.renderTargetSize,z,S,f._creationFlags??0),w._waitingRenderList=f.renderList;return E(w),w}if(f.isVideo){const C=V._CreateVideoTexture(w+(f.url||f.name),w+(f.src||f.url),z,S,f.invertY,f.samplingMode,f.settings||{});return E(C),C}{let F;if(f.base64String&&!C)F=V.CreateFromBase64String(f.base64String,f.base64String,z,!S,f.invertY,f.samplingMode,(()=>{E(F)}),f._creationFlags??0,f._useSRGBBuffer??!1),F.name=f.name;else{let J;J=f.name&&(f.name.indexOf("://")>0||f.name.startsWith("data:"))?f.name:w+f.name,f.url&&(f.url.startsWith("data:")||V.UseSerializedUrlIfAny)&&(J=f.url);const x={noMipmap:!S,invertY:f.invertY,samplingMode:f.samplingMode,X:()=>{E(F)},internalTexture:C};F=new V(J,z,x)}return F}}),f,z)}static CreateFromBase64String(f,z,w,S,C){let E=arguments.length>5&&void 0!==arguments[5]?arguments[5]:V.TRILINEAR_SAMPLINGMODE;return new V("data:"+z,w,S,C,E,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,f,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(f,z,w){let S=arguments.length>3&&void 0!==arguments[3]&&arguments[3],C=arguments.length>4?arguments[4]:void 0,E=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],F=arguments.length>6&&void 0!==arguments[6]?arguments[6]:V.TRILINEAR_SAMPLINGMODE,J=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,x=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,h=arguments.length>10?arguments[10]:void 0,X=arguments.length>11?arguments[11]:void 0;return"data:"!==f.substring(0,5)&&(f="data:"+f),new V(f,w,C,E,F,J,x,z,S,u,void 0,void 0,h,X)}}V.SerializeBuffers=!0,V.ForceSerializeBuffers=!1,V.OnTextureLoadErrorObservable=new E.c,V._SerializeInternalTextureUniqueId=!1,V._CubeTextureParser=(f,z,w)=>{throw(0,u.d)("CubeTexture")},V._CreateMirror=(f,z,w,S)=>{throw(0,u.d)("MirrorTexture")},V._CreateRenderTargetTexture=(f,z,w,S,C)=>{throw(0,u.d)("RenderTargetTexture")},V.NEAREST_SAMPLINGMODE=1,V.NEAREST_NEAREST_MIPLINEAR=8,V.BILINEAR_SAMPLINGMODE=2,V.LINEAR_LINEAR_MIPNEAREST=11,V.TRILINEAR_SAMPLINGMODE=3,V.LINEAR_LINEAR_MIPLINEAR=3,V.NEAREST_NEAREST_MIPNEAREST=4,V.NEAREST_LINEAR_MIPNEAREST=5,V.NEAREST_LINEAR_MIPLINEAR=6,V.NEAREST_LINEAR=7,V.NEAREST_NEAREST=1,V.LINEAR_NEAREST_MIPNEAREST=9,V.LINEAR_NEAREST_MIPLINEAR=10,V.LINEAR_LINEAR=2,V.LINEAR_NEAREST=12,V.EXPLICIT_MODE=0,V.SPHERICAL_MODE=1,V.PLANAR_MODE=2,V.CUBIC_MODE=3,V.PROJECTION_MODE=4,V.SKYBOX_MODE=5,V.INVCUBIC_MODE=6,V.EQUIRECTANGULAR_MODE=7,V.FIXED_EQUIRECTANGULAR_MODE=8,V.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,V.CLAMP_ADDRESSMODE=0,V.WRAP_ADDRESSMODE=1,V.MIRROR_ADDRESSMODE=2,V.UseSerializedUrlIfAny=!1,(0,S.b)([(0,C.O)()],V.prototype,"url",void 0),(0,S.b)([(0,C.O)()],V.prototype,"uOffset",void 0),(0,S.b)([(0,C.O)()],V.prototype,"vOffset",void 0),(0,S.b)([(0,C.O)()],V.prototype,"uScale",void 0),(0,S.b)([(0,C.O)()],V.prototype,"vScale",void 0),(0,S.b)([(0,C.O)()],V.prototype,"uAng",void 0),(0,S.b)([(0,C.O)()],V.prototype,"vAng",void 0),(0,S.b)([(0,C.O)()],V.prototype,"wAng",void 0),(0,S.b)([(0,C.O)()],V.prototype,"uRotationCenter",void 0),(0,S.b)([(0,C.O)()],V.prototype,"vRotationCenter",void 0),(0,S.b)([(0,C.O)()],V.prototype,"wRotationCenter",void 0),(0,S.b)([(0,C.O)()],V.prototype,"homogeneousRotationInUVTransform",void 0),(0,S.b)([(0,C.O)()],V.prototype,"isBlocking",null),(0,x.f)("BABYLON.Texture",V),B.b._TextureParser=V.Parse},2302:(f,z,w)=>{w.d(z,{b:()=>S});class S{constructor(f,z){this.width=f,this.height=z}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let f=0|this.width;return f=397*f^this.height,f}p(f){this.width=f.width,this.height=f.height}Gd(f,z){return this.width=f,this.height=z,this}set(f,z){return this.Gd(f,z)}multiplyByFloats(f,z){return new S(this.width*f,this.height*z)}clone(){return new S(this.width,this.height)}equals(f){return!!f&&(this.width===f.width&&this.height===f.height)}get surface(){return this.width*this.height}static Zero(){return new S(0,0)}add(f){return new S(this.width+f.width,this.height+f.height)}te(f){return new S(this.width-f.width,this.height-f.height)}scale(f){return new S(this.width*f,this.height*f)}static Lerp(f,z,w){const C=f.width+(z.width-f.width)*w,E=f.height+(z.height-f.height)*w;return new S(C,E)}}}}]);