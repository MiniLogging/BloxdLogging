"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[4],{2039:(B,o,e)=>{e.d(o,{c:()=>w});var k=e(665),d=e(672),f=e(497),J=e(690),Z=e(539),t=e(640),h=(e(541),e(2006));class O{get wrapU(){return this._wrapU}set wrapU(B){this._wrapU=B}get wrapV(){return this._wrapV}set wrapV(B){this._wrapV=B}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(B){this._texture&&(this._texture.isCube=B)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(B){this._texture&&(this._texture.is3D=B)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(B){this._texture&&(this._texture.is2DArray=B)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(B){return void 0!==(null===B||void 0===B?void 0:B.shareDepth)}constructor(B){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=h.c.Zero(),this._cachedBaseSize=h.c.Zero(),this._initialSamplingMode=2,this._texture=O._IsRenderTargetWrapper(B)?B.texture:B,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(B){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(B,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var K=e(712);class w extends O{set zj(B){this._hasAlpha!==B&&(this._hasAlpha=B,this._scene&&this._scene.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))))}get zj(){return this._hasAlpha}set getAlphaFromRGB(B){this._getAlphaFromRGB!==B&&(this._getAlphaFromRGB=B,this._scene&&this._scene.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(B){this._coordinatesIndex!==B&&(this._coordinatesIndex=B,this._scene&&this._scene.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(B){this._coordinatesMode!==B&&(this._coordinatesMode=B,this._scene&&this._scene.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(B){this._wrapU=B}get wrapV(){return this._wrapV}set wrapV(B){this._wrapV=B}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(B){this._texture?this._texture.isCube=B:this._isCube=B}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(B){this._texture&&(this._texture.is3D=B)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(B){this._texture&&(this._texture.is2DArray=B)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(B){var o;if(this._texture){if(this._texture._gammaSpace===B)return;this._texture._gammaSpace=B}else{if(this._gammaSpace===B)return;this._gammaSpace=B}null===(o=this.va())||void 0===o||o.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(B){var o;B!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=B),null===(o=this.va())||void 0===o||o.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(B){this._texture&&(this._texture._lodGenerationOffset=B)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(B){this._texture&&(this._texture._lodGenerationScale=B)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(B){this._texture&&(this._texture._linearSpecularLOD=B)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(B){this._texture&&(this._texture._irradianceTexture=B)}get uid(){return this._uid||(this._uid=(0,t.b)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(B){this._onDisposeObserver&&this.Ei.remove(this._onDisposeObserver),this._onDisposeObserver=this.Ei.add(B)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(B){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=w.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Ei=new f.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,B?w._IsScene(B)?this._scene=B:this._engine=B:this._scene=Z.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=o,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return J.d.IdentityReadOnly}getReflectionTextureMatrix(){return J.d.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(B){}get canRescale(){return!1}_getFromCache(B,o,e,k,d,f){const J=this._getEngine();if(!J)return null;const Z=J._getUseSRGBBuffer(!!d,o),t=J.getLoadedTexturesCache();for(let h=0;h<t.length;h++){const J=t[h];if((void 0===d||Z===J._useSRGBBuffer)&&(void 0===k||k===J.invertY)&&J.url===B&&J.generateMipMaps===!o&&(!e||e===J.samplingMode)&&(void 0===f||f===J.isCube))return J.incrementReferences(),J}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const B=this.va();B&&B.markAllMaterialsAsDirty(1)}readPixels(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,k=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],d=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,J=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,Z=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const h=this._getEngine();if(!h)return null;const O=this.getSize();let K=O.width,w=O.height;0!==o&&(K/=Math.pow(2,o),w/=Math.pow(2,o),K=Math.round(K),w=Math.round(w)),Z=Math.min(K,Z),t=Math.min(w,t);try{return this._texture.isCube?h._readTexturePixels(this._texture,Z,t,B,o,e,k,d,f,J):h._readTexturePixels(this._texture,Z,t,-1,o,e,k,d,f,J)}catch(u){return null}}_readPixelsSync(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,k=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],d=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const f=this.getSize();let J=f.width,Z=f.height;const t=this._getEngine();if(!t)return null;0!=o&&(J/=Math.pow(2,o),Z/=Math.pow(2,o),J=Math.round(J),Z=Math.round(Z));try{return this._texture.isCube?t._readTexturePixelsSync(this._texture,J,Z,B,o,e,k,d):t._readTexturePixelsSync(this._texture,J,Z,-1,o,e,k,d)}catch(h){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const B=this._scene.textures.indexOf(this);if(B>=0&&this._scene.textures.splice(B,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const B=this._parentContainer.textures.indexOf(this);B>-1&&this._parentContainer.textures.splice(B,1),this._parentContainer=null}}this.Ei.notifyObservers(this),this.Ei.clear(),this.metadata=null,super.dispose()}serialize(){let B=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!B)return null;const o=K.d.Serialize(this);return K.d.AppendSerializedAnimations(this,o),o}static WhenAllReady(B,o){let e=B.length;if(0!==e)for(let k=0;k<B.length;k++){const d=B[k];if(d.isReady())0===--e&&o();else{const B=d.onLoadObservable;B?B.addOnce((()=>{0===--e&&o()})):0===--e&&o()}}else o()}static _IsScene(B){return"Scene"===B.getClassName()}}w.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,k.b)([(0,d.C)()],w.prototype,"uniqueId",void 0),(0,k.b)([(0,d.C)()],w.prototype,"name",void 0),(0,k.b)([(0,d.C)()],w.prototype,"metadata",void 0),(0,k.b)([(0,d.C)("zj")],w.prototype,"_hasAlpha",void 0),(0,k.b)([(0,d.C)("getAlphaFromRGB")],w.prototype,"_getAlphaFromRGB",void 0),(0,k.b)([(0,d.C)()],w.prototype,"level",void 0),(0,k.b)([(0,d.C)("coordinatesIndex")],w.prototype,"_coordinatesIndex",void 0),(0,k.b)([(0,d.C)()],w.prototype,"optimizeUVAllocation",void 0),(0,k.b)([(0,d.C)("coordinatesMode")],w.prototype,"_coordinatesMode",void 0),(0,k.b)([(0,d.C)()],w.prototype,"wrapU",null),(0,k.b)([(0,d.C)()],w.prototype,"wrapV",null),(0,k.b)([(0,d.C)()],w.prototype,"wrapR",void 0),(0,k.b)([(0,d.C)()],w.prototype,"anisotropicFilteringLevel",void 0),(0,k.b)([(0,d.C)()],w.prototype,"isCube",null),(0,k.b)([(0,d.C)()],w.prototype,"is3D",null),(0,k.b)([(0,d.C)()],w.prototype,"is2DArray",null),(0,k.b)([(0,d.C)()],w.prototype,"gammaSpace",null),(0,k.b)([(0,d.C)()],w.prototype,"invertZ",void 0),(0,k.b)([(0,d.C)()],w.prototype,"lodLevelInAlpha",void 0),(0,k.b)([(0,d.C)()],w.prototype,"lodGenerationOffset",null),(0,k.b)([(0,d.C)()],w.prototype,"lodGenerationScale",null),(0,k.b)([(0,d.C)()],w.prototype,"linearSpecularLOD",null),(0,k.b)([(0,d.y)()],w.prototype,"irradianceTexture",null),(0,k.b)([(0,d.C)()],w.prototype,"isRenderTarget",void 0)},2033:(B,o,e)=>{e.d(o,{d:()=>I});var k=e(665),d=e(672),f=e(497),J=e(690),Z=e(2039),t=e(635),h=e(531),O=e(566),K=e(628),w=e(735),u=e(550);function L(B,o){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const k=o.width,d=o.height;if(B instanceof Float32Array){let o=B.byteLength/B.BYTES_PER_ELEMENT;const e=new Uint8Array(o);for(;--o>=0;){let k=B[o];k<0?k=0:k>1&&(k=1),e[o]=255*k}B=e}const f=document.createElement("canvas");f.width=k,f.height=d;const J=f.getContext("2d");if(!J)return null;const Z=J.createImageData(k,d);if(Z.data.set(B),J.putImageData(Z,0,0),e){const B=document.createElement("canvas");B.width=k,B.height=d;const o=B.getContext("2d");return o?(o.translate(0,d),o.scale(1,-1),o.drawImage(f,0,0),B.toDataURL("image/png")):null}return f.toDataURL("image/png")}function H(B){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const k=B.getInternalTexture();if(!k)return null;const d=B._readPixelsSync(o,e);return d?L(d,B.getSize(),k.invertY):null}async function n(B){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const k=B.getInternalTexture();if(!k)return null;const d=await B.readPixels(o,e);return d?L(d,B.getSize(),k.invertY):null}var W=e(804),R=e(712);class I extends Z.c{static _CreateVideoTexture(B,o,e){arguments.length>5&&void 0!==arguments[5]||I.TRILINEAR_SAMPLINGMODE;throw(0,h.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(B){this._isBlocking=B}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(B,o,e,k){let d,J=arguments.length>4&&void 0!==arguments[4]?arguments[4]:I.TRILINEAR_SAMPLINGMODE,Z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,t=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,K=arguments.length>8&&void 0!==arguments[8]&&arguments[8],w=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,L=arguments.length>11?arguments[11]:void 0,H=arguments.length>12?arguments[12]:void 0,n=arguments.length>13?arguments[13]:void 0;super(o),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new f.e,this._isBlocking=!0,this.name=B||"",this.url=B;let R=!1,T=null,s=!0;"object"===typeof e&&null!==e?(d=e.noMipmap??!1,k=e.invertY??!W.e,J=e.samplingMode??I.TRILINEAR_SAMPLINGMODE,Z=e.X??null,t=e.onError??null,h=e.buffer??null,K=e.deleteBuffer??!1,w=e.format,u=e.mimeType,L=e.loaderOptions,H=e.creationFlags,R=e.useSRGBBuffer??!1,T=e.internalTexture??null,s=e.gammaSpace??s):d=!!e,this._gammaSpace=s,this._noMipmap=d,this._invertY=void 0===k?!W.e:k,this._initialSamplingMode=J,this._buffer=h,this._deleteBuffer=K,this._mimeType=u,this._loaderOptions=L,this._creationFlags=H,this._useSRGBBuffer=R,this._forcedExtension=n,w&&(this._format=w);const V=this.va(),Q=this._getEngine();if(!Q)return;Q.onBeforeTextureInitObservable.notifyObservers(this);const p=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),Z&&Z(),!this.isBlocking&&V&&V.resetCachedMaterial()},X=(B,o)=>{this._loadingError=!0,this._errorObject={message:B,exception:o},t&&t(B,o),I.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!T)return this._delayedOnLoad=p,void(this._delayedOnError=X);if(this._texture=T??this._getFromCache(this.url,d,J,this._invertY,R,this.isCube),this._texture)if(this._texture.isReady)O.d.SetImmediate((()=>p()));else{const B=this._texture.onLoadedObservable.add(p);this._texture.onErrorObservable.add((o=>{var e;X(o.message,o.exception),null===(e=this._texture)||void 0===e||e.onLoadedObservable.remove(B)}))}else if(V&&V.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=p,this._delayedOnError=X;else{try{this._texture=Q.createTexture(this.url,d,this._invertY,V,J,p,X,this._buffer,void 0,this._format,this._forcedExtension,u,L,H,R)}catch(l){throw X("error loading",l),l}K&&(this._buffer=null)}}updateURL(B){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2?arguments[2]:void 0,k=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(B=>B.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=B),this.url=B,this._buffer=o,this._forcedExtension=k,this.delayLoadState=4,e&&(this._delayedOnLoad=e),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const B=this.va();B&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?O.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=B.getEngine().createTexture(this.url,this._noMipmap,this._invertY,B,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(B,o,e,k){B*=this._cachedUScale,o*=this._cachedVScale,B-=this.uRotationCenter*this._cachedUScale,o-=this.vRotationCenter*this._cachedVScale,e-=this.wRotationCenter,J.o.TransformCoordinatesFromFloatsToRef(B,o,e,this._rowGenerationMatrix,k),k.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,k.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,k.z+=this.wRotationCenter}getTextureMatrix(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*B===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*B,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=J.d.Zero(),this._rowGenerationMatrix=new J.d,this._t0=J.o.Zero(),this._t1=J.o.Zero(),this._t2=J.o.Zero()),J.d.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(J.d.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,J.j.Matrix[0]),J.d.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,J.j.Matrix[1]),J.d.ScalingToRef(this._cachedUScale,this._cachedVScale,0,J.j.Matrix[2]),J.d.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,J.j.Matrix[3]),J.j.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(J.j.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(J.j.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(J.j.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Mi(this._t0),this._t2.Mi(this._t0),J.d.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const o=this.va();if(!o)return this._cachedTextureMatrix;const e=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&e!==this._cachedIdentity3x2&&o.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const B=this.va();if(!B)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==I.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===B.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=J.d.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=J.d.Zero());const o=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case I.PLANAR_MODE:J.d.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case I.PROJECTION_MODE:{J.d.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const o=B.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=o.updateFlag,o.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:J.d.IdentityToRef(this._cachedReflectionTextureMatrix)}return o&&B.markAllMaterialsAsDirty(1,(B=>B.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const B={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return R.d.Clone((()=>new I(this._texture?this._texture.url:null,this.va(),B)),this)}serialize(){var B;const o=this.name;I.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const e=super.serialize(I._SerializeInternalTextureUniqueId);if(!e)return null;var k;((I.SerializeBuffers||I.ForceSerializeBuffers)&&("string"===typeof this._buffer&&"data:"===this._buffer.substring(0,5)?(e.base64String=this._buffer,e.name=e.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?e.base64String="data:image/png;base64,"+(0,u.l)(this._buffer):(I.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(e.base64String=!this._engine||this._engine._features.supportSyncTextureRead?H(this):n(this))),e.invertY=this._invertY,e.samplingMode=this.samplingMode,e._creationFlags=this._creationFlags,e._useSRGBBuffer=this._useSRGBBuffer,I._SerializeInternalTextureUniqueId)&&(e.internalTextureUniqueId=null===(k=this._texture)||void 0===k?void 0:k.uniqueId);return e.internalTextureLabel=null===(B=this._texture)||void 0===B?void 0:B.label,e.noMipmap=this._noMipmap,this.name=o,e}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(B,o,e){if(B.customType){const k=K.b.Instantiate(B.customType).Parse(B,o,e);return B.samplingMode&&k.updateSamplingMode&&k._samplingMode&&k._samplingMode!==B.samplingMode&&k.updateSamplingMode(B.samplingMode),k}if(B.isCube&&!B.isRenderTarget)return I._CubeTextureParser(B,o,e);const k=void 0!==B.internalTextureUniqueId;if(!B.name&&!B.isRenderTarget&&!k)return null;let d;if(k){const e=o.getEngine().getLoadedTexturesCache();for(const o of e)if(o.uniqueId===B.internalTextureUniqueId){d=o;break}}const f=o=>{if(o&&o._texture&&(o._texture._cachedWrapU=null,o._texture._cachedWrapV=null,o._texture._cachedWrapR=null),B.samplingMode){const e=B.samplingMode;o&&o.samplingMode!==e&&o.updateSamplingMode(e)}if(o&&B.animations)for(let e=0;e<B.animations.length;e++){const k=B.animations[e],d=(0,t.b)("BABYLON.Animation");d&&o.animations.push(d.Parse(k))}o&&o._texture&&(k&&!d&&o._texture._setUniqueId(B.internalTextureUniqueId),o._texture.label=B.internalTextureLabel)};return R.d.Parse((()=>{let k=!0;if(B.noMipmap&&(k=!1),B.mirrorPlane){const e=I._CreateMirror(B.name,B.renderTargetSize,o,k);return e._waitingRenderList=B.renderList,e.mirrorPlane=w.e.ui(B.mirrorPlane),f(e),e}if(B.isRenderTarget){let e=null;if(B.isCube){if(o.reflectionProbes)for(let k=0;k<o.reflectionProbes.length;k++){const e=o.reflectionProbes[k];if(e.name===B.name)return e.cubeTexture}}else e=I._CreateRenderTargetTexture(B.name,B.renderTargetSize,o,k,B._creationFlags??0),e._waitingRenderList=B.renderList;return f(e),e}if(B.isVideo){const d=I._CreateVideoTexture(e+(B.url||B.name),e+(B.src||B.url),o,k,B.invertY,B.samplingMode,B.settings||{});return f(d),d}{let J;if(B.base64String&&!d)J=I.CreateFromBase64String(B.base64String,B.base64String,o,!k,B.invertY,B.samplingMode,(()=>{f(J)}),B._creationFlags??0,B._useSRGBBuffer??!1),J.name=B.name;else{let Z;Z=B.name&&(B.name.indexOf("://")>0||B.name.startsWith("data:"))?B.name:e+B.name,B.url&&(B.url.startsWith("data:")||I.UseSerializedUrlIfAny)&&(Z=B.url);const t={noMipmap:!k,invertY:B.invertY,samplingMode:B.samplingMode,X:()=>{f(J)},internalTexture:d};J=new I(Z,o,t)}return J}}),B,o)}static CreateFromBase64String(B,o,e,k,d){let f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:I.TRILINEAR_SAMPLINGMODE;return new I("data:"+o,e,k,d,f,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,B,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(B,o,e){let k=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=arguments.length>4?arguments[4]:void 0,f=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],J=arguments.length>6&&void 0!==arguments[6]?arguments[6]:I.TRILINEAR_SAMPLINGMODE,Z=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,O=arguments.length>10?arguments[10]:void 0,K=arguments.length>11?arguments[11]:void 0;return"data:"!==B.substring(0,5)&&(B="data:"+B),new I(B,e,d,f,J,Z,t,o,k,h,void 0,void 0,O,K)}}I.SerializeBuffers=!0,I.ForceSerializeBuffers=!1,I.OnTextureLoadErrorObservable=new f.e,I._SerializeInternalTextureUniqueId=!1,I._CubeTextureParser=(B,o,e)=>{throw(0,h.c)("CubeTexture")},I._CreateMirror=(B,o,e,k)=>{throw(0,h.c)("MirrorTexture")},I._CreateRenderTargetTexture=(B,o,e,k,d)=>{throw(0,h.c)("RenderTargetTexture")},I.NEAREST_SAMPLINGMODE=1,I.NEAREST_NEAREST_MIPLINEAR=8,I.BILINEAR_SAMPLINGMODE=2,I.LINEAR_LINEAR_MIPNEAREST=11,I.TRILINEAR_SAMPLINGMODE=3,I.LINEAR_LINEAR_MIPLINEAR=3,I.NEAREST_NEAREST_MIPNEAREST=4,I.NEAREST_LINEAR_MIPNEAREST=5,I.NEAREST_LINEAR_MIPLINEAR=6,I.NEAREST_LINEAR=7,I.NEAREST_NEAREST=1,I.LINEAR_NEAREST_MIPNEAREST=9,I.LINEAR_NEAREST_MIPLINEAR=10,I.LINEAR_LINEAR=2,I.LINEAR_NEAREST=12,I.EXPLICIT_MODE=0,I.SPHERICAL_MODE=1,I.PLANAR_MODE=2,I.CUBIC_MODE=3,I.PROJECTION_MODE=4,I.SKYBOX_MODE=5,I.INVCUBIC_MODE=6,I.EQUIRECTANGULAR_MODE=7,I.FIXED_EQUIRECTANGULAR_MODE=8,I.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,I.CLAMP_ADDRESSMODE=0,I.WRAP_ADDRESSMODE=1,I.MIRROR_ADDRESSMODE=2,I.UseSerializedUrlIfAny=!1,(0,k.b)([(0,d.C)()],I.prototype,"url",void 0),(0,k.b)([(0,d.C)()],I.prototype,"uOffset",void 0),(0,k.b)([(0,d.C)()],I.prototype,"vOffset",void 0),(0,k.b)([(0,d.C)()],I.prototype,"uScale",void 0),(0,k.b)([(0,d.C)()],I.prototype,"vScale",void 0),(0,k.b)([(0,d.C)()],I.prototype,"uAng",void 0),(0,k.b)([(0,d.C)()],I.prototype,"vAng",void 0),(0,k.b)([(0,d.C)()],I.prototype,"wAng",void 0),(0,k.b)([(0,d.C)()],I.prototype,"uRotationCenter",void 0),(0,k.b)([(0,d.C)()],I.prototype,"vRotationCenter",void 0),(0,k.b)([(0,d.C)()],I.prototype,"wRotationCenter",void 0),(0,k.b)([(0,d.C)()],I.prototype,"homogeneousRotationInUVTransform",void 0),(0,k.b)([(0,d.C)()],I.prototype,"isBlocking",null),(0,t.f)("BABYLON.Texture",I),R.d._TextureParser=I.Parse},2006:(B,o,e)=>{e.d(o,{c:()=>k});class k{constructor(B,o){this.width=B,this.height=o}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let B=0|this.width;return B=397*B^this.height,B}p(B){this.width=B.width,this.height=B.height}ji(B,o){return this.width=B,this.height=o,this}set(B,o){return this.ji(B,o)}multiplyByFloats(B,o){return new k(this.width*B,this.height*o)}clone(){return new k(this.width,this.height)}equals(B){return!!B&&(this.width===B.width&&this.height===B.height)}get surface(){return this.width*this.height}static Zero(){return new k(0,0)}add(B){return new k(this.width+B.width,this.height+B.height)}Ag(B){return new k(this.width-B.width,this.height-B.height)}scale(B){return new k(this.width*B,this.height*B)}static Lerp(B,o,e){const d=B.width+(o.width-B.width)*e,f=B.height+(o.height-B.height)*e;return new k(d,f)}}}}]);