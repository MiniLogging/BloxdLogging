"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[60],{13929:(z,u,Y)=>{Y.r(u),Y.d(u,{FlowGraphStopAnimationBlock:()=>T});var H=Y(12531),E=Y(10918),J=Y(10953),l=Y(12577);class T extends l.c{constructor(z){super(z),this.animationGroup=this.registerDataInput("animationGroup",H.e),this.stopAtFrame=this.registerDataInput("stopAtFrame",H.p,-1)}_preparePendingTasks(z){const u=this.animationGroup.getValue(z),Y=this.stopAtFrame.getValue(z)??-1,H=z._getGlobalContextVariable("pendingStopAnimations",[]);H.push({uniqueId:u.uniqueId,stopAtFrame:Y}),z._setGlobalContextVariable("pendingStopAnimations",H)}_cancelPendingTasks(z){const u=this.animationGroup.getValue(z),Y=z._getGlobalContextVariable("pendingStopAnimations",[]);for(let H=0;H<Y.length;H++)if(Y[H].uniqueId===u.uniqueId){Y.splice(H,1),z._setGlobalContextVariable("pendingStopAnimations",Y);break}}_execute(z){const u=this.animationGroup.getValue(z),Y=this.stopAtFrame.getValue(z)??-1;return u?isNaN(Y)?this._reportError(z,"Invalid stop time."):(Y>0?this._startPendingTasks(z):this._stopAnimation(u,z),void this.out._activateSignal(z)):(J.b.Warn("No animation group provided to stop."),this._reportError(z,"No animation group provided to stop."))}_executeOnTick(z){const u=this.animationGroup.getValue(z),Y=z._getGlobalContextVariable("pendingStopAnimations",[]);for(let H=0;H<Y.length;H++)if(Y[H].uniqueId===u.uniqueId&&u.getCurrentFrame()>=Y[H].stopAtFrame){this._stopAnimation(u,z),Y.splice(H,1),z._setGlobalContextVariable("pendingStopAnimations",Y),this.done._activateSignal(z),z._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(z,u){const Y=u._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),H=Y.indexOf(z.uniqueId);-1!==H&&(z.stop(),Y.splice(H,1),u._setGlobalContextVariable("currentlyRunningAnimationGroups",Y))}}(0,E.d)("FlowGraphStopAnimationBlock",T)}}]);