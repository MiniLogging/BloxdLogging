"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[15],{11669:(L,j,P)=>{P.d(j,{c:()=>v,e:()=>f,i:()=>h,k:()=>V,o:()=>b,p:()=>C,r:()=>N});var A=P(656),R=P(685),o=P(670),Y=P(606),u=P(11677),a=P(676),D=P(2008),S=P(512),g=P(680);const V=Object.freeze(new A.i(0,0,0,0)),N=Object.freeze(A.r.Zero()),C=Object.freeze(A.n.Zero()),b=Object.freeze(D.d.Zero()),f=Object.freeze(R.e.Black()),h=Object.freeze(new R.i(0,0,0,0)),K={key:0,repeatCount:0,loopMode:2};class v{static _PrepareAnimation(L,j,P,o,Y,u,a,S){let g;if(!isNaN(parseFloat(Y))&&isFinite(Y)?g=v.ANIMATIONTYPE_FLOAT:Y instanceof A.i?g=v.ANIMATIONTYPE_QUATERNION:Y instanceof A.r?g=v.ANIMATIONTYPE_VECTOR3:Y instanceof A.n?g=v.ANIMATIONTYPE_VECTOR2:Y instanceof R.e?g=v.ANIMATIONTYPE_COLOR3:Y instanceof R.i?g=v.ANIMATIONTYPE_COLOR4:Y instanceof D.d&&(g=v.ANIMATIONTYPE_SIZE),void 0==g)return null;const V=new v(L,j,P,g,a),N=[{frame:0,value:Y},{frame:o,value:u}];return V.setKeys(N),void 0!==S&&V.setEasingFunction(S),V}static CreateAnimation(L,j,P,A){const R=new v(L+"Animation",L,P,j,v.ANIMATIONLOOPMODE_CONSTANT);return R.setEasingFunction(A),R}static CreateAndStartAnimation(L,j,P,A,R,o,Y,u,a,D,S){const g=v._PrepareAnimation(L,P,A,R,o,Y,u,a);return g?(j.va&&(S=j.va()),S?S.beginDirectAnimation(j,[g],0,R,g.loopMode!==v.ANIMATIONLOOPMODE_CONSTANT,1,D):null):null}static CreateAndStartHierarchyAnimation(L,j,P,A,R,o,Y,u,a,D,S){const g=v._PrepareAnimation(L,A,R,o,Y,u,a,D);if(!g)return null;return j.va().beginDirectHierarchyAnimation(j,P,[g],0,o,1===g.loopMode,1,S)}static CreateMergeAndStartAnimation(L,j,P,A,R,o,Y,u,a,D){const S=v._PrepareAnimation(L,P,A,R,o,Y,u,a);return S?(j.animations.push(S),j.va().beginAnimation(j,0,R,1===S.loopMode,1,D)):null}static MakeAnimationAdditive(L,j,P){let R;R="object"===typeof j?j:{referenceFrame:j??0,range:P,cloneOriginalAnimation:arguments.length>3&&void 0!==arguments[3]&&arguments[3],clonedAnimationName:arguments.length>4?arguments[4]:void 0};let o=L;if(R.cloneOriginalAnimation&&(o=L.clone(),o.name=R.clonedAnimationName||o.name),!o._keys.length)return o;const Y=R.referenceFrame&&R.referenceFrame>=0?R.referenceFrame:0;let u=0;const a=o._keys[0];let D=o._keys.length-1;const S=o._keys[D],g={referenceValue:a.value,referencePosition:A.m.ti[0],referenceQuaternion:A.m.Quaternion[0],referenceScaling:A.m.ti[1],keyPosition:A.m.ti[2],keyQuaternion:A.m.Quaternion[1],keyScaling:A.m.ti[3]};let V=a.frame,N=S.frame;if(R.range){const L=o.getRange(R.range);L&&(V=L.from,N=L.to)}else V=R.fromFrame??V,N=R.toFrame??N;if(V!==a.frame&&(u=o.createKeyForFrame(V)),N!==S.frame&&(D=o.createKeyForFrame(N)),1===o._keys.length){const L=o._getKeyValue(o._keys[0]);g.referenceValue=L.clone?L.clone():L}else if(Y<=a.frame){const L=o._getKeyValue(a.value);g.referenceValue=L.clone?L.clone():L}else if(Y>=S.frame){const L=o._getKeyValue(S.value);g.referenceValue=L.clone?L.clone():L}else{K.key=0;const L=o._interpolate(Y,K);g.referenceValue=L.clone?L.clone():L}o.dataType===v.ANIMATIONTYPE_QUATERNION?g.referenceValue.normalize().conjugateInPlace():o.dataType===v.ANIMATIONTYPE_MATRIX&&(g.referenceValue.decompose(g.referenceScaling,g.referenceQuaternion,g.referencePosition),g.referenceQuaternion.normalize().conjugateInPlace());let C=Number.MAX_VALUE;const b=R.clipKeys?[]:null;for(let f=u;f<=D;f++){let L=o._keys[f];if((b||R.cloneOriginalAnimation)&&(L={frame:L.frame,value:L.value.clone?L.value.clone():L.value,inTangent:L.inTangent,outTangent:L.outTangent,interpolation:L.interpolation,lockedTangent:L.lockedTangent},b&&(C===Number.MAX_VALUE&&(C=L.frame),L.frame-=C,b.push(L))),!f||o.dataType===v.ANIMATIONTYPE_FLOAT||L.value!==a.value)switch(o.dataType){case v.ANIMATIONTYPE_MATRIX:L.value.decompose(g.keyScaling,g.keyQuaternion,g.keyPosition),g.keyPosition.Wi(g.referencePosition),g.keyScaling.divideInPlace(g.referenceScaling),g.referenceQuaternion.multiplyToRef(g.keyQuaternion,g.keyQuaternion),A.e.ComposeToRef(g.keyScaling,g.keyQuaternion,g.keyPosition,L.value);break;case v.ANIMATIONTYPE_QUATERNION:g.referenceValue.multiplyToRef(L.value,L.value);break;case v.ANIMATIONTYPE_VECTOR2:case v.ANIMATIONTYPE_VECTOR3:case v.ANIMATIONTYPE_COLOR3:case v.ANIMATIONTYPE_COLOR4:L.value.subtractToRef(g.referenceValue,L.value);break;case v.ANIMATIONTYPE_SIZE:L.value.width-=g.referenceValue.width,L.value.height-=g.referenceValue.height;break;default:L.value-=g.referenceValue}}return b&&o.setKeys(b,!0),o}static TransitionTo(L,j,P,A,R,o,Y){let u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(Y<=0)return P[L]=j,u&&u(),null;const a=R*(Y/1e3);o.setKeys([{frame:0,value:P[L].clone?P[L].clone():P[L]},{frame:a,value:j}]),P.animations||(P.animations=[]),P.animations.push(o);const D=A.beginAnimation(P,0,a,!1);return D.onAnimationEnd=u,D}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const L of this._runtimeAnimations)if(!L.isStopped())return!0;return!1}constructor(L,j,P,A,R,o){this.name=L,this.targetProperty=j,this.framePerSecond=P,this.dataType=A,this.loopMode=R,this.enableBlending=o,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this._coreAnimation=null,this.targetPropertyPath=j.split("."),this.dataType=A,this.loopMode=void 0===R?v.ANIMATIONLOOPMODE_CYCLE:R,this.uniqueId=v._UniqueIdGenerator++}toString(L){let j="Name: "+this.name+", property: "+this.targetProperty;if(j+=", datatype: "+["Float","ti","Quaternion","Matrix","Zi","Vector2"][this.dataType],j+=", nKeys: "+(this._keys?this._keys.length:"none"),j+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),L){j+=", Ranges: {";let L=!0;for(const P in this._ranges)L&&(j+=", ",L=!1),j+=P;j+="}"}return j}addEvent(L){this._events.push(L),this._events.sort(((L,j)=>L.frame-j.frame))}removeEvents(L){for(let j=0;j<this._events.length;j++)this._events[j].frame===L&&(this._events.splice(j,1),j--)}getEvents(){return this._events}createRange(L,j,P){this._ranges[L]||(this._ranges[L]=new u.e(L,j,P))}deleteRange(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const P=this._ranges[L];if(P){if(j){const L=P.from,j=P.to;for(let P=this._keys.length-1;P>=0;P--)this._keys[P].frame>=L&&this._keys[P].frame<=j&&this._keys.splice(P,1)}this._ranges[L]=null}}getRange(L){return this._ranges[L]}getKeys(){return this._keys}getHighestFrame(){let L=0;for(let j=0,P=this._keys.length;j<P;j++)L<this._keys[j].frame&&(L=this._keys[j].frame);return L}getEasingFunction(){return this._easingFunction}setEasingFunction(L){this._easingFunction=L}floatInterpolateFunction(L,j,P){return(0,o.Lerp)(L,j,P)}floatInterpolateFunctionWithTangents(L,j,P,A,R){return(0,o.Hermite)(L,j,P,A,R)}quaternionInterpolateFunction(L,j,P){return A.i.Slerp(L,j,P)}quaternionInterpolateFunctionWithTangents(L,j,P,R,o){return A.i.Hermite(L,j,P,R,o).normalize()}vector3InterpolateFunction(L,j,P){return A.r.Lerp(L,j,P)}vector3InterpolateFunctionWithTangents(L,j,P,R,o){return A.r.Hermite(L,j,P,R,o)}vector2InterpolateFunction(L,j,P){return A.n.Lerp(L,j,P)}vector2InterpolateFunctionWithTangents(L,j,P,R,o){return A.n.Hermite(L,j,P,R,o)}sizeInterpolateFunction(L,j,P){return D.d.Lerp(L,j,P)}color3InterpolateFunction(L,j,P){return R.e.Lerp(L,j,P)}color3InterpolateFunctionWithTangents(L,j,P,A,o){return R.e.Hermite(L,j,P,A,o)}color4InterpolateFunction(L,j,P){return R.i.Lerp(L,j,P)}color4InterpolateFunctionWithTangents(L,j,P,A,o){return R.i.Hermite(L,j,P,A,o)}_getKeyValue(L){return"function"===typeof L?L():L}evaluate(L){return K.key=0,this._interpolate(L,K)}_interpolate(L,j){let P=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(j.loopMode===v.ANIMATIONLOOPMODE_CONSTANT&&j.repeatCount>0)return j.highLimitValue.clone?j.highLimitValue.clone():j.highLimitValue;const A=this._keys;let R;if(this._coreAnimation)R=this._coreAnimation._key;else{const o=A.length;for(R=j.key;R>=0&&L<A[R].frame;)--R;for(;R+1<=o-1&&L>=A[R+1].frame;)++R;if(j.key=R,R<0)return P?void 0:this._getKeyValue(A[0].value);if(R+1>o-1)return P?void 0:this._getKeyValue(A[o-1].value);this._key=R}const o=A[R],Y=A[R+1];if(P&&(L===o.frame||L===Y.frame))return;const u=this._getKeyValue(o.value),a=this._getKeyValue(Y.value);if(1===o.interpolation)return Y.frame>L?u:a;const D=void 0!==o.outTangent&&void 0!==Y.inTangent,S=Y.frame-o.frame;let g=(L-o.frame)/S;const K=o.easingFunction||this.getEasingFunction();switch(K&&(g=K.ease(g)),this.dataType){case v.ANIMATIONTYPE_FLOAT:{const L=D?this.floatInterpolateFunctionWithTangents(u,o.outTangent*S,a,Y.inTangent*S,g):this.floatInterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return(j.offsetValue??0)*j.repeatCount+L}break}case v.ANIMATIONTYPE_QUATERNION:{const L=D?this.quaternionInterpolateFunctionWithTangents(u,o.outTangent.scale(S),a,Y.inTangent.scale(S),g):this.quaternionInterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return L.addInPlace((j.offsetValue||V).scale(j.repeatCount))}return L}case v.ANIMATIONTYPE_VECTOR3:{const L=D?this.vector3InterpolateFunctionWithTangents(u,o.outTangent.scale(S),a,Y.inTangent.scale(S),g):this.vector3InterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return L.add((j.offsetValue||N).scale(j.repeatCount))}break}case v.ANIMATIONTYPE_VECTOR2:{const L=D?this.vector2InterpolateFunctionWithTangents(u,o.outTangent.scale(S),a,Y.inTangent.scale(S),g):this.vector2InterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return L.add((j.offsetValue||C).scale(j.repeatCount))}break}case v.ANIMATIONTYPE_SIZE:switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return this.sizeInterpolateFunction(u,a,g);case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return this.sizeInterpolateFunction(u,a,g).add((j.offsetValue||b).scale(j.repeatCount))}break;case v.ANIMATIONTYPE_COLOR3:{const L=D?this.color3InterpolateFunctionWithTangents(u,o.outTangent.scale(S),a,Y.inTangent.scale(S),g):this.color3InterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return L.add((j.offsetValue||f).scale(j.repeatCount))}break}case v.ANIMATIONTYPE_COLOR4:{const L=D?this.color4InterpolateFunctionWithTangents(u,o.outTangent.scale(S),a,Y.inTangent.scale(S),g):this.color4InterpolateFunction(u,a,g);switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return L;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return L.add((j.offsetValue||h).scale(j.repeatCount))}break}case v.ANIMATIONTYPE_MATRIX:switch(j.loopMode){case v.ANIMATIONLOOPMODE_CYCLE:case v.ANIMATIONLOOPMODE_CONSTANT:case v.ANIMATIONLOOPMODE_YOYO:return v.AllowMatricesInterpolation?this.matrixInterpolateFunction(u,a,g,j.workValue):u;case v.ANIMATIONLOOPMODE_RELATIVE:case v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return u}}return 0}matrixInterpolateFunction(L,j,P,R){return v.AllowMatrixDecomposeForInterpolation?R?(A.e.DecomposeLerpToRef(L,j,P,R),R):A.e.DecomposeLerp(L,j,P):R?(A.e.LerpToRef(L,j,P,R),R):A.e.Lerp(L,j,P)}clone(){const L=new v(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(L.enableBlending=this.enableBlending,L.blendingSpeed=this.blendingSpeed,this._keys&&L.setKeys(this._keys),this._ranges){L._ranges={};for(const j in this._ranges){const P=this._ranges[j];P&&(L._ranges[j]=P.clone())}}return L}setKeys(L){let j=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._keys=j?L:L.slice(0)}createKeyForFrame(L){K.key=0;const j=this._interpolate(L,K,!0);if(!j)return this._keys[K.key].frame===L?K.key:K.key+1;const P={frame:L,value:j.clone?j.clone():j};return this._keys.splice(K.key+1,0,P),K.key+1}serialize(){const L={};L.name=this.name,L.property=this.targetProperty,L.framePerSecond=this.framePerSecond,L.dataType=this.dataType,L.loopBehavior=this.loopMode,L.enableBlending=this.enableBlending,L.blendingSpeed=this.blendingSpeed;const j=this.dataType;L.keys=[];const P=this.getKeys();for(let A=0;A<P.length;A++){const R=P[A],o={};switch(o.frame=R.frame,j){case v.ANIMATIONTYPE_FLOAT:o.values=[R.value],void 0!==R.inTangent&&o.values.push(R.inTangent),void 0!==R.outTangent&&(void 0===R.inTangent&&o.values.push(void 0),o.values.push(R.outTangent)),void 0!==R.interpolation&&(void 0===R.inTangent&&o.values.push(void 0),void 0===R.outTangent&&o.values.push(void 0),o.values.push(R.interpolation));break;case v.ANIMATIONTYPE_QUATERNION:case v.ANIMATIONTYPE_MATRIX:case v.ANIMATIONTYPE_VECTOR3:case v.ANIMATIONTYPE_COLOR3:case v.ANIMATIONTYPE_COLOR4:o.values=R.value.Ei(),void 0!=R.inTangent&&o.values.push(R.inTangent.Ei()),void 0!=R.outTangent&&(void 0===R.inTangent&&o.values.push(void 0),o.values.push(R.outTangent.Ei())),void 0!==R.interpolation&&(void 0===R.inTangent&&o.values.push(void 0),void 0===R.outTangent&&o.values.push(void 0),o.values.push(R.interpolation))}L.keys.push(o)}L.ranges=[];for(const A in this._ranges){const j=this._ranges[A];if(!j)continue;const P={};P.name=A,P.from=j.from,P.to=j.to,L.ranges.push(P)}return L}static _UniversalLerp(L,j,P){const A=L.constructor;return A.Lerp?A.Lerp(L,j,P):A.Slerp?A.Slerp(L,j,P):L.toFixed?L*(1-P)+P*j:j}static Parse(L){const j=new v(L.name,L.property,L.framePerSecond,L.dataType,L.loopBehavior),P=L.dataType,o=[];let Y,u;for(L.enableBlending&&(j.enableBlending=L.enableBlending),L.blendingSpeed&&(j.blendingSpeed=L.blendingSpeed),u=0;u<L.keys.length;u++){const j=L.keys[u];let a,D,S;switch(P){case v.ANIMATIONTYPE_FLOAT:Y=j.values[0],j.values.length>=2&&(a=j.values[1]),j.values.length>=3&&(D=j.values[2]),j.values.length>=4&&(S=j.values[3]);break;case v.ANIMATIONTYPE_QUATERNION:if(Y=A.i.ri(j.values),j.values.length>=8){const L=A.i.ri(j.values.slice(4,8));L.equals(A.i.Zero())||(a=L)}if(j.values.length>=12){const L=A.i.ri(j.values.slice(8,12));L.equals(A.i.Zero())||(D=L)}j.values.length>=13&&(S=j.values[12]);break;case v.ANIMATIONTYPE_MATRIX:Y=A.e.ri(j.values),j.values.length>=17&&(S=j.values[16]);break;case v.ANIMATIONTYPE_COLOR3:Y=R.e.ri(j.values),j.values[3]&&(a=R.e.ri(j.values[3])),j.values[4]&&(D=R.e.ri(j.values[4])),j.values[5]&&(S=j.values[5]);break;case v.ANIMATIONTYPE_COLOR4:Y=R.i.ri(j.values),j.values[4]&&(a=R.i.ri(j.values[4])),j.values[5]&&(D=R.i.ri(j.values[5])),j.values[6]&&(S=R.i.ri(j.values[6]));break;case v.ANIMATIONTYPE_VECTOR3:default:Y=A.r.ri(j.values),j.values[3]&&(a=A.r.ri(j.values[3])),j.values[4]&&(D=A.r.ri(j.values[4])),j.values[5]&&(S=j.values[5])}const g={};g.frame=j.frame,g.value=Y,void 0!=a&&(g.inTangent=a),void 0!=D&&(g.outTangent=D),void 0!=S&&(g.interpolation=S),o.push(g)}if(j.setKeys(o),L.ranges)for(u=0;u<L.ranges.length;u++)Y=L.ranges[u],j.createRange(Y.name,Y.from,Y.to);return j}static AppendSerializedAnimations(L,j){g.e.AppendSerializedAnimations(L,j)}static async ParseFromFileAsync(L,j){return await new Promise(((P,A)=>{const R=new S.e;R.addEventListener("readystatechange",(()=>{if(4==R.readyState)if(200==R.status){let j=JSON.parse(R.responseText);if(j.animations&&(j=j.animations),j.length){const L=[];for(const P of j)L.push(this.Parse(P));P(L)}else{const A=this.Parse(j);L&&(A.name=L),P(A)}}else A("Unable to load the animation")})),R.open("GET",j),R.send()}))}static async ParseFromSnippetAsync(L){return await new Promise(((j,P)=>{const A=new S.e;A.addEventListener("readystatechange",(()=>{if(4==A.readyState)if(200==A.status){const P=JSON.parse(JSON.parse(A.responseText).jsonPayload);if(P.animations){const A=JSON.parse(P.animations),R=[];for(const j of A.animations){const P=this.Parse(j);P.snippetId=L,R.push(P)}j(R)}else{const A=JSON.parse(P.animation),R=this.Parse(A);R.snippetId=L,j(R)}}else P("Unable to load the snippet "+L)})),A.open("GET",this.SnippetUrl+"/"+L.replace(/#/g,"/")),A.send()}))}}v._UniqueIdGenerator=0,v.AllowMatricesInterpolation=!1,v.AllowMatrixDecomposeForInterpolation=!0,v.SnippetUrl="https://snippet.babylonjs.com",v.ANIMATIONTYPE_FLOAT=0,v.ANIMATIONTYPE_VECTOR3=1,v.ANIMATIONTYPE_QUATERNION=2,v.ANIMATIONTYPE_MATRIX=3,v.ANIMATIONTYPE_COLOR3=4,v.ANIMATIONTYPE_COLOR4=7,v.ANIMATIONTYPE_VECTOR2=5,v.ANIMATIONTYPE_SIZE=6,v.ANIMATIONLOOPMODE_RELATIVE=0,v.ANIMATIONLOOPMODE_CYCLE=1,v.ANIMATIONLOOPMODE_CONSTANT=2,v.ANIMATIONLOOPMODE_YOYO=4,v.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT=5,v.CreateFromSnippetAsync=v.ParseFromSnippetAsync,(0,Y.h)("BABYLON.Animation",v),a.e._AnimationRangeFactory=(L,j,P)=>new u.e(L,j,P)},11677:(L,j,P)=>{P.d(j,{e:()=>A});class A{constructor(L,j,P){this.name=L,this.from=j,this.to=P}clone(){return new A(this.name,this.from,this.to)}}},11589:(L,j,P)=>{P.d(j,{d:()=>g});var A=P(636),R=P(639),o=P(633),Y=P(656),u=P(661),a=P(797);P(676).e.AddNodeConstructor("TargetCamera",((L,j)=>()=>new g(L,Y.r.Zero(),j)));const D=Y.e.Zero(),S=Y.i.Identity();class g extends o.e{constructor(L,j,P){super(L,j,P,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),this.cameraDirection=new Y.r(0,0,0),this.cameraRotation=new Y.n(0,0),this.updateUpVectorFromRotation=!1,this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=Y.r.Zero(),this._initialFocalDistance=1,this._viewMatrix=Y.e.Zero(),this._cameraTransformMatrix=Y.e.Zero(),this._cameraRotationMatrix=Y.e.Zero(),this._transformedReferencePoint=Y.r.Zero(),this._deferredPositionUpdate=new Y.r,this._deferredRotationQuaternionUpdate=new Y.i,this._deferredRotationUpdate=new Y.r,this._deferredUpdated=!1,this._deferOnly=!1,this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0,this._referencePoint=Y.r.Forward(this.va().useRightHandedSystem),this.rotation=new Y.r(0,this.va().useRightHandedSystem?Math.PI:0,0)}getFrontPosition(L){this.getWorldMatrix();const j=Y.m.ti[0],P=Y.m.ti[1];return P.set(0,0,this._scene.useRightHandedSystem?-1:1),this.getDirectionToRef(P,j),j.scaleInPlace(L),this.globalPosition.add(j)}_getLockedTargetPosition(){if(!this.lockedTarget)return null;if(this.lockedTarget.absolutePosition){const L=this.lockedTarget;L.yi().getTranslationToRef(L.absolutePosition)}return this.lockedTarget.absolutePosition||this.lockedTarget}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.li(0,0,0),this.cameraRotation.li(0,0),!0)}_initCache(){super._initCache(),this._cache.lockedTarget=new Y.r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new Y.r(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new Y.i(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(L){L||super._updateCache();const j=this._getLockedTargetPosition();j?this._cache.lockedTarget?this._cache.lockedTarget.p(j):this._cache.lockedTarget=j.clone():this._cache.lockedTarget=null,this._cache.rotation.p(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.p(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const L=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(L):!L)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const L=this.getEngine();return this.speed*Math.sqrt(L.getDeltaTime()/(100*L.getFps()))}setTarget(L){this.upVector.normalize(),this._initialFocalDistance=L.xg(this.position).length(),this.position.z===L.z&&(this.position.z+=u.c),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),this.va().useRightHandedSystem?Y.e.LookAtRHToRef(this.position,L,Y.r.UpReadOnly,D):Y.e.LookAtLHToRef(this.position,L,Y.r.UpReadOnly,D),D.invert();const j=this.rotationQuaternion||S;Y.i.FromRotationMatrixToRef(D,j),j.toEulerAnglesToRef(this.rotation),this.rotation.z=0}get target(){return this.getTarget()}set target(L){this.setTarget(L)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(Y.m.Matrix[0]),Y.r.TransformNormalToRef(this.cameraDirection,Y.m.Matrix[0],Y.m.ti[0]),this._deferredPositionUpdate.addInPlace(Y.m.ti[0]),void(this._deferOnly?this._deferredUpdated=!0:this.position.p(this._deferredPositionUpdate));this._deferredPositionUpdate.addInPlace(this.cameraDirection),this._deferOnly?this._deferredUpdated=!0:this.position.p(this._deferredPositionUpdate)}_checkInputs(){const L=this.invertRotation?-this.inverseRotationSpeed:1,j=this._decideIfNeedsToMove(),P=this.cameraRotation.x||this.cameraRotation.y;if(this._deferredUpdated=!1,this._deferredRotationUpdate.p(this.rotation),this._deferredPositionUpdate.p(this.position),this.rotationQuaternion&&this._deferredRotationQuaternionUpdate.p(this.rotationQuaternion),j&&this._updatePosition(),P){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this._deferredRotationUpdate),this._deferredRotationUpdate.x+=this.cameraRotation.x*L,this._deferredRotationUpdate.y+=this.cameraRotation.y*L,!this.noRotationConstraint){const L=1.570796;this._deferredRotationUpdate.x>L&&(this._deferredRotationUpdate.x=L),this._deferredRotationUpdate.x<-L&&(this._deferredRotationUpdate.x=-L)}if(this._deferOnly?this._deferredUpdated=!0:this.rotation.p(this._deferredRotationUpdate),this.rotationQuaternion){this._deferredRotationUpdate.lengthSquared()&&(Y.i.RotationYawPitchRollToRef(this._deferredRotationUpdate.y,this._deferredRotationUpdate.x,this._deferredRotationUpdate.z,this._deferredRotationQuaternionUpdate),this._deferOnly?this._deferredUpdated=!0:this.rotationQuaternion.p(this._deferredRotationQuaternionUpdate))}}j&&(Math.abs(this.cameraDirection.x)<this.speed*u.c&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*u.c&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*u.c&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),P&&(Math.abs(this.cameraRotation.x)<this.speed*u.c&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*u.c&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):Y.e.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return Y.r.TransformNormalToRef(Y.r.UpReadOnly,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),Y.r.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?a.c.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(Y.i.FromEulerVectorToRef(this.rotation,S),a.c.Y.rotateByQuaternionToRef(S,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(L,j,P){if(this.va().useRightHandedSystem?Y.e.LookAtRHToRef(L,j,P,this._viewMatrix):Y.e.LookAtLHToRef(L,j,P,this._viewMatrix),this.parent){const L=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(L,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.p(L)}createRigCamera(L,j){if(this.cameraRigMode!==o.e.RIG_MODE_NONE){const j=new g(L,this.position.clone(),this.va());return j.isRigCamera=!0,j.rigParent=this,this.cameraRigMode===o.e.RIG_MODE_VR&&(this.rotationQuaternion||(this.rotationQuaternion=new Y.i),j._cameraRigParams={},j.rotationQuaternion=new Y.i),j.mode=this.mode,j.orthoLeft=this.orthoLeft,j.orthoRight=this.orthoRight,j.orthoTop=this.orthoTop,j.orthoBottom=this.orthoBottom,j}return null}_updateRigCameras(){const L=this._rigCameras[0],j=this._rigCameras[1];switch(this.yi(),this.cameraRigMode){case o.e.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case o.e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case o.e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case o.e.RIG_MODE_STEREOSCOPIC_OVERUNDER:case o.e.RIG_MODE_STEREOSCOPIC_INTERLACED:{const P=this.cameraRigMode===o.e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,A=this.cameraRigMode===o.e.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*P,L),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*A,j);break}case o.e.RIG_MODE_VR:L.rotationQuaternion?(L.rotationQuaternion.p(this.rotationQuaternion),j.rotationQuaternion.p(this.rotationQuaternion)):(L.rotation.p(this.rotation),j.rotation.p(this.rotation)),L.position.p(this.position),j.position.p(this.position)}super._updateRigCameras()}_getRigCamPositionAndTarget(L,j){this.getTarget().subtractToRef(this.position,g._TargetFocalPoint),g._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const P=g._TargetFocalPoint.addInPlace(this.position);Y.e.TranslationToRef(-P.x,-P.y,-P.z,g._TargetTransformMatrix),g._TargetTransformMatrix.multiplyToRef(Y.e.RotationAxis(j.upVector,L),g._RigCamTransformMatrix),Y.e.TranslationToRef(P.x,P.y,P.z,g._TargetTransformMatrix),g._RigCamTransformMatrix.multiplyToRef(g._TargetTransformMatrix,g._RigCamTransformMatrix),Y.r.TransformCoordinatesToRef(this.position,g._RigCamTransformMatrix,j.position),j.setTarget(P)}getClassName(){return"TargetCamera"}}g._RigCamTransformMatrix=new Y.e,g._TargetTransformMatrix=new Y.e,g._TargetFocalPoint=new Y.r,(0,A.b)([(0,R.K)()],g.prototype,"updateUpVectorFromRotation",void 0),(0,A.b)([(0,R.J)()],g.prototype,"rotation",void 0),(0,A.b)([(0,R.K)()],g.prototype,"speed",void 0),(0,A.b)([(0,R.w)("lockedTargetId")],g.prototype,"lockedTarget",void 0)},11582:(L,j,P)=>{P.d(j,{e:()=>A});class A{}A.AUTOSAMPLERSUFFIX="Sampler",A.DISABLEUA="#define DISABLE_UNIFORMITY_ANALYSIS",A.ALPHA_DISABLE=0,A.ALPHA_ADD=1,A.ALPHA_COMBINE=2,A.ALPHA_SUBTRACT=3,A.ALPHA_MULTIPLY=4,A.ALPHA_MAXIMIZED=5,A.ALPHA_ONEONE=6,A.ALPHA_PREMULTIPLIED=7,A.ALPHA_PREMULTIPLIED_PORTERDUFF=8,A.ALPHA_INTERPOLATE=9,A.ALPHA_SCREENMODE=10,A.ALPHA_ONEONE_ONEONE=11,A.ALPHA_ALPHATOCOLOR=12,A.ALPHA_REVERSEONEMINUS=13,A.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,A.ALPHA_ONEONE_ONEZERO=15,A.ALPHA_EXCLUSION=16,A.ALPHA_LAYER_ACCUMULATE=17,A.ALPHA_EQUATION_ADD=0,A.ALPHA_EQUATION_SUBSTRACT=1,A.ALPHA_EQUATION_REVERSE_SUBTRACT=2,A.ALPHA_EQUATION_MAX=3,A.ALPHA_EQUATION_MIN=4,A.ALPHA_EQUATION_DARKEN=5,A.DELAYLOADSTATE_NONE=0,A.DELAYLOADSTATE_LOADED=1,A.DELAYLOADSTATE_LOADING=2,A.DELAYLOADSTATE_NOTLOADED=4,A.NEVER=512,A.ALWAYS=519,A.LESS=513,A.EQUAL=514,A.LEQUAL=515,A.GREATER=516,A.GEQUAL=518,A.NOTEQUAL=517,A.KEEP=7680,A.ZERO=0,A.REPLACE=7681,A.INCR=7682,A.DECR=7683,A.INVERT=5386,A.INCR_WRAP=34055,A.DECR_WRAP=34056,A.TEXTURE_CLAMP_ADDRESSMODE=0,A.TEXTURE_WRAP_ADDRESSMODE=1,A.TEXTURE_MIRROR_ADDRESSMODE=2,A.TEXTURE_CREATIONFLAG_STORAGE=1,A.TEXTUREFORMAT_ALPHA=0,A.TEXTUREFORMAT_LUMINANCE=1,A.TEXTUREFORMAT_LUMINANCE_ALPHA=2,A.TEXTUREFORMAT_RGB=4,A.TEXTUREFORMAT_RGBA=5,A.TEXTUREFORMAT_RED=6,A.TEXTUREFORMAT_R=6,A.TEXTUREFORMAT_R16_UNORM=33322,A.TEXTUREFORMAT_RG16_UNORM=33324,A.TEXTUREFORMAT_RGB16_UNORM=32852,A.TEXTUREFORMAT_RGBA16_UNORM=32859,A.TEXTUREFORMAT_R16_SNORM=36760,A.TEXTUREFORMAT_RG16_SNORM=36761,A.TEXTUREFORMAT_RGB16_SNORM=36762,A.TEXTUREFORMAT_RGBA16_SNORM=36763,A.TEXTUREFORMAT_RG=7,A.TEXTUREFORMAT_RED_INTEGER=8,A.TEXTUREFORMAT_R_INTEGER=8,A.TEXTUREFORMAT_RG_INTEGER=9,A.TEXTUREFORMAT_RGB_INTEGER=10,A.TEXTUREFORMAT_RGBA_INTEGER=11,A.TEXTUREFORMAT_BGRA=12,A.TEXTUREFORMAT_DEPTH24_STENCIL8=13,A.TEXTUREFORMAT_DEPTH32_FLOAT=14,A.TEXTUREFORMAT_DEPTH16=15,A.TEXTUREFORMAT_DEPTH24=16,A.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,A.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,A.TEXTUREFORMAT_STENCIL8=19,A.TEXTUREFORMAT_UNDEFINED=4294967295,A.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,A.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,A.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,A.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,A.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,A.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,A.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,A.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,A.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,A.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,A.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,A.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,A.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,A.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,A.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,A.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,A.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,A.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,A.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,A.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,A.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,A.TEXTURETYPE_UNSIGNED_BYTE=0,A.TEXTURETYPE_UNSIGNED_INT=0,A.TEXTURETYPE_FLOAT=1,A.TEXTURETYPE_HALF_FLOAT=2,A.TEXTURETYPE_BYTE=3,A.TEXTURETYPE_SHORT=4,A.TEXTURETYPE_UNSIGNED_SHORT=5,A.TEXTURETYPE_INT=6,A.TEXTURETYPE_UNSIGNED_INTEGER=7,A.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,A.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,A.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,A.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,A.TEXTURETYPE_UNSIGNED_INT_24_8=12,A.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,A.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,A.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,A.TEXTURETYPE_UNDEFINED=16,A.TEXTURE_2D=3553,A.TEXTURE_2D_ARRAY=35866,A.TEXTURE_CUBE_MAP=34067,A.TEXTURE_CUBE_MAP_ARRAY=3735928559,A.TEXTURE_3D=32879,A.TEXTURE_NEAREST_SAMPLINGMODE=1,A.TEXTURE_NEAREST_NEAREST=1,A.TEXTURE_BILINEAR_SAMPLINGMODE=2,A.TEXTURE_LINEAR_LINEAR=2,A.TEXTURE_TRILINEAR_SAMPLINGMODE=3,A.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,A.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,A.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,A.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,A.TEXTURE_NEAREST_LINEAR=7,A.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,A.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,A.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,A.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,A.TEXTURE_LINEAR_NEAREST=12,A.TEXTURE_EXPLICIT_MODE=0,A.TEXTURE_SPHERICAL_MODE=1,A.TEXTURE_PLANAR_MODE=2,A.TEXTURE_CUBIC_MODE=3,A.TEXTURE_PROJECTION_MODE=4,A.TEXTURE_SKYBOX_MODE=5,A.TEXTURE_INVCUBIC_MODE=6,A.TEXTURE_EQUIRECTANGULAR_MODE=7,A.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,A.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,A.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,A.TEXTURE_FILTERING_QUALITY_HIGH=64,A.TEXTURE_FILTERING_QUALITY_MEDIUM=16,A.TEXTURE_FILTERING_QUALITY_LOW=8,A.SCALEMODE_FLOOR=1,A.SCALEMODE_NEAREST=2,A.SCALEMODE_CEILING=3,A.MATERIAL_TextureDirtyFlag=1,A.MATERIAL_LightDirtyFlag=2,A.MATERIAL_FresnelDirtyFlag=4,A.MATERIAL_AttributesDirtyFlag=8,A.MATERIAL_MiscDirtyFlag=16,A.MATERIAL_PrePassDirtyFlag=32,A.MATERIAL_ImageProcessingDirtyFlag=64,A.MATERIAL_AllDirtyFlag=127,A.MATERIAL_TriangleFillMode=0,A.MATERIAL_WireFrameFillMode=1,A.MATERIAL_PointFillMode=2,A.MATERIAL_PointListDrawMode=3,A.MATERIAL_LineListDrawMode=4,A.MATERIAL_LineLoopDrawMode=5,A.MATERIAL_LineStripDrawMode=6,A.MATERIAL_TriangleStripDrawMode=7,A.MATERIAL_TriangleFanDrawMode=8,A.MATERIAL_ClockWiseSideOrientation=0,A.MATERIAL_CounterClockWiseSideOrientation=1,A.MATERIAL_DIFFUSE_MODEL_E_OREN_NAYAR=0,A.MATERIAL_DIFFUSE_MODEL_BURLEY=1,A.MATERIAL_DIFFUSE_MODEL_LAMBERT=2,A.MATERIAL_DIFFUSE_MODEL_LEGACY=3,A.MATERIAL_DIELECTRIC_SPECULAR_MODEL_GLTF=0,A.MATERIAL_DIELECTRIC_SPECULAR_MODEL_OPENPBR=1,A.MATERIAL_CONDUCTOR_SPECULAR_MODEL_GLTF=0,A.MATERIAL_CONDUCTOR_SPECULAR_MODEL_OPENPBR=1,A.ACTION_NothingTrigger=0,A.ACTION_OnPickTrigger=1,A.ACTION_OnLeftPickTrigger=2,A.ACTION_OnRightPickTrigger=3,A.ACTION_OnCenterPickTrigger=4,A.ACTION_OnPickDownTrigger=5,A.ACTION_OnDoublePickTrigger=6,A.ACTION_OnPickUpTrigger=7,A.ACTION_OnPickOutTrigger=16,A.ACTION_OnLongPressTrigger=8,A.ACTION_OnPointerOverTrigger=9,A.ACTION_OnPointerOutTrigger=10,A.ACTION_OnEveryFrameTrigger=11,A.ACTION_OnIntersectionEnterTrigger=12,A.ACTION_OnIntersectionExitTrigger=13,A.ACTION_OnKeyDownTrigger=14,A.ACTION_OnKeyUpTrigger=15,A.PARTICLES_BILLBOARDMODE_Y=2,A.PARTICLES_BILLBOARDMODE_ALL=7,A.PARTICLES_BILLBOARDMODE_STRETCHED=8,A.PARTICLES_BILLBOARDMODE_STRETCHED_LOCAL=9,A.MESHES_CULLINGSTRATEGY_STANDARD=0,A.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,A.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,A.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,A.SCENELOADER_NO_LOGGING=0,A.SCENELOADER_MINIMAL_LOGGING=1,A.SCENELOADER_SUMMARY_LOGGING=2,A.SCENELOADER_DETAILED_LOGGING=3,A.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,A.PREPASS_POSITION_TEXTURE_TYPE=1,A.PREPASS_VELOCITY_TEXTURE_TYPE=2,A.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,A.PREPASS_COLOR_TEXTURE_TYPE=4,A.PREPASS_DEPTH_TEXTURE_TYPE=5,A.PREPASS_NORMAL_TEXTURE_TYPE=6,A.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,A.PREPASS_WORLD_NORMAL_TEXTURE_TYPE=8,A.PREPASS_LOCAL_POSITION_TEXTURE_TYPE=9,A.PREPASS_SCREENSPACE_DEPTH_TEXTURE_TYPE=10,A.PREPASS_VELOCITY_LINEAR_TEXTURE_TYPE=11,A.PREPASS_ALBEDO_TEXTURE_TYPE=12,A.PREPASS_NORMALIZED_VIEW_DEPTH_TEXTURE_TYPE=13,A.BUFFER_CREATIONFLAG_READ=1,A.BUFFER_CREATIONFLAG_WRITE=2,A.BUFFER_CREATIONFLAG_READWRITE=3,A.BUFFER_CREATIONFLAG_UNIFORM=4,A.BUFFER_CREATIONFLAG_VERTEX=8,A.BUFFER_CREATIONFLAG_INDEX=16,A.BUFFER_CREATIONFLAG_STORAGE=32,A.BUFFER_CREATIONFLAG_INDIRECT=64,A.RENDERPASS_MAIN=0,A.INPUT_ALT_KEY=18,A.INPUT_CTRL_KEY=17,A.INPUT_META_KEY1=91,A.INPUT_META_KEY2=92,A.INPUT_META_KEY3=93,A.INPUT_SHIFT_KEY=16,A.SNAPSHOTRENDERING_STANDARD=0,A.SNAPSHOTRENDERING_FAST=1,A.PERSPECTIVE_CAMERA=0,A.ORTHOGRAPHIC_CAMERA=1,A.FOVMODE_VERTICAL_FIXED=0,A.FOVMODE_HORIZONTAL_FIXED=1,A.RIG_MODE_NONE=0,A.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,A.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,A.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,A.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,A.RIG_MODE_STEREOSCOPIC_INTERLACED=14,A.RIG_MODE_VR=20,A.RIG_MODE_CUSTOM=22,A.MAX_SUPPORTED_UV_SETS=6,A.GL_ALPHA_EQUATION_ADD=32774,A.GL_ALPHA_EQUATION_MIN=32775,A.GL_ALPHA_EQUATION_MAX=32776,A.GL_ALPHA_EQUATION_SUBTRACT=32778,A.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,A.GL_ALPHA_FUNCTION_SRC=768,A.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,A.GL_ALPHA_FUNCTION_SRC_ALPHA=770,A.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,A.GL_ALPHA_FUNCTION_DST_ALPHA=772,A.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,A.GL_ALPHA_FUNCTION_DST_COLOR=774,A.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,A.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,A.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,A.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,A.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,A.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,A.GL_ALPHA_FUNCTION_SRC1_COLOR=35065,A.GL_ALPHA_FUNCTION_ONE_MINUS_SRC1_COLOR=35066,A.GL_ALPHA_FUNCTION_SRC1_ALPHA=34185,A.GL_ALPHA_FUNCTION_ONE_MINUS_SRC1_ALPHA=35067,A.SnippetUrl="https://snippet.babylonjs.com",A.FOGMODE_NONE=0,A.FOGMODE_EXP=1,A.FOGMODE_EXP2=2,A.FOGMODE_LINEAR=3,A.BYTE=5120,A.UNSIGNED_BYTE=5121,A.SHORT=5122,A.UNSIGNED_SHORT=5123,A.INT=5124,A.UNSIGNED_INT=5125,A.FLOAT=5126,A.PositionKind="position",A.NormalKind="Xi",A.TangentKind="tangent",A.UVKind="uv",A.UV2Kind="uv2",A.UV3Kind="uv3",A.UV4Kind="uv4",A.UV5Kind="uv5",A.UV6Kind="uv6",A.ColorKind="color",A.ColorInstanceKind="instanceColor",A.MatricesIndicesKind="matricesIndices",A.MatricesWeightsKind="matricesWeights",A.MatricesIndicesExtraKind="matricesIndicesExtra",A.MatricesWeightsExtraKind="matricesWeightsExtra",A.ANIMATIONTYPE_FLOAT=0,A.ANIMATIONTYPE_VECTOR3=1,A.ANIMATIONTYPE_QUATERNION=2,A.ANIMATIONTYPE_MATRIX=3,A.ANIMATIONTYPE_COLOR3=4,A.ANIMATIONTYPE_COLOR4=7,A.ANIMATIONTYPE_VECTOR2=5,A.ANIMATIONTYPE_SIZE=6,A.ShadowMinZ=0,A.ShadowMaxZ=1e4},11687:(L,j,P)=>{P.d(j,{d:()=>V});var A=P(636),R=P(639),o=P(656),Y=P(685),u=P(676),a=P(790),D=P(606),S=P(811),g=P(680);class V extends u.e{get range(){return this._range}set range(L){this._range=L,this._inverseSquaredRange=1/(this.range*this.range)}get intensityMode(){return this._intensityMode}set intensityMode(L){this._intensityMode=L,this._computePhotometricScale()}get radius(){return this._radius}set radius(L){this._radius=L,this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(L){this._shadowEnabled!==L&&(this._shadowEnabled=L,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(L){this._includedOnlyMeshes=L,this._hookArrayForIncludedOnly(L)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(L){this._excludedMeshes=L,this._hookArrayForExcluded(L)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(L){this._excludeWithLayerMask=L,this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(L){this._includeOnlyWithLayerMask=L,this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(L){this._lightmapMode!==L&&(this._lightmapMode=L,this._markMeshesAsLightDirty())}getViewMatrix(L){return null}getProjectionMatrix(L,j){return null}constructor(L,j){super(L,j,!1),this.cb=new Y.e(1,1,1),this.ij=new Y.e(1,1,1),this.falloffType=V.FALLOFF_DEFAULT,this.bb=1,this._range=Number.MAX_VALUE,this._inverseSquaredRange=0,this._photometricScale=1,this._intensityMode=V.INTENSITYMODE_AUTOMATIC,this._radius=1e-5,this.renderPriority=0,this._shadowEnabled=!0,this._excludeWithLayerMask=0,this._includeOnlyWithLayerMask=0,this._lightmapMode=0,this._shadowGenerators=null,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,this._isLight=!0,this.va().addLight(this),this._uniformBuffer=new a.c(this.va().getEngine(),void 0,void 0,L),this._buildUniformLayout(),this.includedOnlyMeshes=[],this.excludedMeshes=[],this._resyncMeshes()}transferTexturesToEffect(L,j){return this}_bindLight(L,j,P,A){let R=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const o=L.toString();let u=!1;if(this._uniformBuffer.bindToEffect(P,"Light"+o),this._renderId!==j.getRenderId()||this._lastUseSpecular!==A||!this._uniformBuffer.useUbo){this._renderId=j.getRenderId(),this._lastUseSpecular=A;const L=this.getScaledIntensity();this.transferToEffect(P,o),this.cb.scaleToRef(L,Y.l.Zi[0]),this._uniformBuffer.updateColor4("vLightDiffuse",Y.l.Zi[0],this.range,o),A&&(this.ij.scaleToRef(L,Y.l.Zi[1]),this._uniformBuffer.updateColor4("vLightSpecular",Y.l.Zi[1],this.radius,o)),u=!0}if(this.transferTexturesToEffect(P,o),j.shadowsEnabled&&this.shadowEnabled&&R){const L=this.getShadowGenerator(j.activeCamera)??this.getShadowGenerator();L&&(L.bindShadowLight(o,P),u=!0)}u?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(L){let j="Name: "+this.name;if(j+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(let P=0;P<this.animations.length;P++)j+=", animation[0]: "+this.animations[P].toString(L);return j}_syncParentEnabledState(){super._syncParentEnabledState(),this.u()||this._resyncMeshes()}hi(L){super.hi(L),this._resyncMeshes()}getShadowGenerator(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===this._shadowGenerators?null:this._shadowGenerators.get(L)??null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return o.r.Zero()}canAffectMesh(L){return!L||!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(L))&&(!(this.excludedMeshes&&this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(L))&&((0===this.includeOnlyWithLayerMask||0!==(this.includeOnlyWithLayerMask&L.layerMask))&&!(0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&L.layerMask)))}dispose(L){let j=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._shadowGenerators){const L=this._shadowGenerators.values();for(let j=L.next();!0!==j.done;j=L.next()){j.value.dispose()}this._shadowGenerators=null}if(this.va().stopAnimation(this),this._parentContainer){const L=this._parentContainer.lights.indexOf(this);L>-1&&this._parentContainer.lights.splice(L,1),this._parentContainer=null}for(const P of this.va().meshes)P._removeLightSource(this,!0);this._uniformBuffer.dispose(),this.va().removeLight(this),super.dispose(L,j)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.bb}clone(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const P=V.GetConstructorFromName(this.getTypeID(),L,this.va());if(!P)return null;const A=g.e.Clone(P,this);return L&&(A.name=L),j&&(A.parent=j),A.hi(this.isEnabled()),this.onClonedObservable.notifyObservers(A),A}serialize(){const L=g.e.Serialize(this);if(L.uniqueId=this.uniqueId,L.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(L),this.excludedMeshes.length>0){L.excludedMeshesIds=[];for(const j of this.excludedMeshes)L.excludedMeshesIds.push(j.id)}if(this.includedOnlyMeshes.length>0){L.includedOnlyMeshesIds=[];for(const j of this.includedOnlyMeshes)L.includedOnlyMeshesIds.push(j.id)}return g.e.AppendSerializedAnimations(this,L),L.ranges=this.serializeAnimationRanges(),L.isEnabled=this.isEnabled(),L}static GetConstructorFromName(L,j,P){const A=u.e.Construct("Light_Type_"+L,j,P);return A||null}static Parse(L,j){const P=V.GetConstructorFromName(L.type,L.name,j);if(!P)return null;const A=g.e.Parse(P,L,j);if(L.excludedMeshesIds&&(A._excludedMeshesIds=L.excludedMeshesIds),L.includedOnlyMeshesIds&&(A._includedOnlyMeshesIds=L.includedOnlyMeshesIds),void 0!==L.parentId&&(A._waitingParentId=L.parentId),void 0!==L.parentInstanceIndex&&(A._waitingParentInstanceIndex=L.parentInstanceIndex),void 0!==L.falloffType&&(A.falloffType=L.falloffType),void 0!==L.lightmapMode&&(A.lightmapMode=L.lightmapMode),L.animations){for(let j=0;j<L.animations.length;j++){const P=L.animations[j],R=(0,D.e)("BABYLON.Animation");R&&A.animations.push(R.Parse(P))}u.e.ParseAnimationRanges(A,L,j)}return L.autoAnimate&&j.beginAnimation(A,L.autoAnimateFrom,L.autoAnimateTo,L.autoAnimateLoop,L.autoAnimateSpeed||1),void 0!==L.isEnabled&&A.hi(L.isEnabled),A}_hookArrayForExcluded(L){var j=this;const P=L.push;L.push=function(){for(var A=arguments.length,R=new Array(A),o=0;o<A;o++)R[o]=arguments[o];const Y=P.apply(L,R);for(const L of R)L._resyncLightSource(j);return Y};const A=L.splice;L.splice=(j,P)=>{const R=A.apply(L,[j,P]);for(const L of R)L._resyncLightSource(this);return R};for(const R of L)R._resyncLightSource(this)}_hookArrayForIncludedOnly(L){var j=this;const P=L.push;L.push=function(){for(var A=arguments.length,R=new Array(A),o=0;o<A;o++)R[o]=arguments[o];const Y=P.apply(L,R);return j._resyncMeshes(),Y};const A=L.splice;L.splice=(j,P)=>{const R=A.apply(L,[j,P]);return this._resyncMeshes(),R},this._resyncMeshes()}_resyncMeshes(){for(const L of this.va().meshes)L._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const L of this.va().meshes)-1!==L.lightSources.indexOf(this)&&L._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale(),this.va().resetCachedMaterial()}_getPhotometricScale(){let L=0;const j=this.getTypeID();let P=this.intensityMode;switch(P===V.INTENSITYMODE_AUTOMATIC&&(P=j===V.LIGHTTYPEID_DIRECTIONALLIGHT?V.INTENSITYMODE_ILLUMINANCE:V.INTENSITYMODE_LUMINOUSINTENSITY),j){case V.LIGHTTYPEID_POINTLIGHT:case V.LIGHTTYPEID_SPOTLIGHT:switch(P){case V.INTENSITYMODE_LUMINOUSPOWER:L=1/(4*Math.PI);break;case V.INTENSITYMODE_LUMINOUSINTENSITY:L=1;break;case V.INTENSITYMODE_LUMINANCE:L=this.radius*this.radius}break;case V.LIGHTTYPEID_DIRECTIONALLIGHT:switch(P){case V.INTENSITYMODE_ILLUMINANCE:L=1;break;case V.INTENSITYMODE_LUMINANCE:{let j=this.radius;j=Math.max(j,.001);L=2*Math.PI*(1-Math.cos(j));break}}break;case V.LIGHTTYPEID_HEMISPHERICLIGHT:L=1}return L}_reorderLightsInScene(){const L=this.va();0!=this._renderPriority&&(L.requireLightSorting=!0),this.va().sortLightsByPriority()}_isReady(){return!0}}V.FALLOFF_DEFAULT=S.b.FALLOFF_DEFAULT,V.FALLOFF_PHYSICAL=S.b.FALLOFF_PHYSICAL,V.FALLOFF_GLTF=S.b.FALLOFF_GLTF,V.FALLOFF_STANDARD=S.b.FALLOFF_STANDARD,V.LIGHTMAP_DEFAULT=S.b.LIGHTMAP_DEFAULT,V.LIGHTMAP_SPECULAR=S.b.LIGHTMAP_SPECULAR,V.LIGHTMAP_SHADOWSONLY=S.b.LIGHTMAP_SHADOWSONLY,V.INTENSITYMODE_AUTOMATIC=S.b.INTENSITYMODE_AUTOMATIC,V.INTENSITYMODE_LUMINOUSPOWER=S.b.INTENSITYMODE_LUMINOUSPOWER,V.INTENSITYMODE_LUMINOUSINTENSITY=S.b.INTENSITYMODE_LUMINOUSINTENSITY,V.INTENSITYMODE_ILLUMINANCE=S.b.INTENSITYMODE_ILLUMINANCE,V.INTENSITYMODE_LUMINANCE=S.b.INTENSITYMODE_LUMINANCE,V.LIGHTTYPEID_POINTLIGHT=S.b.LIGHTTYPEID_POINTLIGHT,V.LIGHTTYPEID_DIRECTIONALLIGHT=S.b.LIGHTTYPEID_DIRECTIONALLIGHT,V.LIGHTTYPEID_SPOTLIGHT=S.b.LIGHTTYPEID_SPOTLIGHT,V.LIGHTTYPEID_HEMISPHERICLIGHT=S.b.LIGHTTYPEID_HEMISPHERICLIGHT,V.LIGHTTYPEID_RECT_AREALIGHT=S.b.LIGHTTYPEID_RECT_AREALIGHT,(0,A.b)([(0,R.j)()],V.prototype,"diffuse",void 0),(0,A.b)([(0,R.j)()],V.prototype,"specular",void 0),(0,A.b)([(0,R.K)()],V.prototype,"falloffType",void 0),(0,A.b)([(0,R.K)()],V.prototype,"intensity",void 0),(0,A.b)([(0,R.K)()],V.prototype,"range",null),(0,A.b)([(0,R.K)()],V.prototype,"intensityMode",null),(0,A.b)([(0,R.K)()],V.prototype,"radius",null),(0,A.b)([(0,R.K)()],V.prototype,"_renderPriority",void 0),(0,A.b)([(0,R.c)("_reorderLightsInScene")],V.prototype,"renderPriority",void 0),(0,A.b)([(0,R.K)("shadowEnabled")],V.prototype,"_shadowEnabled",void 0),(0,A.b)([(0,R.K)("excludeWithLayerMask")],V.prototype,"_excludeWithLayerMask",void 0),(0,A.b)([(0,R.K)("includeOnlyWithLayerMask")],V.prototype,"_includeOnlyWithLayerMask",void 0),(0,A.b)([(0,R.K)("lightmapMode")],V.prototype,"_lightmapMode",void 0)},11725:(L,j,P)=>{P.d(j,{b:()=>a});var A=P(636),R=P(639),o=P(656),Y=P(11687),u=P(797);class a extends Y.d{constructor(){super(...arguments),this._needProjectionMatrixCompute=!0,this._viewMatrix=o.e.Identity(),this._projectionMatrix=o.e.Identity()}_setPosition(L){this._position=L}get position(){return this._position}set position(L){this._setPosition(L)}_setDirection(L){this._direction=L}get direction(){return this._direction}set direction(L){this._setDirection(L)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(L){this._shadowMinZ=L,this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(L){this._shadowMaxZ=L,this.forceProjectionMatrixCompute()}computeTransformedInformation(){return!(!this.parent||!this.parent.getWorldMatrix)&&(this.transformedPosition||(this.transformedPosition=o.r.Zero()),o.r.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=o.r.Zero()),o.r.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),!0)}getDepthScale(){return 50}getShadowDirection(L){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(L){return this.direction=o.r.Normalize(L.xg(this.position)),this.direction}getRotation(){this.direction.normalize();const L=o.r.Cross(this.direction,u.c.Y),j=o.r.Cross(L,this.direction);return o.r.RotationFromAxis(L,j,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache(),this._cache.position=o.r.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}yi(L){return!L&&this.isSynchronized()?(this._currentRenderId=this.va().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.p(this.position),this._worldMatrix||(this._worldMatrix=o.e.Identity()),o.e.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(L){return void 0!==this.shadowMinZ?this.shadowMinZ:(null===L||void 0===L?void 0:L.Ai)||0}getDepthMaxZ(L){return void 0!==this.shadowMaxZ?this.shadowMaxZ:(null===L||void 0===L?void 0:L.maxZ)||1e4}setShadowProjectionMatrix(L,j,P){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(j,P,L):this._setDefaultShadowProjectionMatrix(L,j,P),this}_syncParentEnabledState(){super._syncParentEnabledState(),this.parent&&this.parent.getWorldMatrix||(this.transformedPosition=null,this.transformedDirection=null)}getViewMatrix(L){const j=o.m.ti[0];let P=this.position;this.computeTransformedInformation()&&(P=this.transformedPosition),o.r.NormalizeToRef(this.getShadowDirection(L),j),1===Math.abs(o.r.Dot(j,o.r.Up()))&&(j.z=1e-13);const A=o.m.ti[1];return P.addToRef(j,A),o.e.LookAtLHToRef(P,A,o.r.Up(),this._viewMatrix),this._viewMatrix}getProjectionMatrix(L,j){return this.setShadowProjectionMatrix(this._projectionMatrix,L??this._viewMatrix,j??[]),this._projectionMatrix}}(0,A.b)([(0,R.J)()],a.prototype,"position",null),(0,A.b)([(0,R.J)()],a.prototype,"direction",null),(0,A.b)([(0,R.K)()],a.prototype,"shadowMinZ",null),(0,A.b)([(0,R.K)()],a.prototype,"shadowMaxZ",null)},11604:(L,j,P)=>{P.d(j,{e:()=>s});var A=P(636),R=P(639),o=P(490),Y=P(650),u=P(11600),a=P(2149),D=P(656),S=P(708),g=P(11612),V=P(11620);class N extends g.d{constructor(){super(...arguments),this.BRDF_V_HEIGHT_CORRELATED=!1,this.MS_BRDF_ENERGY_CONSERVATION=!1,this.SPHERICAL_HARMONICS=!1,this.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=!1,this.MIX_IBL_RADIANCE_WITH_IRRADIANCE=!0,this.LEGACY_SPECULAR_ENERGY_CONSERVATION=!1,this.BASE_DIFFUSE_MODEL=0,this.DIELECTRIC_SPECULAR_MODEL=0,this.CONDUCTOR_SPECULAR_MODEL=0}}class C extends V.c{_markAllSubMeshesAsMiscDirty(){this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"PBRBRDF",90,new N,j),this._useEnergyConservation=C.DEFAULT_USE_ENERGY_CONSERVATION,this.useEnergyConservation=C.DEFAULT_USE_ENERGY_CONSERVATION,this._useSmithVisibilityHeightCorrelated=C.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this.useSmithVisibilityHeightCorrelated=C.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this._useSphericalHarmonics=C.DEFAULT_USE_SPHERICAL_HARMONICS,this.useSphericalHarmonics=C.DEFAULT_USE_SPHERICAL_HARMONICS,this._useSpecularGlossinessInputEnergyConservation=C.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this.useSpecularGlossinessInputEnergyConservation=C.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this._mixIblRadianceWithIrradiance=C.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE,this.mixIblRadianceWithIrradiance=C.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE,this._useLegacySpecularEnergyConservation=C.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION,this.useLegacySpecularEnergyConservation=C.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION,this._baseDiffuseModel=C.DEFAULT_DIFFUSE_MODEL,this.baseDiffuseModel=C.DEFAULT_DIFFUSE_MODEL,this._dielectricSpecularModel=C.DEFAULT_DIELECTRIC_SPECULAR_MODEL,this.dielectricSpecularModel=C.DEFAULT_DIELECTRIC_SPECULAR_MODEL,this._conductorSpecularModel=C.DEFAULT_CONDUCTOR_SPECULAR_MODEL,this.conductorSpecularModel=C.DEFAULT_CONDUCTOR_SPECULAR_MODEL,this._internalMarkAllSubMeshesAsMiscDirty=L._dirtyCallbacks[16],this._enable(!0)}prepareDefines(L){L.BRDF_V_HEIGHT_CORRELATED=this._useSmithVisibilityHeightCorrelated,L.MS_BRDF_ENERGY_CONSERVATION=this._useEnergyConservation&&this._useSmithVisibilityHeightCorrelated,L.SPHERICAL_HARMONICS=this._useSphericalHarmonics,L.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=this._useSpecularGlossinessInputEnergyConservation,L.MIX_IBL_RADIANCE_WITH_IRRADIANCE=this._mixIblRadianceWithIrradiance,L.LEGACY_SPECULAR_ENERGY_CONSERVATION=this._useLegacySpecularEnergyConservation,L.BASE_DIFFUSE_MODEL=this._baseDiffuseModel,L.DIELECTRIC_SPECULAR_MODEL=this._dielectricSpecularModel,L.CONDUCTOR_SPECULAR_MODEL=this._conductorSpecularModel}getClassName(){return"PBRBRDFConfiguration"}}C.DEFAULT_USE_ENERGY_CONSERVATION=!0,C.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED=!0,C.DEFAULT_USE_SPHERICAL_HARMONICS=!0,C.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION=!0,C.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE=!0,C.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION=!0,C.DEFAULT_DIFFUSE_MODEL=0,C.DEFAULT_DIELECTRIC_SPECULAR_MODEL=0,C.DEFAULT_CONDUCTOR_SPECULAR_MODEL=0,(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"useEnergyConservation",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"useSmithVisibilityHeightCorrelated",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"useSphericalHarmonics",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"useSpecularGlossinessInputEnergyConservation",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"mixIblRadianceWithIrradiance",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"useLegacySpecularEnergyConservation",void 0),(0,A.b)([(0,R.K)("baseDiffuseModel"),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"baseDiffuseModel",void 0),(0,A.b)([(0,R.K)("dielectricSpecularModel"),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"dielectricSpecularModel",void 0),(0,A.b)([(0,R.K)("conductorSpecularModel"),(0,R.c)("_markAllSubMeshesAsMiscDirty")],C.prototype,"conductorSpecularModel",void 0);var b=P(11626),f=P(685),h=P(2157),K=P(801),v=P(11634),q=P(2032),y=P(11639),T=(P(2203),P(11644)),G=P(805);class M extends g.d{constructor(){super(...arguments),this.CLEARCOAT=!1,this.CLEARCOAT_DEFAULTIOR=!1,this.CLEARCOAT_TEXTURE=!1,this.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this.CLEARCOAT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,this.CLEARCOAT_BUMP=!1,this.CLEARCOAT_BUMPDIRECTUV=0,this.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,this.CLEARCOAT_REMAP_F0=!1,this.CLEARCOAT_TINT=!1,this.CLEARCOAT_TINT_TEXTURE=!1,this.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TINT_GAMMATEXTURE=!1}}class Q extends V.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"PBRClearCoat",100,new M,j),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.roughness=0,this._indexOfRefraction=Q._DefaultIndexOfRefraction,this.indexOfRefraction=Q._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._textureRoughness=null,this.textureRoughness=null,this._remapF0OnInterfaceChange=!0,this.remapF0OnInterfaceChange=!0,this._bumpTexture=null,this.bumpTexture=null,this._isTintEnabled=!1,this.isTintEnabled=!1,this.tintColor=f.e.White(),this.tintColorAtDistance=1,this.tintThickness=1,this._tintTexture=null,this.tintTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1]}isReadyForSubMesh(L,j,P){if(!this._isEnabled)return!0;const A=this._material._disableBumpMap;if(L._areTexturesDirty&&j.texturesEnabled){if(this._texture&&y.d.ClearCoatTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&y.d.ClearCoatTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1;if(P.getCaps().standardDerivatives&&this._bumpTexture&&y.d.ClearCoatBumpTextureEnabled&&!A&&!this._bumpTexture.isReady())return!1;if(this._isTintEnabled&&this._tintTexture&&y.d.ClearCoatTintTextureEnabled&&!this._tintTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(L,j){this._isEnabled?(L.CLEARCOAT=!0,L.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,L.CLEARCOAT_REMAP_F0=this._remapF0OnInterfaceChange,L._areTexturesDirty&&j.texturesEnabled&&(this._texture&&y.d.ClearCoatTextureEnabled?(0,G.Q)(this._texture,L,"CLEARCOAT_TEXTURE"):L.CLEARCOAT_TEXTURE=!1,this._textureRoughness&&y.d.ClearCoatTextureEnabled?(0,G.Q)(this._textureRoughness,L,"CLEARCOAT_TEXTURE_ROUGHNESS"):L.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this._bumpTexture&&y.d.ClearCoatBumpTextureEnabled?(0,G.Q)(this._bumpTexture,L,"CLEARCOAT_BUMP"):L.CLEARCOAT_BUMP=!1,L.CLEARCOAT_DEFAULTIOR=this._indexOfRefraction===Q._DefaultIndexOfRefraction,this._isTintEnabled?(L.CLEARCOAT_TINT=!0,this._tintTexture&&y.d.ClearCoatTintTextureEnabled?((0,G.Q)(this._tintTexture,L,"CLEARCOAT_TINT_TEXTURE"),L.CLEARCOAT_TINT_GAMMATEXTURE=this._tintTexture.gammaSpace):L.CLEARCOAT_TINT_TEXTURE=!1):(L.CLEARCOAT_TINT=!1,L.CLEARCOAT_TINT_TEXTURE=!1))):(L.CLEARCOAT=!1,L.CLEARCOAT_TEXTURE=!1,L.CLEARCOAT_TEXTURE_ROUGHNESS=!1,L.CLEARCOAT_BUMP=!1,L.CLEARCOAT_TINT=!1,L.CLEARCOAT_TINT_TEXTURE=!1,L.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,L.CLEARCOAT_DEFAULTIOR=!1,L.CLEARCOAT_TEXTUREDIRECTUV=0,L.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,L.CLEARCOAT_BUMPDIRECTUV=0,L.CLEARCOAT_REMAP_F0=!1,L.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,L.CLEARCOAT_TINT_GAMMATEXTURE=!1)}bindForSubMesh(L,j,P,A){if(!this._isEnabled)return;const R=A.materialDefines,o=this._material.isFrozen,Y=this._material._disableBumpMap,u=this._material._invertNormalMapX,a=this._material._invertNormalMapY;if(!L.useUbo||!o||!L.isSync){var D,S,g,V;if((this._texture||this._textureRoughness)&&y.d.ClearCoatTextureEnabled)L.updateFloat4("vClearCoatInfos",(null===(D=this._texture)||void 0===D?void 0:D.coordinatesIndex)??0,(null===(S=this._texture)||void 0===S?void 0:S.level)??0,(null===(g=this._textureRoughness)||void 0===g?void 0:g.coordinatesIndex)??0,(null===(V=this._textureRoughness)||void 0===V?void 0:V.level)??0),this._texture&&(0,G.t)(this._texture,L,"clearCoat"),this._textureRoughness&&!R.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&(0,G.t)(this._textureRoughness,L,"clearCoatRoughness");this._bumpTexture&&P.getCaps().standardDerivatives&&y.d.ClearCoatTextureEnabled&&!Y&&(L.updateFloat2("vClearCoatBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level),(0,G.t)(this._bumpTexture,L,"clearCoatBump"),j._mirroredCameraPosition?L.updateFloat2("vClearCoatTangentSpaceParams",u?1:-1,a?1:-1):L.updateFloat2("vClearCoatTangentSpaceParams",u?-1:1,a?-1:1)),this._tintTexture&&y.d.ClearCoatTintTextureEnabled&&(L.updateFloat2("vClearCoatTintInfos",this._tintTexture.coordinatesIndex,this._tintTexture.level),(0,G.t)(this._tintTexture,L,"clearCoatTint")),L.updateFloat2("vClearCoatParams",this.bb,this.roughness);const A=1-this._indexOfRefraction,o=1+this._indexOfRefraction,N=Math.pow(-A/o,2),C=1/this._indexOfRefraction;L.updateFloat4("vClearCoatRefractionParams",N,C,A,o),this._isTintEnabled&&(L.updateFloat4("vClearCoatTintParams",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintThickness)),L.updateFloat("clearCoatColorAtDistance",Math.max(1e-5,this.tintColorAtDistance)))}j.texturesEnabled&&(this._texture&&y.d.ClearCoatTextureEnabled&&L.setTexture("clearCoatSampler",this._texture),this._textureRoughness&&!R.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&y.d.ClearCoatTextureEnabled&&L.setTexture("clearCoatRoughnessSampler",this._textureRoughness),this._bumpTexture&&P.getCaps().standardDerivatives&&y.d.ClearCoatBumpTextureEnabled&&!Y&&L.setTexture("clearCoatBumpSampler",this._bumpTexture),this._isTintEnabled&&this._tintTexture&&y.d.ClearCoatTintTextureEnabled&&L.setTexture("clearCoatTintSampler",this._tintTexture))}hasTexture(L){return this._texture===L||(this._textureRoughness===L||(this._bumpTexture===L||this._tintTexture===L))}getActiveTextures(L){this._texture&&L.push(this._texture),this._textureRoughness&&L.push(this._textureRoughness),this._bumpTexture&&L.push(this._bumpTexture),this._tintTexture&&L.push(this._tintTexture)}getAnimatables(L){this._texture&&this._texture.animations&&this._texture.animations.length>0&&L.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&L.push(this._textureRoughness),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&L.push(this._bumpTexture),this._tintTexture&&this._tintTexture.animations&&this._tintTexture.animations.length>0&&L.push(this._tintTexture)}dispose(L){var j,P,A,R;L&&(null===(j=this._texture)||void 0===j||j.dispose(),null===(P=this._textureRoughness)||void 0===P||P.dispose(),null===(A=this._bumpTexture)||void 0===A||A.dispose(),null===(R=this._tintTexture)||void 0===R||R.dispose())}getClassName(){return"PBRClearCoatConfiguration"}addFallbacks(L,j,P){return L.CLEARCOAT_BUMP&&j.addFallback(P++,"CLEARCOAT_BUMP"),L.CLEARCOAT_TINT&&j.addFallback(P++,"CLEARCOAT_TINT"),L.CLEARCOAT&&j.addFallback(P++,"CLEARCOAT"),P}getSamplers(L){L.push("clearCoatSampler","clearCoatRoughnessSampler","clearCoatBumpSampler","clearCoatTintSampler")}getUniforms(){return{ubo:[{name:"vClearCoatParams",size:2,type:"vec2"},{name:"vClearCoatRefractionParams",size:4,type:"vec4"},{name:"vClearCoatInfos",size:4,type:"vec4"},{name:"clearCoatMatrix",size:16,type:"mat4"},{name:"clearCoatRoughnessMatrix",size:16,type:"mat4"},{name:"vClearCoatBumpInfos",size:2,type:"vec2"},{name:"vClearCoatTangentSpaceParams",size:2,type:"vec2"},{name:"clearCoatBumpMatrix",size:16,type:"mat4"},{name:"vClearCoatTintParams",size:4,type:"vec4"},{name:"clearCoatColorAtDistance",size:1,type:"float"},{name:"vClearCoatTintInfos",size:2,type:"vec2"},{name:"clearCoatTintMatrix",size:16,type:"mat4"}]}}}Q._DefaultIndexOfRefraction=1.5,(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"isEnabled",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"intensity",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"roughness",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"indexOfRefraction",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"texture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useRoughnessFromMainTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"textureRoughness",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"remapF0OnInterfaceChange",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"bumpTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"isTintEnabled",void 0),(0,A.b)([(0,R.j)()],Q.prototype,"tintColor",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"tintColorAtDistance",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"tintThickness",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"tintTexture",void 0);class l extends g.d{constructor(){super(...arguments),this.IRIDESCENCE=!1,this.IRIDESCENCE_TEXTURE=!1,this.IRIDESCENCE_TEXTUREDIRECTUV=0,this.IRIDESCENCE_THICKNESS_TEXTURE=!1,this.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0}}class w extends V.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"PBRIridescence",110,new l,j),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.minimumThickness=w._DefaultMinimumThickness,this.maximumThickness=w._DefaultMaximumThickness,this.indexOfRefraction=w._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._thicknessTexture=null,this.thicknessTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1]}isReadyForSubMesh(L,j){if(!this._isEnabled)return!0;if(L._areTexturesDirty&&j.texturesEnabled){if(this._texture&&y.d.IridescenceTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._thicknessTexture&&y.d.IridescenceTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(L,j){this._isEnabled?(L.IRIDESCENCE=!0,L._areTexturesDirty&&j.texturesEnabled&&(this._texture&&y.d.IridescenceTextureEnabled?(0,G.Q)(this._texture,L,"IRIDESCENCE_TEXTURE"):L.IRIDESCENCE_TEXTURE=!1,this._thicknessTexture&&y.d.IridescenceTextureEnabled?(0,G.Q)(this._thicknessTexture,L,"IRIDESCENCE_THICKNESS_TEXTURE"):L.IRIDESCENCE_THICKNESS_TEXTURE=!1)):(L.IRIDESCENCE=!1,L.IRIDESCENCE_TEXTURE=!1,L.IRIDESCENCE_THICKNESS_TEXTURE=!1,L.IRIDESCENCE_TEXTUREDIRECTUV=0,L.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0)}bindForSubMesh(L,j){if(!this._isEnabled)return;const P=this._material.isFrozen;if(!L.useUbo||!P||!L.isSync){var A,R,o,Y;if((this._texture||this._thicknessTexture)&&y.d.IridescenceTextureEnabled)L.updateFloat4("vIridescenceInfos",(null===(A=this._texture)||void 0===A?void 0:A.coordinatesIndex)??0,(null===(R=this._texture)||void 0===R?void 0:R.level)??0,(null===(o=this._thicknessTexture)||void 0===o?void 0:o.coordinatesIndex)??0,(null===(Y=this._thicknessTexture)||void 0===Y?void 0:Y.level)??0),this._texture&&(0,G.t)(this._texture,L,"iridescence"),this._thicknessTexture&&(0,G.t)(this._thicknessTexture,L,"iridescenceThickness");L.updateFloat4("vIridescenceParams",this.bb,this.indexOfRefraction,this.minimumThickness,this.maximumThickness)}j.texturesEnabled&&(this._texture&&y.d.IridescenceTextureEnabled&&L.setTexture("iridescenceSampler",this._texture),this._thicknessTexture&&y.d.IridescenceTextureEnabled&&L.setTexture("iridescenceThicknessSampler",this._thicknessTexture))}hasTexture(L){return this._texture===L||this._thicknessTexture===L}getActiveTextures(L){this._texture&&L.push(this._texture),this._thicknessTexture&&L.push(this._thicknessTexture)}getAnimatables(L){this._texture&&this._texture.animations&&this._texture.animations.length>0&&L.push(this._texture),this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&L.push(this._thicknessTexture)}dispose(L){var j,P;L&&(null===(j=this._texture)||void 0===j||j.dispose(),null===(P=this._thicknessTexture)||void 0===P||P.dispose())}getClassName(){return"PBRIridescenceConfiguration"}addFallbacks(L,j,P){return L.IRIDESCENCE&&j.addFallback(P++,"IRIDESCENCE"),P}getSamplers(L){L.push("iridescenceSampler","iridescenceThicknessSampler")}getUniforms(){return{ubo:[{name:"vIridescenceParams",size:4,type:"vec4"},{name:"vIridescenceInfos",size:4,type:"vec4"},{name:"iridescenceMatrix",size:16,type:"mat4"},{name:"iridescenceThicknessMatrix",size:16,type:"mat4"}]}}}w._DefaultMinimumThickness=100,w._DefaultMaximumThickness=400,w._DefaultIndexOfRefraction=1.3,(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],w.prototype,"isEnabled",void 0),(0,A.b)([(0,R.K)()],w.prototype,"intensity",void 0),(0,A.b)([(0,R.K)()],w.prototype,"minimumThickness",void 0),(0,A.b)([(0,R.K)()],w.prototype,"maximumThickness",void 0),(0,A.b)([(0,R.K)()],w.prototype,"indexOfRefraction",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],w.prototype,"texture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],w.prototype,"thicknessTexture",void 0);class d extends g.d{constructor(){super(...arguments),this.ANISOTROPIC=!1,this.ANISOTROPIC_TEXTURE=!1,this.ANISOTROPIC_TEXTUREDIRECTUV=0,this.ANISOTROPIC_LEGACY=!1,this.MAINUV1=!1}}class c extends V.c{set angle(L){this.direction.x=Math.cos(L),this.direction.y=Math.sin(L)}get angle(){return Math.atan2(this.direction.y,this.direction.x)}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markAllSubMeshesAsMiscDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"PBRAnisotropic",110,new d,j),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.direction=new D.n(1,0),this._texture=null,this.texture=null,this._legacy=!1,this.legacy=!1,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1],this._internalMarkAllSubMeshesAsMiscDirty=L._dirtyCallbacks[16]}isReadyForSubMesh(L,j){return!this._isEnabled||!(L._areTexturesDirty&&j.texturesEnabled&&this._texture&&y.d.AnisotropicTextureEnabled&&!this._texture.isReadyOrNotBlocking())}prepareDefinesBeforeAttributes(L,j,P){this._isEnabled?(L.ANISOTROPIC=this._isEnabled,this._isEnabled&&!P.isVerticesDataPresent(S.e.TangentKind)&&(L._needUVs=!0,L.MAINUV1=!0),L._areTexturesDirty&&j.texturesEnabled&&(this._texture&&y.d.AnisotropicTextureEnabled?(0,G.Q)(this._texture,L,"ANISOTROPIC_TEXTURE"):L.ANISOTROPIC_TEXTURE=!1),L._areMiscDirty&&(L.ANISOTROPIC_LEGACY=this._legacy)):(L.ANISOTROPIC=!1,L.ANISOTROPIC_TEXTURE=!1,L.ANISOTROPIC_TEXTUREDIRECTUV=0,L.ANISOTROPIC_LEGACY=!1)}bindForSubMesh(L,j){if(!this._isEnabled)return;const P=this._material.isFrozen;L.useUbo&&P&&L.isSync||(this._texture&&y.d.AnisotropicTextureEnabled&&(L.updateFloat2("vAnisotropyInfos",this._texture.coordinatesIndex,this._texture.level),(0,G.t)(this._texture,L,"anisotropy")),L.updateFloat3("vAnisotropy",this.direction.x,this.direction.y,this.bb)),j.texturesEnabled&&this._texture&&y.d.AnisotropicTextureEnabled&&L.setTexture("anisotropySampler",this._texture)}hasTexture(L){return this._texture===L}getActiveTextures(L){this._texture&&L.push(this._texture)}getAnimatables(L){this._texture&&this._texture.animations&&this._texture.animations.length>0&&L.push(this._texture)}dispose(L){L&&this._texture&&this._texture.dispose()}getClassName(){return"PBRAnisotropicConfiguration"}addFallbacks(L,j,P){return L.ANISOTROPIC&&j.addFallback(P++,"ANISOTROPIC"),P}getSamplers(L){L.push("anisotropySampler")}getUniforms(){return{ubo:[{name:"vAnisotropy",size:3,type:"vec3"},{name:"vAnisotropyInfos",size:2,type:"vec2"},{name:"anisotropyMatrix",size:16,type:"mat4"}]}}parse(L,j,P){super.parse(L,j,P),void 0===L.legacy&&(this.legacy=!0)}}(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"isEnabled",void 0),(0,A.b)([(0,R.K)()],c.prototype,"intensity",void 0),(0,A.b)([(0,R.I)()],c.prototype,"direction",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],c.prototype,"texture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],c.prototype,"legacy",void 0);class E extends g.d{constructor(){super(...arguments),this.SHEEN=!1,this.SHEEN_TEXTURE=!1,this.SHEEN_GAMMATEXTURE=!1,this.SHEEN_TEXTURE_ROUGHNESS=!1,this.SHEEN_TEXTUREDIRECTUV=0,this.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0,this.SHEEN_LINKWITHALBEDO=!1,this.SHEEN_ROUGHNESS=!1,this.SHEEN_ALBEDOSCALING=!1,this.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1}}class U extends V.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"Sheen",120,new E,j),this._isEnabled=!1,this.isEnabled=!1,this._linkSheenWithAlbedo=!1,this.linkSheenWithAlbedo=!1,this.bb=1,this.color=f.e.White(),this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._roughness=null,this.roughness=null,this._textureRoughness=null,this.textureRoughness=null,this._albedoScaling=!1,this.albedoScaling=!1,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1]}isReadyForSubMesh(L,j){if(!this._isEnabled)return!0;if(L._areTexturesDirty&&j.texturesEnabled){if(this._texture&&y.d.SheenTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&y.d.SheenTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(L,j){this._isEnabled?(L.SHEEN=!0,L.SHEEN_LINKWITHALBEDO=this._linkSheenWithAlbedo,L.SHEEN_ROUGHNESS=null!==this._roughness,L.SHEEN_ALBEDOSCALING=this._albedoScaling,L.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,L._areTexturesDirty&&j.texturesEnabled&&(this._texture&&y.d.SheenTextureEnabled?((0,G.Q)(this._texture,L,"SHEEN_TEXTURE"),L.SHEEN_GAMMATEXTURE=this._texture.gammaSpace):L.SHEEN_TEXTURE=!1,this._textureRoughness&&y.d.SheenTextureEnabled?(0,G.Q)(this._textureRoughness,L,"SHEEN_TEXTURE_ROUGHNESS"):L.SHEEN_TEXTURE_ROUGHNESS=!1)):(L.SHEEN=!1,L.SHEEN_TEXTURE=!1,L.SHEEN_TEXTURE_ROUGHNESS=!1,L.SHEEN_LINKWITHALBEDO=!1,L.SHEEN_ROUGHNESS=!1,L.SHEEN_ALBEDOSCALING=!1,L.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,L.SHEEN_GAMMATEXTURE=!1,L.SHEEN_TEXTUREDIRECTUV=0,L.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0)}bindForSubMesh(L,j,P,A){if(!this._isEnabled)return;const R=A.materialDefines,o=this._material.isFrozen;if(!L.useUbo||!o||!L.isSync){var Y,u,a,D;if((this._texture||this._textureRoughness)&&y.d.SheenTextureEnabled)L.updateFloat4("vSheenInfos",(null===(Y=this._texture)||void 0===Y?void 0:Y.coordinatesIndex)??0,(null===(u=this._texture)||void 0===u?void 0:u.level)??0,(null===(a=this._textureRoughness)||void 0===a?void 0:a.coordinatesIndex)??0,(null===(D=this._textureRoughness)||void 0===D?void 0:D.level)??0),this._texture&&(0,G.t)(this._texture,L,"sheen"),this._textureRoughness&&!R.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&(0,G.t)(this._textureRoughness,L,"sheenRoughness");L.updateFloat4("vSheenColor",this.color.r,this.color.g,this.color.b,this.bb),null!==this._roughness&&L.updateFloat("vSheenRoughness",this._roughness)}j.texturesEnabled&&(this._texture&&y.d.SheenTextureEnabled&&L.setTexture("sheenSampler",this._texture),this._textureRoughness&&!R.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&y.d.SheenTextureEnabled&&L.setTexture("sheenRoughnessSampler",this._textureRoughness))}hasTexture(L){return this._texture===L||this._textureRoughness===L}getActiveTextures(L){this._texture&&L.push(this._texture),this._textureRoughness&&L.push(this._textureRoughness)}getAnimatables(L){this._texture&&this._texture.animations&&this._texture.animations.length>0&&L.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&L.push(this._textureRoughness)}dispose(L){var j,P;L&&(null===(j=this._texture)||void 0===j||j.dispose(),null===(P=this._textureRoughness)||void 0===P||P.dispose())}getClassName(){return"PBRSheenConfiguration"}addFallbacks(L,j,P){return L.SHEEN&&j.addFallback(P++,"SHEEN"),P}getSamplers(L){L.push("sheenSampler","sheenRoughnessSampler")}getUniforms(){return{ubo:[{name:"vSheenColor",size:4,type:"vec4"},{name:"vSheenRoughness",size:1,type:"float"},{name:"vSheenInfos",size:4,type:"vec4"},{name:"sheenMatrix",size:16,type:"mat4"},{name:"sheenRoughnessMatrix",size:16,type:"mat4"}]}}}(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"isEnabled",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"linkSheenWithAlbedo",void 0),(0,A.b)([(0,R.K)()],U.prototype,"intensity",void 0),(0,A.b)([(0,R.j)()],U.prototype,"color",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"texture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"useRoughnessFromMainTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"roughness",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"textureRoughness",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],U.prototype,"albedoScaling",void 0);class t extends g.d{constructor(){super(...arguments),this.SUBSURFACE=!1,this.SS_REFRACTION=!1,this.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_TRANSLUCENCY=!1,this.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_SCATTERING=!1,this.SS_DISPERSION=!1,this.SS_THICKNESSANDMASK_TEXTURE=!1,this.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,this.SS_HAS_THICKNESS=!1,this.SS_REFRACTIONINTENSITY_TEXTURE=!1,this.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,this.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,this.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=!1,this.SS_REFRACTIONMAP_3D=!1,this.SS_REFRACTIONMAP_OPPOSITEZ=!1,this.SS_LODINREFRACTIONALPHA=!1,this.SS_GAMMAREFRACTION=!1,this.SS_RGBDREFRACTION=!1,this.SS_LINEARSPECULARREFRACTION=!1,this.SS_LINKREFRACTIONTOTRANSPARENCY=!1,this.SS_ALBEDOFORREFRACTIONTINT=!1,this.SS_ALBEDOFORTRANSLUCENCYTINT=!1,this.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.SS_USE_THICKNESS_AS_DEPTH=!1,this.SS_USE_GLTF_TEXTURES=!1,this.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=!1,this.SS_TRANSLUCENCY_LEGACY=!1}}class B extends V.c{get scatteringDiffusionProfile(){return this._scene.subSurfaceConfiguration?this._scene.subSurfaceConfiguration.ssDiffusionProfileColors[this._scatteringDiffusionProfileIndex]:null}set scatteringDiffusionProfile(L){this._scene.enableSubSurfaceForPrePass()&&L&&(this._scatteringDiffusionProfileIndex=this._scene.subSurfaceConfiguration.addDiffusionProfile(L))}get volumeIndexOfRefraction(){return this._volumeIndexOfRefraction>=1?this._volumeIndexOfRefraction:this._indexOfRefraction}set volumeIndexOfRefraction(L){this._volumeIndexOfRefraction=L>=1?L:-1}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markScenePrePassDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty(),this._internalMarkScenePrePassDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"PBRSubSurface",130,new t,j),this._isRefractionEnabled=!1,this.isRefractionEnabled=!1,this._isTranslucencyEnabled=!1,this.isTranslucencyEnabled=!1,this._isDispersionEnabled=!1,this.isDispersionEnabled=!1,this._isScatteringEnabled=!1,this.isScatteringEnabled=!1,this._scatteringDiffusionProfileIndex=0,this.refractionIntensity=1,this.translucencyIntensity=1,this.useAlbedoToTintRefraction=!1,this.useAlbedoToTintTranslucency=!1,this._thicknessTexture=null,this.thicknessTexture=null,this._refractionTexture=null,this.refractionTexture=null,this._indexOfRefraction=1.5,this.indexOfRefraction=1.5,this._volumeIndexOfRefraction=-1,this._invertRefractionY=!1,this.invertRefractionY=!1,this._linkRefractionWithTransparency=!1,this.linkRefractionWithTransparency=!1,this.minimumThickness=0,this.maximumThickness=1,this.useThicknessAsDepth=!1,this.tintColor=f.e.White(),this.tintColorAtDistance=1,this.dispersion=0,this.diffusionDistance=f.e.White(),this._useMaskFromThicknessTexture=!1,this.useMaskFromThicknessTexture=!1,this._refractionIntensityTexture=null,this.refractionIntensityTexture=null,this._translucencyIntensityTexture=null,this.translucencyIntensityTexture=null,this.translucencyColor=null,this._translucencyColorTexture=null,this.translucencyColorTexture=null,this._useGltfStyleTextures=!0,this.useGltfStyleTextures=!0,this.applyAlbedoAfterSubSurface=B.DEFAULT_APPLY_ALBEDO_AFTERSUBSURFACE,this.legacyTransluceny=B.DEFAULT_LEGACY_TRANSLUCENCY,this._scene=L.va(),this.registerForExtraEvents=!0,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1],this._internalMarkScenePrePassDirty=L._dirtyCallbacks[32]}isReadyForSubMesh(L,j){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return!0;if(L._areTexturesDirty&&j.texturesEnabled){if(this._thicknessTexture&&y.d.ThicknessTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1;if(this._translucencyColorTexture&&y.d.TranslucencyColorTextureEnabled&&!this._translucencyColorTexture.isReadyOrNotBlocking())return!1;if(this._translucencyIntensityTexture&&y.d.TranslucencyIntensityTextureEnabled&&!this._translucencyIntensityTexture.isReadyOrNotBlocking())return!1;const L=this._getRefractionTexture(j);if(L&&y.d.RefractionTextureEnabled&&!L.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(L,j){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return L.SUBSURFACE=!1,L.SS_DISPERSION=!1,L.SS_TRANSLUCENCY=!1,L.SS_SCATTERING=!1,L.SS_REFRACTION=!1,L.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,L.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,L.SS_THICKNESSANDMASK_TEXTURE=!1,L.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,L.SS_HAS_THICKNESS=!1,L.SS_REFRACTIONINTENSITY_TEXTURE=!1,L.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,L.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,L.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,L.SS_REFRACTIONMAP_3D=!1,L.SS_REFRACTIONMAP_OPPOSITEZ=!1,L.SS_LODINREFRACTIONALPHA=!1,L.SS_GAMMAREFRACTION=!1,L.SS_RGBDREFRACTION=!1,L.SS_LINEARSPECULARREFRACTION=!1,L.SS_LINKREFRACTIONTOTRANSPARENCY=!1,L.SS_ALBEDOFORREFRACTIONTINT=!1,L.SS_ALBEDOFORTRANSLUCENCYTINT=!1,L.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,L.SS_USE_THICKNESS_AS_DEPTH=!1,L.SS_USE_GLTF_TEXTURES=!1,L.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,L.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0,L.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=!1,void(L.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=!1);if(L._areTexturesDirty){if(L.SUBSURFACE=!0,L.SS_DISPERSION=this._isDispersionEnabled,L.SS_TRANSLUCENCY=this._isTranslucencyEnabled,L.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,L.SS_TRANSLUCENCY_LEGACY=this.legacyTransluceny,L.SS_SCATTERING=this._isScatteringEnabled,L.SS_THICKNESSANDMASK_TEXTURE=!1,L.SS_REFRACTIONINTENSITY_TEXTURE=!1,L.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,L.SS_HAS_THICKNESS=!1,L.SS_USE_GLTF_TEXTURES=!1,L.SS_REFRACTION=!1,L.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,L.SS_REFRACTIONMAP_3D=!1,L.SS_GAMMAREFRACTION=!1,L.SS_RGBDREFRACTION=!1,L.SS_LINEARSPECULARREFRACTION=!1,L.SS_REFRACTIONMAP_OPPOSITEZ=!1,L.SS_LODINREFRACTIONALPHA=!1,L.SS_LINKREFRACTIONTOTRANSPARENCY=!1,L.SS_ALBEDOFORREFRACTIONTINT=!1,L.SS_ALBEDOFORTRANSLUCENCYTINT=!1,L.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,L.SS_USE_THICKNESS_AS_DEPTH=!1,L.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,L.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=this.applyAlbedoAfterSubSurface,L._areTexturesDirty&&j.texturesEnabled&&(this._thicknessTexture&&y.d.ThicknessTextureEnabled&&(0,G.Q)(this._thicknessTexture,L,"SS_THICKNESSANDMASK_TEXTURE"),this._refractionIntensityTexture&&y.d.RefractionIntensityTextureEnabled&&(0,G.Q)(this._refractionIntensityTexture,L,"SS_REFRACTIONINTENSITY_TEXTURE"),this._translucencyIntensityTexture&&y.d.TranslucencyIntensityTextureEnabled&&(0,G.Q)(this._translucencyIntensityTexture,L,"SS_TRANSLUCENCYINTENSITY_TEXTURE"),this._translucencyColorTexture&&y.d.TranslucencyColorTextureEnabled&&((0,G.Q)(this._translucencyColorTexture,L,"SS_TRANSLUCENCYCOLOR_TEXTURE"),L.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=this._translucencyColorTexture.gammaSpace)),L.SS_HAS_THICKNESS=this.maximumThickness-this.minimumThickness!==0,L.SS_USE_GLTF_TEXTURES=this._useGltfStyleTextures,L.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._refractionIntensityTexture,L.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._translucencyIntensityTexture,this._isRefractionEnabled&&j.texturesEnabled){const P=this._getRefractionTexture(j);P&&y.d.RefractionTextureEnabled&&(L.SS_REFRACTION=!0,L.SS_REFRACTIONMAP_3D=P.isCube,L.SS_GAMMAREFRACTION=P.gammaSpace,L.SS_RGBDREFRACTION=P.isRGBD,L.SS_LINEARSPECULARREFRACTION=P.linearSpecularLOD,L.SS_REFRACTIONMAP_OPPOSITEZ=this._scene.useRightHandedSystem&&P.isCube?!P.invertZ:P.invertZ,L.SS_LODINREFRACTIONALPHA=P.lodLevelInAlpha,L.SS_LINKREFRACTIONTOTRANSPARENCY=this._linkRefractionWithTransparency,L.SS_ALBEDOFORREFRACTIONTINT=this.useAlbedoToTintRefraction,L.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=P.isCube&&P.boundingBoxSize,L.SS_USE_THICKNESS_AS_DEPTH=this.useThicknessAsDepth)}this._isTranslucencyEnabled&&(L.SS_ALBEDOFORTRANSLUCENCYTINT=this.useAlbedoToTintTranslucency)}}hardBindForSubMesh(L,j,P,A){if(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled)if(0===this.maximumThickness&&0===this.minimumThickness)L.updateFloat2("vThicknessParam",0,0);else{A.getRenderingMesh().getWorldMatrix().decompose(D.m.ti[0]);const j=Math.max(Math.abs(D.m.ti[0].x),Math.abs(D.m.ti[0].y),Math.abs(D.m.ti[0].z));L.updateFloat2("vThicknessParam",this.minimumThickness*j,(this.maximumThickness-this.minimumThickness)*j)}}bindForSubMesh(L,j,P,A){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return;const R=A.materialDefines,o=this._material.isFrozen,Y=this._material.realTimeFiltering,u=R.LODBASEDMICROSFURACE,a=this._getRefractionTexture(j);if(!L.useUbo||!o||!L.isSync){if(this._thicknessTexture&&y.d.ThicknessTextureEnabled&&(L.updateFloat2("vThicknessInfos",this._thicknessTexture.coordinatesIndex,this._thicknessTexture.level),(0,G.t)(this._thicknessTexture,L,"thickness")),this._refractionIntensityTexture&&y.d.RefractionIntensityTextureEnabled&&R.SS_REFRACTIONINTENSITY_TEXTURE&&(L.updateFloat2("vRefractionIntensityInfos",this._refractionIntensityTexture.coordinatesIndex,this._refractionIntensityTexture.level),(0,G.t)(this._refractionIntensityTexture,L,"refractionIntensity")),this._translucencyColorTexture&&y.d.TranslucencyColorTextureEnabled&&R.SS_TRANSLUCENCYCOLOR_TEXTURE&&(L.updateFloat2("vTranslucencyColorInfos",this._translucencyColorTexture.coordinatesIndex,this._translucencyColorTexture.level),(0,G.t)(this._translucencyColorTexture,L,"translucencyColor")),this._translucencyIntensityTexture&&y.d.TranslucencyIntensityTextureEnabled&&R.SS_TRANSLUCENCYINTENSITY_TEXTURE&&(L.updateFloat2("vTranslucencyIntensityInfos",this._translucencyIntensityTexture.coordinatesIndex,this._translucencyIntensityTexture.level),(0,G.t)(this._translucencyIntensityTexture,L,"translucencyIntensity")),a&&y.d.RefractionTextureEnabled){L.cj("refractionMatrix",a.getRefractionTextureMatrix());let j=1;a.isCube||a.depth&&(j=a.depth);const P=a.getSize().width,A=this.volumeIndexOfRefraction;if(L.updateFloat4("vRefractionInfos",a.level,1/A,j,this._invertRefractionY?-1:1),L.updateFloat4("vRefractionMicrosurfaceInfos",P,a.lodGenerationScale,a.lodGenerationOffset,1/this.indexOfRefraction),Y&&L.updateFloat2("vRefractionFilteringInfo",P,Math.log2(P)),a.boundingBoxSize){const j=a;L.updateVector3("vRefractionPosition",j.boundingBoxPosition),L.updateVector3("vRefractionSize",j.boundingBoxSize)}}this._isScatteringEnabled&&L.updateFloat("scatteringDiffusionProfile",this._scatteringDiffusionProfileIndex),L.updateColor3("vDiffusionDistance",this.diffusionDistance),L.updateFloat4("vTintColor",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintColorAtDistance)),L.updateColor4("vTranslucencyColor",this.translucencyColor??this.tintColor,0),L.updateFloat3("vSubSurfaceIntensity",this.refractionIntensity,this.translucencyIntensity,0),L.updateFloat("dispersion",this.dispersion)}j.texturesEnabled&&(this._thicknessTexture&&y.d.ThicknessTextureEnabled&&L.setTexture("thicknessSampler",this._thicknessTexture),this._refractionIntensityTexture&&y.d.RefractionIntensityTextureEnabled&&R.SS_REFRACTIONINTENSITY_TEXTURE&&L.setTexture("refractionIntensitySampler",this._refractionIntensityTexture),this._translucencyIntensityTexture&&y.d.TranslucencyIntensityTextureEnabled&&R.SS_TRANSLUCENCYINTENSITY_TEXTURE&&L.setTexture("translucencyIntensitySampler",this._translucencyIntensityTexture),this._translucencyColorTexture&&y.d.TranslucencyColorTextureEnabled&&R.SS_TRANSLUCENCYCOLOR_TEXTURE&&L.setTexture("translucencyColorSampler",this._translucencyColorTexture),a&&y.d.RefractionTextureEnabled&&(u?L.setTexture("refractionSampler",a):(L.setTexture("refractionSampler",a._lodTextureMid||a),L.setTexture("refractionSamplerLow",a._lodTextureLow||a),L.setTexture("refractionSamplerHigh",a._lodTextureHigh||a))))}_getRefractionTexture(L){return this._refractionTexture?this._refractionTexture:this._isRefractionEnabled?L.environmentTexture:null}get disableAlphaBlending(){return this._isRefractionEnabled&&this._linkRefractionWithTransparency}fillRenderTargetTextures(L){y.d.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&L.push(this._refractionTexture)}hasTexture(L){return this._thicknessTexture===L||(this._refractionTexture===L||(this._refractionIntensityTexture===L||(this._translucencyIntensityTexture===L||this._translucencyColorTexture===L)))}hasRenderTargetTextures(){return!!(y.d.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)}getActiveTextures(L){this._thicknessTexture&&L.push(this._thicknessTexture),this._refractionTexture&&L.push(this._refractionTexture),this._translucencyColorTexture&&L.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&L.push(this._translucencyIntensityTexture)}getAnimatables(L){this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&L.push(this._thicknessTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&L.push(this._refractionTexture),this._translucencyColorTexture&&this._translucencyColorTexture.animations&&this._translucencyColorTexture.animations.length>0&&L.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.animations&&this._translucencyIntensityTexture.animations.length>0&&L.push(this._translucencyIntensityTexture)}dispose(L){L&&(this._thicknessTexture&&this._thicknessTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose(),this._translucencyColorTexture&&this._translucencyColorTexture.dispose(),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.dispose())}getClassName(){return"PBRSubSurfaceConfiguration"}addFallbacks(L,j,P){return L.SS_SCATTERING&&j.addFallback(P++,"SS_SCATTERING"),L.SS_TRANSLUCENCY&&j.addFallback(P++,"SS_TRANSLUCENCY"),P}getSamplers(L){L.push("thicknessSampler","refractionIntensitySampler","translucencyIntensitySampler","refractionSampler","refractionSamplerLow","refractionSamplerHigh","translucencyColorSampler")}getUniforms(){return{ubo:[{name:"vRefractionMicrosurfaceInfos",size:4,type:"vec4"},{name:"vRefractionFilteringInfo",size:2,type:"vec2"},{name:"vTranslucencyIntensityInfos",size:2,type:"vec2"},{name:"vRefractionInfos",size:4,type:"vec4"},{name:"refractionMatrix",size:16,type:"mat4"},{name:"vThicknessInfos",size:2,type:"vec2"},{name:"vRefractionIntensityInfos",size:2,type:"vec2"},{name:"thicknessMatrix",size:16,type:"mat4"},{name:"refractionIntensityMatrix",size:16,type:"mat4"},{name:"translucencyIntensityMatrix",size:16,type:"mat4"},{name:"vThicknessParam",size:2,type:"vec2"},{name:"vDiffusionDistance",size:3,type:"vec3"},{name:"vTintColor",size:4,type:"vec4"},{name:"vSubSurfaceIntensity",size:3,type:"vec3"},{name:"vRefractionPosition",size:3,type:"vec3"},{name:"vRefractionSize",size:3,type:"vec3"},{name:"scatteringDiffusionProfile",size:1,type:"float"},{name:"dispersion",size:1,type:"float"},{name:"vTranslucencyColor",size:4,type:"vec4"},{name:"vTranslucencyColorInfos",size:2,type:"vec2"},{name:"translucencyColorMatrix",size:16,type:"mat4"}]}}}B.DEFAULT_APPLY_ALBEDO_AFTERSUBSURFACE=!1,B.DEFAULT_LEGACY_TRANSLUCENCY=!1,(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"isRefractionEnabled",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"isTranslucencyEnabled",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"isDispersionEnabled",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markScenePrePassDirty")],B.prototype,"isScatteringEnabled",void 0),(0,A.b)([(0,R.K)()],B.prototype,"_scatteringDiffusionProfileIndex",void 0),(0,A.b)([(0,R.K)()],B.prototype,"refractionIntensity",void 0),(0,A.b)([(0,R.K)()],B.prototype,"translucencyIntensity",void 0),(0,A.b)([(0,R.K)()],B.prototype,"useAlbedoToTintRefraction",void 0),(0,A.b)([(0,R.K)()],B.prototype,"useAlbedoToTintTranslucency",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"thicknessTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"refractionTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"indexOfRefraction",void 0),(0,A.b)([(0,R.K)()],B.prototype,"_volumeIndexOfRefraction",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"volumeIndexOfRefraction",null),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"invertRefractionY",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"linkRefractionWithTransparency",void 0),(0,A.b)([(0,R.K)()],B.prototype,"minimumThickness",void 0),(0,A.b)([(0,R.K)()],B.prototype,"maximumThickness",void 0),(0,A.b)([(0,R.K)()],B.prototype,"useThicknessAsDepth",void 0),(0,A.b)([(0,R.j)()],B.prototype,"tintColor",void 0),(0,A.b)([(0,R.K)()],B.prototype,"tintColorAtDistance",void 0),(0,A.b)([(0,R.K)()],B.prototype,"dispersion",void 0),(0,A.b)([(0,R.j)()],B.prototype,"diffusionDistance",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"useMaskFromThicknessTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"refractionIntensityTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"translucencyIntensityTexture",void 0),(0,A.b)([(0,R.j)()],B.prototype,"translucencyColor",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"translucencyColorTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],B.prototype,"useGltfStyleTextures",void 0),(0,A.b)([(0,R.K)()],B.prototype,"applyAlbedoAfterSubSurface",void 0),(0,A.b)([(0,R.K)()],B.prototype,"legacyTransluceny",void 0);var F=P(11653),X=P(818),H=P(11658);const W={effect:null,subMesh:null};class e extends g.d{constructor(L){super(L),this.PBR=!0,this.NUM_SAMPLES="0",this.REALTIME_FILTERING=!1,this.IBL_CDF_FILTERING=!1,this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.ALBEDO=!1,this.GAMMAALBEDO=!1,this.ALBEDODIRECTUV=0,this.VERTEXCOLOR=!1,this.BASE_WEIGHT=!1,this.BASE_WEIGHTDIRECTUV=0,this.BASE_DIFFUSE_ROUGHNESS=!1,this.BASE_DIFFUSE_ROUGHNESSDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.AMBIENTINGRAYSCALE=!1,this.OPACITY=!1,this.VERTEXALPHA=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHABLEND=!1,this.ALPHAFROMALBEDO=!1,this.ALPHATESTVALUE="0.5",this.SPECULAROVERALPHA=!1,this.RADIANCEOVERALPHA=!1,this.ALPHAFRESNEL=!1,this.LINEARALPHAFRESNEL=!1,this.PREMULTIPLYALPHA=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.GAMMAEMISSIVE=!1,this.REFLECTIVITY=!1,this.REFLECTIVITY_GAMMA=!1,this.REFLECTIVITYDIRECTUV=0,this.SPECULARTERM=!1,this.MICROSURFACEFROMREFLECTIVITYMAP=!1,this.MICROSURFACEAUTOMATIC=!1,this.LODBASEDMICROSFURACE=!1,this.MICROSURFACEMAP=!1,this.MICROSURFACEMAPDIRECTUV=0,this.METALLICWORKFLOW=!1,this.ROUGHNESSSTOREINMETALMAPALPHA=!1,this.ROUGHNESSSTOREINMETALMAPGREEN=!1,this.METALLNESSSTOREINMETALMAPBLUE=!1,this.AOSTOREINMETALMAPRED=!1,this.METALLIC_REFLECTANCE=!1,this.METALLIC_REFLECTANCE_GAMMA=!1,this.METALLIC_REFLECTANCEDIRECTUV=0,this.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=!1,this.REFLECTANCE=!1,this.REFLECTANCE_GAMMA=!1,this.REFLECTANCEDIRECTUV=0,this.ENVIRONMENTBRDF=!1,this.ENVIRONMENTBRDF_RGBD=!1,this.NORMAL=!1,this.TANGENT=!1,this.BUMP=!1,this.BUMPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.NORMALXYSCALE=!0,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.USELIGHTMAPASSHADOWMAP=!1,this.GAMMALIGHTMAP=!1,this.RGBDLIGHTMAP=!1,this.REFLECTION=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.INVERTCUBICMAP=!1,this.USESPHERICALFROMREFLECTIONMAP=!1,this.USEIRRADIANCEMAP=!1,this.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,this.USESPHERICALINVERTEX=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.LODINREFLECTIONALPHA=!1,this.GAMMAREFLECTION=!1,this.RGBDREFLECTION=!1,this.LINEARSPECULARREFLECTION=!1,this.RADIANCEOCCLUSION=!1,this.HORIZONOCCLUSION=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.PREPASS=!1,this.PREPASS_COLOR=!1,this.PREPASS_COLOR_INDEX=-1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO=!1,this.PREPASS_ALBEDO_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_SCREENSPACE_DEPTH=!1,this.PREPASS_SCREENSPACE_DEPTH_INDEX=-1,this.PREPASS_NORMALIZED_VIEW_DEPTH=!1,this.PREPASS_NORMALIZED_VIEW_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.NONUNIFORMSCALING=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_POSITION=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.MORPHTARGETS_UV2=!1,this.MORPHTARGETS_COLOR=!1,this.MORPHTARGETTEXTURE_HASPOSITIONS=!1,this.MORPHTARGETTEXTURE_HASNORMALS=!1,this.MORPHTARGETTEXTURE_HASTANGENTS=!1,this.MORPHTARGETTEXTURE_HASUVS=!1,this.MORPHTARGETTEXTURE_HASUV2S=!1,this.MORPHTARGETTEXTURE_HASCOLORS=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.EXPOSURE=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.USEPHYSICALLIGHTFALLOFF=!1,this.USEGLTFLIGHTFALLOFF=!1,this.TWOSIDEDLIGHTING=!1,this.MIRRORED=!1,this.SHADOWFLOAT=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.POINTSIZE=!1,this.FOG=!1,this.LOGARITHMICDEPTH=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.AREALIGHTSUPPORTED=!0,this.FORCENORMALFORWARD=!1,this.SPECULARAA=!1,this.UNLIT=!1,this.DECAL_AFTER_DETAIL=!1,this.DEBUGMODE=0,this.rebuild()}reset(){super.reset(),this.ALPHATESTVALUE="0.5",this.PBR=!0,this.NORMALXYSCALE=!0}}class s extends v.e{get realTimeFiltering(){return this._realTimeFiltering}set realTimeFiltering(L){this._realTimeFiltering=L,this.Ti(1)}get realTimeFilteringQuality(){return this._realTimeFilteringQuality}set realTimeFilteringQuality(L){this._realTimeFilteringQuality=L,this.Ti(1)}get canRenderToMRT(){return!0}_attachImageProcessingConfiguration(L){L!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=L||this.va().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}constructor(L,j){super(L,j,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]||s.ForceGLSL),this._directIntensity=1,this._emissiveIntensity=1,this._environmentIntensity=1,this._specularIntensity=1,this._lightingInfos=new D.s(this._directIntensity,this._emissiveIntensity,this._environmentIntensity,this._specularIntensity),this._disableBumpMap=!1,this._albedoTexture=null,this._baseWeightTexture=null,this._baseDiffuseRoughnessTexture=null,this._ambientTexture=null,this._ambientTextureStrength=1,this._ambientTextureImpactOnAnalyticalLights=s.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._reflectivityTexture=null,this._metallicTexture=null,this._metallic=null,this._roughness=null,this._metallicF0Factor=1,this._metallicReflectanceColor=f.e.White(),this._useOnlyMetallicFromMetallicReflectanceTexture=!1,this._metallicReflectanceTexture=null,this._reflectanceTexture=null,this._microSurfaceTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._ambientColor=new f.e(0,0,0),this._albedoColor=new f.e(1,1,1),this._baseWeight=1,this._baseDiffuseRoughness=null,this._reflectivityColor=new f.e(1,1,1),this._reflectionColor=new f.e(1,1,1),this._emissiveColor=new f.e(0,0,0),this._microSurface=.9,this._useLightmapAsShadowmap=!1,this._useHorizonOcclusion=!0,this._useRadianceOcclusion=!0,this._useAlphaFromAlbedoTexture=!1,this._useSpecularOverAlpha=!0,this._useMicroSurfaceFromReflectivityMapAlpha=!1,this._useRoughnessFromMetallicTextureAlpha=!0,this._useRoughnessFromMetallicTextureGreen=!1,this._useMetallnessFromMetallicTextureBlue=!1,this._useAmbientOcclusionFromMetallicTextureRed=!1,this._useAmbientInGrayScale=!1,this._useAutoMicroSurfaceFromReflectivityMap=!1,this._lightFalloff=s.LIGHTFALLOFF_PHYSICAL,this._useRadianceOverAlpha=!0,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this._parallaxScaleBias=.05,this._disableLighting=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._alphaCutOff=.4,this._useAlphaFresnel=!1,this._useLinearAlphaFresnel=!1,this._environmentBRDFTexture=null,this._forceIrradianceInFragment=!1,this._realTimeFiltering=!1,this._realTimeFilteringQuality=8,this._forceNormalForward=!1,this._enableSpecularAntiAliasing=!1,this._imageProcessingObserver=null,this._renderTargets=new Y.e(16),this._globalAmbientColor=new f.e(0,0,0),this._unlit=!1,this._applyDecalMapAfterDetailMap=!1,this._debugMode=0,this._shadersLoaded=!1,this._breakShaderLoadedCheck=!1,this.debugMode=0,this.debugLimit=-1,this.debugFactor=1,this._cacheHasRenderTargetTextures=!1,this.brdf=new C(this),this.clearCoat=new Q(this),this.iridescence=new w(this),this.anisotropy=new c(this),this.sheen=new U(this),this.subSurface=new B(this),this.detailMap=new F.e(this),this._attachImageProcessingConfiguration(null),this.getRenderTargetTextures=()=>(this._renderTargets.reset(),y.d.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets),this._environmentBRDFTexture=(0,u.b)(this.va()),this.prePassConfiguration=new b.b}get hasRenderTargetTextures(){return!!(y.d.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures}get isPrePassCapable(){return!this.disableDepthWrite}getClassName(){return"PBRBaseMaterial"}get _disableAlphaBlending(){var L;return this._transparencyMode===s.PBRMATERIAL_OPAQUE||this._transparencyMode===s.PBRMATERIAL_ALPHATEST||(null===(L=this.subSurface)||void 0===L?void 0:L.disableAlphaBlending)}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromAlbedoTexture())}needAlphaTesting(){var L;return this._hasTransparencyMode?this._transparencyModeIsTest:(null===(L=this.subSurface)||void 0===L||!L.disableAlphaBlending)&&(this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===s.PBRMATERIAL_ALPHATEST))}_shouldUseAlphaFromAlbedoTexture(){return null!=this._albedoTexture&&this._albedoTexture.Jj&&this._useAlphaFromAlbedoTexture&&this._transparencyMode!==s.PBRMATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._albedoTexture&&this._albedoTexture.Jj||null!=this._opacityTexture}getAlphaTestTexture(){return this._albedoTexture}isReadyForSubMesh(L,j,P){this._uniformBufferLayoutBuilt||this.buildUniformLayout();const A=j._drawWrapper;if(A.effect&&this.isFrozen&&A._wasPreviouslyReady&&A._wasPreviouslyUsingInstances===P)return!0;j.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),j.materialDefines=new e(this._eventInfo.defineNames));const R=j.materialDefines;if(this._isReadyForSubMesh(j))return!0;const Y=this.va(),u=Y.getEngine();if(R._areTexturesDirty&&(this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,Y.texturesEnabled)){if(this._albedoTexture&&y.d.DiffuseTextureEnabled&&!this._albedoTexture.isReadyOrNotBlocking())return!1;if(this._baseWeightTexture&&y.d.BaseWeightTextureEnabled&&!this._baseWeightTexture.isReadyOrNotBlocking())return!1;if(this._baseDiffuseRoughnessTexture&&y.d.BaseDiffuseRoughnessTextureEnabled&&!this._baseDiffuseRoughnessTexture.isReadyOrNotBlocking())return!1;if(this._ambientTexture&&y.d.AmbientTextureEnabled&&!this._ambientTexture.isReadyOrNotBlocking())return!1;if(this._opacityTexture&&y.d.OpacityTextureEnabled&&!this._opacityTexture.isReadyOrNotBlocking())return!1;const L=this._getReflectionTexture();if(L&&y.d.ReflectionTextureEnabled){if(!L.isReadyOrNotBlocking())return!1;var a;if(L.irradianceTexture){if(!L.irradianceTexture.isReadyOrNotBlocking())return!1}else if(!L.sphericalPolynomial&&null!==(a=L.getInternalTexture())&&void 0!==a&&a._sphericalPolynomialPromise)return!1}if(this._lightmapTexture&&y.d.LightmapTextureEnabled&&!this._lightmapTexture.isReadyOrNotBlocking())return!1;if(this._emissiveTexture&&y.d.EmissiveTextureEnabled&&!this._emissiveTexture.isReadyOrNotBlocking())return!1;if(y.d.SpecularTextureEnabled){if(this._metallicTexture){if(!this._metallicTexture.isReadyOrNotBlocking())return!1}else if(this._reflectivityTexture&&!this._reflectivityTexture.isReadyOrNotBlocking())return!1;if(this._metallicReflectanceTexture&&!this._metallicReflectanceTexture.isReadyOrNotBlocking())return!1;if(this._reflectanceTexture&&!this._reflectanceTexture.isReadyOrNotBlocking())return!1;if(this._microSurfaceTexture&&!this._microSurfaceTexture.isReadyOrNotBlocking())return!1}if(u.getCaps().standardDerivatives&&this._bumpTexture&&y.d.BumpTextureEnabled&&!this._disableBumpMap&&!this._bumpTexture.isReady())return!1;if(this._environmentBRDFTexture&&y.d.ReflectionTextureEnabled&&!this._environmentBRDFTexture.isReady())return!1}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=R,this._eventInfo.subMesh=j,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(R._areImageProcessingDirty&&this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady())return!1;if(R.AREALIGHTUSED)for(let o=0;o<L.lightSources.length;o++)if(!L.lightSources[o]._isReady())return!1;u.getCaps().standardDerivatives||L.isVerticesDataPresent(S.e.NormalKind)||(L.createNormals(!0),o.e.Warn("PBRMaterial: Normals have been created for the mesh: "+L.name));const D=j.effect,g=R._areLightsDisposed;let V=this._prepareEffect(L,R,this.onCompiled,this.onError,P,null,j.getRenderingMesh().hasThinInstances),N=!1;if(V)if(this._onEffectCreatedObservable&&(W.effect=V,W.subMesh=j,this._onEffectCreatedObservable.notifyObservers(W)),this.allowShaderHotSwapping&&D&&!V.isReady()){if(V=D,R.markAsUnprocessed(),N=this.isFrozen,g)return R._areLightsDisposed=!0,!1}else Y.resetCachedMaterial(),j.setEffect(V,R,this._materialContext);return!(!j.effect||!j.effect.isReady())&&(R._renderId=Y.getRenderId(),A._wasPreviouslyReady=!N,A._wasPreviouslyUsingInstances=!!P,this._checkScenePerformancePriority(),!0)}isMetallicWorkflow(){return!(null==this._metallic&&null==this._roughness&&!this._metallicTexture)}_prepareEffect(L,j){let A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,Y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6?arguments[6]:void 0;if(this._prepareDefines(L,j,o,Y,u),!j.isDirty)return null;j.markAsProcessed();const a=this.va().getEngine(),D=new T.d;let g=0;j.USESPHERICALINVERTEX&&D.addFallback(g++,"USESPHERICALINVERTEX"),j.FOG&&D.addFallback(g,"FOG"),j.SPECULARAA&&D.addFallback(g,"SPECULARAA"),j.POINTSIZE&&D.addFallback(g,"POINTSIZE"),j.LOGARITHMICDEPTH&&D.addFallback(g,"LOGARITHMICDEPTH"),j.PARALLAX&&D.addFallback(g,"PARALLAX"),j.PARALLAX_RHS&&D.addFallback(g,"PARALLAX_RHS"),j.PARALLAXOCCLUSION&&D.addFallback(g++,"PARALLAXOCCLUSION"),j.ENVIRONMENTBRDF&&D.addFallback(g++,"ENVIRONMENTBRDF"),j.TANGENT&&D.addFallback(g++,"TANGENT"),j.BUMP&&D.addFallback(g++,"BUMP"),g=(0,G.u)(j,D,this._maxSimultaneousLights,g++),j.SPECULARTERM&&D.addFallback(g++,"SPECULARTERM"),j.USESPHERICALFROMREFLECTIONMAP&&D.addFallback(g++,"USESPHERICALFROMREFLECTIONMAP"),j.USEIRRADIANCEMAP&&D.addFallback(g++,"USEIRRADIANCEMAP"),j.LIGHTMAP&&D.addFallback(g++,"LIGHTMAP"),j.NORMAL&&D.addFallback(g++,"NORMAL"),j.AMBIENT&&D.addFallback(g++,"AMBIENT"),j.EMISSIVE&&D.addFallback(g++,"EMISSIVE"),j.VERTEXCOLOR&&D.addFallback(g++,"VERTEXCOLOR"),j.MORPHTARGETS&&D.addFallback(g++,"MORPHTARGETS"),j.MULTIVIEW&&D.addFallback(0,"MULTIVIEW");const V=[S.e.PositionKind];j.NORMAL&&V.push(S.e.NormalKind),j.TANGENT&&V.push(S.e.TangentKind);for(let P=1;P<=6;++P)j["UV"+P]&&V.push(`uv${1===P?"":P}`);j.VERTEXCOLOR&&V.push(S.e.ColorKind),(0,G.z)(V,L,j,D),(0,G.D)(V,j),(0,G.E)(V,L,j),(0,G.y)(V,L,j);let N="pbr";const C=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","baseWeight","baseDiffuseRoughness","vReflectivityColor","vMetallicReflectanceFactors","vEmissiveColor","visibility","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vBaseWeightInfos","vBaseDiffuseRoughnessInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vReflectionPosition","vReflectionSize","vEmissiveInfos","vReflectivityInfos","vReflectionFilteringInfo","vMetallicReflectanceInfos","vReflectanceInfos","vMicroSurfaceSamplerInfos","vBumpInfos","vLightmapInfos","mBones","albedoMatrix","baseWeightMatrix","baseDiffuseRoughnessMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","normalMatrix","microSurfaceSamplerMatrix","bumpMatrix","lightmapMatrix","metallicReflectanceMatrix","reflectanceMatrix","vLightingIntensity","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX_ZZ","vSphericalYY_ZZ","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vSphericalL00","vSphericalL1_1","vSphericalL10","vSphericalL11","vSphericalL2_2","vSphericalL2_1","vSphericalL20","vSphericalL21","vSphericalL22","vReflectionMicrosurfaceInfos","vReflectionDominantDirection","vTangentSpaceParams","boneTextureWidth","vDebugMode","morphTargetTextureInfo","morphTargetTextureIndices","cameraInfo"],f=["albedoSampler","baseWeightSampler","baseDiffuseRoughnessSampler","reflectivitySampler","ambientSampler","emissiveSampler","bumpSampler","lightmapSampler","opacitySampler","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh","irradianceSampler","microSurfaceSampler","environmentBrdfSampler","boneSampler","metallicReflectanceSampler","reflectanceSampler","morphTargets","oitDepthSampler","oitFrontColorSampler","icdfSampler","areaLightsLTC1Sampler","areaLightsLTC2Sampler"],K=["Material","Scene","Mesh"],v={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:j.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=D,this._eventInfo.fallbackRank=g,this._eventInfo.defines=j,this._eventInfo.uniforms=C,this._eventInfo.attributes=V,this._eventInfo.samplers=f,this._eventInfo.uniformBuffersNames=K,this._eventInfo.customCode=void 0,this._eventInfo.mesh=L,this._eventInfo.indexParameters=v,this._callbackPluginEventGeneric(128,this._eventInfo),H.c.AddUniformsAndSamplers(C,f),b.b.AddUniforms(C),b.b.AddSamplers(f),(0,X.e)(C),h.c&&(h.c.PrepareUniforms(C,j),h.c.PrepareSamplers(f,j)),(0,G.Z)({uniformsNames:C,uniformBuffersNames:K,samplers:f,defines:j,maxSimultaneousLights:this._maxSimultaneousLights});const q={};this.customShaderNameResolve&&(N=this.customShaderNameResolve(N,C,K,f,j,V,q));const y=j.toString(),M=a.createEffect(N,{attributes:V,uniformsNames:C,uniformBuffersNames:K,samplers:f,defines:y,fallbacks:D,onCompiled:A,onError:R,indexParameters:v,processFinalCode:q.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:j.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this.shaderLanguage?await Promise.all([Promise.all([P.e(35),P.e(49)]).then(P.bind(P,13107)),Promise.all([P.e(33),P.e(50)]).then(P.bind(P,13265))]):await Promise.all([Promise.all([P.e(28),P.e(52)]).then(P.bind(P,13351)),Promise.all([P.e(27),P.e(53)]).then(P.bind(P,13523))]),this._shadersLoaded=!0}},a);return this._eventInfo.customCode=void 0,M}_prepareDefines(L,j){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,R=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=this.va(),Y=o.getEngine();(0,G.M)(o,L,j,!0,this._maxSimultaneousLights,this._disableLighting),j._needNormals=!0,(0,G.U)(o,j);const u=this.needAlphaBlendingForMesh(L)&&this.va().useOrderIndependentTransparency;if((0,G.Y)(o,j,this.canRenderToMRT&&!u),(0,G.X)(o,j,u),H.c.PrepareDefines(Y.currentRenderPassId,L,j),j.METALLICWORKFLOW=this.isMetallicWorkflow(),j._areTexturesDirty){j._needUVs=!1;for(let L=1;L<=6;++L)j["MAINUV"+L]=!1;if(o.texturesEnabled){j.ALBEDODIRECTUV=0,j.BASE_WEIGHTDIRECTUV=0,j.BASE_DIFFUSE_ROUGHNESSDIRECTUV=0,j.AMBIENTDIRECTUV=0,j.OPACITYDIRECTUV=0,j.EMISSIVEDIRECTUV=0,j.REFLECTIVITYDIRECTUV=0,j.MICROSURFACEMAPDIRECTUV=0,j.METALLIC_REFLECTANCEDIRECTUV=0,j.REFLECTANCEDIRECTUV=0,j.BUMPDIRECTUV=0,j.LIGHTMAPDIRECTUV=0,Y.getCaps().textureLOD&&(j.LODBASEDMICROSFURACE=!0),this._albedoTexture&&y.d.DiffuseTextureEnabled?((0,G.Q)(this._albedoTexture,j,"ALBEDO"),j.GAMMAALBEDO=this._albedoTexture.gammaSpace):j.ALBEDO=!1,this._baseWeightTexture&&y.d.BaseWeightTextureEnabled?(0,G.Q)(this._baseWeightTexture,j,"BASE_WEIGHT"):j.BASE_WEIGHT=!1,this._baseDiffuseRoughnessTexture&&y.d.BaseDiffuseRoughnessTextureEnabled?(0,G.Q)(this._baseDiffuseRoughnessTexture,j,"BASE_DIFFUSE_ROUGHNESS"):j.BASE_DIFFUSE_ROUGHNESS=!1,this._ambientTexture&&y.d.AmbientTextureEnabled?((0,G.Q)(this._ambientTexture,j,"AMBIENT"),j.AMBIENTINGRAYSCALE=this._useAmbientInGrayScale):j.AMBIENT=!1,this._opacityTexture&&y.d.OpacityTextureEnabled?((0,G.Q)(this._opacityTexture,j,"OPACITY"),j.OPACITYRGB=this._opacityTexture.getAlphaFromRGB):j.OPACITY=!1;const L=this._getReflectionTexture();if(L&&y.d.ReflectionTextureEnabled){switch(j.REFLECTION=!0,j.GAMMAREFLECTION=L.gammaSpace,j.RGBDREFLECTION=L.isRGBD,j.LODINREFLECTIONALPHA=L.lodLevelInAlpha,j.LINEARSPECULARREFLECTION=L.linearSpecularLOD,j.USEIRRADIANCEMAP=!1,this.realTimeFiltering&&this.realTimeFilteringQuality>0?(j.NUM_SAMPLES=""+this.realTimeFilteringQuality,Y._features.needTypeSuffixInShaderConstants&&(j.NUM_SAMPLES=j.NUM_SAMPLES+"u"),j.REALTIME_FILTERING=!0,this.va().iblCdfGenerator&&(j.IBL_CDF_FILTERING=!0)):j.REALTIME_FILTERING=!1,j.INVERTCUBICMAP=L.coordinatesMode===q.e.INVCUBIC_MODE,j.REFLECTIONMAP_3D=L.isCube,j.REFLECTIONMAP_OPPOSITEZ=j.REFLECTIONMAP_3D&&this.va().useRightHandedSystem?!L.invertZ:L.invertZ,j.REFLECTIONMAP_CUBIC=!1,j.REFLECTIONMAP_EXPLICIT=!1,j.REFLECTIONMAP_PLANAR=!1,j.REFLECTIONMAP_PROJECTION=!1,j.REFLECTIONMAP_SKYBOX=!1,j.REFLECTIONMAP_SPHERICAL=!1,j.REFLECTIONMAP_EQUIRECTANGULAR=!1,j.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,j.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,L.coordinatesMode){case q.e.EXPLICIT_MODE:j.REFLECTIONMAP_EXPLICIT=!0;break;case q.e.PLANAR_MODE:j.REFLECTIONMAP_PLANAR=!0;break;case q.e.PROJECTION_MODE:j.REFLECTIONMAP_PROJECTION=!0;break;case q.e.SKYBOX_MODE:j.REFLECTIONMAP_SKYBOX=!0;break;case q.e.SPHERICAL_MODE:j.REFLECTIONMAP_SPHERICAL=!0;break;case q.e.EQUIRECTANGULAR_MODE:j.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case q.e.FIXED_EQUIRECTANGULAR_MODE:j.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case q.e.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:j.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case q.e.CUBIC_MODE:case q.e.INVCUBIC_MODE:default:j.REFLECTIONMAP_CUBIC=!0,j.USE_LOCAL_REFLECTIONMAP_CUBIC=!!L.boundingBoxSize}L.coordinatesMode!==q.e.SKYBOX_MODE&&(L.irradianceTexture?(j.USEIRRADIANCEMAP=!0,j.USESPHERICALFROMREFLECTIONMAP=!1,j.USESPHERICALINVERTEX=!1,L.irradianceTexture._dominantDirection&&(j.USE_IRRADIANCE_DOMINANT_DIRECTION=!0)):L.isCube&&(j.USESPHERICALFROMREFLECTIONMAP=!0,j.USEIRRADIANCEMAP=!1,j.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,this._forceIrradianceInFragment||this.realTimeFiltering||this._twoSidedLighting||Y.getCaps().maxVaryingVectors<=8||this._baseDiffuseRoughnessTexture?j.USESPHERICALINVERTEX=!1:j.USESPHERICALINVERTEX=!0))}else j.REFLECTION=!1,j.REFLECTIONMAP_3D=!1,j.REFLECTIONMAP_SPHERICAL=!1,j.REFLECTIONMAP_PLANAR=!1,j.REFLECTIONMAP_CUBIC=!1,j.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,j.REFLECTIONMAP_PROJECTION=!1,j.REFLECTIONMAP_SKYBOX=!1,j.REFLECTIONMAP_EXPLICIT=!1,j.REFLECTIONMAP_EQUIRECTANGULAR=!1,j.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,j.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,j.INVERTCUBICMAP=!1,j.USESPHERICALFROMREFLECTIONMAP=!1,j.USEIRRADIANCEMAP=!1,j.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,j.USESPHERICALINVERTEX=!1,j.REFLECTIONMAP_OPPOSITEZ=!1,j.LODINREFLECTIONALPHA=!1,j.GAMMAREFLECTION=!1,j.RGBDREFLECTION=!1,j.LINEARSPECULARREFLECTION=!1;this._lightmapTexture&&y.d.LightmapTextureEnabled?((0,G.Q)(this._lightmapTexture,j,"LIGHTMAP"),j.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,j.GAMMALIGHTMAP=this._lightmapTexture.gammaSpace,j.RGBDLIGHTMAP=this._lightmapTexture.isRGBD):j.LIGHTMAP=!1,this._emissiveTexture&&y.d.EmissiveTextureEnabled?((0,G.Q)(this._emissiveTexture,j,"EMISSIVE"),j.GAMMAEMISSIVE=this._emissiveTexture.gammaSpace):j.EMISSIVE=!1,y.d.SpecularTextureEnabled?(this._metallicTexture?((0,G.Q)(this._metallicTexture,j,"REFLECTIVITY"),j.ROUGHNESSSTOREINMETALMAPALPHA=this._useRoughnessFromMetallicTextureAlpha,j.ROUGHNESSSTOREINMETALMAPGREEN=!this._useRoughnessFromMetallicTextureAlpha&&this._useRoughnessFromMetallicTextureGreen,j.METALLNESSSTOREINMETALMAPBLUE=this._useMetallnessFromMetallicTextureBlue,j.AOSTOREINMETALMAPRED=this._useAmbientOcclusionFromMetallicTextureRed,j.REFLECTIVITY_GAMMA=!1):this._reflectivityTexture?((0,G.Q)(this._reflectivityTexture,j,"REFLECTIVITY"),j.MICROSURFACEFROMREFLECTIVITYMAP=this._useMicroSurfaceFromReflectivityMapAlpha,j.MICROSURFACEAUTOMATIC=this._useAutoMicroSurfaceFromReflectivityMap,j.REFLECTIVITY_GAMMA=this._reflectivityTexture.gammaSpace):j.REFLECTIVITY=!1,this._metallicReflectanceTexture||this._reflectanceTexture?(j.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=this._useOnlyMetallicFromMetallicReflectanceTexture,this._metallicReflectanceTexture?((0,G.Q)(this._metallicReflectanceTexture,j,"METALLIC_REFLECTANCE"),j.METALLIC_REFLECTANCE_GAMMA=this._metallicReflectanceTexture.gammaSpace):j.METALLIC_REFLECTANCE=!1,this._reflectanceTexture&&(!this._metallicReflectanceTexture||this._metallicReflectanceTexture&&this._useOnlyMetallicFromMetallicReflectanceTexture)?((0,G.Q)(this._reflectanceTexture,j,"REFLECTANCE"),j.REFLECTANCE_GAMMA=this._reflectanceTexture.gammaSpace):j.REFLECTANCE=!1):(j.METALLIC_REFLECTANCE=!1,j.REFLECTANCE=!1),this._microSurfaceTexture?(0,G.Q)(this._microSurfaceTexture,j,"MICROSURFACEMAP"):j.MICROSURFACEMAP=!1):(j.REFLECTIVITY=!1,j.MICROSURFACEMAP=!1),Y.getCaps().standardDerivatives&&this._bumpTexture&&y.d.BumpTextureEnabled&&!this._disableBumpMap?((0,G.Q)(this._bumpTexture,j,"BUMP"),this._useParallax&&this._albedoTexture&&y.d.DiffuseTextureEnabled?(j.PARALLAX=!0,j.PARALLAX_RHS=o.useRightHandedSystem,j.PARALLAXOCCLUSION=!!this._useParallaxOcclusion):j.PARALLAX=!1,j.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap):(j.BUMP=!1,j.PARALLAX=!1,j.PARALLAX_RHS=!1,j.PARALLAXOCCLUSION=!1,j.OBJECTSPACE_NORMALMAP=!1),this._environmentBRDFTexture&&y.d.ReflectionTextureEnabled?(j.ENVIRONMENTBRDF=!0,j.ENVIRONMENTBRDF_RGBD=this._environmentBRDFTexture.isRGBD):(j.ENVIRONMENTBRDF=!1,j.ENVIRONMENTBRDF_RGBD=!1),this._shouldUseAlphaFromAlbedoTexture()?j.ALPHAFROMALBEDO=!0:j.ALPHAFROMALBEDO=!1}j.SPECULAROVERALPHA=this._useSpecularOverAlpha,this._lightFalloff===s.LIGHTFALLOFF_STANDARD?(j.USEPHYSICALLIGHTFALLOFF=!1,j.USEGLTFLIGHTFALLOFF=!1):this._lightFalloff===s.LIGHTFALLOFF_GLTF?(j.USEPHYSICALLIGHTFALLOFF=!1,j.USEGLTFLIGHTFALLOFF=!0):(j.USEPHYSICALLIGHTFALLOFF=!0,j.USEGLTFLIGHTFALLOFF=!1),j.RADIANCEOVERALPHA=this._useRadianceOverAlpha,!this.Di&&this._twoSidedLighting?j.TWOSIDEDLIGHTING=!0:j.TWOSIDEDLIGHTING=!1,j.MIRRORED=!!o._mirroredCameraPosition,j.SPECULARAA=Y.getCaps().standardDerivatives&&this._enableSpecularAntiAliasing}(j._areTexturesDirty||j._areMiscDirty)&&(j.ALPHATESTVALUE=`${this._alphaCutOff}${this._alphaCutOff%1===0?".":""}`,j.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,j.ALPHABLEND=this.needAlphaBlendingForMesh(L),j.ALPHAFRESNEL=this._useAlphaFresnel||this._useLinearAlphaFresnel,j.LINEARALPHAFRESNEL=this._useLinearAlphaFresnel),j._areImageProcessingDirty&&this._imageProcessingConfiguration&&this._imageProcessingConfiguration.prepareDefines(j),j.FORCENORMALFORWARD=this._forceNormalForward,j.RADIANCEOCCLUSION=this._useRadianceOcclusion,j.HORIZONOCCLUSION=this._useHorizonOcclusion,j._areMiscDirty&&((0,G.T)(L,o,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this.needAlphaTestingForMesh(L),j,this._applyDecalMapAfterDetailMap),j.UNLIT=this._unlit||(this.pointsCloud||this.wireframe)&&!L.isVerticesDataPresent(S.e.NormalKind),j.DEBUGMODE=this._debugMode),(0,G.L)(o,Y,this,j,!!P,A,R),this._eventInfo.defines=j,this._eventInfo.mesh=L,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),(0,G.K)(L,j,!0,!0,!0,this._transparencyMode!==s.PBRMATERIAL_OPAQUE),this._callbackPluginEventPrepareDefines(this._eventInfo)}forceCompilation(L,j,P){const A={clipPlane:!1,useInstances:!1,...P};this._uniformBufferLayoutBuilt||this.buildUniformLayout(),this._callbackPluginEventGeneric(4,this._eventInfo);(()=>{if(this._breakShaderLoadedCheck)return;const P=new e(this._eventInfo.defineNames),R=this._prepareEffect(L,P,void 0,void 0,A.useInstances,A.clipPlane,L.hasThinInstances);this._onEffectCreatedObservable&&(W.effect=R,W.subMesh=null,this._onEffectCreatedObservable.notifyObservers(W)),R.isReady()?j&&j(this):R.onCompileObservable.add((()=>{j&&j(this)}))})()}buildUniformLayout(){const L=this._uniformBuffer;L.addUniform("vAlbedoInfos",2),L.addUniform("vBaseWeightInfos",2),L.addUniform("vBaseDiffuseRoughnessInfos",2),L.addUniform("vAmbientInfos",4),L.addUniform("vOpacityInfos",2),L.addUniform("vEmissiveInfos",2),L.addUniform("vLightmapInfos",2),L.addUniform("vReflectivityInfos",3),L.addUniform("vMicroSurfaceSamplerInfos",2),L.addUniform("vReflectionInfos",2),L.addUniform("vReflectionFilteringInfo",2),L.addUniform("vReflectionPosition",3),L.addUniform("vReflectionSize",3),L.addUniform("vBumpInfos",3),L.addUniform("albedoMatrix",16),L.addUniform("baseWeightMatrix",16),L.addUniform("baseDiffuseRoughnessMatrix",16),L.addUniform("ambientMatrix",16),L.addUniform("opacityMatrix",16),L.addUniform("emissiveMatrix",16),L.addUniform("lightmapMatrix",16),L.addUniform("reflectivityMatrix",16),L.addUniform("microSurfaceSamplerMatrix",16),L.addUniform("bumpMatrix",16),L.addUniform("vTangentSpaceParams",2),L.addUniform("reflectionMatrix",16),L.addUniform("vReflectionColor",3),L.addUniform("vAlbedoColor",4),L.addUniform("baseWeight",1),L.addUniform("baseDiffuseRoughness",1),L.addUniform("vLightingIntensity",4),L.addUniform("vReflectionMicrosurfaceInfos",3),L.addUniform("vReflectionDominantDirection",3),L.addUniform("pointSize",1),L.addUniform("vReflectivityColor",4),L.addUniform("vEmissiveColor",3),L.addUniform("vAmbientColor",3),L.addUniform("vDebugMode",2),L.addUniform("vMetallicReflectanceFactors",4),L.addUniform("vMetallicReflectanceInfos",2),L.addUniform("metallicReflectanceMatrix",16),L.addUniform("vReflectanceInfos",2),L.addUniform("reflectanceMatrix",16),L.addUniform("vSphericalL00",3),L.addUniform("vSphericalL1_1",3),L.addUniform("vSphericalL10",3),L.addUniform("vSphericalL11",3),L.addUniform("vSphericalL2_2",3),L.addUniform("vSphericalL2_1",3),L.addUniform("vSphericalL20",3),L.addUniform("vSphericalL21",3),L.addUniform("vSphericalL22",3),L.addUniform("vSphericalX",3),L.addUniform("vSphericalY",3),L.addUniform("vSphericalZ",3),L.addUniform("vSphericalXX_ZZ",3),L.addUniform("vSphericalYY_ZZ",3),L.addUniform("vSphericalZZ",3),L.addUniform("vSphericalXY",3),L.addUniform("vSphericalYZ",3),L.addUniform("vSphericalZX",3),L.addUniform("cameraInfo",4),super.buildUniformLayout()}bindForSubMesh(L,j,P){const A=this.va(),R=P.materialDefines;if(!R)return;const o=P.effect;if(!o)return;this._activeEffect=o,j.getMeshUniformBuffer().bindToEffect(o,"Mesh"),j.transferToEffect(L);const Y=A.getEngine();this._uniformBuffer.bindToEffect(o,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,A,j,L,this.isFrozen),H.c.Bind(Y.currentRenderPassId,this._activeEffect,j,L,this);const u=A.activeCamera;u?this._uniformBuffer.updateFloat4("cameraInfo",u.Ai,u.maxZ,0,0):this._uniformBuffer.updateFloat4("cameraInfo",0,0,0,0),this._eventInfo.subMesh=P,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),R.OBJECTSPACE_NORMALMAP&&(L.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const D=this._mustRebind(A,o,P,j.visibility);(0,G.e)(j,this._activeEffect,this.prePassConfiguration);let S=null;const g=this._uniformBuffer;if(D){if(this.bindViewProjection(o),S=this._getReflectionTexture(),!g.useUbo||!this.isFrozen||!g.isSync||P._drawWrapper._forceRebindOnNextCall){var V;if(A.texturesEnabled){if(this._albedoTexture&&y.d.DiffuseTextureEnabled&&(g.updateFloat2("vAlbedoInfos",this._albedoTexture.coordinatesIndex,this._albedoTexture.level),(0,G.t)(this._albedoTexture,g,"albedo")),this._baseWeightTexture&&y.d.BaseWeightTextureEnabled&&(g.updateFloat2("vBaseWeightInfos",this._baseWeightTexture.coordinatesIndex,this._baseWeightTexture.level),(0,G.t)(this._baseWeightTexture,g,"baseWeight")),this._baseDiffuseRoughnessTexture&&y.d.BaseDiffuseRoughnessTextureEnabled&&(g.updateFloat2("vBaseDiffuseRoughnessInfos",this._baseDiffuseRoughnessTexture.coordinatesIndex,this._baseDiffuseRoughnessTexture.level),(0,G.t)(this._baseDiffuseRoughnessTexture,g,"baseDiffuseRoughness")),this._ambientTexture&&y.d.AmbientTextureEnabled&&(g.updateFloat4("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level,this._ambientTextureStrength,this._ambientTextureImpactOnAnalyticalLights),(0,G.t)(this._ambientTexture,g,"ambient")),this._opacityTexture&&y.d.OpacityTextureEnabled&&(g.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),(0,G.t)(this._opacityTexture,g,"opacity")),S&&y.d.ReflectionTextureEnabled){if(g.cj("reflectionMatrix",S.getReflectionTextureMatrix()),g.updateFloat2("vReflectionInfos",S.level*A.iblIntensity,0),S.boundingBoxSize){const L=S;g.updateVector3("vReflectionPosition",L.boundingBoxPosition),g.updateVector3("vReflectionSize",L.boundingBoxSize)}if(this.realTimeFiltering){const L=S.getSize().width;g.updateFloat2("vReflectionFilteringInfo",L,Math.log2(L))}if(R.USEIRRADIANCEMAP)R.USEIRRADIANCEMAP&&R.USE_IRRADIANCE_DOMINANT_DIRECTION&&g.updateVector3("vReflectionDominantDirection",S.irradianceTexture._dominantDirection);else{const L=S.sphericalPolynomial;if(R.USESPHERICALFROMREFLECTIONMAP&&L)if(R.SPHERICAL_HARMONICS){const j=L.preScaledHarmonics;g.updateVector3("vSphericalL00",j.l00),g.updateVector3("vSphericalL1_1",j.l1_1),g.updateVector3("vSphericalL10",j.l10),g.updateVector3("vSphericalL11",j.l11),g.updateVector3("vSphericalL2_2",j.l2_2),g.updateVector3("vSphericalL2_1",j.l2_1),g.updateVector3("vSphericalL20",j.l20),g.updateVector3("vSphericalL21",j.l21),g.updateVector3("vSphericalL22",j.l22)}else g.updateFloat3("vSphericalX",L.x.x,L.x.y,L.x.z),g.updateFloat3("vSphericalY",L.y.x,L.y.y,L.y.z),g.updateFloat3("vSphericalZ",L.z.x,L.z.y,L.z.z),g.updateFloat3("vSphericalXX_ZZ",L.xx.x-L.zz.x,L.xx.y-L.zz.y,L.xx.z-L.zz.z),g.updateFloat3("vSphericalYY_ZZ",L.yy.x-L.zz.x,L.yy.y-L.zz.y,L.yy.z-L.zz.z),g.updateFloat3("vSphericalZZ",L.zz.x,L.zz.y,L.zz.z),g.updateFloat3("vSphericalXY",L.xy.x,L.xy.y,L.xy.z),g.updateFloat3("vSphericalYZ",L.yz.x,L.yz.y,L.yz.z),g.updateFloat3("vSphericalZX",L.zx.x,L.zx.y,L.zx.z)}g.updateFloat3("vReflectionMicrosurfaceInfos",S.getSize().width,S.lodGenerationScale,S.lodGenerationOffset)}this._emissiveTexture&&y.d.EmissiveTextureEnabled&&(g.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),(0,G.t)(this._emissiveTexture,g,"emissive")),this._lightmapTexture&&y.d.LightmapTextureEnabled&&(g.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),(0,G.t)(this._lightmapTexture,g,"lightmap")),y.d.SpecularTextureEnabled&&(this._metallicTexture?(g.updateFloat3("vReflectivityInfos",this._metallicTexture.coordinatesIndex,this._metallicTexture.level,this._ambientTextureStrength),(0,G.t)(this._metallicTexture,g,"reflectivity")):this._reflectivityTexture&&(g.updateFloat3("vReflectivityInfos",this._reflectivityTexture.coordinatesIndex,this._reflectivityTexture.level,1),(0,G.t)(this._reflectivityTexture,g,"reflectivity")),this._metallicReflectanceTexture&&(g.updateFloat2("vMetallicReflectanceInfos",this._metallicReflectanceTexture.coordinatesIndex,this._metallicReflectanceTexture.level),(0,G.t)(this._metallicReflectanceTexture,g,"metallicReflectance")),this._reflectanceTexture&&R.REFLECTANCE&&(g.updateFloat2("vReflectanceInfos",this._reflectanceTexture.coordinatesIndex,this._reflectanceTexture.level),(0,G.t)(this._reflectanceTexture,g,"reflectance")),this._microSurfaceTexture&&(g.updateFloat2("vMicroSurfaceSamplerInfos",this._microSurfaceTexture.coordinatesIndex,this._microSurfaceTexture.level),(0,G.t)(this._microSurfaceTexture,g,"microSurfaceSampler"))),this._bumpTexture&&Y.getCaps().standardDerivatives&&y.d.BumpTextureEnabled&&!this._disableBumpMap&&(g.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level,this._parallaxScaleBias),(0,G.t)(this._bumpTexture,g,"bump"),A._mirroredCameraPosition?g.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):g.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1))}if(this.pointsCloud&&g.updateFloat("pointSize",this.pointSize),R.METALLICWORKFLOW){var N;f.l._i[0].r=void 0===this._metallic||null===this._metallic?1:this._metallic,f.l._i[0].g=void 0===this._roughness||null===this._roughness?1:this._roughness;const L=(null===(N=this.subSurface)||void 0===N?void 0:N._indexOfRefraction)??1.5,j=1;f.l._i[0].b=L;const P=Math.pow((L-j)/(L+j),2);f.l._i[0].a=P,g.updateDirectColor4("vReflectivityColor",f.l._i[0]),g.updateColor4("vMetallicReflectanceFactors",this._metallicReflectanceColor,this._metallicF0Factor)}else g.updateColor4("vReflectivityColor",this._reflectivityColor,this._microSurface);g.updateColor3("vEmissiveColor",y.d.EmissiveTextureEnabled?this._emissiveColor:f.e.BlackReadOnly),g.updateColor3("vReflectionColor",this._reflectionColor),!R.SS_REFRACTION&&null!==(V=this.subSurface)&&void 0!==V&&V._linkRefractionWithTransparency?g.updateColor4("vAlbedoColor",this._albedoColor,1):g.updateColor4("vAlbedoColor",this._albedoColor,this.alpha),g.updateFloat("baseWeight",this._baseWeight),g.updateFloat("baseDiffuseRoughness",this._baseDiffuseRoughness||0),this._lightingInfos.x=this._directIntensity,this._lightingInfos.y=this._emissiveIntensity,this._lightingInfos.z=this._environmentIntensity*A.environmentIntensity,this._lightingInfos.w=this._specularIntensity,g.updateVector4("vLightingIntensity",this._lightingInfos),A.ambientColor.multiplyToRef(this._ambientColor,this._globalAmbientColor),g.updateColor3("vAmbientColor",this._globalAmbientColor),g.updateFloat2("vDebugMode",this.debugLimit,this.debugFactor)}if(A.texturesEnabled){if(this._albedoTexture&&y.d.DiffuseTextureEnabled&&g.setTexture("albedoSampler",this._albedoTexture),this._baseWeightTexture&&y.d.BaseWeightTextureEnabled&&g.setTexture("baseWeightSampler",this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&y.d.BaseDiffuseRoughnessTextureEnabled&&g.setTexture("baseDiffuseRoughnessSampler",this._baseDiffuseRoughnessTexture),this._ambientTexture&&y.d.AmbientTextureEnabled&&g.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&y.d.OpacityTextureEnabled&&g.setTexture("opacitySampler",this._opacityTexture),S&&y.d.ReflectionTextureEnabled){R.LODBASEDMICROSFURACE?g.setTexture("reflectionSampler",S):(g.setTexture("reflectionSampler",S._lodTextureMid||S),g.setTexture("reflectionSamplerLow",S._lodTextureLow||S),g.setTexture("reflectionSamplerHigh",S._lodTextureHigh||S)),R.USEIRRADIANCEMAP&&g.setTexture("irradianceSampler",S.irradianceTexture);const L=this.va().iblCdfGenerator;this.realTimeFiltering&&L&&g.setTexture("icdfSampler",L.getIcdfTexture())}R.ENVIRONMENTBRDF&&g.setTexture("environmentBrdfSampler",this._environmentBRDFTexture),this._emissiveTexture&&y.d.EmissiveTextureEnabled&&g.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&y.d.LightmapTextureEnabled&&g.setTexture("lightmapSampler",this._lightmapTexture),y.d.SpecularTextureEnabled&&(this._metallicTexture?g.setTexture("reflectivitySampler",this._metallicTexture):this._reflectivityTexture&&g.setTexture("reflectivitySampler",this._reflectivityTexture),this._metallicReflectanceTexture&&g.setTexture("metallicReflectanceSampler",this._metallicReflectanceTexture),this._reflectanceTexture&&R.REFLECTANCE&&g.setTexture("reflectanceSampler",this._reflectanceTexture),this._microSurfaceTexture&&g.setTexture("microSurfaceSampler",this._microSurfaceTexture)),this._bumpTexture&&Y.getCaps().standardDerivatives&&y.d.BumpTextureEnabled&&!this._disableBumpMap&&g.setTexture("bumpSampler",this._bumpTexture)}this.va().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(j)&&this.va().depthPeelingRenderer.bind(o),this._eventInfo.subMesh=P,this._callbackPluginEventBindForSubMesh(this._eventInfo),(0,X.g)(this._activeEffect,this,A),this.bindEyePosition(o)}else A.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);if(D||!this.isFrozen){var C;if(A.lightsEnabled&&!this._disableLighting&&(0,G.j)(A,j,this._activeEffect,R,this._maxSimultaneousLights),(A.fogEnabled&&j.applyFog&&A.fogMode!==a.e.FOGMODE_NONE||S||this.subSurface.refractionTexture||j.receiveShadows||R.PREPASS)&&this.bindView(o),(0,G.i)(A,j,this._activeEffect,!0),R.NUM_MORPH_INFLUENCERS&&(0,G.p)(j,this._activeEffect),R.BAKED_VERTEX_ANIMATION_TEXTURE)null===(C=j.bakedVertexAnimationManager)||void 0===C||C.bind(o,R.INSTANCES);this._imageProcessingConfiguration.bind(this._activeEffect),(0,G.n)(R,this._activeEffect,A)}this._afterBind(j,this._activeEffect,P),g.update()}getAnimatables(){const L=super.getAnimatables();return this._albedoTexture&&this._albedoTexture.animations&&this._albedoTexture.animations.length>0&&L.push(this._albedoTexture),this._baseWeightTexture&&this._baseWeightTexture.animations&&this._baseWeightTexture.animations.length>0&&L.push(this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&this._baseDiffuseRoughnessTexture.animations&&this._baseDiffuseRoughnessTexture.animations.length>0&&L.push(this._baseDiffuseRoughnessTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&L.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&L.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&L.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&L.push(this._emissiveTexture),this._metallicTexture&&this._metallicTexture.animations&&this._metallicTexture.animations.length>0?L.push(this._metallicTexture):this._reflectivityTexture&&this._reflectivityTexture.animations&&this._reflectivityTexture.animations.length>0&&L.push(this._reflectivityTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&L.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&L.push(this._lightmapTexture),this._metallicReflectanceTexture&&this._metallicReflectanceTexture.animations&&this._metallicReflectanceTexture.animations.length>0&&L.push(this._metallicReflectanceTexture),this._reflectanceTexture&&this._reflectanceTexture.animations&&this._reflectanceTexture.animations.length>0&&L.push(this._reflectanceTexture),this._microSurfaceTexture&&this._microSurfaceTexture.animations&&this._microSurfaceTexture.animations.length>0&&L.push(this._microSurfaceTexture),L}_getReflectionTexture(){return this._reflectionTexture?this._reflectionTexture:this.va().environmentTexture}getActiveTextures(){const L=super.getActiveTextures();return this._albedoTexture&&L.push(this._albedoTexture),this._baseWeightTexture&&L.push(this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&L.push(this._baseDiffuseRoughnessTexture),this._ambientTexture&&L.push(this._ambientTexture),this._opacityTexture&&L.push(this._opacityTexture),this._reflectionTexture&&L.push(this._reflectionTexture),this._emissiveTexture&&L.push(this._emissiveTexture),this._reflectivityTexture&&L.push(this._reflectivityTexture),this._metallicTexture&&L.push(this._metallicTexture),this._metallicReflectanceTexture&&L.push(this._metallicReflectanceTexture),this._reflectanceTexture&&L.push(this._reflectanceTexture),this._microSurfaceTexture&&L.push(this._microSurfaceTexture),this._bumpTexture&&L.push(this._bumpTexture),this._lightmapTexture&&L.push(this._lightmapTexture),L}hasTexture(L){return!!super.hasTexture(L)||(this._albedoTexture===L||(this._baseWeightTexture===L||(this._baseDiffuseRoughnessTexture===L||(this._ambientTexture===L||(this._opacityTexture===L||(this._reflectionTexture===L||(this._emissiveTexture===L||(this._reflectivityTexture===L||(this._metallicTexture===L||(this._metallicReflectanceTexture===L||(this._reflectanceTexture===L||(this._microSurfaceTexture===L||(this._bumpTexture===L||this._lightmapTexture===L)))))))))))))}setPrePassRenderer(){var L;if(null===(L=this.subSurface)||void 0===L||!L.isScatteringEnabled)return!1;const j=this.va().enableSubSurfaceForPrePass();return j&&(j.enabled=!0),!0}dispose(L,j){var P,A,R,o,Y,u,a,D,S,g,V,N,C,b;(this._breakShaderLoadedCheck=!0,j)&&(this._environmentBRDFTexture&&this.va().environmentBRDFTexture!==this._environmentBRDFTexture&&this._environmentBRDFTexture.dispose(),null===(P=this._albedoTexture)||void 0===P||P.dispose(),null===(A=this._baseWeightTexture)||void 0===A||A.dispose(),null===(R=this._baseDiffuseRoughnessTexture)||void 0===R||R.dispose(),null===(o=this._ambientTexture)||void 0===o||o.dispose(),null===(Y=this._opacityTexture)||void 0===Y||Y.dispose(),null===(u=this._reflectionTexture)||void 0===u||u.dispose(),null===(a=this._emissiveTexture)||void 0===a||a.dispose(),null===(D=this._metallicTexture)||void 0===D||D.dispose(),null===(S=this._reflectivityTexture)||void 0===S||S.dispose(),null===(g=this._bumpTexture)||void 0===g||g.dispose(),null===(V=this._lightmapTexture)||void 0===V||V.dispose(),null===(N=this._metallicReflectanceTexture)||void 0===N||N.dispose(),null===(C=this._reflectanceTexture)||void 0===C||C.dispose(),null===(b=this._microSurfaceTexture)||void 0===b||b.dispose());this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(L,j)}}s.PBRMATERIAL_OPAQUE=K.c.MATERIAL_OPAQUE,s.PBRMATERIAL_ALPHATEST=K.c.MATERIAL_ALPHATEST,s.PBRMATERIAL_ALPHABLEND=K.c.MATERIAL_ALPHABLEND,s.PBRMATERIAL_ALPHATESTANDBLEND=K.c.MATERIAL_ALPHATESTANDBLEND,s.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=0,s.LIGHTFALLOFF_PHYSICAL=0,s.LIGHTFALLOFF_GLTF=1,s.LIGHTFALLOFF_STANDARD=2,s.ForceGLSL=!1,(0,A.b)([(0,R.r)()],s.prototype,"_imageProcessingConfiguration",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsMiscDirty")],s.prototype,"debugMode",void 0)},11595:(L,j,P)=>{P.d(j,{c:()=>g});var A=P(636),R=P(639),o=P(11600),Y=P(685),u=P(11604),a=P(606),D=P(801),S=P(680);class g extends u.e{get refractionTexture(){return this.subSurface.refractionTexture}set refractionTexture(L){this.subSurface.refractionTexture=L,L?this.subSurface.isRefractionEnabled=!0:this.subSurface.linkRefractionWithTransparency||(this.subSurface.isRefractionEnabled=!1)}get indexOfRefraction(){return this.subSurface.indexOfRefraction}set indexOfRefraction(L){this.subSurface.indexOfRefraction=L}get invertRefractionY(){return this.subSurface.invertRefractionY}set invertRefractionY(L){this.subSurface.invertRefractionY=L}get linkRefractionWithTransparency(){return this.subSurface.linkRefractionWithTransparency}set linkRefractionWithTransparency(L){this.subSurface.linkRefractionWithTransparency=L,L&&(this.subSurface.isRefractionEnabled=!0)}get usePhysicalLightFalloff(){return this._lightFalloff===u.e.LIGHTFALLOFF_PHYSICAL}set usePhysicalLightFalloff(L){L!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=L?u.e.LIGHTFALLOFF_PHYSICAL:u.e.LIGHTFALLOFF_STANDARD)}get useGLTFLightFalloff(){return this._lightFalloff===u.e.LIGHTFALLOFF_GLTF}set useGLTFLightFalloff(L){L!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=L?u.e.LIGHTFALLOFF_GLTF:u.e.LIGHTFALLOFF_STANDARD)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(L){this._attachImageProcessingConfiguration(L),this._markAllSubMeshesAsImageProcessingDirty()}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(L){this.imageProcessingConfiguration.colorCurvesEnabled=L}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(L){this.imageProcessingConfiguration.colorGradingEnabled=L}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(L){this._imageProcessingConfiguration.toneMappingEnabled=L}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(L){this._imageProcessingConfiguration.exposure=L}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(L){this._imageProcessingConfiguration.contrast=L}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(L){this._imageProcessingConfiguration.colorGradingTexture=L}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(L){this._imageProcessingConfiguration.colorCurves=L}constructor(L,j){super(L,j,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this.disableBumpMap=!1,this.ambientTextureStrength=1,this.ambientTextureImpactOnAnalyticalLights=g.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this.metallicF0Factor=1,this.metallicReflectanceColor=Y.e.White(),this.useOnlyMetallicFromMetallicReflectanceTexture=!1,this.ambientColor=new Y.e(0,0,0),this.albedoColor=new Y.e(1,1,1),this.baseWeight=1,this.reflectivityColor=new Y.e(1,1,1),this.reflectionColor=new Y.e(1,1,1),this.emissiveColor=new Y.e(0,0,0),this.microSurface=1,this.useLightmapAsShadowmap=!1,this.useAlphaFromAlbedoTexture=!1,this.forceAlphaTest=!1,this.alphaCutOff=.4,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useRoughnessFromMetallicTextureAlpha=!0,this.useRoughnessFromMetallicTextureGreen=!1,this.useMetallnessFromMetallicTextureBlue=!1,this.useAmbientOcclusionFromMetallicTextureRed=!1,this.useAmbientInGrayScale=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useRadianceOverAlpha=!0,this.useObjectSpaceNormalMap=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.forceIrradianceInFragment=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this.twoSidedLighting=!1,this.useAlphaFresnel=!1,this.useLinearAlphaFresnel=!1,this.environmentBRDFTexture=null,this.forceNormalForward=!1,this.enableSpecularAntiAliasing=!1,this.useHorizonOcclusion=!0,this.useRadianceOcclusion=!0,this.unlit=!1,this.applyDecalMapAfterDetailMap=!1,this._environmentBRDFTexture=(0,o.b)(this.va())}getClassName(){return"PBRMaterial"}clone(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const A=S.e.Clone((()=>new g(L,this.va())),this,{cloneTexturesOnlyOnce:j});return A.id=L,A.name=L,this.stencil.copyTo(A.stencil),this._clonePlugins(A,P),A}serialize(){const L=super.serialize();return L.customType="BABYLON.PBRMaterial",L}static Parse(L,j,P){const A=S.e.Parse((()=>new g(L.name,j)),L,j,P);return L.stencil&&A.stencil.parse(L.stencil,j,P),D.c._ParsePlugins(L,A,j,P),L.clearCoat&&A.clearCoat.parse(L.clearCoat,j,P),L.anisotropy&&A.anisotropy.parse(L.anisotropy,j,P),L.brdf&&A.brdf.parse(L.brdf,j,P),L.sheen&&A.sheen.parse(L.sheen,j,P),L.subSurface&&A.subSurface.parse(L.subSurface,j,P),L.iridescence&&A.iridescence.parse(L.iridescence,j,P),A}}g.PBRMATERIAL_OPAQUE=u.e.PBRMATERIAL_OPAQUE,g.PBRMATERIAL_ALPHATEST=u.e.PBRMATERIAL_ALPHATEST,g.PBRMATERIAL_ALPHABLEND=u.e.PBRMATERIAL_ALPHABLEND,g.PBRMATERIAL_ALPHATESTANDBLEND=u.e.PBRMATERIAL_ALPHATESTANDBLEND,g.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=u.e.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"directIntensity",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"emissiveIntensity",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"environmentIntensity",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"specularIntensity",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"disableBumpMap",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"albedoTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"baseWeightTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"baseDiffuseRoughnessTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"ambientTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"ambientTextureStrength",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"ambientTextureImpactOnAnalyticalLights",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],g.prototype,"opacityTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"reflectionTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"emissiveTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"reflectivityTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"metallicTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"metallic",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"roughness",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"metallicF0Factor",void 0),(0,A.b)([(0,R.j)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"metallicReflectanceColor",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useOnlyMetallicFromMetallicReflectanceTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"metallicReflectanceTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"reflectanceTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"microSurfaceTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"bumpTexture",void 0),(0,A.b)([(0,R.E)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty",null)],g.prototype,"lightmapTexture",void 0),(0,A.b)([(0,R.j)("ambient"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"ambientColor",void 0),(0,A.b)([(0,R.j)("albedo"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"albedoColor",void 0),(0,A.b)([(0,R.K)("baseWeight"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"baseWeight",void 0),(0,A.b)([(0,R.K)("baseDiffuseRoughness"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"baseDiffuseRoughness",void 0),(0,A.b)([(0,R.j)("reflectivity"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"reflectivityColor",void 0),(0,A.b)([(0,R.j)("reflection"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"reflectionColor",void 0),(0,A.b)([(0,R.j)("emissive"),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"emissiveColor",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"microSurface",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useLightmapAsShadowmap",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],g.prototype,"useAlphaFromAlbedoTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],g.prototype,"forceAlphaTest",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],g.prototype,"alphaCutOff",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useSpecularOverAlpha",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useRoughnessFromMetallicTextureAlpha",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useRoughnessFromMetallicTextureGreen",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useMetallnessFromMetallicTextureBlue",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useAmbientInGrayScale",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),(0,A.b)([(0,R.K)()],g.prototype,"usePhysicalLightFalloff",null),(0,A.b)([(0,R.K)()],g.prototype,"useGLTFLightFalloff",null),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useRadianceOverAlpha",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useObjectSpaceNormalMap",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useParallax",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useParallaxOcclusion",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"parallaxScaleBias",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsLightsDirty")],g.prototype,"disableLighting",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"forceIrradianceInFragment",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsLightsDirty")],g.prototype,"maxSimultaneousLights",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"invertNormalMapX",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"invertNormalMapY",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"twoSidedLighting",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useAlphaFresnel",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useLinearAlphaFresnel",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"environmentBRDFTexture",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"forceNormalForward",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"enableSpecularAntiAliasing",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useHorizonOcclusion",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"useRadianceOcclusion",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],g.prototype,"unlit",void 0),(0,A.b)([(0,R.K)(),(0,R.c)("_markAllSubMeshesAsMiscDirty")],g.prototype,"applyDecalMapAfterDetailMap",void 0),(0,a.h)("BABYLON.PBRMaterial",g)},11580:(L,j,P)=>{P.d(j,{c:()=>R});var A=P(2032);class R extends A.e{constructor(L,j,P,R,o){let Y=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3,D=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,S=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0,V=arguments.length>11?arguments[11]:void 0;super(null,o,!Y,u,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,S),this.format=R,this._engine&&(this._engine._caps.textureFloatLinearFiltering||1!==D||(a=1),this._engine._caps.textureHalfFloatLinearFiltering||2!==D||(a=1),this._texture=this._engine.createRawTexture(L,j,P,R,Y,u,a,null,D,S??0,g??!1),this.wrapU=A.e.CLAMP_ADDRESSMODE,this.wrapV=A.e.CLAMP_ADDRESSMODE,this._waitingForData=!!V&&!L)}update(L){this._getEngine().updateRawTexture(this._texture,L,this._texture.format,this._texture.invertY,null,this._texture.type,this._texture._useSRGBBuffer),this._waitingForData=!1}clone(){if(!this._texture)return super.clone();const L=new R(null,this.getSize().width,this.getSize().height,this.format,this.va(),this._texture.generateMipMaps,this._invertY,this.samplingMode,this._texture.type,this._texture._creationFlags,this._useSRGBBuffer);return L._texture=this._texture,this._texture.incrementReferences(),L}isReady(){return super.isReady()&&!this._waitingForData}static CreateLuminanceTexture(L,j,P,A){return new R(L,j,P,1,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateLuminanceAlphaTexture(L,j,P,A){return new R(L,j,P,2,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateAlphaTexture(L,j,P,A){return new R(L,j,P,0,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateRGBTexture(L,j,P,A){return new R(L,j,P,4,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,arguments.length>9&&void 0!==arguments[9]&&arguments[9])}static CreateRGBATexture(L,j,P,A){return new R(L,j,P,5,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,arguments.length>9&&void 0!==arguments[9]&&arguments[9],arguments.length>10&&void 0!==arguments[10]&&arguments[10])}static CreateRGBAStorageTexture(L,j,P,A){return new R(L,j,P,5,A,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,1,arguments.length>8&&void 0!==arguments[8]&&arguments[8])}static CreateRTexture(L,j,P,o){let Y=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:A.e.TRILINEAR_SAMPLINGMODE;return new R(L,j,P,6,o,Y,u,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:1)}static CreateRStorageTexture(L,j,P,o){let Y=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:A.e.TRILINEAR_SAMPLINGMODE;return new R(L,j,P,6,o,Y,u,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,1)}}},11644:(L,j,P)=>{P.d(j,{d:()=>A});class A{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(L,j){this._defines[L]||(L<this._currentRank&&(this._currentRank=L),L>this._maxRank&&(this._maxRank=L),this._defines[L]=new Array),this._defines[L].push(j)}addCPUSkinningFallback(L,j){this._mesh=j,L<this._currentRank&&(this._currentRank=L),L>this._maxRank&&(this._maxRank=L)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(L,j){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,L=L.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),j._bonesComputationForcedToCPU=!0;const P=this._mesh.va();for(let L=0;L<P.meshes.length;L++){const A=P.meshes[L];if(A.material){if(A.computeBonesUsingShaders&&0!==A.numBoneInfluencers)if(A.material.getEffect()===j)A.computeBonesUsingShaders=!1;else if(A.Bi)for(const L of A.Bi){if(L.effect===j){A.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&A.computeBonesUsingShaders&&A.numBoneInfluencers>0&&(A.computeBonesUsingShaders=!1)}}else{const j=this._defines[this._currentRank];if(j)for(let P=0;P<j.length;P++)L=L.replace("#define "+j[P],"");this._currentRank++}return L}}},11653:(L,j,P)=>{P.d(j,{e:()=>g});var A=P(636),R=P(801),o=P(639),Y=P(11639),u=P(11612),a=P(11620),D=P(805);class S extends u.d{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class g extends a.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(L,"DetailMap",140,new S,j),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=R.c.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=L._dirtyCallbacks[1]}isReadyForSubMesh(L,j,P){return!this._isEnabled||!(L._areTexturesDirty&&j.texturesEnabled&&P.getCaps().standardDerivatives&&this._texture&&Y.d.DetailTextureEnabled&&!this._texture.isReady())}prepareDefines(L,j){if(this._isEnabled){L.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const P=j.getEngine();L._areTexturesDirty&&(P.getCaps().standardDerivatives&&this._texture&&Y.d.DetailTextureEnabled&&this._isEnabled?((0,D.Q)(this._texture,L,"DETAIL"),L.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):L.DETAIL=!1)}else L.DETAIL=!1}bindForSubMesh(L,j){if(!this._isEnabled)return;const P=this._material.isFrozen;L.useUbo&&P&&L.isSync||this._texture&&Y.d.DetailTextureEnabled&&(L.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),(0,D.t)(this._texture,L,"detail")),j.texturesEnabled&&this._texture&&Y.d.DetailTextureEnabled&&L.setTexture("detailSampler",this._texture)}hasTexture(L){return this._texture===L}getActiveTextures(L){this._texture&&L.push(this._texture)}getAnimatables(L){this._texture&&this._texture.animations&&this._texture.animations.length>0&&L.push(this._texture)}dispose(L){var j;L&&(null===(j=this._texture)||void 0===j||j.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(L){L.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}(0,A.b)([(0,o.E)("detailTexture"),(0,o.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"texture",void 0),(0,A.b)([(0,o.K)()],g.prototype,"diffuseBlendLevel",void 0),(0,A.b)([(0,o.K)()],g.prototype,"roughnessBlendLevel",void 0),(0,A.b)([(0,o.K)()],g.prototype,"bumpLevel",void 0),(0,A.b)([(0,o.K)(),(0,o.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"normalBlendMethod",void 0),(0,A.b)([(0,o.K)(),(0,o.c)("_markAllSubMeshesAsTexturesDirty")],g.prototype,"isEnabled",void 0)},11612:(L,j,P)=>{P.d(j,{d:()=>A});class A{constructor(L){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=L,L)for(const j in L)Object.prototype.hasOwnProperty.call(L,j)&&this._setDefaultValue(j)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||L,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const L of Object.keys(this))"_"!==L[0]&&this._keys.push(L);if(this._externalProperties)for(const L in this._externalProperties)-1===this._keys.indexOf(L)&&this._keys.push(L)}isEqual(L){if(this._keys.length!==L._keys.length)return!1;for(let j=0;j<this._keys.length;j++){const P=this._keys[j];if(this[P]!==L[P])return!1}return!0}cloneTo(L){this._keys.length!==L._keys.length&&(L._keys=this._keys.slice(0));for(let j=0;j<this._keys.length;j++){const P=this._keys[j];L[P]=this[P]}}reset(){for(const L of this._keys)this._setDefaultValue(L)}_setDefaultValue(L){var j,P,A,R;const o=(null===(j=this._externalProperties)||void 0===j||null===(P=j[L])||void 0===P?void 0:P.type)??typeof this[L],Y=null===(A=this._externalProperties)||void 0===A||null===(R=A[L])||void 0===R?void 0:R.default;switch(o){case"number":this[L]=Y??0;break;case"string":this[L]=Y??"";break;default:this[L]=Y??!1}}toString(){let L="";for(let j=0;j<this._keys.length;j++){const P=this._keys[j],A=this[P];switch(typeof A){case"number":case"string":L+="#define "+P+" "+A+"\n";break;default:A&&(L+="#define "+P+"\n")}}return L}}},11639:(L,j,P)=>{P.d(j,{d:()=>R});var A=P(554);class R{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(L){this._DiffuseTextureEnabled!==L&&(this._DiffuseTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get BaseWeightTextureEnabled(){return this._BaseWeightTextureEnabled}static set BaseWeightTextureEnabled(L){this._BaseWeightTextureEnabled!==L&&(this._BaseWeightTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get BaseDiffuseRoughnessTextureEnabled(){return this._BaseDiffuseRoughnessTextureEnabled}static set BaseDiffuseRoughnessTextureEnabled(L){this._BaseDiffuseRoughnessTextureEnabled!==L&&(this._BaseDiffuseRoughnessTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(L){this._DetailTextureEnabled!==L&&(this._DetailTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get DecalMapEnabled(){return this._DecalMapEnabled}static set DecalMapEnabled(L){this._DecalMapEnabled!==L&&(this._DecalMapEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(L){this._AmbientTextureEnabled!==L&&(this._AmbientTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(L){this._OpacityTextureEnabled!==L&&(this._OpacityTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(L){this._ReflectionTextureEnabled!==L&&(this._ReflectionTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(L){this._EmissiveTextureEnabled!==L&&(this._EmissiveTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(L){this._SpecularTextureEnabled!==L&&(this._SpecularTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(L){this._BumpTextureEnabled!==L&&(this._BumpTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(L){this._LightmapTextureEnabled!==L&&(this._LightmapTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(L){this._RefractionTextureEnabled!==L&&(this._RefractionTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(L){this._ColorGradingTextureEnabled!==L&&(this._ColorGradingTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(L){this._FresnelEnabled!==L&&(this._FresnelEnabled=L,A.d.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(L){this._ClearCoatTextureEnabled!==L&&(this._ClearCoatTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(L){this._ClearCoatBumpTextureEnabled!==L&&(this._ClearCoatBumpTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(L){this._ClearCoatTintTextureEnabled!==L&&(this._ClearCoatTintTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(L){this._SheenTextureEnabled!==L&&(this._SheenTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(L){this._AnisotropicTextureEnabled!==L&&(this._AnisotropicTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(L){this._ThicknessTextureEnabled!==L&&(this._ThicknessTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(L){this._RefractionIntensityTextureEnabled!==L&&(this._RefractionIntensityTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._TranslucencyIntensityTextureEnabled}static set TranslucencyIntensityTextureEnabled(L){this._TranslucencyIntensityTextureEnabled!==L&&(this._TranslucencyIntensityTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get TranslucencyColorTextureEnabled(){return this._TranslucencyColorTextureEnabled}static set TranslucencyColorTextureEnabled(L){this._TranslucencyColorTextureEnabled!==L&&(this._TranslucencyColorTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(L){this._IridescenceTextureEnabled!==L&&(this._IridescenceTextureEnabled=L,A.d.MarkAllMaterialsAsDirty(1))}}R._DiffuseTextureEnabled=!0,R._BaseWeightTextureEnabled=!0,R._BaseDiffuseRoughnessTextureEnabled=!0,R._DetailTextureEnabled=!0,R._DecalMapEnabled=!0,R._AmbientTextureEnabled=!0,R._OpacityTextureEnabled=!0,R._ReflectionTextureEnabled=!0,R._EmissiveTextureEnabled=!0,R._SpecularTextureEnabled=!0,R._BumpTextureEnabled=!0,R._LightmapTextureEnabled=!0,R._RefractionTextureEnabled=!0,R._ColorGradingTextureEnabled=!0,R._FresnelEnabled=!0,R._ClearCoatTextureEnabled=!0,R._ClearCoatBumpTextureEnabled=!0,R._ClearCoatTintTextureEnabled=!0,R._SheenTextureEnabled=!0,R._AnisotropicTextureEnabled=!0,R._ThicknessTextureEnabled=!0,R._RefractionIntensityTextureEnabled=!0,R._TranslucencyIntensityTextureEnabled=!0,R._TranslucencyColorTextureEnabled=!0,R._IridescenceTextureEnabled=!0},11658:(L,j,P)=>{P.d(j,{c:()=>o});var A,R=P(656);!function(L){L[L.Zero=0]="Zero",L[L.One=1]="One",L[L.MaxViewZ=2]="MaxViewZ"}(A||(A={}));class o{static CreateConfiguration(L){return o._Configurations[L]={defines:{},previousWorldMatrices:{},previousViewProjection:R.e.Zero(),currentViewProjection:R.e.Zero(),previousBones:{},lastUpdateFrameId:-1,excludedSkinnedMesh:[],reverseCulling:!1},o._Configurations[L]}static DeleteConfiguration(L){delete o._Configurations[L]}static GetConfiguration(L){return o._Configurations[L]}static AddUniformsAndSamplers(L,j){L.push("previousWorld","previousViewProjection","mPreviousBones")}static MarkAsDirty(L,j){for(const P of j)if(P.Bi)for(const j of P.Bi)j._removeDrawWrapper(L)}static PrepareDefines(L,j,P){if(!P._arePrePassDirty)return;const A=o._Configurations[L];if(!A)return;P.PREPASS=!0,P.PREPASS_COLOR=!1,P.PREPASS_COLOR_INDEX=-1;let R=0;for(let Y=0;Y<o.GeometryTextureDescriptions.length;Y++){const L=o.GeometryTextureDescriptions[Y],j=L.define,u=L.defineIndex,a=A.defines[u];void 0!==a?(P[j]=!0,P[u]=a,R++):(P[j]=!1,delete P[u])}P.SCENE_MRT_COUNT=R,P.BONES_VELOCITY_ENABLED=j.useBones&&j.computeBonesUsingShaders&&j.skeleton&&!j.skeleton.isUsingTextureForMatrices&&-1===A.excludedSkinnedMesh.indexOf(j)}static Bind(L,j,P,A,R){const Y=o._Configurations[L];if(!Y)return;const u=P.va(),a=u.getEngine();if(Y.reverseCulling&&a.setStateCullFaceType(u._mirroredCameraPosition?R.cullBackFaces:!R.cullBackFaces),(void 0!==Y.defines.PREPASS_VELOCITY_INDEX||void 0!==Y.defines.PREPASS_VELOCITY_LINEAR_INDEX)&&(Y.previousWorldMatrices[P.uniqueId]||(Y.previousWorldMatrices[P.uniqueId]=A.clone()),Y.previousViewProjection||(Y.previousViewProjection=u.getTransformMatrix().clone(),Y.currentViewProjection=u.getTransformMatrix().clone()),Y.currentViewProjection.updateFlag!==u.getTransformMatrix().updateFlag?(Y.lastUpdateFrameId=a.frameId,Y.previousViewProjection.p(Y.currentViewProjection),Y.currentViewProjection.p(u.getTransformMatrix())):Y.lastUpdateFrameId!==a.frameId&&(Y.lastUpdateFrameId=a.frameId,Y.previousViewProjection.p(Y.currentViewProjection)),j.setMatrix("previousWorld",Y.previousWorldMatrices[P.uniqueId]),j.setMatrix("previousViewProjection",Y.previousViewProjection),Y.previousWorldMatrices[P.uniqueId]=A.clone(),P.useBones&&P.computeBonesUsingShaders&&P.skeleton)){const L=P.skeleton;if(!L.isUsingTextureForMatrices||-1===j.getUniformIndex("boneTextureWidth")){const A=L.getTransformMatrices(P);A&&(Y.previousBones[P.uniqueId]||(Y.previousBones[P.uniqueId]=A.slice()),j.setMatrices("mPreviousBones",Y.previousBones[P.uniqueId]),Y.previousBones[P.uniqueId].set(A))}}}}o.GeometryTextureDescriptions=[{type:0,name:"Irradiance",clearType:0,define:"PREPASS_IRRADIANCE",defineIndex:"PREPASS_IRRADIANCE_INDEX"},{type:1,name:"WorldPosition",clearType:0,define:"PREPASS_POSITION",defineIndex:"PREPASS_POSITION_INDEX"},{type:2,name:"Velocity",clearType:0,define:"PREPASS_VELOCITY",defineIndex:"PREPASS_VELOCITY_INDEX"},{type:3,name:"Reflectivity",clearType:0,define:"PREPASS_REFLECTIVITY",defineIndex:"PREPASS_REFLECTIVITY_INDEX"},{type:5,name:"ViewDepth",clearType:2,define:"PREPASS_DEPTH",defineIndex:"PREPASS_DEPTH_INDEX"},{type:6,name:"ViewNormal",clearType:0,define:"PREPASS_NORMAL",defineIndex:"PREPASS_NORMAL_INDEX"},{type:7,name:"AlbedoSqrt",clearType:0,define:"PREPASS_ALBEDO_SQRT",defineIndex:"PREPASS_ALBEDO_SQRT_INDEX"},{type:8,name:"WorldNormal",clearType:0,define:"PREPASS_WORLD_NORMAL",defineIndex:"PREPASS_WORLD_NORMAL_INDEX"},{type:9,name:"LocalPosition",clearType:0,define:"PREPASS_LOCAL_POSITION",defineIndex:"PREPASS_LOCAL_POSITION_INDEX"},{type:10,name:"ScreenDepth",clearType:1,define:"PREPASS_SCREENSPACE_DEPTH",defineIndex:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:11,name:"LinearVelocity",clearType:0,define:"PREPASS_VELOCITY_LINEAR",defineIndex:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:12,name:"Albedo",clearType:0,define:"PREPASS_ALBEDO",defineIndex:"PREPASS_ALBEDO_INDEX"},{type:13,name:"NormalizedViewDepth",clearType:1,define:"PREPASS_NORMALIZED_VIEW_DEPTH",defineIndex:"PREPASS_NORMALIZED_VIEW_DEPTH_INDEX"}],o._Configurations={}},11620:(L,j,P)=>{P.d(j,{c:()=>h});var A=P(636),R=P(639),o=P(801),Y=P(519),u=P(538),a=P(563);const D=new RegExp("^([gimus]+)!");class S{constructor(L){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=L,this._scene=L.va(),this._engine=this._scene.getEngine()}_addPlugin(L){for(let A=0;A<this._plugins.length;++A)if(this._plugins[A].name===L.name)return!1;if(this._material._uniformBufferLayoutBuilt&&(this._material.resetDrawCache(),this._material._createUniformBuffer()),!L.isCompatible(this._material.shaderLanguage))throw`The plugin "${L.name}" can't be added to the material "${this._material.name}" because the plugin is not compatible with the shader language of the material.`;const j=L.getClassName();S._MaterialPluginClassToMainDefine[j]||(S._MaterialPluginClassToMainDefine[j]="MATERIALPLUGIN_"+ ++S._MaterialPluginCounter),this._material._callbackPluginEventGeneric=(L,j)=>this._handlePluginEvent(L,j),this._plugins.push(L),this._plugins.sort(((L,j)=>L.priority-j.priority)),this._codeInjectionPoints={};const P={};P[S._MaterialPluginClassToMainDefine[j]]={type:"boolean",default:!0};for(const A of this._plugins)A.collectDefines(P),this._collectPointNames("vertex",A.getCustomCode("vertex",this._material.shaderLanguage)),this._collectPointNames("fragment",A.getCustomCode("fragment",this._material.shaderLanguage));return this._defineNamesFromPlugins=P,!0}_activatePlugin(L){-1===this._activePlugins.indexOf(L)&&(this._activePlugins.push(L),this._activePlugins.sort(((L,j)=>L.priority-j.priority)),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),L.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(L),this._activePluginsForExtraEvents.sort(((L,j)=>L.priority-j.priority)),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(L){for(let j=0;j<this._plugins.length;++j)if(this._plugins[j].name===L)return this._plugins[j];return null}_handlePluginEventIsReadyForSubMesh(L){let j=!0;for(const P of this._activePlugins)j=j&&P.isReadyForSubMesh(L.defines,this._scene,this._engine,L.subMesh);L.isReadyForSubMesh=j}_handlePluginEventPrepareDefinesBeforeAttributes(L){for(const j of this._activePlugins)j.prepareDefinesBeforeAttributes(L.defines,this._scene,L.mesh)}_handlePluginEventPrepareDefines(L){for(const j of this._activePlugins)j.prepareDefines(L.defines,this._scene,L.mesh)}_handlePluginEventHardBindForSubMesh(L){for(const j of this._activePluginsForExtraEvents)j.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,L.subMesh)}_handlePluginEventBindForSubMesh(L){for(const j of this._activePlugins)j.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,L.subMesh)}_handlePluginEventHasRenderTargetTextures(L){let j=!1;for(const P of this._activePluginsForExtraEvents)if(j=P.hasRenderTargetTextures(),j)break;L.hasRenderTargetTextures=j}_handlePluginEventFillRenderTargetTextures(L){for(const j of this._activePluginsForExtraEvents)j.fillRenderTargetTextures(L.renderTargets)}_handlePluginEvent(L,j){switch(L){case 512:{const L=j;for(const j of this._activePlugins)j.getActiveTextures(L.activeTextures);break}case 256:{const L=j;for(const j of this._activePlugins)j.getAnimatables(L.animatables);break}case 1024:{const L=j;let P=!1;for(const j of this._activePlugins)if(P=j.hasTexture(L.texture),P)break;L.hasTexture=P;break}case 2:{const L=j;for(const j of this._plugins)j.dispose(L.forceDisposeTextures);break}case 4:j.defineNames=this._defineNamesFromPlugins;break;case 128:{const L=j;for(const j of this._activePlugins)L.fallbackRank=j.addFallbacks(L.defines,L.fallbacks,L.fallbackRank),j.getAttributes(L.attributes,this._scene,L.mesh);this._uniformList.length>0&&L.uniforms.push(...this._uniformList),this._samplerList.length>0&&L.samplers.push(...this._samplerList),this._uboList.length>0&&L.uniformBuffersNames.push(...this._uboList),L.customCode=this._injectCustomCode(L,L.customCode);break}case 8:{const L=j;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];const P=1===this._material.shaderLanguage;for(const j of this._plugins){const A=j.getUniforms(this._material.shaderLanguage);if(A){if(A.ubo)for(const j of A.ubo){if(j.size&&j.type){const A=j.arraySize??0;if(L.ubo.addUniform(j.name,j.size,A),P){let L;switch(j.type){case"mat4":L="mat4x4f";break;case"float":L="f32";break;default:L=`${j.type}f`}this._uboDeclaration+=A>0?`uniform ${j.name}: array<${L}, ${A}>;\n`:`uniform ${j.name}: ${L};\n`}else this._uboDeclaration+=`${j.type} ${j.name}${A>0?`[${A}]`:""};\n`}this._uniformList.push(j.name)}A.vertex&&(this._vertexDeclaration+=A.vertex+"\n"),A.fragment&&(this._fragmentDeclaration+=A.fragment+"\n")}j.getSamplers(this._samplerList),j.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(L,j){if(j)for(const P in j)this._codeInjectionPoints[L]||(this._codeInjectionPoints[L]={}),this._codeInjectionPoints[L][P]=!0}_injectCustomCode(L,j){return(P,A)=>{var R;j&&(A=j(P,A)),this._uboDeclaration&&(A=A.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(A=A.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(A=A.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const o=null===(R=this._codeInjectionPoints)||void 0===R?void 0:R[P];if(!o)return A;let Y=null;for(let j in o){let R="";for(const A of this._activePlugins){var S;let o=null===(S=A.getCustomCode(P,this._material.shaderLanguage))||void 0===S?void 0:S[j];if(o){if(A.resolveIncludes){if(null===Y){const j=0;Y={defines:[],indexParameters:L.indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:void 0,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:a.d.GetShadersRepository(j),includesShadersStore:a.d.GetIncludesShadersStore(j),version:void 0,platformName:this._engine.shaderPlatformName,processingContext:void 0,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:void 0}}Y.isFragment="fragment"===P,(0,u.h)(o,Y,(L=>o=L))}R+=o+"\n"}}if(R.length>0)if("!"===j.charAt(0)){j=j.substring(1);let L="g";if("!"===j.charAt(0))L="",j=j.substring(1);else{const P=D.exec(j);P&&P.length>=2&&(L=P[1],j=j.substring(L.length+1))}L.indexOf("g")<0&&(L+="g");const P=A,o=new RegExp(j,L);let Y=o.exec(P);for(;null!==Y;){let L=R;for(let j=0;j<Y.length;++j)L=L.replace("$"+j,Y[j]);A=A.replace(Y[0],L),Y=o.exec(P)}}else{const L="#define "+j;A=A.replace(L,"\n"+R+"\n"+L)}}return A}}}S._MaterialPluginClassToMainDefine={},S._MaterialPluginCounter=0,Y.b.OnEnginesDisposedObservable.add((()=>{C()}));const g=[];let V=!1,N=null;function C(){g.length=0,V=!1,o.c.OnEventObservable.remove(N),N=null}var b=P(680),f=P(606);class h{isCompatible(L){return 0===L}_enable(L){L&&this._pluginManager._activatePlugin(this)}constructor(L,j,P,A){let R=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],Y=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.priority=500,this.resolveIncludes=!1,this.registerForExtraEvents=!1,this.doNotSerialize=!1,this._material=L,this.name=j,this.priority=P,this.resolveIncludes=Y,L.pluginManager||(L.pluginManager=new S(L),L.Oi.add((()=>{L.pluginManager=void 0}))),this._pluginDefineNames=A,this._pluginManager=L.pluginManager,R&&this._pluginManager._addPlugin(this),o&&this._enable(!0),this.markAllDefinesAsDirty=L._dirtyCallbacks[127]}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(L,j,P,A){return!0}hardBindForSubMesh(L,j,P,A){}bindForSubMesh(L,j,P,A){}dispose(L){}getCustomCode(L){return null}collectDefines(L){if(this._pluginDefineNames)for(const j of Object.keys(this._pluginDefineNames)){if("_"===j[0])continue;const P=typeof this._pluginDefineNames[j];L[j]={type:"number"===P?"number":"string"===P?"string":"boolean"===P?"boolean":"object",default:this._pluginDefineNames[j]}}}prepareDefinesBeforeAttributes(L,j,P){}prepareDefines(L,j,P){}hasTexture(L){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(L){}getActiveTextures(L){}getAnimatables(L){}addFallbacks(L,j,P){return P}getSamplers(L){}getAttributes(L,j,P){}getUniformBuffersNames(L){}getUniforms(){return{}}copyTo(L){b.e.Clone((()=>L),this)}serialize(){return b.e.Serialize(this)}parse(L,j,P){b.e.Parse((()=>this),L,j,P)}}(0,A.b)([(0,R.K)()],h.prototype,"name",void 0),(0,A.b)([(0,R.K)()],h.prototype,"priority",void 0),(0,A.b)([(0,R.K)()],h.prototype,"resolveIncludes",void 0),(0,A.b)([(0,R.K)()],h.prototype,"registerForExtraEvents",void 0),(0,f.h)("BABYLON.MaterialPluginBase",h)},11626:(L,j,P)=>{P.d(j,{b:()=>A});class A{constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(L){L.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(L){}bindForSubMesh(L,j,P,A,R){if(j.prePassRenderer&&j.prePassRenderer.enabled&&j.prePassRenderer.currentRTisSceneRT&&(-1!==j.prePassRenderer.getIndex(2)||-1!==j.prePassRenderer.getIndex(11))){this.previousWorldMatrices[P.uniqueId]||(this.previousWorldMatrices[P.uniqueId]=A.clone()),this.previousViewProjection||(this.previousViewProjection=j.getTransformMatrix().clone(),this.currentViewProjection=j.getTransformMatrix().clone());const R=j.getEngine();this.currentViewProjection.updateFlag!==j.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=R.frameId,this.previousViewProjection.p(this.currentViewProjection),this.currentViewProjection.p(j.getTransformMatrix())):this._lastUpdateFrameId!==R.frameId&&(this._lastUpdateFrameId=R.frameId,this.previousViewProjection.p(this.currentViewProjection)),L.setMatrix("previousWorld",this.previousWorldMatrices[P.uniqueId]),L.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[P.uniqueId]=A.clone()}}}},11634:(L,j,P)=>{P.d(j,{e:()=>o});var A=P(656),R=P(801);class o extends R.c{constructor(L,j){let P=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(L,j,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new A.e,this._storeEffectOnSubMeshes=P}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(L,j){return!!L&&(!this._storeEffectOnSubMeshes||(!L.Bi||0===L.Bi.length||this.isReadyForSubMesh(L,L.Bi[0],j)))}_isReadyForSubMesh(L){const j=L.materialDefines;return!(this.checkReadyOnEveryCall||!L.effect||!j||j._renderId!==this.va().getRenderId())}bindOnlyWorldMatrix(L){this._activeEffect.setMatrix("world",L)}bindOnlyNormalMatrix(L){this._activeEffect.setMatrix("normalMatrix",L)}bind(L,j){j&&this.bindForSubMesh(L,j,j.Bi[0])}_afterBind(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,P=arguments.length>2?arguments[2]:void 0;super._afterBind(L,j,P),this.va()._cachedEffect=j,P?P._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(L,j,P){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return P._drawWrapper._forceRebindOnNextCall||L.isCachedMaterialInvalid(this,j,A)}dispose(L,j,P){this._activeEffect=void 0,super.dispose(L,j,P)}}},11692:(L,j,P)=>{P.d(j,{c:()=>f});var A=P(680),R=P(2149),o=P(656),Y=P(708),u=P(2032),a=P(606),D=P(11644),S=P(512),g=P(11634),V=P(519),N=P(818),C=P(805);const b={effect:null,subMesh:null};class f extends g.e{constructor(L,j,P){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(L,j,!(arguments.length>4&&void 0!==arguments[4])||arguments[4]),this._textures={},this._textureArrays={},this._externalTextures={},this._floats={},this._ints={},this._uints={},this._floatsArrays={},this._colors3={},this._colors3Arrays={},this._colors4={},this._colors4Arrays={},this._vectors2={},this._vectors3={},this._vectors4={},this._quaternions={},this._quaternionsArrays={},this._matrices={},this._matrixArrays={},this._matrices3x3={},this._matrices2x2={},this._vectors2Arrays={},this._vectors3Arrays={},this._vectors4Arrays={},this._uniformBuffers={},this._textureSamplers={},this._storageBuffers={},this._cachedWorldViewMatrix=new o.e,this._cachedWorldViewProjectionMatrix=new o.e,this._multiview=!1,this._materialHelperNeedsPreviousMatrices=!1,this._shaderPath=P,this._options={needAlphaBlending:!1,needAlphaTesting:!1,attributes:["position","Xi","uv"],uniforms:["worldViewProjection"],uniformBuffers:[],samplers:[],externalTextures:[],samplerObjects:[],storageBuffers:[],defines:[],useClipPlane:!1,...A}}get shaderPath(){return this._shaderPath}set shaderPath(L){this._shaderPath=L}get options(){return this._options}get isMultiview(){return this._multiview}getClassName(){return"ShaderMaterial"}needAlphaBlending(){return this.alpha<1||this._options.needAlphaBlending}needAlphaTesting(){return this._options.needAlphaTesting}_checkUniform(L){-1===this._options.uniforms.indexOf(L)&&this._options.uniforms.push(L)}setTexture(L,j){return-1===this._options.samplers.indexOf(L)&&this._options.samplers.push(L),this._textures[L]=j,this}removeTexture(L){delete this._textures[L]}setTextureArray(L,j){return-1===this._options.samplers.indexOf(L)&&this._options.samplers.push(L),this._checkUniform(L),this._textureArrays[L]=j,this}setExternalTexture(L,j){return-1===this._options.externalTextures.indexOf(L)&&this._options.externalTextures.push(L),this._externalTextures[L]=j,this}setFloat(L,j){return this._checkUniform(L),this._floats[L]=j,this}setInt(L,j){return this._checkUniform(L),this._ints[L]=j,this}setUInt(L,j){return this._checkUniform(L),this._uints[L]=j,this}setFloats(L,j){return this._checkUniform(L),this._floatsArrays[L]=j,this}setColor3(L,j){return this._checkUniform(L),this._colors3[L]=j,this}setColor3Array(L,j){return this._checkUniform(L),this._colors3Arrays[L]=j.reduce(((L,j)=>(L.push(j.r,j.g,j.b),L)),[]),this}setColor4(L,j){return this._checkUniform(L),this._colors4[L]=j,this}setColor4Array(L,j){return this._checkUniform(L),this._colors4Arrays[L]=j.reduce(((L,j)=>(L.push(j.r,j.g,j.b,j.a),L)),[]),this}setVector2(L,j){return this._checkUniform(L),this._vectors2[L]=j,this}setVector3(L,j){return this._checkUniform(L),this._vectors3[L]=j,this}setVector4(L,j){return this._checkUniform(L),this._vectors4[L]=j,this}setQuaternion(L,j){return this._checkUniform(L),this._quaternions[L]=j,this}setQuaternionArray(L,j){return this._checkUniform(L),this._quaternionsArrays[L]=j.reduce(((L,j)=>(j.toArray(L,L.length),L)),[]),this}setMatrix(L,j){return this._checkUniform(L),this._matrices[L]=j,this}setMatrices(L,j){this._checkUniform(L);const P=new Float32Array(16*j.length);for(let A=0;A<j.length;A++){j[A].copyToArray(P,16*A)}return this._matrixArrays[L]=P,this}setMatrix3x3(L,j){return this._checkUniform(L),this._matrices3x3[L]=j,this}setMatrix2x2(L,j){return this._checkUniform(L),this._matrices2x2[L]=j,this}setArray2(L,j){return this._checkUniform(L),this._vectors2Arrays[L]=j,this}setArray3(L,j){return this._checkUniform(L),this._vectors3Arrays[L]=j,this}setArray4(L,j){return this._checkUniform(L),this._vectors4Arrays[L]=j,this}setUniformBuffer(L,j){return-1===this._options.uniformBuffers.indexOf(L)&&this._options.uniformBuffers.push(L),this._uniformBuffers[L]=j,this}setTextureSampler(L,j){return-1===this._options.samplerObjects.indexOf(L)&&this._options.samplerObjects.push(L),this._textureSamplers[L]=j,this}setStorageBuffer(L,j){return-1===this._options.storageBuffers.indexOf(L)&&this._options.storageBuffers.push(L),this._storageBuffers[L]=j,this}setDefine(L,j){const P=L.trimEnd()+" ",A=this.options.defines.findIndex((j=>j===L||j.startsWith(P)));return A>=0&&this.options.defines.splice(A,1),("boolean"!==typeof j||j)&&this.options.defines.push(P+j),this}isReadyForSubMesh(L,j,P){return this.isReady(L,P,j)}isReady(L,j,P){var A;const o=P&&this._storeEffectOnSubMeshes;if(this.isFrozen){const L=o?P._drawWrapper:this._drawWrapper;if(L.effect&&L._wasPreviouslyReady&&L._wasPreviouslyUsingInstances===j)return!0}const u=this.va(),a=u.getEngine(),S=[],g=[];let V=null,f=this._shaderPath,h=this._options.uniforms,K=this._options.uniformBuffers,v=this._options.samplers;a.getCaps().multiview&&u.activeCamera&&u.activeCamera.outputRenderTarget&&u.activeCamera.outputRenderTarget.getViewCount()>1&&(this._multiview=!0,S.push("#define MULTIVIEW"),-1!==h.indexOf("viewProjection")&&-1===h.indexOf("viewProjectionR")&&h.push("viewProjectionR"));for(let R=0;R<this._options.defines.length;R++){const L=0===this._options.defines[R].indexOf("#define")?this._options.defines[R]:`#define ${this._options.defines[R]}`;S.push(L)}for(let R=0;R<this._options.attributes.length;R++)g.push(this._options.attributes[R]);if(L&&L.isVerticesDataPresent(Y.e.ColorKind)&&(-1===g.indexOf(Y.e.ColorKind)&&g.push(Y.e.ColorKind),S.push("#define VERTEXCOLOR")),j&&(S.push("#define INSTANCES"),(0,C._)(g,this._materialHelperNeedsPreviousMatrices),null!==L&&void 0!==L&&L.hasThinInstances&&(S.push("#define THIN_INSTANCES"),L&&L.isVerticesDataPresent(Y.e.ColorInstanceKind)&&(g.push(Y.e.ColorInstanceKind),S.push("#define INSTANCESCOLOR")))),L&&L.useBones&&L.computeBonesUsingShaders&&L.skeleton){g.push(Y.e.MatricesIndicesKind),g.push(Y.e.MatricesWeightsKind),L.numBoneInfluencers>4&&(g.push(Y.e.MatricesIndicesExtraKind),g.push(Y.e.MatricesWeightsExtraKind));const j=L.skeleton;S.push("#define NUM_BONE_INFLUENCERS "+L.numBoneInfluencers),V=new D.d,V.addCPUSkinningFallback(0,L),j.isUsingTextureForMatrices?(S.push("#define BONETEXTURE"),-1===h.indexOf("boneTextureWidth")&&h.push("boneTextureWidth"),-1===this._options.samplers.indexOf("boneSampler")&&this._options.samplers.push("boneSampler")):(S.push("#define BonesPerMesh "+(j.bones.length+1)),-1===h.indexOf("mBones")&&h.push("mBones"))}else S.push("#define NUM_BONE_INFLUENCERS 0");let q=0;const y=L?L.morphTargetManager:null;if(y){const j=-1!==S.indexOf("#define UV1"),P=-1!==S.indexOf("#define UV2"),A=-1!==S.indexOf("#define TANGENT"),R=-1!==S.indexOf("#define NORMAL"),o=-1!==S.indexOf("#define VERTEXCOLOR");q=(0,C.H)(y,S,g,L,!0,R,A,j,P,o),y.isUsingTextureForTargets&&(-1===h.indexOf("morphTargetTextureIndices")&&h.push("morphTargetTextureIndices"),-1===this._options.samplers.indexOf("morphTargets")&&this._options.samplers.push("morphTargets")),q>0&&(h=h.slice(),h.push("morphTargetInfluences"),h.push("morphTargetCount"),h.push("morphTargetTextureInfo"),h.push("morphTargetTextureIndices"))}else S.push("#define NUM_MORPH_INFLUENCERS 0");if(L){const j=L.bakedVertexAnimationManager;j&&j.isEnabled&&(S.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),-1===h.indexOf("bakedVertexAnimationSettings")&&h.push("bakedVertexAnimationSettings"),-1===h.indexOf("bakedVertexAnimationTextureSizeInverted")&&h.push("bakedVertexAnimationTextureSizeInverted"),-1===h.indexOf("bakedVertexAnimationTime")&&h.push("bakedVertexAnimationTime"),-1===this._options.samplers.indexOf("bakedVertexAnimationTexture")&&this._options.samplers.push("bakedVertexAnimationTexture")),(0,C.y)(g,L,S)}for(const R in this._textures)if(!this._textures[R].isReady())return!1;L&&this.needAlphaTestingForMesh(L)&&S.push("#define ALPHATEST"),!1!==this._options.useClipPlane&&((0,N.e)(h),(0,N.j)(this,u,S)),u.fogEnabled&&null!==L&&void 0!==L&&L.applyFog&&u.fogMode!==R.e.FOGMODE_NONE&&(S.push("#define FOG"),-1===h.indexOf("view")&&h.push("view"),-1===h.indexOf("vFogInfos")&&h.push("vFogInfos"),-1===h.indexOf("vFogColor")&&h.push("vFogColor")),this._useLogarithmicDepth&&(S.push("#define LOGARITHMICDEPTH"),-1===h.indexOf("logarithmicDepthConstant")&&h.push("logarithmicDepthConstant")),this.customShaderNameResolve&&(h=h.slice(),K=K.slice(),v=v.slice(),f=this.customShaderNameResolve(this.name,h,K,v,S,g));const T=o?P._getDrawWrapper(void 0,!0):this._drawWrapper,G=(null===T||void 0===T?void 0:T.effect)??null,M=(null===T||void 0===T?void 0:T.defines)??null,Q=S.join("\n");let l=G;return M!==Q&&(l=a.createEffect(f,{attributes:g,uniformsNames:h,uniformBuffersNames:K,samplers:v,defines:Q,fallbacks:V,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousMorphTargets:q},shaderLanguage:this._options.shaderLanguage,extraInitializationsAsync:this._options.extraInitializationsAsync},a),o?P.setEffect(l,Q,this._materialContext):T&&T.setEffect(l,Q),this._onEffectCreatedObservable&&(b.effect=l,b.subMesh=P??(null===L||void 0===L?void 0:L.Bi[0])??null,this._onEffectCreatedObservable.notifyObservers(b))),T._wasPreviouslyUsingInstances=!!j,!(null===(A=l)||void 0===A||!A.isReady())&&(G!==l&&u.resetCachedMaterial(),T._wasPreviouslyReady=!0,!0)}bindOnlyWorldMatrix(L,j){const P=j??this.getEffect();if(!P)return;const A=this._options.uniforms;-1!==A.indexOf("world")&&P.setMatrix("world",L);const R=this.va();-1!==A.indexOf("worldView")&&(L.multiplyToRef(R.getViewMatrix(),this._cachedWorldViewMatrix),P.setMatrix("worldView",this._cachedWorldViewMatrix)),-1!==A.indexOf("worldViewProjection")&&(L.multiplyToRef(R.getTransformMatrix(),this._cachedWorldViewProjectionMatrix),P.setMatrix("worldViewProjection",this._cachedWorldViewProjectionMatrix)),-1!==A.indexOf("view")&&P.setMatrix("view",R.getViewMatrix())}bindForSubMesh(L,j,P){var A;this.bind(L,j,null===(A=P._drawWrapperOverride)||void 0===A?void 0:A.effect,P)}bind(L,j,P,A){const R=A&&this._storeEffectOnSubMeshes,o=P??(R?A.effect:this.getEffect());if(!o)return;const Y=this.va();this._activeEffect=o,this.bindOnlyWorldMatrix(L,P);const u=this._options.uniformBuffers;let a=!1;if(o&&u&&u.length>0&&Y.getEngine().supportsUniformBuffers)for(let g=0;g<u.length;++g){switch(u[g]){case"Mesh":j&&(j.getMeshUniformBuffer().bindToEffect(o,"Mesh"),j.transferToEffect(L));break;case"Scene":(0,C.q)(o,Y.getSceneUniformBuffer()),Y.finalizeSceneUbo(),a=!0}}const D=j&&R?this._mustRebind(Y,o,A,j.visibility):Y.getCachedMaterial()!==this;if(o&&D){let L;for(L in a||-1===this._options.uniforms.indexOf("view")||o.setMatrix("view",Y.getViewMatrix()),a||-1===this._options.uniforms.indexOf("projection")||o.setMatrix("projection",Y.getProjectionMatrix()),a||-1===this._options.uniforms.indexOf("viewProjection")||(o.setMatrix("viewProjection",Y.getTransformMatrix()),this._multiview&&o.setMatrix("viewProjectionR",Y._transformMatrixR)),Y.activeCamera&&-1!==this._options.uniforms.indexOf("cameraPosition")&&o.setVector3("cameraPosition",Y.activeCamera.globalPosition),(0,C.e)(j,o),(0,N.g)(o,this,Y),this._useLogarithmicDepth&&(0,C.n)(R?A.materialDefines:o.defines,o,Y),j&&(0,C.i)(Y,j,o),this._textures)o.setTexture(L,this._textures[L]);for(L in this._textureArrays)o.setTextureArray(L,this._textureArrays[L]);for(L in this._ints)o.setInt(L,this._ints[L]);for(L in this._uints)o.setUInt(L,this._uints[L]);for(L in this._floats)o.setFloat(L,this._floats[L]);for(L in this._floatsArrays)o.setArray(L,this._floatsArrays[L]);for(L in this._colors3)o.setColor3(L,this._colors3[L]);for(L in this._colors3Arrays)o.setArray3(L,this._colors3Arrays[L]);for(L in this._colors4){const j=this._colors4[L];o.setFloat4(L,j.r,j.g,j.b,j.a)}for(L in this._colors4Arrays)o.setArray4(L,this._colors4Arrays[L]);for(L in this._vectors2)o.setVector2(L,this._vectors2[L]);for(L in this._vectors3)o.setVector3(L,this._vectors3[L]);for(L in this._vectors4)o.setVector4(L,this._vectors4[L]);for(L in this._quaternions)o.setQuaternion(L,this._quaternions[L]);for(L in this._matrices)o.setMatrix(L,this._matrices[L]);for(L in this._matrixArrays)o.setMatrices(L,this._matrixArrays[L]);for(L in this._matrices3x3)o.setMatrix3x3(L,this._matrices3x3[L]);for(L in this._matrices2x2)o.setMatrix2x2(L,this._matrices2x2[L]);for(L in this._vectors2Arrays)o.setArray2(L,this._vectors2Arrays[L]);for(L in this._vectors3Arrays)o.setArray3(L,this._vectors3Arrays[L]);for(L in this._vectors4Arrays)o.setArray4(L,this._vectors4Arrays[L]);for(L in this._quaternionsArrays)o.setArray4(L,this._quaternionsArrays[L]);for(L in this._uniformBuffers){const j=this._uniformBuffers[L].getBuffer();j&&o.bindUniformBuffer(j,L)}const P=Y.getEngine(),u=P.setExternalTexture;if(u)for(L in this._externalTextures)u.call(P,L,this._externalTextures[L]);const D=P.setTextureSampler;if(D)for(L in this._textureSamplers)D.call(P,L,this._textureSamplers[L]);const S=P.setStorageBuffer;if(S)for(L in this._storageBuffers)S.call(P,L,this._storageBuffers[L])}if(o&&j&&(D||!this.isFrozen)){(0,C.p)(j,o),j.morphTargetManager&&j.morphTargetManager.isUsingTextureForTargets&&j.morphTargetManager._bind(o);const L=j.bakedVertexAnimationManager;if(L&&L.isEnabled){var S;const L=R?A._drawWrapper:this._drawWrapper;null===(S=j.bakedVertexAnimationManager)||void 0===S||S.bind(o,!!L._wasPreviouslyUsingInstances)}}this._afterBind(j,o,A)}getActiveTextures(){const L=super.getActiveTextures();for(const j in this._textures)L.push(this._textures[j]);for(const j in this._textureArrays){const P=this._textureArrays[j];for(let j=0;j<P.length;j++)L.push(P[j])}return L}hasTexture(L){if(super.hasTexture(L))return!0;for(const j in this._textures)if(this._textures[j]===L)return!0;for(const j in this._textureArrays){const P=this._textureArrays[j];for(let j=0;j<P.length;j++)if(P[j]===L)return!0}return!1}clone(L){const j=A.e.Clone((()=>new f(L,this.va(),this._shaderPath,this._options,this._storeEffectOnSubMeshes)),this);j.name=L,j.id=L,"object"===typeof j._shaderPath&&(j._shaderPath={...j._shaderPath}),this._options={...this._options};const P=Object.keys(this._options);for(const A of P){const L=this._options[A];Array.isArray(L)&&(this._options[A]=L.slice(0))}this.stencil.copyTo(j.stencil);for(const A in this._textures)j.setTexture(A,this._textures[A]);for(const A in this._textureArrays)j.setTextureArray(A,this._textureArrays[A]);for(const A in this._externalTextures)j.setExternalTexture(A,this._externalTextures[A]);for(const A in this._ints)j.setInt(A,this._ints[A]);for(const A in this._uints)j.setUInt(A,this._uints[A]);for(const A in this._floats)j.setFloat(A,this._floats[A]);for(const A in this._floatsArrays)j.setFloats(A,this._floatsArrays[A]);for(const A in this._colors3)j.setColor3(A,this._colors3[A]);for(const A in this._colors3Arrays)j._colors3Arrays[A]=this._colors3Arrays[A];for(const A in this._colors4)j.setColor4(A,this._colors4[A]);for(const A in this._colors4Arrays)j._colors4Arrays[A]=this._colors4Arrays[A];for(const A in this._vectors2)j.setVector2(A,this._vectors2[A]);for(const A in this._vectors3)j.setVector3(A,this._vectors3[A]);for(const A in this._vectors4)j.setVector4(A,this._vectors4[A]);for(const A in this._quaternions)j.setQuaternion(A,this._quaternions[A]);for(const A in this._quaternionsArrays)j._quaternionsArrays[A]=this._quaternionsArrays[A];for(const A in this._matrices)j.setMatrix(A,this._matrices[A]);for(const A in this._matrixArrays)j._matrixArrays[A]=this._matrixArrays[A].slice();for(const A in this._matrices3x3)j.setMatrix3x3(A,this._matrices3x3[A]);for(const A in this._matrices2x2)j.setMatrix2x2(A,this._matrices2x2[A]);for(const A in this._vectors2Arrays)j.setArray2(A,this._vectors2Arrays[A]);for(const A in this._vectors3Arrays)j.setArray3(A,this._vectors3Arrays[A]);for(const A in this._vectors4Arrays)j.setArray4(A,this._vectors4Arrays[A]);for(const A in this._uniformBuffers)j.setUniformBuffer(A,this._uniformBuffers[A]);for(const A in this._textureSamplers)j.setTextureSampler(A,this._textureSamplers[A]);for(const A in this._storageBuffers)j.setStorageBuffer(A,this._storageBuffers[A]);return j}dispose(L,j,P){if(j){let L;for(L in this._textures)this._textures[L].dispose();for(L in this._textureArrays){const j=this._textureArrays[L];for(let L=0;L<j.length;L++)j[L].dispose()}}this._textures={},super.dispose(L,j,P)}serialize(){const L=A.e.Serialize(this);let j;for(j in L.customType="BABYLON.ShaderMaterial",L.uniqueId=this.uniqueId,L.options=this._options,L.shaderPath=this._shaderPath,L.storeEffectOnSubMeshes=this._storeEffectOnSubMeshes,L.stencil=this.stencil.serialize(),L.textures={},this._textures)L.textures[j]=this._textures[j].serialize();for(j in L.textureArrays={},this._textureArrays){L.textureArrays[j]=[];const P=this._textureArrays[j];for(let A=0;A<P.length;A++)L.textureArrays[j].push(P[A].serialize())}for(j in L.ints={},this._ints)L.ints[j]=this._ints[j];for(j in L.uints={},this._uints)L.uints[j]=this._uints[j];for(j in L.floats={},this._floats)L.floats[j]=this._floats[j];for(j in L.floatsArrays={},this._floatsArrays)L.floatsArrays[j]=this._floatsArrays[j];for(j in L.colors3={},this._colors3){const P=this._colors3[j];L.colors3[j]=[P.r,P.g,P.b]}for(j in L.colors3Arrays={},this._colors3Arrays)L.colors3Arrays[j]=this._colors3Arrays[j];for(j in L.colors4={},this._colors4){const P=this._colors4[j];L.colors4[j]=[P.r,P.g,P.b,P.a]}for(j in L.colors4Arrays={},this._colors4Arrays)L.colors4Arrays[j]=this._colors4Arrays[j];for(j in L.vectors2={},this._vectors2){const P=this._vectors2[j];L.vectors2[j]=[P.x,P.y]}for(j in L.vectors3={},this._vectors3){const P=this._vectors3[j];L.vectors3[j]=[P.x,P.y,P.z]}for(j in L.vectors4={},this._vectors4){const P=this._vectors4[j];L.vectors4[j]=[P.x,P.y,P.z,P.w]}for(j in L.quaternions={},this._quaternions)L.quaternions[j]=this._quaternions[j].Ei();for(j in L.matrices={},this._matrices)L.matrices[j]=this._matrices[j].Ei();for(j in L.matrixArray={},this._matrixArrays)L.matrixArray[j]=this._matrixArrays[j];for(j in L.matrices3x3={},this._matrices3x3)L.matrices3x3[j]=this._matrices3x3[j];for(j in L.matrices2x2={},this._matrices2x2)L.matrices2x2[j]=this._matrices2x2[j];for(j in L.vectors2Arrays={},this._vectors2Arrays)L.vectors2Arrays[j]=this._vectors2Arrays[j];for(j in L.vectors3Arrays={},this._vectors3Arrays)L.vectors3Arrays[j]=this._vectors3Arrays[j];for(j in L.vectors4Arrays={},this._vectors4Arrays)L.vectors4Arrays[j]=this._vectors4Arrays[j];for(j in L.quaternionsArrays={},this._quaternionsArrays)L.quaternionsArrays[j]=this._quaternionsArrays[j];return L}static Parse(L,j,P){const R=A.e.Parse((()=>new f(L.name,j,L.shaderPath,L.options,L.storeEffectOnSubMeshes)),L,j,P);let Y;for(Y in L.stencil&&R.stencil.parse(L.stencil,j,P),L.textures)R.setTexture(Y,u.e.Parse(L.textures[Y],j,P));for(Y in L.textureArrays){const A=L.textureArrays[Y],o=[];for(let L=0;L<A.length;L++)o.push(u.e.Parse(A[L],j,P));R.setTextureArray(Y,o)}for(Y in L.ints)R.setInt(Y,L.ints[Y]);for(Y in L.uints)R.setUInt(Y,L.uints[Y]);for(Y in L.floats)R.setFloat(Y,L.floats[Y]);for(Y in L.floatsArrays)R.setFloats(Y,L.floatsArrays[Y]);for(Y in L.colors3){const j=L.colors3[Y];R.setColor3(Y,{r:j[0],g:j[1],b:j[2]})}for(Y in L.colors3Arrays){const j=L.colors3Arrays[Y].reduce(((L,j,P)=>(P%3===0?L.push([j]):L[L.length-1].push(j),L)),[]).map((L=>({r:L[0],g:L[1],b:L[2]})));R.setColor3Array(Y,j)}for(Y in L.colors4){const j=L.colors4[Y];R.setColor4(Y,{r:j[0],g:j[1],b:j[2],a:j[3]})}for(Y in L.colors4Arrays){const j=L.colors4Arrays[Y].reduce(((L,j,P)=>(P%4===0?L.push([j]):L[L.length-1].push(j),L)),[]).map((L=>({r:L[0],g:L[1],b:L[2],a:L[3]})));R.setColor4Array(Y,j)}for(Y in L.vectors2){const j=L.vectors2[Y];R.setVector2(Y,{x:j[0],y:j[1]})}for(Y in L.vectors3){const j=L.vectors3[Y];R.setVector3(Y,{x:j[0],y:j[1],z:j[2]})}for(Y in L.vectors4){const j=L.vectors4[Y];R.setVector4(Y,{x:j[0],y:j[1],z:j[2],w:j[3]})}for(Y in L.quaternions)R.setQuaternion(Y,o.i.ri(L.quaternions[Y]));for(Y in L.matrices)R.setMatrix(Y,o.e.ri(L.matrices[Y]));for(Y in L.matrixArray)R._matrixArrays[Y]=new Float32Array(L.matrixArray[Y]);for(Y in L.matrices3x3)R.setMatrix3x3(Y,L.matrices3x3[Y]);for(Y in L.matrices2x2)R.setMatrix2x2(Y,L.matrices2x2[Y]);for(Y in L.vectors2Arrays)R.setArray2(Y,L.vectors2Arrays[Y]);for(Y in L.vectors3Arrays)R.setArray3(Y,L.vectors3Arrays[Y]);for(Y in L.vectors4Arrays)R.setArray4(Y,L.vectors4Arrays[Y]);for(Y in L.quaternionsArrays)R.setArray4(Y,L.quaternionsArrays[Y]);return R}static async ParseFromFileAsync(L,j,P){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return await new Promise(((R,o)=>{const Y=new S.e;Y.addEventListener("readystatechange",(()=>{if(4==Y.readyState)if(200==Y.status){const j=JSON.parse(Y.responseText),o=this.Parse(j,P||V.b.LastCreatedScene,A);L&&(o.name=L),R(o)}else o("Unable to load the ShaderMaterial")})),Y.open("GET",j),Y.send()}))}static async ParseFromSnippetAsync(L,j){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return await new Promise(((A,R)=>{const o=new S.e;o.addEventListener("readystatechange",(()=>{if(4==o.readyState)if(200==o.status){const R=JSON.parse(JSON.parse(o.responseText).jsonPayload),Y=JSON.parse(R.shaderMaterial),u=this.Parse(Y,j||V.b.LastCreatedScene,P);u.snippetId=L,A(u)}else R("Unable to load the snippet "+L)})),o.open("GET",this.SnippetUrl+"/"+L.replace(/#/g,"/")),o.send()}))}}f.SnippetUrl="https://snippet.babylonjs.com",f.CreateFromSnippetAsync=f.ParseFromSnippetAsync,(0,a.h)("BABYLON.ShaderMaterial",f)},11666:(L,j,P)=>{P.d(j,{e:()=>Q});var A=P(636),R=P(639),o=P(650),Y=P(2149),u=P(685),a=P(708),D=P(11626),S=P(2157),g=P(801),V=P(11612),N=P(11634),C=P(2032),b=P(606),f=P(11639),h=P(11644),K=P(11653),v=P(818),q=P(805),y=P(680),T=P(11658);const G={effect:null,subMesh:null};class M extends V.d{constructor(L){super(L),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_POSITION=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.MORPHTARGETS_UV2=!1,this.MORPHTARGETS_COLOR=!1,this.MORPHTARGETTEXTURE_HASPOSITIONS=!1,this.MORPHTARGETTEXTURE_HASNORMALS=!1,this.MORPHTARGETTEXTURE_HASTANGENTS=!1,this.MORPHTARGETTEXTURE_HASUVS=!1,this.MORPHTARGETTEXTURE_HASUV2S=!1,this.MORPHTARGETTEXTURE_HASCOLORS=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_COLOR=!1,this.PREPASS_COLOR_INDEX=-1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO=!1,this.PREPASS_ALBEDO_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_SCREENSPACE_DEPTH=!1,this.PREPASS_SCREENSPACE_DEPTH_INDEX=-1,this.PREPASS_NORMALIZED_VIEW_DEPTH=!1,this.PREPASS_NORMALIZED_VIEW_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.AREALIGHTSUPPORTED=!0,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.DECAL_AFTER_DETAIL=!1,this.rebuild()}setReflectionMode(L){const j=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const P of j)this[P]=P===L}}class Q extends N.e{get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(L){this._attachImageProcessingConfiguration(L),this._markAllSubMeshesAsImageProcessingDirty()}_attachImageProcessingConfiguration(L){L!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=L||this.va().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(L){this.imageProcessingConfiguration.colorCurvesEnabled=L}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(L){this.imageProcessingConfiguration.colorGradingEnabled=L}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(L){this._imageProcessingConfiguration.toneMappingEnabled=L}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(L){this._imageProcessingConfiguration.exposure=L}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(L){this._imageProcessingConfiguration.contrast=L}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(L){this._imageProcessingConfiguration.colorGradingTexture=L}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(L){this._imageProcessingConfiguration.colorCurves=L}get canRenderToMRT(){return!0}constructor(L,j){super(L,j,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]||Q.ForceGLSL),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new u.e(0,0,0),this.diffuseColor=new u.e(1,1,1),this.specularColor=new u.e(1,1,1),this.emissiveColor=new u.e(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._applyDecalMapAfterDetailMap=!1,this._shadersLoaded=!1,this._renderTargets=new o.e(16),this._globalAmbientColor=new u.e(0,0,0),this._cacheHasRenderTargetTextures=!1,this.detailMap=new K.e(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new D.b,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),Q.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),Q.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get hasRenderTargetTextures(){return!!(Q.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||(!!(Q.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures)}getClassName(){return"eb"}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled)}needAlphaTesting(){return this._hasTransparencyMode?this._transparencyModeIsTest:this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===g.c.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return null!=this._diffuseTexture&&this._diffuseTexture.Jj&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==g.c.MATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._diffuseTexture&&this._diffuseTexture.Jj||null!=this._opacityTexture}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(L,j){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._uniformBufferLayoutBuilt||this.buildUniformLayout();const R=j._drawWrapper;if(R.effect&&this.isFrozen&&R._wasPreviouslyReady&&R._wasPreviouslyUsingInstances===A)return!0;j.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),j.materialDefines=new M(this._eventInfo.defineNames));const o=this.va(),Y=j.materialDefines;if(this._isReadyForSubMesh(j))return!0;const u=o.getEngine();Y._needNormals=(0,q.M)(o,L,Y,!0,this._maxSimultaneousLights,this._disableLighting),(0,q.U)(o,Y);const g=this.needAlphaBlendingForMesh(L)&&this.va().useOrderIndependentTransparency;if((0,q.Y)(o,Y,this.canRenderToMRT&&!g),(0,q.X)(o,Y,g),T.c.PrepareDefines(u.currentRenderPassId,L,Y),Y._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,Y._needUVs=!1;for(let L=1;L<=6;++L)Y["MAINUV"+L]=!1;if(o.texturesEnabled){if(Y.DIFFUSEDIRECTUV=0,Y.BUMPDIRECTUV=0,Y.AMBIENTDIRECTUV=0,Y.OPACITYDIRECTUV=0,Y.EMISSIVEDIRECTUV=0,Y.SPECULARDIRECTUV=0,Y.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&Q.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._diffuseTexture,Y,"DIFFUSE")}else Y.DIFFUSE=!1;if(this._ambientTexture&&Q.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._ambientTexture,Y,"AMBIENT")}else Y.AMBIENT=!1;if(this._opacityTexture&&Q.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._opacityTexture,Y,"OPACITY"),Y.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else Y.OPACITY=!1;if(this._reflectionTexture&&Q.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(Y._needNormals=!0,Y.REFLECTION=!0,Y.ROUGHNESS=this._roughness>0,Y.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,Y.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===C.e.INVCUBIC_MODE,Y.REFLECTIONMAP_3D=this._reflectionTexture.isCube,Y.REFLECTIONMAP_OPPOSITEZ=Y.REFLECTIONMAP_3D&&this.va().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,Y.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case C.e.EXPLICIT_MODE:Y.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case C.e.PLANAR_MODE:Y.setReflectionMode("REFLECTIONMAP_PLANAR");break;case C.e.PROJECTION_MODE:Y.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case C.e.SKYBOX_MODE:Y.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case C.e.SPHERICAL_MODE:Y.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case C.e.EQUIRECTANGULAR_MODE:Y.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case C.e.FIXED_EQUIRECTANGULAR_MODE:Y.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case C.e.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:Y.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case C.e.CUBIC_MODE:case C.e.INVCUBIC_MODE:default:Y.setReflectionMode("REFLECTIONMAP_CUBIC")}Y.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else Y.REFLECTION=!1,Y.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&Q.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._emissiveTexture,Y,"EMISSIVE")}else Y.EMISSIVE=!1;if(this._lightmapTexture&&Q.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._lightmapTexture,Y,"LIGHTMAP"),Y.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,Y.RGBDLIGHTMAP=this._lightmapTexture.isRGBD}else Y.LIGHTMAP=!1;if(this._specularTexture&&Q.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;(0,q.Q)(this._specularTexture,Y,"SPECULAR"),Y.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else Y.SPECULAR=!1;if(o.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&Q.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;(0,q.Q)(this._bumpTexture,Y,"BUMP"),Y.PARALLAX=this._useParallax,Y.PARALLAX_RHS=o.useRightHandedSystem,Y.PARALLAXOCCLUSION=this._useParallaxOcclusion,Y.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else Y.BUMP=!1,Y.PARALLAX=!1,Y.PARALLAX_RHS=!1,Y.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&Q.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;Y._needUVs=!0,Y.REFRACTION=!0,Y.REFRACTIONMAP_3D=this._refractionTexture.isCube,Y.RGBDREFRACTION=this._refractionTexture.isRGBD,Y.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize}else Y.REFRACTION=!1;Y.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else Y.DIFFUSE=!1,Y.AMBIENT=!1,Y.OPACITY=!1,Y.REFLECTION=!1,Y.EMISSIVE=!1,Y.LIGHTMAP=!1,Y.BUMP=!1,Y.REFRACTION=!1;Y.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),Y.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,Y.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,Y.SPECULAROVERALPHA=this._useSpecularOverAlpha,Y.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,Y.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode,Y.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(L)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=Y,this._eventInfo.subMesh=j,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(Y._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(Y),Y.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,Y.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}if(Y._areFresnelDirty&&(Q.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(Y.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,Y.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,Y.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,Y.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,Y.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,Y.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,Y._needNormals=!0,Y.FRESNEL=!0):Y.FRESNEL=!1),Y.AREALIGHTUSED)for(let P=0;P<L.lightSources.length;P++)if(!L.lightSources[P]._isReady())return!1;(0,q.T)(L,o,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this.needAlphaTestingForMesh(L),Y,this._applyDecalMapAfterDetailMap),(0,q.L)(o,u,this,Y,A,null,j.getRenderingMesh().hasThinInstances),this._eventInfo.defines=Y,this._eventInfo.mesh=L,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),(0,q.K)(L,Y,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let V=!1;if(Y.isDirty){const A=Y._areLightsDisposed;Y.markAsProcessed();const R=new h.d;Y.REFLECTION&&R.addFallback(0,"REFLECTION"),Y.SPECULAR&&R.addFallback(0,"SPECULAR"),Y.BUMP&&R.addFallback(0,"BUMP"),Y.PARALLAX&&R.addFallback(1,"PARALLAX"),Y.PARALLAX_RHS&&R.addFallback(1,"PARALLAX_RHS"),Y.PARALLAXOCCLUSION&&R.addFallback(0,"PARALLAXOCCLUSION"),Y.SPECULAROVERALPHA&&R.addFallback(0,"SPECULAROVERALPHA"),Y.FOG&&R.addFallback(1,"FOG"),Y.POINTSIZE&&R.addFallback(0,"POINTSIZE"),Y.LOGARITHMICDEPTH&&R.addFallback(0,"LOGARITHMICDEPTH"),(0,q.u)(Y,R,this._maxSimultaneousLights),Y.SPECULARTERM&&R.addFallback(0,"SPECULARTERM"),Y.DIFFUSEFRESNEL&&R.addFallback(1,"DIFFUSEFRESNEL"),Y.OPACITYFRESNEL&&R.addFallback(2,"OPACITYFRESNEL"),Y.REFLECTIONFRESNEL&&R.addFallback(3,"REFLECTIONFRESNEL"),Y.EMISSIVEFRESNEL&&R.addFallback(4,"EMISSIVEFRESNEL"),Y.FRESNEL&&R.addFallback(4,"FRESNEL"),Y.MULTIVIEW&&R.addFallback(0,"MULTIVIEW");const g=[a.e.PositionKind];Y.NORMAL&&g.push(a.e.NormalKind),Y.TANGENT&&g.push(a.e.TangentKind);for(let L=1;L<=6;++L)Y["UV"+L]&&g.push(`uv${1===L?"":L}`);Y.VERTEXCOLOR&&g.push(a.e.ColorKind),(0,q.z)(g,L,Y,R),(0,q.D)(g,Y),(0,q.E)(g,L,Y),(0,q.y)(g,L,Y);let N="default";const C=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices","cameraInfo"],b=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler","areaLightsLTC1Sampler","areaLightsLTC2Sampler"],f=["Material","Scene","Mesh"],K={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:Y.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=R,this._eventInfo.fallbackRank=0,this._eventInfo.defines=Y,this._eventInfo.uniforms=C,this._eventInfo.attributes=g,this._eventInfo.samplers=b,this._eventInfo.uniformBuffersNames=f,this._eventInfo.customCode=void 0,this._eventInfo.mesh=L,this._eventInfo.indexParameters=K,this._callbackPluginEventGeneric(128,this._eventInfo),T.c.AddUniformsAndSamplers(C,b),D.b.AddUniforms(C),D.b.AddSamplers(b),S.c&&(S.c.PrepareUniforms(C,Y),S.c.PrepareSamplers(b,Y)),(0,q.Z)({uniformsNames:C,uniformBuffersNames:f,samplers:b,defines:Y,maxSimultaneousLights:this._maxSimultaneousLights}),(0,v.e)(C);const y={};this.customShaderNameResolve&&(N=this.customShaderNameResolve(N,C,f,b,Y,g,y));const M=Y.toString(),Q=j.effect;let l=o.getEngine().createEffect(N,{attributes:g,uniformsNames:C,uniformBuffersNames:f,samplers:b,defines:M,fallbacks:R,onCompiled:this.onCompiled,onError:this.onError,indexParameters:K,processFinalCode:y.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:Y.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this._shaderLanguage?await Promise.all([Promise.all([P.e(35),P.e(55)]).then(P.bind(P,13623)),Promise.all([P.e(33),P.e(56)]).then(P.bind(P,13639))]):await Promise.all([Promise.all([P.e(28),P.e(57)]).then(P.bind(P,13647)),Promise.all([P.e(27),P.e(58)]).then(P.bind(P,13653))]),this._shadersLoaded=!0}},u);if(this._eventInfo.customCode=void 0,l)if(this._onEffectCreatedObservable&&(G.effect=l,G.subMesh=j,this._onEffectCreatedObservable.notifyObservers(G)),this.allowShaderHotSwapping&&Q&&!l.isReady()){if(l=Q,Y.markAsUnprocessed(),V=this.isFrozen,A)return Y._areLightsDisposed=!0,!1}else o.resetCachedMaterial(),j.setEffect(l,Y,this._materialContext)}return!(!j.effect||!j.effect.isReady())&&(Y._renderId=o.getRenderId(),R._wasPreviouslyReady=!V,R._wasPreviouslyUsingInstances=A,this._checkScenePerformancePriority(),!0)}buildUniformLayout(){const L=this._uniformBuffer;L.addUniform("diffuseLeftColor",4),L.addUniform("diffuseRightColor",4),L.addUniform("opacityParts",4),L.addUniform("reflectionLeftColor",4),L.addUniform("reflectionRightColor",4),L.addUniform("refractionLeftColor",4),L.addUniform("refractionRightColor",4),L.addUniform("emissiveLeftColor",4),L.addUniform("emissiveRightColor",4),L.addUniform("vDiffuseInfos",2),L.addUniform("vAmbientInfos",2),L.addUniform("vOpacityInfos",2),L.addUniform("vReflectionInfos",2),L.addUniform("vReflectionPosition",3),L.addUniform("vReflectionSize",3),L.addUniform("vEmissiveInfos",2),L.addUniform("vLightmapInfos",2),L.addUniform("vSpecularInfos",2),L.addUniform("vBumpInfos",3),L.addUniform("diffuseMatrix",16),L.addUniform("ambientMatrix",16),L.addUniform("opacityMatrix",16),L.addUniform("reflectionMatrix",16),L.addUniform("emissiveMatrix",16),L.addUniform("lightmapMatrix",16),L.addUniform("specularMatrix",16),L.addUniform("bumpMatrix",16),L.addUniform("vTangentSpaceParams",2),L.addUniform("pointSize",1),L.addUniform("alphaCutOff",1),L.addUniform("refractionMatrix",16),L.addUniform("vRefractionInfos",4),L.addUniform("vRefractionPosition",3),L.addUniform("vRefractionSize",3),L.addUniform("vSpecularColor",4),L.addUniform("vEmissiveColor",3),L.addUniform("vDiffuseColor",4),L.addUniform("vAmbientColor",3),L.addUniform("cameraInfo",4),super.buildUniformLayout()}bindForSubMesh(L,j,P){const A=this.va(),R=P.materialDefines;if(!R)return;const o=P.effect;if(!o)return;this._activeEffect=o,j.getMeshUniformBuffer().bindToEffect(o,"Mesh"),j.transferToEffect(L),this._uniformBuffer.bindToEffect(o,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,A,j,L,this.isFrozen),T.c.Bind(A.getEngine().currentRenderPassId,this._activeEffect,j,L,this);const a=A.activeCamera;a?this._uniformBuffer.updateFloat4("cameraInfo",a.Ai,a.maxZ,0,0):this._uniformBuffer.updateFloat4("cameraInfo",0,0,0,0),this._eventInfo.subMesh=P,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),R.OBJECTSPACE_NORMALMAP&&(L.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const D=this._mustRebind(A,o,P,j.visibility);(0,q.e)(j,o);const S=this._uniformBuffer;if(D){if(this.bindViewProjection(o),!S.useUbo||!this.isFrozen||!S.isSync||P._drawWrapper._forceRebindOnNextCall){if(Q.FresnelEnabled&&R.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(S.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),S.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&S.updateColor4("opacityParts",new u.e(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(S.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),S.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(S.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),S.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(S.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),S.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),A.texturesEnabled){if(this._diffuseTexture&&Q.DiffuseTextureEnabled&&(S.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),(0,q.t)(this._diffuseTexture,S,"diffuse")),this._ambientTexture&&Q.AmbientTextureEnabled&&(S.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),(0,q.t)(this._ambientTexture,S,"ambient")),this._opacityTexture&&Q.OpacityTextureEnabled&&(S.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),(0,q.t)(this._opacityTexture,S,"opacity")),this._hasAlphaChannel()&&S.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&Q.ReflectionTextureEnabled){if(S.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),S.cj("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize){const L=this._reflectionTexture;S.updateVector3("vReflectionPosition",L.boundingBoxPosition),S.updateVector3("vReflectionSize",L.boundingBoxSize)}}else S.updateFloat2("vReflectionInfos",0,this.roughness);if(this._emissiveTexture&&Q.EmissiveTextureEnabled&&(S.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),(0,q.t)(this._emissiveTexture,S,"emissive")),this._lightmapTexture&&Q.LightmapTextureEnabled&&(S.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),(0,q.t)(this._lightmapTexture,S,"lightmap")),this._specularTexture&&Q.SpecularTextureEnabled&&(S.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),(0,q.t)(this._specularTexture,S,"specular")),this._bumpTexture&&A.getEngine().getCaps().standardDerivatives&&Q.BumpTextureEnabled&&(S.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),(0,q.t)(this._bumpTexture,S,"bump"),A._mirroredCameraPosition?S.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):S.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&Q.RefractionTextureEnabled){let L=1;if(this._refractionTexture.isCube||(S.cj("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(L=this._refractionTexture.depth)),S.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,L,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const L=this._refractionTexture;S.updateVector3("vRefractionPosition",L.boundingBoxPosition),S.updateVector3("vRefractionSize",L.boundingBoxSize)}}}this.pointsCloud&&S.updateFloat("pointSize",this.pointSize),S.updateColor4("vSpecularColor",this.specularColor,this.specularPower),S.updateColor3("vEmissiveColor",Q.EmissiveTextureEnabled?this.emissiveColor:u.e.BlackReadOnly),S.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),A.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),S.updateColor3("vAmbientColor",this._globalAmbientColor)}A.texturesEnabled&&(this._diffuseTexture&&Q.DiffuseTextureEnabled&&o.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&Q.AmbientTextureEnabled&&o.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&Q.OpacityTextureEnabled&&o.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&Q.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?o.setTexture("reflectionCubeSampler",this._reflectionTexture):o.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&Q.EmissiveTextureEnabled&&o.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&Q.LightmapTextureEnabled&&o.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&Q.SpecularTextureEnabled&&o.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&A.getEngine().getCaps().standardDerivatives&&Q.BumpTextureEnabled&&o.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&Q.RefractionTextureEnabled&&(this._refractionTexture.isCube?o.setTexture("refractionCubeSampler",this._refractionTexture):o.setTexture("refraction2DSampler",this._refractionTexture))),this.va().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(j)&&this.va().depthPeelingRenderer.bind(o),this._eventInfo.subMesh=P,this._callbackPluginEventBindForSubMesh(this._eventInfo),(0,v.g)(o,this,A),this.bindEyePosition(o)}else A.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);if(D||!this.isFrozen){var g;if(A.lightsEnabled&&!this._disableLighting&&(0,q.j)(A,j,o,R,this._maxSimultaneousLights),(A.fogEnabled&&j.applyFog&&A.fogMode!==Y.e.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||j.receiveShadows||R.PREPASS)&&this.bindView(o),(0,q.i)(A,j,o),R.NUM_MORPH_INFLUENCERS&&(0,q.p)(j,o),R.BAKED_VERTEX_ANIMATION_TEXTURE)null===(g=j.bakedVertexAnimationManager)||void 0===g||g.bind(o,R.INSTANCES);this.useLogarithmicDepth&&(0,q.n)(R,o,A),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)}this._afterBind(j,this._activeEffect,P),S.update()}getAnimatables(){const L=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&L.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&L.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&L.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&L.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&L.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&L.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&L.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&L.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&L.push(this._refractionTexture),L}getActiveTextures(){const L=super.getActiveTextures();return this._diffuseTexture&&L.push(this._diffuseTexture),this._ambientTexture&&L.push(this._ambientTexture),this._opacityTexture&&L.push(this._opacityTexture),this._reflectionTexture&&L.push(this._reflectionTexture),this._emissiveTexture&&L.push(this._emissiveTexture),this._specularTexture&&L.push(this._specularTexture),this._bumpTexture&&L.push(this._bumpTexture),this._lightmapTexture&&L.push(this._lightmapTexture),this._refractionTexture&&L.push(this._refractionTexture),L}hasTexture(L){return!!super.hasTexture(L)||(this._diffuseTexture===L||(this._ambientTexture===L||(this._opacityTexture===L||(this._reflectionTexture===L||(this._emissiveTexture===L||(this._specularTexture===L||(this._bumpTexture===L||(this._lightmapTexture===L||this._refractionTexture===L))))))))}dispose(L,j){var P,A,R,o,Y,u,a,D,S;j&&(null===(P=this._diffuseTexture)||void 0===P||P.dispose(),null===(A=this._ambientTexture)||void 0===A||A.dispose(),null===(R=this._opacityTexture)||void 0===R||R.dispose(),null===(o=this._reflectionTexture)||void 0===o||o.dispose(),null===(Y=this._emissiveTexture)||void 0===Y||Y.dispose(),null===(u=this._specularTexture)||void 0===u||u.dispose(),null===(a=this._bumpTexture)||void 0===a||a.dispose(),null===(D=this._lightmapTexture)||void 0===D||D.dispose(),null===(S=this._refractionTexture)||void 0===S||S.dispose());this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(L,j)}clone(L){let j=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const A=y.e.Clone((()=>new Q(L,this.va())),this,{cloneTexturesOnlyOnce:j});return A.name=L,A.id=L,this.stencil.copyTo(A.stencil),this._clonePlugins(A,P),A}static Parse(L,j,P){const A=y.e.Parse((()=>new Q(L.name,j)),L,j,P);return L.stencil&&A.stencil.parse(L.stencil,j,P),g.c._ParsePlugins(L,A,j,P),A}static get DiffuseTextureEnabled(){return f.d.DiffuseTextureEnabled}static set DiffuseTextureEnabled(L){f.d.DiffuseTextureEnabled=L}static get DetailTextureEnabled(){return f.d.DetailTextureEnabled}static set DetailTextureEnabled(L){f.d.DetailTextureEnabled=L}static get AmbientTextureEnabled(){return f.d.AmbientTextureEnabled}static set AmbientTextureEnabled(L){f.d.AmbientTextureEnabled=L}static get OpacityTextureEnabled(){return f.d.OpacityTextureEnabled}static set OpacityTextureEnabled(L){f.d.OpacityTextureEnabled=L}static get ReflectionTextureEnabled(){return f.d.ReflectionTextureEnabled}static set ReflectionTextureEnabled(L){f.d.ReflectionTextureEnabled=L}static get EmissiveTextureEnabled(){return f.d.EmissiveTextureEnabled}static set EmissiveTextureEnabled(L){f.d.EmissiveTextureEnabled=L}static get SpecularTextureEnabled(){return f.d.SpecularTextureEnabled}static set SpecularTextureEnabled(L){f.d.SpecularTextureEnabled=L}static get BumpTextureEnabled(){return f.d.BumpTextureEnabled}static set BumpTextureEnabled(L){f.d.BumpTextureEnabled=L}static get LightmapTextureEnabled(){return f.d.LightmapTextureEnabled}static set LightmapTextureEnabled(L){f.d.LightmapTextureEnabled=L}static get RefractionTextureEnabled(){return f.d.RefractionTextureEnabled}static set RefractionTextureEnabled(L){f.d.RefractionTextureEnabled=L}static get ColorGradingTextureEnabled(){return f.d.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(L){f.d.ColorGradingTextureEnabled=L}static get FresnelEnabled(){return f.d.FresnelEnabled}static set FresnelEnabled(L){f.d.FresnelEnabled=L}}Q.ForceGLSL=!1,(0,A.b)([(0,R.E)("diffuseTexture")],Q.prototype,"_diffuseTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],Q.prototype,"diffuseTexture",void 0),(0,A.b)([(0,R.E)("ambientTexture")],Q.prototype,"_ambientTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"ambientTexture",void 0),(0,A.b)([(0,R.E)("opacityTexture")],Q.prototype,"_opacityTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],Q.prototype,"opacityTexture",void 0),(0,A.b)([(0,R.E)("reflectionTexture")],Q.prototype,"_reflectionTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"reflectionTexture",void 0),(0,A.b)([(0,R.E)("emissiveTexture")],Q.prototype,"_emissiveTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"emissiveTexture",void 0),(0,A.b)([(0,R.E)("specularTexture")],Q.prototype,"_specularTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"specularTexture",void 0),(0,A.b)([(0,R.E)("bumpTexture")],Q.prototype,"_bumpTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"bumpTexture",void 0),(0,A.b)([(0,R.E)("lightmapTexture")],Q.prototype,"_lightmapTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"lightmapTexture",void 0),(0,A.b)([(0,R.E)("refractionTexture")],Q.prototype,"_refractionTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"refractionTexture",void 0),(0,A.b)([(0,R.j)("ambient")],Q.prototype,"ambientColor",void 0),(0,A.b)([(0,R.j)("diffuse")],Q.prototype,"diffuseColor",void 0),(0,A.b)([(0,R.j)("specular")],Q.prototype,"specularColor",void 0),(0,A.b)([(0,R.j)("emissive")],Q.prototype,"emissiveColor",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"specularPower",void 0),(0,A.b)([(0,R.K)("useAlphaFromDiffuseTexture")],Q.prototype,"_useAlphaFromDiffuseTexture",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesAndMiscDirty")],Q.prototype,"useAlphaFromDiffuseTexture",void 0),(0,A.b)([(0,R.K)("useEmissiveAsIllumination")],Q.prototype,"_useEmissiveAsIllumination",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useEmissiveAsIllumination",void 0),(0,A.b)([(0,R.K)("linkEmissiveWithDiffuse")],Q.prototype,"_linkEmissiveWithDiffuse",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"linkEmissiveWithDiffuse",void 0),(0,A.b)([(0,R.K)("useSpecularOverAlpha")],Q.prototype,"_useSpecularOverAlpha",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useSpecularOverAlpha",void 0),(0,A.b)([(0,R.K)("useReflectionOverAlpha")],Q.prototype,"_useReflectionOverAlpha",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useReflectionOverAlpha",void 0),(0,A.b)([(0,R.K)("disableLighting")],Q.prototype,"_disableLighting",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsLightsDirty")],Q.prototype,"disableLighting",void 0),(0,A.b)([(0,R.K)("useObjectSpaceNormalMap")],Q.prototype,"_useObjectSpaceNormalMap",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useObjectSpaceNormalMap",void 0),(0,A.b)([(0,R.K)("useParallax")],Q.prototype,"_useParallax",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useParallax",void 0),(0,A.b)([(0,R.K)("useParallaxOcclusion")],Q.prototype,"_useParallaxOcclusion",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useParallaxOcclusion",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"parallaxScaleBias",void 0),(0,A.b)([(0,R.K)("roughness")],Q.prototype,"_roughness",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"roughness",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"indexOfRefraction",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"invertRefractionY",void 0),(0,A.b)([(0,R.K)()],Q.prototype,"alphaCutOff",void 0),(0,A.b)([(0,R.K)("useLightmapAsShadowmap")],Q.prototype,"_useLightmapAsShadowmap",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useLightmapAsShadowmap",void 0),(0,A.b)([(0,R.q)("diffuseFresnelParameters")],Q.prototype,"_diffuseFresnelParameters",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelDirty")],Q.prototype,"diffuseFresnelParameters",void 0),(0,A.b)([(0,R.q)("opacityFresnelParameters")],Q.prototype,"_opacityFresnelParameters",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelAndMiscDirty")],Q.prototype,"opacityFresnelParameters",void 0),(0,A.b)([(0,R.q)("reflectionFresnelParameters")],Q.prototype,"_reflectionFresnelParameters",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelDirty")],Q.prototype,"reflectionFresnelParameters",void 0),(0,A.b)([(0,R.q)("refractionFresnelParameters")],Q.prototype,"_refractionFresnelParameters",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelDirty")],Q.prototype,"refractionFresnelParameters",void 0),(0,A.b)([(0,R.q)("emissiveFresnelParameters")],Q.prototype,"_emissiveFresnelParameters",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelDirty")],Q.prototype,"emissiveFresnelParameters",void 0),(0,A.b)([(0,R.K)("useReflectionFresnelFromSpecular")],Q.prototype,"_useReflectionFresnelFromSpecular",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsFresnelDirty")],Q.prototype,"useReflectionFresnelFromSpecular",void 0),(0,A.b)([(0,R.K)("useGlossinessFromSpecularMapAlpha")],Q.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"useGlossinessFromSpecularMapAlpha",void 0),(0,A.b)([(0,R.K)("maxSimultaneousLights")],Q.prototype,"_maxSimultaneousLights",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsLightsDirty")],Q.prototype,"maxSimultaneousLights",void 0),(0,A.b)([(0,R.K)("invertNormalMapX")],Q.prototype,"_invertNormalMapX",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"invertNormalMapX",void 0),(0,A.b)([(0,R.K)("invertNormalMapY")],Q.prototype,"_invertNormalMapY",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"invertNormalMapY",void 0),(0,A.b)([(0,R.K)("twoSidedLighting")],Q.prototype,"_twoSidedLighting",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsTexturesDirty")],Q.prototype,"twoSidedLighting",void 0),(0,A.b)([(0,R.K)("applyDecalMapAfterDetailMap")],Q.prototype,"_applyDecalMapAfterDetailMap",void 0),(0,A.b)([(0,R.c)("_markAllSubMeshesAsMiscDirty")],Q.prototype,"applyDecalMapAfterDetailMap",void 0),(0,b.h)("BABYLON.StandardMaterial",Q),Y.e.DefaultMaterialFactory=L=>new Q("default material",L)},11703:(L,j,P)=>{P.d(j,{d:()=>h,h:()=>K});var A=P(656),R=P(685),o=P(460),Y=P(722),u=P(490),a=P(708),D=P(2005),S=P(661),g=P(519);class V extends A.n{constructor(L,j){super(L.x,L.y),this.index=j}}class N{constructor(){this.elements=[]}add(L){const j=[];for(const P of L){const L=new V(P,this.elements.length);j.push(L),this.elements.push(L)}return j}computeBounds(){const L=new A.n(this.elements[0].x,this.elements[0].y),j=new A.n(this.elements[0].x,this.elements[0].y);for(const P of this.elements)P.x<L.x?L.x=P.x:P.x>j.x&&(j.x=P.x),P.y<L.y?L.y=P.y:P.y>j.y&&(j.y=P.y);return{min:L,max:j,width:j.x-L.x,height:j.y-L.y}}}class C{_addToepoint(L){for(const j of L)this._epoints.push(j.x,j.y)}constructor(L,j,P){let A,R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut;this._points=new N,this._outlinepoints=new N,this._holes=new Array,this._epoints=new Array,this._eholes=new Array,this.bjsEarcut=R,this._name=L,this._scene=P||g.b.LastCreatedScene,A=j instanceof D.h?j.getPoints():j,this._addToepoint(A),this._points.add(A),this._outlinepoints.add(A),"undefined"===typeof this.bjsEarcut&&u.e.Warn("Earcut was not found, the polygon will not be built.")}addHole(L){this._points.add(L);const j=new N;return j.add(L),this._holes.push(j),this._eholes.push(this._epoints.length/2),this._addToepoint(L),this}build(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0],j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const A=new o.e(this._name,this._scene),R=this.buildVertexData(j,P);return A.Ga(a.e.PositionKind,R.xa,L),A.Ga(a.e.NormalKind,R.ya,L),A.Ga(a.e.UVKind,R.Aa,L),A.setIndices(R.indices),A}buildVertexData(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const P=new Y.d,A=[],R=[],o=[],u=this._points.computeBounds();for(const Y of this._points.elements)A.push(0,1,0),R.push(Y.x,0,Y.y),o.push((Y.x-u.min.x)/u.width,(Y.y-u.min.y)/u.height);const a=[],D=this.bjsEarcut(this._epoints,this._eholes,2);for(let Y=0;Y<D.length;Y++)a.push(D[Y]);if(L>0){const P=R.length/3;for(const j of this._points.elements)A.push(0,-1,0),R.push(j.x,-L,j.y),o.push(1-(j.x-u.min.x)/u.width,1-(j.y-u.min.y)/u.height);const Y=a.length;for(let L=0;L<Y;L+=3){const j=a[L+0],A=a[L+1],R=a[L+2];a.push(R+P),a.push(A+P),a.push(j+P)}this._addSide(R,A,o,a,u,this._outlinepoints,L,!1,j);for(const D of this._holes)this._addSide(R,A,o,a,u,D,L,!0,j)}return P.indices=a,P.xa=R,P.ya=A,P.Aa=o,P}_addSide(L,j,P,R,o,Y,u,a,D){let g=L.length/3,V=0;for(let N=0;N<Y.elements.length;N++){const C=Y.elements[N],b=Y.elements[(N+1)%Y.elements.length];L.push(C.x,0,C.y),L.push(C.x,-u,C.y),L.push(b.x,0,b.y),L.push(b.x,-u,b.y);const f=Y.elements[(N+Y.elements.length-1)%Y.elements.length],h=Y.elements[(N+2)%Y.elements.length];let K=new A.r(-(b.y-C.y),0,b.x-C.x),v=new A.r(-(C.y-f.y),0,C.x-f.x),q=new A.r(-(h.y-b.y),0,h.x-b.x);a||(K=K.scale(-1),v=v.scale(-1),q=q.scale(-1));const y=K.normalizeToNew();let T=v.normalizeToNew(),G=q.normalizeToNew();const M=A.r.Dot(T,y);T=M>D?M<S.c-1?new A.r(C.x,0,C.y).xg(new A.r(b.x,0,b.y)).normalize():v.add(K).normalize():y;const Q=A.r.Dot(q,K);G=Q>D?Q<S.c-1?new A.r(b.x,0,b.y).xg(new A.r(C.x,0,C.y)).normalize():q.add(K).normalize():y,P.push(V/o.width,0),P.push(V/o.width,1),V+=K.length(),P.push(V/o.width,0),P.push(V/o.width,1),j.push(T.x,T.y,T.z),j.push(T.x,T.y,T.z),j.push(G.x,G.y,G.z),j.push(G.x,G.y,G.z),a?(R.push(g),R.push(g+2),R.push(g+1),R.push(g+1),R.push(g+2),R.push(g+3)):(R.push(g),R.push(g+1),R.push(g+2),R.push(g+1),R.push(g+3),R.push(g+2)),g+=4}}}var b=P(771);function f(L,j,P,o,u,D,S){const g=P||new Array(3),V=o,N=[],C=S||!1;for(let Y=0;Y<3;Y++)void 0===g[Y]&&(g[Y]=new A.s(0,0,1,1)),V&&void 0===V[Y]&&(V[Y]=new R.i(1,1,1,1));const f=L.getVerticesData(a.e.PositionKind),h=L.getVerticesData(a.e.NormalKind),K=L.getVerticesData(a.e.UVKind),v=L.zi(),q=f.length/9;let y=0,T=0,G=0,M=0,Q=0;const l=[0];if(C)for(let A=q;A<f.length/3;A+=4)T=f[3*(A+2)]-f[3*A],G=f[3*(A+2)+2]-f[3*A+2],M=Math.sqrt(T*T+G*G),Q+=M,l.push(Q);let w=0,d=0;for(let A=0;A<h.length;A+=3)Math.abs(h[A+1])<.001&&(d=1),Math.abs(h[A+1]-1)<.001&&(d=0),Math.abs(h[A+1]+1)<.001&&(d=2),w=A/3,1===d?(y=w-q,K[2*w]=y%4<1.5?C?g[d].x+(g[d].z-g[d].x)*l[Math.floor(y/4)]/Q:g[d].x:C?g[d].x+(g[d].z-g[d].x)*l[Math.floor(y/4)+1]/Q:g[d].z,K[2*w+1]=y%2===0?b.c?1-g[d].w:g[d].w:b.c?1-g[d].y:g[d].y):(K[2*w]=(1-K[2*w])*g[d].x+K[2*w]*g[d].z,K[2*w+1]=(1-K[2*w+1])*g[d].y+K[2*w+1]*g[d].w,b.c&&(K[2*w+1]=1-K[2*w+1])),V&&N.push(V[d].r,V[d].g,V[d].b,V[d].a);Y.d._ComputeSides(j,f,v,h,K,u,D);const c=new Y.d;if(c.indices=v,c.xa=f,c.ya=h,c.Aa=K,V){const L=j===Y.d.DOUBLESIDE?N.concat(N):N;c.za=L}return c}function h(L,j){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut;j.sideOrientation=o.e._GetDefaultSideOrientation(j.sideOrientation);const Y=j.shape,u=j.holes||[],a=j.depth||0,D=j.smoothingThreshold||2,S=[];let V=[];for(let o=0;o<Y.length;o++)S[o]=new A.n(Y[o].x,Y[o].z);S[0].equalsWithEpsilon(S[S.length-1],1e-8)&&S.pop();const N=new C(L,S,P||g.b.LastCreatedScene,R);for(let o=0;o<u.length;o++){V=[];for(let L=0;L<u[o].length;L++)V.push(new A.n(u[o][L].x,u[o][L].z));N.addHole(V)}const b=N.build(!1,a,D);b._originalBuilderSideOrientation=j.sideOrientation;return f(b,j.sideOrientation,j.faceUV,j.faceColors,j.frontUVs,j.backUVs,j.wrap).Ca(b,j.updatable),b}function K(L,j){return h(L,j,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut)}Y.d.CreatePolygon=f,o.e.CreatePolygon=function(L,j,P,A,R,o){return h(L,{shape:j,holes:A,updatable:R,sideOrientation:o},P,arguments.length>6&&void 0!==arguments[6]?arguments[6]:earcut)},o.e.ExtrudePolygon=function(L,j,P,A,R,o,Y){return K(L,{shape:j,holes:R,depth:P,updatable:o,sideOrientation:Y},A,arguments.length>7&&void 0!==arguments[7]?arguments[7]:earcut)}},11694:(L,j,P)=>{P.d(j,{d:()=>S,g:()=>g});var A=P(2005),R=P(656),o=P(460),Y=P(780),u=P(11703);class a{constructor(L){this._paths=[],this._tempPaths=[],this._holes=[],this._resolution=L}moveTo(L,j){this._currentPath=new A.h(L,j),this._tempPaths.push(this._currentPath)}lineTo(L,j){this._currentPath.addLineTo(L,j)}quadraticCurveTo(L,j,P,A){this._currentPath.addQuadraticCurveTo(L,j,P,A,this._resolution)}bezierCurveTo(L,j,P,A,R,o){this._currentPath.addBezierCurveTo(L,j,P,A,R,o,this._resolution)}extractHoles(){for(const L of this._tempPaths)L.area()>0?this._holes.push(L):this._paths.push(L);if(!this._paths.length&&this._holes.length){const L=this._holes;this._holes=this._paths,this._paths=L}this._tempPaths.length=0}get paths(){return this._paths}get holes(){return this._holes}}function D(L,j,P,A,R,o){const Y=o.glyphs[L]||o.glyphs["?"];if(!Y)return null;const u=new a(R);if(Y.o){const L=Y.o.split(" ");for(let R=0,o=L.length;R<o;){switch(L[R++]){case"m":{const o=parseInt(L[R++])*j+P,Y=parseInt(L[R++])*j+A;u.moveTo(o,Y);break}case"l":{const o=parseInt(L[R++])*j+P,Y=parseInt(L[R++])*j+A;u.lineTo(o,Y);break}case"q":{const o=parseInt(L[R++])*j+P,Y=parseInt(L[R++])*j+A,a=parseInt(L[R++])*j+P,D=parseInt(L[R++])*j+A;u.quadraticCurveTo(a,D,o,Y);break}case"b":{const o=parseInt(L[R++])*j+P,Y=parseInt(L[R++])*j+A,a=parseInt(L[R++])*j+P,D=parseInt(L[R++])*j+A,S=parseInt(L[R++])*j+P,g=parseInt(L[R++])*j+A;u.bezierCurveTo(a,D,S,g,o,Y);break}}}}return u.extractHoles(),{offsetX:Y.ha*j,shapePath:u}}function S(L,j,P,A){const R=Array.from(L),o=j/A.resolution,Y=(A.boundingBox.yMax-A.boundingBox.yMin+A.underlineThickness)*o,u=[];let a=0,S=0;for(let g=0;g<R.length;g++){const L=R[g];if("\n"===L)a=0,S-=Y;else{const j=D(L,o,a,S,P,A);j&&(a+=j.offsetX,u.push(j.shapePath))}}return u}function g(L,j,P){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:50,resolution:8,depth:1},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:earcut;const g=S(j,A.size||50,A.resolution||8,P),V=[];let N=0;for(const Y of g){if(!Y.paths.length)continue;const j=Y.holes.slice();for(const P of Y.paths){var C,b;const Y=[],S=[],g=P.getPoints();for(const L of g)S.push(new R.r(L.x,0,L.y));const f=j.slice();for(const L of f){const A=L.getPoints();let o=!1;for(const L of A)if(P.isPointInside(L)){o=!0;break}if(!o)continue;const u=[];for(const L of A)u.push(new R.r(L.x,0,L.y));Y.push(u),j.splice(j.indexOf(L),1)}if(!Y.length&&j.length)for(const L of j){const j=L.getPoints(),P=[];for(const L of j)P.push(new R.r(L.x,0,L.y));Y.push(P)}const h=(0,u.h)(L,{shape:S,holes:Y.length?Y:void 0,depth:A.depth||1,faceUV:A.faceUV||(null===(C=A.perLetterFaceUV)||void 0===C?void 0:C.call(A,N)),faceColors:A.faceColors||(null===(b=A.perLetterFaceColors)||void 0===b?void 0:b.call(A,N)),sideOrientation:o.e._GetDefaultSideOrientation(A.sideOrientation||o.e.DOUBLESIDE)},a,D);V.push(h),N++}}const f=o.e.MergeMeshes(V,!0,!0);if(f){const j=f.getBoundingInfo().boundingBox;f.position.x+=-(j.minimumWorld.x+j.maximumWorld.x)/2,f.position.y+=-(j.minimumWorld.y+j.maximumWorld.y)/2,f.position.z+=-(j.minimumWorld.z+j.maximumWorld.z)/2+j.extendSize.z,f.name=L;const P=new Y.b("pivot",a);P.rotation.x=-Math.PI/2,f.parent=P,f.bakeCurrentTransformIntoVertices(),f.parent=null,P.dispose()}return f}},11706:(L,j,P)=>{P.d(j,{b:()=>a,c:()=>Y,d:()=>u});var A=P(475),R=P(2215),o=P(11712);function Y(){return"object"===typeof navigator&&navigator.hardwareConcurrency?Math.min(Math.floor(.5*navigator.hardwareConcurrency),4):1}function u(L){return!!(L.wasmUrl&&(L.wasmBinary||L.wasmBinaryUrl)&&"object"===typeof WebAssembly||L.fallbackUrl)}class a{constructor(L){if(L.workerPool)return void(this._workerPoolPromise=Promise.resolve(L.workerPool));const j=L.wasmBinary,P=L.numWorkers??Y(),u=P&&"function"===typeof Worker&&"function"===typeof URL,a=u||!L.jsModule,D=L.wasmUrl&&L.wasmBinaryUrl&&"object"===typeof WebAssembly?{url:a?A.d.GetBabylonScriptURL(L.wasmUrl,!0):"",wasmBinaryPromise:j?Promise.resolve(j):A.d.LoadFileAsync(A.d.GetBabylonScriptURL(L.wasmBinaryUrl,!0))}:{url:a?A.d.GetBabylonScriptURL(L.fallbackUrl):"",wasmBinaryPromise:Promise.resolve(void 0)};u?this._workerPoolPromise=D.wasmBinaryPromise.then((L=>{const j=this._getWorkerContent(),A=URL.createObjectURL(new Blob([j],{type:"application/javascript"}));return new R.b(P,(()=>{const j=new Worker(A);return(0,o.p)(j,L,D.url)}))})):this._modulePromise=D.wasmBinaryPromise.then((async j=>{if(!this._isModuleAvailable()&&!L.jsModule){if(!D.url)throw new Error("Draco codec module is not available");await A.d.LoadBabylonScriptAsync(D.url)}return await this._createModuleAsync(j,L.jsModule)}))}async whenReadyAsync(){this._workerPoolPromise?await this._workerPoolPromise:this._modulePromise&&await this._modulePromise}dispose(){this._workerPoolPromise&&this._workerPoolPromise.then((L=>{L.dispose()})),delete this._workerPoolPromise,delete this._modulePromise}}},11712:(L,j,P)=>{function A(L,j,P,A){const R=L;let o=null,Y=null,u=null,a=null;const D={},S=j.find((L=>"POSITION"===L.dracoName));if(!S)throw new Error("Position attribute is required for Draco encoding");if(!P){const L=S.data.length/S.size;P=new(L>65535?Uint32Array:Uint16Array)(L);for(let j=0;j<L;j++)P[j]=j}try{o=new R.Encoder,Y=new R.MeshBuilder,u=new R.Mesh,Y.AddFacesToMesh(u,P.length/3,P);const L=new Map([[Float32Array,(L,j,P,A,R,o)=>L.AddFloatAttribute(j,P,A,R,o)],[Uint32Array,(L,j,P,A,R,o)=>L.AddUInt32Attribute(j,P,A,R,o)],[Uint16Array,(L,j,P,A,R,o)=>L.AddUInt16Attribute(j,P,A,R,o)],[Uint8Array,(L,j,P,A,R,o)=>L.AddUInt8Attribute(j,P,A,R,o)],[Int32Array,(L,j,P,A,R,o)=>L.AddInt32Attribute(j,P,A,R,o)],[Int16Array,(L,j,P,A,R,o)=>L.AddInt16Attribute(j,P,A,R,o)],[Int8Array,(L,j,P,A,R,o)=>L.AddInt8Attribute(j,P,A,R,o)]]);for(const P of j){P.data instanceof Uint8ClampedArray&&(P.data=new Uint8Array(P.data));const j=L.get(P.data.constructor),a=P.data.length/P.size;D[P.kind]=j(Y,u,R[P.dracoName],a,P.size,P.data),A.quantizationBits&&A.quantizationBits[P.dracoName]&&o.SetAttributeQuantization(R[P.dracoName],A.quantizationBits[P.dracoName])}A.method&&o.SetEncodingMethod(R[A.method]),void 0!==A.encodeSpeed&&void 0!==A.decodeSpeed&&o.SetSpeedOptions(A.encodeSpeed,A.decodeSpeed),a=new R.DracoInt8Array;const S=o.EncodeMeshToDracoBuffer(u,a);if(S<=0)throw new Error("Draco encoding failed.");const g=new Int8Array(S);for(let j=0;j<S;j++)g[j]=a.GetValue(j);return{data:g,attributeIds:D}}finally{u&&R.destroy(u),Y&&R.destroy(Y),o&&R.destroy(o),a&&R.destroy(a)}}function R(){let L;onmessage=j=>{const P=j.data;switch(P.id){case"init":{P.url&&importScripts(P.url);const j=P.wasmBinary?{wasmBinary:P.wasmBinary}:{};L=DracoEncoderModule(j),postMessage({id:"initDone"});break}case"encodeMesh":if(!L)throw new Error("Draco encoder module is not available");L.then((L=>{const j=A(L,P.attributes,P.indices,P.options);postMessage({id:"encodeMeshDone",encodedMeshData:j},j?[j.data.buffer]:void 0)}))}}}function o(L,j,P,A,R){const o=L;let Y=null,u=null,a=null;try{let L;Y=new o.Decoder,u=new o.DecoderBuffer,u.Init(j,j.byteLength);const D=Y.GetEncodedGeometryType(u);switch(D){case o.TRIANGULAR_MESH:{const j=new o.Mesh;if(L=Y.DecodeBufferToMesh(u,j),!L.ok()||0===j.ptr)throw new Error(L.error_msg());const P=3*j.num_faces(),R=4*P,D=o._malloc(R);try{Y.GetTrianglesUInt32Array(j,R,D);const L=new Uint32Array(P);L.set(new Uint32Array(o.HEAPF32.buffer,D,P)),A(L)}finally{o._free(D)}a=j;break}case o.POINT_CLOUD:{const j=new o.PointCloud;if(L=Y.DecodeBufferToPointCloud(u,j),!L.ok()||!j.ptr)throw new Error(L.error_msg());a=j;break}default:throw new Error(`Invalid geometry type ${D}`)}const S=a.num_points(),g=(L,j,P,A)=>{const Y=A.data_type(),u=A.num_components(),a=A.normalized(),D=A.byte_stride(),g=A.byte_offset(),V={[o.DT_FLOAT32]:{typedArrayConstructor:Float32Array,heap:o.HEAPF32},[o.DT_INT8]:{typedArrayConstructor:Int8Array,heap:o.HEAP8},[o.DT_INT16]:{typedArrayConstructor:Int16Array,heap:o.HEAP16},[o.DT_INT32]:{typedArrayConstructor:Int32Array,heap:o.HEAP32},[o.DT_UINT8]:{typedArrayConstructor:Uint8Array,heap:o.HEAPU8},[o.DT_UINT16]:{typedArrayConstructor:Uint16Array,heap:o.HEAPU16},[o.DT_UINT32]:{typedArrayConstructor:Uint32Array,heap:o.HEAPU32}}[Y];if(!V)throw new Error(`Invalid data type ${Y}`);const N=S*u,C=N*V.typedArrayConstructor.BYTES_PER_ELEMENT,b=o._malloc(C);try{L.GetAttributeDataArrayForAllPoints(j,A,Y,C,b);const o=new V.typedArrayConstructor(V.heap.buffer,b,N);R(P,o.slice(),u,g,D,a)}finally{o._free(b)}};if(P)for(const j in P){const L=P[j],A=Y.GetAttributeByUniqueId(a,L);g(Y,a,j,A)}else{const L={position:o.POSITION,Xi:o.NORMAL,color:o.COLOR,uv:o.TEX_COORD};for(const j in L){const P=Y.GetAttributeId(a,L[j]);if(-1!==P){const L=Y.GetAttribute(a,P);g(Y,a,j,L)}}}return S}finally{a&&o.destroy(a),u&&o.destroy(u),Y&&o.destroy(Y)}}function Y(){let L;onmessage=j=>{const P=j.data;switch(P.id){case"init":{P.url&&importScripts(P.url);const j=P.wasmBinary?{wasmBinary:P.wasmBinary}:{};L=DracoDecoderModule(j),postMessage({id:"initDone"});break}case"decodeMesh":if(!L)throw new Error("Draco decoder module is not available");L.then((L=>{const j=o(L,P.dataView,P.attributes,(L=>{postMessage({id:"indices",data:L},[L.buffer])}),((L,j,P,A,R,o)=>{postMessage({id:"attribute",kind:L,data:j,size:P,byteOffset:A,byteStride:R,normalized:o},[j.buffer])}));postMessage({id:"decodeMeshDone",totalVertices:j})}))}}}async function u(L,j,P){return await new Promise(((A,R)=>{const o=j=>{L.removeEventListener("error",o),L.removeEventListener("message",Y),R(j)},Y=j=>{"initDone"===j.data.id&&(L.removeEventListener("error",o),L.removeEventListener("message",Y),A(L))};if(L.addEventListener("error",o),L.addEventListener("message",Y),j){const A=j.slice(0);L.postMessage({id:"init",url:P,wasmBinary:A},[A])}else L.postMessage({id:"init",url:P})}))}P.d(j,{e:()=>o,h:()=>Y,k:()=>A,n:()=>R,p:()=>u})},11717:(L,j,P)=>{P.d(j,{e:()=>A.e});var A=P(708)},11575:(L,j,P)=>{P.d(j,{d:()=>V});var A=P(656),R=P(490),o=P(778),Y=P(460),u=P(496),a=P(780),D=P(708),S=P(475),g=P(606);Y.e._instancedMeshFactory=(L,j)=>{const P=new V(L,j);if(j.instancedBuffers){P.instancedBuffers={};for(const L in j.instancedBuffers)P.instancedBuffers[L]=j.instancedBuffers[L]}return P};class V extends o.b{constructor(L,j){super(L,j.va()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,j.Hi(this),this._sourceMesh=j,this._unIndexed=j._unIndexed,this.position.p(j.position),this.rotation.p(j.rotation),this.mi.p(j.mi),j.rotationQuaternion&&(this.rotationQuaternion=j.rotationQuaternion.clone()),this.animations=j.animations.slice();for(const P of j.getAnimationRanges())null!=P&&this.createAnimationRange(P.name,P.from,P.to);if(this.infiniteDistance=j.infiniteDistance,this.setPivotMatrix(j.getPivotMatrix()),j.skeleton||j.morphTargetManager||!j.hasBoundingInfo)this.refreshBoundingInfo(!0,!0);else{const L=j.getBoundingInfo();this.buildBoundingInfo(L.minimum,L.maximum)}this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}set receiveShadows(L){var j;(null===(j=this._sourceMesh)||void 0===j?void 0:j.receiveShadows)!==L&&S.d.Warn("Setting receiveShadows on an instanced mesh has no effect")}get material(){return this._sourceMesh.material}set material(L){var j;(null===(j=this._sourceMesh)||void 0===j?void 0:j.material)!==L&&S.d.Warn("Setting material on an instanced mesh has no effect")}get visibility(){return this._sourceMesh.visibility}set visibility(L){var j;(null===(j=this._sourceMesh)||void 0===j?void 0:j.visibility)!==L&&S.d.Warn("Setting visibility on an instanced mesh has no effect")}get skeleton(){return this._sourceMesh.skeleton}set skeleton(L){var j;(null===(j=this._sourceMesh)||void 0===j?void 0:j.skeleton)!==L&&S.d.Warn("Setting skeleton on an instanced mesh has no effect")}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(L){this._sourceMesh&&L!==this._sourceMesh.renderingGroupId&&R.e.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}get ui(){return this._sourceMesh._geometry}createInstance(L){return this._sourceMesh.createInstance(L)}isReady(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sourceMesh.isReady(L,!0)}getVerticesData(L,j,P){return this._sourceMesh.getVerticesData(L,j,P)}copyVerticesData(L,j){this._sourceMesh.copyVerticesData(L,j)}Ga(L,j,P,A){return this.sourceMesh&&this.sourceMesh.Ga(L,j,P,A),this.sourceMesh}updateVerticesData(L,j,P,A){return this.sourceMesh&&this.sourceMesh.updateVerticesData(L,j,P,A),this.sourceMesh}setIndices(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.sourceMesh&&this.sourceMesh.setIndices(L,j),this.sourceMesh}isVerticesDataPresent(L){return this._sourceMesh.isVerticesDataPresent(L)}zi(){return this._sourceMesh.zi()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(){let L,j=arguments.length>0&&void 0!==arguments[0]&&arguments[0],P=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;L="object"===typeof j?j:{applySkeleton:j,applyMorph:P};const A=this._sourceMesh.ui?this._sourceMesh.ui.boundingBias:null;return this.Fa(this._sourceMesh._getData(L,null,D.e.PositionKind),A),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(L,j){if(super._activate(L,j),this._sourceMesh.Bi||R.e.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!==this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,L),j){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD!==this._sourceMesh&&this._currentLOD.billboardMode!==a.b.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new A.e);const L=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,A.m.ti[7].p(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.p(this._currentLOD.yi(!0)),this._currentLOD.position.p(A.m.ti[7]),this._currentLOD._masterMesh=L,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(L){if(!L)return this;const j=this.sourceMesh.getLODLevels();if(j&&0!==j.length){const j=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(L,j.boundingSphere)}else this._currentLOD=this.sourceMesh;return this._currentLOD}_preActivateForIntermediateRendering(L){return this.sourceMesh._preActivateForIntermediateRendering(L)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.Bi)for(let L=0;L<this._sourceMesh.Bi.length;L++)this._sourceMesh.Bi[L].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}Ea(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,P=arguments.length>2?arguments[2]:void 0;const A=((arguments.length>3?arguments[3]:void 0)||this._sourceMesh).createInstance(L);if(u.b.DeepCopy(this,A,["name","Bi","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","wi","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo","ui"],[]),this.refreshBoundingInfo(),j&&(A.parent=j),!P)for(let R=0;R<this.va().meshes.length;R++){const L=this.va().meshes[R];L.parent===this&&L.clone(L.name,A)}return A.yi(!0),this.onClonedObservable.notifyObservers(A),A}dispose(L){let j=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sourceMesh.Ii(this),super.dispose(L,j)}_serializeAsParent(L){super._serializeAsParent(L),L.parentId=this._sourceMesh.uniqueId,L.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,j=arguments.length>1?arguments[1]:void 0,P=arguments.length>2?arguments[2]:void 0;const A=this.clone("Clone of "+(this.name||this.id),L||this.parent,!0,j&&j.newSourcedMesh);A&&P&&P(this,A);for(const R of this.getChildTransformNodes(!0))R.instantiateHierarchy(A,j,P);return A}}Y.e.prototype.registerInstancedBuffer=function(L,j){var P,A;if(null===(P=this._userInstancedBuffersStorage)||void 0===P||null===(A=P.vertexBuffers[L])||void 0===A||A.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const L of this.instances)L.instancedBuffers={}}this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this.instancedBuffers[L]=null,this._userInstancedBuffersStorage.strides[L]=j,this._userInstancedBuffersStorage.sizes[L]=32*j,this._userInstancedBuffersStorage.data[L]=new Float32Array(this._userInstancedBuffersStorage.sizes[L]),this._userInstancedBuffersStorage.vertexBuffers[L]=new D.e(this.getEngine(),this._userInstancedBuffersStorage.data[L],L,!0,!1,j,!0);for(const R of this.instances)R.instancedBuffers[L]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()},Y.e.prototype._processInstancedBuffers=function(L,j){const P=L?L.length:0;for(const A in this.instancedBuffers){let R=this._userInstancedBuffersStorage.sizes[A];const o=this._userInstancedBuffersStorage.strides[A],Y=(P+1)*o;for(;R<Y;)R*=2;this._userInstancedBuffersStorage.data[A].length!=R&&(this._userInstancedBuffersStorage.data[A]=new Float32Array(R),this._userInstancedBuffersStorage.sizes[A]=R,this._userInstancedBuffersStorage.vertexBuffers[A]&&(this._userInstancedBuffersStorage.vertexBuffers[A].dispose(),this._userInstancedBuffersStorage.vertexBuffers[A]=null));const u=this._userInstancedBuffersStorage.data[A];let a=0;if(j){const L=this.instancedBuffers[A];L.toArray?L.toArray(u,a):L.copyToArray?L.copyToArray(u,a):u[a]=L,a+=o}for(let j=0;j<P;j++){const P=L[j].instancedBuffers[A];P.toArray?P.toArray(u,a):P.copyToArray?P.copyToArray(u,a):u[a]=P,a+=o}this._userInstancedBuffersStorage.vertexBuffers[A]?this._userInstancedBuffersStorage.vertexBuffers[A].updateDirectly(u,0):(this._userInstancedBuffersStorage.vertexBuffers[A]=new D.e(this.getEngine(),this._userInstancedBuffersStorage.data[A],A,!0,!1,o,!0),this._invalidateInstanceVertexArrayObject())}},Y.e.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(const L in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[L]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},Y.e.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const L in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[L]&&this._userInstancedBuffersStorage.vertexBuffers[L].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}},(0,g.h)("BABYLON.InstancedMesh",V)},11690:(L,j,P)=>{P.d(j,{c:()=>D});var A=P(685),R=P(708),o=P(460),Y=P(11575),u=P(801),a=P(11692);o.e._LinesMeshParser=(L,j)=>D.Parse(L,j);class D extends o.e{_isShaderMaterial(L){return"ShaderMaterial"===L.getClassName()}constructor(L){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>5?arguments[5]:void 0,Y=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0;super(L,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,j,arguments.length>4?arguments[4]:void 0),this.useVertexColor=o,this.useVertexAlpha=Y,this.color=new A.e(1,1,1),this.alpha=1,this._shaderLanguage=0,j&&(this.color=j.color.clone(),this.alpha=j.alpha,this.useVertexColor=j.useVertexColor,this.useVertexAlpha=j.useVertexAlpha),this.intersectionThreshold=.1;const S={attributes:[R.e.PositionKind],uniforms:["world","viewProjection"],needAlphaBlending:!0,defines:[],useClipPlane:null,shaderLanguage:0};if(this.useVertexAlpha?S.defines.push("#define VERTEXALPHA"):S.needAlphaBlending=!1,this.useVertexColor?(S.defines.push("#define VERTEXCOLOR"),S.attributes.push(R.e.ColorKind)):(S.uniforms.push("color"),this._color4=new A.i),u)this.material=u;else{this.va().getEngine().isWebGPU&&!D.ForceGLSL&&(this._shaderLanguage=1),S.shaderLanguage=this._shaderLanguage,S.extraInitializationsAsync=async()=>{1===this._shaderLanguage?await Promise.all([P.e(38).then(P.bind(P,13659)),P.e(34).then(P.bind(P,13665))]):await Promise.all([P.e(32).then(P.bind(P,13673)),P.e(31).then(P.bind(P,13678))])},this.material=new a.c("colorShader",this.va(),"color",S,!1),this.material.doNotSerialize=!0}}isReady(){return!!this._lineMaterial.isReady(this,!!this._userInstancedBuffersStorage||this.hasThinInstances)&&super.isReady()}getClassName(){return"LinesMesh"}get material(){return this._lineMaterial}set material(L){this._lineMaterial=L,this._lineMaterial.fillMode=u.c.LineListDrawMode}get checkCollisions(){return!1}set checkCollisions(L){}_bind(L,j){if(!this._geometry)return this;const P=this.isUnIndexed?null:this._geometry.getIndexBuffer();if(!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(j,P):this._geometry._bind(j,P,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),!this.useVertexColor&&this._isShaderMaterial(this._lineMaterial)){const{r:L,g:j,b:P}=this.color;this._color4.set(L,j,P,this.alpha),this._lineMaterial.setColor4("color",this._color4)}return this}_draw(L,j,P){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const A=this.va().getEngine();return this._unIndexed?A.drawArraysType(u.c.LineListDrawMode,L.verticesStart,L.verticesCount,P):A.drawElementsType(u.c.LineListDrawMode,L.indexStart,L.indexCount,P),this}dispose(L){(arguments.length>2?arguments[2]:void 0)||this._lineMaterial.dispose(!1,!1,!0),super.dispose(L)}clone(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,P=arguments.length>2?arguments[2]:void 0;if(j&&void 0===j._addToSceneRootNodes){const P=j;return P.source=this,new D(L,this.va(),P.parent,P.source,P.doNotCloneChildren)}return new D(L,this.va(),j,this,P)}createInstance(L){const j=new S(L,this);if(this.instancedBuffers){j.instancedBuffers={};for(const L in this.instancedBuffers)j.instancedBuffers[L]=this.instancedBuffers[L]}return j}serialize(L){super.serialize(L),L.color=this.color.Ei(),L.alpha=this.alpha}static Parse(L,j){const P=new D(L.name,j);return P.color=A.e.ri(L.color),P.alpha=L.alpha,P}}D.ForceGLSL=!1;class S extends Y.d{constructor(L,j){super(L,j),this.intersectionThreshold=j.intersectionThreshold}getClassName(){return"InstancedLinesMesh"}}},11600:(L,j,P)=>{P.d(j,{b:()=>Y});var A=P(2032),R=P(2199);let o=0;const Y=L=>{if(!L.environmentBRDFTexture){const j=L.useDelayedTextureLoading;L.useDelayedTextureLoading=!1;const P=L._blockEntityCollection;L._blockEntityCollection=!1;const Y=A.e.CreateFromBase64String("data:image/png;base64,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","EnvironmentBRDFTexture"+o++,L,!0,!1,A.e.BILINEAR_SAMPLINGMODE);L._blockEntityCollection=P;const u=L.getEngine().getLoadedTexturesCache(),a=u.indexOf(Y.getInternalTexture());-1!==a&&u.splice(a,1),Y.isRGBD=!0,Y.wrapU=A.e.CLAMP_ADDRESSMODE,Y.wrapV=A.e.CLAMP_ADDRESSMODE,L.environmentBRDFTexture=Y,L.useDelayedTextureLoading=j,R.c.ExpandRGBDTexture(Y);const D=L.getEngine().onContextRestoredObservable.add((()=>{Y.isRGBD=!0;const j=L.onBeforeRenderObservable.add((()=>{Y.isReady()&&(L.onBeforeRenderObservable.remove(j),R.c.ExpandRGBDTexture(Y))}))}));L.Oi.add((()=>{L.getEngine().onContextRestoredObservable.remove(D)}))}return L.environmentBRDFTexture}},11723:(L,j,P)=>{function A(){const L=L=>!!L&&"object"===typeof L;for(var j=arguments.length,P=new Array(j),R=0;R<j;R++)P[R]=arguments[R];return P.reduce(((j,P)=>{const R=Object.keys(P);for(const o of R){const R=j[o],Y=P[o];Array.isArray(R)&&Array.isArray(Y)?j[o]=R.concat(...Y):L(R)&&L(Y)?j[o]=A(R,Y):j[o]=Y}return j}),{})}P.d(j,{b:()=>A})},2215:(L,j,P)=>{P.d(j,{b:()=>R});class A{constructor(L){this._pendingActions=new Array,this._workerInfos=L.map((L=>({workerPromise:Promise.resolve(L),idle:!0})))}dispose(){for(const L of this._workerInfos)L.workerPromise.then((L=>{L.terminate()}));this._workerInfos.length=0,this._pendingActions.length=0}push(L){this._executeOnIdleWorker(L)||this._pendingActions.push(L)}_executeOnIdleWorker(L){for(const j of this._workerInfos)if(j.idle)return this._execute(j,L),!0;return!1}_execute(L,j){L.idle=!1,L.workerPromise.then((P=>{j(P,(()=>{const j=this._pendingActions.shift();j?this._execute(L,j):L.idle=!0}))}))}}class R extends A{constructor(L,j){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R.DefaultOptions;super([]),this._maxWorkers=L,this._createWorkerAsync=j,this._options=P}push(L){if(!this._executeOnIdleWorker(L))if(this._workerInfos.length<this._maxWorkers){const j={workerPromise:this._createWorkerAsync(),idle:!1};this._workerInfos.push(j),this._execute(j,L)}else this._pendingActions.push(L)}_execute(L,j){L.timeoutId&&(clearTimeout(L.timeoutId),delete L.timeoutId),super._execute(L,((P,A)=>{j(P,(()=>{A(),L.idle&&(L.timeoutId=setTimeout((()=>{L.workerPromise.then((L=>{L.terminate()}));const j=this._workerInfos.indexOf(L);-1!==j&&this._workerInfos.splice(j,1)}),this._options.idleTimeElapsedBeforeRelease))}))}))}}R.DefaultOptions={idleTimeElapsedBeforeRelease:1e3}},11680:(L,j,P)=>{P.d(j,{e:()=>S});var A=P(636),R=P(469),o=P(519),Y=P(708),u=P(639),a=P(680),D=P(606);class S{get influence(){return this._influence}set influence(L){if(this._influence===L)return;const j=this._influence;this._influence=L,this.onInfluenceChanged.hasObservers()&&this.onInfluenceChanged.notifyObservers(0===j||0===L)}get animationPropertiesOverride(){return!this._animationPropertiesOverride&&this._scene?this._scene.animationPropertiesOverride:this._animationPropertiesOverride}set animationPropertiesOverride(L){this._animationPropertiesOverride=L}constructor(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.name=L,this.animations=[],this._positions=null,this._normals=null,this._tangents=null,this._uvs=null,this._uv2s=null,this._colors=null,this._uniqueId=0,this.onInfluenceChanged=new R.e,this._onDataLayoutChanged=new R.e,this._animationPropertiesOverride=null,this.id=L,this._scene=P||o.b.LastCreatedScene,this.influence=j,this._scene&&(this._uniqueId=this._scene.getUniqueId())}get uniqueId(){return this._uniqueId}get hasPositions(){return!!this._positions}get hasNormals(){return!!this._normals}get hasTangents(){return!!this._tangents}get hasUVs(){return!!this._uvs}get hasUV2s(){return!!this._uv2s}get hasColors(){return!!this._colors}get vertexCount(){return this._positions?this._positions.length/3:this._normals?this._normals.length/3:this._tangents?this._tangents.length/3:this._uvs?this._uvs.length/2:this._uv2s?this._uv2s.length/2:this._colors?this._colors.length/4:0}setPositions(L){const j=this.hasPositions;this._positions=L,j!==this.hasPositions&&this._onDataLayoutChanged.notifyObservers(void 0)}getPositions(){return this._positions}setNormals(L){const j=this.hasNormals;this._normals=L,j!==this.hasNormals&&this._onDataLayoutChanged.notifyObservers(void 0)}getNormals(){return this._normals}setTangents(L){const j=this.hasTangents;this._tangents=L,j!==this.hasTangents&&this._onDataLayoutChanged.notifyObservers(void 0)}getTangents(){return this._tangents}setUVs(L){const j=this.hasUVs;this._uvs=L,j!==this.hasUVs&&this._onDataLayoutChanged.notifyObservers(void 0)}getUVs(){return this._uvs}setUV2s(L){const j=this.hasUV2s;this._uv2s=L,j!==this.hasUV2s&&this._onDataLayoutChanged.notifyObservers(void 0)}getUV2s(){return this._uv2s}setColors(L){const j=this.hasColors;this._colors=L,j!==this.hasColors&&this._onDataLayoutChanged.notifyObservers(void 0)}getColors(){return this._colors}clone(){const L=a.e.Clone((()=>new S(this.name,this.influence,this._scene)),this);return L._positions=this._positions,L._normals=this._normals,L._tangents=this._tangents,L._uvs=this._uvs,L._uv2s=this._uv2s,L._colors=this._colors,L}serialize(){const L={};return L.name=this.name,L.influence=this.influence,L.xa=Array.prototype.slice.call(this.getPositions()),null!=this.id&&(L.id=this.id),this.hasNormals&&(L.ya=Array.prototype.slice.call(this.getNormals())),this.hasTangents&&(L.tangents=Array.prototype.slice.call(this.getTangents())),this.hasUVs&&(L.Aa=Array.prototype.slice.call(this.getUVs())),this.hasUV2s&&(L.uv2s=Array.prototype.slice.call(this.getUV2s())),this.hasColors&&(L.za=Array.prototype.slice.call(this.getColors())),a.e.AppendSerializedAnimations(this,L),L}getClassName(){return"MorphTarget"}static Parse(L,j){const P=new S(L.name,L.influence);if(P.setPositions(L.xa),null!=L.id&&(P.id=L.id),L.ya&&P.setNormals(L.ya),L.tangents&&P.setTangents(L.tangents),L.Aa&&P.setUVs(L.Aa),L.uv2s&&P.setUV2s(L.uv2s),L.za&&P.setColors(L.za),L.animations){for(let j=0;j<L.animations.length;j++){const A=L.animations[j],R=(0,D.e)("BABYLON.Animation");R&&P.animations.push(R.Parse(A))}L.autoAnimate&&j&&j.beginAnimation(P,L.autoAnimateFrom,L.autoAnimateTo,L.autoAnimateLoop,L.autoAnimateSpeed||1)}return P}static FromMesh(L,j,P){j||(j=L.name);const A=new S(j,P,L.va());return A.setPositions(L.getVerticesData(Y.e.PositionKind)),L.isVerticesDataPresent(Y.e.NormalKind)&&A.setNormals(L.getVerticesData(Y.e.NormalKind)),L.isVerticesDataPresent(Y.e.TangentKind)&&A.setTangents(L.getVerticesData(Y.e.TangentKind)),L.isVerticesDataPresent(Y.e.UVKind)&&A.setUVs(L.getVerticesData(Y.e.UVKind)),L.isVerticesDataPresent(Y.e.UV2Kind)&&A.setUV2s(L.getVerticesData(Y.e.UV2Kind)),L.isVerticesDataPresent(Y.e.ColorKind)&&A.setColors(L.getVerticesData(Y.e.ColorKind)),A}}(0,A.b)([(0,u.K)()],S.prototype,"id",void 0)}}]);