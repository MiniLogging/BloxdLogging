"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[15],{11860:(U,W,l)=>{l.d(W,{c:()=>g,e:()=>r,f:()=>m,g:()=>j,i:()=>K,l:()=>w,o:()=>s});var M=l(706),t=l(742),L=l(722),p=l(655),B=l(11862),k=l(730),A=l(2033),q=l(541),y=l(734);const j=Object.freeze(new M.e(0,0,0,0)),s=Object.freeze(M.l.Zero()),w=Object.freeze(M.h.Zero()),K=Object.freeze(A.e.Zero()),r=Object.freeze(t.e.Black()),m=Object.freeze(new t.f(0,0,0,0)),f={key:0,repeatCount:0,loopMode:2};class g{static _PrepareAnimation(U,W,l,L,p,B,k,q){let y;if(!isNaN(parseFloat(p))&&isFinite(p)?y=g.ANIMATIONTYPE_FLOAT:p instanceof M.e?y=g.ANIMATIONTYPE_QUATERNION:p instanceof M.l?y=g.ANIMATIONTYPE_VECTOR3:p instanceof M.h?y=g.ANIMATIONTYPE_VECTOR2:p instanceof t.e?y=g.ANIMATIONTYPE_COLOR3:p instanceof t.f?y=g.ANIMATIONTYPE_COLOR4:p instanceof A.e&&(y=g.ANIMATIONTYPE_SIZE),void 0==y)return null;const j=new g(U,W,l,y,k),s=[{frame:0,value:p},{frame:L,value:B}];return j.setKeys(s),void 0!==q&&j.setEasingFunction(q),j}static CreateAnimation(U,W,l,M){const t=new g(U+"Animation",U,l,W,g.ANIMATIONLOOPMODE_CONSTANT);return t.setEasingFunction(M),t}static CreateAndStartAnimation(U,W,l,M,t,L,p,B,k,A,q){const y=g._PrepareAnimation(U,l,M,t,L,p,B,k);return y?(W.va&&(q=W.va()),q?q.beginDirectAnimation(W,[y],0,t,y.loopMode!==g.ANIMATIONLOOPMODE_CONSTANT,1,A):null):null}static CreateAndStartHierarchyAnimation(U,W,l,M,t,L,p,B,k,A,q){const y=g._PrepareAnimation(U,M,t,L,p,B,k,A);if(!y)return null;return W.va().beginDirectHierarchyAnimation(W,l,[y],0,L,1===y.loopMode,1,q)}static CreateMergeAndStartAnimation(U,W,l,M,t,L,p,B,k,A){const q=g._PrepareAnimation(U,l,M,t,L,p,B,k);return q?(W.animations.push(q),W.va().beginAnimation(W,0,t,1===q.loopMode,1,A)):null}static MakeAnimationAdditive(U,W,l){let t;t="object"===typeof W?W:{referenceFrame:W??0,range:l,cloneOriginalAnimation:arguments.length>3&&void 0!==arguments[3]&&arguments[3],clonedAnimationName:arguments.length>4?arguments[4]:void 0};let L=U;if(t.cloneOriginalAnimation&&(L=U.clone(),L.name=t.clonedAnimationName||L.name),!L._keys.length)return L;const p=t.referenceFrame&&t.referenceFrame>=0?t.referenceFrame:0;let B=0;const k=L._keys[0];let A=L._keys.length-1;const q=L._keys[A],y={referenceValue:k.value,referencePosition:M.f.ik[0],referenceQuaternion:M.f.Quaternion[0],referenceScaling:M.f.ik[1],keyPosition:M.f.ik[2],keyQuaternion:M.f.Quaternion[1],keyScaling:M.f.ik[3]};let j=k.frame,s=q.frame;if(t.range){const U=L.getRange(t.range);U&&(j=U.from,s=U.to)}else j=t.fromFrame??j,s=t.toFrame??s;if(j!==k.frame&&(B=L.createKeyForFrame(j)),s!==q.frame&&(A=L.createKeyForFrame(s)),1===L._keys.length){const U=L._getKeyValue(L._keys[0]);y.referenceValue=U.clone?U.clone():U}else if(p<=k.frame){const U=L._getKeyValue(k.value);y.referenceValue=U.clone?U.clone():U}else if(p>=q.frame){const U=L._getKeyValue(q.value);y.referenceValue=U.clone?U.clone():U}else{f.key=0;const U=L._interpolate(p,f);y.referenceValue=U.clone?U.clone():U}L.dataType===g.ANIMATIONTYPE_QUATERNION?y.referenceValue.normalize().conjugateInPlace():L.dataType===g.ANIMATIONTYPE_MATRIX&&(y.referenceValue.decompose(y.referenceScaling,y.referenceQuaternion,y.referencePosition),y.referenceQuaternion.normalize().conjugateInPlace());let w=Number.MAX_VALUE;const K=t.clipKeys?[]:null;for(let r=B;r<=A;r++){let U=L._keys[r];if((K||t.cloneOriginalAnimation)&&(U={frame:U.frame,value:U.value.clone?U.value.clone():U.value,inTangent:U.inTangent,outTangent:U.outTangent,interpolation:U.interpolation,lockedTangent:U.lockedTangent},K&&(w===Number.MAX_VALUE&&(w=U.frame),U.frame-=w,K.push(U))),!r||L.dataType===g.ANIMATIONTYPE_FLOAT||U.value!==k.value)switch(L.dataType){case g.ANIMATIONTYPE_MATRIX:U.value.decompose(y.keyScaling,y.keyQuaternion,y.keyPosition),y.keyPosition.kk(y.referencePosition),y.keyScaling.divideInPlace(y.referenceScaling),y.referenceQuaternion.multiplyToRef(y.keyQuaternion,y.keyQuaternion),M.c.ComposeToRef(y.keyScaling,y.keyQuaternion,y.keyPosition,U.value);break;case g.ANIMATIONTYPE_QUATERNION:y.referenceValue.multiplyToRef(U.value,U.value);break;case g.ANIMATIONTYPE_VECTOR2:case g.ANIMATIONTYPE_VECTOR3:case g.ANIMATIONTYPE_COLOR3:case g.ANIMATIONTYPE_COLOR4:U.value.subtractToRef(y.referenceValue,U.value);break;case g.ANIMATIONTYPE_SIZE:U.value.width-=y.referenceValue.width,U.value.height-=y.referenceValue.height;break;default:U.value-=y.referenceValue}}return K&&L.setKeys(K,!0),L}static TransitionTo(U,W,l,M,t,L,p){let B=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(p<=0)return l[U]=W,B&&B(),null;const k=t*(p/1e3);L.setKeys([{frame:0,value:l[U].clone?l[U].clone():l[U]},{frame:k,value:W}]),l.animations||(l.animations=[]),l.animations.push(L);const A=M.beginAnimation(l,0,k,!1);return A.onAnimationEnd=B,A}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const U of this._runtimeAnimations)if(!U.isStopped())return!0;return!1}constructor(U,W,l,M,t,L){this.name=U,this.targetProperty=W,this.framePerSecond=l,this.dataType=M,this.loopMode=t,this.enableBlending=L,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this._coreAnimation=null,this.targetPropertyPath=W.split("."),this.dataType=M,this.loopMode=void 0===t?g.ANIMATIONLOOPMODE_CYCLE:t,this.uniqueId=g._UniqueIdGenerator++}toString(U){let W="Name: "+this.name+", property: "+this.targetProperty;if(W+=", datatype: "+["Float","ik","Quaternion","Matrix","zk","Vector2"][this.dataType],W+=", nKeys: "+(this._keys?this._keys.length:"none"),W+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),U){W+=", Ranges: {";let U=!0;for(const l in this._ranges)U&&(W+=", ",U=!1),W+=l;W+="}"}return W}addEvent(U){this._events.push(U),this._events.sort(((U,W)=>U.frame-W.frame))}removeEvents(U){for(let W=0;W<this._events.length;W++)this._events[W].frame===U&&(this._events.splice(W,1),W--)}getEvents(){return this._events}createRange(U,W,l){this._ranges[U]||(this._ranges[U]=new B.b(U,W,l))}deleteRange(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const l=this._ranges[U];if(l){if(W){const U=l.from,W=l.to;for(let l=this._keys.length-1;l>=0;l--)this._keys[l].frame>=U&&this._keys[l].frame<=W&&this._keys.splice(l,1)}this._ranges[U]=null}}getRange(U){return this._ranges[U]}getKeys(){return this._keys}getHighestFrame(){let U=0;for(let W=0,l=this._keys.length;W<l;W++)U<this._keys[W].frame&&(U=this._keys[W].frame);return U}getEasingFunction(){return this._easingFunction}setEasingFunction(U){this._easingFunction=U}floatInterpolateFunction(U,W,l){return(0,L.Lerp)(U,W,l)}floatInterpolateFunctionWithTangents(U,W,l,M,t){return(0,L.Hermite)(U,W,l,M,t)}quaternionInterpolateFunction(U,W,l){return M.e.Slerp(U,W,l)}quaternionInterpolateFunctionWithTangents(U,W,l,t,L){return M.e.Hermite(U,W,l,t,L).normalize()}vector3InterpolateFunction(U,W,l){return M.l.Lerp(U,W,l)}vector3InterpolateFunctionWithTangents(U,W,l,t,L){return M.l.Hermite(U,W,l,t,L)}vector2InterpolateFunction(U,W,l){return M.h.Lerp(U,W,l)}vector2InterpolateFunctionWithTangents(U,W,l,t,L){return M.h.Hermite(U,W,l,t,L)}sizeInterpolateFunction(U,W,l){return A.e.Lerp(U,W,l)}color3InterpolateFunction(U,W,l){return t.e.Lerp(U,W,l)}color3InterpolateFunctionWithTangents(U,W,l,M,L){return t.e.Hermite(U,W,l,M,L)}color4InterpolateFunction(U,W,l){return t.f.Lerp(U,W,l)}color4InterpolateFunctionWithTangents(U,W,l,M,L){return t.f.Hermite(U,W,l,M,L)}_getKeyValue(U){return"function"===typeof U?U():U}evaluate(U){return f.key=0,this._interpolate(U,f)}_interpolate(U,W){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(W.loopMode===g.ANIMATIONLOOPMODE_CONSTANT&&W.repeatCount>0)return W.highLimitValue.clone?W.highLimitValue.clone():W.highLimitValue;const M=this._keys;let t;if(this._coreAnimation)t=this._coreAnimation._key;else{const L=M.length;for(t=W.key;t>=0&&U<M[t].frame;)--t;for(;t+1<=L-1&&U>=M[t+1].frame;)++t;if(W.key=t,t<0)return l?void 0:this._getKeyValue(M[0].value);if(t+1>L-1)return l?void 0:this._getKeyValue(M[L-1].value);this._key=t}const L=M[t],p=M[t+1];if(l&&(U===L.frame||U===p.frame))return;const B=this._getKeyValue(L.value),k=this._getKeyValue(p.value);if(1===L.interpolation)return p.frame>U?B:k;const A=void 0!==L.outTangent&&void 0!==p.inTangent,q=p.frame-L.frame;let y=(U-L.frame)/q;const f=L.easingFunction||this.getEasingFunction();switch(f&&(y=f.ease(y)),this.dataType){case g.ANIMATIONTYPE_FLOAT:{const U=A?this.floatInterpolateFunctionWithTangents(B,L.outTangent*q,k,p.inTangent*q,y):this.floatInterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return(W.offsetValue??0)*W.repeatCount+U}break}case g.ANIMATIONTYPE_QUATERNION:{const U=A?this.quaternionInterpolateFunctionWithTangents(B,L.outTangent.scale(q),k,p.inTangent.scale(q),y):this.quaternionInterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return U.addInPlace((W.offsetValue||j).scale(W.repeatCount))}return U}case g.ANIMATIONTYPE_VECTOR3:{const U=A?this.vector3InterpolateFunctionWithTangents(B,L.outTangent.scale(q),k,p.inTangent.scale(q),y):this.vector3InterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return U.add((W.offsetValue||s).scale(W.repeatCount))}break}case g.ANIMATIONTYPE_VECTOR2:{const U=A?this.vector2InterpolateFunctionWithTangents(B,L.outTangent.scale(q),k,p.inTangent.scale(q),y):this.vector2InterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return U.add((W.offsetValue||w).scale(W.repeatCount))}break}case g.ANIMATIONTYPE_SIZE:switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return this.sizeInterpolateFunction(B,k,y);case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return this.sizeInterpolateFunction(B,k,y).add((W.offsetValue||K).scale(W.repeatCount))}break;case g.ANIMATIONTYPE_COLOR3:{const U=A?this.color3InterpolateFunctionWithTangents(B,L.outTangent.scale(q),k,p.inTangent.scale(q),y):this.color3InterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return U.add((W.offsetValue||r).scale(W.repeatCount))}break}case g.ANIMATIONTYPE_COLOR4:{const U=A?this.color4InterpolateFunctionWithTangents(B,L.outTangent.scale(q),k,p.inTangent.scale(q),y):this.color4InterpolateFunction(B,k,y);switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return U;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return U.add((W.offsetValue||m).scale(W.repeatCount))}break}case g.ANIMATIONTYPE_MATRIX:switch(W.loopMode){case g.ANIMATIONLOOPMODE_CYCLE:case g.ANIMATIONLOOPMODE_CONSTANT:case g.ANIMATIONLOOPMODE_YOYO:return g.AllowMatricesInterpolation?this.matrixInterpolateFunction(B,k,y,W.workValue):B;case g.ANIMATIONLOOPMODE_RELATIVE:case g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT:return B}}return 0}matrixInterpolateFunction(U,W,l,t){return g.AllowMatrixDecomposeForInterpolation?t?(M.c.DecomposeLerpToRef(U,W,l,t),t):M.c.DecomposeLerp(U,W,l):t?(M.c.LerpToRef(U,W,l,t),t):M.c.Lerp(U,W,l)}clone(){const U=new g(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(U.enableBlending=this.enableBlending,U.blendingSpeed=this.blendingSpeed,this._keys&&U.setKeys(this._keys),this._ranges){U._ranges={};for(const W in this._ranges){const l=this._ranges[W];l&&(U._ranges[W]=l.clone())}}return U}setKeys(U){let W=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._keys=W?U:U.slice(0)}createKeyForFrame(U){f.key=0;const W=this._interpolate(U,f,!0);if(!W)return this._keys[f.key].frame===U?f.key:f.key+1;const l={frame:U,value:W.clone?W.clone():W};return this._keys.splice(f.key+1,0,l),f.key+1}serialize(){const U={};U.name=this.name,U.property=this.targetProperty,U.framePerSecond=this.framePerSecond,U.dataType=this.dataType,U.loopBehavior=this.loopMode,U.enableBlending=this.enableBlending,U.blendingSpeed=this.blendingSpeed;const W=this.dataType;U.keys=[];const l=this.getKeys();for(let M=0;M<l.length;M++){const t=l[M],L={};switch(L.frame=t.frame,W){case g.ANIMATIONTYPE_FLOAT:L.values=[t.value],void 0!==t.inTangent&&L.values.push(t.inTangent),void 0!==t.outTangent&&(void 0===t.inTangent&&L.values.push(void 0),L.values.push(t.outTangent)),void 0!==t.interpolation&&(void 0===t.inTangent&&L.values.push(void 0),void 0===t.outTangent&&L.values.push(void 0),L.values.push(t.interpolation));break;case g.ANIMATIONTYPE_QUATERNION:case g.ANIMATIONTYPE_MATRIX:case g.ANIMATIONTYPE_VECTOR3:case g.ANIMATIONTYPE_COLOR3:case g.ANIMATIONTYPE_COLOR4:L.values=t.value.qk(),void 0!=t.inTangent&&L.values.push(t.inTangent.qk()),void 0!=t.outTangent&&(void 0===t.inTangent&&L.values.push(void 0),L.values.push(t.outTangent.qk())),void 0!==t.interpolation&&(void 0===t.inTangent&&L.values.push(void 0),void 0===t.outTangent&&L.values.push(void 0),L.values.push(t.interpolation))}U.keys.push(L)}U.ranges=[];for(const M in this._ranges){const W=this._ranges[M];if(!W)continue;const l={};l.name=M,l.from=W.from,l.to=W.to,U.ranges.push(l)}return U}static _UniversalLerp(U,W,l){const M=U.constructor;return M.Lerp?M.Lerp(U,W,l):M.Slerp?M.Slerp(U,W,l):U.toFixed?U*(1-l)+l*W:W}static Parse(U){const W=new g(U.name,U.property,U.framePerSecond,U.dataType,U.loopBehavior),l=U.dataType,L=[];let p,B;for(U.enableBlending&&(W.enableBlending=U.enableBlending),U.blendingSpeed&&(W.blendingSpeed=U.blendingSpeed),B=0;B<U.keys.length;B++){const W=U.keys[B];let k,A,q;switch(l){case g.ANIMATIONTYPE_FLOAT:p=W.values[0],W.values.length>=2&&(k=W.values[1]),W.values.length>=3&&(A=W.values[2]),W.values.length>=4&&(q=W.values[3]);break;case g.ANIMATIONTYPE_QUATERNION:if(p=M.e.gk(W.values),W.values.length>=8){const U=M.e.gk(W.values.slice(4,8));U.equals(M.e.Zero())||(k=U)}if(W.values.length>=12){const U=M.e.gk(W.values.slice(8,12));U.equals(M.e.Zero())||(A=U)}W.values.length>=13&&(q=W.values[12]);break;case g.ANIMATIONTYPE_MATRIX:p=M.c.gk(W.values),W.values.length>=17&&(q=W.values[16]);break;case g.ANIMATIONTYPE_COLOR3:p=t.e.gk(W.values),W.values[3]&&(k=t.e.gk(W.values[3])),W.values[4]&&(A=t.e.gk(W.values[4])),W.values[5]&&(q=W.values[5]);break;case g.ANIMATIONTYPE_COLOR4:p=t.f.gk(W.values),W.values[4]&&(k=t.f.gk(W.values[4])),W.values[5]&&(A=t.f.gk(W.values[5])),W.values[6]&&(q=t.f.gk(W.values[6]));break;case g.ANIMATIONTYPE_VECTOR3:default:p=M.l.gk(W.values),W.values[3]&&(k=M.l.gk(W.values[3])),W.values[4]&&(A=M.l.gk(W.values[4])),W.values[5]&&(q=W.values[5])}const y={};y.frame=W.frame,y.value=p,void 0!=k&&(y.inTangent=k),void 0!=A&&(y.outTangent=A),void 0!=q&&(y.interpolation=q),L.push(y)}if(W.setKeys(L),U.ranges)for(B=0;B<U.ranges.length;B++)p=U.ranges[B],W.createRange(p.name,p.from,p.to);return W}static AppendSerializedAnimations(U,W){y.e.AppendSerializedAnimations(U,W)}static async ParseFromFileAsync(U,W){return await new Promise(((l,M)=>{const t=new q.c;t.addEventListener("readystatechange",(()=>{if(4==t.readyState)if(200==t.status){let W=JSON.parse(t.responseText);if(W.animations&&(W=W.animations),W.length){const U=[];for(const l of W)U.push(this.Parse(l));l(U)}else{const M=this.Parse(W);U&&(M.name=U),l(M)}}else M("Unable to load the animation")})),t.open("GET",W),t.send()}))}static async ParseFromSnippetAsync(U){return await new Promise(((W,l)=>{const M=new q.c;M.addEventListener("readystatechange",(()=>{if(4==M.readyState)if(200==M.status){const l=JSON.parse(JSON.parse(M.responseText).jsonPayload);if(l.animations){const M=JSON.parse(l.animations),t=[];for(const W of M.animations){const l=this.Parse(W);l.snippetId=U,t.push(l)}W(t)}else{const M=JSON.parse(l.animation),t=this.Parse(M);t.snippetId=U,W(t)}}else l("Unable to load the snippet "+U)})),M.open("GET",this.SnippetUrl+"/"+U.replace(/#/g,"/")),M.send()}))}}g._UniqueIdGenerator=0,g.AllowMatricesInterpolation=!1,g.AllowMatrixDecomposeForInterpolation=!0,g.SnippetUrl="https://snippet.babylonjs.com",g.ANIMATIONTYPE_FLOAT=0,g.ANIMATIONTYPE_VECTOR3=1,g.ANIMATIONTYPE_QUATERNION=2,g.ANIMATIONTYPE_MATRIX=3,g.ANIMATIONTYPE_COLOR3=4,g.ANIMATIONTYPE_COLOR4=7,g.ANIMATIONTYPE_VECTOR2=5,g.ANIMATIONTYPE_SIZE=6,g.ANIMATIONLOOPMODE_RELATIVE=0,g.ANIMATIONLOOPMODE_CYCLE=1,g.ANIMATIONLOOPMODE_CONSTANT=2,g.ANIMATIONLOOPMODE_YOYO=4,g.ANIMATIONLOOPMODE_RELATIVE_FROM_CURRENT=5,g.CreateFromSnippetAsync=g.ParseFromSnippetAsync,(0,p.f)("BABYLON.Animation",g),k.c._AnimationRangeFactory=(U,W,l)=>new B.b(U,W,l)},11862:(U,W,l)=>{l.d(W,{b:()=>M});class M{constructor(U,W,l){this.name=U,this.from=W,this.to=l}clone(){return new M(this.name,this.from,this.to)}}},11789:(U,W,l)=>{l.d(W,{b:()=>y});var M=l(686),t=l(688),L=l(677),p=l(706),B=l(711),k=l(845);l(730).c.AddNodeConstructor("TargetCamera",((U,W)=>()=>new y(U,p.l.Zero(),W)));const A=p.c.Zero(),q=p.e.Identity();class y extends L.d{constructor(U,W,l){super(U,W,l,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),this.cameraDirection=new p.l(0,0,0),this.cameraRotation=new p.h(0,0),this.updateUpVectorFromRotation=!1,this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=p.l.Zero(),this._initialFocalDistance=1,this._viewMatrix=p.c.Zero(),this._cameraTransformMatrix=p.c.Zero(),this._cameraRotationMatrix=p.c.Zero(),this._transformedReferencePoint=p.l.Zero(),this._deferredPositionUpdate=new p.l,this._deferredRotationQuaternionUpdate=new p.e,this._deferredRotationUpdate=new p.l,this._deferredUpdated=!1,this._deferOnly=!1,this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0,this._referencePoint=p.l.Forward(this.va().useRightHandedSystem),this.rotation=new p.l(0,this.va().useRightHandedSystem?Math.PI:0,0)}getFrontPosition(U){this.getWorldMatrix();const W=p.f.ik[0],l=p.f.ik[1];return l.set(0,0,this._scene.useRightHandedSystem?-1:1),this.getDirectionToRef(l,W),W.scaleInPlace(U),this.globalPosition.add(W)}_getLockedTargetPosition(){if(!this.lockedTarget)return null;if(this.lockedTarget.absolutePosition){const U=this.lockedTarget;U.fk().getTranslationToRef(U.absolutePosition)}return this.lockedTarget.absolutePosition||this.lockedTarget}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.wd(0,0,0),this.cameraRotation.wd(0,0),!0)}_initCache(){super._initCache(),this._cache.lockedTarget=new p.l(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new p.l(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new p.e(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(U){U||super._updateCache();const W=this._getLockedTargetPosition();W?this._cache.lockedTarget?this._cache.lockedTarget.p(W):this._cache.lockedTarget=W.clone():this._cache.lockedTarget=null,this._cache.rotation.p(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.p(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const U=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(U):!U)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const U=this.getEngine();return this.speed*Math.sqrt(U.getDeltaTime()/(100*U.getFps()))}setTarget(U){this.upVector.normalize(),this._initialFocalDistance=U.de(this.position).length(),this.position.z===U.z&&(this.position.z+=B.d),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),this.va().useRightHandedSystem?p.c.LookAtRHToRef(this.position,U,p.l.UpReadOnly,A):p.c.LookAtLHToRef(this.position,U,p.l.UpReadOnly,A),A.invert();const W=this.rotationQuaternion||q;p.e.FromRotationMatrixToRef(A,W),W.toEulerAnglesToRef(this.rotation),this.rotation.z=0}get target(){return this.getTarget()}set target(U){this.setTarget(U)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(p.f.Matrix[0]),p.l.TransformNormalToRef(this.cameraDirection,p.f.Matrix[0],p.f.ik[0]),this._deferredPositionUpdate.addInPlace(p.f.ik[0]),void(this._deferOnly?this._deferredUpdated=!0:this.position.p(this._deferredPositionUpdate));this._deferredPositionUpdate.addInPlace(this.cameraDirection),this._deferOnly?this._deferredUpdated=!0:this.position.p(this._deferredPositionUpdate)}_checkInputs(){const U=this.invertRotation?-this.inverseRotationSpeed:1,W=this._decideIfNeedsToMove(),l=this.cameraRotation.x||this.cameraRotation.y;if(this._deferredUpdated=!1,this._deferredRotationUpdate.p(this.rotation),this._deferredPositionUpdate.p(this.position),this.rotationQuaternion&&this._deferredRotationQuaternionUpdate.p(this.rotationQuaternion),W&&this._updatePosition(),l){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this._deferredRotationUpdate),this._deferredRotationUpdate.x+=this.cameraRotation.x*U,this._deferredRotationUpdate.y+=this.cameraRotation.y*U,!this.noRotationConstraint){const U=1.570796;this._deferredRotationUpdate.x>U&&(this._deferredRotationUpdate.x=U),this._deferredRotationUpdate.x<-U&&(this._deferredRotationUpdate.x=-U)}if(this._deferOnly?this._deferredUpdated=!0:this.rotation.p(this._deferredRotationUpdate),this.rotationQuaternion){this._deferredRotationUpdate.lengthSquared()&&(p.e.RotationYawPitchRollToRef(this._deferredRotationUpdate.y,this._deferredRotationUpdate.x,this._deferredRotationUpdate.z,this._deferredRotationQuaternionUpdate),this._deferOnly?this._deferredUpdated=!0:this.rotationQuaternion.p(this._deferredRotationQuaternionUpdate))}}W&&(Math.abs(this.cameraDirection.x)<this.speed*B.d&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*B.d&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*B.d&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),l&&(Math.abs(this.cameraRotation.x)<this.speed*B.d&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*B.d&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):p.c.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return p.l.TransformNormalToRef(p.l.UpReadOnly,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),p.l.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?k.c.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(p.e.FromEulerVectorToRef(this.rotation,q),k.c.Y.rotateByQuaternionToRef(q,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(U,W,l){if(this.va().useRightHandedSystem?p.c.LookAtRHToRef(U,W,l,this._viewMatrix):p.c.LookAtLHToRef(U,W,l,this._viewMatrix),this.parent){const U=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(U,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.p(U)}createRigCamera(U,W){if(this.cameraRigMode!==L.d.RIG_MODE_NONE){const W=new y(U,this.position.clone(),this.va());return W.isRigCamera=!0,W.rigParent=this,this.cameraRigMode===L.d.RIG_MODE_VR&&(this.rotationQuaternion||(this.rotationQuaternion=new p.e),W._cameraRigParams={},W.rotationQuaternion=new p.e),W.mode=this.mode,W.orthoLeft=this.orthoLeft,W.orthoRight=this.orthoRight,W.orthoTop=this.orthoTop,W.orthoBottom=this.orthoBottom,W}return null}_updateRigCameras(){const U=this._rigCameras[0],W=this._rigCameras[1];switch(this.fk(),this.cameraRigMode){case L.d.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case L.d.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case L.d.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case L.d.RIG_MODE_STEREOSCOPIC_OVERUNDER:case L.d.RIG_MODE_STEREOSCOPIC_INTERLACED:{const l=this.cameraRigMode===L.d.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,M=this.cameraRigMode===L.d.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*l,U),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*M,W);break}case L.d.RIG_MODE_VR:U.rotationQuaternion?(U.rotationQuaternion.p(this.rotationQuaternion),W.rotationQuaternion.p(this.rotationQuaternion)):(U.rotation.p(this.rotation),W.rotation.p(this.rotation)),U.position.p(this.position),W.position.p(this.position)}super._updateRigCameras()}_getRigCamPositionAndTarget(U,W){this.getTarget().subtractToRef(this.position,y._TargetFocalPoint),y._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const l=y._TargetFocalPoint.addInPlace(this.position);p.c.TranslationToRef(-l.x,-l.y,-l.z,y._TargetTransformMatrix),y._TargetTransformMatrix.multiplyToRef(p.c.RotationAxis(W.upVector,U),y._RigCamTransformMatrix),p.c.TranslationToRef(l.x,l.y,l.z,y._TargetTransformMatrix),y._RigCamTransformMatrix.multiplyToRef(y._TargetTransformMatrix,y._RigCamTransformMatrix),p.l.TransformCoordinatesToRef(this.position,y._RigCamTransformMatrix,W.position),W.setTarget(l)}getClassName(){return"TargetCamera"}}y._RigCamTransformMatrix=new p.c,y._TargetTransformMatrix=new p.c,y._TargetFocalPoint=new p.l,(0,M.e)([(0,t.T)()],y.prototype,"updateUpVectorFromRotation",void 0),(0,M.e)([(0,t.R)()],y.prototype,"rotation",void 0),(0,M.e)([(0,t.T)()],y.prototype,"speed",void 0),(0,M.e)([(0,t.D)("lockedTargetId")],y.prototype,"lockedTarget",void 0)},11783:(U,W,l)=>{l.d(W,{c:()=>M});class M{}M.AUTOSAMPLERSUFFIX="Sampler",M.DISABLEUA="#define DISABLE_UNIFORMITY_ANALYSIS",M.ALPHA_DISABLE=0,M.ALPHA_ADD=1,M.ALPHA_COMBINE=2,M.ALPHA_SUBTRACT=3,M.ALPHA_MULTIPLY=4,M.ALPHA_MAXIMIZED=5,M.ALPHA_ONEONE=6,M.ALPHA_PREMULTIPLIED=7,M.ALPHA_PREMULTIPLIED_PORTERDUFF=8,M.ALPHA_INTERPOLATE=9,M.ALPHA_SCREENMODE=10,M.ALPHA_ONEONE_ONEONE=11,M.ALPHA_ALPHATOCOLOR=12,M.ALPHA_REVERSEONEMINUS=13,M.ALPHA_SRC_DSTONEMINUSSRCALPHA=14,M.ALPHA_ONEONE_ONEZERO=15,M.ALPHA_EXCLUSION=16,M.ALPHA_LAYER_ACCUMULATE=17,M.ALPHA_EQUATION_ADD=0,M.ALPHA_EQUATION_SUBSTRACT=1,M.ALPHA_EQUATION_REVERSE_SUBTRACT=2,M.ALPHA_EQUATION_MAX=3,M.ALPHA_EQUATION_MIN=4,M.ALPHA_EQUATION_DARKEN=5,M.DELAYLOADSTATE_NONE=0,M.DELAYLOADSTATE_LOADED=1,M.DELAYLOADSTATE_LOADING=2,M.DELAYLOADSTATE_NOTLOADED=4,M.NEVER=512,M.ALWAYS=519,M.LESS=513,M.EQUAL=514,M.LEQUAL=515,M.GREATER=516,M.GEQUAL=518,M.NOTEQUAL=517,M.KEEP=7680,M.ZERO=0,M.REPLACE=7681,M.INCR=7682,M.DECR=7683,M.INVERT=5386,M.INCR_WRAP=34055,M.DECR_WRAP=34056,M.TEXTURE_CLAMP_ADDRESSMODE=0,M.TEXTURE_WRAP_ADDRESSMODE=1,M.TEXTURE_MIRROR_ADDRESSMODE=2,M.TEXTURE_CREATIONFLAG_STORAGE=1,M.TEXTUREFORMAT_ALPHA=0,M.TEXTUREFORMAT_LUMINANCE=1,M.TEXTUREFORMAT_LUMINANCE_ALPHA=2,M.TEXTUREFORMAT_RGB=4,M.TEXTUREFORMAT_RGBA=5,M.TEXTUREFORMAT_RED=6,M.TEXTUREFORMAT_R=6,M.TEXTUREFORMAT_R16_UNORM=33322,M.TEXTUREFORMAT_RG16_UNORM=33324,M.TEXTUREFORMAT_RGB16_UNORM=32852,M.TEXTUREFORMAT_RGBA16_UNORM=32859,M.TEXTUREFORMAT_R16_SNORM=36760,M.TEXTUREFORMAT_RG16_SNORM=36761,M.TEXTUREFORMAT_RGB16_SNORM=36762,M.TEXTUREFORMAT_RGBA16_SNORM=36763,M.TEXTUREFORMAT_RG=7,M.TEXTUREFORMAT_RED_INTEGER=8,M.TEXTUREFORMAT_R_INTEGER=8,M.TEXTUREFORMAT_RG_INTEGER=9,M.TEXTUREFORMAT_RGB_INTEGER=10,M.TEXTUREFORMAT_RGBA_INTEGER=11,M.TEXTUREFORMAT_BGRA=12,M.TEXTUREFORMAT_DEPTH24_STENCIL8=13,M.TEXTUREFORMAT_DEPTH32_FLOAT=14,M.TEXTUREFORMAT_DEPTH16=15,M.TEXTUREFORMAT_DEPTH24=16,M.TEXTUREFORMAT_DEPTH24UNORM_STENCIL8=17,M.TEXTUREFORMAT_DEPTH32FLOAT_STENCIL8=18,M.TEXTUREFORMAT_STENCIL8=19,M.TEXTUREFORMAT_UNDEFINED=4294967295,M.TEXTUREFORMAT_COMPRESSED_RGBA_BPTC_UNORM=36492,M.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_BPTC_UNORM=36493,M.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT=36495,M.TEXTUREFORMAT_COMPRESSED_RGB_BPTC_SIGNED_FLOAT=36494,M.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT5=33779,M.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919,M.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT3=33778,M.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918,M.TEXTUREFORMAT_COMPRESSED_RGBA_S3TC_DXT1=33777,M.TEXTUREFORMAT_COMPRESSED_RGB_S3TC_DXT1=33776,M.TEXTUREFORMAT_COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917,M.TEXTUREFORMAT_COMPRESSED_SRGB_S3TC_DXT1_EXT=35916,M.TEXTUREFORMAT_COMPRESSED_RGBA_ASTC_4x4=37808,M.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840,M.TEXTUREFORMAT_COMPRESSED_RGB_ETC1_WEBGL=36196,M.TEXTUREFORMAT_COMPRESSED_RGB8_ETC2=37492,M.TEXTUREFORMAT_COMPRESSED_SRGB8_ETC2=37493,M.TEXTUREFORMAT_COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,M.TEXTUREFORMAT_COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,M.TEXTUREFORMAT_COMPRESSED_RGBA8_ETC2_EAC=37496,M.TEXTUREFORMAT_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,M.TEXTURETYPE_UNSIGNED_BYTE=0,M.TEXTURETYPE_UNSIGNED_INT=0,M.TEXTURETYPE_FLOAT=1,M.TEXTURETYPE_HALF_FLOAT=2,M.TEXTURETYPE_BYTE=3,M.TEXTURETYPE_SHORT=4,M.TEXTURETYPE_UNSIGNED_SHORT=5,M.TEXTURETYPE_INT=6,M.TEXTURETYPE_UNSIGNED_INTEGER=7,M.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,M.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,M.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,M.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,M.TEXTURETYPE_UNSIGNED_INT_24_8=12,M.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,M.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,M.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,M.TEXTURETYPE_UNDEFINED=16,M.TEXTURE_2D=3553,M.TEXTURE_2D_ARRAY=35866,M.TEXTURE_CUBE_MAP=34067,M.TEXTURE_CUBE_MAP_ARRAY=3735928559,M.TEXTURE_3D=32879,M.TEXTURE_NEAREST_SAMPLINGMODE=1,M.TEXTURE_NEAREST_NEAREST=1,M.TEXTURE_BILINEAR_SAMPLINGMODE=2,M.TEXTURE_LINEAR_LINEAR=2,M.TEXTURE_TRILINEAR_SAMPLINGMODE=3,M.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,M.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,M.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,M.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,M.TEXTURE_NEAREST_LINEAR=7,M.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,M.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,M.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,M.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,M.TEXTURE_LINEAR_NEAREST=12,M.TEXTURE_EXPLICIT_MODE=0,M.TEXTURE_SPHERICAL_MODE=1,M.TEXTURE_PLANAR_MODE=2,M.TEXTURE_CUBIC_MODE=3,M.TEXTURE_PROJECTION_MODE=4,M.TEXTURE_SKYBOX_MODE=5,M.TEXTURE_INVCUBIC_MODE=6,M.TEXTURE_EQUIRECTANGULAR_MODE=7,M.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,M.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,M.TEXTURE_FILTERING_QUALITY_OFFLINE=4096,M.TEXTURE_FILTERING_QUALITY_HIGH=64,M.TEXTURE_FILTERING_QUALITY_MEDIUM=16,M.TEXTURE_FILTERING_QUALITY_LOW=8,M.SCALEMODE_FLOOR=1,M.SCALEMODE_NEAREST=2,M.SCALEMODE_CEILING=3,M.MATERIAL_TextureDirtyFlag=1,M.MATERIAL_LightDirtyFlag=2,M.MATERIAL_FresnelDirtyFlag=4,M.MATERIAL_AttributesDirtyFlag=8,M.MATERIAL_MiscDirtyFlag=16,M.MATERIAL_PrePassDirtyFlag=32,M.MATERIAL_ImageProcessingDirtyFlag=64,M.MATERIAL_AllDirtyFlag=127,M.MATERIAL_TriangleFillMode=0,M.MATERIAL_WireFrameFillMode=1,M.MATERIAL_PointFillMode=2,M.MATERIAL_PointListDrawMode=3,M.MATERIAL_LineListDrawMode=4,M.MATERIAL_LineLoopDrawMode=5,M.MATERIAL_LineStripDrawMode=6,M.MATERIAL_TriangleStripDrawMode=7,M.MATERIAL_TriangleFanDrawMode=8,M.MATERIAL_ClockWiseSideOrientation=0,M.MATERIAL_CounterClockWiseSideOrientation=1,M.MATERIAL_DIFFUSE_MODEL_E_OREN_NAYAR=0,M.MATERIAL_DIFFUSE_MODEL_BURLEY=1,M.MATERIAL_DIFFUSE_MODEL_LAMBERT=2,M.MATERIAL_DIFFUSE_MODEL_LEGACY=3,M.MATERIAL_DIELECTRIC_SPECULAR_MODEL_GLTF=0,M.MATERIAL_DIELECTRIC_SPECULAR_MODEL_OPENPBR=1,M.MATERIAL_CONDUCTOR_SPECULAR_MODEL_GLTF=0,M.MATERIAL_CONDUCTOR_SPECULAR_MODEL_OPENPBR=1,M.ACTION_NothingTrigger=0,M.ACTION_OnPickTrigger=1,M.ACTION_OnLeftPickTrigger=2,M.ACTION_OnRightPickTrigger=3,M.ACTION_OnCenterPickTrigger=4,M.ACTION_OnPickDownTrigger=5,M.ACTION_OnDoublePickTrigger=6,M.ACTION_OnPickUpTrigger=7,M.ACTION_OnPickOutTrigger=16,M.ACTION_OnLongPressTrigger=8,M.ACTION_OnPointerOverTrigger=9,M.ACTION_OnPointerOutTrigger=10,M.ACTION_OnEveryFrameTrigger=11,M.ACTION_OnIntersectionEnterTrigger=12,M.ACTION_OnIntersectionExitTrigger=13,M.ACTION_OnKeyDownTrigger=14,M.ACTION_OnKeyUpTrigger=15,M.PARTICLES_BILLBOARDMODE_Y=2,M.PARTICLES_BILLBOARDMODE_ALL=7,M.PARTICLES_BILLBOARDMODE_STRETCHED=8,M.PARTICLES_BILLBOARDMODE_STRETCHED_LOCAL=9,M.MESHES_CULLINGSTRATEGY_STANDARD=0,M.MESHES_CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,M.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,M.MESHES_CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,M.SCENELOADER_NO_LOGGING=0,M.SCENELOADER_MINIMAL_LOGGING=1,M.SCENELOADER_SUMMARY_LOGGING=2,M.SCENELOADER_DETAILED_LOGGING=3,M.PREPASS_IRRADIANCE_TEXTURE_TYPE=0,M.PREPASS_POSITION_TEXTURE_TYPE=1,M.PREPASS_VELOCITY_TEXTURE_TYPE=2,M.PREPASS_REFLECTIVITY_TEXTURE_TYPE=3,M.PREPASS_COLOR_TEXTURE_TYPE=4,M.PREPASS_DEPTH_TEXTURE_TYPE=5,M.PREPASS_NORMAL_TEXTURE_TYPE=6,M.PREPASS_ALBEDO_SQRT_TEXTURE_TYPE=7,M.PREPASS_WORLD_NORMAL_TEXTURE_TYPE=8,M.PREPASS_LOCAL_POSITION_TEXTURE_TYPE=9,M.PREPASS_SCREENSPACE_DEPTH_TEXTURE_TYPE=10,M.PREPASS_VELOCITY_LINEAR_TEXTURE_TYPE=11,M.PREPASS_ALBEDO_TEXTURE_TYPE=12,M.PREPASS_NORMALIZED_VIEW_DEPTH_TEXTURE_TYPE=13,M.BUFFER_CREATIONFLAG_READ=1,M.BUFFER_CREATIONFLAG_WRITE=2,M.BUFFER_CREATIONFLAG_READWRITE=3,M.BUFFER_CREATIONFLAG_UNIFORM=4,M.BUFFER_CREATIONFLAG_VERTEX=8,M.BUFFER_CREATIONFLAG_INDEX=16,M.BUFFER_CREATIONFLAG_STORAGE=32,M.BUFFER_CREATIONFLAG_INDIRECT=64,M.RENDERPASS_MAIN=0,M.INPUT_ALT_KEY=18,M.INPUT_CTRL_KEY=17,M.INPUT_META_KEY1=91,M.INPUT_META_KEY2=92,M.INPUT_META_KEY3=93,M.INPUT_SHIFT_KEY=16,M.SNAPSHOTRENDERING_STANDARD=0,M.SNAPSHOTRENDERING_FAST=1,M.PERSPECTIVE_CAMERA=0,M.ORTHOGRAPHIC_CAMERA=1,M.FOVMODE_VERTICAL_FIXED=0,M.FOVMODE_HORIZONTAL_FIXED=1,M.RIG_MODE_NONE=0,M.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,M.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,M.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,M.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,M.RIG_MODE_STEREOSCOPIC_INTERLACED=14,M.RIG_MODE_VR=20,M.RIG_MODE_CUSTOM=22,M.MAX_SUPPORTED_UV_SETS=6,M.GL_ALPHA_EQUATION_ADD=32774,M.GL_ALPHA_EQUATION_MIN=32775,M.GL_ALPHA_EQUATION_MAX=32776,M.GL_ALPHA_EQUATION_SUBTRACT=32778,M.GL_ALPHA_EQUATION_REVERSE_SUBTRACT=32779,M.GL_ALPHA_FUNCTION_SRC=768,M.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_COLOR=769,M.GL_ALPHA_FUNCTION_SRC_ALPHA=770,M.GL_ALPHA_FUNCTION_ONE_MINUS_SRC_ALPHA=771,M.GL_ALPHA_FUNCTION_DST_ALPHA=772,M.GL_ALPHA_FUNCTION_ONE_MINUS_DST_ALPHA=773,M.GL_ALPHA_FUNCTION_DST_COLOR=774,M.GL_ALPHA_FUNCTION_ONE_MINUS_DST_COLOR=775,M.GL_ALPHA_FUNCTION_SRC_ALPHA_SATURATED=776,M.GL_ALPHA_FUNCTION_CONSTANT_COLOR=32769,M.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_COLOR=32770,M.GL_ALPHA_FUNCTION_CONSTANT_ALPHA=32771,M.GL_ALPHA_FUNCTION_ONE_MINUS_CONSTANT_ALPHA=32772,M.GL_ALPHA_FUNCTION_SRC1_COLOR=35065,M.GL_ALPHA_FUNCTION_ONE_MINUS_SRC1_COLOR=35066,M.GL_ALPHA_FUNCTION_SRC1_ALPHA=34185,M.GL_ALPHA_FUNCTION_ONE_MINUS_SRC1_ALPHA=35067,M.SnippetUrl="https://snippet.babylonjs.com",M.FOGMODE_NONE=0,M.FOGMODE_EXP=1,M.FOGMODE_EXP2=2,M.FOGMODE_LINEAR=3,M.BYTE=5120,M.UNSIGNED_BYTE=5121,M.SHORT=5122,M.UNSIGNED_SHORT=5123,M.INT=5124,M.UNSIGNED_INT=5125,M.FLOAT=5126,M.PositionKind="position",M.NormalKind="rk",M.TangentKind="tangent",M.UVKind="uv",M.UV2Kind="uv2",M.UV3Kind="uv3",M.UV4Kind="uv4",M.UV5Kind="uv5",M.UV6Kind="uv6",M.ColorKind="color",M.ColorInstanceKind="instanceColor",M.MatricesIndicesKind="matricesIndices",M.MatricesWeightsKind="matricesWeights",M.MatricesIndicesExtraKind="matricesIndicesExtra",M.MatricesWeightsExtraKind="matricesWeightsExtra",M.ANIMATIONTYPE_FLOAT=0,M.ANIMATIONTYPE_VECTOR3=1,M.ANIMATIONTYPE_QUATERNION=2,M.ANIMATIONTYPE_MATRIX=3,M.ANIMATIONTYPE_COLOR3=4,M.ANIMATIONTYPE_COLOR4=7,M.ANIMATIONTYPE_VECTOR2=5,M.ANIMATIONTYPE_SIZE=6,M.ShadowMinZ=0,M.ShadowMaxZ=1e4},11868:(U,W,l)=>{l.d(W,{c:()=>j});var M=l(686),t=l(688),L=l(706),p=l(742),B=l(730),k=l(837),A=l(655),q=l(862),y=l(734);class j extends B.c{get range(){return this._range}set range(U){this._range=U,this._inverseSquaredRange=1/(this.range*this.range)}get intensityMode(){return this._intensityMode}set intensityMode(U){this._intensityMode=U,this._computePhotometricScale()}get radius(){return this._radius}set radius(U){this._radius=U,this._computePhotometricScale()}get shadowEnabled(){return this._shadowEnabled}set shadowEnabled(U){this._shadowEnabled!==U&&(this._shadowEnabled=U,this._markMeshesAsLightDirty())}get includedOnlyMeshes(){return this._includedOnlyMeshes}set includedOnlyMeshes(U){this._includedOnlyMeshes=U,this._hookArrayForIncludedOnly(U)}get excludedMeshes(){return this._excludedMeshes}set excludedMeshes(U){this._excludedMeshes=U,this._hookArrayForExcluded(U)}get excludeWithLayerMask(){return this._excludeWithLayerMask}set excludeWithLayerMask(U){this._excludeWithLayerMask=U,this._resyncMeshes()}get includeOnlyWithLayerMask(){return this._includeOnlyWithLayerMask}set includeOnlyWithLayerMask(U){this._includeOnlyWithLayerMask=U,this._resyncMeshes()}get lightmapMode(){return this._lightmapMode}set lightmapMode(U){this._lightmapMode!==U&&(this._lightmapMode=U,this._markMeshesAsLightDirty())}getViewMatrix(U){return null}getProjectionMatrix(U,W){return null}constructor(U,W){super(U,W,!1),this.cb=new p.e(1,1,1),this.xk=new p.e(1,1,1),this.falloffType=j.FALLOFF_DEFAULT,this.bb=1,this._range=Number.MAX_VALUE,this._inverseSquaredRange=0,this._photometricScale=1,this._intensityMode=j.INTENSITYMODE_AUTOMATIC,this._radius=1e-5,this.renderPriority=0,this._shadowEnabled=!0,this._excludeWithLayerMask=0,this._includeOnlyWithLayerMask=0,this._lightmapMode=0,this._shadowGenerators=null,this._excludedMeshesIds=new Array,this._includedOnlyMeshesIds=new Array,this._isLight=!0,this.va().addLight(this),this._uniformBuffer=new k.e(this.va().getEngine(),void 0,void 0,U),this._buildUniformLayout(),this.includedOnlyMeshes=[],this.excludedMeshes=[],this._resyncMeshes()}transferTexturesToEffect(U,W){return this}_bindLight(U,W,l,M){let t=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const L=U.toString();let B=!1;if(this._uniformBuffer.bindToEffect(l,"Light"+L),this._renderId!==W.getRenderId()||this._lastUseSpecular!==M||!this._uniformBuffer.useUbo){this._renderId=W.getRenderId(),this._lastUseSpecular=M;const U=this.getScaledIntensity();this.transferToEffect(l,L),this.cb.scaleToRef(U,p.h.zk[0]),this._uniformBuffer.updateColor4("vLightDiffuse",p.h.zk[0],this.range,L),M&&(this.xk.scaleToRef(U,p.h.zk[1]),this._uniformBuffer.updateColor4("vLightSpecular",p.h.zk[1],this.radius,L)),B=!0}if(this.transferTexturesToEffect(l,L),W.shadowsEnabled&&this.shadowEnabled&&t){const U=this.getShadowGenerator(W.activeCamera)??this.getShadowGenerator();U&&(U.bindShadowLight(L,l),B=!0)}B?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}getClassName(){return"Light"}toString(U){let W="Name: "+this.name;if(W+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(let l=0;l<this.animations.length;l++)W+=", animation[0]: "+this.animations[l].toString(U);return W}_syncParentEnabledState(){super._syncParentEnabledState(),this.u()||this._resyncMeshes()}hc(U){super.hc(U),this._resyncMeshes()}getShadowGenerator(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===this._shadowGenerators?null:this._shadowGenerators.get(U)??null}getShadowGenerators(){return this._shadowGenerators}getAbsolutePosition(){return L.l.Zero()}canAffectMesh(U){return!U||!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(U))&&(!(this.excludedMeshes&&this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(U))&&((0===this.includeOnlyWithLayerMask||0!==(this.includeOnlyWithLayerMask&U.layerMask))&&!(0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&U.layerMask)))}dispose(U){let W=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._shadowGenerators){const U=this._shadowGenerators.values();for(let W=U.next();!0!==W.done;W=U.next()){W.value.dispose()}this._shadowGenerators=null}if(this.va().stopAnimation(this),this._parentContainer){const U=this._parentContainer.lights.indexOf(this);U>-1&&this._parentContainer.lights.splice(U,1),this._parentContainer=null}for(const l of this.va().meshes)l._removeLightSource(this,!0);this._uniformBuffer.dispose(),this.va().removeLight(this),super.dispose(U,W)}getTypeID(){return 0}getScaledIntensity(){return this._photometricScale*this.bb}clone(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const l=j.GetConstructorFromName(this.getTypeID(),U,this.va());if(!l)return null;const M=y.e.Clone(l,this);return U&&(M.name=U),W&&(M.parent=W),M.hc(this.isEnabled()),this.onClonedObservable.notifyObservers(M),M}serialize(){const U=y.e.Serialize(this);if(U.uniqueId=this.uniqueId,U.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(U),this.excludedMeshes.length>0){U.excludedMeshesIds=[];for(const W of this.excludedMeshes)U.excludedMeshesIds.push(W.id)}if(this.includedOnlyMeshes.length>0){U.includedOnlyMeshesIds=[];for(const W of this.includedOnlyMeshes)U.includedOnlyMeshesIds.push(W.id)}return y.e.AppendSerializedAnimations(this,U),U.ranges=this.serializeAnimationRanges(),U.isEnabled=this.isEnabled(),U}static GetConstructorFromName(U,W,l){const M=B.c.Construct("Light_Type_"+U,W,l);return M||null}static Parse(U,W){const l=j.GetConstructorFromName(U.type,U.name,W);if(!l)return null;const M=y.e.Parse(l,U,W);if(U.excludedMeshesIds&&(M._excludedMeshesIds=U.excludedMeshesIds),U.includedOnlyMeshesIds&&(M._includedOnlyMeshesIds=U.includedOnlyMeshesIds),void 0!==U.parentId&&(M._waitingParentId=U.parentId),void 0!==U.parentInstanceIndex&&(M._waitingParentInstanceIndex=U.parentInstanceIndex),void 0!==U.falloffType&&(M.falloffType=U.falloffType),void 0!==U.lightmapMode&&(M.lightmapMode=U.lightmapMode),U.animations){for(let W=0;W<U.animations.length;W++){const l=U.animations[W],t=(0,A.d)("BABYLON.Animation");t&&M.animations.push(t.Parse(l))}B.c.ParseAnimationRanges(M,U,W)}return U.autoAnimate&&W.beginAnimation(M,U.autoAnimateFrom,U.autoAnimateTo,U.autoAnimateLoop,U.autoAnimateSpeed||1),void 0!==U.isEnabled&&M.hc(U.isEnabled),M}_hookArrayForExcluded(U){var W=this;const l=U.push;U.push=function(){for(var M=arguments.length,t=new Array(M),L=0;L<M;L++)t[L]=arguments[L];const p=l.apply(U,t);for(const U of t)U._resyncLightSource(W);return p};const M=U.splice;U.splice=(W,l)=>{const t=M.apply(U,[W,l]);for(const U of t)U._resyncLightSource(this);return t};for(const t of U)t._resyncLightSource(this)}_hookArrayForIncludedOnly(U){var W=this;const l=U.push;U.push=function(){for(var M=arguments.length,t=new Array(M),L=0;L<M;L++)t[L]=arguments[L];const p=l.apply(U,t);return W._resyncMeshes(),p};const M=U.splice;U.splice=(W,l)=>{const t=M.apply(U,[W,l]);return this._resyncMeshes(),t},this._resyncMeshes()}_resyncMeshes(){for(const U of this.va().meshes)U._resyncLightSource(this)}_markMeshesAsLightDirty(){for(const U of this.va().meshes)-1!==U.lightSources.indexOf(this)&&U._markSubMeshesAsLightDirty()}_computePhotometricScale(){this._photometricScale=this._getPhotometricScale(),this.va().resetCachedMaterial()}_getPhotometricScale(){let U=0;const W=this.getTypeID();let l=this.intensityMode;switch(l===j.INTENSITYMODE_AUTOMATIC&&(l=W===j.LIGHTTYPEID_DIRECTIONALLIGHT?j.INTENSITYMODE_ILLUMINANCE:j.INTENSITYMODE_LUMINOUSINTENSITY),W){case j.LIGHTTYPEID_POINTLIGHT:case j.LIGHTTYPEID_SPOTLIGHT:switch(l){case j.INTENSITYMODE_LUMINOUSPOWER:U=1/(4*Math.PI);break;case j.INTENSITYMODE_LUMINOUSINTENSITY:U=1;break;case j.INTENSITYMODE_LUMINANCE:U=this.radius*this.radius}break;case j.LIGHTTYPEID_DIRECTIONALLIGHT:switch(l){case j.INTENSITYMODE_ILLUMINANCE:U=1;break;case j.INTENSITYMODE_LUMINANCE:{let W=this.radius;W=Math.max(W,.001);U=2*Math.PI*(1-Math.cos(W));break}}break;case j.LIGHTTYPEID_HEMISPHERICLIGHT:U=1}return U}_reorderLightsInScene(){const U=this.va();0!=this._renderPriority&&(U.requireLightSorting=!0),this.va().sortLightsByPriority()}_isReady(){return!0}}j.FALLOFF_DEFAULT=q.c.FALLOFF_DEFAULT,j.FALLOFF_PHYSICAL=q.c.FALLOFF_PHYSICAL,j.FALLOFF_GLTF=q.c.FALLOFF_GLTF,j.FALLOFF_STANDARD=q.c.FALLOFF_STANDARD,j.LIGHTMAP_DEFAULT=q.c.LIGHTMAP_DEFAULT,j.LIGHTMAP_SPECULAR=q.c.LIGHTMAP_SPECULAR,j.LIGHTMAP_SHADOWSONLY=q.c.LIGHTMAP_SHADOWSONLY,j.INTENSITYMODE_AUTOMATIC=q.c.INTENSITYMODE_AUTOMATIC,j.INTENSITYMODE_LUMINOUSPOWER=q.c.INTENSITYMODE_LUMINOUSPOWER,j.INTENSITYMODE_LUMINOUSINTENSITY=q.c.INTENSITYMODE_LUMINOUSINTENSITY,j.INTENSITYMODE_ILLUMINANCE=q.c.INTENSITYMODE_ILLUMINANCE,j.INTENSITYMODE_LUMINANCE=q.c.INTENSITYMODE_LUMINANCE,j.LIGHTTYPEID_POINTLIGHT=q.c.LIGHTTYPEID_POINTLIGHT,j.LIGHTTYPEID_DIRECTIONALLIGHT=q.c.LIGHTTYPEID_DIRECTIONALLIGHT,j.LIGHTTYPEID_SPOTLIGHT=q.c.LIGHTTYPEID_SPOTLIGHT,j.LIGHTTYPEID_HEMISPHERICLIGHT=q.c.LIGHTTYPEID_HEMISPHERICLIGHT,j.LIGHTTYPEID_RECT_AREALIGHT=q.c.LIGHTTYPEID_RECT_AREALIGHT,(0,M.e)([(0,t.n)()],j.prototype,"diffuse",void 0),(0,M.e)([(0,t.n)()],j.prototype,"specular",void 0),(0,M.e)([(0,t.T)()],j.prototype,"falloffType",void 0),(0,M.e)([(0,t.T)()],j.prototype,"intensity",void 0),(0,M.e)([(0,t.T)()],j.prototype,"range",null),(0,M.e)([(0,t.T)()],j.prototype,"intensityMode",null),(0,M.e)([(0,t.T)()],j.prototype,"radius",null),(0,M.e)([(0,t.T)()],j.prototype,"_renderPriority",void 0),(0,M.e)([(0,t.d)("_reorderLightsInScene")],j.prototype,"renderPriority",void 0),(0,M.e)([(0,t.T)("shadowEnabled")],j.prototype,"_shadowEnabled",void 0),(0,M.e)([(0,t.T)("excludeWithLayerMask")],j.prototype,"_excludeWithLayerMask",void 0),(0,M.e)([(0,t.T)("includeOnlyWithLayerMask")],j.prototype,"_includeOnlyWithLayerMask",void 0),(0,M.e)([(0,t.T)("lightmapMode")],j.prototype,"_lightmapMode",void 0)},11914:(U,W,l)=>{l.d(W,{d:()=>k});var M=l(686),t=l(688),L=l(706),p=l(11868),B=l(845);class k extends p.c{constructor(){super(...arguments),this._needProjectionMatrixCompute=!0,this._viewMatrix=L.c.Identity(),this._projectionMatrix=L.c.Identity()}_setPosition(U){this._position=U}get position(){return this._position}set position(U){this._setPosition(U)}_setDirection(U){this._direction=U}get direction(){return this._direction}set direction(U){this._setDirection(U)}get shadowMinZ(){return this._shadowMinZ}set shadowMinZ(U){this._shadowMinZ=U,this.forceProjectionMatrixCompute()}get shadowMaxZ(){return this._shadowMaxZ}set shadowMaxZ(U){this._shadowMaxZ=U,this.forceProjectionMatrixCompute()}computeTransformedInformation(){return!(!this.parent||!this.parent.getWorldMatrix)&&(this.transformedPosition||(this.transformedPosition=L.l.Zero()),L.l.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=L.l.Zero()),L.l.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),!0)}getDepthScale(){return 50}getShadowDirection(U){return this.transformedDirection?this.transformedDirection:this.direction}getAbsolutePosition(){return this.transformedPosition?this.transformedPosition:this.position}setDirectionToTarget(U){return this.direction=L.l.Normalize(U.de(this.position)),this.direction}getRotation(){this.direction.normalize();const U=L.l.Cross(this.direction,B.c.Y),W=L.l.Cross(U,this.direction);return L.l.RotationFromAxis(U,W,this.direction)}needCube(){return!1}needProjectionMatrixCompute(){return this._needProjectionMatrixCompute}forceProjectionMatrixCompute(){this._needProjectionMatrixCompute=!0}_initCache(){super._initCache(),this._cache.position=L.l.Zero()}_isSynchronized(){return!!this._cache.position.equals(this.position)}fk(U){return!U&&this.isSynchronized()?(this._currentRenderId=this.va().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.p(this.position),this._worldMatrix||(this._worldMatrix=L.c.Identity()),L.c.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}getDepthMinZ(U){return void 0!==this.shadowMinZ?this.shadowMinZ:(null===U||void 0===U?void 0:U.bk)||0}getDepthMaxZ(U){return void 0!==this.shadowMaxZ?this.shadowMaxZ:(null===U||void 0===U?void 0:U.maxZ)||1e4}setShadowProjectionMatrix(U,W,l){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(W,l,U):this._setDefaultShadowProjectionMatrix(U,W,l),this}_syncParentEnabledState(){super._syncParentEnabledState(),this.parent&&this.parent.getWorldMatrix||(this.transformedPosition=null,this.transformedDirection=null)}getViewMatrix(U){const W=L.f.ik[0];let l=this.position;this.computeTransformedInformation()&&(l=this.transformedPosition),L.l.NormalizeToRef(this.getShadowDirection(U),W),1===Math.abs(L.l.Dot(W,L.l.Up()))&&(W.z=1e-13);const M=L.f.ik[1];return l.addToRef(W,M),L.c.LookAtLHToRef(l,M,L.l.Up(),this._viewMatrix),this._viewMatrix}getProjectionMatrix(U,W){return this.setShadowProjectionMatrix(this._projectionMatrix,U??this._viewMatrix,W??[]),this._projectionMatrix}}(0,M.e)([(0,t.R)()],k.prototype,"position",null),(0,M.e)([(0,t.R)()],k.prototype,"direction",null),(0,M.e)([(0,t.T)()],k.prototype,"shadowMinZ",null),(0,M.e)([(0,t.T)()],k.prototype,"shadowMaxZ",null)},11813:(U,W,l)=>{l.d(W,{b:()=>G});var M=l(686),t=l(688),L=l(512),p=l(702),B=l(11806),k=l(2178),A=l(706),q=l(763),y=l(11816),j=l(11821);class s extends y.b{constructor(){super(...arguments),this.BRDF_V_HEIGHT_CORRELATED=!1,this.MS_BRDF_ENERGY_CONSERVATION=!1,this.SPHERICAL_HARMONICS=!1,this.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=!1,this.MIX_IBL_RADIANCE_WITH_IRRADIANCE=!0,this.LEGACY_SPECULAR_ENERGY_CONSERVATION=!1,this.BASE_DIFFUSE_MODEL=0,this.DIELECTRIC_SPECULAR_MODEL=0,this.CONDUCTOR_SPECULAR_MODEL=0}}class w extends j.c{_markAllSubMeshesAsMiscDirty(){this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"PBRBRDF",90,new s,W),this._useEnergyConservation=w.DEFAULT_USE_ENERGY_CONSERVATION,this.useEnergyConservation=w.DEFAULT_USE_ENERGY_CONSERVATION,this._useSmithVisibilityHeightCorrelated=w.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this.useSmithVisibilityHeightCorrelated=w.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED,this._useSphericalHarmonics=w.DEFAULT_USE_SPHERICAL_HARMONICS,this.useSphericalHarmonics=w.DEFAULT_USE_SPHERICAL_HARMONICS,this._useSpecularGlossinessInputEnergyConservation=w.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this.useSpecularGlossinessInputEnergyConservation=w.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION,this._mixIblRadianceWithIrradiance=w.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE,this.mixIblRadianceWithIrradiance=w.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE,this._useLegacySpecularEnergyConservation=w.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION,this.useLegacySpecularEnergyConservation=w.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION,this._baseDiffuseModel=w.DEFAULT_DIFFUSE_MODEL,this.baseDiffuseModel=w.DEFAULT_DIFFUSE_MODEL,this._dielectricSpecularModel=w.DEFAULT_DIELECTRIC_SPECULAR_MODEL,this.dielectricSpecularModel=w.DEFAULT_DIELECTRIC_SPECULAR_MODEL,this._conductorSpecularModel=w.DEFAULT_CONDUCTOR_SPECULAR_MODEL,this.conductorSpecularModel=w.DEFAULT_CONDUCTOR_SPECULAR_MODEL,this._internalMarkAllSubMeshesAsMiscDirty=U._dirtyCallbacks[16],this._enable(!0)}prepareDefines(U){U.BRDF_V_HEIGHT_CORRELATED=this._useSmithVisibilityHeightCorrelated,U.MS_BRDF_ENERGY_CONSERVATION=this._useEnergyConservation&&this._useSmithVisibilityHeightCorrelated,U.SPHERICAL_HARMONICS=this._useSphericalHarmonics,U.SPECULAR_GLOSSINESS_ENERGY_CONSERVATION=this._useSpecularGlossinessInputEnergyConservation,U.MIX_IBL_RADIANCE_WITH_IRRADIANCE=this._mixIblRadianceWithIrradiance,U.LEGACY_SPECULAR_ENERGY_CONSERVATION=this._useLegacySpecularEnergyConservation,U.BASE_DIFFUSE_MODEL=this._baseDiffuseModel,U.DIELECTRIC_SPECULAR_MODEL=this._dielectricSpecularModel,U.CONDUCTOR_SPECULAR_MODEL=this._conductorSpecularModel}getClassName(){return"PBRBRDFConfiguration"}}w.DEFAULT_USE_ENERGY_CONSERVATION=!0,w.DEFAULT_USE_SMITH_VISIBILITY_HEIGHT_CORRELATED=!0,w.DEFAULT_USE_SPHERICAL_HARMONICS=!0,w.DEFAULT_USE_SPECULAR_GLOSSINESS_INPUT_ENERGY_CONSERVATION=!0,w.DEFAULT_MIX_IBL_RADIANCE_WITH_IRRADIANCE=!0,w.DEFAULT_USE_LEGACY_SPECULAR_ENERGY_CONSERVATION=!0,w.DEFAULT_DIFFUSE_MODEL=0,w.DEFAULT_DIELECTRIC_SPECULAR_MODEL=0,w.DEFAULT_CONDUCTOR_SPECULAR_MODEL=0,(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"useEnergyConservation",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"useSmithVisibilityHeightCorrelated",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"useSphericalHarmonics",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"useSpecularGlossinessInputEnergyConservation",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"mixIblRadianceWithIrradiance",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"useLegacySpecularEnergyConservation",void 0),(0,M.e)([(0,t.T)("baseDiffuseModel"),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"baseDiffuseModel",void 0),(0,M.e)([(0,t.T)("dielectricSpecularModel"),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"dielectricSpecularModel",void 0),(0,M.e)([(0,t.T)("conductorSpecularModel"),(0,t.d)("_markAllSubMeshesAsMiscDirty")],w.prototype,"conductorSpecularModel",void 0);var K=l(11824),r=l(742),m=l(2183),f=l(851),g=l(11826),E=l(2048),Z=l(11829),N=(l(2245),l(11832)),D=l(854);class o extends y.b{constructor(){super(...arguments),this.CLEARCOAT=!1,this.CLEARCOAT_DEFAULTIOR=!1,this.CLEARCOAT_TEXTURE=!1,this.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this.CLEARCOAT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,this.CLEARCOAT_BUMP=!1,this.CLEARCOAT_BUMPDIRECTUV=0,this.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,this.CLEARCOAT_REMAP_F0=!1,this.CLEARCOAT_TINT=!1,this.CLEARCOAT_TINT_TEXTURE=!1,this.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,this.CLEARCOAT_TINT_GAMMATEXTURE=!1}}class i extends j.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"PBRClearCoat",100,new o,W),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.roughness=0,this._indexOfRefraction=i._DefaultIndexOfRefraction,this.indexOfRefraction=i._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._textureRoughness=null,this.textureRoughness=null,this._remapF0OnInterfaceChange=!0,this.remapF0OnInterfaceChange=!0,this._bumpTexture=null,this.bumpTexture=null,this._isTintEnabled=!1,this.isTintEnabled=!1,this.tintColor=r.e.White(),this.tintColorAtDistance=1,this.tintThickness=1,this._tintTexture=null,this.tintTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1]}isReadyForSubMesh(U,W,l){if(!this._isEnabled)return!0;const M=this._material._disableBumpMap;if(U._areTexturesDirty&&W.texturesEnabled){if(this._texture&&Z.e.ClearCoatTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&Z.e.ClearCoatTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1;if(l.getCaps().standardDerivatives&&this._bumpTexture&&Z.e.ClearCoatBumpTextureEnabled&&!M&&!this._bumpTexture.isReady())return!1;if(this._isTintEnabled&&this._tintTexture&&Z.e.ClearCoatTintTextureEnabled&&!this._tintTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(U,W){this._isEnabled?(U.CLEARCOAT=!0,U.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,U.CLEARCOAT_REMAP_F0=this._remapF0OnInterfaceChange,U._areTexturesDirty&&W.texturesEnabled&&(this._texture&&Z.e.ClearCoatTextureEnabled?(0,D.V)(this._texture,U,"CLEARCOAT_TEXTURE"):U.CLEARCOAT_TEXTURE=!1,this._textureRoughness&&Z.e.ClearCoatTextureEnabled?(0,D.V)(this._textureRoughness,U,"CLEARCOAT_TEXTURE_ROUGHNESS"):U.CLEARCOAT_TEXTURE_ROUGHNESS=!1,this._bumpTexture&&Z.e.ClearCoatBumpTextureEnabled?(0,D.V)(this._bumpTexture,U,"CLEARCOAT_BUMP"):U.CLEARCOAT_BUMP=!1,U.CLEARCOAT_DEFAULTIOR=this._indexOfRefraction===i._DefaultIndexOfRefraction,this._isTintEnabled?(U.CLEARCOAT_TINT=!0,this._tintTexture&&Z.e.ClearCoatTintTextureEnabled?((0,D.V)(this._tintTexture,U,"CLEARCOAT_TINT_TEXTURE"),U.CLEARCOAT_TINT_GAMMATEXTURE=this._tintTexture.gammaSpace):U.CLEARCOAT_TINT_TEXTURE=!1):(U.CLEARCOAT_TINT=!1,U.CLEARCOAT_TINT_TEXTURE=!1))):(U.CLEARCOAT=!1,U.CLEARCOAT_TEXTURE=!1,U.CLEARCOAT_TEXTURE_ROUGHNESS=!1,U.CLEARCOAT_BUMP=!1,U.CLEARCOAT_TINT=!1,U.CLEARCOAT_TINT_TEXTURE=!1,U.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,U.CLEARCOAT_DEFAULTIOR=!1,U.CLEARCOAT_TEXTUREDIRECTUV=0,U.CLEARCOAT_TEXTURE_ROUGHNESSDIRECTUV=0,U.CLEARCOAT_BUMPDIRECTUV=0,U.CLEARCOAT_REMAP_F0=!1,U.CLEARCOAT_TINT_TEXTUREDIRECTUV=0,U.CLEARCOAT_TINT_GAMMATEXTURE=!1)}bindForSubMesh(U,W,l,M){if(!this._isEnabled)return;const t=M.materialDefines,L=this._material.isFrozen,p=this._material._disableBumpMap,B=this._material._invertNormalMapX,k=this._material._invertNormalMapY;if(!U.useUbo||!L||!U.isSync){var A,q,y,j;if((this._texture||this._textureRoughness)&&Z.e.ClearCoatTextureEnabled)U.updateFloat4("vClearCoatInfos",(null===(A=this._texture)||void 0===A?void 0:A.coordinatesIndex)??0,(null===(q=this._texture)||void 0===q?void 0:q.level)??0,(null===(y=this._textureRoughness)||void 0===y?void 0:y.coordinatesIndex)??0,(null===(j=this._textureRoughness)||void 0===j?void 0:j.level)??0),this._texture&&(0,D.u)(this._texture,U,"clearCoat"),this._textureRoughness&&!t.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&(0,D.u)(this._textureRoughness,U,"clearCoatRoughness");this._bumpTexture&&l.getCaps().standardDerivatives&&Z.e.ClearCoatTextureEnabled&&!p&&(U.updateFloat2("vClearCoatBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level),(0,D.u)(this._bumpTexture,U,"clearCoatBump"),W._mirroredCameraPosition?U.updateFloat2("vClearCoatTangentSpaceParams",B?1:-1,k?1:-1):U.updateFloat2("vClearCoatTangentSpaceParams",B?-1:1,k?-1:1)),this._tintTexture&&Z.e.ClearCoatTintTextureEnabled&&(U.updateFloat2("vClearCoatTintInfos",this._tintTexture.coordinatesIndex,this._tintTexture.level),(0,D.u)(this._tintTexture,U,"clearCoatTint")),U.updateFloat2("vClearCoatParams",this.bb,this.roughness);const M=1-this._indexOfRefraction,L=1+this._indexOfRefraction,s=Math.pow(-M/L,2),w=1/this._indexOfRefraction;U.updateFloat4("vClearCoatRefractionParams",s,w,M,L),this._isTintEnabled&&(U.updateFloat4("vClearCoatTintParams",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintThickness)),U.updateFloat("clearCoatColorAtDistance",Math.max(1e-5,this.tintColorAtDistance)))}W.texturesEnabled&&(this._texture&&Z.e.ClearCoatTextureEnabled&&U.setTexture("clearCoatSampler",this._texture),this._textureRoughness&&!t.CLEARCOAT_USE_ROUGHNESS_FROM_MAINTEXTURE&&Z.e.ClearCoatTextureEnabled&&U.setTexture("clearCoatRoughnessSampler",this._textureRoughness),this._bumpTexture&&l.getCaps().standardDerivatives&&Z.e.ClearCoatBumpTextureEnabled&&!p&&U.setTexture("clearCoatBumpSampler",this._bumpTexture),this._isTintEnabled&&this._tintTexture&&Z.e.ClearCoatTintTextureEnabled&&U.setTexture("clearCoatTintSampler",this._tintTexture))}hasTexture(U){return this._texture===U||(this._textureRoughness===U||(this._bumpTexture===U||this._tintTexture===U))}getActiveTextures(U){this._texture&&U.push(this._texture),this._textureRoughness&&U.push(this._textureRoughness),this._bumpTexture&&U.push(this._bumpTexture),this._tintTexture&&U.push(this._tintTexture)}getAnimatables(U){this._texture&&this._texture.animations&&this._texture.animations.length>0&&U.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&U.push(this._textureRoughness),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&U.push(this._bumpTexture),this._tintTexture&&this._tintTexture.animations&&this._tintTexture.animations.length>0&&U.push(this._tintTexture)}dispose(U){var W,l,M,t;U&&(null===(W=this._texture)||void 0===W||W.dispose(),null===(l=this._textureRoughness)||void 0===l||l.dispose(),null===(M=this._bumpTexture)||void 0===M||M.dispose(),null===(t=this._tintTexture)||void 0===t||t.dispose())}getClassName(){return"PBRClearCoatConfiguration"}addFallbacks(U,W,l){return U.CLEARCOAT_BUMP&&W.addFallback(l++,"CLEARCOAT_BUMP"),U.CLEARCOAT_TINT&&W.addFallback(l++,"CLEARCOAT_TINT"),U.CLEARCOAT&&W.addFallback(l++,"CLEARCOAT"),l}getSamplers(U){U.push("clearCoatSampler","clearCoatRoughnessSampler","clearCoatBumpSampler","clearCoatTintSampler")}getUniforms(){return{ubo:[{name:"vClearCoatParams",size:2,type:"vec2"},{name:"vClearCoatRefractionParams",size:4,type:"vec4"},{name:"vClearCoatInfos",size:4,type:"vec4"},{name:"clearCoatMatrix",size:16,type:"mat4"},{name:"clearCoatRoughnessMatrix",size:16,type:"mat4"},{name:"vClearCoatBumpInfos",size:2,type:"vec2"},{name:"vClearCoatTangentSpaceParams",size:2,type:"vec2"},{name:"clearCoatBumpMatrix",size:16,type:"mat4"},{name:"vClearCoatTintParams",size:4,type:"vec4"},{name:"clearCoatColorAtDistance",size:1,type:"float"},{name:"vClearCoatTintInfos",size:2,type:"vec2"},{name:"clearCoatTintMatrix",size:16,type:"mat4"}]}}}i._DefaultIndexOfRefraction=1.5,(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"isEnabled",void 0),(0,M.e)([(0,t.T)()],i.prototype,"intensity",void 0),(0,M.e)([(0,t.T)()],i.prototype,"roughness",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"indexOfRefraction",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"texture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useRoughnessFromMainTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"textureRoughness",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"remapF0OnInterfaceChange",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"bumpTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"isTintEnabled",void 0),(0,M.e)([(0,t.n)()],i.prototype,"tintColor",void 0),(0,M.e)([(0,t.T)()],i.prototype,"tintColorAtDistance",void 0),(0,M.e)([(0,t.T)()],i.prototype,"tintThickness",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"tintTexture",void 0);class O extends y.b{constructor(){super(...arguments),this.IRIDESCENCE=!1,this.IRIDESCENCE_TEXTURE=!1,this.IRIDESCENCE_TEXTUREDIRECTUV=0,this.IRIDESCENCE_THICKNESS_TEXTURE=!1,this.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0}}class e extends j.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"PBRIridescence",110,new O,W),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.minimumThickness=e._DefaultMinimumThickness,this.maximumThickness=e._DefaultMaximumThickness,this.indexOfRefraction=e._DefaultIndexOfRefraction,this._texture=null,this.texture=null,this._thicknessTexture=null,this.thicknessTexture=null,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1]}isReadyForSubMesh(U,W){if(!this._isEnabled)return!0;if(U._areTexturesDirty&&W.texturesEnabled){if(this._texture&&Z.e.IridescenceTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._thicknessTexture&&Z.e.IridescenceTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(U,W){this._isEnabled?(U.IRIDESCENCE=!0,U._areTexturesDirty&&W.texturesEnabled&&(this._texture&&Z.e.IridescenceTextureEnabled?(0,D.V)(this._texture,U,"IRIDESCENCE_TEXTURE"):U.IRIDESCENCE_TEXTURE=!1,this._thicknessTexture&&Z.e.IridescenceTextureEnabled?(0,D.V)(this._thicknessTexture,U,"IRIDESCENCE_THICKNESS_TEXTURE"):U.IRIDESCENCE_THICKNESS_TEXTURE=!1)):(U.IRIDESCENCE=!1,U.IRIDESCENCE_TEXTURE=!1,U.IRIDESCENCE_THICKNESS_TEXTURE=!1,U.IRIDESCENCE_TEXTUREDIRECTUV=0,U.IRIDESCENCE_THICKNESS_TEXTUREDIRECTUV=0)}bindForSubMesh(U,W){if(!this._isEnabled)return;const l=this._material.isFrozen;if(!U.useUbo||!l||!U.isSync){var M,t,L,p;if((this._texture||this._thicknessTexture)&&Z.e.IridescenceTextureEnabled)U.updateFloat4("vIridescenceInfos",(null===(M=this._texture)||void 0===M?void 0:M.coordinatesIndex)??0,(null===(t=this._texture)||void 0===t?void 0:t.level)??0,(null===(L=this._thicknessTexture)||void 0===L?void 0:L.coordinatesIndex)??0,(null===(p=this._thicknessTexture)||void 0===p?void 0:p.level)??0),this._texture&&(0,D.u)(this._texture,U,"iridescence"),this._thicknessTexture&&(0,D.u)(this._thicknessTexture,U,"iridescenceThickness");U.updateFloat4("vIridescenceParams",this.bb,this.indexOfRefraction,this.minimumThickness,this.maximumThickness)}W.texturesEnabled&&(this._texture&&Z.e.IridescenceTextureEnabled&&U.setTexture("iridescenceSampler",this._texture),this._thicknessTexture&&Z.e.IridescenceTextureEnabled&&U.setTexture("iridescenceThicknessSampler",this._thicknessTexture))}hasTexture(U){return this._texture===U||this._thicknessTexture===U}getActiveTextures(U){this._texture&&U.push(this._texture),this._thicknessTexture&&U.push(this._thicknessTexture)}getAnimatables(U){this._texture&&this._texture.animations&&this._texture.animations.length>0&&U.push(this._texture),this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&U.push(this._thicknessTexture)}dispose(U){var W,l;U&&(null===(W=this._texture)||void 0===W||W.dispose(),null===(l=this._thicknessTexture)||void 0===l||l.dispose())}getClassName(){return"PBRIridescenceConfiguration"}addFallbacks(U,W,l){return U.IRIDESCENCE&&W.addFallback(l++,"IRIDESCENCE"),l}getSamplers(U){U.push("iridescenceSampler","iridescenceThicknessSampler")}getUniforms(){return{ubo:[{name:"vIridescenceParams",size:4,type:"vec4"},{name:"vIridescenceInfos",size:4,type:"vec4"},{name:"iridescenceMatrix",size:16,type:"mat4"},{name:"iridescenceThicknessMatrix",size:16,type:"mat4"}]}}}e._DefaultMinimumThickness=100,e._DefaultMaximumThickness=400,e._DefaultIndexOfRefraction=1.3,(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"isEnabled",void 0),(0,M.e)([(0,t.T)()],e.prototype,"intensity",void 0),(0,M.e)([(0,t.T)()],e.prototype,"minimumThickness",void 0),(0,M.e)([(0,t.T)()],e.prototype,"maximumThickness",void 0),(0,M.e)([(0,t.T)()],e.prototype,"indexOfRefraction",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"texture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],e.prototype,"thicknessTexture",void 0);class d extends y.b{constructor(){super(...arguments),this.ANISOTROPIC=!1,this.ANISOTROPIC_TEXTURE=!1,this.ANISOTROPIC_TEXTUREDIRECTUV=0,this.ANISOTROPIC_LEGACY=!1,this.MAINUV1=!1}}class H extends j.c{set angle(U){this.direction.x=Math.cos(U),this.direction.y=Math.sin(U)}get angle(){return Math.atan2(this.direction.y,this.direction.x)}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markAllSubMeshesAsMiscDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsMiscDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"PBRAnisotropic",110,new d,W),this._isEnabled=!1,this.isEnabled=!1,this.bb=1,this.direction=new A.h(1,0),this._texture=null,this.texture=null,this._legacy=!1,this.legacy=!1,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1],this._internalMarkAllSubMeshesAsMiscDirty=U._dirtyCallbacks[16]}isReadyForSubMesh(U,W){return!this._isEnabled||!(U._areTexturesDirty&&W.texturesEnabled&&this._texture&&Z.e.AnisotropicTextureEnabled&&!this._texture.isReadyOrNotBlocking())}prepareDefinesBeforeAttributes(U,W,l){this._isEnabled?(U.ANISOTROPIC=this._isEnabled,this._isEnabled&&!l.isVerticesDataPresent(q.e.TangentKind)&&(U._needUVs=!0,U.MAINUV1=!0),U._areTexturesDirty&&W.texturesEnabled&&(this._texture&&Z.e.AnisotropicTextureEnabled?(0,D.V)(this._texture,U,"ANISOTROPIC_TEXTURE"):U.ANISOTROPIC_TEXTURE=!1),U._areMiscDirty&&(U.ANISOTROPIC_LEGACY=this._legacy)):(U.ANISOTROPIC=!1,U.ANISOTROPIC_TEXTURE=!1,U.ANISOTROPIC_TEXTUREDIRECTUV=0,U.ANISOTROPIC_LEGACY=!1)}bindForSubMesh(U,W){if(!this._isEnabled)return;const l=this._material.isFrozen;U.useUbo&&l&&U.isSync||(this._texture&&Z.e.AnisotropicTextureEnabled&&(U.updateFloat2("vAnisotropyInfos",this._texture.coordinatesIndex,this._texture.level),(0,D.u)(this._texture,U,"anisotropy")),U.updateFloat3("vAnisotropy",this.direction.x,this.direction.y,this.bb)),W.texturesEnabled&&this._texture&&Z.e.AnisotropicTextureEnabled&&U.setTexture("anisotropySampler",this._texture)}hasTexture(U){return this._texture===U}getActiveTextures(U){this._texture&&U.push(this._texture)}getAnimatables(U){this._texture&&this._texture.animations&&this._texture.animations.length>0&&U.push(this._texture)}dispose(U){U&&this._texture&&this._texture.dispose()}getClassName(){return"PBRAnisotropicConfiguration"}addFallbacks(U,W,l){return U.ANISOTROPIC&&W.addFallback(l++,"ANISOTROPIC"),l}getSamplers(U){U.push("anisotropySampler")}getUniforms(){return{ubo:[{name:"vAnisotropy",size:3,type:"vec3"},{name:"vAnisotropyInfos",size:2,type:"vec2"},{name:"anisotropyMatrix",size:16,type:"mat4"}]}}parse(U,W,l){super.parse(U,W,l),void 0===U.legacy&&(this.legacy=!0)}}(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],H.prototype,"isEnabled",void 0),(0,M.e)([(0,t.T)()],H.prototype,"intensity",void 0),(0,M.e)([(0,t.O)()],H.prototype,"direction",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],H.prototype,"texture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],H.prototype,"legacy",void 0);class V extends y.b{constructor(){super(...arguments),this.SHEEN=!1,this.SHEEN_TEXTURE=!1,this.SHEEN_GAMMATEXTURE=!1,this.SHEEN_TEXTURE_ROUGHNESS=!1,this.SHEEN_TEXTUREDIRECTUV=0,this.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0,this.SHEEN_LINKWITHALBEDO=!1,this.SHEEN_ROUGHNESS=!1,this.SHEEN_ALBEDOSCALING=!1,this.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1}}class n extends j.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"Sheen",120,new V,W),this._isEnabled=!1,this.isEnabled=!1,this._linkSheenWithAlbedo=!1,this.linkSheenWithAlbedo=!1,this.bb=1,this.color=r.e.White(),this._texture=null,this.texture=null,this._useRoughnessFromMainTexture=!0,this.useRoughnessFromMainTexture=!0,this._roughness=null,this.roughness=null,this._textureRoughness=null,this.textureRoughness=null,this._albedoScaling=!1,this.albedoScaling=!1,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1]}isReadyForSubMesh(U,W){if(!this._isEnabled)return!0;if(U._areTexturesDirty&&W.texturesEnabled){if(this._texture&&Z.e.SheenTextureEnabled&&!this._texture.isReadyOrNotBlocking())return!1;if(this._textureRoughness&&Z.e.SheenTextureEnabled&&!this._textureRoughness.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(U,W){this._isEnabled?(U.SHEEN=!0,U.SHEEN_LINKWITHALBEDO=this._linkSheenWithAlbedo,U.SHEEN_ROUGHNESS=null!==this._roughness,U.SHEEN_ALBEDOSCALING=this._albedoScaling,U.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=this._useRoughnessFromMainTexture,U._areTexturesDirty&&W.texturesEnabled&&(this._texture&&Z.e.SheenTextureEnabled?((0,D.V)(this._texture,U,"SHEEN_TEXTURE"),U.SHEEN_GAMMATEXTURE=this._texture.gammaSpace):U.SHEEN_TEXTURE=!1,this._textureRoughness&&Z.e.SheenTextureEnabled?(0,D.V)(this._textureRoughness,U,"SHEEN_TEXTURE_ROUGHNESS"):U.SHEEN_TEXTURE_ROUGHNESS=!1)):(U.SHEEN=!1,U.SHEEN_TEXTURE=!1,U.SHEEN_TEXTURE_ROUGHNESS=!1,U.SHEEN_LINKWITHALBEDO=!1,U.SHEEN_ROUGHNESS=!1,U.SHEEN_ALBEDOSCALING=!1,U.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE=!1,U.SHEEN_GAMMATEXTURE=!1,U.SHEEN_TEXTUREDIRECTUV=0,U.SHEEN_TEXTURE_ROUGHNESSDIRECTUV=0)}bindForSubMesh(U,W,l,M){if(!this._isEnabled)return;const t=M.materialDefines,L=this._material.isFrozen;if(!U.useUbo||!L||!U.isSync){var p,B,k,A;if((this._texture||this._textureRoughness)&&Z.e.SheenTextureEnabled)U.updateFloat4("vSheenInfos",(null===(p=this._texture)||void 0===p?void 0:p.coordinatesIndex)??0,(null===(B=this._texture)||void 0===B?void 0:B.level)??0,(null===(k=this._textureRoughness)||void 0===k?void 0:k.coordinatesIndex)??0,(null===(A=this._textureRoughness)||void 0===A?void 0:A.level)??0),this._texture&&(0,D.u)(this._texture,U,"sheen"),this._textureRoughness&&!t.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&(0,D.u)(this._textureRoughness,U,"sheenRoughness");U.updateFloat4("vSheenColor",this.color.r,this.color.g,this.color.b,this.bb),null!==this._roughness&&U.updateFloat("vSheenRoughness",this._roughness)}W.texturesEnabled&&(this._texture&&Z.e.SheenTextureEnabled&&U.setTexture("sheenSampler",this._texture),this._textureRoughness&&!t.SHEEN_USE_ROUGHNESS_FROM_MAINTEXTURE&&Z.e.SheenTextureEnabled&&U.setTexture("sheenRoughnessSampler",this._textureRoughness))}hasTexture(U){return this._texture===U||this._textureRoughness===U}getActiveTextures(U){this._texture&&U.push(this._texture),this._textureRoughness&&U.push(this._textureRoughness)}getAnimatables(U){this._texture&&this._texture.animations&&this._texture.animations.length>0&&U.push(this._texture),this._textureRoughness&&this._textureRoughness.animations&&this._textureRoughness.animations.length>0&&U.push(this._textureRoughness)}dispose(U){var W,l;U&&(null===(W=this._texture)||void 0===W||W.dispose(),null===(l=this._textureRoughness)||void 0===l||l.dispose())}getClassName(){return"PBRSheenConfiguration"}addFallbacks(U,W,l){return U.SHEEN&&W.addFallback(l++,"SHEEN"),l}getSamplers(U){U.push("sheenSampler","sheenRoughnessSampler")}getUniforms(){return{ubo:[{name:"vSheenColor",size:4,type:"vec4"},{name:"vSheenRoughness",size:1,type:"float"},{name:"vSheenInfos",size:4,type:"vec4"},{name:"sheenMatrix",size:16,type:"mat4"},{name:"sheenRoughnessMatrix",size:16,type:"mat4"}]}}}(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"isEnabled",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"linkSheenWithAlbedo",void 0),(0,M.e)([(0,t.T)()],n.prototype,"intensity",void 0),(0,M.e)([(0,t.n)()],n.prototype,"color",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"texture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"useRoughnessFromMainTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"roughness",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"textureRoughness",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],n.prototype,"albedoScaling",void 0);class x extends y.b{constructor(){super(...arguments),this.SUBSURFACE=!1,this.SS_REFRACTION=!1,this.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_TRANSLUCENCY=!1,this.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,this.SS_SCATTERING=!1,this.SS_DISPERSION=!1,this.SS_THICKNESSANDMASK_TEXTURE=!1,this.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,this.SS_HAS_THICKNESS=!1,this.SS_REFRACTIONINTENSITY_TEXTURE=!1,this.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,this.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,this.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0,this.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=!1,this.SS_REFRACTIONMAP_3D=!1,this.SS_REFRACTIONMAP_OPPOSITEZ=!1,this.SS_LODINREFRACTIONALPHA=!1,this.SS_GAMMAREFRACTION=!1,this.SS_RGBDREFRACTION=!1,this.SS_LINEARSPECULARREFRACTION=!1,this.SS_LINKREFRACTIONTOTRANSPARENCY=!1,this.SS_ALBEDOFORREFRACTIONTINT=!1,this.SS_ALBEDOFORTRANSLUCENCYTINT=!1,this.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.SS_USE_THICKNESS_AS_DEPTH=!1,this.SS_USE_GLTF_TEXTURES=!1,this.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=!1,this.SS_TRANSLUCENCY_LEGACY=!1}}class I extends j.c{get scatteringDiffusionProfile(){return this._scene.subSurfaceConfiguration?this._scene.subSurfaceConfiguration.ssDiffusionProfileColors[this._scatteringDiffusionProfileIndex]:null}set scatteringDiffusionProfile(U){this._scene.enableSubSurfaceForPrePass()&&U&&(this._scatteringDiffusionProfileIndex=this._scene.subSurfaceConfiguration.addDiffusionProfile(U))}get volumeIndexOfRefraction(){return this._volumeIndexOfRefraction>=1?this._volumeIndexOfRefraction:this._indexOfRefraction}set volumeIndexOfRefraction(U){this._volumeIndexOfRefraction=U>=1?U:-1}_markAllSubMeshesAsTexturesDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}_markScenePrePassDirty(){this._enable(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled),this._internalMarkAllSubMeshesAsTexturesDirty(),this._internalMarkScenePrePassDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"PBRSubSurface",130,new x,W),this._isRefractionEnabled=!1,this.isRefractionEnabled=!1,this._isTranslucencyEnabled=!1,this.isTranslucencyEnabled=!1,this._isDispersionEnabled=!1,this.isDispersionEnabled=!1,this._isScatteringEnabled=!1,this.isScatteringEnabled=!1,this._scatteringDiffusionProfileIndex=0,this.refractionIntensity=1,this.translucencyIntensity=1,this.useAlbedoToTintRefraction=!1,this.useAlbedoToTintTranslucency=!1,this._thicknessTexture=null,this.thicknessTexture=null,this._refractionTexture=null,this.refractionTexture=null,this._indexOfRefraction=1.5,this.indexOfRefraction=1.5,this._volumeIndexOfRefraction=-1,this._invertRefractionY=!1,this.invertRefractionY=!1,this._linkRefractionWithTransparency=!1,this.linkRefractionWithTransparency=!1,this.minimumThickness=0,this.maximumThickness=1,this.useThicknessAsDepth=!1,this.tintColor=r.e.White(),this.tintColorAtDistance=1,this.dispersion=0,this.diffusionDistance=r.e.White(),this._useMaskFromThicknessTexture=!1,this.useMaskFromThicknessTexture=!1,this._refractionIntensityTexture=null,this.refractionIntensityTexture=null,this._translucencyIntensityTexture=null,this.translucencyIntensityTexture=null,this.translucencyColor=null,this._translucencyColorTexture=null,this.translucencyColorTexture=null,this._useGltfStyleTextures=!0,this.useGltfStyleTextures=!0,this.applyAlbedoAfterSubSurface=I.DEFAULT_APPLY_ALBEDO_AFTERSUBSURFACE,this.legacyTransluceny=I.DEFAULT_LEGACY_TRANSLUCENCY,this._scene=U.va(),this.registerForExtraEvents=!0,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1],this._internalMarkScenePrePassDirty=U._dirtyCallbacks[32]}isReadyForSubMesh(U,W){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return!0;if(U._areTexturesDirty&&W.texturesEnabled){if(this._thicknessTexture&&Z.e.ThicknessTextureEnabled&&!this._thicknessTexture.isReadyOrNotBlocking())return!1;if(this._translucencyColorTexture&&Z.e.TranslucencyColorTextureEnabled&&!this._translucencyColorTexture.isReadyOrNotBlocking())return!1;if(this._translucencyIntensityTexture&&Z.e.TranslucencyIntensityTextureEnabled&&!this._translucencyIntensityTexture.isReadyOrNotBlocking())return!1;const U=this._getRefractionTexture(W);if(U&&Z.e.RefractionTextureEnabled&&!U.isReadyOrNotBlocking())return!1}return!0}prepareDefinesBeforeAttributes(U,W){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return U.SUBSURFACE=!1,U.SS_DISPERSION=!1,U.SS_TRANSLUCENCY=!1,U.SS_SCATTERING=!1,U.SS_REFRACTION=!1,U.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,U.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,U.SS_THICKNESSANDMASK_TEXTURE=!1,U.SS_THICKNESSANDMASK_TEXTUREDIRECTUV=0,U.SS_HAS_THICKNESS=!1,U.SS_REFRACTIONINTENSITY_TEXTURE=!1,U.SS_REFRACTIONINTENSITY_TEXTUREDIRECTUV=0,U.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,U.SS_TRANSLUCENCYINTENSITY_TEXTUREDIRECTUV=0,U.SS_REFRACTIONMAP_3D=!1,U.SS_REFRACTIONMAP_OPPOSITEZ=!1,U.SS_LODINREFRACTIONALPHA=!1,U.SS_GAMMAREFRACTION=!1,U.SS_RGBDREFRACTION=!1,U.SS_LINEARSPECULARREFRACTION=!1,U.SS_LINKREFRACTIONTOTRANSPARENCY=!1,U.SS_ALBEDOFORREFRACTIONTINT=!1,U.SS_ALBEDOFORTRANSLUCENCYTINT=!1,U.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,U.SS_USE_THICKNESS_AS_DEPTH=!1,U.SS_USE_GLTF_TEXTURES=!1,U.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,U.SS_TRANSLUCENCYCOLOR_TEXTUREDIRECTUV=0,U.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=!1,void(U.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=!1);if(U._areTexturesDirty){if(U.SUBSURFACE=!0,U.SS_DISPERSION=this._isDispersionEnabled,U.SS_TRANSLUCENCY=this._isTranslucencyEnabled,U.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=!1,U.SS_TRANSLUCENCY_LEGACY=this.legacyTransluceny,U.SS_SCATTERING=this._isScatteringEnabled,U.SS_THICKNESSANDMASK_TEXTURE=!1,U.SS_REFRACTIONINTENSITY_TEXTURE=!1,U.SS_TRANSLUCENCYINTENSITY_TEXTURE=!1,U.SS_HAS_THICKNESS=!1,U.SS_USE_GLTF_TEXTURES=!1,U.SS_REFRACTION=!1,U.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=!1,U.SS_REFRACTIONMAP_3D=!1,U.SS_GAMMAREFRACTION=!1,U.SS_RGBDREFRACTION=!1,U.SS_LINEARSPECULARREFRACTION=!1,U.SS_REFRACTIONMAP_OPPOSITEZ=!1,U.SS_LODINREFRACTIONALPHA=!1,U.SS_LINKREFRACTIONTOTRANSPARENCY=!1,U.SS_ALBEDOFORREFRACTIONTINT=!1,U.SS_ALBEDOFORTRANSLUCENCYTINT=!1,U.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=!1,U.SS_USE_THICKNESS_AS_DEPTH=!1,U.SS_TRANSLUCENCYCOLOR_TEXTURE=!1,U.SS_APPLY_ALBEDO_AFTER_SUBSURFACE=this.applyAlbedoAfterSubSurface,U._areTexturesDirty&&W.texturesEnabled&&(this._thicknessTexture&&Z.e.ThicknessTextureEnabled&&(0,D.V)(this._thicknessTexture,U,"SS_THICKNESSANDMASK_TEXTURE"),this._refractionIntensityTexture&&Z.e.RefractionIntensityTextureEnabled&&(0,D.V)(this._refractionIntensityTexture,U,"SS_REFRACTIONINTENSITY_TEXTURE"),this._translucencyIntensityTexture&&Z.e.TranslucencyIntensityTextureEnabled&&(0,D.V)(this._translucencyIntensityTexture,U,"SS_TRANSLUCENCYINTENSITY_TEXTURE"),this._translucencyColorTexture&&Z.e.TranslucencyColorTextureEnabled&&((0,D.V)(this._translucencyColorTexture,U,"SS_TRANSLUCENCYCOLOR_TEXTURE"),U.SS_TRANSLUCENCYCOLOR_TEXTURE_GAMMA=this._translucencyColorTexture.gammaSpace)),U.SS_HAS_THICKNESS=this.maximumThickness-this.minimumThickness!==0,U.SS_USE_GLTF_TEXTURES=this._useGltfStyleTextures,U.SS_REFRACTION_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._refractionIntensityTexture,U.SS_TRANSLUCENCY_USE_INTENSITY_FROM_THICKNESS=this._useMaskFromThicknessTexture&&!this._translucencyIntensityTexture,this._isRefractionEnabled&&W.texturesEnabled){const l=this._getRefractionTexture(W);l&&Z.e.RefractionTextureEnabled&&(U.SS_REFRACTION=!0,U.SS_REFRACTIONMAP_3D=l.isCube,U.SS_GAMMAREFRACTION=l.gammaSpace,U.SS_RGBDREFRACTION=l.isRGBD,U.SS_LINEARSPECULARREFRACTION=l.linearSpecularLOD,U.SS_REFRACTIONMAP_OPPOSITEZ=this._scene.useRightHandedSystem&&l.isCube?!l.invertZ:l.invertZ,U.SS_LODINREFRACTIONALPHA=l.lodLevelInAlpha,U.SS_LINKREFRACTIONTOTRANSPARENCY=this._linkRefractionWithTransparency,U.SS_ALBEDOFORREFRACTIONTINT=this.useAlbedoToTintRefraction,U.SS_USE_LOCAL_REFRACTIONMAP_CUBIC=l.isCube&&l.boundingBoxSize,U.SS_USE_THICKNESS_AS_DEPTH=this.useThicknessAsDepth)}this._isTranslucencyEnabled&&(U.SS_ALBEDOFORTRANSLUCENCYTINT=this.useAlbedoToTintTranslucency)}}hardBindForSubMesh(U,W,l,M){if(this._isRefractionEnabled||this._isTranslucencyEnabled||this._isScatteringEnabled)if(0===this.maximumThickness&&0===this.minimumThickness)U.updateFloat2("vThicknessParam",0,0);else{M.getRenderingMesh().getWorldMatrix().decompose(A.f.ik[0]);const W=Math.max(Math.abs(A.f.ik[0].x),Math.abs(A.f.ik[0].y),Math.abs(A.f.ik[0].z));U.updateFloat2("vThicknessParam",this.minimumThickness*W,(this.maximumThickness-this.minimumThickness)*W)}}bindForSubMesh(U,W,l,M){if(!this._isRefractionEnabled&&!this._isTranslucencyEnabled&&!this._isScatteringEnabled)return;const t=M.materialDefines,L=this._material.isFrozen,p=this._material.realTimeFiltering,B=t.LODBASEDMICROSFURACE,k=this._getRefractionTexture(W);if(!U.useUbo||!L||!U.isSync){if(this._thicknessTexture&&Z.e.ThicknessTextureEnabled&&(U.updateFloat2("vThicknessInfos",this._thicknessTexture.coordinatesIndex,this._thicknessTexture.level),(0,D.u)(this._thicknessTexture,U,"thickness")),this._refractionIntensityTexture&&Z.e.RefractionIntensityTextureEnabled&&t.SS_REFRACTIONINTENSITY_TEXTURE&&(U.updateFloat2("vRefractionIntensityInfos",this._refractionIntensityTexture.coordinatesIndex,this._refractionIntensityTexture.level),(0,D.u)(this._refractionIntensityTexture,U,"refractionIntensity")),this._translucencyColorTexture&&Z.e.TranslucencyColorTextureEnabled&&t.SS_TRANSLUCENCYCOLOR_TEXTURE&&(U.updateFloat2("vTranslucencyColorInfos",this._translucencyColorTexture.coordinatesIndex,this._translucencyColorTexture.level),(0,D.u)(this._translucencyColorTexture,U,"translucencyColor")),this._translucencyIntensityTexture&&Z.e.TranslucencyIntensityTextureEnabled&&t.SS_TRANSLUCENCYINTENSITY_TEXTURE&&(U.updateFloat2("vTranslucencyIntensityInfos",this._translucencyIntensityTexture.coordinatesIndex,this._translucencyIntensityTexture.level),(0,D.u)(this._translucencyIntensityTexture,U,"translucencyIntensity")),k&&Z.e.RefractionTextureEnabled){U.wk("refractionMatrix",k.getRefractionTextureMatrix());let W=1;k.isCube||k.depth&&(W=k.depth);const l=k.getSize().width,M=this.volumeIndexOfRefraction;if(U.updateFloat4("vRefractionInfos",k.level,1/M,W,this._invertRefractionY?-1:1),U.updateFloat4("vRefractionMicrosurfaceInfos",l,k.lodGenerationScale,k.lodGenerationOffset,1/this.indexOfRefraction),p&&U.updateFloat2("vRefractionFilteringInfo",l,Math.log2(l)),k.boundingBoxSize){const W=k;U.updateVector3("vRefractionPosition",W.boundingBoxPosition),U.updateVector3("vRefractionSize",W.boundingBoxSize)}}this._isScatteringEnabled&&U.updateFloat("scatteringDiffusionProfile",this._scatteringDiffusionProfileIndex),U.updateColor3("vDiffusionDistance",this.diffusionDistance),U.updateFloat4("vTintColor",this.tintColor.r,this.tintColor.g,this.tintColor.b,Math.max(1e-5,this.tintColorAtDistance)),U.updateColor4("vTranslucencyColor",this.translucencyColor??this.tintColor,0),U.updateFloat3("vSubSurfaceIntensity",this.refractionIntensity,this.translucencyIntensity,0),U.updateFloat("dispersion",this.dispersion)}W.texturesEnabled&&(this._thicknessTexture&&Z.e.ThicknessTextureEnabled&&U.setTexture("thicknessSampler",this._thicknessTexture),this._refractionIntensityTexture&&Z.e.RefractionIntensityTextureEnabled&&t.SS_REFRACTIONINTENSITY_TEXTURE&&U.setTexture("refractionIntensitySampler",this._refractionIntensityTexture),this._translucencyIntensityTexture&&Z.e.TranslucencyIntensityTextureEnabled&&t.SS_TRANSLUCENCYINTENSITY_TEXTURE&&U.setTexture("translucencyIntensitySampler",this._translucencyIntensityTexture),this._translucencyColorTexture&&Z.e.TranslucencyColorTextureEnabled&&t.SS_TRANSLUCENCYCOLOR_TEXTURE&&U.setTexture("translucencyColorSampler",this._translucencyColorTexture),k&&Z.e.RefractionTextureEnabled&&(B?U.setTexture("refractionSampler",k):(U.setTexture("refractionSampler",k._lodTextureMid||k),U.setTexture("refractionSamplerLow",k._lodTextureLow||k),U.setTexture("refractionSamplerHigh",k._lodTextureHigh||k))))}_getRefractionTexture(U){return this._refractionTexture?this._refractionTexture:this._isRefractionEnabled?U.environmentTexture:null}get disableAlphaBlending(){return this._isRefractionEnabled&&this._linkRefractionWithTransparency}fillRenderTargetTextures(U){Z.e.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&U.push(this._refractionTexture)}hasTexture(U){return this._thicknessTexture===U||(this._refractionTexture===U||(this._refractionIntensityTexture===U||(this._translucencyIntensityTexture===U||this._translucencyColorTexture===U)))}hasRenderTargetTextures(){return!!(Z.e.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)}getActiveTextures(U){this._thicknessTexture&&U.push(this._thicknessTexture),this._refractionTexture&&U.push(this._refractionTexture),this._translucencyColorTexture&&U.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&U.push(this._translucencyIntensityTexture)}getAnimatables(U){this._thicknessTexture&&this._thicknessTexture.animations&&this._thicknessTexture.animations.length>0&&U.push(this._thicknessTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&U.push(this._refractionTexture),this._translucencyColorTexture&&this._translucencyColorTexture.animations&&this._translucencyColorTexture.animations.length>0&&U.push(this._translucencyColorTexture),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.animations&&this._translucencyIntensityTexture.animations.length>0&&U.push(this._translucencyIntensityTexture)}dispose(U){U&&(this._thicknessTexture&&this._thicknessTexture.dispose(),this._refractionTexture&&this._refractionTexture.dispose(),this._translucencyColorTexture&&this._translucencyColorTexture.dispose(),this._translucencyIntensityTexture&&this._translucencyIntensityTexture.dispose())}getClassName(){return"PBRSubSurfaceConfiguration"}addFallbacks(U,W,l){return U.SS_SCATTERING&&W.addFallback(l++,"SS_SCATTERING"),U.SS_TRANSLUCENCY&&W.addFallback(l++,"SS_TRANSLUCENCY"),l}getSamplers(U){U.push("thicknessSampler","refractionIntensitySampler","translucencyIntensitySampler","refractionSampler","refractionSamplerLow","refractionSamplerHigh","translucencyColorSampler")}getUniforms(){return{ubo:[{name:"vRefractionMicrosurfaceInfos",size:4,type:"vec4"},{name:"vRefractionFilteringInfo",size:2,type:"vec2"},{name:"vTranslucencyIntensityInfos",size:2,type:"vec2"},{name:"vRefractionInfos",size:4,type:"vec4"},{name:"refractionMatrix",size:16,type:"mat4"},{name:"vThicknessInfos",size:2,type:"vec2"},{name:"vRefractionIntensityInfos",size:2,type:"vec2"},{name:"thicknessMatrix",size:16,type:"mat4"},{name:"refractionIntensityMatrix",size:16,type:"mat4"},{name:"translucencyIntensityMatrix",size:16,type:"mat4"},{name:"vThicknessParam",size:2,type:"vec2"},{name:"vDiffusionDistance",size:3,type:"vec3"},{name:"vTintColor",size:4,type:"vec4"},{name:"vSubSurfaceIntensity",size:3,type:"vec3"},{name:"vRefractionPosition",size:3,type:"vec3"},{name:"vRefractionSize",size:3,type:"vec3"},{name:"scatteringDiffusionProfile",size:1,type:"float"},{name:"dispersion",size:1,type:"float"},{name:"vTranslucencyColor",size:4,type:"vec4"},{name:"vTranslucencyColorInfos",size:2,type:"vec2"},{name:"translucencyColorMatrix",size:16,type:"mat4"}]}}}I.DEFAULT_APPLY_ALBEDO_AFTERSUBSURFACE=!1,I.DEFAULT_LEGACY_TRANSLUCENCY=!1,(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"isRefractionEnabled",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"isTranslucencyEnabled",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"isDispersionEnabled",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markScenePrePassDirty")],I.prototype,"isScatteringEnabled",void 0),(0,M.e)([(0,t.T)()],I.prototype,"_scatteringDiffusionProfileIndex",void 0),(0,M.e)([(0,t.T)()],I.prototype,"refractionIntensity",void 0),(0,M.e)([(0,t.T)()],I.prototype,"translucencyIntensity",void 0),(0,M.e)([(0,t.T)()],I.prototype,"useAlbedoToTintRefraction",void 0),(0,M.e)([(0,t.T)()],I.prototype,"useAlbedoToTintTranslucency",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"thicknessTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"refractionTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"indexOfRefraction",void 0),(0,M.e)([(0,t.T)()],I.prototype,"_volumeIndexOfRefraction",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"volumeIndexOfRefraction",null),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"invertRefractionY",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"linkRefractionWithTransparency",void 0),(0,M.e)([(0,t.T)()],I.prototype,"minimumThickness",void 0),(0,M.e)([(0,t.T)()],I.prototype,"maximumThickness",void 0),(0,M.e)([(0,t.T)()],I.prototype,"useThicknessAsDepth",void 0),(0,M.e)([(0,t.n)()],I.prototype,"tintColor",void 0),(0,M.e)([(0,t.T)()],I.prototype,"tintColorAtDistance",void 0),(0,M.e)([(0,t.T)()],I.prototype,"dispersion",void 0),(0,M.e)([(0,t.n)()],I.prototype,"diffusionDistance",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"useMaskFromThicknessTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"refractionIntensityTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"translucencyIntensityTexture",void 0),(0,M.e)([(0,t.n)()],I.prototype,"translucencyColor",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"translucencyColorTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],I.prototype,"useGltfStyleTextures",void 0),(0,M.e)([(0,t.T)()],I.prototype,"applyAlbedoAfterSubSurface",void 0),(0,M.e)([(0,t.T)()],I.prototype,"legacyTransluceny",void 0);var R=l(11840),F=l(868),v=l(11846);const J={effect:null,subMesh:null};class Q extends y.b{constructor(U){super(U),this.PBR=!0,this.NUM_SAMPLES="0",this.REALTIME_FILTERING=!1,this.IBL_CDF_FILTERING=!1,this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.ALBEDO=!1,this.GAMMAALBEDO=!1,this.ALBEDODIRECTUV=0,this.VERTEXCOLOR=!1,this.BASE_WEIGHT=!1,this.BASE_WEIGHTDIRECTUV=0,this.BASE_DIFFUSE_ROUGHNESS=!1,this.BASE_DIFFUSE_ROUGHNESSDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.AMBIENTINGRAYSCALE=!1,this.OPACITY=!1,this.VERTEXALPHA=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHABLEND=!1,this.ALPHAFROMALBEDO=!1,this.ALPHATESTVALUE="0.5",this.SPECULAROVERALPHA=!1,this.RADIANCEOVERALPHA=!1,this.ALPHAFRESNEL=!1,this.LINEARALPHAFRESNEL=!1,this.PREMULTIPLYALPHA=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.GAMMAEMISSIVE=!1,this.REFLECTIVITY=!1,this.REFLECTIVITY_GAMMA=!1,this.REFLECTIVITYDIRECTUV=0,this.SPECULARTERM=!1,this.MICROSURFACEFROMREFLECTIVITYMAP=!1,this.MICROSURFACEAUTOMATIC=!1,this.LODBASEDMICROSFURACE=!1,this.MICROSURFACEMAP=!1,this.MICROSURFACEMAPDIRECTUV=0,this.METALLICWORKFLOW=!1,this.ROUGHNESSSTOREINMETALMAPALPHA=!1,this.ROUGHNESSSTOREINMETALMAPGREEN=!1,this.METALLNESSSTOREINMETALMAPBLUE=!1,this.AOSTOREINMETALMAPRED=!1,this.METALLIC_REFLECTANCE=!1,this.METALLIC_REFLECTANCE_GAMMA=!1,this.METALLIC_REFLECTANCEDIRECTUV=0,this.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=!1,this.REFLECTANCE=!1,this.REFLECTANCE_GAMMA=!1,this.REFLECTANCEDIRECTUV=0,this.ENVIRONMENTBRDF=!1,this.ENVIRONMENTBRDF_RGBD=!1,this.NORMAL=!1,this.TANGENT=!1,this.BUMP=!1,this.BUMPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.NORMALXYSCALE=!0,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.USELIGHTMAPASSHADOWMAP=!1,this.GAMMALIGHTMAP=!1,this.RGBDLIGHTMAP=!1,this.REFLECTION=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.INVERTCUBICMAP=!1,this.USESPHERICALFROMREFLECTIONMAP=!1,this.USEIRRADIANCEMAP=!1,this.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,this.USESPHERICALINVERTEX=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.LODINREFLECTIONALPHA=!1,this.GAMMAREFLECTION=!1,this.RGBDREFLECTION=!1,this.LINEARSPECULARREFLECTION=!1,this.RADIANCEOCCLUSION=!1,this.HORIZONOCCLUSION=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.PREPASS=!1,this.PREPASS_COLOR=!1,this.PREPASS_COLOR_INDEX=-1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO=!1,this.PREPASS_ALBEDO_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_SCREENSPACE_DEPTH=!1,this.PREPASS_SCREENSPACE_DEPTH_INDEX=-1,this.PREPASS_NORMALIZED_VIEW_DEPTH=!1,this.PREPASS_NORMALIZED_VIEW_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.NONUNIFORMSCALING=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_POSITION=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.MORPHTARGETS_UV2=!1,this.MORPHTARGETS_COLOR=!1,this.MORPHTARGETTEXTURE_HASPOSITIONS=!1,this.MORPHTARGETTEXTURE_HASNORMALS=!1,this.MORPHTARGETTEXTURE_HASTANGENTS=!1,this.MORPHTARGETTEXTURE_HASUVS=!1,this.MORPHTARGETTEXTURE_HASUV2S=!1,this.MORPHTARGETTEXTURE_HASCOLORS=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.EXPOSURE=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.USEPHYSICALLIGHTFALLOFF=!1,this.USEGLTFLIGHTFALLOFF=!1,this.TWOSIDEDLIGHTING=!1,this.MIRRORED=!1,this.SHADOWFLOAT=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.POINTSIZE=!1,this.FOG=!1,this.LOGARITHMICDEPTH=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.AREALIGHTSUPPORTED=!0,this.FORCENORMALFORWARD=!1,this.SPECULARAA=!1,this.UNLIT=!1,this.DECAL_AFTER_DETAIL=!1,this.DEBUGMODE=0,this.rebuild()}reset(){super.reset(),this.ALPHATESTVALUE="0.5",this.PBR=!0,this.NORMALXYSCALE=!0}}class G extends g.d{get realTimeFiltering(){return this._realTimeFiltering}set realTimeFiltering(U){this._realTimeFiltering=U,this.ek(1)}get realTimeFilteringQuality(){return this._realTimeFilteringQuality}set realTimeFilteringQuality(U){this._realTimeFilteringQuality=U,this.ek(1)}get canRenderToMRT(){return!0}_attachImageProcessingConfiguration(U){U!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=U||this.va().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}constructor(U,W){super(U,W,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]||G.ForceGLSL),this._directIntensity=1,this._emissiveIntensity=1,this._environmentIntensity=1,this._specularIntensity=1,this._lightingInfos=new A.p(this._directIntensity,this._emissiveIntensity,this._environmentIntensity,this._specularIntensity),this._disableBumpMap=!1,this._albedoTexture=null,this._baseWeightTexture=null,this._baseDiffuseRoughnessTexture=null,this._ambientTexture=null,this._ambientTextureStrength=1,this._ambientTextureImpactOnAnalyticalLights=G.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._reflectivityTexture=null,this._metallicTexture=null,this._metallic=null,this._roughness=null,this._metallicF0Factor=1,this._metallicReflectanceColor=r.e.White(),this._useOnlyMetallicFromMetallicReflectanceTexture=!1,this._metallicReflectanceTexture=null,this._reflectanceTexture=null,this._microSurfaceTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._ambientColor=new r.e(0,0,0),this._albedoColor=new r.e(1,1,1),this._baseWeight=1,this._baseDiffuseRoughness=null,this._reflectivityColor=new r.e(1,1,1),this._reflectionColor=new r.e(1,1,1),this._emissiveColor=new r.e(0,0,0),this._microSurface=.9,this._useLightmapAsShadowmap=!1,this._useHorizonOcclusion=!0,this._useRadianceOcclusion=!0,this._useAlphaFromAlbedoTexture=!1,this._useSpecularOverAlpha=!0,this._useMicroSurfaceFromReflectivityMapAlpha=!1,this._useRoughnessFromMetallicTextureAlpha=!0,this._useRoughnessFromMetallicTextureGreen=!1,this._useMetallnessFromMetallicTextureBlue=!1,this._useAmbientOcclusionFromMetallicTextureRed=!1,this._useAmbientInGrayScale=!1,this._useAutoMicroSurfaceFromReflectivityMap=!1,this._lightFalloff=G.LIGHTFALLOFF_PHYSICAL,this._useRadianceOverAlpha=!0,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this._parallaxScaleBias=.05,this._disableLighting=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._alphaCutOff=.4,this._useAlphaFresnel=!1,this._useLinearAlphaFresnel=!1,this._environmentBRDFTexture=null,this._forceIrradianceInFragment=!1,this._realTimeFiltering=!1,this._realTimeFilteringQuality=8,this._forceNormalForward=!1,this._enableSpecularAntiAliasing=!1,this._imageProcessingObserver=null,this._renderTargets=new p.f(16),this._globalAmbientColor=new r.e(0,0,0),this._unlit=!1,this._applyDecalMapAfterDetailMap=!1,this._debugMode=0,this._shadersLoaded=!1,this._breakShaderLoadedCheck=!1,this.debugMode=0,this.debugLimit=-1,this.debugFactor=1,this._cacheHasRenderTargetTextures=!1,this.brdf=new w(this),this.clearCoat=new i(this),this.iridescence=new e(this),this.anisotropy=new H(this),this.sheen=new n(this),this.subSurface=new I(this),this.detailMap=new R.b(this),this._attachImageProcessingConfiguration(null),this.getRenderTargetTextures=()=>(this._renderTargets.reset(),Z.e.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets),this._environmentBRDFTexture=(0,B.c)(this.va()),this.prePassConfiguration=new K.b}get hasRenderTargetTextures(){return!!(Z.e.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures}get isPrePassCapable(){return!this.disableDepthWrite}getClassName(){return"PBRBaseMaterial"}get _disableAlphaBlending(){var U;return this._transparencyMode===G.PBRMATERIAL_OPAQUE||this._transparencyMode===G.PBRMATERIAL_ALPHATEST||(null===(U=this.subSurface)||void 0===U?void 0:U.disableAlphaBlending)}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromAlbedoTexture())}needAlphaTesting(){var U;return this._hasTransparencyMode?this._transparencyModeIsTest:(null===(U=this.subSurface)||void 0===U||!U.disableAlphaBlending)&&(this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===G.PBRMATERIAL_ALPHATEST))}_shouldUseAlphaFromAlbedoTexture(){return null!=this._albedoTexture&&this._albedoTexture.yi&&this._useAlphaFromAlbedoTexture&&this._transparencyMode!==G.PBRMATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._albedoTexture&&this._albedoTexture.yi||null!=this._opacityTexture}getAlphaTestTexture(){return this._albedoTexture}isReadyForSubMesh(U,W,l){this._uniformBufferLayoutBuilt||this.buildUniformLayout();const M=W._drawWrapper;if(M.effect&&this.isFrozen&&M._wasPreviouslyReady&&M._wasPreviouslyUsingInstances===l)return!0;W.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),W.materialDefines=new Q(this._eventInfo.defineNames));const t=W.materialDefines;if(this._isReadyForSubMesh(W))return!0;const p=this.va(),B=p.getEngine();if(t._areTexturesDirty&&(this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,p.texturesEnabled)){if(this._albedoTexture&&Z.e.DiffuseTextureEnabled&&!this._albedoTexture.isReadyOrNotBlocking())return!1;if(this._baseWeightTexture&&Z.e.BaseWeightTextureEnabled&&!this._baseWeightTexture.isReadyOrNotBlocking())return!1;if(this._baseDiffuseRoughnessTexture&&Z.e.BaseDiffuseRoughnessTextureEnabled&&!this._baseDiffuseRoughnessTexture.isReadyOrNotBlocking())return!1;if(this._ambientTexture&&Z.e.AmbientTextureEnabled&&!this._ambientTexture.isReadyOrNotBlocking())return!1;if(this._opacityTexture&&Z.e.OpacityTextureEnabled&&!this._opacityTexture.isReadyOrNotBlocking())return!1;const U=this._getReflectionTexture();if(U&&Z.e.ReflectionTextureEnabled){if(!U.isReadyOrNotBlocking())return!1;var k;if(U.irradianceTexture){if(!U.irradianceTexture.isReadyOrNotBlocking())return!1}else if(!U.sphericalPolynomial&&null!==(k=U.getInternalTexture())&&void 0!==k&&k._sphericalPolynomialPromise)return!1}if(this._lightmapTexture&&Z.e.LightmapTextureEnabled&&!this._lightmapTexture.isReadyOrNotBlocking())return!1;if(this._emissiveTexture&&Z.e.EmissiveTextureEnabled&&!this._emissiveTexture.isReadyOrNotBlocking())return!1;if(Z.e.SpecularTextureEnabled){if(this._metallicTexture){if(!this._metallicTexture.isReadyOrNotBlocking())return!1}else if(this._reflectivityTexture&&!this._reflectivityTexture.isReadyOrNotBlocking())return!1;if(this._metallicReflectanceTexture&&!this._metallicReflectanceTexture.isReadyOrNotBlocking())return!1;if(this._reflectanceTexture&&!this._reflectanceTexture.isReadyOrNotBlocking())return!1;if(this._microSurfaceTexture&&!this._microSurfaceTexture.isReadyOrNotBlocking())return!1}if(B.getCaps().standardDerivatives&&this._bumpTexture&&Z.e.BumpTextureEnabled&&!this._disableBumpMap&&!this._bumpTexture.isReady())return!1;if(this._environmentBRDFTexture&&Z.e.ReflectionTextureEnabled&&!this._environmentBRDFTexture.isReady())return!1}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=t,this._eventInfo.subMesh=W,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(t._areImageProcessingDirty&&this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.isReady())return!1;if(t.AREALIGHTUSED)for(let L=0;L<U.lightSources.length;L++)if(!U.lightSources[L]._isReady())return!1;B.getCaps().standardDerivatives||U.isVerticesDataPresent(q.e.NormalKind)||(U.createNormals(!0),L.b.Warn("PBRMaterial: Normals have been created for the mesh: "+U.name));const A=W.effect,y=t._areLightsDisposed;let j=this._prepareEffect(U,t,this.onCompiled,this.onError,l,null,W.getRenderingMesh().hasThinInstances),s=!1;if(j)if(this._onEffectCreatedObservable&&(J.effect=j,J.subMesh=W,this._onEffectCreatedObservable.notifyObservers(J)),this.allowShaderHotSwapping&&A&&!j.isReady()){if(j=A,t.markAsUnprocessed(),s=this.isFrozen,y)return t._areLightsDisposed=!0,!1}else p.resetCachedMaterial(),W.setEffect(j,t,this._materialContext);return!(!W.effect||!W.effect.isReady())&&(t._renderId=p.getRenderId(),M._wasPreviouslyReady=!s,M._wasPreviouslyUsingInstances=!!l,this._checkScenePerformancePriority(),!0)}isMetallicWorkflow(){return!(null==this._metallic&&null==this._roughness&&!this._metallicTexture)}_prepareEffect(U,W){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,B=arguments.length>6?arguments[6]:void 0;if(this._prepareDefines(U,W,L,p,B),!W.isDirty)return null;W.markAsProcessed();const k=this.va().getEngine(),A=new N.e;let y=0;W.USESPHERICALINVERTEX&&A.addFallback(y++,"USESPHERICALINVERTEX"),W.FOG&&A.addFallback(y,"FOG"),W.SPECULARAA&&A.addFallback(y,"SPECULARAA"),W.POINTSIZE&&A.addFallback(y,"POINTSIZE"),W.LOGARITHMICDEPTH&&A.addFallback(y,"LOGARITHMICDEPTH"),W.PARALLAX&&A.addFallback(y,"PARALLAX"),W.PARALLAX_RHS&&A.addFallback(y,"PARALLAX_RHS"),W.PARALLAXOCCLUSION&&A.addFallback(y++,"PARALLAXOCCLUSION"),W.ENVIRONMENTBRDF&&A.addFallback(y++,"ENVIRONMENTBRDF"),W.TANGENT&&A.addFallback(y++,"TANGENT"),W.BUMP&&A.addFallback(y++,"BUMP"),y=(0,D.x)(W,A,this._maxSimultaneousLights,y++),W.SPECULARTERM&&A.addFallback(y++,"SPECULARTERM"),W.USESPHERICALFROMREFLECTIONMAP&&A.addFallback(y++,"USESPHERICALFROMREFLECTIONMAP"),W.USEIRRADIANCEMAP&&A.addFallback(y++,"USEIRRADIANCEMAP"),W.LIGHTMAP&&A.addFallback(y++,"LIGHTMAP"),W.NORMAL&&A.addFallback(y++,"NORMAL"),W.AMBIENT&&A.addFallback(y++,"AMBIENT"),W.EMISSIVE&&A.addFallback(y++,"EMISSIVE"),W.VERTEXCOLOR&&A.addFallback(y++,"VERTEXCOLOR"),W.MORPHTARGETS&&A.addFallback(y++,"MORPHTARGETS"),W.MULTIVIEW&&A.addFallback(0,"MULTIVIEW");const j=[q.e.PositionKind];W.NORMAL&&j.push(q.e.NormalKind),W.TANGENT&&j.push(q.e.TangentKind);for(let l=1;l<=6;++l)W["UV"+l]&&j.push(`uv${1===l?"":l}`);W.VERTEXCOLOR&&j.push(q.e.ColorKind),(0,D.D)(j,U,W,A),(0,D.H)(j,W),(0,D.J)(j,U,W),(0,D.B)(j,U,W);let s="pbr";const w=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vAlbedoColor","baseWeight","baseDiffuseRoughness","vReflectivityColor","vMetallicReflectanceFactors","vEmissiveColor","visibility","vReflectionColor","vFogInfos","vFogColor","pointSize","vAlbedoInfos","vBaseWeightInfos","vBaseDiffuseRoughnessInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vReflectionPosition","vReflectionSize","vEmissiveInfos","vReflectivityInfos","vReflectionFilteringInfo","vMetallicReflectanceInfos","vReflectanceInfos","vMicroSurfaceSamplerInfos","vBumpInfos","vLightmapInfos","mBones","albedoMatrix","baseWeightMatrix","baseDiffuseRoughnessMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","reflectivityMatrix","normalMatrix","microSurfaceSamplerMatrix","bumpMatrix","lightmapMatrix","metallicReflectanceMatrix","reflectanceMatrix","vLightingIntensity","logarithmicDepthConstant","vSphericalX","vSphericalY","vSphericalZ","vSphericalXX_ZZ","vSphericalYY_ZZ","vSphericalZZ","vSphericalXY","vSphericalYZ","vSphericalZX","vSphericalL00","vSphericalL1_1","vSphericalL10","vSphericalL11","vSphericalL2_2","vSphericalL2_1","vSphericalL20","vSphericalL21","vSphericalL22","vReflectionMicrosurfaceInfos","vReflectionDominantDirection","vTangentSpaceParams","boneTextureWidth","vDebugMode","morphTargetTextureInfo","morphTargetTextureIndices","cameraInfo"],r=["albedoSampler","baseWeightSampler","baseDiffuseRoughnessSampler","reflectivitySampler","ambientSampler","emissiveSampler","bumpSampler","lightmapSampler","opacitySampler","reflectionSampler","reflectionSamplerLow","reflectionSamplerHigh","irradianceSampler","microSurfaceSampler","environmentBrdfSampler","boneSampler","metallicReflectanceSampler","reflectanceSampler","morphTargets","oitDepthSampler","oitFrontColorSampler","icdfSampler","areaLightsLTC1Sampler","areaLightsLTC2Sampler"],f=["Material","Scene","Mesh"],g={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:W.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=A,this._eventInfo.fallbackRank=y,this._eventInfo.defines=W,this._eventInfo.uniforms=w,this._eventInfo.attributes=j,this._eventInfo.samplers=r,this._eventInfo.uniformBuffersNames=f,this._eventInfo.customCode=void 0,this._eventInfo.mesh=U,this._eventInfo.indexParameters=g,this._callbackPluginEventGeneric(128,this._eventInfo),v.d.AddUniformsAndSamplers(w,r),K.b.AddUniforms(w),K.b.AddSamplers(r),(0,F.c)(w),m.c&&(m.c.PrepareUniforms(w,W),m.c.PrepareSamplers(r,W)),(0,D.eb)({uniformsNames:w,uniformBuffersNames:f,samplers:r,defines:W,maxSimultaneousLights:this._maxSimultaneousLights});const E={};this.customShaderNameResolve&&(s=this.customShaderNameResolve(s,w,f,r,W,j,E));const Z=W.toString(),o=k.createEffect(s,{attributes:j,uniformsNames:w,uniformBuffersNames:f,samplers:r,defines:Z,fallbacks:A,onCompiled:M,onError:t,indexParameters:g,processFinalCode:E.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:W.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this.shaderLanguage?await Promise.all([Promise.all([l.e(35),l.e(49)]).then(l.bind(l,13334)),Promise.all([l.e(33),l.e(50)]).then(l.bind(l,13505))]):await Promise.all([Promise.all([l.e(28),l.e(52)]).then(l.bind(l,13598)),Promise.all([l.e(27),l.e(53)]).then(l.bind(l,13744))]),this._shadersLoaded=!0}},k);return this._eventInfo.customCode=void 0,o}_prepareDefines(U,W){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,t=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const L=this.va(),p=L.getEngine();(0,D.T)(L,U,W,!0,this._maxSimultaneousLights,this._disableLighting),W._needNormals=!0,(0,D.$)(L,W);const B=this.needAlphaBlendingForMesh(U)&&this.va().useOrderIndependentTransparency;if((0,D.cb)(L,W,this.canRenderToMRT&&!B),(0,D.bb)(L,W,B),v.d.PrepareDefines(p.currentRenderPassId,U,W),W.METALLICWORKFLOW=this.isMetallicWorkflow(),W._areTexturesDirty){W._needUVs=!1;for(let U=1;U<=6;++U)W["MAINUV"+U]=!1;if(L.texturesEnabled){W.ALBEDODIRECTUV=0,W.BASE_WEIGHTDIRECTUV=0,W.BASE_DIFFUSE_ROUGHNESSDIRECTUV=0,W.AMBIENTDIRECTUV=0,W.OPACITYDIRECTUV=0,W.EMISSIVEDIRECTUV=0,W.REFLECTIVITYDIRECTUV=0,W.MICROSURFACEMAPDIRECTUV=0,W.METALLIC_REFLECTANCEDIRECTUV=0,W.REFLECTANCEDIRECTUV=0,W.BUMPDIRECTUV=0,W.LIGHTMAPDIRECTUV=0,p.getCaps().textureLOD&&(W.LODBASEDMICROSFURACE=!0),this._albedoTexture&&Z.e.DiffuseTextureEnabled?((0,D.V)(this._albedoTexture,W,"ALBEDO"),W.GAMMAALBEDO=this._albedoTexture.gammaSpace):W.ALBEDO=!1,this._baseWeightTexture&&Z.e.BaseWeightTextureEnabled?(0,D.V)(this._baseWeightTexture,W,"BASE_WEIGHT"):W.BASE_WEIGHT=!1,this._baseDiffuseRoughnessTexture&&Z.e.BaseDiffuseRoughnessTextureEnabled?(0,D.V)(this._baseDiffuseRoughnessTexture,W,"BASE_DIFFUSE_ROUGHNESS"):W.BASE_DIFFUSE_ROUGHNESS=!1,this._ambientTexture&&Z.e.AmbientTextureEnabled?((0,D.V)(this._ambientTexture,W,"AMBIENT"),W.AMBIENTINGRAYSCALE=this._useAmbientInGrayScale):W.AMBIENT=!1,this._opacityTexture&&Z.e.OpacityTextureEnabled?((0,D.V)(this._opacityTexture,W,"OPACITY"),W.OPACITYRGB=this._opacityTexture.getAlphaFromRGB):W.OPACITY=!1;const U=this._getReflectionTexture();if(U&&Z.e.ReflectionTextureEnabled){switch(W.REFLECTION=!0,W.GAMMAREFLECTION=U.gammaSpace,W.RGBDREFLECTION=U.isRGBD,W.LODINREFLECTIONALPHA=U.lodLevelInAlpha,W.LINEARSPECULARREFLECTION=U.linearSpecularLOD,W.USEIRRADIANCEMAP=!1,this.realTimeFiltering&&this.realTimeFilteringQuality>0?(W.NUM_SAMPLES=""+this.realTimeFilteringQuality,p._features.needTypeSuffixInShaderConstants&&(W.NUM_SAMPLES=W.NUM_SAMPLES+"u"),W.REALTIME_FILTERING=!0,this.va().iblCdfGenerator&&(W.IBL_CDF_FILTERING=!0)):W.REALTIME_FILTERING=!1,W.INVERTCUBICMAP=U.coordinatesMode===E.d.INVCUBIC_MODE,W.REFLECTIONMAP_3D=U.isCube,W.REFLECTIONMAP_OPPOSITEZ=W.REFLECTIONMAP_3D&&this.va().useRightHandedSystem?!U.invertZ:U.invertZ,W.REFLECTIONMAP_CUBIC=!1,W.REFLECTIONMAP_EXPLICIT=!1,W.REFLECTIONMAP_PLANAR=!1,W.REFLECTIONMAP_PROJECTION=!1,W.REFLECTIONMAP_SKYBOX=!1,W.REFLECTIONMAP_SPHERICAL=!1,W.REFLECTIONMAP_EQUIRECTANGULAR=!1,W.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,W.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,U.coordinatesMode){case E.d.EXPLICIT_MODE:W.REFLECTIONMAP_EXPLICIT=!0;break;case E.d.PLANAR_MODE:W.REFLECTIONMAP_PLANAR=!0;break;case E.d.PROJECTION_MODE:W.REFLECTIONMAP_PROJECTION=!0;break;case E.d.SKYBOX_MODE:W.REFLECTIONMAP_SKYBOX=!0;break;case E.d.SPHERICAL_MODE:W.REFLECTIONMAP_SPHERICAL=!0;break;case E.d.EQUIRECTANGULAR_MODE:W.REFLECTIONMAP_EQUIRECTANGULAR=!0;break;case E.d.FIXED_EQUIRECTANGULAR_MODE:W.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!0;break;case E.d.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:W.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!0;break;case E.d.CUBIC_MODE:case E.d.INVCUBIC_MODE:default:W.REFLECTIONMAP_CUBIC=!0,W.USE_LOCAL_REFLECTIONMAP_CUBIC=!!U.boundingBoxSize}U.coordinatesMode!==E.d.SKYBOX_MODE&&(U.irradianceTexture?(W.USEIRRADIANCEMAP=!0,W.USESPHERICALFROMREFLECTIONMAP=!1,W.USESPHERICALINVERTEX=!1,U.irradianceTexture._dominantDirection&&(W.USE_IRRADIANCE_DOMINANT_DIRECTION=!0)):U.isCube&&(W.USESPHERICALFROMREFLECTIONMAP=!0,W.USEIRRADIANCEMAP=!1,W.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,this._forceIrradianceInFragment||this.realTimeFiltering||this._twoSidedLighting||p.getCaps().maxVaryingVectors<=8||this._baseDiffuseRoughnessTexture?W.USESPHERICALINVERTEX=!1:W.USESPHERICALINVERTEX=!0))}else W.REFLECTION=!1,W.REFLECTIONMAP_3D=!1,W.REFLECTIONMAP_SPHERICAL=!1,W.REFLECTIONMAP_PLANAR=!1,W.REFLECTIONMAP_CUBIC=!1,W.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,W.REFLECTIONMAP_PROJECTION=!1,W.REFLECTIONMAP_SKYBOX=!1,W.REFLECTIONMAP_EXPLICIT=!1,W.REFLECTIONMAP_EQUIRECTANGULAR=!1,W.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,W.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,W.INVERTCUBICMAP=!1,W.USESPHERICALFROMREFLECTIONMAP=!1,W.USEIRRADIANCEMAP=!1,W.USE_IRRADIANCE_DOMINANT_DIRECTION=!1,W.USESPHERICALINVERTEX=!1,W.REFLECTIONMAP_OPPOSITEZ=!1,W.LODINREFLECTIONALPHA=!1,W.GAMMAREFLECTION=!1,W.RGBDREFLECTION=!1,W.LINEARSPECULARREFLECTION=!1;this._lightmapTexture&&Z.e.LightmapTextureEnabled?((0,D.V)(this._lightmapTexture,W,"LIGHTMAP"),W.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,W.GAMMALIGHTMAP=this._lightmapTexture.gammaSpace,W.RGBDLIGHTMAP=this._lightmapTexture.isRGBD):W.LIGHTMAP=!1,this._emissiveTexture&&Z.e.EmissiveTextureEnabled?((0,D.V)(this._emissiveTexture,W,"EMISSIVE"),W.GAMMAEMISSIVE=this._emissiveTexture.gammaSpace):W.EMISSIVE=!1,Z.e.SpecularTextureEnabled?(this._metallicTexture?((0,D.V)(this._metallicTexture,W,"REFLECTIVITY"),W.ROUGHNESSSTOREINMETALMAPALPHA=this._useRoughnessFromMetallicTextureAlpha,W.ROUGHNESSSTOREINMETALMAPGREEN=!this._useRoughnessFromMetallicTextureAlpha&&this._useRoughnessFromMetallicTextureGreen,W.METALLNESSSTOREINMETALMAPBLUE=this._useMetallnessFromMetallicTextureBlue,W.AOSTOREINMETALMAPRED=this._useAmbientOcclusionFromMetallicTextureRed,W.REFLECTIVITY_GAMMA=!1):this._reflectivityTexture?((0,D.V)(this._reflectivityTexture,W,"REFLECTIVITY"),W.MICROSURFACEFROMREFLECTIVITYMAP=this._useMicroSurfaceFromReflectivityMapAlpha,W.MICROSURFACEAUTOMATIC=this._useAutoMicroSurfaceFromReflectivityMap,W.REFLECTIVITY_GAMMA=this._reflectivityTexture.gammaSpace):W.REFLECTIVITY=!1,this._metallicReflectanceTexture||this._reflectanceTexture?(W.METALLIC_REFLECTANCE_USE_ALPHA_ONLY=this._useOnlyMetallicFromMetallicReflectanceTexture,this._metallicReflectanceTexture?((0,D.V)(this._metallicReflectanceTexture,W,"METALLIC_REFLECTANCE"),W.METALLIC_REFLECTANCE_GAMMA=this._metallicReflectanceTexture.gammaSpace):W.METALLIC_REFLECTANCE=!1,this._reflectanceTexture&&(!this._metallicReflectanceTexture||this._metallicReflectanceTexture&&this._useOnlyMetallicFromMetallicReflectanceTexture)?((0,D.V)(this._reflectanceTexture,W,"REFLECTANCE"),W.REFLECTANCE_GAMMA=this._reflectanceTexture.gammaSpace):W.REFLECTANCE=!1):(W.METALLIC_REFLECTANCE=!1,W.REFLECTANCE=!1),this._microSurfaceTexture?(0,D.V)(this._microSurfaceTexture,W,"MICROSURFACEMAP"):W.MICROSURFACEMAP=!1):(W.REFLECTIVITY=!1,W.MICROSURFACEMAP=!1),p.getCaps().standardDerivatives&&this._bumpTexture&&Z.e.BumpTextureEnabled&&!this._disableBumpMap?((0,D.V)(this._bumpTexture,W,"BUMP"),this._useParallax&&this._albedoTexture&&Z.e.DiffuseTextureEnabled?(W.PARALLAX=!0,W.PARALLAX_RHS=L.useRightHandedSystem,W.PARALLAXOCCLUSION=!!this._useParallaxOcclusion):W.PARALLAX=!1,W.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap):(W.BUMP=!1,W.PARALLAX=!1,W.PARALLAX_RHS=!1,W.PARALLAXOCCLUSION=!1,W.OBJECTSPACE_NORMALMAP=!1),this._environmentBRDFTexture&&Z.e.ReflectionTextureEnabled?(W.ENVIRONMENTBRDF=!0,W.ENVIRONMENTBRDF_RGBD=this._environmentBRDFTexture.isRGBD):(W.ENVIRONMENTBRDF=!1,W.ENVIRONMENTBRDF_RGBD=!1),this._shouldUseAlphaFromAlbedoTexture()?W.ALPHAFROMALBEDO=!0:W.ALPHAFROMALBEDO=!1}W.SPECULAROVERALPHA=this._useSpecularOverAlpha,this._lightFalloff===G.LIGHTFALLOFF_STANDARD?(W.USEPHYSICALLIGHTFALLOFF=!1,W.USEGLTFLIGHTFALLOFF=!1):this._lightFalloff===G.LIGHTFALLOFF_GLTF?(W.USEPHYSICALLIGHTFALLOFF=!1,W.USEGLTFLIGHTFALLOFF=!0):(W.USEPHYSICALLIGHTFALLOFF=!0,W.USEGLTFLIGHTFALLOFF=!1),W.RADIANCEOVERALPHA=this._useRadianceOverAlpha,!this.sk&&this._twoSidedLighting?W.TWOSIDEDLIGHTING=!0:W.TWOSIDEDLIGHTING=!1,W.MIRRORED=!!L._mirroredCameraPosition,W.SPECULARAA=p.getCaps().standardDerivatives&&this._enableSpecularAntiAliasing}(W._areTexturesDirty||W._areMiscDirty)&&(W.ALPHATESTVALUE=`${this._alphaCutOff}${this._alphaCutOff%1===0?".":""}`,W.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,W.ALPHABLEND=this.needAlphaBlendingForMesh(U),W.ALPHAFRESNEL=this._useAlphaFresnel||this._useLinearAlphaFresnel,W.LINEARALPHAFRESNEL=this._useLinearAlphaFresnel),W._areImageProcessingDirty&&this._imageProcessingConfiguration&&this._imageProcessingConfiguration.prepareDefines(W),W.FORCENORMALFORWARD=this._forceNormalForward,W.RADIANCEOCCLUSION=this._useRadianceOcclusion,W.HORIZONOCCLUSION=this._useHorizonOcclusion,W._areMiscDirty&&((0,D.Z)(U,L,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this.needAlphaTestingForMesh(U),W,this._applyDecalMapAfterDetailMap),W.UNLIT=this._unlit||(this.pointsCloud||this.wireframe)&&!U.isVerticesDataPresent(q.e.NormalKind),W.DEBUGMODE=this._debugMode),(0,D.S)(L,p,this,W,!!l,M,t),this._eventInfo.defines=W,this._eventInfo.mesh=U,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),(0,D.O)(U,W,!0,!0,!0,this._transparencyMode!==G.PBRMATERIAL_OPAQUE),this._callbackPluginEventPrepareDefines(this._eventInfo)}forceCompilation(U,W,l){const M={clipPlane:!1,useInstances:!1,...l};this._uniformBufferLayoutBuilt||this.buildUniformLayout(),this._callbackPluginEventGeneric(4,this._eventInfo);(()=>{if(this._breakShaderLoadedCheck)return;const l=new Q(this._eventInfo.defineNames),t=this._prepareEffect(U,l,void 0,void 0,M.useInstances,M.clipPlane,U.hasThinInstances);this._onEffectCreatedObservable&&(J.effect=t,J.subMesh=null,this._onEffectCreatedObservable.notifyObservers(J)),t.isReady()?W&&W(this):t.onCompileObservable.add((()=>{W&&W(this)}))})()}buildUniformLayout(){const U=this._uniformBuffer;U.addUniform("vAlbedoInfos",2),U.addUniform("vBaseWeightInfos",2),U.addUniform("vBaseDiffuseRoughnessInfos",2),U.addUniform("vAmbientInfos",4),U.addUniform("vOpacityInfos",2),U.addUniform("vEmissiveInfos",2),U.addUniform("vLightmapInfos",2),U.addUniform("vReflectivityInfos",3),U.addUniform("vMicroSurfaceSamplerInfos",2),U.addUniform("vReflectionInfos",2),U.addUniform("vReflectionFilteringInfo",2),U.addUniform("vReflectionPosition",3),U.addUniform("vReflectionSize",3),U.addUniform("vBumpInfos",3),U.addUniform("albedoMatrix",16),U.addUniform("baseWeightMatrix",16),U.addUniform("baseDiffuseRoughnessMatrix",16),U.addUniform("ambientMatrix",16),U.addUniform("opacityMatrix",16),U.addUniform("emissiveMatrix",16),U.addUniform("lightmapMatrix",16),U.addUniform("reflectivityMatrix",16),U.addUniform("microSurfaceSamplerMatrix",16),U.addUniform("bumpMatrix",16),U.addUniform("vTangentSpaceParams",2),U.addUniform("reflectionMatrix",16),U.addUniform("vReflectionColor",3),U.addUniform("vAlbedoColor",4),U.addUniform("baseWeight",1),U.addUniform("baseDiffuseRoughness",1),U.addUniform("vLightingIntensity",4),U.addUniform("vReflectionMicrosurfaceInfos",3),U.addUniform("vReflectionDominantDirection",3),U.addUniform("pointSize",1),U.addUniform("vReflectivityColor",4),U.addUniform("vEmissiveColor",3),U.addUniform("vAmbientColor",3),U.addUniform("vDebugMode",2),U.addUniform("vMetallicReflectanceFactors",4),U.addUniform("vMetallicReflectanceInfos",2),U.addUniform("metallicReflectanceMatrix",16),U.addUniform("vReflectanceInfos",2),U.addUniform("reflectanceMatrix",16),U.addUniform("vSphericalL00",3),U.addUniform("vSphericalL1_1",3),U.addUniform("vSphericalL10",3),U.addUniform("vSphericalL11",3),U.addUniform("vSphericalL2_2",3),U.addUniform("vSphericalL2_1",3),U.addUniform("vSphericalL20",3),U.addUniform("vSphericalL21",3),U.addUniform("vSphericalL22",3),U.addUniform("vSphericalX",3),U.addUniform("vSphericalY",3),U.addUniform("vSphericalZ",3),U.addUniform("vSphericalXX_ZZ",3),U.addUniform("vSphericalYY_ZZ",3),U.addUniform("vSphericalZZ",3),U.addUniform("vSphericalXY",3),U.addUniform("vSphericalYZ",3),U.addUniform("vSphericalZX",3),U.addUniform("cameraInfo",4),super.buildUniformLayout()}bindForSubMesh(U,W,l){const M=this.va(),t=l.materialDefines;if(!t)return;const L=l.effect;if(!L)return;this._activeEffect=L,W.getMeshUniformBuffer().bindToEffect(L,"Mesh"),W.transferToEffect(U);const p=M.getEngine();this._uniformBuffer.bindToEffect(L,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,M,W,U,this.isFrozen),v.d.Bind(p.currentRenderPassId,this._activeEffect,W,U,this);const B=M.activeCamera;B?this._uniformBuffer.updateFloat4("cameraInfo",B.bk,B.maxZ,0,0):this._uniformBuffer.updateFloat4("cameraInfo",0,0,0,0),this._eventInfo.subMesh=l,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),t.OBJECTSPACE_NORMALMAP&&(U.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const A=this._mustRebind(M,L,l,W.visibility);(0,D.d)(W,this._activeEffect,this.prePassConfiguration);let q=null;const y=this._uniformBuffer;if(A){if(this.bindViewProjection(L),q=this._getReflectionTexture(),!y.useUbo||!this.isFrozen||!y.isSync||l._drawWrapper._forceRebindOnNextCall){var j;if(M.texturesEnabled){if(this._albedoTexture&&Z.e.DiffuseTextureEnabled&&(y.updateFloat2("vAlbedoInfos",this._albedoTexture.coordinatesIndex,this._albedoTexture.level),(0,D.u)(this._albedoTexture,y,"albedo")),this._baseWeightTexture&&Z.e.BaseWeightTextureEnabled&&(y.updateFloat2("vBaseWeightInfos",this._baseWeightTexture.coordinatesIndex,this._baseWeightTexture.level),(0,D.u)(this._baseWeightTexture,y,"baseWeight")),this._baseDiffuseRoughnessTexture&&Z.e.BaseDiffuseRoughnessTextureEnabled&&(y.updateFloat2("vBaseDiffuseRoughnessInfos",this._baseDiffuseRoughnessTexture.coordinatesIndex,this._baseDiffuseRoughnessTexture.level),(0,D.u)(this._baseDiffuseRoughnessTexture,y,"baseDiffuseRoughness")),this._ambientTexture&&Z.e.AmbientTextureEnabled&&(y.updateFloat4("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level,this._ambientTextureStrength,this._ambientTextureImpactOnAnalyticalLights),(0,D.u)(this._ambientTexture,y,"ambient")),this._opacityTexture&&Z.e.OpacityTextureEnabled&&(y.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),(0,D.u)(this._opacityTexture,y,"opacity")),q&&Z.e.ReflectionTextureEnabled){if(y.wk("reflectionMatrix",q.getReflectionTextureMatrix()),y.updateFloat2("vReflectionInfos",q.level*M.iblIntensity,0),q.boundingBoxSize){const U=q;y.updateVector3("vReflectionPosition",U.boundingBoxPosition),y.updateVector3("vReflectionSize",U.boundingBoxSize)}if(this.realTimeFiltering){const U=q.getSize().width;y.updateFloat2("vReflectionFilteringInfo",U,Math.log2(U))}if(t.USEIRRADIANCEMAP)t.USEIRRADIANCEMAP&&t.USE_IRRADIANCE_DOMINANT_DIRECTION&&y.updateVector3("vReflectionDominantDirection",q.irradianceTexture._dominantDirection);else{const U=q.sphericalPolynomial;if(t.USESPHERICALFROMREFLECTIONMAP&&U)if(t.SPHERICAL_HARMONICS){const W=U.preScaledHarmonics;y.updateVector3("vSphericalL00",W.l00),y.updateVector3("vSphericalL1_1",W.l1_1),y.updateVector3("vSphericalL10",W.l10),y.updateVector3("vSphericalL11",W.l11),y.updateVector3("vSphericalL2_2",W.l2_2),y.updateVector3("vSphericalL2_1",W.l2_1),y.updateVector3("vSphericalL20",W.l20),y.updateVector3("vSphericalL21",W.l21),y.updateVector3("vSphericalL22",W.l22)}else y.updateFloat3("vSphericalX",U.x.x,U.x.y,U.x.z),y.updateFloat3("vSphericalY",U.y.x,U.y.y,U.y.z),y.updateFloat3("vSphericalZ",U.z.x,U.z.y,U.z.z),y.updateFloat3("vSphericalXX_ZZ",U.xx.x-U.zz.x,U.xx.y-U.zz.y,U.xx.z-U.zz.z),y.updateFloat3("vSphericalYY_ZZ",U.yy.x-U.zz.x,U.yy.y-U.zz.y,U.yy.z-U.zz.z),y.updateFloat3("vSphericalZZ",U.zz.x,U.zz.y,U.zz.z),y.updateFloat3("vSphericalXY",U.xy.x,U.xy.y,U.xy.z),y.updateFloat3("vSphericalYZ",U.yz.x,U.yz.y,U.yz.z),y.updateFloat3("vSphericalZX",U.zx.x,U.zx.y,U.zx.z)}y.updateFloat3("vReflectionMicrosurfaceInfos",q.getSize().width,q.lodGenerationScale,q.lodGenerationOffset)}this._emissiveTexture&&Z.e.EmissiveTextureEnabled&&(y.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),(0,D.u)(this._emissiveTexture,y,"emissive")),this._lightmapTexture&&Z.e.LightmapTextureEnabled&&(y.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),(0,D.u)(this._lightmapTexture,y,"lightmap")),Z.e.SpecularTextureEnabled&&(this._metallicTexture?(y.updateFloat3("vReflectivityInfos",this._metallicTexture.coordinatesIndex,this._metallicTexture.level,this._ambientTextureStrength),(0,D.u)(this._metallicTexture,y,"reflectivity")):this._reflectivityTexture&&(y.updateFloat3("vReflectivityInfos",this._reflectivityTexture.coordinatesIndex,this._reflectivityTexture.level,1),(0,D.u)(this._reflectivityTexture,y,"reflectivity")),this._metallicReflectanceTexture&&(y.updateFloat2("vMetallicReflectanceInfos",this._metallicReflectanceTexture.coordinatesIndex,this._metallicReflectanceTexture.level),(0,D.u)(this._metallicReflectanceTexture,y,"metallicReflectance")),this._reflectanceTexture&&t.REFLECTANCE&&(y.updateFloat2("vReflectanceInfos",this._reflectanceTexture.coordinatesIndex,this._reflectanceTexture.level),(0,D.u)(this._reflectanceTexture,y,"reflectance")),this._microSurfaceTexture&&(y.updateFloat2("vMicroSurfaceSamplerInfos",this._microSurfaceTexture.coordinatesIndex,this._microSurfaceTexture.level),(0,D.u)(this._microSurfaceTexture,y,"microSurfaceSampler"))),this._bumpTexture&&p.getCaps().standardDerivatives&&Z.e.BumpTextureEnabled&&!this._disableBumpMap&&(y.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,this._bumpTexture.level,this._parallaxScaleBias),(0,D.u)(this._bumpTexture,y,"bump"),M._mirroredCameraPosition?y.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):y.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1))}if(this.pointsCloud&&y.updateFloat("pointSize",this.pointSize),t.METALLICWORKFLOW){var s;r.h.Ak[0].r=void 0===this._metallic||null===this._metallic?1:this._metallic,r.h.Ak[0].g=void 0===this._roughness||null===this._roughness?1:this._roughness;const U=(null===(s=this.subSurface)||void 0===s?void 0:s._indexOfRefraction)??1.5,W=1;r.h.Ak[0].b=U;const l=Math.pow((U-W)/(U+W),2);r.h.Ak[0].a=l,y.updateDirectColor4("vReflectivityColor",r.h.Ak[0]),y.updateColor4("vMetallicReflectanceFactors",this._metallicReflectanceColor,this._metallicF0Factor)}else y.updateColor4("vReflectivityColor",this._reflectivityColor,this._microSurface);y.updateColor3("vEmissiveColor",Z.e.EmissiveTextureEnabled?this._emissiveColor:r.e.BlackReadOnly),y.updateColor3("vReflectionColor",this._reflectionColor),!t.SS_REFRACTION&&null!==(j=this.subSurface)&&void 0!==j&&j._linkRefractionWithTransparency?y.updateColor4("vAlbedoColor",this._albedoColor,1):y.updateColor4("vAlbedoColor",this._albedoColor,this.alpha),y.updateFloat("baseWeight",this._baseWeight),y.updateFloat("baseDiffuseRoughness",this._baseDiffuseRoughness||0),this._lightingInfos.x=this._directIntensity,this._lightingInfos.y=this._emissiveIntensity,this._lightingInfos.z=this._environmentIntensity*M.environmentIntensity,this._lightingInfos.w=this._specularIntensity,y.updateVector4("vLightingIntensity",this._lightingInfos),M.ambientColor.multiplyToRef(this._ambientColor,this._globalAmbientColor),y.updateColor3("vAmbientColor",this._globalAmbientColor),y.updateFloat2("vDebugMode",this.debugLimit,this.debugFactor)}if(M.texturesEnabled){if(this._albedoTexture&&Z.e.DiffuseTextureEnabled&&y.setTexture("albedoSampler",this._albedoTexture),this._baseWeightTexture&&Z.e.BaseWeightTextureEnabled&&y.setTexture("baseWeightSampler",this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&Z.e.BaseDiffuseRoughnessTextureEnabled&&y.setTexture("baseDiffuseRoughnessSampler",this._baseDiffuseRoughnessTexture),this._ambientTexture&&Z.e.AmbientTextureEnabled&&y.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&Z.e.OpacityTextureEnabled&&y.setTexture("opacitySampler",this._opacityTexture),q&&Z.e.ReflectionTextureEnabled){t.LODBASEDMICROSFURACE?y.setTexture("reflectionSampler",q):(y.setTexture("reflectionSampler",q._lodTextureMid||q),y.setTexture("reflectionSamplerLow",q._lodTextureLow||q),y.setTexture("reflectionSamplerHigh",q._lodTextureHigh||q)),t.USEIRRADIANCEMAP&&y.setTexture("irradianceSampler",q.irradianceTexture);const U=this.va().iblCdfGenerator;this.realTimeFiltering&&U&&y.setTexture("icdfSampler",U.getIcdfTexture())}t.ENVIRONMENTBRDF&&y.setTexture("environmentBrdfSampler",this._environmentBRDFTexture),this._emissiveTexture&&Z.e.EmissiveTextureEnabled&&y.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&Z.e.LightmapTextureEnabled&&y.setTexture("lightmapSampler",this._lightmapTexture),Z.e.SpecularTextureEnabled&&(this._metallicTexture?y.setTexture("reflectivitySampler",this._metallicTexture):this._reflectivityTexture&&y.setTexture("reflectivitySampler",this._reflectivityTexture),this._metallicReflectanceTexture&&y.setTexture("metallicReflectanceSampler",this._metallicReflectanceTexture),this._reflectanceTexture&&t.REFLECTANCE&&y.setTexture("reflectanceSampler",this._reflectanceTexture),this._microSurfaceTexture&&y.setTexture("microSurfaceSampler",this._microSurfaceTexture)),this._bumpTexture&&p.getCaps().standardDerivatives&&Z.e.BumpTextureEnabled&&!this._disableBumpMap&&y.setTexture("bumpSampler",this._bumpTexture)}this.va().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(W)&&this.va().depthPeelingRenderer.bind(L),this._eventInfo.subMesh=l,this._callbackPluginEventBindForSubMesh(this._eventInfo),(0,F.g)(this._activeEffect,this,M),this.bindEyePosition(L)}else M.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);if(A||!this.isFrozen){var w;if(M.lightsEnabled&&!this._disableLighting&&(0,D.j)(M,W,this._activeEffect,t,this._maxSimultaneousLights),(M.fogEnabled&&W.applyFog&&M.fogMode!==k.c.FOGMODE_NONE||q||this.subSurface.refractionTexture||W.receiveShadows||t.PREPASS)&&this.bindView(L),(0,D.g)(M,W,this._activeEffect,!0),t.NUM_MORPH_INFLUENCERS&&(0,D.q)(W,this._activeEffect),t.BAKED_VERTEX_ANIMATION_TEXTURE)null===(w=W.bakedVertexAnimationManager)||void 0===w||w.bind(L,t.INSTANCES);this._imageProcessingConfiguration.bind(this._activeEffect),(0,D.n)(t,this._activeEffect,M)}this._afterBind(W,this._activeEffect,l),y.update()}getAnimatables(){const U=super.getAnimatables();return this._albedoTexture&&this._albedoTexture.animations&&this._albedoTexture.animations.length>0&&U.push(this._albedoTexture),this._baseWeightTexture&&this._baseWeightTexture.animations&&this._baseWeightTexture.animations.length>0&&U.push(this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&this._baseDiffuseRoughnessTexture.animations&&this._baseDiffuseRoughnessTexture.animations.length>0&&U.push(this._baseDiffuseRoughnessTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&U.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&U.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&U.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&U.push(this._emissiveTexture),this._metallicTexture&&this._metallicTexture.animations&&this._metallicTexture.animations.length>0?U.push(this._metallicTexture):this._reflectivityTexture&&this._reflectivityTexture.animations&&this._reflectivityTexture.animations.length>0&&U.push(this._reflectivityTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&U.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&U.push(this._lightmapTexture),this._metallicReflectanceTexture&&this._metallicReflectanceTexture.animations&&this._metallicReflectanceTexture.animations.length>0&&U.push(this._metallicReflectanceTexture),this._reflectanceTexture&&this._reflectanceTexture.animations&&this._reflectanceTexture.animations.length>0&&U.push(this._reflectanceTexture),this._microSurfaceTexture&&this._microSurfaceTexture.animations&&this._microSurfaceTexture.animations.length>0&&U.push(this._microSurfaceTexture),U}_getReflectionTexture(){return this._reflectionTexture?this._reflectionTexture:this.va().environmentTexture}getActiveTextures(){const U=super.getActiveTextures();return this._albedoTexture&&U.push(this._albedoTexture),this._baseWeightTexture&&U.push(this._baseWeightTexture),this._baseDiffuseRoughnessTexture&&U.push(this._baseDiffuseRoughnessTexture),this._ambientTexture&&U.push(this._ambientTexture),this._opacityTexture&&U.push(this._opacityTexture),this._reflectionTexture&&U.push(this._reflectionTexture),this._emissiveTexture&&U.push(this._emissiveTexture),this._reflectivityTexture&&U.push(this._reflectivityTexture),this._metallicTexture&&U.push(this._metallicTexture),this._metallicReflectanceTexture&&U.push(this._metallicReflectanceTexture),this._reflectanceTexture&&U.push(this._reflectanceTexture),this._microSurfaceTexture&&U.push(this._microSurfaceTexture),this._bumpTexture&&U.push(this._bumpTexture),this._lightmapTexture&&U.push(this._lightmapTexture),U}hasTexture(U){return!!super.hasTexture(U)||(this._albedoTexture===U||(this._baseWeightTexture===U||(this._baseDiffuseRoughnessTexture===U||(this._ambientTexture===U||(this._opacityTexture===U||(this._reflectionTexture===U||(this._emissiveTexture===U||(this._reflectivityTexture===U||(this._metallicTexture===U||(this._metallicReflectanceTexture===U||(this._reflectanceTexture===U||(this._microSurfaceTexture===U||(this._bumpTexture===U||this._lightmapTexture===U)))))))))))))}setPrePassRenderer(){var U;if(null===(U=this.subSurface)||void 0===U||!U.isScatteringEnabled)return!1;const W=this.va().enableSubSurfaceForPrePass();return W&&(W.enabled=!0),!0}dispose(U,W){var l,M,t,L,p,B,k,A,q,y,j,s,w,K;(this._breakShaderLoadedCheck=!0,W)&&(this._environmentBRDFTexture&&this.va().environmentBRDFTexture!==this._environmentBRDFTexture&&this._environmentBRDFTexture.dispose(),null===(l=this._albedoTexture)||void 0===l||l.dispose(),null===(M=this._baseWeightTexture)||void 0===M||M.dispose(),null===(t=this._baseDiffuseRoughnessTexture)||void 0===t||t.dispose(),null===(L=this._ambientTexture)||void 0===L||L.dispose(),null===(p=this._opacityTexture)||void 0===p||p.dispose(),null===(B=this._reflectionTexture)||void 0===B||B.dispose(),null===(k=this._emissiveTexture)||void 0===k||k.dispose(),null===(A=this._metallicTexture)||void 0===A||A.dispose(),null===(q=this._reflectivityTexture)||void 0===q||q.dispose(),null===(y=this._bumpTexture)||void 0===y||y.dispose(),null===(j=this._lightmapTexture)||void 0===j||j.dispose(),null===(s=this._metallicReflectanceTexture)||void 0===s||s.dispose(),null===(w=this._reflectanceTexture)||void 0===w||w.dispose(),null===(K=this._microSurfaceTexture)||void 0===K||K.dispose());this._renderTargets.dispose(),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(U,W)}}G.PBRMATERIAL_OPAQUE=f.b.MATERIAL_OPAQUE,G.PBRMATERIAL_ALPHATEST=f.b.MATERIAL_ALPHATEST,G.PBRMATERIAL_ALPHABLEND=f.b.MATERIAL_ALPHABLEND,G.PBRMATERIAL_ALPHATESTANDBLEND=f.b.MATERIAL_ALPHATESTANDBLEND,G.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=0,G.LIGHTFALLOFF_PHYSICAL=0,G.LIGHTFALLOFF_GLTF=1,G.LIGHTFALLOFF_STANDARD=2,G.ForceGLSL=!1,(0,M.e)([(0,t.x)()],G.prototype,"_imageProcessingConfiguration",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsMiscDirty")],G.prototype,"debugMode",void 0)},11798:(U,W,l)=>{l.d(W,{c:()=>y});var M=l(686),t=l(688),L=l(11806),p=l(742),B=l(11813),k=l(655),A=l(851),q=l(734);class y extends B.b{get refractionTexture(){return this.subSurface.refractionTexture}set refractionTexture(U){this.subSurface.refractionTexture=U,U?this.subSurface.isRefractionEnabled=!0:this.subSurface.linkRefractionWithTransparency||(this.subSurface.isRefractionEnabled=!1)}get indexOfRefraction(){return this.subSurface.indexOfRefraction}set indexOfRefraction(U){this.subSurface.indexOfRefraction=U}get invertRefractionY(){return this.subSurface.invertRefractionY}set invertRefractionY(U){this.subSurface.invertRefractionY=U}get linkRefractionWithTransparency(){return this.subSurface.linkRefractionWithTransparency}set linkRefractionWithTransparency(U){this.subSurface.linkRefractionWithTransparency=U,U&&(this.subSurface.isRefractionEnabled=!0)}get usePhysicalLightFalloff(){return this._lightFalloff===B.b.LIGHTFALLOFF_PHYSICAL}set usePhysicalLightFalloff(U){U!==this.usePhysicalLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=U?B.b.LIGHTFALLOFF_PHYSICAL:B.b.LIGHTFALLOFF_STANDARD)}get useGLTFLightFalloff(){return this._lightFalloff===B.b.LIGHTFALLOFF_GLTF}set useGLTFLightFalloff(U){U!==this.useGLTFLightFalloff&&(this._markAllSubMeshesAsTexturesDirty(),this._lightFalloff=U?B.b.LIGHTFALLOFF_GLTF:B.b.LIGHTFALLOFF_STANDARD)}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(U){this._attachImageProcessingConfiguration(U),this._markAllSubMeshesAsImageProcessingDirty()}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(U){this.imageProcessingConfiguration.colorCurvesEnabled=U}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(U){this.imageProcessingConfiguration.colorGradingEnabled=U}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(U){this._imageProcessingConfiguration.toneMappingEnabled=U}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(U){this._imageProcessingConfiguration.exposure=U}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(U){this._imageProcessingConfiguration.contrast=U}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(U){this._imageProcessingConfiguration.colorGradingTexture=U}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(U){this._imageProcessingConfiguration.colorCurves=U}constructor(U,W){super(U,W,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.directIntensity=1,this.emissiveIntensity=1,this.environmentIntensity=1,this.specularIntensity=1,this.disableBumpMap=!1,this.ambientTextureStrength=1,this.ambientTextureImpactOnAnalyticalLights=y.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,this.metallicF0Factor=1,this.metallicReflectanceColor=p.e.White(),this.useOnlyMetallicFromMetallicReflectanceTexture=!1,this.ambientColor=new p.e(0,0,0),this.albedoColor=new p.e(1,1,1),this.baseWeight=1,this.reflectivityColor=new p.e(1,1,1),this.reflectionColor=new p.e(1,1,1),this.emissiveColor=new p.e(0,0,0),this.microSurface=1,this.useLightmapAsShadowmap=!1,this.useAlphaFromAlbedoTexture=!1,this.forceAlphaTest=!1,this.alphaCutOff=.4,this.useSpecularOverAlpha=!0,this.useMicroSurfaceFromReflectivityMapAlpha=!1,this.useRoughnessFromMetallicTextureAlpha=!0,this.useRoughnessFromMetallicTextureGreen=!1,this.useMetallnessFromMetallicTextureBlue=!1,this.useAmbientOcclusionFromMetallicTextureRed=!1,this.useAmbientInGrayScale=!1,this.useAutoMicroSurfaceFromReflectivityMap=!1,this.useRadianceOverAlpha=!0,this.useObjectSpaceNormalMap=!1,this.useParallax=!1,this.useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this.disableLighting=!1,this.forceIrradianceInFragment=!1,this.maxSimultaneousLights=4,this.invertNormalMapX=!1,this.invertNormalMapY=!1,this.twoSidedLighting=!1,this.useAlphaFresnel=!1,this.useLinearAlphaFresnel=!1,this.environmentBRDFTexture=null,this.forceNormalForward=!1,this.enableSpecularAntiAliasing=!1,this.useHorizonOcclusion=!0,this.useRadianceOcclusion=!0,this.unlit=!1,this.applyDecalMapAfterDetailMap=!1,this._environmentBRDFTexture=(0,L.c)(this.va())}getClassName(){return"PBRMaterial"}clone(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const M=q.e.Clone((()=>new y(U,this.va())),this,{cloneTexturesOnlyOnce:W});return M.id=U,M.name=U,this.stencil.copyTo(M.stencil),this._clonePlugins(M,l),M}serialize(){const U=super.serialize();return U.customType="BABYLON.PBRMaterial",U}static Parse(U,W,l){const M=q.e.Parse((()=>new y(U.name,W)),U,W,l);return U.stencil&&M.stencil.parse(U.stencil,W,l),A.b._ParsePlugins(U,M,W,l),U.clearCoat&&M.clearCoat.parse(U.clearCoat,W,l),U.anisotropy&&M.anisotropy.parse(U.anisotropy,W,l),U.brdf&&M.brdf.parse(U.brdf,W,l),U.sheen&&M.sheen.parse(U.sheen,W,l),U.subSurface&&M.subSurface.parse(U.subSurface,W,l),U.iridescence&&M.iridescence.parse(U.iridescence,W,l),M}}y.PBRMATERIAL_OPAQUE=B.b.PBRMATERIAL_OPAQUE,y.PBRMATERIAL_ALPHATEST=B.b.PBRMATERIAL_ALPHATEST,y.PBRMATERIAL_ALPHABLEND=B.b.PBRMATERIAL_ALPHABLEND,y.PBRMATERIAL_ALPHATESTANDBLEND=B.b.PBRMATERIAL_ALPHATESTANDBLEND,y.DEFAULT_AO_ON_ANALYTICAL_LIGHTS=B.b.DEFAULT_AO_ON_ANALYTICAL_LIGHTS,(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"directIntensity",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"emissiveIntensity",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"environmentIntensity",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"specularIntensity",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"disableBumpMap",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"albedoTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"baseWeightTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"baseDiffuseRoughnessTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"ambientTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"ambientTextureStrength",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"ambientTextureImpactOnAnalyticalLights",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],y.prototype,"opacityTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"reflectionTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"emissiveTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"reflectivityTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"metallicTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"metallic",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"roughness",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"metallicF0Factor",void 0),(0,M.e)([(0,t.n)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"metallicReflectanceColor",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useOnlyMetallicFromMetallicReflectanceTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"metallicReflectanceTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"reflectanceTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"microSurfaceTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"bumpTexture",void 0),(0,M.e)([(0,t.K)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty",null)],y.prototype,"lightmapTexture",void 0),(0,M.e)([(0,t.n)("ambient"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"ambientColor",void 0),(0,M.e)([(0,t.n)("albedo"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"albedoColor",void 0),(0,M.e)([(0,t.T)("baseWeight"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"baseWeight",void 0),(0,M.e)([(0,t.T)("baseDiffuseRoughness"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"baseDiffuseRoughness",void 0),(0,M.e)([(0,t.n)("reflectivity"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"reflectivityColor",void 0),(0,M.e)([(0,t.n)("reflection"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"reflectionColor",void 0),(0,M.e)([(0,t.n)("emissive"),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"emissiveColor",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"microSurface",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useLightmapAsShadowmap",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],y.prototype,"useAlphaFromAlbedoTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],y.prototype,"forceAlphaTest",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],y.prototype,"alphaCutOff",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useSpecularOverAlpha",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useMicroSurfaceFromReflectivityMapAlpha",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useRoughnessFromMetallicTextureAlpha",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useRoughnessFromMetallicTextureGreen",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useMetallnessFromMetallicTextureBlue",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useAmbientOcclusionFromMetallicTextureRed",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useAmbientInGrayScale",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useAutoMicroSurfaceFromReflectivityMap",void 0),(0,M.e)([(0,t.T)()],y.prototype,"usePhysicalLightFalloff",null),(0,M.e)([(0,t.T)()],y.prototype,"useGLTFLightFalloff",null),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useRadianceOverAlpha",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useObjectSpaceNormalMap",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useParallax",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useParallaxOcclusion",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"parallaxScaleBias",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsLightsDirty")],y.prototype,"disableLighting",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"forceIrradianceInFragment",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsLightsDirty")],y.prototype,"maxSimultaneousLights",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"invertNormalMapX",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"invertNormalMapY",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"twoSidedLighting",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useAlphaFresnel",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useLinearAlphaFresnel",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"environmentBRDFTexture",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"forceNormalForward",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"enableSpecularAntiAliasing",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useHorizonOcclusion",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"useRadianceOcclusion",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],y.prototype,"unlit",void 0),(0,M.e)([(0,t.T)(),(0,t.d)("_markAllSubMeshesAsMiscDirty")],y.prototype,"applyDecalMapAfterDetailMap",void 0),(0,k.f)("BABYLON.PBRMaterial",y)},11781:(U,W,l)=>{l.d(W,{e:()=>t});var M=l(2048);class t extends M.d{constructor(U,W,l,t,L){let p=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],B=arguments.length>6&&void 0!==arguments[6]&&arguments[6],k=arguments.length>7&&void 0!==arguments[7]?arguments[7]:3,A=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,q=arguments.length>9?arguments[9]:void 0,y=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0;super(null,L,!p,B,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,q),this.format=t,this._engine&&(this._engine._caps.textureFloatLinearFiltering||1!==A||(k=1),this._engine._caps.textureHalfFloatLinearFiltering||2!==A||(k=1),this._texture=this._engine.createRawTexture(U,W,l,t,p,B,k,null,A,q??0,y??!1),this.wrapU=M.d.CLAMP_ADDRESSMODE,this.wrapV=M.d.CLAMP_ADDRESSMODE,this._waitingForData=!!j&&!U)}update(U){this._getEngine().updateRawTexture(this._texture,U,this._texture.format,this._texture.invertY,null,this._texture.type,this._texture._useSRGBBuffer),this._waitingForData=!1}clone(){if(!this._texture)return super.clone();const U=new t(null,this.getSize().width,this.getSize().height,this.format,this.va(),this._texture.generateMipMaps,this._invertY,this.samplingMode,this._texture.type,this._texture._creationFlags,this._useSRGBBuffer);return U._texture=this._texture,this._texture.incrementReferences(),U}isReady(){return super.isReady()&&!this._waitingForData}static CreateLuminanceTexture(U,W,l,M){return new t(U,W,l,1,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateLuminanceAlphaTexture(U,W,l,M){return new t(U,W,l,2,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateAlphaTexture(U,W,l,M){return new t(U,W,l,0,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3)}static CreateRGBTexture(U,W,l,M){return new t(U,W,l,4,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,arguments.length>9&&void 0!==arguments[9]&&arguments[9])}static CreateRGBATexture(U,W,l,M){return new t(U,W,l,5,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,arguments.length>9&&void 0!==arguments[9]&&arguments[9],arguments.length>10&&void 0!==arguments[10]&&arguments[10])}static CreateRGBAStorageTexture(U,W,l,M){return new t(U,W,l,5,M,!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]?arguments[6]:3,arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,1,arguments.length>8&&void 0!==arguments[8]&&arguments[8])}static CreateRTexture(U,W,l,L){let p=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],B=arguments.length>5&&void 0!==arguments[5]&&arguments[5],k=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M.d.TRILINEAR_SAMPLINGMODE;return new t(U,W,l,6,L,p,B,k,arguments.length>7&&void 0!==arguments[7]?arguments[7]:1)}static CreateRStorageTexture(U,W,l,L){let p=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],B=arguments.length>5&&void 0!==arguments[5]&&arguments[5],k=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M.d.TRILINEAR_SAMPLINGMODE;return new t(U,W,l,6,L,p,B,k,arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,1)}}},11832:(U,W,l)=>{l.d(W,{e:()=>M});class M{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(U,W){this._defines[U]||(U<this._currentRank&&(this._currentRank=U),U>this._maxRank&&(this._maxRank=U),this._defines[U]=new Array),this._defines[U].push(W)}addCPUSkinningFallback(U,W){this._mesh=W,U<this._currentRank&&(this._currentRank=U),U>this._maxRank&&(this._maxRank=U)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(U,W){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,U=U.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),W._bonesComputationForcedToCPU=!0;const l=this._mesh.va();for(let U=0;U<l.meshes.length;U++){const M=l.meshes[U];if(M.material){if(M.computeBonesUsingShaders&&0!==M.numBoneInfluencers)if(M.material.getEffect()===W)M.computeBonesUsingShaders=!1;else if(M.uk)for(const U of M.uk){if(U.effect===W){M.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&M.computeBonesUsingShaders&&M.numBoneInfluencers>0&&(M.computeBonesUsingShaders=!1)}}else{const W=this._defines[this._currentRank];if(W)for(let l=0;l<W.length;l++)U=U.replace("#define "+W[l],"");this._currentRank++}return U}}},11840:(U,W,l)=>{l.d(W,{b:()=>y});var M=l(686),t=l(851),L=l(688),p=l(11829),B=l(11816),k=l(11821),A=l(854);class q extends B.b{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class y extends k.c{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}isCompatible(){return!0}constructor(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(U,"DetailMap",140,new q,W),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=t.b.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=U._dirtyCallbacks[1]}isReadyForSubMesh(U,W,l){return!this._isEnabled||!(U._areTexturesDirty&&W.texturesEnabled&&l.getCaps().standardDerivatives&&this._texture&&p.e.DetailTextureEnabled&&!this._texture.isReady())}prepareDefines(U,W){if(this._isEnabled){U.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const l=W.getEngine();U._areTexturesDirty&&(l.getCaps().standardDerivatives&&this._texture&&p.e.DetailTextureEnabled&&this._isEnabled?((0,A.V)(this._texture,U,"DETAIL"),U.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):U.DETAIL=!1)}else U.DETAIL=!1}bindForSubMesh(U,W){if(!this._isEnabled)return;const l=this._material.isFrozen;U.useUbo&&l&&U.isSync||this._texture&&p.e.DetailTextureEnabled&&(U.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),(0,A.u)(this._texture,U,"detail")),W.texturesEnabled&&this._texture&&p.e.DetailTextureEnabled&&U.setTexture("detailSampler",this._texture)}hasTexture(U){return this._texture===U}getActiveTextures(U){this._texture&&U.push(this._texture)}getAnimatables(U){this._texture&&this._texture.animations&&this._texture.animations.length>0&&U.push(this._texture)}dispose(U){var W;U&&(null===(W=this._texture)||void 0===W||W.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(U){U.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}(0,M.e)([(0,L.K)("detailTexture"),(0,L.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"texture",void 0),(0,M.e)([(0,L.T)()],y.prototype,"diffuseBlendLevel",void 0),(0,M.e)([(0,L.T)()],y.prototype,"roughnessBlendLevel",void 0),(0,M.e)([(0,L.T)()],y.prototype,"bumpLevel",void 0),(0,M.e)([(0,L.T)(),(0,L.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"normalBlendMethod",void 0),(0,M.e)([(0,L.T)(),(0,L.d)("_markAllSubMeshesAsTexturesDirty")],y.prototype,"isEnabled",void 0)},11816:(U,W,l)=>{l.d(W,{b:()=>M});class M{constructor(U){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=U,U)for(const W in U)Object.prototype.hasOwnProperty.call(U,W)&&this._setDefaultValue(W)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(){let U=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||U,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const U of Object.keys(this))"_"!==U[0]&&this._keys.push(U);if(this._externalProperties)for(const U in this._externalProperties)-1===this._keys.indexOf(U)&&this._keys.push(U)}isEqual(U){if(this._keys.length!==U._keys.length)return!1;for(let W=0;W<this._keys.length;W++){const l=this._keys[W];if(this[l]!==U[l])return!1}return!0}cloneTo(U){this._keys.length!==U._keys.length&&(U._keys=this._keys.slice(0));for(let W=0;W<this._keys.length;W++){const l=this._keys[W];U[l]=this[l]}}reset(){for(const U of this._keys)this._setDefaultValue(U)}_setDefaultValue(U){var W,l,M,t;const L=(null===(W=this._externalProperties)||void 0===W||null===(l=W[U])||void 0===l?void 0:l.type)??typeof this[U],p=null===(M=this._externalProperties)||void 0===M||null===(t=M[U])||void 0===t?void 0:t.default;switch(L){case"number":this[U]=p??0;break;case"string":this[U]=p??"";break;default:this[U]=p??!1}}toString(){let U="";for(let W=0;W<this._keys.length;W++){const l=this._keys[W],M=this[l];switch(typeof M){case"number":case"string":U+="#define "+l+" "+M+"\n";break;default:M&&(U+="#define "+l+"\n")}}return U}}},11829:(U,W,l)=>{l.d(W,{e:()=>t});var M=l(592);class t{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(U){this._DiffuseTextureEnabled!==U&&(this._DiffuseTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get BaseWeightTextureEnabled(){return this._BaseWeightTextureEnabled}static set BaseWeightTextureEnabled(U){this._BaseWeightTextureEnabled!==U&&(this._BaseWeightTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get BaseDiffuseRoughnessTextureEnabled(){return this._BaseDiffuseRoughnessTextureEnabled}static set BaseDiffuseRoughnessTextureEnabled(U){this._BaseDiffuseRoughnessTextureEnabled!==U&&(this._BaseDiffuseRoughnessTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(U){this._DetailTextureEnabled!==U&&(this._DetailTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get DecalMapEnabled(){return this._DecalMapEnabled}static set DecalMapEnabled(U){this._DecalMapEnabled!==U&&(this._DecalMapEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(U){this._AmbientTextureEnabled!==U&&(this._AmbientTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(U){this._OpacityTextureEnabled!==U&&(this._OpacityTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(U){this._ReflectionTextureEnabled!==U&&(this._ReflectionTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(U){this._EmissiveTextureEnabled!==U&&(this._EmissiveTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(U){this._SpecularTextureEnabled!==U&&(this._SpecularTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(U){this._BumpTextureEnabled!==U&&(this._BumpTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(U){this._LightmapTextureEnabled!==U&&(this._LightmapTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(U){this._RefractionTextureEnabled!==U&&(this._RefractionTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(U){this._ColorGradingTextureEnabled!==U&&(this._ColorGradingTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(U){this._FresnelEnabled!==U&&(this._FresnelEnabled=U,M.d.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(U){this._ClearCoatTextureEnabled!==U&&(this._ClearCoatTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(U){this._ClearCoatBumpTextureEnabled!==U&&(this._ClearCoatBumpTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(U){this._ClearCoatTintTextureEnabled!==U&&(this._ClearCoatTintTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(U){this._SheenTextureEnabled!==U&&(this._SheenTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(U){this._AnisotropicTextureEnabled!==U&&(this._AnisotropicTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(U){this._ThicknessTextureEnabled!==U&&(this._ThicknessTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(U){this._RefractionIntensityTextureEnabled!==U&&(this._RefractionIntensityTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._TranslucencyIntensityTextureEnabled}static set TranslucencyIntensityTextureEnabled(U){this._TranslucencyIntensityTextureEnabled!==U&&(this._TranslucencyIntensityTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get TranslucencyColorTextureEnabled(){return this._TranslucencyColorTextureEnabled}static set TranslucencyColorTextureEnabled(U){this._TranslucencyColorTextureEnabled!==U&&(this._TranslucencyColorTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(U){this._IridescenceTextureEnabled!==U&&(this._IridescenceTextureEnabled=U,M.d.MarkAllMaterialsAsDirty(1))}}t._DiffuseTextureEnabled=!0,t._BaseWeightTextureEnabled=!0,t._BaseDiffuseRoughnessTextureEnabled=!0,t._DetailTextureEnabled=!0,t._DecalMapEnabled=!0,t._AmbientTextureEnabled=!0,t._OpacityTextureEnabled=!0,t._ReflectionTextureEnabled=!0,t._EmissiveTextureEnabled=!0,t._SpecularTextureEnabled=!0,t._BumpTextureEnabled=!0,t._LightmapTextureEnabled=!0,t._RefractionTextureEnabled=!0,t._ColorGradingTextureEnabled=!0,t._FresnelEnabled=!0,t._ClearCoatTextureEnabled=!0,t._ClearCoatBumpTextureEnabled=!0,t._ClearCoatTintTextureEnabled=!0,t._SheenTextureEnabled=!0,t._AnisotropicTextureEnabled=!0,t._ThicknessTextureEnabled=!0,t._RefractionIntensityTextureEnabled=!0,t._TranslucencyIntensityTextureEnabled=!0,t._TranslucencyColorTextureEnabled=!0,t._IridescenceTextureEnabled=!0},11846:(U,W,l)=>{l.d(W,{d:()=>L});var M,t=l(706);!function(U){U[U.Zero=0]="Zero",U[U.One=1]="One",U[U.MaxViewZ=2]="MaxViewZ"}(M||(M={}));class L{static CreateConfiguration(U){return L._Configurations[U]={defines:{},previousWorldMatrices:{},previousViewProjection:t.c.Zero(),currentViewProjection:t.c.Zero(),previousBones:{},lastUpdateFrameId:-1,excludedSkinnedMesh:[],reverseCulling:!1},L._Configurations[U]}static DeleteConfiguration(U){delete L._Configurations[U]}static GetConfiguration(U){return L._Configurations[U]}static AddUniformsAndSamplers(U,W){U.push("previousWorld","previousViewProjection","mPreviousBones")}static MarkAsDirty(U,W){for(const l of W)if(l.uk)for(const W of l.uk)W._removeDrawWrapper(U)}static PrepareDefines(U,W,l){if(!l._arePrePassDirty)return;const M=L._Configurations[U];if(!M)return;l.PREPASS=!0,l.PREPASS_COLOR=!1,l.PREPASS_COLOR_INDEX=-1;let t=0;for(let p=0;p<L.GeometryTextureDescriptions.length;p++){const U=L.GeometryTextureDescriptions[p],W=U.define,B=U.defineIndex,k=M.defines[B];void 0!==k?(l[W]=!0,l[B]=k,t++):(l[W]=!1,delete l[B])}l.SCENE_MRT_COUNT=t,l.BONES_VELOCITY_ENABLED=W.useBones&&W.computeBonesUsingShaders&&W.skeleton&&!W.skeleton.isUsingTextureForMatrices&&-1===M.excludedSkinnedMesh.indexOf(W)}static Bind(U,W,l,M,t){const p=L._Configurations[U];if(!p)return;const B=l.va(),k=B.getEngine();if(p.reverseCulling&&k.setStateCullFaceType(B._mirroredCameraPosition?t.cullBackFaces:!t.cullBackFaces),(void 0!==p.defines.PREPASS_VELOCITY_INDEX||void 0!==p.defines.PREPASS_VELOCITY_LINEAR_INDEX)&&(p.previousWorldMatrices[l.uniqueId]||(p.previousWorldMatrices[l.uniqueId]=M.clone()),p.previousViewProjection||(p.previousViewProjection=B.getTransformMatrix().clone(),p.currentViewProjection=B.getTransformMatrix().clone()),p.currentViewProjection.updateFlag!==B.getTransformMatrix().updateFlag?(p.lastUpdateFrameId=k.frameId,p.previousViewProjection.p(p.currentViewProjection),p.currentViewProjection.p(B.getTransformMatrix())):p.lastUpdateFrameId!==k.frameId&&(p.lastUpdateFrameId=k.frameId,p.previousViewProjection.p(p.currentViewProjection)),W.setMatrix("previousWorld",p.previousWorldMatrices[l.uniqueId]),W.setMatrix("previousViewProjection",p.previousViewProjection),p.previousWorldMatrices[l.uniqueId]=M.clone(),l.useBones&&l.computeBonesUsingShaders&&l.skeleton)){const U=l.skeleton;if(!U.isUsingTextureForMatrices||-1===W.getUniformIndex("boneTextureWidth")){const M=U.getTransformMatrices(l);M&&(p.previousBones[l.uniqueId]||(p.previousBones[l.uniqueId]=M.slice()),W.setMatrices("mPreviousBones",p.previousBones[l.uniqueId]),p.previousBones[l.uniqueId].set(M))}}}}L.GeometryTextureDescriptions=[{type:0,name:"Irradiance",clearType:0,define:"PREPASS_IRRADIANCE",defineIndex:"PREPASS_IRRADIANCE_INDEX"},{type:1,name:"WorldPosition",clearType:0,define:"PREPASS_POSITION",defineIndex:"PREPASS_POSITION_INDEX"},{type:2,name:"Velocity",clearType:0,define:"PREPASS_VELOCITY",defineIndex:"PREPASS_VELOCITY_INDEX"},{type:3,name:"Reflectivity",clearType:0,define:"PREPASS_REFLECTIVITY",defineIndex:"PREPASS_REFLECTIVITY_INDEX"},{type:5,name:"ViewDepth",clearType:2,define:"PREPASS_DEPTH",defineIndex:"PREPASS_DEPTH_INDEX"},{type:6,name:"ViewNormal",clearType:0,define:"PREPASS_NORMAL",defineIndex:"PREPASS_NORMAL_INDEX"},{type:7,name:"AlbedoSqrt",clearType:0,define:"PREPASS_ALBEDO_SQRT",defineIndex:"PREPASS_ALBEDO_SQRT_INDEX"},{type:8,name:"WorldNormal",clearType:0,define:"PREPASS_WORLD_NORMAL",defineIndex:"PREPASS_WORLD_NORMAL_INDEX"},{type:9,name:"LocalPosition",clearType:0,define:"PREPASS_LOCAL_POSITION",defineIndex:"PREPASS_LOCAL_POSITION_INDEX"},{type:10,name:"ScreenDepth",clearType:1,define:"PREPASS_SCREENSPACE_DEPTH",defineIndex:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:11,name:"LinearVelocity",clearType:0,define:"PREPASS_VELOCITY_LINEAR",defineIndex:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:12,name:"Albedo",clearType:0,define:"PREPASS_ALBEDO",defineIndex:"PREPASS_ALBEDO_INDEX"},{type:13,name:"NormalizedViewDepth",clearType:1,define:"PREPASS_NORMALIZED_VIEW_DEPTH",defineIndex:"PREPASS_NORMALIZED_VIEW_DEPTH_INDEX"}],L._Configurations={}},11821:(U,W,l)=>{l.d(W,{c:()=>m});var M=l(686),t=l(688),L=l(851),p=l(543),B=l(569),k=l(604);const A=new RegExp("^([gimus]+)!");class q{constructor(U){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=U,this._scene=U.va(),this._engine=this._scene.getEngine()}_addPlugin(U){for(let M=0;M<this._plugins.length;++M)if(this._plugins[M].name===U.name)return!1;if(this._material._uniformBufferLayoutBuilt&&(this._material.resetDrawCache(),this._material._createUniformBuffer()),!U.isCompatible(this._material.shaderLanguage))throw`The plugin "${U.name}" can't be added to the material "${this._material.name}" because the plugin is not compatible with the shader language of the material.`;const W=U.getClassName();q._MaterialPluginClassToMainDefine[W]||(q._MaterialPluginClassToMainDefine[W]="MATERIALPLUGIN_"+ ++q._MaterialPluginCounter),this._material._callbackPluginEventGeneric=(U,W)=>this._handlePluginEvent(U,W),this._plugins.push(U),this._plugins.sort(((U,W)=>U.priority-W.priority)),this._codeInjectionPoints={};const l={};l[q._MaterialPluginClassToMainDefine[W]]={type:"boolean",default:!0};for(const M of this._plugins)M.collectDefines(l),this._collectPointNames("vertex",M.getCustomCode("vertex",this._material.shaderLanguage)),this._collectPointNames("fragment",M.getCustomCode("fragment",this._material.shaderLanguage));return this._defineNamesFromPlugins=l,!0}_activatePlugin(U){-1===this._activePlugins.indexOf(U)&&(this._activePlugins.push(U),this._activePlugins.sort(((U,W)=>U.priority-W.priority)),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),U.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(U),this._activePluginsForExtraEvents.sort(((U,W)=>U.priority-W.priority)),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(U){for(let W=0;W<this._plugins.length;++W)if(this._plugins[W].name===U)return this._plugins[W];return null}_handlePluginEventIsReadyForSubMesh(U){let W=!0;for(const l of this._activePlugins)W=W&&l.isReadyForSubMesh(U.defines,this._scene,this._engine,U.subMesh);U.isReadyForSubMesh=W}_handlePluginEventPrepareDefinesBeforeAttributes(U){for(const W of this._activePlugins)W.prepareDefinesBeforeAttributes(U.defines,this._scene,U.mesh)}_handlePluginEventPrepareDefines(U){for(const W of this._activePlugins)W.prepareDefines(U.defines,this._scene,U.mesh)}_handlePluginEventHardBindForSubMesh(U){for(const W of this._activePluginsForExtraEvents)W.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,U.subMesh)}_handlePluginEventBindForSubMesh(U){for(const W of this._activePlugins)W.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,U.subMesh)}_handlePluginEventHasRenderTargetTextures(U){let W=!1;for(const l of this._activePluginsForExtraEvents)if(W=l.hasRenderTargetTextures(),W)break;U.hasRenderTargetTextures=W}_handlePluginEventFillRenderTargetTextures(U){for(const W of this._activePluginsForExtraEvents)W.fillRenderTargetTextures(U.renderTargets)}_handlePluginEvent(U,W){switch(U){case 512:{const U=W;for(const W of this._activePlugins)W.getActiveTextures(U.activeTextures);break}case 256:{const U=W;for(const W of this._activePlugins)W.getAnimatables(U.animatables);break}case 1024:{const U=W;let l=!1;for(const W of this._activePlugins)if(l=W.hasTexture(U.texture),l)break;U.hasTexture=l;break}case 2:{const U=W;for(const W of this._plugins)W.dispose(U.forceDisposeTextures);break}case 4:W.defineNames=this._defineNamesFromPlugins;break;case 128:{const U=W;for(const W of this._activePlugins)U.fallbackRank=W.addFallbacks(U.defines,U.fallbacks,U.fallbackRank),W.getAttributes(U.attributes,this._scene,U.mesh);this._uniformList.length>0&&U.uniforms.push(...this._uniformList),this._samplerList.length>0&&U.samplers.push(...this._samplerList),this._uboList.length>0&&U.uniformBuffersNames.push(...this._uboList),U.customCode=this._injectCustomCode(U,U.customCode);break}case 8:{const U=W;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];const l=1===this._material.shaderLanguage;for(const W of this._plugins){const M=W.getUniforms(this._material.shaderLanguage);if(M){if(M.ubo)for(const W of M.ubo){if(W.size&&W.type){const M=W.arraySize??0;if(U.ubo.addUniform(W.name,W.size,M),l){let U;switch(W.type){case"mat4":U="mat4x4f";break;case"float":U="f32";break;default:U=`${W.type}f`}this._uboDeclaration+=M>0?`uniform ${W.name}: array<${U}, ${M}>;\n`:`uniform ${W.name}: ${U};\n`}else this._uboDeclaration+=`${W.type} ${W.name}${M>0?`[${M}]`:""};\n`}this._uniformList.push(W.name)}M.vertex&&(this._vertexDeclaration+=M.vertex+"\n"),M.fragment&&(this._fragmentDeclaration+=M.fragment+"\n")}W.getSamplers(this._samplerList),W.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(U,W){if(W)for(const l in W)this._codeInjectionPoints[U]||(this._codeInjectionPoints[U]={}),this._codeInjectionPoints[U][l]=!0}_injectCustomCode(U,W){return(l,M)=>{var t;W&&(M=W(l,M)),this._uboDeclaration&&(M=M.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(M=M.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(M=M.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const L=null===(t=this._codeInjectionPoints)||void 0===t?void 0:t[l];if(!L)return M;let p=null;for(let W in L){let t="";for(const M of this._activePlugins){var q;let L=null===(q=M.getCustomCode(l,this._material.shaderLanguage))||void 0===q?void 0:q[W];if(L){if(M.resolveIncludes){if(null===p){const W=0;p={defines:[],indexParameters:U.indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:void 0,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:k.d.GetShadersRepository(W),includesShadersStore:k.d.GetIncludesShadersStore(W),version:void 0,platformName:this._engine.shaderPlatformName,processingContext:void 0,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:void 0}}p.isFragment="fragment"===l,(0,B.i)(L,p,(U=>L=U))}t+=L+"\n"}}if(t.length>0)if("!"===W.charAt(0)){W=W.substring(1);let U="g";if("!"===W.charAt(0))U="",W=W.substring(1);else{const l=A.exec(W);l&&l.length>=2&&(U=l[1],W=W.substring(U.length+1))}U.indexOf("g")<0&&(U+="g");const l=M,L=new RegExp(W,U);let p=L.exec(l);for(;null!==p;){let U=t;for(let W=0;W<p.length;++W)U=U.replace("$"+W,p[W]);M=M.replace(p[0],U),p=L.exec(l)}}else{const U="#define "+W;M=M.replace(U,"\n"+t+"\n"+U)}}return M}}}q._MaterialPluginClassToMainDefine={},q._MaterialPluginCounter=0,p.d.OnEnginesDisposedObservable.add((()=>{w()}));const y=[];let j=!1,s=null;function w(){y.length=0,j=!1,L.b.OnEventObservable.remove(s),s=null}var K=l(734),r=l(655);class m{isCompatible(U){return 0===U}_enable(U){U&&this._pluginManager._activatePlugin(this)}constructor(U,W,l,M){let t=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],L=arguments.length>5&&void 0!==arguments[5]&&arguments[5],p=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.priority=500,this.resolveIncludes=!1,this.registerForExtraEvents=!1,this.doNotSerialize=!1,this._material=U,this.name=W,this.priority=l,this.resolveIncludes=p,U.pluginManager||(U.pluginManager=new q(U),U.nk.add((()=>{U.pluginManager=void 0}))),this._pluginDefineNames=M,this._pluginManager=U.pluginManager,t&&this._pluginManager._addPlugin(this),L&&this._enable(!0),this.markAllDefinesAsDirty=U._dirtyCallbacks[127]}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(U,W,l,M){return!0}hardBindForSubMesh(U,W,l,M){}bindForSubMesh(U,W,l,M){}dispose(U){}getCustomCode(U){return null}collectDefines(U){if(this._pluginDefineNames)for(const W of Object.keys(this._pluginDefineNames)){if("_"===W[0])continue;const l=typeof this._pluginDefineNames[W];U[W]={type:"number"===l?"number":"string"===l?"string":"boolean"===l?"boolean":"object",default:this._pluginDefineNames[W]}}}prepareDefinesBeforeAttributes(U,W,l){}prepareDefines(U,W,l){}hasTexture(U){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(U){}getActiveTextures(U){}getAnimatables(U){}addFallbacks(U,W,l){return l}getSamplers(U){}getAttributes(U,W,l){}getUniformBuffersNames(U){}getUniforms(){return{}}copyTo(U){K.e.Clone((()=>U),this)}serialize(){return K.e.Serialize(this)}parse(U,W,l){K.e.Parse((()=>this),U,W,l)}}(0,M.e)([(0,t.T)()],m.prototype,"name",void 0),(0,M.e)([(0,t.T)()],m.prototype,"priority",void 0),(0,M.e)([(0,t.T)()],m.prototype,"resolveIncludes",void 0),(0,M.e)([(0,t.T)()],m.prototype,"registerForExtraEvents",void 0),(0,r.f)("BABYLON.MaterialPluginBase",m)},11824:(U,W,l)=>{l.d(W,{b:()=>M});class M{constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(U){U.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(U){}bindForSubMesh(U,W,l,M,t){if(W.prePassRenderer&&W.prePassRenderer.enabled&&W.prePassRenderer.currentRTisSceneRT&&(-1!==W.prePassRenderer.getIndex(2)||-1!==W.prePassRenderer.getIndex(11))){this.previousWorldMatrices[l.uniqueId]||(this.previousWorldMatrices[l.uniqueId]=M.clone()),this.previousViewProjection||(this.previousViewProjection=W.getTransformMatrix().clone(),this.currentViewProjection=W.getTransformMatrix().clone());const t=W.getEngine();this.currentViewProjection.updateFlag!==W.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=t.frameId,this.previousViewProjection.p(this.currentViewProjection),this.currentViewProjection.p(W.getTransformMatrix())):this._lastUpdateFrameId!==t.frameId&&(this._lastUpdateFrameId=t.frameId,this.previousViewProjection.p(this.currentViewProjection)),U.setMatrix("previousWorld",this.previousWorldMatrices[l.uniqueId]),U.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[l.uniqueId]=M.clone()}}}},11826:(U,W,l)=>{l.d(W,{d:()=>L});var M=l(706),t=l(851);class L extends t.b{constructor(U,W){let l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(U,W,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new M.c,this._storeEffectOnSubMeshes=l}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(U,W){return!!U&&(!this._storeEffectOnSubMeshes||(!U.uk||0===U.uk.length||this.isReadyForSubMesh(U,U.uk[0],W)))}_isReadyForSubMesh(U){const W=U.materialDefines;return!(this.checkReadyOnEveryCall||!U.effect||!W||W._renderId!==this.va().getRenderId())}bindOnlyWorldMatrix(U){this._activeEffect.setMatrix("world",U)}bindOnlyNormalMatrix(U){this._activeEffect.setMatrix("normalMatrix",U)}bind(U,W){W&&this.bindForSubMesh(U,W,W.uk[0])}_afterBind(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2?arguments[2]:void 0;super._afterBind(U,W,l),this.va()._cachedEffect=W,l?l._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(U,W,l){let M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return l._drawWrapper._forceRebindOnNextCall||U.isCachedMaterialInvalid(this,W,M)}dispose(U,W,l){this._activeEffect=void 0,super.dispose(U,W,l)}}},11879:(U,W,l)=>{l.d(W,{b:()=>r});var M=l(734),t=l(2178),L=l(706),p=l(763),B=l(2048),k=l(655),A=l(11832),q=l(541),y=l(11826),j=l(543),s=l(868),w=l(854);const K={effect:null,subMesh:null};class r extends y.d{constructor(U,W,l){let M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(U,W,!(arguments.length>4&&void 0!==arguments[4])||arguments[4]),this._textures={},this._textureArrays={},this._externalTextures={},this._floats={},this._ints={},this._uints={},this._floatsArrays={},this._colors3={},this._colors3Arrays={},this._colors4={},this._colors4Arrays={},this._vectors2={},this._vectors3={},this._vectors4={},this._quaternions={},this._quaternionsArrays={},this._matrices={},this._matrixArrays={},this._matrices3x3={},this._matrices2x2={},this._vectors2Arrays={},this._vectors3Arrays={},this._vectors4Arrays={},this._uniformBuffers={},this._textureSamplers={},this._storageBuffers={},this._cachedWorldViewMatrix=new L.c,this._cachedWorldViewProjectionMatrix=new L.c,this._multiview=!1,this._materialHelperNeedsPreviousMatrices=!1,this._shaderPath=l,this._options={needAlphaBlending:!1,needAlphaTesting:!1,attributes:["position","rk","uv"],uniforms:["worldViewProjection"],uniformBuffers:[],samplers:[],externalTextures:[],samplerObjects:[],storageBuffers:[],defines:[],useClipPlane:!1,...M}}get shaderPath(){return this._shaderPath}set shaderPath(U){this._shaderPath=U}get options(){return this._options}get isMultiview(){return this._multiview}getClassName(){return"ShaderMaterial"}needAlphaBlending(){return this.alpha<1||this._options.needAlphaBlending}needAlphaTesting(){return this._options.needAlphaTesting}_checkUniform(U){-1===this._options.uniforms.indexOf(U)&&this._options.uniforms.push(U)}setTexture(U,W){return-1===this._options.samplers.indexOf(U)&&this._options.samplers.push(U),this._textures[U]=W,this}removeTexture(U){delete this._textures[U]}setTextureArray(U,W){return-1===this._options.samplers.indexOf(U)&&this._options.samplers.push(U),this._checkUniform(U),this._textureArrays[U]=W,this}setExternalTexture(U,W){return-1===this._options.externalTextures.indexOf(U)&&this._options.externalTextures.push(U),this._externalTextures[U]=W,this}setFloat(U,W){return this._checkUniform(U),this._floats[U]=W,this}setInt(U,W){return this._checkUniform(U),this._ints[U]=W,this}setUInt(U,W){return this._checkUniform(U),this._uints[U]=W,this}setFloats(U,W){return this._checkUniform(U),this._floatsArrays[U]=W,this}setColor3(U,W){return this._checkUniform(U),this._colors3[U]=W,this}setColor3Array(U,W){return this._checkUniform(U),this._colors3Arrays[U]=W.reduce(((U,W)=>(U.push(W.r,W.g,W.b),U)),[]),this}setColor4(U,W){return this._checkUniform(U),this._colors4[U]=W,this}setColor4Array(U,W){return this._checkUniform(U),this._colors4Arrays[U]=W.reduce(((U,W)=>(U.push(W.r,W.g,W.b,W.a),U)),[]),this}setVector2(U,W){return this._checkUniform(U),this._vectors2[U]=W,this}setVector3(U,W){return this._checkUniform(U),this._vectors3[U]=W,this}setVector4(U,W){return this._checkUniform(U),this._vectors4[U]=W,this}setQuaternion(U,W){return this._checkUniform(U),this._quaternions[U]=W,this}setQuaternionArray(U,W){return this._checkUniform(U),this._quaternionsArrays[U]=W.reduce(((U,W)=>(W.toArray(U,U.length),U)),[]),this}setMatrix(U,W){return this._checkUniform(U),this._matrices[U]=W,this}setMatrices(U,W){this._checkUniform(U);const l=new Float32Array(16*W.length);for(let M=0;M<W.length;M++){W[M].copyToArray(l,16*M)}return this._matrixArrays[U]=l,this}setMatrix3x3(U,W){return this._checkUniform(U),this._matrices3x3[U]=W,this}setMatrix2x2(U,W){return this._checkUniform(U),this._matrices2x2[U]=W,this}setArray2(U,W){return this._checkUniform(U),this._vectors2Arrays[U]=W,this}setArray3(U,W){return this._checkUniform(U),this._vectors3Arrays[U]=W,this}setArray4(U,W){return this._checkUniform(U),this._vectors4Arrays[U]=W,this}setUniformBuffer(U,W){return-1===this._options.uniformBuffers.indexOf(U)&&this._options.uniformBuffers.push(U),this._uniformBuffers[U]=W,this}setTextureSampler(U,W){return-1===this._options.samplerObjects.indexOf(U)&&this._options.samplerObjects.push(U),this._textureSamplers[U]=W,this}setStorageBuffer(U,W){return-1===this._options.storageBuffers.indexOf(U)&&this._options.storageBuffers.push(U),this._storageBuffers[U]=W,this}setDefine(U,W){const l=U.trimEnd()+" ",M=this.options.defines.findIndex((W=>W===U||W.startsWith(l)));return M>=0&&this.options.defines.splice(M,1),("boolean"!==typeof W||W)&&this.options.defines.push(l+W),this}isReadyForSubMesh(U,W,l){return this.isReady(U,l,W)}isReady(U,W,l){var M;const L=l&&this._storeEffectOnSubMeshes;if(this.isFrozen){const U=L?l._drawWrapper:this._drawWrapper;if(U.effect&&U._wasPreviouslyReady&&U._wasPreviouslyUsingInstances===W)return!0}const B=this.va(),k=B.getEngine(),q=[],y=[];let j=null,r=this._shaderPath,m=this._options.uniforms,f=this._options.uniformBuffers,g=this._options.samplers;k.getCaps().multiview&&B.activeCamera&&B.activeCamera.outputRenderTarget&&B.activeCamera.outputRenderTarget.getViewCount()>1&&(this._multiview=!0,q.push("#define MULTIVIEW"),-1!==m.indexOf("viewProjection")&&-1===m.indexOf("viewProjectionR")&&m.push("viewProjectionR"));for(let t=0;t<this._options.defines.length;t++){const U=0===this._options.defines[t].indexOf("#define")?this._options.defines[t]:`#define ${this._options.defines[t]}`;q.push(U)}for(let t=0;t<this._options.attributes.length;t++)y.push(this._options.attributes[t]);if(U&&U.isVerticesDataPresent(p.e.ColorKind)&&(-1===y.indexOf(p.e.ColorKind)&&y.push(p.e.ColorKind),q.push("#define VERTEXCOLOR")),W&&(q.push("#define INSTANCES"),(0,w.hb)(y,this._materialHelperNeedsPreviousMatrices),null!==U&&void 0!==U&&U.hasThinInstances&&(q.push("#define THIN_INSTANCES"),U&&U.isVerticesDataPresent(p.e.ColorInstanceKind)&&(y.push(p.e.ColorInstanceKind),q.push("#define INSTANCESCOLOR")))),U&&U.useBones&&U.computeBonesUsingShaders&&U.skeleton){y.push(p.e.MatricesIndicesKind),y.push(p.e.MatricesWeightsKind),U.numBoneInfluencers>4&&(y.push(p.e.MatricesIndicesExtraKind),y.push(p.e.MatricesWeightsExtraKind));const W=U.skeleton;q.push("#define NUM_BONE_INFLUENCERS "+U.numBoneInfluencers),j=new A.e,j.addCPUSkinningFallback(0,U),W.isUsingTextureForMatrices?(q.push("#define BONETEXTURE"),-1===m.indexOf("boneTextureWidth")&&m.push("boneTextureWidth"),-1===this._options.samplers.indexOf("boneSampler")&&this._options.samplers.push("boneSampler")):(q.push("#define BonesPerMesh "+(W.bones.length+1)),-1===m.indexOf("mBones")&&m.push("mBones"))}else q.push("#define NUM_BONE_INFLUENCERS 0");let E=0;const Z=U?U.morphTargetManager:null;if(Z){const W=-1!==q.indexOf("#define UV1"),l=-1!==q.indexOf("#define UV2"),M=-1!==q.indexOf("#define TANGENT"),t=-1!==q.indexOf("#define NORMAL"),L=-1!==q.indexOf("#define VERTEXCOLOR");E=(0,w.L)(Z,q,y,U,!0,t,M,W,l,L),Z.isUsingTextureForTargets&&(-1===m.indexOf("morphTargetTextureIndices")&&m.push("morphTargetTextureIndices"),-1===this._options.samplers.indexOf("morphTargets")&&this._options.samplers.push("morphTargets")),E>0&&(m=m.slice(),m.push("morphTargetInfluences"),m.push("morphTargetCount"),m.push("morphTargetTextureInfo"),m.push("morphTargetTextureIndices"))}else q.push("#define NUM_MORPH_INFLUENCERS 0");if(U){const W=U.bakedVertexAnimationManager;W&&W.isEnabled&&(q.push("#define BAKED_VERTEX_ANIMATION_TEXTURE"),-1===m.indexOf("bakedVertexAnimationSettings")&&m.push("bakedVertexAnimationSettings"),-1===m.indexOf("bakedVertexAnimationTextureSizeInverted")&&m.push("bakedVertexAnimationTextureSizeInverted"),-1===m.indexOf("bakedVertexAnimationTime")&&m.push("bakedVertexAnimationTime"),-1===this._options.samplers.indexOf("bakedVertexAnimationTexture")&&this._options.samplers.push("bakedVertexAnimationTexture")),(0,w.B)(y,U,q)}for(const t in this._textures)if(!this._textures[t].isReady())return!1;U&&this.needAlphaTestingForMesh(U)&&q.push("#define ALPHATEST"),!1!==this._options.useClipPlane&&((0,s.c)(m),(0,s.m)(this,B,q)),B.fogEnabled&&null!==U&&void 0!==U&&U.applyFog&&B.fogMode!==t.c.FOGMODE_NONE&&(q.push("#define FOG"),-1===m.indexOf("view")&&m.push("view"),-1===m.indexOf("vFogInfos")&&m.push("vFogInfos"),-1===m.indexOf("vFogColor")&&m.push("vFogColor")),this._useLogarithmicDepth&&(q.push("#define LOGARITHMICDEPTH"),-1===m.indexOf("logarithmicDepthConstant")&&m.push("logarithmicDepthConstant")),this.customShaderNameResolve&&(m=m.slice(),f=f.slice(),g=g.slice(),r=this.customShaderNameResolve(this.name,m,f,g,q,y));const N=L?l._getDrawWrapper(void 0,!0):this._drawWrapper,D=(null===N||void 0===N?void 0:N.effect)??null,o=(null===N||void 0===N?void 0:N.defines)??null,i=q.join("\n");let O=D;return o!==i&&(O=k.createEffect(r,{attributes:y,uniformsNames:m,uniformBuffersNames:f,samplers:g,defines:i,fallbacks:j,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousMorphTargets:E},shaderLanguage:this._options.shaderLanguage,extraInitializationsAsync:this._options.extraInitializationsAsync},k),L?l.setEffect(O,i,this._materialContext):N&&N.setEffect(O,i),this._onEffectCreatedObservable&&(K.effect=O,K.subMesh=l??(null===U||void 0===U?void 0:U.uk[0])??null,this._onEffectCreatedObservable.notifyObservers(K))),N._wasPreviouslyUsingInstances=!!W,!(null===(M=O)||void 0===M||!M.isReady())&&(D!==O&&B.resetCachedMaterial(),N._wasPreviouslyReady=!0,!0)}bindOnlyWorldMatrix(U,W){const l=W??this.getEffect();if(!l)return;const M=this._options.uniforms;-1!==M.indexOf("world")&&l.setMatrix("world",U);const t=this.va();-1!==M.indexOf("worldView")&&(U.multiplyToRef(t.getViewMatrix(),this._cachedWorldViewMatrix),l.setMatrix("worldView",this._cachedWorldViewMatrix)),-1!==M.indexOf("worldViewProjection")&&(U.multiplyToRef(t.getTransformMatrix(),this._cachedWorldViewProjectionMatrix),l.setMatrix("worldViewProjection",this._cachedWorldViewProjectionMatrix)),-1!==M.indexOf("view")&&l.setMatrix("view",t.getViewMatrix())}bindForSubMesh(U,W,l){var M;this.bind(U,W,null===(M=l._drawWrapperOverride)||void 0===M?void 0:M.effect,l)}bind(U,W,l,M){const t=M&&this._storeEffectOnSubMeshes,L=l??(t?M.effect:this.getEffect());if(!L)return;const p=this.va();this._activeEffect=L,this.bindOnlyWorldMatrix(U,l);const B=this._options.uniformBuffers;let k=!1;if(L&&B&&B.length>0&&p.getEngine().supportsUniformBuffers)for(let y=0;y<B.length;++y){switch(B[y]){case"Mesh":W&&(W.getMeshUniformBuffer().bindToEffect(L,"Mesh"),W.transferToEffect(U));break;case"Scene":(0,w.t)(L,p.getSceneUniformBuffer()),p.finalizeSceneUbo(),k=!0}}const A=W&&t?this._mustRebind(p,L,M,W.visibility):p.getCachedMaterial()!==this;if(L&&A){let U;for(U in k||-1===this._options.uniforms.indexOf("view")||L.setMatrix("view",p.getViewMatrix()),k||-1===this._options.uniforms.indexOf("projection")||L.setMatrix("projection",p.getProjectionMatrix()),k||-1===this._options.uniforms.indexOf("viewProjection")||(L.setMatrix("viewProjection",p.getTransformMatrix()),this._multiview&&L.setMatrix("viewProjectionR",p._transformMatrixR)),p.activeCamera&&-1!==this._options.uniforms.indexOf("cameraPosition")&&L.setVector3("cameraPosition",p.activeCamera.globalPosition),(0,w.d)(W,L),(0,s.g)(L,this,p),this._useLogarithmicDepth&&(0,w.n)(t?M.materialDefines:L.defines,L,p),W&&(0,w.g)(p,W,L),this._textures)L.setTexture(U,this._textures[U]);for(U in this._textureArrays)L.setTextureArray(U,this._textureArrays[U]);for(U in this._ints)L.setInt(U,this._ints[U]);for(U in this._uints)L.setUInt(U,this._uints[U]);for(U in this._floats)L.setFloat(U,this._floats[U]);for(U in this._floatsArrays)L.setArray(U,this._floatsArrays[U]);for(U in this._colors3)L.setColor3(U,this._colors3[U]);for(U in this._colors3Arrays)L.setArray3(U,this._colors3Arrays[U]);for(U in this._colors4){const W=this._colors4[U];L.setFloat4(U,W.r,W.g,W.b,W.a)}for(U in this._colors4Arrays)L.setArray4(U,this._colors4Arrays[U]);for(U in this._vectors2)L.setVector2(U,this._vectors2[U]);for(U in this._vectors3)L.setVector3(U,this._vectors3[U]);for(U in this._vectors4)L.setVector4(U,this._vectors4[U]);for(U in this._quaternions)L.setQuaternion(U,this._quaternions[U]);for(U in this._matrices)L.setMatrix(U,this._matrices[U]);for(U in this._matrixArrays)L.setMatrices(U,this._matrixArrays[U]);for(U in this._matrices3x3)L.setMatrix3x3(U,this._matrices3x3[U]);for(U in this._matrices2x2)L.setMatrix2x2(U,this._matrices2x2[U]);for(U in this._vectors2Arrays)L.setArray2(U,this._vectors2Arrays[U]);for(U in this._vectors3Arrays)L.setArray3(U,this._vectors3Arrays[U]);for(U in this._vectors4Arrays)L.setArray4(U,this._vectors4Arrays[U]);for(U in this._quaternionsArrays)L.setArray4(U,this._quaternionsArrays[U]);for(U in this._uniformBuffers){const W=this._uniformBuffers[U].getBuffer();W&&L.bindUniformBuffer(W,U)}const l=p.getEngine(),B=l.setExternalTexture;if(B)for(U in this._externalTextures)B.call(l,U,this._externalTextures[U]);const A=l.setTextureSampler;if(A)for(U in this._textureSamplers)A.call(l,U,this._textureSamplers[U]);const q=l.setStorageBuffer;if(q)for(U in this._storageBuffers)q.call(l,U,this._storageBuffers[U])}if(L&&W&&(A||!this.isFrozen)){(0,w.q)(W,L),W.morphTargetManager&&W.morphTargetManager.isUsingTextureForTargets&&W.morphTargetManager._bind(L);const U=W.bakedVertexAnimationManager;if(U&&U.isEnabled){var q;const U=t?M._drawWrapper:this._drawWrapper;null===(q=W.bakedVertexAnimationManager)||void 0===q||q.bind(L,!!U._wasPreviouslyUsingInstances)}}this._afterBind(W,L,M)}getActiveTextures(){const U=super.getActiveTextures();for(const W in this._textures)U.push(this._textures[W]);for(const W in this._textureArrays){const l=this._textureArrays[W];for(let W=0;W<l.length;W++)U.push(l[W])}return U}hasTexture(U){if(super.hasTexture(U))return!0;for(const W in this._textures)if(this._textures[W]===U)return!0;for(const W in this._textureArrays){const l=this._textureArrays[W];for(let W=0;W<l.length;W++)if(l[W]===U)return!0}return!1}clone(U){const W=M.e.Clone((()=>new r(U,this.va(),this._shaderPath,this._options,this._storeEffectOnSubMeshes)),this);W.name=U,W.id=U,"object"===typeof W._shaderPath&&(W._shaderPath={...W._shaderPath}),this._options={...this._options};const l=Object.keys(this._options);for(const M of l){const U=this._options[M];Array.isArray(U)&&(this._options[M]=U.slice(0))}this.stencil.copyTo(W.stencil);for(const M in this._textures)W.setTexture(M,this._textures[M]);for(const M in this._textureArrays)W.setTextureArray(M,this._textureArrays[M]);for(const M in this._externalTextures)W.setExternalTexture(M,this._externalTextures[M]);for(const M in this._ints)W.setInt(M,this._ints[M]);for(const M in this._uints)W.setUInt(M,this._uints[M]);for(const M in this._floats)W.setFloat(M,this._floats[M]);for(const M in this._floatsArrays)W.setFloats(M,this._floatsArrays[M]);for(const M in this._colors3)W.setColor3(M,this._colors3[M]);for(const M in this._colors3Arrays)W._colors3Arrays[M]=this._colors3Arrays[M];for(const M in this._colors4)W.setColor4(M,this._colors4[M]);for(const M in this._colors4Arrays)W._colors4Arrays[M]=this._colors4Arrays[M];for(const M in this._vectors2)W.setVector2(M,this._vectors2[M]);for(const M in this._vectors3)W.setVector3(M,this._vectors3[M]);for(const M in this._vectors4)W.setVector4(M,this._vectors4[M]);for(const M in this._quaternions)W.setQuaternion(M,this._quaternions[M]);for(const M in this._quaternionsArrays)W._quaternionsArrays[M]=this._quaternionsArrays[M];for(const M in this._matrices)W.setMatrix(M,this._matrices[M]);for(const M in this._matrixArrays)W._matrixArrays[M]=this._matrixArrays[M].slice();for(const M in this._matrices3x3)W.setMatrix3x3(M,this._matrices3x3[M]);for(const M in this._matrices2x2)W.setMatrix2x2(M,this._matrices2x2[M]);for(const M in this._vectors2Arrays)W.setArray2(M,this._vectors2Arrays[M]);for(const M in this._vectors3Arrays)W.setArray3(M,this._vectors3Arrays[M]);for(const M in this._vectors4Arrays)W.setArray4(M,this._vectors4Arrays[M]);for(const M in this._uniformBuffers)W.setUniformBuffer(M,this._uniformBuffers[M]);for(const M in this._textureSamplers)W.setTextureSampler(M,this._textureSamplers[M]);for(const M in this._storageBuffers)W.setStorageBuffer(M,this._storageBuffers[M]);return W}dispose(U,W,l){if(W){let U;for(U in this._textures)this._textures[U].dispose();for(U in this._textureArrays){const W=this._textureArrays[U];for(let U=0;U<W.length;U++)W[U].dispose()}}this._textures={},super.dispose(U,W,l)}serialize(){const U=M.e.Serialize(this);let W;for(W in U.customType="BABYLON.ShaderMaterial",U.uniqueId=this.uniqueId,U.options=this._options,U.shaderPath=this._shaderPath,U.storeEffectOnSubMeshes=this._storeEffectOnSubMeshes,U.stencil=this.stencil.serialize(),U.textures={},this._textures)U.textures[W]=this._textures[W].serialize();for(W in U.textureArrays={},this._textureArrays){U.textureArrays[W]=[];const l=this._textureArrays[W];for(let M=0;M<l.length;M++)U.textureArrays[W].push(l[M].serialize())}for(W in U.ints={},this._ints)U.ints[W]=this._ints[W];for(W in U.uints={},this._uints)U.uints[W]=this._uints[W];for(W in U.floats={},this._floats)U.floats[W]=this._floats[W];for(W in U.floatsArrays={},this._floatsArrays)U.floatsArrays[W]=this._floatsArrays[W];for(W in U.colors3={},this._colors3){const l=this._colors3[W];U.colors3[W]=[l.r,l.g,l.b]}for(W in U.colors3Arrays={},this._colors3Arrays)U.colors3Arrays[W]=this._colors3Arrays[W];for(W in U.colors4={},this._colors4){const l=this._colors4[W];U.colors4[W]=[l.r,l.g,l.b,l.a]}for(W in U.colors4Arrays={},this._colors4Arrays)U.colors4Arrays[W]=this._colors4Arrays[W];for(W in U.vectors2={},this._vectors2){const l=this._vectors2[W];U.vectors2[W]=[l.x,l.y]}for(W in U.vectors3={},this._vectors3){const l=this._vectors3[W];U.vectors3[W]=[l.x,l.y,l.z]}for(W in U.vectors4={},this._vectors4){const l=this._vectors4[W];U.vectors4[W]=[l.x,l.y,l.z,l.w]}for(W in U.quaternions={},this._quaternions)U.quaternions[W]=this._quaternions[W].qk();for(W in U.matrices={},this._matrices)U.matrices[W]=this._matrices[W].qk();for(W in U.matrixArray={},this._matrixArrays)U.matrixArray[W]=this._matrixArrays[W];for(W in U.matrices3x3={},this._matrices3x3)U.matrices3x3[W]=this._matrices3x3[W];for(W in U.matrices2x2={},this._matrices2x2)U.matrices2x2[W]=this._matrices2x2[W];for(W in U.vectors2Arrays={},this._vectors2Arrays)U.vectors2Arrays[W]=this._vectors2Arrays[W];for(W in U.vectors3Arrays={},this._vectors3Arrays)U.vectors3Arrays[W]=this._vectors3Arrays[W];for(W in U.vectors4Arrays={},this._vectors4Arrays)U.vectors4Arrays[W]=this._vectors4Arrays[W];for(W in U.quaternionsArrays={},this._quaternionsArrays)U.quaternionsArrays[W]=this._quaternionsArrays[W];return U}static Parse(U,W,l){const t=M.e.Parse((()=>new r(U.name,W,U.shaderPath,U.options,U.storeEffectOnSubMeshes)),U,W,l);let p;for(p in U.stencil&&t.stencil.parse(U.stencil,W,l),U.textures)t.setTexture(p,B.d.Parse(U.textures[p],W,l));for(p in U.textureArrays){const M=U.textureArrays[p],L=[];for(let U=0;U<M.length;U++)L.push(B.d.Parse(M[U],W,l));t.setTextureArray(p,L)}for(p in U.ints)t.setInt(p,U.ints[p]);for(p in U.uints)t.setUInt(p,U.uints[p]);for(p in U.floats)t.setFloat(p,U.floats[p]);for(p in U.floatsArrays)t.setFloats(p,U.floatsArrays[p]);for(p in U.colors3){const W=U.colors3[p];t.setColor3(p,{r:W[0],g:W[1],b:W[2]})}for(p in U.colors3Arrays){const W=U.colors3Arrays[p].reduce(((U,W,l)=>(l%3===0?U.push([W]):U[U.length-1].push(W),U)),[]).map((U=>({r:U[0],g:U[1],b:U[2]})));t.setColor3Array(p,W)}for(p in U.colors4){const W=U.colors4[p];t.setColor4(p,{r:W[0],g:W[1],b:W[2],a:W[3]})}for(p in U.colors4Arrays){const W=U.colors4Arrays[p].reduce(((U,W,l)=>(l%4===0?U.push([W]):U[U.length-1].push(W),U)),[]).map((U=>({r:U[0],g:U[1],b:U[2],a:U[3]})));t.setColor4Array(p,W)}for(p in U.vectors2){const W=U.vectors2[p];t.setVector2(p,{x:W[0],y:W[1]})}for(p in U.vectors3){const W=U.vectors3[p];t.setVector3(p,{x:W[0],y:W[1],z:W[2]})}for(p in U.vectors4){const W=U.vectors4[p];t.setVector4(p,{x:W[0],y:W[1],z:W[2],w:W[3]})}for(p in U.quaternions)t.setQuaternion(p,L.e.gk(U.quaternions[p]));for(p in U.matrices)t.setMatrix(p,L.c.gk(U.matrices[p]));for(p in U.matrixArray)t._matrixArrays[p]=new Float32Array(U.matrixArray[p]);for(p in U.matrices3x3)t.setMatrix3x3(p,U.matrices3x3[p]);for(p in U.matrices2x2)t.setMatrix2x2(p,U.matrices2x2[p]);for(p in U.vectors2Arrays)t.setArray2(p,U.vectors2Arrays[p]);for(p in U.vectors3Arrays)t.setArray3(p,U.vectors3Arrays[p]);for(p in U.vectors4Arrays)t.setArray4(p,U.vectors4Arrays[p]);for(p in U.quaternionsArrays)t.setArray4(p,U.quaternionsArrays[p]);return t}static async ParseFromFileAsync(U,W,l){let M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return await new Promise(((t,L)=>{const p=new q.c;p.addEventListener("readystatechange",(()=>{if(4==p.readyState)if(200==p.status){const W=JSON.parse(p.responseText),L=this.Parse(W,l||j.d.LastCreatedScene,M);U&&(L.name=U),t(L)}else L("Unable to load the ShaderMaterial")})),p.open("GET",W),p.send()}))}static async ParseFromSnippetAsync(U,W){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return await new Promise(((M,t)=>{const L=new q.c;L.addEventListener("readystatechange",(()=>{if(4==L.readyState)if(200==L.status){const t=JSON.parse(JSON.parse(L.responseText).jsonPayload),p=JSON.parse(t.shaderMaterial),B=this.Parse(p,W||j.d.LastCreatedScene,l);B.snippetId=U,M(B)}else t("Unable to load the snippet "+U)})),L.open("GET",this.SnippetUrl+"/"+U.replace(/#/g,"/")),L.send()}))}}r.SnippetUrl="https://snippet.babylonjs.com",r.CreateFromSnippetAsync=r.ParseFromSnippetAsync,(0,k.f)("BABYLON.ShaderMaterial",r)},11851:(U,W,l)=>{l.d(W,{e:()=>i});var M=l(686),t=l(688),L=l(702),p=l(2178),B=l(742),k=l(763),A=l(11824),q=l(2183),y=l(851),j=l(11816),s=l(11826),w=l(2048),K=l(655),r=l(11829),m=l(11832),f=l(11840),g=l(868),E=l(854),Z=l(734),N=l(11846);const D={effect:null,subMesh:null};class o extends j.b{constructor(U){super(U),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAX_RHS=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_POSITION=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.MORPHTARGETS_UV2=!1,this.MORPHTARGETS_COLOR=!1,this.MORPHTARGETTEXTURE_HASPOSITIONS=!1,this.MORPHTARGETTEXTURE_HASNORMALS=!1,this.MORPHTARGETTEXTURE_HASTANGENTS=!1,this.MORPHTARGETTEXTURE_HASUVS=!1,this.MORPHTARGETTEXTURE_HASUV2S=!1,this.MORPHTARGETTEXTURE_HASCOLORS=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_COLOR=!1,this.PREPASS_COLOR_INDEX=-1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO=!1,this.PREPASS_ALBEDO_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_SCREENSPACE_DEPTH=!1,this.PREPASS_SCREENSPACE_DEPTH_INDEX=-1,this.PREPASS_NORMALIZED_VIEW_DEPTH=!1,this.PREPASS_NORMALIZED_VIEW_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_NORMAL_WORLDSPACE=!1,this.PREPASS_WORLD_NORMAL=!1,this.PREPASS_WORLD_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_LOCAL_POSITION=!1,this.PREPASS_LOCAL_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_VELOCITY_LINEAR=!1,this.PREPASS_VELOCITY_LINEAR_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=0,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.AREALIGHTSUPPORTED=!0,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.DECAL_AFTER_DETAIL=!1,this.rebuild()}setReflectionMode(U){const W=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const l of W)this[l]=l===U}}class i extends s.d{get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(U){this._attachImageProcessingConfiguration(U),this._markAllSubMeshesAsImageProcessingDirty()}_attachImageProcessingConfiguration(U){U!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=U||this.va().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(U){this.imageProcessingConfiguration.colorCurvesEnabled=U}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(U){this.imageProcessingConfiguration.colorGradingEnabled=U}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(U){this._imageProcessingConfiguration.toneMappingEnabled=U}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(U){this._imageProcessingConfiguration.exposure=U}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(U){this._imageProcessingConfiguration.contrast=U}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(U){this._imageProcessingConfiguration.colorGradingTexture=U}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(U){this._imageProcessingConfiguration.colorCurves=U}get canRenderToMRT(){return!0}constructor(U,W){super(U,W,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]||i.ForceGLSL),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new B.e(0,0,0),this.diffuseColor=new B.e(1,1,1),this.specularColor=new B.e(1,1,1),this.emissiveColor=new B.e(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._applyDecalMapAfterDetailMap=!1,this._shadersLoaded=!1,this._renderTargets=new L.f(16),this._globalAmbientColor=new B.e(0,0,0),this._cacheHasRenderTargetTextures=!1,this.detailMap=new f.b(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new A.b,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),i.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),i.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get hasRenderTargetTextures(){return!!(i.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||(!!(i.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures)}getClassName(){return"eb"}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled)}needAlphaTesting(){return this._hasTransparencyMode?this._transparencyModeIsTest:this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===y.b.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return null!=this._diffuseTexture&&this._diffuseTexture.yi&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==y.b.MATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._diffuseTexture&&this._diffuseTexture.yi||null!=this._opacityTexture}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(U,W){let M=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._uniformBufferLayoutBuilt||this.buildUniformLayout();const t=W._drawWrapper;if(t.effect&&this.isFrozen&&t._wasPreviouslyReady&&t._wasPreviouslyUsingInstances===M)return!0;W.materialDefines||(this._callbackPluginEventGeneric(4,this._eventInfo),W.materialDefines=new o(this._eventInfo.defineNames));const L=this.va(),p=W.materialDefines;if(this._isReadyForSubMesh(W))return!0;const B=L.getEngine();p._needNormals=(0,E.T)(L,U,p,!0,this._maxSimultaneousLights,this._disableLighting),(0,E.$)(L,p);const y=this.needAlphaBlendingForMesh(U)&&this.va().useOrderIndependentTransparency;if((0,E.cb)(L,p,this.canRenderToMRT&&!y),(0,E.bb)(L,p,y),N.d.PrepareDefines(B.currentRenderPassId,U,p),p._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,p._needUVs=!1;for(let U=1;U<=6;++U)p["MAINUV"+U]=!1;if(L.texturesEnabled){if(p.DIFFUSEDIRECTUV=0,p.BUMPDIRECTUV=0,p.AMBIENTDIRECTUV=0,p.OPACITYDIRECTUV=0,p.EMISSIVEDIRECTUV=0,p.SPECULARDIRECTUV=0,p.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&i.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._diffuseTexture,p,"DIFFUSE")}else p.DIFFUSE=!1;if(this._ambientTexture&&i.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._ambientTexture,p,"AMBIENT")}else p.AMBIENT=!1;if(this._opacityTexture&&i.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._opacityTexture,p,"OPACITY"),p.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else p.OPACITY=!1;if(this._reflectionTexture&&i.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(p._needNormals=!0,p.REFLECTION=!0,p.ROUGHNESS=this._roughness>0,p.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,p.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===w.d.INVCUBIC_MODE,p.REFLECTIONMAP_3D=this._reflectionTexture.isCube,p.REFLECTIONMAP_OPPOSITEZ=p.REFLECTIONMAP_3D&&this.va().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,p.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case w.d.EXPLICIT_MODE:p.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case w.d.PLANAR_MODE:p.setReflectionMode("REFLECTIONMAP_PLANAR");break;case w.d.PROJECTION_MODE:p.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case w.d.SKYBOX_MODE:p.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case w.d.SPHERICAL_MODE:p.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case w.d.EQUIRECTANGULAR_MODE:p.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case w.d.FIXED_EQUIRECTANGULAR_MODE:p.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case w.d.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:p.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case w.d.CUBIC_MODE:case w.d.INVCUBIC_MODE:default:p.setReflectionMode("REFLECTIONMAP_CUBIC")}p.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else p.REFLECTION=!1,p.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&i.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._emissiveTexture,p,"EMISSIVE")}else p.EMISSIVE=!1;if(this._lightmapTexture&&i.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._lightmapTexture,p,"LIGHTMAP"),p.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,p.RGBDLIGHTMAP=this._lightmapTexture.isRGBD}else p.LIGHTMAP=!1;if(this._specularTexture&&i.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;(0,E.V)(this._specularTexture,p,"SPECULAR"),p.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else p.SPECULAR=!1;if(L.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&i.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;(0,E.V)(this._bumpTexture,p,"BUMP"),p.PARALLAX=this._useParallax,p.PARALLAX_RHS=L.useRightHandedSystem,p.PARALLAXOCCLUSION=this._useParallaxOcclusion,p.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else p.BUMP=!1,p.PARALLAX=!1,p.PARALLAX_RHS=!1,p.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&i.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;p._needUVs=!0,p.REFRACTION=!0,p.REFRACTIONMAP_3D=this._refractionTexture.isCube,p.RGBDREFRACTION=this._refractionTexture.isRGBD,p.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize}else p.REFRACTION=!1;p.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else p.DIFFUSE=!1,p.AMBIENT=!1,p.OPACITY=!1,p.REFLECTION=!1,p.EMISSIVE=!1,p.LIGHTMAP=!1,p.BUMP=!1,p.REFRACTION=!1;p.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),p.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,p.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,p.SPECULAROVERALPHA=this._useSpecularOverAlpha,p.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,p.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode,p.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(U)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=p,this._eventInfo.subMesh=W,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(p._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(p),p.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,p.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}if(p._areFresnelDirty&&(i.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(p.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,p.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,p.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,p.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,p.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,p.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,p._needNormals=!0,p.FRESNEL=!0):p.FRESNEL=!1),p.AREALIGHTUSED)for(let l=0;l<U.lightSources.length;l++)if(!U.lightSources[l]._isReady())return!1;(0,E.Z)(U,L,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this.needAlphaTestingForMesh(U),p,this._applyDecalMapAfterDetailMap),(0,E.S)(L,B,this,p,M,null,W.getRenderingMesh().hasThinInstances),this._eventInfo.defines=p,this._eventInfo.mesh=U,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),(0,E.O)(U,p,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let j=!1;if(p.isDirty){const M=p._areLightsDisposed;p.markAsProcessed();const t=new m.e;p.REFLECTION&&t.addFallback(0,"REFLECTION"),p.SPECULAR&&t.addFallback(0,"SPECULAR"),p.BUMP&&t.addFallback(0,"BUMP"),p.PARALLAX&&t.addFallback(1,"PARALLAX"),p.PARALLAX_RHS&&t.addFallback(1,"PARALLAX_RHS"),p.PARALLAXOCCLUSION&&t.addFallback(0,"PARALLAXOCCLUSION"),p.SPECULAROVERALPHA&&t.addFallback(0,"SPECULAROVERALPHA"),p.FOG&&t.addFallback(1,"FOG"),p.POINTSIZE&&t.addFallback(0,"POINTSIZE"),p.LOGARITHMICDEPTH&&t.addFallback(0,"LOGARITHMICDEPTH"),(0,E.x)(p,t,this._maxSimultaneousLights),p.SPECULARTERM&&t.addFallback(0,"SPECULARTERM"),p.DIFFUSEFRESNEL&&t.addFallback(1,"DIFFUSEFRESNEL"),p.OPACITYFRESNEL&&t.addFallback(2,"OPACITYFRESNEL"),p.REFLECTIONFRESNEL&&t.addFallback(3,"REFLECTIONFRESNEL"),p.EMISSIVEFRESNEL&&t.addFallback(4,"EMISSIVEFRESNEL"),p.FRESNEL&&t.addFallback(4,"FRESNEL"),p.MULTIVIEW&&t.addFallback(0,"MULTIVIEW");const y=[k.e.PositionKind];p.NORMAL&&y.push(k.e.NormalKind),p.TANGENT&&y.push(k.e.TangentKind);for(let U=1;U<=6;++U)p["UV"+U]&&y.push(`uv${1===U?"":U}`);p.VERTEXCOLOR&&y.push(k.e.ColorKind),(0,E.D)(y,U,p,t),(0,E.H)(y,p),(0,E.J)(y,U,p),(0,E.B)(y,U,p);let s="default";const w=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices","cameraInfo"],K=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler","areaLightsLTC1Sampler","areaLightsLTC2Sampler"],r=["Material","Scene","Mesh"],f={maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:p.NUM_MORPH_INFLUENCERS};this._eventInfo.fallbacks=t,this._eventInfo.fallbackRank=0,this._eventInfo.defines=p,this._eventInfo.uniforms=w,this._eventInfo.attributes=y,this._eventInfo.samplers=K,this._eventInfo.uniformBuffersNames=r,this._eventInfo.customCode=void 0,this._eventInfo.mesh=U,this._eventInfo.indexParameters=f,this._callbackPluginEventGeneric(128,this._eventInfo),N.d.AddUniformsAndSamplers(w,K),A.b.AddUniforms(w),A.b.AddSamplers(K),q.c&&(q.c.PrepareUniforms(w,p),q.c.PrepareSamplers(K,p)),(0,E.eb)({uniformsNames:w,uniformBuffersNames:r,samplers:K,defines:p,maxSimultaneousLights:this._maxSimultaneousLights}),(0,g.c)(w);const Z={};this.customShaderNameResolve&&(s=this.customShaderNameResolve(s,w,r,K,p,y,Z));const o=p.toString(),i=W.effect;let O=L.getEngine().createEffect(s,{attributes:y,uniformsNames:w,uniformBuffersNames:r,samplers:K,defines:o,fallbacks:t,onCompiled:this.onCompiled,onError:this.onError,indexParameters:f,processFinalCode:Z.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:p.PREPASS,shaderLanguage:this._shaderLanguage,extraInitializationsAsync:this._shadersLoaded?void 0:async()=>{1===this._shaderLanguage?await Promise.all([Promise.all([l.e(35),l.e(55)]).then(l.bind(l,13840)),Promise.all([l.e(33),l.e(56)]).then(l.bind(l,13849))]):await Promise.all([Promise.all([l.e(28),l.e(57)]).then(l.bind(l,13856)),Promise.all([l.e(27),l.e(58)]).then(l.bind(l,13861))]),this._shadersLoaded=!0}},B);if(this._eventInfo.customCode=void 0,O)if(this._onEffectCreatedObservable&&(D.effect=O,D.subMesh=W,this._onEffectCreatedObservable.notifyObservers(D)),this.allowShaderHotSwapping&&i&&!O.isReady()){if(O=i,p.markAsUnprocessed(),j=this.isFrozen,M)return p._areLightsDisposed=!0,!1}else L.resetCachedMaterial(),W.setEffect(O,p,this._materialContext)}return!(!W.effect||!W.effect.isReady())&&(p._renderId=L.getRenderId(),t._wasPreviouslyReady=!j,t._wasPreviouslyUsingInstances=M,this._checkScenePerformancePriority(),!0)}buildUniformLayout(){const U=this._uniformBuffer;U.addUniform("diffuseLeftColor",4),U.addUniform("diffuseRightColor",4),U.addUniform("opacityParts",4),U.addUniform("reflectionLeftColor",4),U.addUniform("reflectionRightColor",4),U.addUniform("refractionLeftColor",4),U.addUniform("refractionRightColor",4),U.addUniform("emissiveLeftColor",4),U.addUniform("emissiveRightColor",4),U.addUniform("vDiffuseInfos",2),U.addUniform("vAmbientInfos",2),U.addUniform("vOpacityInfos",2),U.addUniform("vReflectionInfos",2),U.addUniform("vReflectionPosition",3),U.addUniform("vReflectionSize",3),U.addUniform("vEmissiveInfos",2),U.addUniform("vLightmapInfos",2),U.addUniform("vSpecularInfos",2),U.addUniform("vBumpInfos",3),U.addUniform("diffuseMatrix",16),U.addUniform("ambientMatrix",16),U.addUniform("opacityMatrix",16),U.addUniform("reflectionMatrix",16),U.addUniform("emissiveMatrix",16),U.addUniform("lightmapMatrix",16),U.addUniform("specularMatrix",16),U.addUniform("bumpMatrix",16),U.addUniform("vTangentSpaceParams",2),U.addUniform("pointSize",1),U.addUniform("alphaCutOff",1),U.addUniform("refractionMatrix",16),U.addUniform("vRefractionInfos",4),U.addUniform("vRefractionPosition",3),U.addUniform("vRefractionSize",3),U.addUniform("vSpecularColor",4),U.addUniform("vEmissiveColor",3),U.addUniform("vDiffuseColor",4),U.addUniform("vAmbientColor",3),U.addUniform("cameraInfo",4),super.buildUniformLayout()}bindForSubMesh(U,W,l){const M=this.va(),t=l.materialDefines;if(!t)return;const L=l.effect;if(!L)return;this._activeEffect=L,W.getMeshUniformBuffer().bindToEffect(L,"Mesh"),W.transferToEffect(U),this._uniformBuffer.bindToEffect(L,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,M,W,U,this.isFrozen),N.d.Bind(M.getEngine().currentRenderPassId,this._activeEffect,W,U,this);const k=M.activeCamera;k?this._uniformBuffer.updateFloat4("cameraInfo",k.bk,k.maxZ,0,0):this._uniformBuffer.updateFloat4("cameraInfo",0,0,0,0),this._eventInfo.subMesh=l,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),t.OBJECTSPACE_NORMALMAP&&(U.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const A=this._mustRebind(M,L,l,W.visibility);(0,E.d)(W,L);const q=this._uniformBuffer;if(A){if(this.bindViewProjection(L),!q.useUbo||!this.isFrozen||!q.isSync||l._drawWrapper._forceRebindOnNextCall){if(i.FresnelEnabled&&t.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(q.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),q.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&q.updateColor4("opacityParts",new B.e(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(q.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),q.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(q.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),q.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(q.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),q.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),M.texturesEnabled){if(this._diffuseTexture&&i.DiffuseTextureEnabled&&(q.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),(0,E.u)(this._diffuseTexture,q,"diffuse")),this._ambientTexture&&i.AmbientTextureEnabled&&(q.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),(0,E.u)(this._ambientTexture,q,"ambient")),this._opacityTexture&&i.OpacityTextureEnabled&&(q.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),(0,E.u)(this._opacityTexture,q,"opacity")),this._hasAlphaChannel()&&q.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&i.ReflectionTextureEnabled){if(q.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),q.wk("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize){const U=this._reflectionTexture;q.updateVector3("vReflectionPosition",U.boundingBoxPosition),q.updateVector3("vReflectionSize",U.boundingBoxSize)}}else q.updateFloat2("vReflectionInfos",0,this.roughness);if(this._emissiveTexture&&i.EmissiveTextureEnabled&&(q.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),(0,E.u)(this._emissiveTexture,q,"emissive")),this._lightmapTexture&&i.LightmapTextureEnabled&&(q.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),(0,E.u)(this._lightmapTexture,q,"lightmap")),this._specularTexture&&i.SpecularTextureEnabled&&(q.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),(0,E.u)(this._specularTexture,q,"specular")),this._bumpTexture&&M.getEngine().getCaps().standardDerivatives&&i.BumpTextureEnabled&&(q.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),(0,E.u)(this._bumpTexture,q,"bump"),M._mirroredCameraPosition?q.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):q.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&i.RefractionTextureEnabled){let U=1;if(this._refractionTexture.isCube||(q.wk("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(U=this._refractionTexture.depth)),q.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,U,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const U=this._refractionTexture;q.updateVector3("vRefractionPosition",U.boundingBoxPosition),q.updateVector3("vRefractionSize",U.boundingBoxSize)}}}this.pointsCloud&&q.updateFloat("pointSize",this.pointSize),q.updateColor4("vSpecularColor",this.specularColor,this.specularPower),q.updateColor3("vEmissiveColor",i.EmissiveTextureEnabled?this.emissiveColor:B.e.BlackReadOnly),q.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),M.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),q.updateColor3("vAmbientColor",this._globalAmbientColor)}M.texturesEnabled&&(this._diffuseTexture&&i.DiffuseTextureEnabled&&L.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&i.AmbientTextureEnabled&&L.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&i.OpacityTextureEnabled&&L.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&i.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?L.setTexture("reflectionCubeSampler",this._reflectionTexture):L.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&i.EmissiveTextureEnabled&&L.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&i.LightmapTextureEnabled&&L.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&i.SpecularTextureEnabled&&L.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&M.getEngine().getCaps().standardDerivatives&&i.BumpTextureEnabled&&L.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&i.RefractionTextureEnabled&&(this._refractionTexture.isCube?L.setTexture("refractionCubeSampler",this._refractionTexture):L.setTexture("refraction2DSampler",this._refractionTexture))),this.va().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(W)&&this.va().depthPeelingRenderer.bind(L),this._eventInfo.subMesh=l,this._callbackPluginEventBindForSubMesh(this._eventInfo),(0,g.g)(L,this,M),this.bindEyePosition(L)}else M.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);if(A||!this.isFrozen){var y;if(M.lightsEnabled&&!this._disableLighting&&(0,E.j)(M,W,L,t,this._maxSimultaneousLights),(M.fogEnabled&&W.applyFog&&M.fogMode!==p.c.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||W.receiveShadows||t.PREPASS)&&this.bindView(L),(0,E.g)(M,W,L),t.NUM_MORPH_INFLUENCERS&&(0,E.q)(W,L),t.BAKED_VERTEX_ANIMATION_TEXTURE)null===(y=W.bakedVertexAnimationManager)||void 0===y||y.bind(L,t.INSTANCES);this.useLogarithmicDepth&&(0,E.n)(t,L,M),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)}this._afterBind(W,this._activeEffect,l),q.update()}getAnimatables(){const U=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&U.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&U.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&U.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&U.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&U.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&U.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&U.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&U.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&U.push(this._refractionTexture),U}getActiveTextures(){const U=super.getActiveTextures();return this._diffuseTexture&&U.push(this._diffuseTexture),this._ambientTexture&&U.push(this._ambientTexture),this._opacityTexture&&U.push(this._opacityTexture),this._reflectionTexture&&U.push(this._reflectionTexture),this._emissiveTexture&&U.push(this._emissiveTexture),this._specularTexture&&U.push(this._specularTexture),this._bumpTexture&&U.push(this._bumpTexture),this._lightmapTexture&&U.push(this._lightmapTexture),this._refractionTexture&&U.push(this._refractionTexture),U}hasTexture(U){return!!super.hasTexture(U)||(this._diffuseTexture===U||(this._ambientTexture===U||(this._opacityTexture===U||(this._reflectionTexture===U||(this._emissiveTexture===U||(this._specularTexture===U||(this._bumpTexture===U||(this._lightmapTexture===U||this._refractionTexture===U))))))))}dispose(U,W){var l,M,t,L,p,B,k,A,q;W&&(null===(l=this._diffuseTexture)||void 0===l||l.dispose(),null===(M=this._ambientTexture)||void 0===M||M.dispose(),null===(t=this._opacityTexture)||void 0===t||t.dispose(),null===(L=this._reflectionTexture)||void 0===L||L.dispose(),null===(p=this._emissiveTexture)||void 0===p||p.dispose(),null===(B=this._specularTexture)||void 0===B||B.dispose(),null===(k=this._bumpTexture)||void 0===k||k.dispose(),null===(A=this._lightmapTexture)||void 0===A||A.dispose(),null===(q=this._refractionTexture)||void 0===q||q.dispose());this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(U,W)}clone(U){let W=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const M=Z.e.Clone((()=>new i(U,this.va())),this,{cloneTexturesOnlyOnce:W});return M.name=U,M.id=U,this.stencil.copyTo(M.stencil),this._clonePlugins(M,l),M}static Parse(U,W,l){const M=Z.e.Parse((()=>new i(U.name,W)),U,W,l);return U.stencil&&M.stencil.parse(U.stencil,W,l),y.b._ParsePlugins(U,M,W,l),M}static get DiffuseTextureEnabled(){return r.e.DiffuseTextureEnabled}static set DiffuseTextureEnabled(U){r.e.DiffuseTextureEnabled=U}static get DetailTextureEnabled(){return r.e.DetailTextureEnabled}static set DetailTextureEnabled(U){r.e.DetailTextureEnabled=U}static get AmbientTextureEnabled(){return r.e.AmbientTextureEnabled}static set AmbientTextureEnabled(U){r.e.AmbientTextureEnabled=U}static get OpacityTextureEnabled(){return r.e.OpacityTextureEnabled}static set OpacityTextureEnabled(U){r.e.OpacityTextureEnabled=U}static get ReflectionTextureEnabled(){return r.e.ReflectionTextureEnabled}static set ReflectionTextureEnabled(U){r.e.ReflectionTextureEnabled=U}static get EmissiveTextureEnabled(){return r.e.EmissiveTextureEnabled}static set EmissiveTextureEnabled(U){r.e.EmissiveTextureEnabled=U}static get SpecularTextureEnabled(){return r.e.SpecularTextureEnabled}static set SpecularTextureEnabled(U){r.e.SpecularTextureEnabled=U}static get BumpTextureEnabled(){return r.e.BumpTextureEnabled}static set BumpTextureEnabled(U){r.e.BumpTextureEnabled=U}static get LightmapTextureEnabled(){return r.e.LightmapTextureEnabled}static set LightmapTextureEnabled(U){r.e.LightmapTextureEnabled=U}static get RefractionTextureEnabled(){return r.e.RefractionTextureEnabled}static set RefractionTextureEnabled(U){r.e.RefractionTextureEnabled=U}static get ColorGradingTextureEnabled(){return r.e.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(U){r.e.ColorGradingTextureEnabled=U}static get FresnelEnabled(){return r.e.FresnelEnabled}static set FresnelEnabled(U){r.e.FresnelEnabled=U}}i.ForceGLSL=!1,(0,M.e)([(0,t.K)("diffuseTexture")],i.prototype,"_diffuseTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],i.prototype,"diffuseTexture",void 0),(0,M.e)([(0,t.K)("ambientTexture")],i.prototype,"_ambientTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"ambientTexture",void 0),(0,M.e)([(0,t.K)("opacityTexture")],i.prototype,"_opacityTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],i.prototype,"opacityTexture",void 0),(0,M.e)([(0,t.K)("reflectionTexture")],i.prototype,"_reflectionTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"reflectionTexture",void 0),(0,M.e)([(0,t.K)("emissiveTexture")],i.prototype,"_emissiveTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"emissiveTexture",void 0),(0,M.e)([(0,t.K)("specularTexture")],i.prototype,"_specularTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"specularTexture",void 0),(0,M.e)([(0,t.K)("bumpTexture")],i.prototype,"_bumpTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"bumpTexture",void 0),(0,M.e)([(0,t.K)("lightmapTexture")],i.prototype,"_lightmapTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"lightmapTexture",void 0),(0,M.e)([(0,t.K)("refractionTexture")],i.prototype,"_refractionTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"refractionTexture",void 0),(0,M.e)([(0,t.n)("ambient")],i.prototype,"ambientColor",void 0),(0,M.e)([(0,t.n)("diffuse")],i.prototype,"diffuseColor",void 0),(0,M.e)([(0,t.n)("specular")],i.prototype,"specularColor",void 0),(0,M.e)([(0,t.n)("emissive")],i.prototype,"emissiveColor",void 0),(0,M.e)([(0,t.T)()],i.prototype,"specularPower",void 0),(0,M.e)([(0,t.T)("useAlphaFromDiffuseTexture")],i.prototype,"_useAlphaFromDiffuseTexture",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesAndMiscDirty")],i.prototype,"useAlphaFromDiffuseTexture",void 0),(0,M.e)([(0,t.T)("useEmissiveAsIllumination")],i.prototype,"_useEmissiveAsIllumination",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useEmissiveAsIllumination",void 0),(0,M.e)([(0,t.T)("linkEmissiveWithDiffuse")],i.prototype,"_linkEmissiveWithDiffuse",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"linkEmissiveWithDiffuse",void 0),(0,M.e)([(0,t.T)("useSpecularOverAlpha")],i.prototype,"_useSpecularOverAlpha",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useSpecularOverAlpha",void 0),(0,M.e)([(0,t.T)("useReflectionOverAlpha")],i.prototype,"_useReflectionOverAlpha",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useReflectionOverAlpha",void 0),(0,M.e)([(0,t.T)("disableLighting")],i.prototype,"_disableLighting",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsLightsDirty")],i.prototype,"disableLighting",void 0),(0,M.e)([(0,t.T)("useObjectSpaceNormalMap")],i.prototype,"_useObjectSpaceNormalMap",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useObjectSpaceNormalMap",void 0),(0,M.e)([(0,t.T)("useParallax")],i.prototype,"_useParallax",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useParallax",void 0),(0,M.e)([(0,t.T)("useParallaxOcclusion")],i.prototype,"_useParallaxOcclusion",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useParallaxOcclusion",void 0),(0,M.e)([(0,t.T)()],i.prototype,"parallaxScaleBias",void 0),(0,M.e)([(0,t.T)("roughness")],i.prototype,"_roughness",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"roughness",void 0),(0,M.e)([(0,t.T)()],i.prototype,"indexOfRefraction",void 0),(0,M.e)([(0,t.T)()],i.prototype,"invertRefractionY",void 0),(0,M.e)([(0,t.T)()],i.prototype,"alphaCutOff",void 0),(0,M.e)([(0,t.T)("useLightmapAsShadowmap")],i.prototype,"_useLightmapAsShadowmap",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useLightmapAsShadowmap",void 0),(0,M.e)([(0,t.u)("diffuseFresnelParameters")],i.prototype,"_diffuseFresnelParameters",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelDirty")],i.prototype,"diffuseFresnelParameters",void 0),(0,M.e)([(0,t.u)("opacityFresnelParameters")],i.prototype,"_opacityFresnelParameters",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelAndMiscDirty")],i.prototype,"opacityFresnelParameters",void 0),(0,M.e)([(0,t.u)("reflectionFresnelParameters")],i.prototype,"_reflectionFresnelParameters",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelDirty")],i.prototype,"reflectionFresnelParameters",void 0),(0,M.e)([(0,t.u)("refractionFresnelParameters")],i.prototype,"_refractionFresnelParameters",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelDirty")],i.prototype,"refractionFresnelParameters",void 0),(0,M.e)([(0,t.u)("emissiveFresnelParameters")],i.prototype,"_emissiveFresnelParameters",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelDirty")],i.prototype,"emissiveFresnelParameters",void 0),(0,M.e)([(0,t.T)("useReflectionFresnelFromSpecular")],i.prototype,"_useReflectionFresnelFromSpecular",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsFresnelDirty")],i.prototype,"useReflectionFresnelFromSpecular",void 0),(0,M.e)([(0,t.T)("useGlossinessFromSpecularMapAlpha")],i.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"useGlossinessFromSpecularMapAlpha",void 0),(0,M.e)([(0,t.T)("maxSimultaneousLights")],i.prototype,"_maxSimultaneousLights",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsLightsDirty")],i.prototype,"maxSimultaneousLights",void 0),(0,M.e)([(0,t.T)("invertNormalMapX")],i.prototype,"_invertNormalMapX",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"invertNormalMapX",void 0),(0,M.e)([(0,t.T)("invertNormalMapY")],i.prototype,"_invertNormalMapY",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"invertNormalMapY",void 0),(0,M.e)([(0,t.T)("twoSidedLighting")],i.prototype,"_twoSidedLighting",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsTexturesDirty")],i.prototype,"twoSidedLighting",void 0),(0,M.e)([(0,t.T)("applyDecalMapAfterDetailMap")],i.prototype,"_applyDecalMapAfterDetailMap",void 0),(0,M.e)([(0,t.d)("_markAllSubMeshesAsMiscDirty")],i.prototype,"applyDecalMapAfterDetailMap",void 0),(0,K.f)("BABYLON.StandardMaterial",i),p.c.DefaultMaterialFactory=U=>new i("default material",U)},11886:(U,W,l)=>{l.d(W,{d:()=>m,g:()=>f});var M=l(706),t=l(742),L=l(487),p=l(774),B=l(512),k=l(763),A=l(2024),q=l(711),y=l(543);class j extends M.h{constructor(U,W){super(U.x,U.y),this.index=W}}class s{constructor(){this.elements=[]}add(U){const W=[];for(const l of U){const U=new j(l,this.elements.length);W.push(U),this.elements.push(U)}return W}computeBounds(){const U=new M.h(this.elements[0].x,this.elements[0].y),W=new M.h(this.elements[0].x,this.elements[0].y);for(const l of this.elements)l.x<U.x?U.x=l.x:l.x>W.x&&(W.x=l.x),l.y<U.y?U.y=l.y:l.y>W.y&&(W.y=l.y);return{min:U,max:W,width:W.x-U.x,height:W.y-U.y}}}class w{_addToepoint(U){for(const W of U)this._epoints.push(W.x,W.y)}constructor(U,W,l){let M,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut;this._points=new s,this._outlinepoints=new s,this._holes=new Array,this._epoints=new Array,this._eholes=new Array,this.bjsEarcut=t,this._name=U,this._scene=l||y.d.LastCreatedScene,M=W instanceof A.i?W.getPoints():W,this._addToepoint(M),this._points.add(M),this._outlinepoints.add(M),"undefined"===typeof this.bjsEarcut&&B.b.Warn("Earcut was not found, the polygon will not be built.")}addHole(U){this._points.add(U);const W=new s;return W.add(U),this._holes.push(W),this._eholes.push(this._epoints.length/2),this._addToepoint(U),this}build(){let U=arguments.length>0&&void 0!==arguments[0]&&arguments[0],W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const M=new L.e(this._name,this._scene),t=this.buildVertexData(W,l);return M.Ga(k.e.PositionKind,t.xa,U),M.Ga(k.e.NormalKind,t.ya,U),M.Ga(k.e.UVKind,t.Aa,U),M.setIndices(t.indices),M}buildVertexData(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;const l=new p.b,M=[],t=[],L=[],B=this._points.computeBounds();for(const p of this._points.elements)M.push(0,1,0),t.push(p.x,0,p.y),L.push((p.x-B.min.x)/B.width,(p.y-B.min.y)/B.height);const k=[],A=this.bjsEarcut(this._epoints,this._eholes,2);for(let p=0;p<A.length;p++)k.push(A[p]);if(U>0){const l=t.length/3;for(const W of this._points.elements)M.push(0,-1,0),t.push(W.x,-U,W.y),L.push(1-(W.x-B.min.x)/B.width,1-(W.y-B.min.y)/B.height);const p=k.length;for(let U=0;U<p;U+=3){const W=k[U+0],M=k[U+1],t=k[U+2];k.push(t+l),k.push(M+l),k.push(W+l)}this._addSide(t,M,L,k,B,this._outlinepoints,U,!1,W);for(const A of this._holes)this._addSide(t,M,L,k,B,A,U,!0,W)}return l.indices=k,l.xa=t,l.ya=M,l.Aa=L,l}_addSide(U,W,l,t,L,p,B,k,A){let y=U.length/3,j=0;for(let s=0;s<p.elements.length;s++){const w=p.elements[s],K=p.elements[(s+1)%p.elements.length];U.push(w.x,0,w.y),U.push(w.x,-B,w.y),U.push(K.x,0,K.y),U.push(K.x,-B,K.y);const r=p.elements[(s+p.elements.length-1)%p.elements.length],m=p.elements[(s+2)%p.elements.length];let f=new M.l(-(K.y-w.y),0,K.x-w.x),g=new M.l(-(w.y-r.y),0,w.x-r.x),E=new M.l(-(m.y-K.y),0,m.x-K.x);k||(f=f.scale(-1),g=g.scale(-1),E=E.scale(-1));const Z=f.normalizeToNew();let N=g.normalizeToNew(),D=E.normalizeToNew();const o=M.l.Dot(N,Z);N=o>A?o<q.d-1?new M.l(w.x,0,w.y).de(new M.l(K.x,0,K.y)).normalize():g.add(f).normalize():Z;const i=M.l.Dot(E,f);D=i>A?i<q.d-1?new M.l(K.x,0,K.y).de(new M.l(w.x,0,w.y)).normalize():E.add(f).normalize():Z,l.push(j/L.width,0),l.push(j/L.width,1),j+=f.length(),l.push(j/L.width,0),l.push(j/L.width,1),W.push(N.x,N.y,N.z),W.push(N.x,N.y,N.z),W.push(D.x,D.y,D.z),W.push(D.x,D.y,D.z),k?(t.push(y),t.push(y+2),t.push(y+1),t.push(y+1),t.push(y+2),t.push(y+3)):(t.push(y),t.push(y+1),t.push(y+2),t.push(y+1),t.push(y+3),t.push(y+2)),y+=4}}}var K=l(818);function r(U,W,l,L,B,A,q){const y=l||new Array(3),j=L,s=[],w=q||!1;for(let p=0;p<3;p++)void 0===y[p]&&(y[p]=new M.p(0,0,1,1)),j&&void 0===j[p]&&(j[p]=new t.f(1,1,1,1));const r=U.getVerticesData(k.e.PositionKind),m=U.getVerticesData(k.e.NormalKind),f=U.getVerticesData(k.e.UVKind),g=U.hk(),E=r.length/9;let Z=0,N=0,D=0,o=0,i=0;const O=[0];if(w)for(let M=E;M<r.length/3;M+=4)N=r[3*(M+2)]-r[3*M],D=r[3*(M+2)+2]-r[3*M+2],o=Math.sqrt(N*N+D*D),i+=o,O.push(i);let e=0,d=0;for(let M=0;M<m.length;M+=3)Math.abs(m[M+1])<.001&&(d=1),Math.abs(m[M+1]-1)<.001&&(d=0),Math.abs(m[M+1]+1)<.001&&(d=2),e=M/3,1===d?(Z=e-E,f[2*e]=Z%4<1.5?w?y[d].x+(y[d].z-y[d].x)*O[Math.floor(Z/4)]/i:y[d].x:w?y[d].x+(y[d].z-y[d].x)*O[Math.floor(Z/4)+1]/i:y[d].z,f[2*e+1]=Z%2===0?K.c?1-y[d].w:y[d].w:K.c?1-y[d].y:y[d].y):(f[2*e]=(1-f[2*e])*y[d].x+f[2*e]*y[d].z,f[2*e+1]=(1-f[2*e+1])*y[d].y+f[2*e+1]*y[d].w,K.c&&(f[2*e+1]=1-f[2*e+1])),j&&s.push(j[d].r,j[d].g,j[d].b,j[d].a);p.b._ComputeSides(W,r,g,m,f,B,A);const H=new p.b;if(H.indices=g,H.xa=r,H.ya=m,H.Aa=f,j){const U=W===p.b.DOUBLESIDE?s.concat(s):s;H.za=U}return H}function m(U,W){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut;W.sideOrientation=L.e._GetDefaultSideOrientation(W.sideOrientation);const p=W.shape,B=W.holes||[],k=W.depth||0,A=W.smoothingThreshold||2,q=[];let j=[];for(let L=0;L<p.length;L++)q[L]=new M.h(p[L].x,p[L].z);q[0].equalsWithEpsilon(q[q.length-1],1e-8)&&q.pop();const s=new w(U,q,l||y.d.LastCreatedScene,t);for(let L=0;L<B.length;L++){j=[];for(let U=0;U<B[L].length;U++)j.push(new M.h(B[L][U].x,B[L][U].z));s.addHole(j)}const K=s.build(!1,k,A);K._originalBuilderSideOrientation=W.sideOrientation;return r(K,W.sideOrientation,W.faceUV,W.faceColors,W.frontUVs,W.backUVs,W.wrap).Ca(K,W.updatable),K}function f(U,W){return m(U,W,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3&&void 0!==arguments[3]?arguments[3]:earcut)}p.b.CreatePolygon=r,L.e.CreatePolygon=function(U,W,l,M,t,L){return m(U,{shape:W,holes:M,updatable:t,sideOrientation:L},l,arguments.length>6&&void 0!==arguments[6]?arguments[6]:earcut)},L.e.ExtrudePolygon=function(U,W,l,M,t,L,p){return f(U,{shape:W,holes:t,depth:l,updatable:L,sideOrientation:p},M,arguments.length>7&&void 0!==arguments[7]?arguments[7]:earcut)}},11881:(U,W,l)=>{l.d(W,{b:()=>q,d:()=>y});var M=l(2024),t=l(706),L=l(487),p=l(828),B=l(11886);class k{constructor(U){this._paths=[],this._tempPaths=[],this._holes=[],this._resolution=U}moveTo(U,W){this._currentPath=new M.i(U,W),this._tempPaths.push(this._currentPath)}lineTo(U,W){this._currentPath.addLineTo(U,W)}quadraticCurveTo(U,W,l,M){this._currentPath.addQuadraticCurveTo(U,W,l,M,this._resolution)}bezierCurveTo(U,W,l,M,t,L){this._currentPath.addBezierCurveTo(U,W,l,M,t,L,this._resolution)}extractHoles(){for(const U of this._tempPaths)U.area()>0?this._holes.push(U):this._paths.push(U);if(!this._paths.length&&this._holes.length){const U=this._holes;this._holes=this._paths,this._paths=U}this._tempPaths.length=0}get paths(){return this._paths}get holes(){return this._holes}}function A(U,W,l,M,t,L){const p=L.glyphs[U]||L.glyphs["?"];if(!p)return null;const B=new k(t);if(p.o){const U=p.o.split(" ");for(let t=0,L=U.length;t<L;){switch(U[t++]){case"m":{const L=parseInt(U[t++])*W+l,p=parseInt(U[t++])*W+M;B.moveTo(L,p);break}case"l":{const L=parseInt(U[t++])*W+l,p=parseInt(U[t++])*W+M;B.lineTo(L,p);break}case"q":{const L=parseInt(U[t++])*W+l,p=parseInt(U[t++])*W+M,k=parseInt(U[t++])*W+l,A=parseInt(U[t++])*W+M;B.quadraticCurveTo(k,A,L,p);break}case"b":{const L=parseInt(U[t++])*W+l,p=parseInt(U[t++])*W+M,k=parseInt(U[t++])*W+l,A=parseInt(U[t++])*W+M,q=parseInt(U[t++])*W+l,y=parseInt(U[t++])*W+M;B.bezierCurveTo(k,A,q,y,L,p);break}}}}return B.extractHoles(),{offsetX:p.ha*W,shapePath:B}}function q(U,W,l,M){const t=Array.from(U),L=W/M.resolution,p=(M.boundingBox.yMax-M.boundingBox.yMin+M.underlineThickness)*L,B=[];let k=0,q=0;for(let y=0;y<t.length;y++){const U=t[y];if("\n"===U)k=0,q-=p;else{const W=A(U,L,k,q,l,M);W&&(k+=W.offsetX,B.push(W.shapePath))}}return B}function y(U,W,l){let M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:50,resolution:8,depth:1},k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:earcut;const y=q(W,M.size||50,M.resolution||8,l),j=[];let s=0;for(const p of y){if(!p.paths.length)continue;const W=p.holes.slice();for(const l of p.paths){var w,K;const p=[],q=[],y=l.getPoints();for(const U of y)q.push(new t.l(U.x,0,U.y));const r=W.slice();for(const U of r){const M=U.getPoints();let L=!1;for(const U of M)if(l.isPointInside(U)){L=!0;break}if(!L)continue;const B=[];for(const U of M)B.push(new t.l(U.x,0,U.y));p.push(B),W.splice(W.indexOf(U),1)}if(!p.length&&W.length)for(const U of W){const W=U.getPoints(),l=[];for(const U of W)l.push(new t.l(U.x,0,U.y));p.push(l)}const m=(0,B.g)(U,{shape:q,holes:p.length?p:void 0,depth:M.depth||1,faceUV:M.faceUV||(null===(w=M.perLetterFaceUV)||void 0===w?void 0:w.call(M,s)),faceColors:M.faceColors||(null===(K=M.perLetterFaceColors)||void 0===K?void 0:K.call(M,s)),sideOrientation:L.e._GetDefaultSideOrientation(M.sideOrientation||L.e.DOUBLESIDE)},k,A);j.push(m),s++}}const r=L.e.MergeMeshes(j,!0,!0);if(r){const W=r.getBoundingInfo().boundingBox;r.position.x+=-(W.minimumWorld.x+W.maximumWorld.x)/2,r.position.y+=-(W.minimumWorld.y+W.maximumWorld.y)/2,r.position.z+=-(W.minimumWorld.z+W.maximumWorld.z)/2+W.extendSize.z,r.name=U;const l=new p.d("pivot",k);l.rotation.x=-Math.PI/2,r.parent=l,r.bakeCurrentTransformIntoVertices(),r.parent=null,l.dispose()}return r}},11889:(U,W,l)=>{l.d(W,{c:()=>k,g:()=>p,j:()=>B});var M=l(503),t=l(2262),L=l(11896);function p(){return"object"===typeof navigator&&navigator.hardwareConcurrency?Math.min(Math.floor(.5*navigator.hardwareConcurrency),4):1}function B(U){return!!(U.wasmUrl&&(U.wasmBinary||U.wasmBinaryUrl)&&"object"===typeof WebAssembly||U.fallbackUrl)}class k{constructor(U){if(U.workerPool)return void(this._workerPoolPromise=Promise.resolve(U.workerPool));const W=U.wasmBinary,l=U.numWorkers??p(),B=l&&"function"===typeof Worker&&"function"===typeof URL,k=B||!U.jsModule,A=U.wasmUrl&&U.wasmBinaryUrl&&"object"===typeof WebAssembly?{url:k?M.h.GetBabylonScriptURL(U.wasmUrl,!0):"",wasmBinaryPromise:W?Promise.resolve(W):M.h.LoadFileAsync(M.h.GetBabylonScriptURL(U.wasmBinaryUrl,!0))}:{url:k?M.h.GetBabylonScriptURL(U.fallbackUrl):"",wasmBinaryPromise:Promise.resolve(void 0)};B?this._workerPoolPromise=A.wasmBinaryPromise.then((U=>{const W=this._getWorkerContent(),M=URL.createObjectURL(new Blob([W],{type:"application/javascript"}));return new t.b(l,(()=>{const W=new Worker(M);return(0,L.n)(W,U,A.url)}))})):this._modulePromise=A.wasmBinaryPromise.then((async W=>{if(!this._isModuleAvailable()&&!U.jsModule){if(!A.url)throw new Error("Draco codec module is not available");await M.h.LoadBabylonScriptAsync(A.url)}return await this._createModuleAsync(W,U.jsModule)}))}async whenReadyAsync(){this._workerPoolPromise?await this._workerPoolPromise:this._modulePromise&&await this._modulePromise}dispose(){this._workerPoolPromise&&this._workerPoolPromise.then((U=>{U.dispose()})),delete this._workerPoolPromise,delete this._modulePromise}}},11896:(U,W,l)=>{function M(U,W,l,M){const t=U;let L=null,p=null,B=null,k=null;const A={},q=W.find((U=>"POSITION"===U.dracoName));if(!q)throw new Error("Position attribute is required for Draco encoding");if(!l){const U=q.data.length/q.size;l=new(U>65535?Uint32Array:Uint16Array)(U);for(let W=0;W<U;W++)l[W]=W}try{L=new t.Encoder,p=new t.MeshBuilder,B=new t.Mesh,p.AddFacesToMesh(B,l.length/3,l);const U=new Map([[Float32Array,(U,W,l,M,t,L)=>U.AddFloatAttribute(W,l,M,t,L)],[Uint32Array,(U,W,l,M,t,L)=>U.AddUInt32Attribute(W,l,M,t,L)],[Uint16Array,(U,W,l,M,t,L)=>U.AddUInt16Attribute(W,l,M,t,L)],[Uint8Array,(U,W,l,M,t,L)=>U.AddUInt8Attribute(W,l,M,t,L)],[Int32Array,(U,W,l,M,t,L)=>U.AddInt32Attribute(W,l,M,t,L)],[Int16Array,(U,W,l,M,t,L)=>U.AddInt16Attribute(W,l,M,t,L)],[Int8Array,(U,W,l,M,t,L)=>U.AddInt8Attribute(W,l,M,t,L)]]);for(const l of W){l.data instanceof Uint8ClampedArray&&(l.data=new Uint8Array(l.data));const W=U.get(l.data.constructor),k=l.data.length/l.size;A[l.kind]=W(p,B,t[l.dracoName],k,l.size,l.data),M.quantizationBits&&M.quantizationBits[l.dracoName]&&L.SetAttributeQuantization(t[l.dracoName],M.quantizationBits[l.dracoName])}M.method&&L.SetEncodingMethod(t[M.method]),void 0!==M.encodeSpeed&&void 0!==M.decodeSpeed&&L.SetSpeedOptions(M.encodeSpeed,M.decodeSpeed),k=new t.DracoInt8Array;const q=L.EncodeMeshToDracoBuffer(B,k);if(q<=0)throw new Error("Draco encoding failed.");const y=new Int8Array(q);for(let W=0;W<q;W++)y[W]=k.GetValue(W);return{data:y,attributeIds:A}}finally{B&&t.destroy(B),p&&t.destroy(p),L&&t.destroy(L),k&&t.destroy(k)}}function t(){let U;onmessage=W=>{const l=W.data;switch(l.id){case"init":{l.url&&importScripts(l.url);const W=l.wasmBinary?{wasmBinary:l.wasmBinary}:{};U=DracoEncoderModule(W),postMessage({id:"initDone"});break}case"encodeMesh":if(!U)throw new Error("Draco encoder module is not available");U.then((U=>{const W=M(U,l.attributes,l.indices,l.options);postMessage({id:"encodeMeshDone",encodedMeshData:W},W?[W.data.buffer]:void 0)}))}}}function L(U,W,l,M,t){const L=U;let p=null,B=null,k=null;try{let U;p=new L.Decoder,B=new L.DecoderBuffer,B.Init(W,W.byteLength);const A=p.GetEncodedGeometryType(B);switch(A){case L.TRIANGULAR_MESH:{const W=new L.Mesh;if(U=p.DecodeBufferToMesh(B,W),!U.ok()||0===W.ptr)throw new Error(U.error_msg());const l=3*W.num_faces(),t=4*l,A=L._malloc(t);try{p.GetTrianglesUInt32Array(W,t,A);const U=new Uint32Array(l);U.set(new Uint32Array(L.HEAPF32.buffer,A,l)),M(U)}finally{L._free(A)}k=W;break}case L.POINT_CLOUD:{const W=new L.PointCloud;if(U=p.DecodeBufferToPointCloud(B,W),!U.ok()||!W.ptr)throw new Error(U.error_msg());k=W;break}default:throw new Error(`Invalid geometry type ${A}`)}const q=k.num_points(),y=(U,W,l,M)=>{const p=M.data_type(),B=M.num_components(),k=M.normalized(),A=M.byte_stride(),y=M.byte_offset(),j={[L.DT_FLOAT32]:{typedArrayConstructor:Float32Array,heap:L.HEAPF32},[L.DT_INT8]:{typedArrayConstructor:Int8Array,heap:L.HEAP8},[L.DT_INT16]:{typedArrayConstructor:Int16Array,heap:L.HEAP16},[L.DT_INT32]:{typedArrayConstructor:Int32Array,heap:L.HEAP32},[L.DT_UINT8]:{typedArrayConstructor:Uint8Array,heap:L.HEAPU8},[L.DT_UINT16]:{typedArrayConstructor:Uint16Array,heap:L.HEAPU16},[L.DT_UINT32]:{typedArrayConstructor:Uint32Array,heap:L.HEAPU32}}[p];if(!j)throw new Error(`Invalid data type ${p}`);const s=q*B,w=s*j.typedArrayConstructor.BYTES_PER_ELEMENT,K=L._malloc(w);try{U.GetAttributeDataArrayForAllPoints(W,M,p,w,K);const L=new j.typedArrayConstructor(j.heap.buffer,K,s);t(l,L.slice(),B,y,A,k)}finally{L._free(K)}};if(l)for(const W in l){const U=l[W],M=p.GetAttributeByUniqueId(k,U);y(p,k,W,M)}else{const U={position:L.POSITION,rk:L.NORMAL,color:L.COLOR,uv:L.TEX_COORD};for(const W in U){const l=p.GetAttributeId(k,U[W]);if(-1!==l){const U=p.GetAttribute(k,l);y(p,k,W,U)}}}return q}finally{k&&L.destroy(k),B&&L.destroy(B),p&&L.destroy(p)}}function p(){let U;onmessage=W=>{const l=W.data;switch(l.id){case"init":{l.url&&importScripts(l.url);const W=l.wasmBinary?{wasmBinary:l.wasmBinary}:{};U=DracoDecoderModule(W),postMessage({id:"initDone"});break}case"decodeMesh":if(!U)throw new Error("Draco decoder module is not available");U.then((U=>{const W=L(U,l.dataView,l.attributes,(U=>{postMessage({id:"indices",data:U},[U.buffer])}),((U,W,l,M,t,L)=>{postMessage({id:"attribute",kind:U,data:W,size:l,byteOffset:M,byteStride:t,normalized:L},[W.buffer])}));postMessage({id:"decodeMeshDone",totalVertices:W})}))}}}async function B(U,W,l){return await new Promise(((M,t)=>{const L=W=>{U.removeEventListener("error",L),U.removeEventListener("message",p),t(W)},p=W=>{"initDone"===W.data.id&&(U.removeEventListener("error",L),U.removeEventListener("message",p),M(U))};if(U.addEventListener("error",L),U.addEventListener("message",p),W){const M=W.slice(0);U.postMessage({id:"init",url:l,wasmBinary:M},[M])}else U.postMessage({id:"init",url:l})}))}l.d(W,{e:()=>L,f:()=>p,h:()=>M,l:()=>t,n:()=>B})},11898:(U,W,l)=>{l.d(W,{c:()=>M.e});var M=l(763)},11778:(U,W,l)=>{l.d(W,{b:()=>j});var M=l(706),t=l(512),L=l(821),p=l(487),B=l(520),k=l(828),A=l(763),q=l(503),y=l(655);p.e._instancedMeshFactory=(U,W)=>{const l=new j(U,W);if(W.instancedBuffers){l.instancedBuffers={};for(const U in W.instancedBuffers)l.instancedBuffers[U]=W.instancedBuffers[U]}return l};class j extends L.c{constructor(U,W){super(U,W.va()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,W.Kk(this),this._sourceMesh=W,this._unIndexed=W._unIndexed,this.position.p(W.position),this.rotation.p(W.rotation),this.yd.p(W.yd),W.rotationQuaternion&&(this.rotationQuaternion=W.rotationQuaternion.clone()),this.animations=W.animations.slice();for(const l of W.getAnimationRanges())null!=l&&this.createAnimationRange(l.name,l.from,l.to);if(this.infiniteDistance=W.infiniteDistance,this.setPivotMatrix(W.getPivotMatrix()),W.skeleton||W.morphTargetManager||!W.hasBoundingInfo)this.refreshBoundingInfo(!0,!0);else{const U=W.getBoundingInfo();this.buildBoundingInfo(U.minimum,U.maximum)}this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}set receiveShadows(U){var W;(null===(W=this._sourceMesh)||void 0===W?void 0:W.receiveShadows)!==U&&q.h.Warn("Setting receiveShadows on an instanced mesh has no effect")}get material(){return this._sourceMesh.material}set material(U){var W;(null===(W=this._sourceMesh)||void 0===W?void 0:W.material)!==U&&q.h.Warn("Setting material on an instanced mesh has no effect")}get visibility(){return this._sourceMesh.visibility}set visibility(U){var W;(null===(W=this._sourceMesh)||void 0===W?void 0:W.visibility)!==U&&q.h.Warn("Setting visibility on an instanced mesh has no effect")}get skeleton(){return this._sourceMesh.skeleton}set skeleton(U){var W;(null===(W=this._sourceMesh)||void 0===W?void 0:W.skeleton)!==U&&q.h.Warn("Setting skeleton on an instanced mesh has no effect")}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(U){this._sourceMesh&&U!==this._sourceMesh.renderingGroupId&&t.b.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}get vk(){return this._sourceMesh._geometry}createInstance(U){return this._sourceMesh.createInstance(U)}isReady(){let U=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sourceMesh.isReady(U,!0)}getVerticesData(U,W,l){return this._sourceMesh.getVerticesData(U,W,l)}copyVerticesData(U,W){this._sourceMesh.copyVerticesData(U,W)}Ga(U,W,l,M){return this.sourceMesh&&this.sourceMesh.Ga(U,W,l,M),this.sourceMesh}updateVerticesData(U,W,l,M){return this.sourceMesh&&this.sourceMesh.updateVerticesData(U,W,l,M),this.sourceMesh}setIndices(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.sourceMesh&&this.sourceMesh.setIndices(U,W),this.sourceMesh}isVerticesDataPresent(U){return this._sourceMesh.isVerticesDataPresent(U)}hk(){return this._sourceMesh.hk()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(){let U,W=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;U="object"===typeof W?W:{applySkeleton:W,applyMorph:l};const M=this._sourceMesh.vk?this._sourceMesh.vk.boundingBias:null;return this.Fa(this._sourceMesh._getData(U,null,A.e.PositionKind),M),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(U,W){if(super._activate(U,W),this._sourceMesh.uk||t.b.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!==this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,U),W){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD!==this._sourceMesh&&this._currentLOD.billboardMode!==k.d.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new M.c);const U=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,M.f.ik[7].p(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.p(this._currentLOD.fk(!0)),this._currentLOD.position.p(M.f.ik[7]),this._currentLOD._masterMesh=U,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(U){if(!U)return this;const W=this.sourceMesh.getLODLevels();if(W&&0!==W.length){const W=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(U,W.boundingSphere)}else this._currentLOD=this.sourceMesh;return this._currentLOD}_preActivateForIntermediateRendering(U){return this.sourceMesh._preActivateForIntermediateRendering(U)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.uk)for(let U=0;U<this._sourceMesh.uk.length;U++)this._sourceMesh.uk[U].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}Ea(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2?arguments[2]:void 0;const M=((arguments.length>3?arguments[3]:void 0)||this._sourceMesh).createInstance(U);if(B.b.DeepCopy(this,M,["name","uk","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","Hk","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo","vk"],[]),this.refreshBoundingInfo(),W&&(M.parent=W),!l)for(let t=0;t<this.va().meshes.length;t++){const U=this.va().meshes[t];U.parent===this&&U.clone(U.name,M)}return M.fk(!0),this.onClonedObservable.notifyObservers(M),M}dispose(U){let W=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sourceMesh.Lk(this),super.dispose(U,W)}_serializeAsParent(U){super._serializeAsParent(U),U.parentId=this._sourceMesh.uniqueId,U.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,W=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;const M=this.clone("Clone of "+(this.name||this.id),U||this.parent,!0,W&&W.newSourcedMesh);M&&l&&l(this,M);for(const t of this.getChildTransformNodes(!0))t.instantiateHierarchy(M,W,l);return M}}p.e.prototype.registerInstancedBuffer=function(U,W){var l,M;if(null===(l=this._userInstancedBuffersStorage)||void 0===l||null===(M=l.vertexBuffers[U])||void 0===M||M.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const U of this.instances)U.instancedBuffers={}}this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0}),this.instancedBuffers[U]=null,this._userInstancedBuffersStorage.strides[U]=W,this._userInstancedBuffersStorage.sizes[U]=32*W,this._userInstancedBuffersStorage.data[U]=new Float32Array(this._userInstancedBuffersStorage.sizes[U]),this._userInstancedBuffersStorage.vertexBuffers[U]=new A.e(this.getEngine(),this._userInstancedBuffersStorage.data[U],U,!0,!1,W,!0);for(const t of this.instances)t.instancedBuffers[U]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()},p.e.prototype._processInstancedBuffers=function(U,W){const l=U?U.length:0;for(const M in this.instancedBuffers){let t=this._userInstancedBuffersStorage.sizes[M];const L=this._userInstancedBuffersStorage.strides[M],p=(l+1)*L;for(;t<p;)t*=2;this._userInstancedBuffersStorage.data[M].length!=t&&(this._userInstancedBuffersStorage.data[M]=new Float32Array(t),this._userInstancedBuffersStorage.sizes[M]=t,this._userInstancedBuffersStorage.vertexBuffers[M]&&(this._userInstancedBuffersStorage.vertexBuffers[M].dispose(),this._userInstancedBuffersStorage.vertexBuffers[M]=null));const B=this._userInstancedBuffersStorage.data[M];let k=0;if(W){const U=this.instancedBuffers[M];U.toArray?U.toArray(B,k):U.copyToArray?U.copyToArray(B,k):B[k]=U,k+=L}for(let W=0;W<l;W++){const l=U[W].instancedBuffers[M];l.toArray?l.toArray(B,k):l.copyToArray?l.copyToArray(B,k):B[k]=l,k+=L}this._userInstancedBuffersStorage.vertexBuffers[M]?this._userInstancedBuffersStorage.vertexBuffers[M].updateDirectly(B,0):(this._userInstancedBuffersStorage.vertexBuffers[M]=new A.e(this.getEngine(),this._userInstancedBuffersStorage.data[M],M,!0,!1,L,!0),this._invalidateInstanceVertexArrayObject())}},p.e.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(const U in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[U]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},p.e.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const U in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[U]&&this._userInstancedBuffersStorage.vertexBuffers[U].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}},(0,y.f)("BABYLON.InstancedMesh",j)},11873:(U,W,l)=>{l.d(W,{e:()=>A});var M=l(742),t=l(763),L=l(487),p=l(11778),B=l(851),k=l(11879);L.e._LinesMeshParser=(U,W)=>A.Parse(U,W);class A extends L.e{_isShaderMaterial(U){return"ShaderMaterial"===U.getClassName()}constructor(U){let W=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,L=arguments.length>5?arguments[5]:void 0,p=arguments.length>6?arguments[6]:void 0,B=arguments.length>7?arguments[7]:void 0;super(U,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,W,arguments.length>4?arguments[4]:void 0),this.useVertexColor=L,this.useVertexAlpha=p,this.color=new M.e(1,1,1),this.alpha=1,this._shaderLanguage=0,W&&(this.color=W.color.clone(),this.alpha=W.alpha,this.useVertexColor=W.useVertexColor,this.useVertexAlpha=W.useVertexAlpha),this.intersectionThreshold=.1;const q={attributes:[t.e.PositionKind],uniforms:["world","viewProjection"],needAlphaBlending:!0,defines:[],useClipPlane:null,shaderLanguage:0};if(this.useVertexAlpha?q.defines.push("#define VERTEXALPHA"):q.needAlphaBlending=!1,this.useVertexColor?(q.defines.push("#define VERTEXCOLOR"),q.attributes.push(t.e.ColorKind)):(q.uniforms.push("color"),this._color4=new M.f),B)this.material=B;else{this.va().getEngine().isWebGPU&&!A.ForceGLSL&&(this._shaderLanguage=1),q.shaderLanguage=this._shaderLanguage,q.extraInitializationsAsync=async()=>{1===this._shaderLanguage?await Promise.all([l.e(38).then(l.bind(l,13864)),l.e(34).then(l.bind(l,13870))]):await Promise.all([l.e(32).then(l.bind(l,13872)),l.e(31).then(l.bind(l,13881))])},this.material=new k.b("colorShader",this.va(),"color",q,!1),this.material.doNotSerialize=!0}}isReady(){return!!this._lineMaterial.isReady(this,!!this._userInstancedBuffersStorage||this.hasThinInstances)&&super.isReady()}getClassName(){return"LinesMesh"}get material(){return this._lineMaterial}set material(U){this._lineMaterial=U,this._lineMaterial.fillMode=B.b.LineListDrawMode}get checkCollisions(){return!1}set checkCollisions(U){}_bind(U,W){if(!this._geometry)return this;const l=this.isUnIndexed?null:this._geometry.getIndexBuffer();if(!this._userInstancedBuffersStorage||this.hasThinInstances?this._geometry._bind(W,l):this._geometry._bind(W,l,this._userInstancedBuffersStorage.vertexBuffers,this._userInstancedBuffersStorage.vertexArrayObjects),!this.useVertexColor&&this._isShaderMaterial(this._lineMaterial)){const{r:U,g:W,b:l}=this.color;this._color4.set(U,W,l,this.alpha),this._lineMaterial.setColor4("color",this._color4)}return this}_draw(U,W,l){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;const M=this.va().getEngine();return this._unIndexed?M.drawArraysType(B.b.LineListDrawMode,U.verticesStart,U.verticesCount,l):M.drawElementsType(B.b.LineListDrawMode,U.indexStart,U.indexCount,l),this}dispose(U){(arguments.length>2?arguments[2]:void 0)||this._lineMaterial.dispose(!1,!1,!0),super.dispose(U)}clone(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2?arguments[2]:void 0;if(W&&void 0===W._addToSceneRootNodes){const l=W;return l.source=this,new A(U,this.va(),l.parent,l.source,l.doNotCloneChildren)}return new A(U,this.va(),W,this,l)}createInstance(U){const W=new q(U,this);if(this.instancedBuffers){W.instancedBuffers={};for(const U in this.instancedBuffers)W.instancedBuffers[U]=this.instancedBuffers[U]}return W}serialize(U){super.serialize(U),U.color=this.color.qk(),U.alpha=this.alpha}static Parse(U,W){const l=new A(U.name,W);return l.color=M.e.gk(U.color),l.alpha=U.alpha,l}}A.ForceGLSL=!1;class q extends p.b{constructor(U,W){super(U,W),this.intersectionThreshold=W.intersectionThreshold}getClassName(){return"InstancedLinesMesh"}}},11806:(U,W,l)=>{l.d(W,{c:()=>p});var M=l(2048),t=l(2235);let L=0;const p=U=>{if(!U.environmentBRDFTexture){const W=U.useDelayedTextureLoading;U.useDelayedTextureLoading=!1;const l=U._blockEntityCollection;U._blockEntityCollection=!1;const p=M.d.CreateFromBase64String("data:image/png;base64,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","EnvironmentBRDFTexture"+L++,U,!0,!1,M.d.BILINEAR_SAMPLINGMODE);U._blockEntityCollection=l;const B=U.getEngine().getLoadedTexturesCache(),k=B.indexOf(p.getInternalTexture());-1!==k&&B.splice(k,1),p.isRGBD=!0,p.wrapU=M.d.CLAMP_ADDRESSMODE,p.wrapV=M.d.CLAMP_ADDRESSMODE,U.environmentBRDFTexture=p,U.useDelayedTextureLoading=W,t.b.ExpandRGBDTexture(p);const A=U.getEngine().onContextRestoredObservable.add((()=>{p.isRGBD=!0;const W=U.onBeforeRenderObservable.add((()=>{p.isReady()&&(U.onBeforeRenderObservable.remove(W),t.b.ExpandRGBDTexture(p))}))}));U.nk.add((()=>{U.getEngine().onContextRestoredObservable.remove(A)}))}return U.environmentBRDFTexture}},11907:(U,W,l)=>{function M(){const U=U=>!!U&&"object"===typeof U;for(var W=arguments.length,l=new Array(W),t=0;t<W;t++)l[t]=arguments[t];return l.reduce(((W,l)=>{const t=Object.keys(l);for(const L of t){const t=W[L],p=l[L];Array.isArray(t)&&Array.isArray(p)?W[L]=t.concat(...p):U(t)&&U(p)?W[L]=M(t,p):W[L]=p}return W}),{})}l.d(W,{d:()=>M})},2262:(U,W,l)=>{l.d(W,{b:()=>t});class M{constructor(U){this._pendingActions=new Array,this._workerInfos=U.map((U=>({workerPromise:Promise.resolve(U),idle:!0})))}dispose(){for(const U of this._workerInfos)U.workerPromise.then((U=>{U.terminate()}));this._workerInfos.length=0,this._pendingActions.length=0}push(U){this._executeOnIdleWorker(U)||this._pendingActions.push(U)}_executeOnIdleWorker(U){for(const W of this._workerInfos)if(W.idle)return this._execute(W,U),!0;return!1}_execute(U,W){U.idle=!1,U.workerPromise.then((l=>{W(l,(()=>{const W=this._pendingActions.shift();W?this._execute(U,W):U.idle=!0}))}))}}class t extends M{constructor(U,W){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.DefaultOptions;super([]),this._maxWorkers=U,this._createWorkerAsync=W,this._options=l}push(U){if(!this._executeOnIdleWorker(U))if(this._workerInfos.length<this._maxWorkers){const W={workerPromise:this._createWorkerAsync(),idle:!1};this._workerInfos.push(W),this._execute(W,U)}else this._pendingActions.push(U)}_execute(U,W){U.timeoutId&&(clearTimeout(U.timeoutId),delete U.timeoutId),super._execute(U,((l,M)=>{W(l,(()=>{M(),U.idle&&(U.timeoutId=setTimeout((()=>{U.workerPromise.then((U=>{U.terminate()}));const W=this._workerInfos.indexOf(U);-1!==W&&this._workerInfos.splice(W,1)}),this._options.idleTimeElapsedBeforeRelease))}))}))}}t.DefaultOptions={idleTimeElapsedBeforeRelease:1e3}},11864:(U,W,l)=>{l.d(W,{b:()=>q});var M=l(686),t=l(496),L=l(543),p=l(763),B=l(688),k=l(734),A=l(655);class q{get influence(){return this._influence}set influence(U){if(this._influence===U)return;const W=this._influence;this._influence=U,this.onInfluenceChanged.hasObservers()&&this.onInfluenceChanged.notifyObservers(0===W||0===U)}get animationPropertiesOverride(){return!this._animationPropertiesOverride&&this._scene?this._scene.animationPropertiesOverride:this._animationPropertiesOverride}set animationPropertiesOverride(U){this._animationPropertiesOverride=U}constructor(U){let W=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.name=U,this.animations=[],this._positions=null,this._normals=null,this._tangents=null,this._uvs=null,this._uv2s=null,this._colors=null,this._uniqueId=0,this.onInfluenceChanged=new t.b,this._onDataLayoutChanged=new t.b,this._animationPropertiesOverride=null,this.id=U,this._scene=l||L.d.LastCreatedScene,this.influence=W,this._scene&&(this._uniqueId=this._scene.getUniqueId())}get uniqueId(){return this._uniqueId}get hasPositions(){return!!this._positions}get hasNormals(){return!!this._normals}get hasTangents(){return!!this._tangents}get hasUVs(){return!!this._uvs}get hasUV2s(){return!!this._uv2s}get hasColors(){return!!this._colors}get vertexCount(){return this._positions?this._positions.length/3:this._normals?this._normals.length/3:this._tangents?this._tangents.length/3:this._uvs?this._uvs.length/2:this._uv2s?this._uv2s.length/2:this._colors?this._colors.length/4:0}setPositions(U){const W=this.hasPositions;this._positions=U,W!==this.hasPositions&&this._onDataLayoutChanged.notifyObservers(void 0)}getPositions(){return this._positions}setNormals(U){const W=this.hasNormals;this._normals=U,W!==this.hasNormals&&this._onDataLayoutChanged.notifyObservers(void 0)}getNormals(){return this._normals}setTangents(U){const W=this.hasTangents;this._tangents=U,W!==this.hasTangents&&this._onDataLayoutChanged.notifyObservers(void 0)}getTangents(){return this._tangents}setUVs(U){const W=this.hasUVs;this._uvs=U,W!==this.hasUVs&&this._onDataLayoutChanged.notifyObservers(void 0)}getUVs(){return this._uvs}setUV2s(U){const W=this.hasUV2s;this._uv2s=U,W!==this.hasUV2s&&this._onDataLayoutChanged.notifyObservers(void 0)}getUV2s(){return this._uv2s}setColors(U){const W=this.hasColors;this._colors=U,W!==this.hasColors&&this._onDataLayoutChanged.notifyObservers(void 0)}getColors(){return this._colors}clone(){const U=k.e.Clone((()=>new q(this.name,this.influence,this._scene)),this);return U._positions=this._positions,U._normals=this._normals,U._tangents=this._tangents,U._uvs=this._uvs,U._uv2s=this._uv2s,U._colors=this._colors,U}serialize(){const U={};return U.name=this.name,U.influence=this.influence,U.xa=Array.prototype.slice.call(this.getPositions()),null!=this.id&&(U.id=this.id),this.hasNormals&&(U.ya=Array.prototype.slice.call(this.getNormals())),this.hasTangents&&(U.tangents=Array.prototype.slice.call(this.getTangents())),this.hasUVs&&(U.Aa=Array.prototype.slice.call(this.getUVs())),this.hasUV2s&&(U.uv2s=Array.prototype.slice.call(this.getUV2s())),this.hasColors&&(U.za=Array.prototype.slice.call(this.getColors())),k.e.AppendSerializedAnimations(this,U),U}getClassName(){return"MorphTarget"}static Parse(U,W){const l=new q(U.name,U.influence);if(l.setPositions(U.xa),null!=U.id&&(l.id=U.id),U.ya&&l.setNormals(U.ya),U.tangents&&l.setTangents(U.tangents),U.Aa&&l.setUVs(U.Aa),U.uv2s&&l.setUV2s(U.uv2s),U.za&&l.setColors(U.za),U.animations){for(let W=0;W<U.animations.length;W++){const M=U.animations[W],t=(0,A.d)("BABYLON.Animation");t&&l.animations.push(t.Parse(M))}U.autoAnimate&&W&&W.beginAnimation(l,U.autoAnimateFrom,U.autoAnimateTo,U.autoAnimateLoop,U.autoAnimateSpeed||1)}return l}static FromMesh(U,W,l){W||(W=U.name);const M=new q(W,l,U.va());return M.setPositions(U.getVerticesData(p.e.PositionKind)),U.isVerticesDataPresent(p.e.NormalKind)&&M.setNormals(U.getVerticesData(p.e.NormalKind)),U.isVerticesDataPresent(p.e.TangentKind)&&M.setTangents(U.getVerticesData(p.e.TangentKind)),U.isVerticesDataPresent(p.e.UVKind)&&M.setUVs(U.getVerticesData(p.e.UVKind)),U.isVerticesDataPresent(p.e.UV2Kind)&&M.setUV2s(U.getVerticesData(p.e.UV2Kind)),U.isVerticesDataPresent(p.e.ColorKind)&&M.setColors(U.getVerticesData(p.e.ColorKind)),M}}(0,M.e)([(0,B.T)()],q.prototype,"id",void 0)}}]);