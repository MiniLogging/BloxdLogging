"use strict";(self["3gghkoft8x"]=self["3gghkoft8x"]||[]).push([[19],{12390:(y,S,I)=>{I.d(S,{b:()=>B,e:()=>d});var V=I(12397),i=I(12151),A=I(12404);class B{get J(){return this._isDisposed}constructor(y,S,I){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,A=arguments.length>4&&void 0!==arguments[4]&&arguments[4],B=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=arguments.length>6&&void 0!==arguments[6]&&arguments[6],F=arguments.length>7?arguments[7]:void 0,J=arguments.length>8?arguments[8]:void 0;this._isAlreadyOwned=!1,this._isDisposed=!1,y&&y.Ey?this._engine=y.Ey().getEngine():this._engine=y,this._updatable=I,this._instanced=B,this._divisor=F||1,this._label=J,S instanceof V.d?(this._data=null,this._buffer=S):(this._data=S,this._buffer=null),this.byteStride=d?i:i*Float32Array.BYTES_PER_ELEMENT,A||this.create()}createVertexBuffer(y,S,I,V,i){let A=arguments.length>5&&void 0!==arguments[5]&&arguments[5],B=arguments.length>6?arguments[6]:void 0;const F=A?S:S*Float32Array.BYTES_PER_ELEMENT,J=V?A?V:V*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new d(this._engine,this,y,this._updatable,!0,J,void 0===i?this._instanced:i,F,I,void 0,void 0,!0,this._divisor||B)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!y&&this._buffer||(y=y||this._data,y&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,y),this._data=y):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(y,this._label),this._data=y):this._buffer=this._engine.createVertexBuffer(y,void 0,this._label)))}_rebuild(){if(this._data)this._buffer=null,this.create(this._data);else{if(!this._buffer)return;if(this._buffer.zS>0)return void(this._updatable?this._buffer=this._engine.createDynamicVertexBuffer(this._buffer.zS,this._label):this._buffer=this._engine.createVertexBuffer(this._buffer.zS,void 0,this._label));i.b.Warn(`Missing data for buffer "${this._label}" ${this._buffer?"(uniqueId: "+this._buffer.uniqueId+")":""}. Buffer reconstruction failed.`),this._buffer=null}}update(y){this.create(y)}updateDirectly(y,S,I){let V=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,y,V?S:S*Float32Array.BYTES_PER_ELEMENT,I?I*this.byteStride:void 0),this._data=0===S&&void 0===I?y:null)}_increaseReferences(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._isDisposed=!0,this._data=null,this._buffer=null)}}class d{get J(){return this._isDisposed}get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(y){const S=0!=y;this._instanceDivisor=y,S!==this._instanced&&(this._instanced=S,this._computeHashCode())}get _maxVerticesCount(){const y=this.getData();return y?Array.isArray(y)?y.length/(this.byteStride/4)-this.byteOffset/4:(y.byteLength-this.byteOffset)/this.byteStride:0}constructor(y,S,I,V,i,F,J,u,K,G){let p=arguments.length>10&&void 0!==arguments[10]&&arguments[10],L=arguments.length>11&&void 0!==arguments[11]&&arguments[11],T=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,l=arguments.length>13&&void 0!==arguments[13]&&arguments[13];this._isDisposed=!1;let j=!1;if(this.sS=y,"object"===typeof V&&null!==V?(j=V.updatable??!1,i=V.postponeInternalCreation,F=V.stride,J=V.instanced,u=V.offset,K=V.size,G=V.type,p=V.normalized??!1,L=V.useBytes??!1,T=V.divisor??1,l=V.takeBufferOwnership??!1,this._label=V.label):j=!!V,S instanceof B?(this._buffer=S,this._ownsBuffer=l):(this._buffer=new B(y,S,j,F,i,J,L,T,this._label),this._ownsBuffer=!0),this.uniqueId=d._Counter++,this._kind=I,void 0===G){const y=this.getData();this.type=y?d.GetDataType(y):d.FLOAT}else this.type=G;const s=(0,A.p)(this.type);L?(this._size=K||(F?F/s:d.DeduceStride(I)),this.byteStride=F||this._buffer.byteStride||this._size*s,this.byteOffset=u||0):(this._size=K||F||d.DeduceStride(I),this.byteStride=F?F*s:this._buffer.byteStride||this._size*s,this.byteOffset=(u||0)*s),this.normalized=p,this._instanced=void 0!==J&&J,this._instanceDivisor=J?T:0,this._alignBuffer(),this._computeHashCode()}_computeHashCode(){this.hashCode=(this.type-5120|0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){var y;null===(y=this._buffer)||void 0===y||y._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(y,S){const I=this.getData();return I?(0,A.m)(I,this._size,this.type,this.byteOffset,this.byteStride,this.normalized,y,S):null}getBuffer(){return this._buffer.getBuffer()}getWrapperBuffer(){return this._buffer}getStrideSize(){return this.byteStride/(0,A.p)(this.type)}getOffset(){return this.byteOffset/(0,A.p)(this.type)}getSize(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this._size*(0,A.p)(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(y){this._buffer.create(y),this._alignBuffer()}update(y){this._buffer.update(y),this._alignBuffer()}updateDirectly(y,S){let I=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._buffer.updateDirectly(y,S,void 0,I),this._alignBuffer()}dispose(){this._ownsBuffer&&this._buffer.dispose(),this._isDisposed=!0}forEach(y,S){(0,A.i)(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,y,this.normalized,((y,I)=>{for(let V=0;V<this._size;V++)S(y[V],I+V)}))}_alignBuffer(){}static DeduceStride(y){switch(y){case d.UVKind:case d.UV2Kind:case d.UV3Kind:case d.UV4Kind:case d.UV5Kind:case d.UV6Kind:return 2;case d.NormalKind:case d.PositionKind:return 3;case d.ColorKind:case d.ColorInstanceKind:case d.MatricesIndicesKind:case d.MatricesIndicesExtraKind:case d.MatricesWeightsKind:case d.MatricesWeightsExtraKind:case d.TangentKind:return 4;default:throw new Error("Invalid kind '"+y+"'")}}static GetDataType(y){return y instanceof Int8Array?d.BYTE:y instanceof Uint8Array?d.UNSIGNED_BYTE:y instanceof Int16Array?d.SHORT:y instanceof Uint16Array?d.UNSIGNED_SHORT:y instanceof Int32Array?d.INT:y instanceof Uint32Array?d.UNSIGNED_INT:d.FLOAT}static GetTypeByteLength(y){return(0,A.p)(y)}static ForEach(y,S,I,V,i,B,d,F){(0,A.i)(y,S,I,V,i,B,d,((y,S)=>{for(let I=0;I<V;I++)F(y[I],S+I)}))}static GetFloatData(y,S,I,V,i,B,d,F){return(0,A.m)(y,S,I,V,i,B,d,F)}}d._Counter=0,d.BYTE=5120,d.UNSIGNED_BYTE=5121,d.SHORT=5122,d.UNSIGNED_SHORT=5123,d.INT=5124,d.UNSIGNED_INT=5125,d.FLOAT=5126,d.PositionKind="position",d.NormalKind="normal",d.TangentKind="tangent",d.UVKind="uv",d.UV2Kind="uv2",d.UV3Kind="uv3",d.UV4Kind="uv4",d.UV5Kind="uv5",d.UV6Kind="uv6",d.ColorKind="color",d.ColorInstanceKind="instanceColor",d.MatricesIndicesKind="matricesIndices",d.MatricesWeightsKind="matricesWeights",d.MatricesIndicesExtraKind="matricesIndicesExtra",d.MatricesWeightsExtraKind="matricesWeightsExtra"},12404:(y,S,I)=>{I.d(S,{d:()=>G,h:()=>K,i:()=>F,m:()=>J,p:()=>B,q:()=>d,t:()=>u});var V=I(12151);function i(y,S,I,V){switch(S){case 5120:{let S=y.getInt8(I);return V&&(S=Math.max(S/127,-1)),S}case 5121:{let S=y.getUint8(I);return V&&(S/=255),S}case 5122:{let S=y.getInt16(I,!0);return V&&(S=Math.max(S/32767,-1)),S}case 5123:{let S=y.getUint16(I,!0);return V&&(S/=65535),S}case 5124:return y.getInt32(I,!0);case 5125:return y.getUint32(I,!0);case 5126:return y.getFloat32(I,!0);default:throw new Error(`Invalid component type ${S}`)}}function A(y,S,I,V,i){switch(S){case 5120:V&&(i=Math.round(127*i)),y.setInt8(I,i);break;case 5121:V&&(i=Math.round(255*i)),y.setUint8(I,i);break;case 5122:V&&(i=Math.round(32767*i)),y.setInt16(I,i,!0);break;case 5123:V&&(i=Math.round(65535*i)),y.setUint16(I,i,!0);break;case 5124:y.setInt32(I,i,!0);break;case 5125:y.setUint32(I,i,!0);break;case 5126:y.setFloat32(I,i,!0);break;default:throw new Error(`Invalid component type ${S}`)}}function B(y){switch(y){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:return 4;default:throw new Error(`Invalid type '${y}'`)}}function d(y){switch(y){case 5120:return Int8Array;case 5121:return Uint8Array;case 5122:return Int16Array;case 5123:return Uint16Array;case 5124:return Int32Array;case 5125:return Uint32Array;case 5126:return Float32Array;default:throw new Error(`Invalid component type '${y}'`)}}function F(y,S,I,V,d,F,J,u){const K=new Array(V),G=new Array(V);if(y instanceof Array){let i=S/4;const A=I/4;for(let S=0;S<F;S+=V){for(let S=0;S<V;S++)K[S]=G[S]=y[i+S];u(G,S);for(let S=0;S<V;S++)K[S]!==G[S]&&(y[i+S]=G[S]);i+=A}}else{const p=ArrayBuffer.isView(y)?new DataView(y.buffer,y.byteOffset,y.byteLength):new DataView(y),L=B(d);for(let y=0;y<F;y+=V){for(let y=0,I=S;y<V;y++,I+=L)K[y]=G[y]=i(p,d,I,J);u(G,y);for(let y=0,I=S;y<V;y++,I+=L)K[y]!==G[y]&&A(p,d,I,J,G[y]);S+=I}}}function J(y,S,I,i,A,d,J,u){const K=S*B(I),G=J*S;if(5126!==I||A!==K){const V=new Float32Array(G);return F(y,i,A,S,I,G,d,((y,I)=>{for(let i=0;i<S;i++)V[I+i]=y[i]})),V}if(!(y instanceof Array||y instanceof Float32Array)||0!==i||y.length!==G){if(y instanceof Array){const S=i/4;return y.slice(S,S+G)}if(y instanceof ArrayBuffer)return new Float32Array(y,i,G);{const S=y.byteOffset+i;return 0!==(3&S)&&(V.b.Warn("Float array must be aligned to 4-bytes border"),u=!0),u?new Float32Array(y.buffer.slice(S,S+G*Float32Array.BYTES_PER_ELEMENT)):new Float32Array(y.buffer,S,G)}}return u?y.slice():y}function u(y,S,I,i,A,J,u,K){const G=B(I),p=d(I),L=u*S;if(Array.isArray(y)){if(0!==(3&i)||0!==(3&A))throw new Error("byteOffset and byteStride must be a multiple of 4 for number[] data.");const V=i/4,B=A/4;if(V+(u-1)*B+S>y.length)throw new Error("Last accessed index is out of bounds.");if(B<S)throw new Error("Data stride cannot be smaller than the component size.");if(B!==S){const V=new p(L);return F(y,i,A,S,I,L,J,((y,I)=>{for(let i=0;i<S;i++)V[I+i]=y[i]})),V}return new p(y.slice(V,V+L))}let T,l=i;y instanceof ArrayBuffer?T=y:(T=y.buffer,l+=y.byteOffset);if(l+(u-1)*A+S*G>T.byteLength)throw new Error("Last accessed byte is out of bounds.");const j=S*G;if(A<j)throw new Error("Byte stride cannot be smaller than the component's byte size.");if(A!==j){const y=new p(L);return F(T,l,A,S,I,L,J,((I,V)=>{for(let i=0;i<S;i++)y[V+i]=I[i]})),y}return 1!==G&&0!==(l&G-1)&&(V.b.Warn("Array must be aligned to border of element size. Data will be copied."),K=!0),K?new p(T.slice(l,l+L*G)):new p(T,l,L)}function K(y,S,I,i,A,d,J,u){const K=S*B(I),G=J*S;if(u.length!==G)throw new Error("Output length is not valid");if(5126===I&&A===K)if(y instanceof Array){const S=i/4;u.set(y,S)}else if(y instanceof ArrayBuffer){const S=new Float32Array(y,i,G);u.set(S)}else{const S=y.byteOffset+i;if(0!==(3&S))return V.b.Warn("Float array must be aligned to 4-bytes border"),void u.set(new Float32Array(y.buffer.slice(S,S+G*Float32Array.BYTES_PER_ELEMENT)));const I=new Float32Array(y.buffer,S,G);u.set(I)}else F(y,i,A,S,I,G,d,((y,I)=>{for(let V=0;V<S;V++)u[I+V]=y[V]}))}function G(y,S){let I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Array.isArray(y)){for(let i=0;i<S;i++)if(y[I+i]-V>65535)return!0;return!1}return 4===y.BYTES_PER_ELEMENT}},12397:(y,S,I)=>{I.d(S,{d:()=>V});class V{get underlyingResource(){return null}constructor(){this.references=0,this.zS=0,this.is32Bits=!1,this.uniqueId=V._Counter++}}V._Counter=0},12440:(y,S,I)=>{I.d(S,{e:()=>i});var V=I(12216);class i{static GetEffect(y){return void 0===y.getPipelineContext?y.effect:y}constructor(y){let S=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!0,this._wasPreviouslyUsingInstances=null,this.effect=null,this.defines=null,this.drawContext=y.createDrawContext(),S&&(this.materialContext=y.createMaterialContext())}setEffect(y,S){let I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var V;(this.effect=y,void 0!==S&&(this.defines=S),I)&&(null===(V=this.drawContext)||void 0===V||V.reset())}dispose(){var y;let S=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.effect){const y=this.effect;S?y.dispose():V.b.SetImmediate((()=>{y.getEngine().onEndFrameObservable.addOnce((()=>{y.dispose()}))})),this.effect=null}null===(y=this.drawContext)||void 0===y||y.dispose()}}},12532:(y,S,I)=>{I.d(S,{e:()=>i});var V=I(12367);class i{static GetPlanes(y){const S=[];for(let I=0;I<6;I++)S.push(new V.e(0,0,0,0));return i.GetPlanesToRef(y,S),S}static GetNearPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]+I[2],S.normal.y=I[7]+I[6],S.normal.z=I[11]+I[10],S.d=I[15]+I[14],S.normalize()}static GetFarPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]-I[2],S.normal.y=I[7]-I[6],S.normal.z=I[11]-I[10],S.d=I[15]-I[14],S.normalize()}static GetLeftPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]+I[0],S.normal.y=I[7]+I[4],S.normal.z=I[11]+I[8],S.d=I[15]+I[12],S.normalize()}static GetRightPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]-I[0],S.normal.y=I[7]-I[4],S.normal.z=I[11]-I[8],S.d=I[15]-I[12],S.normalize()}static GetTopPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]-I[1],S.normal.y=I[7]-I[5],S.normal.z=I[11]-I[9],S.d=I[15]-I[13],S.normalize()}static GetBottomPlaneToRef(y,S){const I=y.m;S.normal.x=I[3]+I[1],S.normal.y=I[7]+I[5],S.normal.z=I[11]+I[9],S.d=I[15]+I[13],S.normalize()}static GetPlanesToRef(y,S){i.GetNearPlaneToRef(y,S[0]),i.GetFarPlaneToRef(y,S[1]),i.GetLeftPlaneToRef(y,S[2]),i.GetRightPlaneToRef(y,S[3]),i.GetTopPlaneToRef(y,S[4]),i.GetBottomPlaneToRef(y,S[5])}static IsPointInFrustum(y,S){for(let I=0;I<6;I++)if(S[I].dotCoordinate(y)<0)return!1;return!0}}},12540:(y,S,I)=>{I.d(S,{b:()=>i});var V=I(12167);class i{get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(y,S){i.Enabled&&(this._current+=y,S&&this._fetchResult())}beginMonitoring(){i.Enabled&&(this._startMonitoringTime=V.b.Now)}endMonitoring(){let y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!i.Enabled)return;y&&this.fetchNewFrame();const S=V.b.Now;this._current=S-this._startMonitoringTime,y&&this._fetchResult()}oi(){this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const y=V.b.Now;y-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=y,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}i.Enabled=!0},12412:(y,S,I)=>{I.d(S,{c:()=>i,f:()=>V});class V{constructor(y){this.length=0,this.data=new Array(y),this._id=V._GlobalId++}push(y){this.data[this.length++]=y,this.length>this.data.length&&(this.data.length*=2)}forEach(y){for(let S=0;S<this.length;S++)y(this.data[S])}sort(y){this.data.sort(y)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(y){if(0!==y.length){this.length+y.length>this.data.length&&(this.data.length=2*(this.length+y.length));for(let S=0;S<y.length;S++)this.data[this.length++]=(y.data||y)[S]}}indexOf(y){const S=this.data.indexOf(y);return S>=this.length?-1:S}contains(y){return-1!==this.indexOf(y)}}V._GlobalId=0;class i extends V{constructor(){super(...arguments),this._duplicateId=0}push(y){super.push(y),y.__smartArrayFlags||(y.__smartArrayFlags={}),y.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(y){return(!y.__smartArrayFlags||y.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(y),!0)}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(y){if(0!==y.length){this.length+y.length>this.data.length&&(this.data.length=2*(this.length+y.length));for(let S=0;S<y.length;S++){const I=(y.data||y)[S];this.pushNoDuplicate(I)}}}}},12385:(y,S,I)=>{I.d(S,{c:()=>A});var V=I(12390),i=I(12133);class A{constructor(y){this._vertexBuffers={},this.onBeforeRenderObservable=new i.b,this._scene=y}_prepareBuffers(){if(this._vertexBuffers[V.e.PositionKind])return;const y=[];y.push(1,1),y.push(-1,1),y.push(-1,-1),y.push(1,-1),this._vertexBuffers[V.e.PositionKind]=new V.e(this._scene.getEngine(),y,V.e.PositionKind,!1,!1,2),this._buildIndexBuffer()}_buildIndexBuffer(){const y=[];y.push(0),y.push(1),y.push(2),y.push(0),y.push(2),y.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(y)}_rebuild(){const y=this._vertexBuffers[V.e.PositionKind];y&&(y._rebuild(),this._buildIndexBuffer())}_prepareFrame(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const I=this._scene.activeCamera;return!!I&&(S=S||I._postProcesses.filter((y=>null!=y)),!(!S||0===S.length||!this._scene.postProcessesEnabled)&&(S[0].activate(I,y,null!==S&&void 0!==S),!0))}directRender(y){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,I=arguments.length>2&&void 0!==arguments[2]&&arguments[2],V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,A=arguments.length>5&&void 0!==arguments[5]&&arguments[5],B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:y.length;const d=this._scene.getEngine();for(let J=0;J<B;J++){var F;if(J<y.length-1)y[J+1].activate(this._scene.activeCamera||this._scene,null===S||void 0===S?void 0:S.texture);else S?d.bindFramebuffer(S,V,void 0,void 0,I,i):A||d.restoreDefaultFramebuffer(),null===(F=d._debugInsertMarker)||void 0===F||F.call(d,`post process ${y[J].name} output`);const B=y[J],u=B.apply();u&&(B.onBeforeRenderObservable.notifyObservers(u),this._prepareBuffers(),d.bindBuffers(this._vertexBuffers,this._indexBuffer,u),d.drawElementsType(0,0,6),B.onAfterRenderObservable.notifyObservers(u))}d.setDepthBuffer(!0),d.setDepthWrite(!0)}_finalizeFrame(y,S,I,V){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const A=this._scene.activeCamera;if(!A)return;if(this.onBeforeRenderObservable.notifyObservers(this),0===(V=V||A._postProcesses.filter((y=>null!=y))).length||!this._scene.postProcessesEnabled)return;const B=this._scene.getEngine();for(let F=0,J=V.length;F<J;F++){const u=V[F];var d;if(F<J-1)u._outputTexture=V[F+1].activate(A,null===S||void 0===S?void 0:S.texture);else S?(B.bindFramebuffer(S,I,void 0,void 0,i),u._outputTexture=S):(B.restoreDefaultFramebuffer(),u._outputTexture=null),null===(d=B._debugInsertMarker)||void 0===d||d.call(B,`post process ${V[F].name} output`);if(y)break;const K=u.apply();K&&(u.onBeforeRenderObservable.notifyObservers(K),this._prepareBuffers(),B.bindBuffers(this._vertexBuffers,this._indexBuffer,K),B.drawElementsType(0,0,6),u.onAfterRenderObservable.notifyObservers(K))}B.setDepthBuffer(!0),B.setDepthWrite(!0),B.setAlphaMode(0)}dispose(){const y=this._vertexBuffers[V.e.PositionKind];y&&(y.dispose(),this._vertexBuffers[V.e.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}},12407:(y,S,I)=>{I.d(S,{e:()=>d});var V=I(12412),i=I(12321);class A{set opaqueSortCompareFn(y){this._opaqueSortCompareFn=y||A.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(y){this._alphaTestSortCompareFn=y||A.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(y){this._transparentSortCompareFn=y||A.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}constructor(y,S){let I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.index=y,this._opaqueSubMeshes=new V.f(256),this._transparentSubMeshes=new V.f(256),this._alphaTestSubMeshes=new V.f(256),this._depthOnlySubMeshes=new V.f(256),this._particleSystems=new V.f(256),this._spriteManagers=new V.f(256),this._empty=!0,this._edgesRenderers=new V.c(16),this._scene=S,this.opaqueSortCompareFn=I,this.alphaTestSortCompareFn=i,this.transparentSortCompareFn=A}render(y,S,I,V){if(y)return void y(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);const i=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(i.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),i.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);const A=i.getStencilBuffer();if(i.setStencilBuffer(!1),S&&this._renderSprites(),I&&this._renderParticles(V),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency){if(i.setStencilBuffer(A),this._scene.useOrderIndependentTransparency){const y=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);y.length&&this._renderTransparent(y)}else this._renderTransparent(this._transparentSubMeshes);i.setAlphaMode(0)}if(i.setStencilBuffer(!1),this._edgesRenderers.length){for(let y=0;y<this._edgesRenderers.length;y++)this._edgesRenderers.data[y].render();i.setAlphaMode(0)}i.setStencilBuffer(A)}_renderOpaqueSorted(y){A._RenderSorted(y,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(y){A._RenderSorted(y,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}_renderTransparentSorted(y){A._RenderSorted(y,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(y,S,I,V){let B,d=0;const F=I?I.globalPosition:A._ZeroVector;if(V)for(;d<y.length;d++)B=y.data[d],B._alphaIndex=B.getMesh().alphaIndex,B._distanceToCamera=i.OS.Distance(B.getBoundingInfo().boundingSphere.centerWorld,F);const J=y.length===y.data.length?y.data:y.data.slice(0,y.length);S&&J.sort(S);const u=J[0].getMesh().Ey();for(d=0;d<J.length;d++)if(B=J[d],!u._activeMeshesFrozenButKeepClipping||B.isInFrustum(u._frustumPlanes)){if(V){const y=B.Wy();if(y&&y.needDepthPrePass){const S=y.Ey().getEngine();S.setColorWrite(!1),S.setAlphaMode(0),B.render(!1),S.setColorWrite(!0)}}B.render(V)}}static defaultTransparentSortCompare(y,S){return y._alphaIndex>S._alphaIndex?1:y._alphaIndex<S._alphaIndex?-1:A.backToFrontSortCompare(y,S)}static backToFrontSortCompare(y,S){return y._distanceToCamera<S._distanceToCamera?1:y._distanceToCamera>S._distanceToCamera?-1:0}static frontToBackSortCompare(y,S){return y._distanceToCamera<S._distanceToCamera?-1:y._distanceToCamera>S._distanceToCamera?1:0}static PainterSortCompare(y,S){const I=y.getMesh(),V=S.getMesh();return I.material&&V.material?I.material.uniqueId-V.material.uniqueId:I.uniqueId-V.uniqueId}prepare(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}dispatch(y,S,I){void 0===S&&(S=y.getMesh()),void 0===I&&(I=y.Wy()),null!==I&&void 0!==I&&(I.needAlphaBlendingForMesh(S)?this._transparentSubMeshes.push(y):I.needAlphaTestingForMesh(S)?(I.needDepthPrePass&&this._depthOnlySubMeshes.push(y),this._alphaTestSubMeshes.push(y)):(I.needDepthPrePass&&this._depthOnlySubMeshes.push(y),this._opaqueSubMeshes.push(y)),S._renderingGroup=this,S._edgesRenderer&&S.isEnabled()&&S.isVisible&&S._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(S._edgesRenderer),this._empty=!1)}dispatchSprites(y){this._spriteManagers.push(y),this._empty=!1}dispatchParticles(y){this._particleSystems.push(y),this._empty=!1}_renderParticles(y){if(0===this._particleSystems.length)return;const S=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let I=0;I<this._particleSystems.length;I++){const V=this._particleSystems.data[I];if(0===(S&&S.layerMask&V.layerMask))continue;const i=V.FS;i.position&&y&&-1===y.indexOf(i)||this._scene._activeParticles.addCount(V.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}_renderSprites(){if(!this._scene.spritesEnabled||0===this._spriteManagers.length)return;const y=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let S=0;S<this._spriteManagers.length;S++){const I=this._spriteManagers.data[S];0!==(y&&y.layerMask&I.layerMask)&&I.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}A._ZeroVector=i.OS.Zero();class B{}class d{get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(y){y!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=y,this._maintainStateBetweenFrames||this.restoreDispachedFlags())}restoreDispachedFlags(){for(const y of this._scene.meshes)if(y.wi)for(const S of y.wi)S._wasDispatched=!1;if(this._scene.spriteManagers)for(const y of this._scene.spriteManagers)y._wasDispatched=!1;for(const y of this._scene.dG)y._wasDispatched=!1}constructor(y){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new B,this._maintainStateBetweenFrames=!1,this._scene=y;for(let S=d.MIN_RENDERINGGROUPS;S<d.MAX_RENDERINGGROUPS;S++)this._autoClearDepthStencil[S]={Hi:!0,depth:!0,gi:!0}}getRenderingGroup(y){const S=y||0;return this._prepareRenderingGroup(S),this._renderingGroups[S]}_clearDepthStencilBuffer(){let y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],S=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,y,S),this._depthStencilBufferAlreadyCleaned=!0)}render(y,S,I,V){const i=this._renderingGroupInfo;if(i.mI=this._scene,i.camera=this._scene.activeCamera,i.renderingManager=this,this._scene.spriteManagers&&V)for(let A=0;A<this._scene.spriteManagers.length;A++){const y=this._scene.spriteManagers[A];this.dispatchSprites(y)}for(let A=d.MIN_RENDERINGGROUPS;A<d.MAX_RENDERINGGROUPS;A++){this._depthStencilBufferAlreadyCleaned=A===d.MIN_RENDERINGGROUPS;const B=this._renderingGroups[A];if(!B||B._empty)continue;const F=1<<A;if(i.renderingGroupId=A,this._scene.onBeforeRenderingGroupObservable.notifyObservers(i,F),d.AUTOCLEAR){const y=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(A):this._autoClearDepthStencil[A];y&&y.Hi&&this._clearDepthStencilBuffer(y.depth,y.gi)}for(const y of this._scene._beforeRenderingGroupDrawStage)y.action(A);B.render(y,V,I,S);for(const y of this._scene._afterRenderingGroupDrawStage)y.action(A);this._scene.onAfterRenderingGroupObservable.notifyObservers(i,F)}}reset(){if(!this.maintainStateBetweenFrames)for(let y=d.MIN_RENDERINGGROUPS;y<d.MAX_RENDERINGGROUPS;y++){const S=this._renderingGroups[y];S&&S.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let y=d.MIN_RENDERINGGROUPS;y<d.MAX_RENDERINGGROUPS;y++){const S=this._renderingGroups[y];S&&S.prepareSprites()}}dispose(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}freeRenderingGroups(){for(let y=d.MIN_RENDERINGGROUPS;y<d.MAX_RENDERINGGROUPS;y++){const S=this._renderingGroups[y];S&&S.dispose()}}_prepareRenderingGroup(y){void 0===this._renderingGroups[y]&&(this._renderingGroups[y]=new A(y,this._scene,this._customOpaqueSortCompareFn[y],this._customAlphaTestSortCompareFn[y],this._customTransparentSortCompareFn[y]))}dispatchSprites(y){this.maintainStateBetweenFrames&&y._wasDispatched||(y._wasDispatched=!0,this.getRenderingGroup(y.renderingGroupId).dispatchSprites(y))}dispatchParticles(y){this.maintainStateBetweenFrames&&y._wasDispatched||(y._wasDispatched=!0,this.getRenderingGroup(y.renderingGroupId).dispatchParticles(y))}dispatch(y,S,I){void 0===S&&(S=y.getMesh()),this.maintainStateBetweenFrames&&y._wasDispatched||(y._wasDispatched=!0,this.getRenderingGroup(S.renderingGroupId).dispatch(y,S,I))}setRenderingOrder(y){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this._customOpaqueSortCompareFn[y]=S,this._customAlphaTestSortCompareFn[y]=I,this._customTransparentSortCompareFn[y]=V,this._renderingGroups[y]){const S=this._renderingGroups[y];S.opaqueSortCompareFn=this._customOpaqueSortCompareFn[y],S.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[y],S.transparentSortCompareFn=this._customTransparentSortCompareFn[y]}}setRenderingAutoClearDepthStencil(y,S){let I=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],V=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._autoClearDepthStencil[y]={Hi:S,depth:I,gi:V}}getAutoClearDepthStencilSetup(y){return this._autoClearDepthStencil[y]}}d.MAX_RENDERINGGROUPS=4,d.MIN_RENDERINGGROUPS=0,d.AUTOCLEAR=!0}}]);