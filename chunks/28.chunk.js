"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[28,29],{12792:(g,w,q)=>{var R=q(11103),o=q(11011),r=q(11043),S=q(11136),i=q(11074),T=q(11118);i.b.prototype._partialLoadFile=function(g,w,q,R){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(g,(g=>{q[w]=g,q._internalCount++,6===q._internalCount&&R(q)}),void 0,void 0,!0,((g,w)=>{o&&g&&o(g.status+" "+g.statusText,w)}))},i.b.prototype._cascadeLoadFiles=function(g,w,q){let R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=[];o._internalCount=0;for(let r=0;r<6;r++)this._partialLoadFile(q[r],r,o,w,R)},i.b.prototype._cascadeLoadImgs=function(g,w,q,R){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5?arguments[5]:void 0;const S=[];S._internalCount=0;for(let i=0;i<6;i++)this._partialLoadImg(R[i],i,S,g,w,q,o,r)},i.b.prototype._partialLoadImg=function(g,w,q,R,o,i){let T=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,z=arguments.length>7?arguments[7]:void 0;const t=(0,S.c)();(0,r.n)(g,(g=>{q[w]=g,q._internalCount++,R&&R.removePendingData(t),6===q._internalCount&&i&&i(o,q)}),((g,w)=>{R&&R.removePendingData(t),T&&T(g,w)}),R?R.offlineProvider:null,z),R&&R.addPendingData(t)},i.b.prototype.createCubeTextureBase=function(g,w,q,r){let S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,z=arguments.length>6?arguments[6]:void 0,t=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,m=arguments.length>8&&void 0!==arguments[8]&&arguments[8],e=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,L=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,A=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,l=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,J=arguments.length>14&&void 0!==arguments[14]&&arguments[14],x=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const G=L||new R.d(this,7);G.isCube=!0,G.url=g,G.generateMipMaps=!r,G._lodGenerationScale=e,G._lodGenerationOffset=y,G._useSRGBBuffer=!!J&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!r),G!==L&&(G.label=g.substring(0,60)),this._doNotHandleContextLost||(G._extension=t,G._files=q,G._buffer=x);const d=g;this._transformTextureUrl&&!L&&(g=this._transformTextureUrl(g));const D=t??function(g){const w=g.split("?")[0],q=w.lastIndexOf(".");return q>-1?w.substring(q).toLowerCase():""}(g),U=(0,T.b)(D),N=(g,w)=>{G.dispose(),i?i(g,w):g&&o.d.Warn(g)},a=(R,i)=>{g===d?R&&N(R.status+" "+R.statusText,i):(o.d.Warn(`Failed to load ${g}, falling back to the ${d}`),this.createCubeTextureBase(d,w,q,!!r,S,N,z,t,m,e,y,G,A,l,J,x))};if(U)U.then((R=>{const o=g=>{A&&A(G,g),R.loadCubeData(g,G,m,S,((g,w)=>{N(g,w)}))};x?o(x):q&&6===q.length?R.supportCascades?this._cascadeLoadFiles(w,(g=>o(g.map((g=>new Uint8Array(g))))),q,N):N("Textures type does not support cascades."):this._loadFile(g,(g=>o(new Uint8Array(g))),void 0,void 0,!0,a)}));else{if(!q||0===q.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(w,G,((g,w)=>{l&&l(g,w)}),q,N)}return this._internalTexturesCache.push(G),G}},13554:(g,w,q)=>{q.r(w),q.d(w,{_DDSTextureLoader:()=>r});var R=q(11345),o=q(13563);class r{constructor(){this.supportCascades=!0}loadCubeData(g,w,q,r){const S=w.getEngine();let i,T=!1,z=1e3;if(Array.isArray(g))for(let R=0;R<g.length;R++){const q=g[R];i=o.DDSTools.GetDDSInfo(q),w.width=i.width,w.height=i.height,T=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&w.generateMipMaps,S._unpackFlipY(i.isCompressed),o.DDSTools.UploadDDSLevels(S,w,q,i,T,6,-1,R),i.isFourCC||1!==i.mipmapCount?z=i.mipmapCount-1:S.generateMipMapsForCubemap(w)}else{const r=g;i=o.DDSTools.GetDDSInfo(r),w.width=i.width,w.height=i.height,q&&(i.sphericalPolynomial=new R.h),T=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&w.generateMipMaps,S._unpackFlipY(i.isCompressed),o.DDSTools.UploadDDSLevels(S,w,r,i,T,6),i.isFourCC||1!==i.mipmapCount?z=i.mipmapCount-1:S.generateMipMapsForCubemap(w,!1)}S._setCubeMapTextureParams(w,T,z),w.isReady=!0,w.onLoadedObservable.notifyObservers(w),w.onLoadedObservable.clear(),r&&r({isDDS:!0,width:w.width,info:i,data:g,texture:w})}loadData(g,w,q){const R=o.DDSTools.GetDDSInfo(g),r=(R.isRGB||R.isLuminance||R.mipmapCount>1)&&w.generateMipMaps&&Math.max(R.width,R.height)>>R.mipmapCount-1===1;q(R.width,R.height,r,R.isFourCC,(()=>{o.DDSTools.UploadDDSLevels(w.getEngine(),w,g,R,r,1)}))}}},11650:(g,w,q)=>{q.d(w,{c:()=>z});var R=q(11180),o=q(11195),r=q(11345),S=q(11188),i=q(11235);class T{constructor(g,w,q,R){this.name=g,this.worldAxisForNormal=w,this.worldAxisForFileX=q,this.worldAxisForFileY=R}}class z{static ConvertCubeMapTextureToSphericalPolynomial(g){var w;if(!g.isCube)return null;null===(w=g.Ng())||void 0===w||w.getEngine().flushFramebuffer();const q=g.getSize().width,R=g.readPixels(0,void 0,void 0,!1),o=g.readPixels(1,void 0,void 0,!1);let r,S;g.isRenderTarget?(r=g.readPixels(3,void 0,void 0,!1),S=g.readPixels(2,void 0,void 0,!1)):(r=g.readPixels(2,void 0,void 0,!1),S=g.readPixels(3,void 0,void 0,!1));const i=g.readPixels(4,void 0,void 0,!1),T=g.readPixels(5,void 0,void 0,!1),z=g.gammaSpace;let t=0;return 1!=g.textureType&&2!=g.textureType||(t=1),new Promise((g=>{Promise.all([o,R,r,S,i,T]).then((w=>{let[R,o,r,S,i,T]=w;const m={size:q,right:o,left:R,up:r,down:S,front:i,back:T,format:5,type:t,gammaSpace:z};g(this.ConvertCubeMapToSphericalPolynomial(m))}))}))}static _AreaElement(g,w){return Math.atan2(g*w,Math.sqrt(g*g+w*w+1))}static ConvertCubeMapToSphericalPolynomial(g){const w=new r.e;let q=0;const R=2/g.size,T=R,z=.5*R,t=z-1;for(let r=0;r<6;r++){const m=this._FileFaces[r],e=g[m.name];let y=t;const L=5===g.format?4:3;for(let r=0;r<g.size;r++){let A=t;for(let T=0;T<g.size;T++){const t=m.worldAxisForFileX.scale(A).add(m.worldAxisForFileY.scale(y)).add(m.worldAxisForNormal);t.normalize();const l=this._AreaElement(A-z,y-z)-this._AreaElement(A-z,y+z)-this._AreaElement(A+z,y-z)+this._AreaElement(A+z,y+z);let J=e[r*g.size*L+T*L+0],x=e[r*g.size*L+T*L+1],G=e[r*g.size*L+T*L+2];isNaN(J)&&(J=0),isNaN(x)&&(x=0),isNaN(G)&&(G=0),0===g.type&&(J/=255,x/=255,G/=255),g.gammaSpace&&(J=Math.pow((0,o.Clamp)(J),S.h),x=Math.pow((0,o.Clamp)(x),S.h),G=Math.pow((0,o.Clamp)(G),S.h));const d=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const g=Math.max(J,x,G);if(g>d){const w=d/g;J*=w,x*=w,G*=w}}else J=(0,o.Clamp)(J,0,d),x=(0,o.Clamp)(x,0,d),G=(0,o.Clamp)(G,0,d);const D=new i.Jw(J,x,G);w.addLight(t,D,l),q+=l,A+=R}y+=T}}const m=6*(4*Math.PI)/6/q;return w.scaleInPlace(m),w.convertIncidentRadianceToIrradiance(),w.convertIrradianceToLambertianRadiance(),r.h.FromHarmonics(w)}}z._FileFaces=[new T("right",new R.ew(1,0,0),new R.ew(0,0,-1),new R.ew(0,-1,0)),new T("left",new R.ew(-1,0,0),new R.ew(0,0,1),new R.ew(0,-1,0)),new T("up",new R.ew(0,1,0),new R.ew(1,0,0),new R.ew(0,0,1)),new T("down",new R.ew(0,-1,0),new R.ew(1,0,0),new R.ew(0,0,-1)),new T("front",new R.ew(0,0,1),new R.ew(1,0,0),new R.ew(0,-1,0)),new T("back",new R.ew(0,0,-1),new R.ew(-1,0,0),new R.ew(0,-1,0))],z.MAX_HDRI_VALUE=4096,z.PRESERVE_CLAMPED_COLORS=!1},13563:(g,w,q)=>{q.d(w,{DDSTools:()=>L});var R=q(11195),o=q(11011),r=q(11650),S=q(11383);q(12792);const i=131072,T=131072;function z(g){return g.charCodeAt(0)+(g.charCodeAt(1)<<8)+(g.charCodeAt(2)<<16)+(g.charCodeAt(3)<<24)}const t=z("DXT1"),m=z("DXT3"),e=z("DXT5"),y=z("DX10");class L{static GetDDSInfo(g){const w=new Int32Array(g.buffer,g.byteOffset,31),q=new Int32Array(g.buffer,g.byteOffset,35);let R=1;w[2]&i&&(R=Math.max(1,w[7]));const o=w[21],r=o===y?q[32]:0;let S=0;switch(o){case 113:S=2;break;case 116:S=1;break;case y:if(10===r){S=2;break}if(2===r){S=1;break}}return{width:w[4],height:w[3],mipmapCount:R,isFourCC:4===(4&w[20]),isRGB:64===(64&w[20]),isLuminance:(w[20]&T)===T,isCube:512===(512&w[28]),isCompressed:o===t||o===m||o===e,dxgiFormat:r,textureType:S}}static _GetHalfFloatAsFloatRGBAArrayBuffer(g,w,q,R,o,r){const i=new Float32Array(R),T=new Uint16Array(o,q);let z=0;for(let t=0;t<w;t++)for(let w=0;w<g;w++){const q=4*(w+t*g);i[z]=(0,S.f)(T[q]),i[z+1]=(0,S.f)(T[q+1]),i[z+2]=(0,S.f)(T[q+2]),L.StoreLODInAlphaChannel?i[z+3]=r:i[z+3]=(0,S.f)(T[q+3]),z+=4}return i}static _GetHalfFloatRGBAArrayBuffer(g,w,q,R,o,r){if(L.StoreLODInAlphaChannel){const i=new Uint16Array(R),T=new Uint16Array(o,q);let z=0;for(let q=0;q<w;q++)for(let w=0;w<g;w++){const R=4*(w+q*g);i[z]=T[R],i[z+1]=T[R+1],i[z+2]=T[R+2],i[z+3]=(0,S.m)(r),z+=4}return i}return new Uint16Array(o,q,R)}static _GetFloatRGBAArrayBuffer(g,w,q,R,o,r){if(L.StoreLODInAlphaChannel){const S=new Float32Array(R),i=new Float32Array(o,q);let T=0;for(let q=0;q<w;q++)for(let w=0;w<g;w++){const R=4*(w+q*g);S[T]=i[R],S[T+1]=i[R+1],S[T+2]=i[R+2],S[T+3]=r,T+=4}return S}return new Float32Array(o,q,R)}static _GetFloatAsHalfFloatRGBAArrayBuffer(g,w,q,R,o,r){const i=new Uint16Array(R),T=new Float32Array(o,q);let z=0;for(let t=0;t<w;t++)for(let w=0;w<g;w++)i[z]=(0,S.m)(T[z]),i[z+1]=(0,S.m)(T[z+1]),i[z+2]=(0,S.m)(T[z+2]),L.StoreLODInAlphaChannel?i[z+3]=(0,S.m)(r):i[z+3]=(0,S.m)(T[z+3]),z+=4;return i}static _GetFloatAsUIntRGBAArrayBuffer(g,w,q,o,r,S){const i=new Uint8Array(o),T=new Float32Array(r,q);let z=0;for(let t=0;t<w;t++)for(let w=0;w<g;w++){const q=4*(w+t*g);i[z]=255*(0,R.Clamp)(T[q]),i[z+1]=255*(0,R.Clamp)(T[q+1]),i[z+2]=255*(0,R.Clamp)(T[q+2]),L.StoreLODInAlphaChannel?i[z+3]=S:i[z+3]=255*(0,R.Clamp)(T[q+3]),z+=4}return i}static _GetHalfFloatAsUIntRGBAArrayBuffer(g,w,q,o,r,i){const T=new Uint8Array(o),z=new Uint16Array(r,q);let t=0;for(let m=0;m<w;m++)for(let w=0;w<g;w++){const q=4*(w+m*g);T[t]=255*(0,R.Clamp)((0,S.f)(z[q])),T[t+1]=255*(0,R.Clamp)((0,S.f)(z[q+1])),T[t+2]=255*(0,R.Clamp)((0,S.f)(z[q+2])),L.StoreLODInAlphaChannel?T[t+3]=i:T[t+3]=255*(0,R.Clamp)((0,S.f)(z[q+3])),t+=4}return T}static _GetRGBAArrayBuffer(g,w,q,R,o,r,S,i,T){const z=new Uint8Array(R),t=new Uint8Array(o,q);let m=0;for(let e=0;e<w;e++)for(let w=0;w<g;w++){const q=4*(w+e*g);z[m]=t[q+r],z[m+1]=t[q+S],z[m+2]=t[q+i],z[m+3]=t[q+T],m+=4}return z}static _ExtractLongWordOrder(g){return 0===g||255===g||-16777216===g?0:1+L._ExtractLongWordOrder(g>>8)}static _GetRGBArrayBuffer(g,w,q,R,o,r,S,i){const T=new Uint8Array(R),z=new Uint8Array(o,q);let t=0;for(let m=0;m<w;m++)for(let w=0;w<g;w++){const q=3*(w+m*g);T[t]=z[q+r],T[t+1]=z[q+S],T[t+2]=z[q+i],t+=3}return T}static _GetLuminanceArrayBuffer(g,w,q,R,o){const r=new Uint8Array(R),S=new Uint8Array(o,q);let i=0;for(let T=0;T<w;T++)for(let w=0;w<g;w++){const q=w+T*g;r[i]=S[q],i++}return r}static UploadDDSLevels(g,w,q,R,S,T){let z=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,A=arguments.length>7?arguments[7]:void 0,l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],J=null;R.sphericalPolynomial&&(J=[]);const x=!!g.getCaps().s3tc;w.generateMipMaps=S;const G=new Int32Array(q.buffer,q.byteOffset,31);let d,D,U,N,a,H,C,c=0,P=0,j=1;if(542327876!==G[0])return void o.d.Error("Invalid magic number in DDS header");if(!R.isFourCC&&!R.isRGB&&!R.isLuminance)return void o.d.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(R.isCompressed&&!x)return void o.d.Error("Compressed textures are not supported on this platform.");let M=G[22];N=G[1]+4;let V=!1;if(R.isFourCC)switch(d=G[21],d){case t:j=8,P=33777;break;case m:j=16,P=33778;break;case e:j=16,P=33779;break;case 113:V=!0,M=64;break;case 116:V=!0,M=128;break;case y:{N+=20;let g=!1;switch(R.dxgiFormat){case 10:V=!0,M=64,g=!0;break;case 2:V=!0,M=128,g=!0;break;case 88:R.isRGB=!0,R.isFourCC=!1,M=32,g=!0}if(g)break}default:return void o.d.Error(["Unsupported FourCC code:",(s=d,String.fromCharCode(255&s,s>>8&255,s>>16&255,s>>24&255))])}var s;const h=L._ExtractLongWordOrder(G[23]),v=L._ExtractLongWordOrder(G[24]),b=L._ExtractLongWordOrder(G[25]),B=L._ExtractLongWordOrder(G[26]);V&&(P=g._getRGBABufferInternalSizedFormat(R.textureType)),H=1,G[2]&i&&!1!==S&&(H=Math.max(1,G[7]));const f=A||0,O=g.getCaps();for(let o=f;o<T;o++){for(D=G[4],U=G[3],C=0;C<H;++C){if(-1===z||z===C){const r=-1===z?C:0;if(!R.isCompressed&&R.isFourCC){w.format=5,c=D*U*4;let R=null;if(g._badOS||g._badDesktopOS||!O.textureHalfFloat&&!O.textureFloat)128===M?(R=L._GetFloatAsUIntRGBAArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,r),J&&0==r&&J.push(L._GetFloatRGBAArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,r))):64===M&&(R=L._GetHalfFloatAsUIntRGBAArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,r),J&&0==r&&J.push(L._GetHalfFloatAsFloatRGBAArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,r))),w.type=0;else{const g=O.textureFloat&&(l&&O.textureFloatLinearFiltering||!l),o=O.textureHalfFloat&&(l&&O.textureHalfFloatLinearFiltering||!l),S=(128===M||64===M&&!o)&&g?1:(64===M||128===M&&!g)&&o?2:0;let i,T=null;if(128===M)switch(S){case 1:i=L._GetFloatRGBAArrayBuffer,T=null;break;case 2:i=L._GetFloatAsHalfFloatRGBAArrayBuffer,T=L._GetFloatRGBAArrayBuffer;break;case 0:i=L._GetFloatAsUIntRGBAArrayBuffer,T=L._GetFloatRGBAArrayBuffer}else switch(S){case 1:i=L._GetHalfFloatAsFloatRGBAArrayBuffer,T=null;break;case 2:i=L._GetHalfFloatRGBAArrayBuffer,T=L._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:i=L._GetHalfFloatAsUIntRGBAArrayBuffer,T=L._GetHalfFloatAsFloatRGBAArrayBuffer}w.type=S,R=i(D,U,q.byteOffset+N,c,q.buffer,r),J&&0==r&&J.push(T?T(D,U,q.byteOffset+N,c,q.buffer,r):R)}R&&g._uploadDataToTextureDirectly(w,R,o,r)}else if(R.isRGB)w.type=0,24===M?(w.format=4,c=D*U*3,a=L._GetRGBArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,h,v,b),g._uploadDataToTextureDirectly(w,a,o,r)):(w.format=5,c=D*U*4,a=L._GetRGBAArrayBuffer(D,U,q.byteOffset+N,c,q.buffer,h,v,b,B),g._uploadDataToTextureDirectly(w,a,o,r));else if(R.isLuminance){const R=g._getUnpackAlignement(),S=D;c=Math.floor((D+R-1)/R)*R*(U-1)+S,a=L._GetLuminanceArrayBuffer(D,U,q.byteOffset+N,c,q.buffer),w.format=1,w.type=0,g._uploadDataToTextureDirectly(w,a,o,r)}else c=Math.max(4,D)/4*Math.max(4,U)/4*j,a=new Uint8Array(q.buffer,q.byteOffset+N,c),w.type=0,g._uploadCompressedDataToTextureDirectly(w,P,D,U,a,o,r)}N+=M?D*U*(M/8):c,D*=.5,U*=.5,D=Math.max(1,D),U=Math.max(1,U)}if(void 0!==A)break}J&&J.length>0?R.sphericalPolynomial=r.c.ConvertCubeMapToSphericalPolynomial({size:G[4],right:J[0],left:J[1],up:J[2],down:J[3],front:J[4],back:J[5],format:5,type:1,gammaSpace:!1}):R.sphericalPolynomial=void 0}}L.StoreLODInAlphaChannel=!1}}]);