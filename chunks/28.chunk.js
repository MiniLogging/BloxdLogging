"use strict";(self.h6ljd275xwr=self.h6ljd275xwr||[]).push([[28,29],{13091:(n,y,H)=>{var o=H(11230),G=H(11114),h=H(11154),k=H(11253),i=H(11189),B=H(11240);i.e.prototype._partialLoadFile=function(n,y,H,o){let G=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(n,(n=>{H[y]=n,H._internalCount++,6===H._internalCount&&o(H)}),void 0,void 0,!0,((n,y)=>{G&&n&&G(n.status+" "+n.statusText,y)}))},i.e.prototype._cascadeLoadFiles=function(n,y,H){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const G=[];G._internalCount=0;for(let h=0;h<6;h++)this._partialLoadFile(H[h],h,G,y,o)},i.e.prototype._cascadeLoadImgs=function(n,y,H,o){let G=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5?arguments[5]:void 0;const k=[];k._internalCount=0;for(let i=0;i<6;i++)this._partialLoadImg(o[i],i,k,n,y,H,G,h)},i.e.prototype._partialLoadImg=function(n,y,H,o,G,i){let B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,V=arguments.length>7?arguments[7]:void 0;const q=(0,k.b)();(0,h.s)(n,(n=>{H[y]=n,H._internalCount++,o&&o.removePendingData(q),6===H._internalCount&&i&&i(G,H)}),((n,y)=>{o&&o.removePendingData(q),B&&B(n,y)}),o?o.offlineProvider:null,V),o&&o.addPendingData(q)},i.e.prototype.createCubeTextureBase=function(n,y,H,h){let k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,V=arguments.length>6?arguments[6]:void 0,q=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,b=arguments.length>8&&void 0!==arguments[8]&&arguments[8],A=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,U=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,T=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,W=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,z=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,Q=arguments.length>14&&void 0!==arguments[14]&&arguments[14],l=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const v=T||new o.b(this,7);v.isCube=!0,v.url=n,v.generateMipMaps=!h,v._lodGenerationScale=A,v._lodGenerationOffset=U,v._useSRGBBuffer=!!Q&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!h),v!==T&&(v.label=n.substring(0,60)),this._doNotHandleContextLost||(v._extension=q,v._files=H,v._buffer=l);const F=n;this._transformTextureUrl&&!T&&(n=this._transformTextureUrl(n));const g=q??function(n){const y=n.split("?")[0],H=y.lastIndexOf(".");return H>-1?y.substring(H).toLowerCase():""}(n),M=(0,B.b)(g),f=(n,y)=>{v.dispose(),i?i(n,y):n&&G.d.Warn(n)},c=(o,i)=>{n===F?o&&f(o.status+" "+o.statusText,i):(G.d.Warn(`Failed to load ${n}, falling back to the ${F}`),this.createCubeTextureBase(F,y,H,!!h,k,f,V,q,b,A,U,v,W,z,Q,l))};if(M)M.then((o=>{const G=n=>{W&&W(v,n),o.loadCubeData(n,v,b,k,((n,y)=>{f(n,y)}))};l?G(l):H&&6===H.length?o.supportCascades?this._cascadeLoadFiles(y,(n=>G(n.map((n=>new Uint8Array(n))))),H,f):f("Textures type does not support cascades."):this._loadFile(n,(n=>G(new Uint8Array(n))),void 0,void 0,!0,c)}));else{if(!H||0===H.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(y,v,((n,y)=>{z&&z(n,y)}),H,f)}return this._internalTexturesCache.push(v),v}},13829:(n,y,H)=>{H.r(y),H.d(y,{_DDSTextureLoader:()=>h});var o=H(11500),G=H(13834);class h{constructor(){this.supportCascades=!0}loadCubeData(n,y,H,h){const k=y.getEngine();let i,B=!1,V=1e3;if(Array.isArray(n))for(let o=0;o<n.length;o++){const H=n[o];i=G.DDSTools.GetDDSInfo(H),y.width=i.width,y.height=i.height,B=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&y.generateMipMaps,k._unpackFlipY(i.isCompressed),G.DDSTools.UploadDDSLevels(k,y,H,i,B,6,-1,o),i.isFourCC||1!==i.mipmapCount?V=i.mipmapCount-1:k.generateMipMapsForCubemap(y)}else{const h=n;i=G.DDSTools.GetDDSInfo(h),y.width=i.width,y.height=i.height,H&&(i.sphericalPolynomial=new o.f),B=(i.isRGB||i.isLuminance||i.mipmapCount>1)&&y.generateMipMaps,k._unpackFlipY(i.isCompressed),G.DDSTools.UploadDDSLevels(k,y,h,i,B,6),i.isFourCC||1!==i.mipmapCount?V=i.mipmapCount-1:k.generateMipMapsForCubemap(y,!1)}k._setCubeMapTextureParams(y,B,V),y.isReady=!0,y.onLoadedObservable.notifyObservers(y),y.onLoadedObservable.clear(),h&&h({isDDS:!0,width:y.width,info:i,data:n,texture:y})}loadData(n,y,H){const o=G.DDSTools.GetDDSInfo(n),h=(o.isRGB||o.isLuminance||o.mipmapCount>1)&&y.generateMipMaps&&Math.max(o.width,o.height)>>o.mipmapCount-1===1;H(o.width,o.height,h,o.isFourCC,(()=>{G.DDSTools.UploadDDSLevels(y.getEngine(),y,n,o,h,1)}))}}},11882:(n,y,H)=>{H.d(y,{b:()=>V});var o=H(11288),G=H(11303),h=H(11500),k=H(11297),i=H(11335);class B{constructor(n,y,H,o){this.name=n,this.worldAxisForNormal=y,this.worldAxisForFileX=H,this.worldAxisForFileY=o}}class V{static ConvertCubeMapTextureToSphericalPolynomial(n){var y;if(!n.isCube)return null;null===(y=n.pn())||void 0===y||y.getEngine().flushFramebuffer();const H=n.getSize().width,o=n.readPixels(0,void 0,void 0,!1),G=n.readPixels(1,void 0,void 0,!1);let h,k;n.isRenderTarget?(h=n.readPixels(3,void 0,void 0,!1),k=n.readPixels(2,void 0,void 0,!1)):(h=n.readPixels(2,void 0,void 0,!1),k=n.readPixels(3,void 0,void 0,!1));const i=n.readPixels(4,void 0,void 0,!1),B=n.readPixels(5,void 0,void 0,!1),V=n.gammaSpace;let q=0;return 1!=n.textureType&&2!=n.textureType||(q=1),new Promise((n=>{Promise.all([G,o,h,k,i,B]).then((y=>{let[o,G,h,k,i,B]=y;const b={size:H,right:G,left:o,up:h,down:k,front:i,back:B,format:5,type:q,gammaSpace:V};n(this.ConvertCubeMapToSphericalPolynomial(b))}))}))}static _AreaElement(n,y){return Math.atan2(n*y,Math.sqrt(n*n+y*y+1))}static ConvertCubeMapToSphericalPolynomial(n){const y=new h.b;let H=0;const o=2/n.size,B=o,V=.5*o,q=V-1;for(let h=0;h<6;h++){const b=this._FileFaces[h],A=n[b.name];let U=q;const T=5===n.format?4:3;for(let h=0;h<n.size;h++){let W=q;for(let B=0;B<n.size;B++){const q=b.worldAxisForFileX.scale(W).add(b.worldAxisForFileY.scale(U)).add(b.worldAxisForNormal);q.normalize();const z=this._AreaElement(W-V,U-V)-this._AreaElement(W-V,U+V)-this._AreaElement(W+V,U-V)+this._AreaElement(W+V,U+V);let Q=A[h*n.size*T+B*T+0],l=A[h*n.size*T+B*T+1],v=A[h*n.size*T+B*T+2];isNaN(Q)&&(Q=0),isNaN(l)&&(l=0),isNaN(v)&&(v=0),0===n.type&&(Q/=255,l/=255,v/=255),n.gammaSpace&&(Q=Math.pow((0,G.Clamp)(Q),k.n),l=Math.pow((0,G.Clamp)(l),k.n),v=Math.pow((0,G.Clamp)(v),k.n));const F=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const n=Math.max(Q,l,v);if(n>F){const y=F/n;Q*=y,l*=y,v*=y}}else Q=(0,G.Clamp)(Q,0,F),l=(0,G.Clamp)(l,0,F),v=(0,G.Clamp)(v,0,F);const g=new i.Fy(Q,l,v);y.addLight(q,g,z),H+=z,W+=o}U+=B}}const b=6*(4*Math.PI)/6/H;return y.scaleInPlace(b),y.convertIncidentRadianceToIrradiance(),y.convertIrradianceToLambertianRadiance(),h.f.FromHarmonics(y)}}V._FileFaces=[new B("right",new o.zy(1,0,0),new o.zy(0,0,-1),new o.zy(0,-1,0)),new B("left",new o.zy(-1,0,0),new o.zy(0,0,1),new o.zy(0,-1,0)),new B("up",new o.zy(0,1,0),new o.zy(1,0,0),new o.zy(0,0,1)),new B("down",new o.zy(0,-1,0),new o.zy(1,0,0),new o.zy(0,0,-1)),new B("front",new o.zy(0,0,1),new o.zy(1,0,0),new o.zy(0,-1,0)),new B("back",new o.zy(0,0,-1),new o.zy(-1,0,0),new o.zy(0,-1,0))],V.MAX_HDRI_VALUE=4096,V.PRESERVE_CLAMPED_COLORS=!1},13834:(n,y,H)=>{H.d(y,{DDSTools:()=>T});var o=H(11303),G=H(11114),h=H(11882),k=H(11547);H(13091);const i=131072,B=131072;function V(n){return n.charCodeAt(0)+(n.charCodeAt(1)<<8)+(n.charCodeAt(2)<<16)+(n.charCodeAt(3)<<24)}const q=V("DXT1"),b=V("DXT3"),A=V("DXT5"),U=V("DX10");class T{static GetDDSInfo(n){const y=new Int32Array(n.buffer,n.byteOffset,31),H=new Int32Array(n.buffer,n.byteOffset,35);let o=1;y[2]&i&&(o=Math.max(1,y[7]));const G=y[21],h=G===U?H[32]:0;let k=0;switch(G){case 113:k=2;break;case 116:k=1;break;case U:if(10===h){k=2;break}if(2===h){k=1;break}}return{width:y[4],height:y[3],mipmapCount:o,isFourCC:4===(4&y[20]),isRGB:64===(64&y[20]),isLuminance:(y[20]&B)===B,isCube:512===(512&y[28]),isCompressed:G===q||G===b||G===A,dxgiFormat:h,textureType:k}}static _GetHalfFloatAsFloatRGBAArrayBuffer(n,y,H,o,G,h){const i=new Float32Array(o),B=new Uint16Array(G,H);let V=0;for(let q=0;q<y;q++)for(let y=0;y<n;y++){const H=4*(y+q*n);i[V]=(0,k.e)(B[H]),i[V+1]=(0,k.e)(B[H+1]),i[V+2]=(0,k.e)(B[H+2]),T.StoreLODInAlphaChannel?i[V+3]=h:i[V+3]=(0,k.e)(B[H+3]),V+=4}return i}static _GetHalfFloatRGBAArrayBuffer(n,y,H,o,G,h){if(T.StoreLODInAlphaChannel){const i=new Uint16Array(o),B=new Uint16Array(G,H);let V=0;for(let H=0;H<y;H++)for(let y=0;y<n;y++){const o=4*(y+H*n);i[V]=B[o],i[V+1]=B[o+1],i[V+2]=B[o+2],i[V+3]=(0,k.k)(h),V+=4}return i}return new Uint16Array(G,H,o)}static _GetFloatRGBAArrayBuffer(n,y,H,o,G,h){if(T.StoreLODInAlphaChannel){const k=new Float32Array(o),i=new Float32Array(G,H);let B=0;for(let H=0;H<y;H++)for(let y=0;y<n;y++){const o=4*(y+H*n);k[B]=i[o],k[B+1]=i[o+1],k[B+2]=i[o+2],k[B+3]=h,B+=4}return k}return new Float32Array(G,H,o)}static _GetFloatAsHalfFloatRGBAArrayBuffer(n,y,H,o,G,h){const i=new Uint16Array(o),B=new Float32Array(G,H);let V=0;for(let q=0;q<y;q++)for(let y=0;y<n;y++)i[V]=(0,k.k)(B[V]),i[V+1]=(0,k.k)(B[V+1]),i[V+2]=(0,k.k)(B[V+2]),T.StoreLODInAlphaChannel?i[V+3]=(0,k.k)(h):i[V+3]=(0,k.k)(B[V+3]),V+=4;return i}static _GetFloatAsUIntRGBAArrayBuffer(n,y,H,G,h,k){const i=new Uint8Array(G),B=new Float32Array(h,H);let V=0;for(let q=0;q<y;q++)for(let y=0;y<n;y++){const H=4*(y+q*n);i[V]=255*(0,o.Clamp)(B[H]),i[V+1]=255*(0,o.Clamp)(B[H+1]),i[V+2]=255*(0,o.Clamp)(B[H+2]),T.StoreLODInAlphaChannel?i[V+3]=k:i[V+3]=255*(0,o.Clamp)(B[H+3]),V+=4}return i}static _GetHalfFloatAsUIntRGBAArrayBuffer(n,y,H,G,h,i){const B=new Uint8Array(G),V=new Uint16Array(h,H);let q=0;for(let b=0;b<y;b++)for(let y=0;y<n;y++){const H=4*(y+b*n);B[q]=255*(0,o.Clamp)((0,k.e)(V[H])),B[q+1]=255*(0,o.Clamp)((0,k.e)(V[H+1])),B[q+2]=255*(0,o.Clamp)((0,k.e)(V[H+2])),T.StoreLODInAlphaChannel?B[q+3]=i:B[q+3]=255*(0,o.Clamp)((0,k.e)(V[H+3])),q+=4}return B}static _GetRGBAArrayBuffer(n,y,H,o,G,h,k,i,B){const V=new Uint8Array(o),q=new Uint8Array(G,H);let b=0;for(let A=0;A<y;A++)for(let y=0;y<n;y++){const H=4*(y+A*n);V[b]=q[H+h],V[b+1]=q[H+k],V[b+2]=q[H+i],V[b+3]=q[H+B],b+=4}return V}static _ExtractLongWordOrder(n){return 0===n||255===n||-16777216===n?0:1+T._ExtractLongWordOrder(n>>8)}static _GetRGBArrayBuffer(n,y,H,o,G,h,k,i){const B=new Uint8Array(o),V=new Uint8Array(G,H);let q=0;for(let b=0;b<y;b++)for(let y=0;y<n;y++){const H=3*(y+b*n);B[q]=V[H+h],B[q+1]=V[H+k],B[q+2]=V[H+i],q+=3}return B}static _GetLuminanceArrayBuffer(n,y,H,o,G){const h=new Uint8Array(o),k=new Uint8Array(G,H);let i=0;for(let B=0;B<y;B++)for(let y=0;y<n;y++){const H=y+B*n;h[i]=k[H],i++}return h}static UploadDDSLevels(n,y,H,o,k,B){let V=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,W=arguments.length>7?arguments[7]:void 0,z=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],Q=null;o.sphericalPolynomial&&(Q=[]);const l=!!n.getCaps().s3tc;y.generateMipMaps=k;const v=new Int32Array(H.buffer,H.byteOffset,31);let F,g,M,f,c,p,E,X=0,d=0,a=1;if(542327876!==v[0])return void G.d.Error("Invalid magic number in DDS header");if(!o.isFourCC&&!o.isRGB&&!o.isLuminance)return void G.d.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(o.isCompressed&&!l)return void G.d.Error("Compressed textures are not supported on this platform.");let O=v[22];f=v[1]+4;let e=!1;if(o.isFourCC)switch(F=v[21],F){case q:a=8,d=33777;break;case b:a=16,d=33778;break;case A:a=16,d=33779;break;case 113:e=!0,O=64;break;case 116:e=!0,O=128;break;case U:{f+=20;let n=!1;switch(o.dxgiFormat){case 10:e=!0,O=64,n=!0;break;case 2:e=!0,O=128,n=!0;break;case 88:o.isRGB=!0,o.isFourCC=!1,O=32,n=!0}if(n)break}default:return void G.d.Error(["Unsupported FourCC code:",(w=F,String.fromCharCode(255&w,w>>8&255,w>>16&255,w>>24&255))])}var w;const j=T._ExtractLongWordOrder(v[23]),I=T._ExtractLongWordOrder(v[24]),R=T._ExtractLongWordOrder(v[25]),C=T._ExtractLongWordOrder(v[26]);e&&(d=n._getRGBABufferInternalSizedFormat(o.textureType)),p=1,v[2]&i&&!1!==k&&(p=Math.max(1,v[7]));const S=W||0,N=n.getCaps();for(let G=S;G<B;G++){for(g=v[4],M=v[3],E=0;E<p;++E){if(-1===V||V===E){const h=-1===V?E:0;if(!o.isCompressed&&o.isFourCC){y.format=5,X=g*M*4;let o=null;if(n._badOS||n._badDesktopOS||!N.textureHalfFloat&&!N.textureFloat)128===O?(o=T._GetFloatAsUIntRGBAArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,h),Q&&0==h&&Q.push(T._GetFloatRGBAArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,h))):64===O&&(o=T._GetHalfFloatAsUIntRGBAArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,h),Q&&0==h&&Q.push(T._GetHalfFloatAsFloatRGBAArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,h))),y.type=0;else{const n=N.textureFloat&&(z&&N.textureFloatLinearFiltering||!z),G=N.textureHalfFloat&&(z&&N.textureHalfFloatLinearFiltering||!z),k=(128===O||64===O&&!G)&&n?1:(64===O||128===O&&!n)&&G?2:0;let i,B=null;if(128===O)switch(k){case 1:i=T._GetFloatRGBAArrayBuffer,B=null;break;case 2:i=T._GetFloatAsHalfFloatRGBAArrayBuffer,B=T._GetFloatRGBAArrayBuffer;break;case 0:i=T._GetFloatAsUIntRGBAArrayBuffer,B=T._GetFloatRGBAArrayBuffer}else switch(k){case 1:i=T._GetHalfFloatAsFloatRGBAArrayBuffer,B=null;break;case 2:i=T._GetHalfFloatRGBAArrayBuffer,B=T._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:i=T._GetHalfFloatAsUIntRGBAArrayBuffer,B=T._GetHalfFloatAsFloatRGBAArrayBuffer}y.type=k,o=i(g,M,H.byteOffset+f,X,H.buffer,h),Q&&0==h&&Q.push(B?B(g,M,H.byteOffset+f,X,H.buffer,h):o)}o&&n._uploadDataToTextureDirectly(y,o,G,h)}else if(o.isRGB)y.type=0,24===O?(y.format=4,X=g*M*3,c=T._GetRGBArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,j,I,R),n._uploadDataToTextureDirectly(y,c,G,h)):(y.format=5,X=g*M*4,c=T._GetRGBAArrayBuffer(g,M,H.byteOffset+f,X,H.buffer,j,I,R,C),n._uploadDataToTextureDirectly(y,c,G,h));else if(o.isLuminance){const o=n._getUnpackAlignement(),k=g;X=Math.floor((g+o-1)/o)*o*(M-1)+k,c=T._GetLuminanceArrayBuffer(g,M,H.byteOffset+f,X,H.buffer),y.format=1,y.type=0,n._uploadDataToTextureDirectly(y,c,G,h)}else X=Math.max(4,g)/4*Math.max(4,M)/4*a,c=new Uint8Array(H.buffer,H.byteOffset+f,X),y.type=0,n._uploadCompressedDataToTextureDirectly(y,d,g,M,c,G,h)}f+=O?g*M*(O/8):X,g*=.5,M*=.5,g=Math.max(1,g),M=Math.max(1,M)}if(void 0!==W)break}Q&&Q.length>0?o.sphericalPolynomial=h.b.ConvertCubeMapToSphericalPolynomial({size:v[4],right:Q[0],left:Q[1],up:Q[2],down:Q[3],front:Q[4],back:Q[5],format:5,type:1,gammaSpace:!1}):o.sphericalPolynomial=void 0}}T.StoreLODInAlphaChannel=!1}}]);