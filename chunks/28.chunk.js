"use strict";(self.fyqbdzs5tyo=self.fyqbdzs5tyo||[]).push([[28,29],{12932:(V,I,A)=>{var B=A(11167),F=A(11064),E=A(11105),Y=A(11194),H=A(11137),c=A(11178);H.e.prototype._partialLoadFile=function(V,I,A,B){let F=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(V,(V=>{A[I]=V,A._internalCount++,6===A._internalCount&&B(A)}),void 0,void 0,!0,((V,I)=>{F&&V&&F(V.status+" "+V.statusText,I)}))},H.e.prototype._cascadeLoadFiles=function(V,I,A){let B=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const F=[];F._internalCount=0;for(let E=0;E<6;E++)this._partialLoadFile(A[E],E,F,I,B)},H.e.prototype._cascadeLoadImgs=function(V,I,A,B){let F=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,E=arguments.length>5?arguments[5]:void 0;const Y=[];Y._internalCount=0;for(let H=0;H<6;H++)this._partialLoadImg(B[H],H,Y,V,I,A,F,E)},H.e.prototype._partialLoadImg=function(V,I,A,B,F,H){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,b=arguments.length>7?arguments[7]:void 0;const X=(0,Y.c)();(0,E.r)(V,(V=>{A[I]=V,A._internalCount++,B&&B.removePendingData(X),6===A._internalCount&&H&&H(F,A)}),((V,I)=>{B&&B.removePendingData(X),c&&c(V,I)}),B?B.offlineProvider:null,b),B&&B.addPendingData(X)},H.e.prototype.createCubeTextureBase=function(V,I,A,E){let Y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,H=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,b=arguments.length>6?arguments[6]:void 0,X=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,P=arguments.length>8&&void 0!==arguments[8]&&arguments[8],J=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,G=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,w=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,t=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,u=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,W=arguments.length>14&&void 0!==arguments[14]&&arguments[14],g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const o=w||new B.d(this,7);o.isCube=!0,o.url=V,o.generateMipMaps=!E,o._lodGenerationScale=J,o._lodGenerationOffset=G,o._useSRGBBuffer=!!W&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!E),o!==w&&(o.label=V.substring(0,60)),this._doNotHandleContextLost||(o._extension=X,o._files=A,o._buffer=g);const L=V;this._transformTextureUrl&&!w&&(V=this._transformTextureUrl(V));const z=X??function(V){const I=V.split("?")[0],A=I.lastIndexOf(".");return A>-1?I.substring(A).toLowerCase():""}(V),m=(0,c.b)(z),s=(V,I)=>{o.dispose(),H?H(V,I):V&&F.b.Warn(V)},e=(B,H)=>{V===L?B&&s(B.status+" "+B.statusText,H):(F.b.Warn(`Failed to load ${V}, falling back to the ${L}`),this.createCubeTextureBase(L,I,A,!!E,Y,s,b,X,P,J,G,o,t,u,W,g))};if(m)m.then((B=>{const F=V=>{t&&t(o,V),B.loadCubeData(V,o,P,Y,((V,I)=>{s(V,I)}))};g?F(g):A&&6===A.length?B.supportCascades?this._cascadeLoadFiles(I,(V=>F(V.map((V=>new Uint8Array(V))))),A,s):s("Textures type does not support cascades."):this._loadFile(V,(V=>F(new Uint8Array(V))),void 0,void 0,!0,e)}));else{if(!A||0===A.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(I,o,((V,I)=>{u&&u(V,I)}),A,s)}return this._internalTexturesCache.push(o),o}},13636:(V,I,A)=>{A.r(I),A.d(I,{_DDSTextureLoader:()=>E});var B=A(11416),F=A(13643);class E{constructor(){this.supportCascades=!0}loadCubeData(V,I,A,E){const Y=I.getEngine();let H,c=!1,b=1e3;if(Array.isArray(V))for(let B=0;B<V.length;B++){const A=V[B];H=F.DDSTools.GetDDSInfo(A),I.width=H.width,I.height=H.height,c=(H.isRGB||H.isLuminance||H.mipmapCount>1)&&I.generateMipMaps,Y._unpackFlipY(H.isCompressed),F.DDSTools.UploadDDSLevels(Y,I,A,H,c,6,-1,B),H.isFourCC||1!==H.mipmapCount?b=H.mipmapCount-1:Y.generateMipMapsForCubemap(I)}else{const E=V;H=F.DDSTools.GetDDSInfo(E),I.width=H.width,I.height=H.height,A&&(H.sphericalPolynomial=new B.h),c=(H.isRGB||H.isLuminance||H.mipmapCount>1)&&I.generateMipMaps,Y._unpackFlipY(H.isCompressed),F.DDSTools.UploadDDSLevels(Y,I,E,H,c,6),H.isFourCC||1!==H.mipmapCount?b=H.mipmapCount-1:Y.generateMipMapsForCubemap(I,!1)}Y._setCubeMapTextureParams(I,c,b),I.isReady=!0,I.onLoadedObservable.notifyObservers(I),I.onLoadedObservable.clear(),E&&E({isDDS:!0,width:I.width,info:H,data:V,texture:I})}loadData(V,I,A){const B=F.DDSTools.GetDDSInfo(V),E=(B.isRGB||B.isLuminance||B.mipmapCount>1)&&I.generateMipMaps&&Math.max(B.width,B.height)>>B.mipmapCount-1===1;A(B.width,B.height,E,B.isFourCC,(()=>{F.DDSTools.UploadDDSLevels(I.getEngine(),I,V,B,E,1)}))}}},11786:(V,I,A)=>{A.d(I,{d:()=>b});var B=A(11231),F=A(11249),E=A(11416),Y=A(11237),H=A(11276);class c{constructor(V,I,A,B){this.name=V,this.worldAxisForNormal=I,this.worldAxisForFileX=A,this.worldAxisForFileY=B}}class b{static ConvertCubeMapTextureToSphericalPolynomial(V){var I;if(!V.isCube)return null;null===(I=V.sV())||void 0===I||I.getEngine().flushFramebuffer();const A=V.getSize().width,B=V.readPixels(0,void 0,void 0,!1),F=V.readPixels(1,void 0,void 0,!1);let E,Y;V.isRenderTarget?(E=V.readPixels(3,void 0,void 0,!1),Y=V.readPixels(2,void 0,void 0,!1)):(E=V.readPixels(2,void 0,void 0,!1),Y=V.readPixels(3,void 0,void 0,!1));const H=V.readPixels(4,void 0,void 0,!1),c=V.readPixels(5,void 0,void 0,!1),b=V.gammaSpace;let X=0;return 1!=V.textureType&&2!=V.textureType||(X=1),new Promise((V=>{Promise.all([F,B,E,Y,H,c]).then((I=>{let[B,F,E,Y,H,c]=I;const P={size:A,right:F,left:B,up:E,down:Y,front:H,back:c,format:5,type:X,gammaSpace:b};V(this.ConvertCubeMapToSphericalPolynomial(P))}))}))}static _AreaElement(V,I){return Math.atan2(V*I,Math.sqrt(V*V+I*I+1))}static ConvertCubeMapToSphericalPolynomial(V){const I=new E.e;let A=0;const B=2/V.size,c=B,b=.5*B,X=b-1;for(let E=0;E<6;E++){const P=this._FileFaces[E],J=V[P.name];let G=X;const w=5===V.format?4:3;for(let E=0;E<V.size;E++){let t=X;for(let c=0;c<V.size;c++){const X=P.worldAxisForFileX.scale(t).add(P.worldAxisForFileY.scale(G)).add(P.worldAxisForNormal);X.normalize();const u=this._AreaElement(t-b,G-b)-this._AreaElement(t-b,G+b)-this._AreaElement(t+b,G-b)+this._AreaElement(t+b,G+b);let W=J[E*V.size*w+c*w+0],g=J[E*V.size*w+c*w+1],o=J[E*V.size*w+c*w+2];isNaN(W)&&(W=0),isNaN(g)&&(g=0),isNaN(o)&&(o=0),0===V.type&&(W/=255,g/=255,o/=255),V.gammaSpace&&(W=Math.pow((0,F.Clamp)(W),Y.j),g=Math.pow((0,F.Clamp)(g),Y.j),o=Math.pow((0,F.Clamp)(o),Y.j));const L=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const V=Math.max(W,g,o);if(V>L){const I=L/V;W*=I,g*=I,o*=I}}else W=(0,F.Clamp)(W,0,L),g=(0,F.Clamp)(g,0,L),o=(0,F.Clamp)(o,0,L);const z=new H.oI(W,g,o);I.addLight(X,z,u),A+=u,t+=B}G+=c}}const P=6*(4*Math.PI)/6/A;return I.scaleInPlace(P),I.convertIncidentRadianceToIrradiance(),I.convertIrradianceToLambertianRadiance(),E.h.FromHarmonics(I)}}b._FileFaces=[new c("right",new B.tI(1,0,0),new B.tI(0,0,-1),new B.tI(0,-1,0)),new c("left",new B.tI(-1,0,0),new B.tI(0,0,1),new B.tI(0,-1,0)),new c("up",new B.tI(0,1,0),new B.tI(1,0,0),new B.tI(0,0,1)),new c("down",new B.tI(0,-1,0),new B.tI(1,0,0),new B.tI(0,0,-1)),new c("front",new B.tI(0,0,1),new B.tI(1,0,0),new B.tI(0,-1,0)),new c("back",new B.tI(0,0,-1),new B.tI(-1,0,0),new B.tI(0,-1,0))],b.MAX_HDRI_VALUE=4096,b.PRESERVE_CLAMPED_COLORS=!1},13643:(V,I,A)=>{A.d(I,{DDSTools:()=>w});var B=A(11249),F=A(11064),E=A(11786),Y=A(11461);A(12932);const H=131072,c=131072;function b(V){return V.charCodeAt(0)+(V.charCodeAt(1)<<8)+(V.charCodeAt(2)<<16)+(V.charCodeAt(3)<<24)}const X=b("DXT1"),P=b("DXT3"),J=b("DXT5"),G=b("DX10");class w{static GetDDSInfo(V){const I=new Int32Array(V.buffer,V.byteOffset,31),A=new Int32Array(V.buffer,V.byteOffset,35);let B=1;I[2]&H&&(B=Math.max(1,I[7]));const F=I[21],E=F===G?A[32]:0;let Y=0;switch(F){case 113:Y=2;break;case 116:Y=1;break;case G:if(10===E){Y=2;break}if(2===E){Y=1;break}}return{width:I[4],height:I[3],mipmapCount:B,isFourCC:4===(4&I[20]),isRGB:64===(64&I[20]),isLuminance:(I[20]&c)===c,isCube:512===(512&I[28]),isCompressed:F===X||F===P||F===J,dxgiFormat:E,textureType:Y}}static _GetHalfFloatAsFloatRGBAArrayBuffer(V,I,A,B,F,E){const H=new Float32Array(B),c=new Uint16Array(F,A);let b=0;for(let X=0;X<I;X++)for(let I=0;I<V;I++){const A=4*(I+X*V);H[b]=(0,Y.e)(c[A]),H[b+1]=(0,Y.e)(c[A+1]),H[b+2]=(0,Y.e)(c[A+2]),w.StoreLODInAlphaChannel?H[b+3]=E:H[b+3]=(0,Y.e)(c[A+3]),b+=4}return H}static _GetHalfFloatRGBAArrayBuffer(V,I,A,B,F,E){if(w.StoreLODInAlphaChannel){const H=new Uint16Array(B),c=new Uint16Array(F,A);let b=0;for(let A=0;A<I;A++)for(let I=0;I<V;I++){const B=4*(I+A*V);H[b]=c[B],H[b+1]=c[B+1],H[b+2]=c[B+2],H[b+3]=(0,Y.n)(E),b+=4}return H}return new Uint16Array(F,A,B)}static _GetFloatRGBAArrayBuffer(V,I,A,B,F,E){if(w.StoreLODInAlphaChannel){const Y=new Float32Array(B),H=new Float32Array(F,A);let c=0;for(let A=0;A<I;A++)for(let I=0;I<V;I++){const B=4*(I+A*V);Y[c]=H[B],Y[c+1]=H[B+1],Y[c+2]=H[B+2],Y[c+3]=E,c+=4}return Y}return new Float32Array(F,A,B)}static _GetFloatAsHalfFloatRGBAArrayBuffer(V,I,A,B,F,E){const H=new Uint16Array(B),c=new Float32Array(F,A);let b=0;for(let X=0;X<I;X++)for(let I=0;I<V;I++)H[b]=(0,Y.n)(c[b]),H[b+1]=(0,Y.n)(c[b+1]),H[b+2]=(0,Y.n)(c[b+2]),w.StoreLODInAlphaChannel?H[b+3]=(0,Y.n)(E):H[b+3]=(0,Y.n)(c[b+3]),b+=4;return H}static _GetFloatAsUIntRGBAArrayBuffer(V,I,A,F,E,Y){const H=new Uint8Array(F),c=new Float32Array(E,A);let b=0;for(let X=0;X<I;X++)for(let I=0;I<V;I++){const A=4*(I+X*V);H[b]=255*(0,B.Clamp)(c[A]),H[b+1]=255*(0,B.Clamp)(c[A+1]),H[b+2]=255*(0,B.Clamp)(c[A+2]),w.StoreLODInAlphaChannel?H[b+3]=Y:H[b+3]=255*(0,B.Clamp)(c[A+3]),b+=4}return H}static _GetHalfFloatAsUIntRGBAArrayBuffer(V,I,A,F,E,H){const c=new Uint8Array(F),b=new Uint16Array(E,A);let X=0;for(let P=0;P<I;P++)for(let I=0;I<V;I++){const A=4*(I+P*V);c[X]=255*(0,B.Clamp)((0,Y.e)(b[A])),c[X+1]=255*(0,B.Clamp)((0,Y.e)(b[A+1])),c[X+2]=255*(0,B.Clamp)((0,Y.e)(b[A+2])),w.StoreLODInAlphaChannel?c[X+3]=H:c[X+3]=255*(0,B.Clamp)((0,Y.e)(b[A+3])),X+=4}return c}static _GetRGBAArrayBuffer(V,I,A,B,F,E,Y,H,c){const b=new Uint8Array(B),X=new Uint8Array(F,A);let P=0;for(let J=0;J<I;J++)for(let I=0;I<V;I++){const A=4*(I+J*V);b[P]=X[A+E],b[P+1]=X[A+Y],b[P+2]=X[A+H],b[P+3]=X[A+c],P+=4}return b}static _ExtractLongWordOrder(V){return 0===V||255===V||-16777216===V?0:1+w._ExtractLongWordOrder(V>>8)}static _GetRGBArrayBuffer(V,I,A,B,F,E,Y,H){const c=new Uint8Array(B),b=new Uint8Array(F,A);let X=0;for(let P=0;P<I;P++)for(let I=0;I<V;I++){const A=3*(I+P*V);c[X]=b[A+E],c[X+1]=b[A+Y],c[X+2]=b[A+H],X+=3}return c}static _GetLuminanceArrayBuffer(V,I,A,B,F){const E=new Uint8Array(B),Y=new Uint8Array(F,A);let H=0;for(let c=0;c<I;c++)for(let I=0;I<V;I++){const A=I+c*V;E[H]=Y[A],H++}return E}static UploadDDSLevels(V,I,A,B,Y,c){let b=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,t=arguments.length>7?arguments[7]:void 0,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],W=null;B.sphericalPolynomial&&(W=[]);const g=!!V.getCaps().s3tc;I.generateMipMaps=Y;const o=new Int32Array(A.buffer,A.byteOffset,31);let L,z,m,s,e,S,Q,h=0,r=0,M=1;if(542327876!==o[0])return void F.b.Error("Invalid magic number in DDS header");if(!B.isFourCC&&!B.isRGB&&!B.isLuminance)return void F.b.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(B.isCompressed&&!g)return void F.b.Error("Compressed textures are not supported on this platform.");let x=o[22];s=o[1]+4;let f=!1;if(B.isFourCC)switch(L=o[21],L){case X:M=8,r=33777;break;case P:M=16,r=33778;break;case J:M=16,r=33779;break;case 113:f=!0,x=64;break;case 116:f=!0,x=128;break;case G:{s+=20;let V=!1;switch(B.dxgiFormat){case 10:f=!0,x=64,V=!0;break;case 2:f=!0,x=128,V=!0;break;case 88:B.isRGB=!0,B.isFourCC=!1,x=32,V=!0}if(V)break}default:return void F.b.Error(["Unsupported FourCC code:",(R=L,String.fromCharCode(255&R,R>>8&255,R>>16&255,R>>24&255))])}var R;const q=w._ExtractLongWordOrder(o[23]),N=w._ExtractLongWordOrder(o[24]),l=w._ExtractLongWordOrder(o[25]),i=w._ExtractLongWordOrder(o[26]);f&&(r=V._getRGBABufferInternalSizedFormat(B.textureType)),S=1,o[2]&H&&!1!==Y&&(S=Math.max(1,o[7]));const y=t||0,v=V.getCaps();for(let F=y;F<c;F++){for(z=o[4],m=o[3],Q=0;Q<S;++Q){if(-1===b||b===Q){const E=-1===b?Q:0;if(!B.isCompressed&&B.isFourCC){I.format=5,h=z*m*4;let B=null;if(V._badOS||V._badDesktopOS||!v.textureHalfFloat&&!v.textureFloat)128===x?(B=w._GetFloatAsUIntRGBAArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,E),W&&0==E&&W.push(w._GetFloatRGBAArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,E))):64===x&&(B=w._GetHalfFloatAsUIntRGBAArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,E),W&&0==E&&W.push(w._GetHalfFloatAsFloatRGBAArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,E))),I.type=0;else{const V=v.textureFloat&&(u&&v.textureFloatLinearFiltering||!u),F=v.textureHalfFloat&&(u&&v.textureHalfFloatLinearFiltering||!u),Y=(128===x||64===x&&!F)&&V?1:(64===x||128===x&&!V)&&F?2:0;let H,c=null;if(128===x)switch(Y){case 1:H=w._GetFloatRGBAArrayBuffer,c=null;break;case 2:H=w._GetFloatAsHalfFloatRGBAArrayBuffer,c=w._GetFloatRGBAArrayBuffer;break;case 0:H=w._GetFloatAsUIntRGBAArrayBuffer,c=w._GetFloatRGBAArrayBuffer}else switch(Y){case 1:H=w._GetHalfFloatAsFloatRGBAArrayBuffer,c=null;break;case 2:H=w._GetHalfFloatRGBAArrayBuffer,c=w._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:H=w._GetHalfFloatAsUIntRGBAArrayBuffer,c=w._GetHalfFloatAsFloatRGBAArrayBuffer}I.type=Y,B=H(z,m,A.byteOffset+s,h,A.buffer,E),W&&0==E&&W.push(c?c(z,m,A.byteOffset+s,h,A.buffer,E):B)}B&&V._uploadDataToTextureDirectly(I,B,F,E)}else if(B.isRGB)I.type=0,24===x?(I.format=4,h=z*m*3,e=w._GetRGBArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,q,N,l),V._uploadDataToTextureDirectly(I,e,F,E)):(I.format=5,h=z*m*4,e=w._GetRGBAArrayBuffer(z,m,A.byteOffset+s,h,A.buffer,q,N,l,i),V._uploadDataToTextureDirectly(I,e,F,E));else if(B.isLuminance){const B=V._getUnpackAlignement(),Y=z;h=Math.floor((z+B-1)/B)*B*(m-1)+Y,e=w._GetLuminanceArrayBuffer(z,m,A.byteOffset+s,h,A.buffer),I.format=1,I.type=0,V._uploadDataToTextureDirectly(I,e,F,E)}else h=Math.max(4,z)/4*Math.max(4,m)/4*M,e=new Uint8Array(A.buffer,A.byteOffset+s,h),I.type=0,V._uploadCompressedDataToTextureDirectly(I,r,z,m,e,F,E)}s+=x?z*m*(x/8):h,z*=.5,m*=.5,z=Math.max(1,z),m=Math.max(1,m)}if(void 0!==t)break}W&&W.length>0?B.sphericalPolynomial=E.d.ConvertCubeMapToSphericalPolynomial({size:o[4],right:W[0],left:W[1],up:W[2],down:W[3],front:W[4],back:W[5],format:5,type:1,gammaSpace:!1}):B.sphericalPolynomial=void 0}}w.StoreLODInAlphaChannel=!1}}]);