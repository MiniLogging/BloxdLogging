"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[28],{13483:(s,Z,o)=>{o.r(Z),o.d(Z,{_IESTextureLoader:()=>O});var t=o(10935);function j(s){return s.split(" ").filter((s=>""!==s)).map((s=>parseFloat(s)))}function S(s,Z,o){for(;o.length!==Z;){const Z=j(s.lines[s.index++]);o.push(...Z)}}function a(s,Z,o){let j=0,S=0,a=0,O=0,v=0,G=0;for(let t=0;t<s.numberOfHorizontalAngles-1;t++)if(o<s.horizontalAngles[t+1]||t===s.numberOfHorizontalAngles-2){S=t,a=s.horizontalAngles[t],O=s.horizontalAngles[t+1];break}for(let t=0;t<s.numberOfVerticalAngles-1;t++)if(Z<s.verticalAngles[t+1]||t===s.numberOfVerticalAngles-2){j=t,v=s.verticalAngles[t],G=s.verticalAngles[t+1];break}const B=O-a,Q=G-v;if(0===Q)return 0;const D=0===B?0:(o-a)/B,z=(Z-v)/Q,Y=0===B?S:S+1,b=(0,t.Lerp)(s.candelaValues[S][j],s.candelaValues[Y][j],D),f=(0,t.Lerp)(s.candelaValues[S][j+1],s.candelaValues[Y][j+1],D);return(0,t.Lerp)(b,f,z)}class O{constructor(){this.supportCascades=!1}loadCubeData(){throw".ies not supported in Cube."}loadData(s,Z,o){const t=function(s){const Z={lines:new TextDecoder("utf-8").decode(s).split("\n"),index:0},o={version:Z.lines[0],candelaValues:[],horizontalAngles:[],verticalAngles:[],numberOfHorizontalAngles:0,numberOfVerticalAngles:0};for(Z.index=1;Z.lines.length>0&&!Z.lines[Z.index].includes("TILT=");)Z.index++;Z.lines[Z.index].includes("INCLUDE"),Z.index++;const t=j(Z.lines[Z.index++]);o.numberOfLights=t[0],o.lumensPerLamp=t[1],o.candelaMultiplier=t[2],o.numberOfVerticalAngles=t[3],o.numberOfHorizontalAngles=t[4],o.photometricType=t[5],o.unitsType=t[6],o.width=t[7],o.length=t[8],o.height=t[9];const O=j(Z.lines[Z.index++]);o.ballastFactor=O[0],o.fileGenerationType=O[1],o.inputWatts=O[2];for(let j=0;j<o.numberOfHorizontalAngles;j++)o.candelaValues[j]=[];S(Z,o.numberOfVerticalAngles,o.verticalAngles),S(Z,o.numberOfHorizontalAngles,o.horizontalAngles);for(let j=0;j<o.numberOfHorizontalAngles;j++)S(Z,o.numberOfVerticalAngles,o.candelaValues[j]);let v=-1;for(let j=0;j<o.numberOfHorizontalAngles;j++)for(let s=0;s<o.numberOfVerticalAngles;s++)o.candelaValues[j][s]*=o.candelaValues[j][s]*o.candelaMultiplier*o.ballastFactor*o.fileGenerationType,v=Math.max(v,o.candelaValues[j][s]);if(v>0)for(let j=0;j<o.numberOfHorizontalAngles;j++)for(let s=0;s<o.numberOfVerticalAngles;s++)o.candelaValues[j][s]/=v;const G=180,B=360,Q=new Float32Array(64800),D=o.horizontalAngles[0],z=o.horizontalAngles[o.numberOfHorizontalAngles-1];for(let j=0;j<64800;j++){let s=j%B;const Z=Math.floor(j/B);z-D!==0&&(s<D||s>=z)&&(s%=2*z,s>z&&(s=2*z-s)),Q[Z+s*G]=a(o,Z,s)}return{width:180,height:1,data:Q}}(new Uint8Array(s.buffer,s.byteOffset,s.byteLength));o(t.width,t.height,!1,!1,(()=>{const s=Z.getEngine();Z.type=1,Z.format=6,Z._gammaSpace=!1,s._uploadDataToTextureDirectly(Z,t.data)}))}}}}]);