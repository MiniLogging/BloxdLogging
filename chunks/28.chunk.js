"use strict";(self.g111kvdsqxc=self.g111kvdsqxc||[]).push([[28,29],{12967:(K,H,M)=>{var q=M(11216),w=M(11112),u=M(11152),y=M(11250),h=M(11180),W=M(11228);h.b.prototype._partialLoadFile=function(K,H,M,q){let w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(K,(K=>{M[H]=K,M._internalCount++,6===M._internalCount&&q(M)}),void 0,void 0,!0,((K,H)=>{w&&K&&w(K.status+" "+K.statusText,H)}))},h.b.prototype._cascadeLoadFiles=function(K,H,M){let q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const w=[];w._internalCount=0;for(let u=0;u<6;u++)this._partialLoadFile(M[u],u,w,H,q)},h.b.prototype._cascadeLoadImgs=function(K,H,M,q){let w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5?arguments[5]:void 0;const y=[];y._internalCount=0;for(let h=0;h<6;h++)this._partialLoadImg(q[h],h,y,K,H,M,w,u)},h.b.prototype._partialLoadImg=function(K,H,M,q,w,h){let W=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,I=arguments.length>7?arguments[7]:void 0;const f=(0,y.c)();(0,u.p)(K,(K=>{M[H]=K,M._internalCount++,q&&q.removePendingData(f),6===M._internalCount&&h&&h(w,M)}),((K,H)=>{q&&q.removePendingData(f),W&&W(K,H)}),q?q.offlineProvider:null,I),q&&q.addPendingData(f)},h.b.prototype.createCubeTextureBase=function(K,H,M,u){let y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,I=arguments.length>6?arguments[6]:void 0,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,z=arguments.length>8&&void 0!==arguments[8]&&arguments[8],G=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,a=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,v=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,O=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,L=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,S=arguments.length>14&&void 0!==arguments[14]&&arguments[14],B=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const C=v||new q.d(this,7);C.isCube=!0,C.url=K,C.generateMipMaps=!u,C._lodGenerationScale=G,C._lodGenerationOffset=a,C._useSRGBBuffer=!!S&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!u),C!==v&&(C.label=K.substring(0,60)),this._doNotHandleContextLost||(C._extension=f,C._files=M,C._buffer=B);const i=K;this._transformTextureUrl&&!v&&(K=this._transformTextureUrl(K));const Z=f??function(K){const H=K.split("?")[0],M=H.lastIndexOf(".");return M>-1?H.substring(M).toLowerCase():""}(K),E=(0,W.c)(Z),l=(K,H)=>{C.dispose(),h?h(K,H):K&&w.e.Warn(K)},s=(q,h)=>{K===i?q&&l(q.status+" "+q.statusText,h):(w.e.Warn(`Failed to load ${K}, falling back to the ${i}`),this.createCubeTextureBase(i,H,M,!!u,y,l,I,f,z,G,a,C,O,L,S,B))};if(E)E.then((q=>{const w=K=>{O&&O(C,K),q.loadCubeData(K,C,z,y,((K,H)=>{l(K,H)}))};B?w(B):M&&6===M.length?q.supportCascades?this._cascadeLoadFiles(H,(K=>w(K.map((K=>new Uint8Array(K))))),M,l):l("Textures type does not support cascades."):this._loadFile(K,(K=>w(new Uint8Array(K))),void 0,void 0,!0,s)}));else{if(!M||0===M.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(H,C,((K,H)=>{L&&L(K,H)}),M,l)}return this._internalTexturesCache.push(C),C}},13718:(K,H,M)=>{M.r(H),M.d(H,{_DDSTextureLoader:()=>u});var q=M(11472),w=M(13722);class u{constructor(){this.supportCascades=!0}loadCubeData(K,H,M,u){const y=H.getEngine();let h,W=!1,I=1e3;if(Array.isArray(K))for(let q=0;q<K.length;q++){const M=K[q];h=w.DDSTools.GetDDSInfo(M),H.width=h.width,H.height=h.height,W=(h.isRGB||h.isLuminance||h.mipmapCount>1)&&H.generateMipMaps,y._unpackFlipY(h.isCompressed),w.DDSTools.UploadDDSLevels(y,H,M,h,W,6,-1,q),h.isFourCC||1!==h.mipmapCount?I=h.mipmapCount-1:y.generateMipMapsForCubemap(H)}else{const u=K;h=w.DDSTools.GetDDSInfo(u),H.width=h.width,H.height=h.height,M&&(h.sphericalPolynomial=new q.e),W=(h.isRGB||h.isLuminance||h.mipmapCount>1)&&H.generateMipMaps,y._unpackFlipY(h.isCompressed),w.DDSTools.UploadDDSLevels(y,H,u,h,W,6),h.isFourCC||1!==h.mipmapCount?I=h.mipmapCount-1:y.generateMipMapsForCubemap(H,!1)}y._setCubeMapTextureParams(H,W,I),H.isReady=!0,H.onLoadedObservable.notifyObservers(H),H.onLoadedObservable.clear(),u&&u({isDDS:!0,width:H.width,info:h,data:K,texture:H})}loadData(K,H,M){const q=w.DDSTools.GetDDSInfo(K),u=(q.isRGB||q.isLuminance||q.mipmapCount>1)&&H.generateMipMaps&&Math.max(q.width,q.height)>>q.mipmapCount-1===1;M(q.width,q.height,u,q.isFourCC,(()=>{w.DDSTools.UploadDDSLevels(H.getEngine(),H,K,q,u,1)}))}}},11802:(K,H,M)=>{M.d(H,{b:()=>I});var q=M(11290),w=M(11307),u=M(11472),y=M(11297),h=M(11329);class W{constructor(K,H,M,q){this.name=K,this.worldAxisForNormal=H,this.worldAxisForFileX=M,this.worldAxisForFileY=q}}class I{static ConvertCubeMapTextureToSphericalPolynomial(K){var H;if(!K.isCube)return null;null===(H=K.sK())||void 0===H||H.getEngine().flushFramebuffer();const M=K.getSize().width,q=K.readPixels(0,void 0,void 0,!1),w=K.readPixels(1,void 0,void 0,!1);let u,y;K.isRenderTarget?(u=K.readPixels(3,void 0,void 0,!1),y=K.readPixels(2,void 0,void 0,!1)):(u=K.readPixels(2,void 0,void 0,!1),y=K.readPixels(3,void 0,void 0,!1));const h=K.readPixels(4,void 0,void 0,!1),W=K.readPixels(5,void 0,void 0,!1),I=K.gammaSpace;let f=0;return 1!=K.textureType&&2!=K.textureType||(f=1),new Promise((K=>{Promise.all([w,q,u,y,h,W]).then((H=>{let[q,w,u,y,h,W]=H;const z={size:M,right:w,left:q,up:u,down:y,front:h,back:W,format:5,type:f,gammaSpace:I};K(this.ConvertCubeMapToSphericalPolynomial(z))}))}))}static _AreaElement(K,H){return Math.atan2(K*H,Math.sqrt(K*K+H*H+1))}static ConvertCubeMapToSphericalPolynomial(K){const H=new u.d;let M=0;const q=2/K.size,W=q,I=.5*q,f=I-1;for(let u=0;u<6;u++){const z=this._FileFaces[u],G=K[z.name];let a=f;const v=5===K.format?4:3;for(let u=0;u<K.size;u++){let O=f;for(let W=0;W<K.size;W++){const f=z.worldAxisForFileX.scale(O).add(z.worldAxisForFileY.scale(a)).add(z.worldAxisForNormal);f.normalize();const L=this._AreaElement(O-I,a-I)-this._AreaElement(O-I,a+I)-this._AreaElement(O+I,a-I)+this._AreaElement(O+I,a+I);let S=G[u*K.size*v+W*v+0],B=G[u*K.size*v+W*v+1],C=G[u*K.size*v+W*v+2];isNaN(S)&&(S=0),isNaN(B)&&(B=0),isNaN(C)&&(C=0),0===K.type&&(S/=255,B/=255,C/=255),K.gammaSpace&&(S=Math.pow((0,w.Clamp)(S),y.l),B=Math.pow((0,w.Clamp)(B),y.l),C=Math.pow((0,w.Clamp)(C),y.l));const i=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const K=Math.max(S,B,C);if(K>i){const H=i/K;S*=H,B*=H,C*=H}}else S=(0,w.Clamp)(S,0,i),B=(0,w.Clamp)(B,0,i),C=(0,w.Clamp)(C,0,i);const Z=new h.CH(S,B,C);H.addLight(f,Z,L),M+=L,O+=q}a+=W}}const z=6*(4*Math.PI)/6/M;return H.scaleInPlace(z),H.convertIncidentRadianceToIrradiance(),H.convertIrradianceToLambertianRadiance(),u.e.FromHarmonics(H)}}I._FileFaces=[new W("right",new q.OH(1,0,0),new q.OH(0,0,-1),new q.OH(0,-1,0)),new W("left",new q.OH(-1,0,0),new q.OH(0,0,1),new q.OH(0,-1,0)),new W("up",new q.OH(0,1,0),new q.OH(1,0,0),new q.OH(0,0,1)),new W("down",new q.OH(0,-1,0),new q.OH(1,0,0),new q.OH(0,0,-1)),new W("front",new q.OH(0,0,1),new q.OH(1,0,0),new q.OH(0,-1,0)),new W("back",new q.OH(0,0,-1),new q.OH(-1,0,0),new q.OH(0,-1,0))],I.MAX_HDRI_VALUE=4096,I.PRESERVE_CLAMPED_COLORS=!1},13722:(K,H,M)=>{M.d(H,{DDSTools:()=>v});var q=M(11307),w=M(11112),u=M(11802),y=M(11507);M(12967);const h=131072,W=131072;function I(K){return K.charCodeAt(0)+(K.charCodeAt(1)<<8)+(K.charCodeAt(2)<<16)+(K.charCodeAt(3)<<24)}const f=I("DXT1"),z=I("DXT3"),G=I("DXT5"),a=I("DX10");class v{static GetDDSInfo(K){const H=new Int32Array(K.buffer,K.byteOffset,31),M=new Int32Array(K.buffer,K.byteOffset,35);let q=1;H[2]&h&&(q=Math.max(1,H[7]));const w=H[21],u=w===a?M[32]:0;let y=0;switch(w){case 113:y=2;break;case 116:y=1;break;case a:if(10===u){y=2;break}if(2===u){y=1;break}}return{width:H[4],height:H[3],mipmapCount:q,isFourCC:4===(4&H[20]),isRGB:64===(64&H[20]),isLuminance:(H[20]&W)===W,isCube:512===(512&H[28]),isCompressed:w===f||w===z||w===G,dxgiFormat:u,textureType:y}}static _GetHalfFloatAsFloatRGBAArrayBuffer(K,H,M,q,w,u){const h=new Float32Array(q),W=new Uint16Array(w,M);let I=0;for(let f=0;f<H;f++)for(let H=0;H<K;H++){const M=4*(H+f*K);h[I]=(0,y.g)(W[M]),h[I+1]=(0,y.g)(W[M+1]),h[I+2]=(0,y.g)(W[M+2]),v.StoreLODInAlphaChannel?h[I+3]=u:h[I+3]=(0,y.g)(W[M+3]),I+=4}return h}static _GetHalfFloatRGBAArrayBuffer(K,H,M,q,w,u){if(v.StoreLODInAlphaChannel){const h=new Uint16Array(q),W=new Uint16Array(w,M);let I=0;for(let M=0;M<H;M++)for(let H=0;H<K;H++){const q=4*(H+M*K);h[I]=W[q],h[I+1]=W[q+1],h[I+2]=W[q+2],h[I+3]=(0,y.n)(u),I+=4}return h}return new Uint16Array(w,M,q)}static _GetFloatRGBAArrayBuffer(K,H,M,q,w,u){if(v.StoreLODInAlphaChannel){const y=new Float32Array(q),h=new Float32Array(w,M);let W=0;for(let M=0;M<H;M++)for(let H=0;H<K;H++){const q=4*(H+M*K);y[W]=h[q],y[W+1]=h[q+1],y[W+2]=h[q+2],y[W+3]=u,W+=4}return y}return new Float32Array(w,M,q)}static _GetFloatAsHalfFloatRGBAArrayBuffer(K,H,M,q,w,u){const h=new Uint16Array(q),W=new Float32Array(w,M);let I=0;for(let f=0;f<H;f++)for(let H=0;H<K;H++)h[I]=(0,y.n)(W[I]),h[I+1]=(0,y.n)(W[I+1]),h[I+2]=(0,y.n)(W[I+2]),v.StoreLODInAlphaChannel?h[I+3]=(0,y.n)(u):h[I+3]=(0,y.n)(W[I+3]),I+=4;return h}static _GetFloatAsUIntRGBAArrayBuffer(K,H,M,w,u,y){const h=new Uint8Array(w),W=new Float32Array(u,M);let I=0;for(let f=0;f<H;f++)for(let H=0;H<K;H++){const M=4*(H+f*K);h[I]=255*(0,q.Clamp)(W[M]),h[I+1]=255*(0,q.Clamp)(W[M+1]),h[I+2]=255*(0,q.Clamp)(W[M+2]),v.StoreLODInAlphaChannel?h[I+3]=y:h[I+3]=255*(0,q.Clamp)(W[M+3]),I+=4}return h}static _GetHalfFloatAsUIntRGBAArrayBuffer(K,H,M,w,u,h){const W=new Uint8Array(w),I=new Uint16Array(u,M);let f=0;for(let z=0;z<H;z++)for(let H=0;H<K;H++){const M=4*(H+z*K);W[f]=255*(0,q.Clamp)((0,y.g)(I[M])),W[f+1]=255*(0,q.Clamp)((0,y.g)(I[M+1])),W[f+2]=255*(0,q.Clamp)((0,y.g)(I[M+2])),v.StoreLODInAlphaChannel?W[f+3]=h:W[f+3]=255*(0,q.Clamp)((0,y.g)(I[M+3])),f+=4}return W}static _GetRGBAArrayBuffer(K,H,M,q,w,u,y,h,W){const I=new Uint8Array(q),f=new Uint8Array(w,M);let z=0;for(let G=0;G<H;G++)for(let H=0;H<K;H++){const M=4*(H+G*K);I[z]=f[M+u],I[z+1]=f[M+y],I[z+2]=f[M+h],I[z+3]=f[M+W],z+=4}return I}static _ExtractLongWordOrder(K){return 0===K||255===K||-16777216===K?0:1+v._ExtractLongWordOrder(K>>8)}static _GetRGBArrayBuffer(K,H,M,q,w,u,y,h){const W=new Uint8Array(q),I=new Uint8Array(w,M);let f=0;for(let z=0;z<H;z++)for(let H=0;H<K;H++){const M=3*(H+z*K);W[f]=I[M+u],W[f+1]=I[M+y],W[f+2]=I[M+h],f+=3}return W}static _GetLuminanceArrayBuffer(K,H,M,q,w){const u=new Uint8Array(q),y=new Uint8Array(w,M);let h=0;for(let W=0;W<H;W++)for(let H=0;H<K;H++){const M=H+W*K;u[h]=y[M],h++}return u}static UploadDDSLevels(K,H,M,q,y,W){let I=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,O=arguments.length>7?arguments[7]:void 0,L=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],S=null;q.sphericalPolynomial&&(S=[]);const B=!!K.getCaps().s3tc;H.generateMipMaps=y;const C=new Int32Array(M.buffer,M.byteOffset,31);let i,Z,E,l,s,D,V,n=0,c=0,k=1;if(542327876!==C[0])return void w.e.Error("Invalid magic number in DDS header");if(!q.isFourCC&&!q.isRGB&&!q.isLuminance)return void w.e.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(q.isCompressed&&!B)return void w.e.Error("Compressed textures are not supported on this platform.");let T=C[22];l=C[1]+4;let d=!1;if(q.isFourCC)switch(i=C[21],i){case f:k=8,c=33777;break;case z:k=16,c=33778;break;case G:k=16,c=33779;break;case 113:d=!0,T=64;break;case 116:d=!0,T=128;break;case a:{l+=20;let K=!1;switch(q.dxgiFormat){case 10:d=!0,T=64,K=!0;break;case 2:d=!0,T=128,K=!0;break;case 88:q.isRGB=!0,q.isFourCC=!1,T=32,K=!0}if(K)break}default:return void w.e.Error(["Unsupported FourCC code:",(x=i,String.fromCharCode(255&x,x>>8&255,x>>16&255,x>>24&255))])}var x;const Q=v._ExtractLongWordOrder(C[23]),J=v._ExtractLongWordOrder(C[24]),N=v._ExtractLongWordOrder(C[25]),p=v._ExtractLongWordOrder(C[26]);d&&(c=K._getRGBABufferInternalSizedFormat(q.textureType)),D=1,C[2]&h&&!1!==y&&(D=Math.max(1,C[7]));const o=O||0,R=K.getCaps();for(let w=o;w<W;w++){for(Z=C[4],E=C[3],V=0;V<D;++V){if(-1===I||I===V){const u=-1===I?V:0;if(!q.isCompressed&&q.isFourCC){H.format=5,n=Z*E*4;let q=null;if(K._badOS||K._badDesktopOS||!R.textureHalfFloat&&!R.textureFloat)128===T?(q=v._GetFloatAsUIntRGBAArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,u),S&&0==u&&S.push(v._GetFloatRGBAArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,u))):64===T&&(q=v._GetHalfFloatAsUIntRGBAArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,u),S&&0==u&&S.push(v._GetHalfFloatAsFloatRGBAArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,u))),H.type=0;else{const K=R.textureFloat&&(L&&R.textureFloatLinearFiltering||!L),w=R.textureHalfFloat&&(L&&R.textureHalfFloatLinearFiltering||!L),y=(128===T||64===T&&!w)&&K?1:(64===T||128===T&&!K)&&w?2:0;let h,W=null;if(128===T)switch(y){case 1:h=v._GetFloatRGBAArrayBuffer,W=null;break;case 2:h=v._GetFloatAsHalfFloatRGBAArrayBuffer,W=v._GetFloatRGBAArrayBuffer;break;case 0:h=v._GetFloatAsUIntRGBAArrayBuffer,W=v._GetFloatRGBAArrayBuffer}else switch(y){case 1:h=v._GetHalfFloatAsFloatRGBAArrayBuffer,W=null;break;case 2:h=v._GetHalfFloatRGBAArrayBuffer,W=v._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:h=v._GetHalfFloatAsUIntRGBAArrayBuffer,W=v._GetHalfFloatAsFloatRGBAArrayBuffer}H.type=y,q=h(Z,E,M.byteOffset+l,n,M.buffer,u),S&&0==u&&S.push(W?W(Z,E,M.byteOffset+l,n,M.buffer,u):q)}q&&K._uploadDataToTextureDirectly(H,q,w,u)}else if(q.isRGB)H.type=0,24===T?(H.format=4,n=Z*E*3,s=v._GetRGBArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,Q,J,N),K._uploadDataToTextureDirectly(H,s,w,u)):(H.format=5,n=Z*E*4,s=v._GetRGBAArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer,Q,J,N,p),K._uploadDataToTextureDirectly(H,s,w,u));else if(q.isLuminance){const q=K._getUnpackAlignement(),y=Z;n=Math.floor((Z+q-1)/q)*q*(E-1)+y,s=v._GetLuminanceArrayBuffer(Z,E,M.byteOffset+l,n,M.buffer),H.format=1,H.type=0,K._uploadDataToTextureDirectly(H,s,w,u)}else n=Math.max(4,Z)/4*Math.max(4,E)/4*k,s=new Uint8Array(M.buffer,M.byteOffset+l,n),H.type=0,K._uploadCompressedDataToTextureDirectly(H,c,Z,E,s,w,u)}l+=T?Z*E*(T/8):n,Z*=.5,E*=.5,Z=Math.max(1,Z),E=Math.max(1,E)}if(void 0!==O)break}S&&S.length>0?q.sphericalPolynomial=u.b.ConvertCubeMapToSphericalPolynomial({size:C[4],right:S[0],left:S[1],up:S[2],down:S[3],front:S[4],back:S[5],format:5,type:1,gammaSpace:!1}):q.sphericalPolynomial=void 0}}v.StoreLODInAlphaChannel=!1}}]);