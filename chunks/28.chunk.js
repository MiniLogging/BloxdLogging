"use strict";(self["9s4i8ue3jq"]=self["9s4i8ue3jq"]||[]).push([[28,29],{14365:(a,c,o)=>{var s=o(12757),q=o(12649),t=o(12689),i=o(12779),p=o(12721),G=o(12768);p.b.prototype._partialLoadFile=function(a,c,o,s){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(a,(a=>{o[c]=a,o._internalCount++,6===o._internalCount&&s(o)}),void 0,void 0,!0,((a,c)=>{q&&a&&q(a.status+" "+a.statusText,c)}))},p.b.prototype._cascadeLoadFiles=function(a,c,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const q=[];q._internalCount=0;for(let t=0;t<6;t++)this._partialLoadFile(o[t],t,q,c,s)},p.b.prototype._cascadeLoadImgs=function(a,c,o,s){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,t=arguments.length>5?arguments[5]:void 0;const i=[];i._internalCount=0;for(let p=0;p<6;p++)this._partialLoadImg(s[p],p,i,a,c,o,q,t)},p.b.prototype._partialLoadImg=function(a,c,o,s,q,p){let G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,T=arguments.length>7?arguments[7]:void 0;const C=(0,i.d)();(0,t.n)(a,(a=>{o[c]=a,o._internalCount++,s&&s.removePendingData(C),6===o._internalCount&&p&&p(q,o)}),((a,c)=>{s&&s.removePendingData(C),G&&G(a,c)}),s?s.offlineProvider:null,T),s&&s.addPendingData(C)},p.b.prototype.createCubeTextureBase=function(a,c,o,t){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,T=arguments.length>6?arguments[6]:void 0,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,j=arguments.length>8&&void 0!==arguments[8]&&arguments[8],L=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,e=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,g=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,M=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,N=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,y=arguments.length>14&&void 0!==arguments[14]&&arguments[14],k=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const n=g||new s.b(this,7);n.isCube=!0,n.url=a,n.generateMipMaps=!t,n._lodGenerationScale=L,n._lodGenerationOffset=e,n._useSRGBBuffer=!!y&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!t),n!==g&&(n.label=a.substring(0,60)),this._doNotHandleContextLost||(n._extension=C,n._files=o,n._buffer=k);const f=a;this._transformTextureUrl&&!g&&(a=this._transformTextureUrl(a));const J=C??function(a){const c=a.split("?")[0],o=c.lastIndexOf(".");return o>-1?c.substring(o).toLowerCase():""}(a),w=(0,G.e)(J),Z=(a,c)=>{n.dispose(),p?p(a,c):a&&q.c.Warn(a)},h=(s,p)=>{a===f?s&&Z(s.status+" "+s.statusText,p):(q.c.Warn(`Failed to load ${a}, falling back to the ${f}`),this.createCubeTextureBase(f,c,o,!!t,i,Z,T,C,j,L,e,n,M,N,y,k))};if(w)w.then((s=>{const q=a=>{M&&M(n,a),s.loadCubeData(a,n,j,i,((a,c)=>{Z(a,c)}))};k?q(k):o&&6===o.length?s.supportCascades?this._cascadeLoadFiles(c,(a=>q(a.map((a=>new Uint8Array(a))))),o,Z):Z("Textures type does not support cascades."):this._loadFile(a,(a=>q(new Uint8Array(a))),void 0,void 0,!0,h)}));else{if(!o||0===o.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(c,n,((a,c)=>{N&&N(a,c)}),o,Z)}return this._internalTexturesCache.push(n),n}},15209:(a,c,o)=>{o.r(c),o.d(c,{_DDSTextureLoader:()=>t});var s=o(12993),q=o(15213);class t{constructor(){this.supportCascades=!0}loadCubeData(a,c,o,t){const i=c.getEngine();let p,G=!1,T=1e3;if(Array.isArray(a))for(let s=0;s<a.length;s++){const o=a[s];p=q.DDSTools.GetDDSInfo(o),c.width=p.width,c.height=p.height,G=(p.isRGB||p.isLuminance||p.mipmapCount>1)&&c.generateMipMaps,i._unpackFlipY(p.isCompressed),q.DDSTools.UploadDDSLevels(i,c,o,p,G,6,-1,s),p.isFourCC||1!==p.mipmapCount?T=p.mipmapCount-1:i.generateMipMapsForCubemap(c)}else{const t=a;p=q.DDSTools.GetDDSInfo(t),c.width=p.width,c.height=p.height,o&&(p.sphericalPolynomial=new s.e),G=(p.isRGB||p.isLuminance||p.mipmapCount>1)&&c.generateMipMaps,i._unpackFlipY(p.isCompressed),q.DDSTools.UploadDDSLevels(i,c,t,p,G,6),p.isFourCC||1!==p.mipmapCount?T=p.mipmapCount-1:i.generateMipMapsForCubemap(c,!1)}i._setCubeMapTextureParams(c,G,T),c.isReady=!0,c.onLoadedObservable.notifyObservers(c),c.onLoadedObservable.clear(),t&&t({isDDS:!0,width:c.width,info:p,data:a,texture:c})}loadData(a,c,o){const s=q.DDSTools.GetDDSInfo(a),t=(s.isRGB||s.isLuminance||s.mipmapCount>1)&&c.generateMipMaps&&Math.max(s.width,s.height)>>s.mipmapCount-1===1;o(s.width,s.height,t,s.isFourCC,(()=>{q.DDSTools.UploadDDSLevels(c.getEngine(),c,a,s,t,1)}))}}},13313:(a,c,o)=>{o.d(c,{e:()=>T});var s=o(12810),q=o(12824),t=o(12993),i=o(12812),p=o(12858);class G{constructor(a,c,o,s){this.name=a,this.worldAxisForNormal=c,this.worldAxisForFileX=o,this.worldAxisForFileY=s}}class T{static ConvertCubeMapTextureToSphericalPolynomial(a){var c;if(!a.isCube)return null;null===(c=a.Za())||void 0===c||c.getEngine().flushFramebuffer();const o=a.getSize().width,s=a.readPixels(0,void 0,void 0,!1),q=a.readPixels(1,void 0,void 0,!1);let t,i;a.isRenderTarget?(t=a.readPixels(3,void 0,void 0,!1),i=a.readPixels(2,void 0,void 0,!1)):(t=a.readPixels(2,void 0,void 0,!1),i=a.readPixels(3,void 0,void 0,!1));const p=a.readPixels(4,void 0,void 0,!1),G=a.readPixels(5,void 0,void 0,!1),T=a.gammaSpace;let C=0;return 1!=a.textureType&&2!=a.textureType||(C=1),new Promise((a=>{Promise.all([q,s,t,i,p,G]).then((c=>{let[s,q,t,i,p,G]=c;const j={size:o,right:q,left:s,up:t,down:i,front:p,back:G,format:5,type:C,gammaSpace:T};a(this.ConvertCubeMapToSphericalPolynomial(j))}))}))}static _AreaElement(a,c){return Math.atan2(a*c,Math.sqrt(a*a+c*c+1))}static ConvertCubeMapToSphericalPolynomial(a){const c=new t.d;let o=0;const s=2/a.size,G=s,T=.5*s,C=T-1;for(let t=0;t<6;t++){const j=this._FileFaces[t],L=a[j.name];let e=C;const g=5===a.format?4:3;for(let t=0;t<a.size;t++){let M=C;for(let G=0;G<a.size;G++){const C=j.worldAxisForFileX.scale(M).add(j.worldAxisForFileY.scale(e)).add(j.worldAxisForNormal);C.normalize();const N=this._AreaElement(M-T,e-T)-this._AreaElement(M-T,e+T)-this._AreaElement(M+T,e-T)+this._AreaElement(M+T,e+T);let y=L[t*a.size*g+G*g+0],k=L[t*a.size*g+G*g+1],n=L[t*a.size*g+G*g+2];isNaN(y)&&(y=0),isNaN(k)&&(k=0),isNaN(n)&&(n=0),0===a.type&&(y/=255,k/=255,n/=255),a.gammaSpace&&(y=Math.pow((0,q.Clamp)(y),i.i),k=Math.pow((0,q.Clamp)(k),i.i),n=Math.pow((0,q.Clamp)(n),i.i));const f=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const a=Math.max(y,k,n);if(a>f){const c=f/a;y*=c,k*=c,n*=c}}else y=(0,q.Clamp)(y,0,f),k=(0,q.Clamp)(k,0,f),n=(0,q.Clamp)(n,0,f);const J=new p.oo(y,k,n);c.addLight(C,J,N),o+=N,M+=s}e+=G}}const j=6*(4*Math.PI)/6/o;return c.scaleInPlace(j),c.convertIncidentRadianceToIrradiance(),c.convertIrradianceToLambertianRadiance(),t.e.FromHarmonics(c)}}T._FileFaces=[new G("right",new s.Hc(1,0,0),new s.Hc(0,0,-1),new s.Hc(0,-1,0)),new G("left",new s.Hc(-1,0,0),new s.Hc(0,0,1),new s.Hc(0,-1,0)),new G("up",new s.Hc(0,1,0),new s.Hc(1,0,0),new s.Hc(0,0,1)),new G("down",new s.Hc(0,-1,0),new s.Hc(1,0,0),new s.Hc(0,0,-1)),new G("front",new s.Hc(0,0,1),new s.Hc(1,0,0),new s.Hc(0,-1,0)),new G("back",new s.Hc(0,0,-1),new s.Hc(-1,0,0),new s.Hc(0,-1,0))],T.MAX_HDRI_VALUE=4096,T.PRESERVE_CLAMPED_COLORS=!1},15213:(a,c,o)=>{o.d(c,{DDSTools:()=>g});var s=o(12824),q=o(12649),t=o(13313),i=o(13035);o(14365);const p=131072,G=131072;function T(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}const C=T("DXT1"),j=T("DXT3"),L=T("DXT5"),e=T("DX10");class g{static GetDDSInfo(a){const c=new Int32Array(a.buffer,a.byteOffset,31),o=new Int32Array(a.buffer,a.byteOffset,35);let s=1;c[2]&p&&(s=Math.max(1,c[7]));const q=c[21],t=q===e?o[32]:0;let i=0;switch(q){case 113:i=2;break;case 116:i=1;break;case e:if(10===t){i=2;break}if(2===t){i=1;break}}return{width:c[4],height:c[3],mipmapCount:s,isFourCC:4===(4&c[20]),isRGB:64===(64&c[20]),isLuminance:(c[20]&G)===G,isCube:512===(512&c[28]),isCompressed:q===C||q===j||q===L,dxgiFormat:t,textureType:i}}static _GetHalfFloatAsFloatRGBAArrayBuffer(a,c,o,s,q,t){const p=new Float32Array(s),G=new Uint16Array(q,o);let T=0;for(let C=0;C<c;C++)for(let c=0;c<a;c++){const o=4*(c+C*a);p[T]=(0,i.g)(G[o]),p[T+1]=(0,i.g)(G[o+1]),p[T+2]=(0,i.g)(G[o+2]),g.StoreLODInAlphaChannel?p[T+3]=t:p[T+3]=(0,i.g)(G[o+3]),T+=4}return p}static _GetHalfFloatRGBAArrayBuffer(a,c,o,s,q,t){if(g.StoreLODInAlphaChannel){const p=new Uint16Array(s),G=new Uint16Array(q,o);let T=0;for(let o=0;o<c;o++)for(let c=0;c<a;c++){const s=4*(c+o*a);p[T]=G[s],p[T+1]=G[s+1],p[T+2]=G[s+2],p[T+3]=(0,i.s)(t),T+=4}return p}return new Uint16Array(q,o,s)}static _GetFloatRGBAArrayBuffer(a,c,o,s,q,t){if(g.StoreLODInAlphaChannel){const i=new Float32Array(s),p=new Float32Array(q,o);let G=0;for(let o=0;o<c;o++)for(let c=0;c<a;c++){const s=4*(c+o*a);i[G]=p[s],i[G+1]=p[s+1],i[G+2]=p[s+2],i[G+3]=t,G+=4}return i}return new Float32Array(q,o,s)}static _GetFloatAsHalfFloatRGBAArrayBuffer(a,c,o,s,q,t){const p=new Uint16Array(s),G=new Float32Array(q,o);let T=0;for(let C=0;C<c;C++)for(let c=0;c<a;c++)p[T]=(0,i.s)(G[T]),p[T+1]=(0,i.s)(G[T+1]),p[T+2]=(0,i.s)(G[T+2]),g.StoreLODInAlphaChannel?p[T+3]=(0,i.s)(t):p[T+3]=(0,i.s)(G[T+3]),T+=4;return p}static _GetFloatAsUIntRGBAArrayBuffer(a,c,o,q,t,i){const p=new Uint8Array(q),G=new Float32Array(t,o);let T=0;for(let C=0;C<c;C++)for(let c=0;c<a;c++){const o=4*(c+C*a);p[T]=255*(0,s.Clamp)(G[o]),p[T+1]=255*(0,s.Clamp)(G[o+1]),p[T+2]=255*(0,s.Clamp)(G[o+2]),g.StoreLODInAlphaChannel?p[T+3]=i:p[T+3]=255*(0,s.Clamp)(G[o+3]),T+=4}return p}static _GetHalfFloatAsUIntRGBAArrayBuffer(a,c,o,q,t,p){const G=new Uint8Array(q),T=new Uint16Array(t,o);let C=0;for(let j=0;j<c;j++)for(let c=0;c<a;c++){const o=4*(c+j*a);G[C]=255*(0,s.Clamp)((0,i.g)(T[o])),G[C+1]=255*(0,s.Clamp)((0,i.g)(T[o+1])),G[C+2]=255*(0,s.Clamp)((0,i.g)(T[o+2])),g.StoreLODInAlphaChannel?G[C+3]=p:G[C+3]=255*(0,s.Clamp)((0,i.g)(T[o+3])),C+=4}return G}static _GetRGBAArrayBuffer(a,c,o,s,q,t,i,p,G){const T=new Uint8Array(s),C=new Uint8Array(q,o);let j=0;for(let L=0;L<c;L++)for(let c=0;c<a;c++){const o=4*(c+L*a);T[j]=C[o+t],T[j+1]=C[o+i],T[j+2]=C[o+p],T[j+3]=C[o+G],j+=4}return T}static _ExtractLongWordOrder(a){return 0===a||255===a||-16777216===a?0:1+g._ExtractLongWordOrder(a>>8)}static _GetRGBArrayBuffer(a,c,o,s,q,t,i,p){const G=new Uint8Array(s),T=new Uint8Array(q,o);let C=0;for(let j=0;j<c;j++)for(let c=0;c<a;c++){const o=3*(c+j*a);G[C]=T[o+t],G[C+1]=T[o+i],G[C+2]=T[o+p],C+=3}return G}static _GetLuminanceArrayBuffer(a,c,o,s,q){const t=new Uint8Array(s),i=new Uint8Array(q,o);let p=0;for(let G=0;G<c;G++)for(let c=0;c<a;c++){const o=c+G*a;t[p]=i[o],p++}return t}static UploadDDSLevels(a,c,o,s,i,G){let T=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,M=arguments.length>7?arguments[7]:void 0,N=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],y=null;s.sphericalPolynomial&&(y=[]);const k=!!a.getCaps().s3tc;c.generateMipMaps=i;const n=new Int32Array(o.buffer,o.byteOffset,31);let f,J,w,Z,h,U,S,r=0,x=0,R=1;if(542327876!==n[0])return void q.c.Error("Invalid magic number in DDS header");if(!s.isFourCC&&!s.isRGB&&!s.isLuminance)return void q.c.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(s.isCompressed&&!k)return void q.c.Error("Compressed textures are not supported on this platform.");let d=n[22];Z=n[1]+4;let X=!1;if(s.isFourCC)switch(f=n[21],f){case C:R=8,x=33777;break;case j:R=16,x=33778;break;case L:R=16,x=33779;break;case 113:X=!0,d=64;break;case 116:X=!0,d=128;break;case e:{Z+=20;let a=!1;switch(s.dxgiFormat){case 10:X=!0,d=64,a=!0;break;case 2:X=!0,d=128,a=!0;break;case 88:s.isRGB=!0,s.isFourCC=!1,d=32,a=!0}if(a)break}default:return void q.c.Error(["Unsupported FourCC code:",(W=f,String.fromCharCode(255&W,W>>8&255,W>>16&255,W>>24&255))])}var W;const F=g._ExtractLongWordOrder(n[23]),O=g._ExtractLongWordOrder(n[24]),B=g._ExtractLongWordOrder(n[25]),u=g._ExtractLongWordOrder(n[26]);X&&(x=a._getRGBABufferInternalSizedFormat(s.textureType)),U=1,n[2]&p&&!1!==i&&(U=Math.max(1,n[7]));const K=M||0,D=a.getCaps();for(let q=K;q<G;q++){for(J=n[4],w=n[3],S=0;S<U;++S){if(-1===T||T===S){const t=-1===T?S:0;if(!s.isCompressed&&s.isFourCC){c.format=5,r=J*w*4;let s=null;if(a._badOS||a._badDesktopOS||!D.textureHalfFloat&&!D.textureFloat)128===d?(s=g._GetFloatAsUIntRGBAArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,t),y&&0==t&&y.push(g._GetFloatRGBAArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,t))):64===d&&(s=g._GetHalfFloatAsUIntRGBAArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,t),y&&0==t&&y.push(g._GetHalfFloatAsFloatRGBAArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,t))),c.type=0;else{const a=D.textureFloat&&(N&&D.textureFloatLinearFiltering||!N),q=D.textureHalfFloat&&(N&&D.textureHalfFloatLinearFiltering||!N),i=(128===d||64===d&&!q)&&a?1:(64===d||128===d&&!a)&&q?2:0;let p,G=null;if(128===d)switch(i){case 1:p=g._GetFloatRGBAArrayBuffer,G=null;break;case 2:p=g._GetFloatAsHalfFloatRGBAArrayBuffer,G=g._GetFloatRGBAArrayBuffer;break;case 0:p=g._GetFloatAsUIntRGBAArrayBuffer,G=g._GetFloatRGBAArrayBuffer}else switch(i){case 1:p=g._GetHalfFloatAsFloatRGBAArrayBuffer,G=null;break;case 2:p=g._GetHalfFloatRGBAArrayBuffer,G=g._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:p=g._GetHalfFloatAsUIntRGBAArrayBuffer,G=g._GetHalfFloatAsFloatRGBAArrayBuffer}c.type=i,s=p(J,w,o.byteOffset+Z,r,o.buffer,t),y&&0==t&&y.push(G?G(J,w,o.byteOffset+Z,r,o.buffer,t):s)}s&&a._uploadDataToTextureDirectly(c,s,q,t)}else if(s.isRGB)c.type=0,24===d?(c.format=4,r=J*w*3,h=g._GetRGBArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,F,O,B),a._uploadDataToTextureDirectly(c,h,q,t)):(c.format=5,r=J*w*4,h=g._GetRGBAArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer,F,O,B,u),a._uploadDataToTextureDirectly(c,h,q,t));else if(s.isLuminance){const s=a._getUnpackAlignement(),i=J;r=Math.floor((J+s-1)/s)*s*(w-1)+i,h=g._GetLuminanceArrayBuffer(J,w,o.byteOffset+Z,r,o.buffer),c.format=1,c.type=0,a._uploadDataToTextureDirectly(c,h,q,t)}else r=Math.max(4,J)/4*Math.max(4,w)/4*R,h=new Uint8Array(o.buffer,o.byteOffset+Z,r),c.type=0,a._uploadCompressedDataToTextureDirectly(c,x,J,w,h,q,t)}Z+=d?J*w*(d/8):r,J*=.5,w*=.5,J=Math.max(1,J),w=Math.max(1,w)}if(void 0!==M)break}y&&y.length>0?s.sphericalPolynomial=t.e.ConvertCubeMapToSphericalPolynomial({size:n[4],right:y[0],left:y[1],up:y[2],down:y[3],front:y[4],back:y[5],format:5,type:1,gammaSpace:!1}):s.sphericalPolynomial=void 0}}g.StoreLODInAlphaChannel=!1}}]);