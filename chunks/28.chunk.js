"use strict";(self.ozi0exxand9=self.ozi0exxand9||[]).push([[28,29],{13091:(f,v,Z)=>{var V=Z(11360),h=Z(11247),J=Z(11290),l=Z(11378),e=Z(11318),C=Z(11366);e.b.prototype._partialLoadFile=function(f,v,Z,V){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(f,(f=>{Z[v]=f,Z._internalCount++,6===Z._internalCount&&V(Z)}),void 0,void 0,!0,((f,v)=>{h&&f&&h(f.status+" "+f.statusText,v)}))},e.b.prototype._cascadeLoadFiles=function(f,v,Z){let V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const h=[];h._internalCount=0;for(let J=0;J<6;J++)this._partialLoadFile(Z[J],J,h,v,V)},e.b.prototype._cascadeLoadImgs=function(f,v,Z,V){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,J=arguments.length>5?arguments[5]:void 0;const l=[];l._internalCount=0;for(let e=0;e<6;e++)this._partialLoadImg(V[e],e,l,f,v,Z,h,J)},e.b.prototype._partialLoadImg=function(f,v,Z,V,h,e){let C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,H=arguments.length>7?arguments[7]:void 0;const O=(0,l.c)();(0,J.x)(f,(f=>{Z[v]=f,Z._internalCount++,V&&V.removePendingData(O),6===Z._internalCount&&e&&e(h,Z)}),((f,v)=>{V&&V.removePendingData(O),C&&C(f,v)}),V?V.offlineProvider:null,H),V&&V.addPendingData(O)},e.b.prototype.createCubeTextureBase=function(f,v,Z,J){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,e=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,H=arguments.length>6?arguments[6]:void 0,O=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],W=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,a=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,b=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,X=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,F=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,U=arguments.length>14&&void 0!==arguments[14]&&arguments[14],K=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const M=b||new V.c(this,7);M.isCube=!0,M.url=f,M.generateMipMaps=!J,M._lodGenerationScale=W,M._lodGenerationOffset=a,M._useSRGBBuffer=!!U&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!J),M!==b&&(M.label=f.substring(0,60)),this._doNotHandleContextLost||(M._extension=O,M._files=Z,M._buffer=K);const A=f;this._transformTextureUrl&&!b&&(f=this._transformTextureUrl(f));const s=O??function(f){const v=f.split("?")[0],Z=v.lastIndexOf(".");return Z>-1?v.substring(Z).toLowerCase():""}(f),z=(0,C.d)(s),Y=(f,v)=>{M.dispose(),e?e(f,v):f&&h.e.Warn(f)},y=(V,e)=>{f===A?V&&Y(V.status+" "+V.statusText,e):(h.e.Warn(`Failed to load ${f}, falling back to the ${A}`),this.createCubeTextureBase(A,v,Z,!!J,l,Y,H,O,u,W,a,M,X,F,U,K))};if(z)z.then((V=>{const h=f=>{X&&X(M,f),V.loadCubeData(f,M,u,l,((f,v)=>{Y(f,v)}))};K?h(K):Z&&6===Z.length?V.supportCascades?this._cascadeLoadFiles(v,(f=>h(f.map((f=>new Uint8Array(f))))),Z,Y):Y("Textures type does not support cascades."):this._loadFile(f,(f=>h(new Uint8Array(f))),void 0,void 0,!0,y)}));else{if(!Z||0===Z.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(v,M,((f,v)=>{F&&F(f,v)}),Z,Y)}return this._internalTexturesCache.push(M),M}},13816:(f,v,Z)=>{Z.r(v),Z.d(v,{_DDSTextureLoader:()=>J});var V=Z(11599),h=Z(13821);class J{constructor(){this.supportCascades=!0}loadCubeData(f,v,Z,J){const l=v.getEngine();let e,C=!1,H=1e3;if(Array.isArray(f))for(let V=0;V<f.length;V++){const Z=f[V];e=h.DDSTools.GetDDSInfo(Z),v.width=e.width,v.height=e.height,C=(e.isRGB||e.isLuminance||e.mipmapCount>1)&&v.generateMipMaps,l._unpackFlipY(e.isCompressed),h.DDSTools.UploadDDSLevels(l,v,Z,e,C,6,-1,V),e.isFourCC||1!==e.mipmapCount?H=e.mipmapCount-1:l.generateMipMapsForCubemap(v)}else{const J=f;e=h.DDSTools.GetDDSInfo(J),v.width=e.width,v.height=e.height,Z&&(e.sphericalPolynomial=new V.g),C=(e.isRGB||e.isLuminance||e.mipmapCount>1)&&v.generateMipMaps,l._unpackFlipY(e.isCompressed),h.DDSTools.UploadDDSLevels(l,v,J,e,C,6),e.isFourCC||1!==e.mipmapCount?H=e.mipmapCount-1:l.generateMipMapsForCubemap(v,!1)}l._setCubeMapTextureParams(v,C,H),v.isReady=!0,v.onLoadedObservable.notifyObservers(v),v.onLoadedObservable.clear(),J&&J({isDDS:!0,width:v.width,info:e,data:f,texture:v})}loadData(f,v,Z){const V=h.DDSTools.GetDDSInfo(f),J=(V.isRGB||V.isLuminance||V.mipmapCount>1)&&v.generateMipMaps&&Math.max(V.width,V.height)>>V.mipmapCount-1===1;Z(V.width,V.height,J,V.isFourCC,(()=>{h.DDSTools.UploadDDSLevels(v.getEngine(),v,f,V,J,1)}))}}},11916:(f,v,Z)=>{Z.d(v,{d:()=>H});var V=Z(11421),h=Z(11440),J=Z(11599),l=Z(11428),e=Z(11472);class C{constructor(f,v,Z,V){this.name=f,this.worldAxisForNormal=v,this.worldAxisForFileX=Z,this.worldAxisForFileY=V}}class H{static ConvertCubeMapTextureToSphericalPolynomial(f){var v;if(!f.isCube)return null;null===(v=f.Yf())||void 0===v||v.getEngine().flushFramebuffer();const Z=f.getSize().width,V=f.readPixels(0,void 0,void 0,!1),h=f.readPixels(1,void 0,void 0,!1);let J,l;f.isRenderTarget?(J=f.readPixels(3,void 0,void 0,!1),l=f.readPixels(2,void 0,void 0,!1)):(J=f.readPixels(2,void 0,void 0,!1),l=f.readPixels(3,void 0,void 0,!1));const e=f.readPixels(4,void 0,void 0,!1),C=f.readPixels(5,void 0,void 0,!1),H=f.gammaSpace;let O=0;return 1!=f.textureType&&2!=f.textureType||(O=1),new Promise((f=>{Promise.all([h,V,J,l,e,C]).then((v=>{let[V,h,J,l,e,C]=v;const u={size:Z,right:h,left:V,up:J,down:l,front:e,back:C,format:5,type:O,gammaSpace:H};f(this.ConvertCubeMapToSphericalPolynomial(u))}))}))}static _AreaElement(f,v){return Math.atan2(f*v,Math.sqrt(f*f+v*v+1))}static ConvertCubeMapToSphericalPolynomial(f){const v=new J.c;let Z=0;const V=2/f.size,C=V,H=.5*V,O=H-1;for(let J=0;J<6;J++){const u=this._FileFaces[J],W=f[u.name];let a=O;const b=5===f.format?4:3;for(let J=0;J<f.size;J++){let X=O;for(let C=0;C<f.size;C++){const O=u.worldAxisForFileX.scale(X).add(u.worldAxisForFileY.scale(a)).add(u.worldAxisForNormal);O.normalize();const F=this._AreaElement(X-H,a-H)-this._AreaElement(X-H,a+H)-this._AreaElement(X+H,a-H)+this._AreaElement(X+H,a+H);let U=W[J*f.size*b+C*b+0],K=W[J*f.size*b+C*b+1],M=W[J*f.size*b+C*b+2];isNaN(U)&&(U=0),isNaN(K)&&(K=0),isNaN(M)&&(M=0),0===f.type&&(U/=255,K/=255,M/=255),f.gammaSpace&&(U=Math.pow((0,h.Clamp)(U),l.h),K=Math.pow((0,h.Clamp)(K),l.h),M=Math.pow((0,h.Clamp)(M),l.h));const A=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const f=Math.max(U,K,M);if(f>A){const v=A/f;U*=v,K*=v,M*=v}}else U=(0,h.Clamp)(U,0,A),K=(0,h.Clamp)(K,0,A),M=(0,h.Clamp)(M,0,A);const s=new e.Mv(U,K,M);v.addLight(O,s,F),Z+=F,X+=V}a+=C}}const u=6*(4*Math.PI)/6/Z;return v.scaleInPlace(u),v.convertIncidentRadianceToIrradiance(),v.convertIrradianceToLambertianRadiance(),J.g.FromHarmonics(v)}}H._FileFaces=[new C("right",new V.Xv(1,0,0),new V.Xv(0,0,-1),new V.Xv(0,-1,0)),new C("left",new V.Xv(-1,0,0),new V.Xv(0,0,1),new V.Xv(0,-1,0)),new C("up",new V.Xv(0,1,0),new V.Xv(1,0,0),new V.Xv(0,0,1)),new C("down",new V.Xv(0,-1,0),new V.Xv(1,0,0),new V.Xv(0,0,-1)),new C("front",new V.Xv(0,0,1),new V.Xv(1,0,0),new V.Xv(0,-1,0)),new C("back",new V.Xv(0,0,-1),new V.Xv(-1,0,0),new V.Xv(0,-1,0))],H.MAX_HDRI_VALUE=4096,H.PRESERVE_CLAMPED_COLORS=!1},13821:(f,v,Z)=>{Z.d(v,{DDSTools:()=>b});var V=Z(11440),h=Z(11247),J=Z(11916),l=Z(11628);Z(13091);const e=131072,C=131072;function H(f){return f.charCodeAt(0)+(f.charCodeAt(1)<<8)+(f.charCodeAt(2)<<16)+(f.charCodeAt(3)<<24)}const O=H("DXT1"),u=H("DXT3"),W=H("DXT5"),a=H("DX10");class b{static GetDDSInfo(f){const v=new Int32Array(f.buffer,f.byteOffset,31),Z=new Int32Array(f.buffer,f.byteOffset,35);let V=1;v[2]&e&&(V=Math.max(1,v[7]));const h=v[21],J=h===a?Z[32]:0;let l=0;switch(h){case 113:l=2;break;case 116:l=1;break;case a:if(10===J){l=2;break}if(2===J){l=1;break}}return{width:v[4],height:v[3],mipmapCount:V,isFourCC:4===(4&v[20]),isRGB:64===(64&v[20]),isLuminance:(v[20]&C)===C,isCube:512===(512&v[28]),isCompressed:h===O||h===u||h===W,dxgiFormat:J,textureType:l}}static _GetHalfFloatAsFloatRGBAArrayBuffer(f,v,Z,V,h,J){const e=new Float32Array(V),C=new Uint16Array(h,Z);let H=0;for(let O=0;O<v;O++)for(let v=0;v<f;v++){const Z=4*(v+O*f);e[H]=(0,l.h)(C[Z]),e[H+1]=(0,l.h)(C[Z+1]),e[H+2]=(0,l.h)(C[Z+2]),b.StoreLODInAlphaChannel?e[H+3]=J:e[H+3]=(0,l.h)(C[Z+3]),H+=4}return e}static _GetHalfFloatRGBAArrayBuffer(f,v,Z,V,h,J){if(b.StoreLODInAlphaChannel){const e=new Uint16Array(V),C=new Uint16Array(h,Z);let H=0;for(let Z=0;Z<v;Z++)for(let v=0;v<f;v++){const V=4*(v+Z*f);e[H]=C[V],e[H+1]=C[V+1],e[H+2]=C[V+2],e[H+3]=(0,l.r)(J),H+=4}return e}return new Uint16Array(h,Z,V)}static _GetFloatRGBAArrayBuffer(f,v,Z,V,h,J){if(b.StoreLODInAlphaChannel){const l=new Float32Array(V),e=new Float32Array(h,Z);let C=0;for(let Z=0;Z<v;Z++)for(let v=0;v<f;v++){const V=4*(v+Z*f);l[C]=e[V],l[C+1]=e[V+1],l[C+2]=e[V+2],l[C+3]=J,C+=4}return l}return new Float32Array(h,Z,V)}static _GetFloatAsHalfFloatRGBAArrayBuffer(f,v,Z,V,h,J){const e=new Uint16Array(V),C=new Float32Array(h,Z);let H=0;for(let O=0;O<v;O++)for(let v=0;v<f;v++)e[H]=(0,l.r)(C[H]),e[H+1]=(0,l.r)(C[H+1]),e[H+2]=(0,l.r)(C[H+2]),b.StoreLODInAlphaChannel?e[H+3]=(0,l.r)(J):e[H+3]=(0,l.r)(C[H+3]),H+=4;return e}static _GetFloatAsUIntRGBAArrayBuffer(f,v,Z,h,J,l){const e=new Uint8Array(h),C=new Float32Array(J,Z);let H=0;for(let O=0;O<v;O++)for(let v=0;v<f;v++){const Z=4*(v+O*f);e[H]=255*(0,V.Clamp)(C[Z]),e[H+1]=255*(0,V.Clamp)(C[Z+1]),e[H+2]=255*(0,V.Clamp)(C[Z+2]),b.StoreLODInAlphaChannel?e[H+3]=l:e[H+3]=255*(0,V.Clamp)(C[Z+3]),H+=4}return e}static _GetHalfFloatAsUIntRGBAArrayBuffer(f,v,Z,h,J,e){const C=new Uint8Array(h),H=new Uint16Array(J,Z);let O=0;for(let u=0;u<v;u++)for(let v=0;v<f;v++){const Z=4*(v+u*f);C[O]=255*(0,V.Clamp)((0,l.h)(H[Z])),C[O+1]=255*(0,V.Clamp)((0,l.h)(H[Z+1])),C[O+2]=255*(0,V.Clamp)((0,l.h)(H[Z+2])),b.StoreLODInAlphaChannel?C[O+3]=e:C[O+3]=255*(0,V.Clamp)((0,l.h)(H[Z+3])),O+=4}return C}static _GetRGBAArrayBuffer(f,v,Z,V,h,J,l,e,C){const H=new Uint8Array(V),O=new Uint8Array(h,Z);let u=0;for(let W=0;W<v;W++)for(let v=0;v<f;v++){const Z=4*(v+W*f);H[u]=O[Z+J],H[u+1]=O[Z+l],H[u+2]=O[Z+e],H[u+3]=O[Z+C],u+=4}return H}static _ExtractLongWordOrder(f){return 0===f||255===f||-16777216===f?0:1+b._ExtractLongWordOrder(f>>8)}static _GetRGBArrayBuffer(f,v,Z,V,h,J,l,e){const C=new Uint8Array(V),H=new Uint8Array(h,Z);let O=0;for(let u=0;u<v;u++)for(let v=0;v<f;v++){const Z=3*(v+u*f);C[O]=H[Z+J],C[O+1]=H[Z+l],C[O+2]=H[Z+e],O+=3}return C}static _GetLuminanceArrayBuffer(f,v,Z,V,h){const J=new Uint8Array(V),l=new Uint8Array(h,Z);let e=0;for(let C=0;C<v;C++)for(let v=0;v<f;v++){const Z=v+C*f;J[e]=l[Z],e++}return J}static UploadDDSLevels(f,v,Z,V,l,C){let H=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,X=arguments.length>7?arguments[7]:void 0,F=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],U=null;V.sphericalPolynomial&&(U=[]);const K=!!f.getCaps().s3tc;v.generateMipMaps=l;const M=new Int32Array(Z.buffer,Z.byteOffset,31);let A,s,z,Y,y,N,i,I=0,T=0,B=1;if(542327876!==M[0])return void h.e.Error("Invalid magic number in DDS header");if(!V.isFourCC&&!V.isRGB&&!V.isLuminance)return void h.e.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(V.isCompressed&&!K)return void h.e.Error("Compressed textures are not supported on this platform.");let P=M[22];Y=M[1]+4;let g=!1;if(V.isFourCC)switch(A=M[21],A){case O:B=8,T=33777;break;case u:B=16,T=33778;break;case W:B=16,T=33779;break;case 113:g=!0,P=64;break;case 116:g=!0,P=128;break;case a:{Y+=20;let f=!1;switch(V.dxgiFormat){case 10:g=!0,P=64,f=!0;break;case 2:g=!0,P=128,f=!0;break;case 88:V.isRGB=!0,V.isFourCC=!1,P=32,f=!0}if(f)break}default:return void h.e.Error(["Unsupported FourCC code:",(w=A,String.fromCharCode(255&w,w>>8&255,w>>16&255,w>>24&255))])}var w;const t=b._ExtractLongWordOrder(M[23]),L=b._ExtractLongWordOrder(M[24]),E=b._ExtractLongWordOrder(M[25]),j=b._ExtractLongWordOrder(M[26]);g&&(T=f._getRGBABufferInternalSizedFormat(V.textureType)),N=1,M[2]&e&&!1!==l&&(N=Math.max(1,M[7]));const q=X||0,c=f.getCaps();for(let h=q;h<C;h++){for(s=M[4],z=M[3],i=0;i<N;++i){if(-1===H||H===i){const J=-1===H?i:0;if(!V.isCompressed&&V.isFourCC){v.format=5,I=s*z*4;let V=null;if(f._badOS||f._badDesktopOS||!c.textureHalfFloat&&!c.textureFloat)128===P?(V=b._GetFloatAsUIntRGBAArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,J),U&&0==J&&U.push(b._GetFloatRGBAArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,J))):64===P&&(V=b._GetHalfFloatAsUIntRGBAArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,J),U&&0==J&&U.push(b._GetHalfFloatAsFloatRGBAArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,J))),v.type=0;else{const f=c.textureFloat&&(F&&c.textureFloatLinearFiltering||!F),h=c.textureHalfFloat&&(F&&c.textureHalfFloatLinearFiltering||!F),l=(128===P||64===P&&!h)&&f?1:(64===P||128===P&&!f)&&h?2:0;let e,C=null;if(128===P)switch(l){case 1:e=b._GetFloatRGBAArrayBuffer,C=null;break;case 2:e=b._GetFloatAsHalfFloatRGBAArrayBuffer,C=b._GetFloatRGBAArrayBuffer;break;case 0:e=b._GetFloatAsUIntRGBAArrayBuffer,C=b._GetFloatRGBAArrayBuffer}else switch(l){case 1:e=b._GetHalfFloatAsFloatRGBAArrayBuffer,C=null;break;case 2:e=b._GetHalfFloatRGBAArrayBuffer,C=b._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:e=b._GetHalfFloatAsUIntRGBAArrayBuffer,C=b._GetHalfFloatAsFloatRGBAArrayBuffer}v.type=l,V=e(s,z,Z.byteOffset+Y,I,Z.buffer,J),U&&0==J&&U.push(C?C(s,z,Z.byteOffset+Y,I,Z.buffer,J):V)}V&&f._uploadDataToTextureDirectly(v,V,h,J)}else if(V.isRGB)v.type=0,24===P?(v.format=4,I=s*z*3,y=b._GetRGBArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,t,L,E),f._uploadDataToTextureDirectly(v,y,h,J)):(v.format=5,I=s*z*4,y=b._GetRGBAArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer,t,L,E,j),f._uploadDataToTextureDirectly(v,y,h,J));else if(V.isLuminance){const V=f._getUnpackAlignement(),l=s;I=Math.floor((s+V-1)/V)*V*(z-1)+l,y=b._GetLuminanceArrayBuffer(s,z,Z.byteOffset+Y,I,Z.buffer),v.format=1,v.type=0,f._uploadDataToTextureDirectly(v,y,h,J)}else I=Math.max(4,s)/4*Math.max(4,z)/4*B,y=new Uint8Array(Z.buffer,Z.byteOffset+Y,I),v.type=0,f._uploadCompressedDataToTextureDirectly(v,T,s,z,y,h,J)}Y+=P?s*z*(P/8):I,s*=.5,z*=.5,s=Math.max(1,s),z=Math.max(1,z)}if(void 0!==X)break}U&&U.length>0?V.sphericalPolynomial=J.d.ConvertCubeMapToSphericalPolynomial({size:M[4],right:U[0],left:U[1],up:U[2],down:U[3],front:U[4],back:U[5],format:5,type:1,gammaSpace:!1}):V.sphericalPolynomial=void 0}}b.StoreLODInAlphaChannel=!1}}]);