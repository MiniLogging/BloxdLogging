"use strict";(self.vb3rpbgyozo=self.vb3rpbgyozo||[]).push([[28,29],{14412:(q,I,l)=>{var w=l(12687),t=l(12591),O=l(12615),c=l(12718),a=l(12656),F=l(12700);a.d.prototype._partialLoadFile=function(q,I,l,w){let t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(q,(q=>{l[I]=q,l._internalCount++,6===l._internalCount&&w(l)}),void 0,void 0,!0,((q,I)=>{t&&q&&t(q.status+" "+q.statusText,I)}))},a.d.prototype._cascadeLoadFiles=function(q,I,l){let w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const t=[];t._internalCount=0;for(let O=0;O<6;O++)this._partialLoadFile(l[O],O,t,I,w)},a.d.prototype._cascadeLoadImgs=function(q,I,l,w){let t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,O=arguments.length>5?arguments[5]:void 0;const c=[];c._internalCount=0;for(let a=0;a<6;a++)this._partialLoadImg(w[a],a,c,q,I,l,t,O)},a.d.prototype._partialLoadImg=function(q,I,l,w,t,a){let F=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7?arguments[7]:void 0;const Z=(0,c.d)();(0,O.r)(q,(q=>{l[I]=q,l._internalCount++,w&&w.removePendingData(Z),6===l._internalCount&&a&&a(t,l)}),((q,I)=>{w&&w.removePendingData(Z),F&&F(q,I)}),w?w.offlineProvider:null,s),w&&w.addPendingData(Z)},a.d.prototype.createCubeTextureBase=function(q,I,l,O){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6?arguments[6]:void 0,Z=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,r=arguments.length>8&&void 0!==arguments[8]&&arguments[8],x=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,o=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,T=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,V=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,U=arguments.length>14&&void 0!==arguments[14]&&arguments[14],B=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const v=d||new w.b(this,7);v.isCube=!0,v.url=q,v.generateMipMaps=!O,v._lodGenerationScale=x,v._lodGenerationOffset=o,v._useSRGBBuffer=!!U&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!O),v!==d&&(v.label=q.substring(0,60)),this._doNotHandleContextLost||(v._extension=Z,v._files=l,v._buffer=B);const k=q;this._transformTextureUrl&&!d&&(q=this._transformTextureUrl(q));const C=Z??function(q){const I=q.split("?")[0],l=I.lastIndexOf(".");return l>-1?I.substring(l).toLowerCase():""}(q),R=(0,F.b)(C),W=(q,I)=>{v.dispose(),a?a(q,I):q&&t.b.Warn(q)},e=(w,a)=>{q===k?w&&W(w.status+" "+w.statusText,a):(t.b.Warn(`Failed to load ${q}, falling back to the ${k}`),this.createCubeTextureBase(k,I,l,!!O,c,W,s,Z,r,x,o,v,T,V,U,B))};if(R)R.then((w=>{const t=q=>{T&&T(v,q),w.loadCubeData(q,v,r,c,((q,I)=>{W(q,I)}))};B?t(B):l&&6===l.length?w.supportCascades?this._cascadeLoadFiles(I,(q=>t(q.map((q=>new Uint8Array(q))))),l,W):W("Textures type does not support cascades."):this._loadFile(q,(q=>t(new Uint8Array(q))),void 0,void 0,!0,e)}));else{if(!l||0===l.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(I,v,((q,I)=>{V&&V(q,I)}),l,W)}return this._internalTexturesCache.push(v),v}},15186:(q,I,l)=>{l.r(I),l.d(I,{_DDSTextureLoader:()=>O});var w=l(12939),t=l(15190);class O{constructor(){this.supportCascades=!0}loadCubeData(q,I,l,O){const c=I.getEngine();let a,F=!1,s=1e3;if(Array.isArray(q))for(let w=0;w<q.length;w++){const l=q[w];a=t.DDSTools.GetDDSInfo(l),I.width=a.width,I.height=a.height,F=(a.isRGB||a.isLuminance||a.mipmapCount>1)&&I.generateMipMaps,c._unpackFlipY(a.isCompressed),t.DDSTools.UploadDDSLevels(c,I,l,a,F,6,-1,w),a.isFourCC||1!==a.mipmapCount?s=a.mipmapCount-1:c.generateMipMapsForCubemap(I)}else{const O=q;a=t.DDSTools.GetDDSInfo(O),I.width=a.width,I.height=a.height,l&&(a.sphericalPolynomial=new w.e),F=(a.isRGB||a.isLuminance||a.mipmapCount>1)&&I.generateMipMaps,c._unpackFlipY(a.isCompressed),t.DDSTools.UploadDDSLevels(c,I,O,a,F,6),a.isFourCC||1!==a.mipmapCount?s=a.mipmapCount-1:c.generateMipMapsForCubemap(I,!1)}c._setCubeMapTextureParams(I,F,s),I.isReady=!0,I.onLoadedObservable.notifyObservers(I),I.onLoadedObservable.clear(),O&&O({isDDS:!0,width:I.width,info:a,data:q,texture:I})}loadData(q,I,l){const w=t.DDSTools.GetDDSInfo(q),O=(w.isRGB||w.isLuminance||w.mipmapCount>1)&&I.generateMipMaps&&Math.max(w.width,w.height)>>w.mipmapCount-1===1;l(w.width,w.height,O,w.isFourCC,(()=>{t.DDSTools.UploadDDSLevels(I.getEngine(),I,q,w,O,1)}))}}},13245:(q,I,l)=>{l.d(I,{b:()=>s});var w=l(12747),t=l(12761),O=l(12939),c=l(12752),a=l(12789);class F{constructor(q,I,l,w){this.name=q,this.worldAxisForNormal=I,this.worldAxisForFileX=l,this.worldAxisForFileY=w}}class s{static ConvertCubeMapTextureToSphericalPolynomial(q){var I;if(!q.isCube)return null;null===(I=q.Wq())||void 0===I||I.getEngine().flushFramebuffer();const l=q.getSize().width,w=q.readPixels(0,void 0,void 0,!1),t=q.readPixels(1,void 0,void 0,!1);let O,c;q.isRenderTarget?(O=q.readPixels(3,void 0,void 0,!1),c=q.readPixels(2,void 0,void 0,!1)):(O=q.readPixels(2,void 0,void 0,!1),c=q.readPixels(3,void 0,void 0,!1));const a=q.readPixels(4,void 0,void 0,!1),F=q.readPixels(5,void 0,void 0,!1),s=q.gammaSpace;let Z=0;return 1!=q.textureType&&2!=q.textureType||(Z=1),new Promise((q=>{Promise.all([t,w,O,c,a,F]).then((I=>{let[w,t,O,c,a,F]=I;const r={size:l,right:t,left:w,up:O,down:c,front:a,back:F,format:5,type:Z,gammaSpace:s};q(this.ConvertCubeMapToSphericalPolynomial(r))}))}))}static _AreaElement(q,I){return Math.atan2(q*I,Math.sqrt(q*q+I*I+1))}static ConvertCubeMapToSphericalPolynomial(q){const I=new O.d;let l=0;const w=2/q.size,F=w,s=.5*w,Z=s-1;for(let O=0;O<6;O++){const r=this._FileFaces[O],x=q[r.name];let o=Z;const d=5===q.format?4:3;for(let O=0;O<q.size;O++){let T=Z;for(let F=0;F<q.size;F++){const Z=r.worldAxisForFileX.scale(T).add(r.worldAxisForFileY.scale(o)).add(r.worldAxisForNormal);Z.normalize();const V=this._AreaElement(T-s,o-s)-this._AreaElement(T-s,o+s)-this._AreaElement(T+s,o-s)+this._AreaElement(T+s,o+s);let U=x[O*q.size*d+F*d+0],B=x[O*q.size*d+F*d+1],v=x[O*q.size*d+F*d+2];isNaN(U)&&(U=0),isNaN(B)&&(B=0),isNaN(v)&&(v=0),0===q.type&&(U/=255,B/=255,v/=255),q.gammaSpace&&(U=Math.pow((0,t.Clamp)(U),c.m),B=Math.pow((0,t.Clamp)(B),c.m),v=Math.pow((0,t.Clamp)(v),c.m));const k=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const q=Math.max(U,B,v);if(q>k){const I=k/q;U*=I,B*=I,v*=I}}else U=(0,t.Clamp)(U,0,k),B=(0,t.Clamp)(B,0,k),v=(0,t.Clamp)(v,0,k);const C=new a.BI(U,B,v);I.addLight(Z,C,V),l+=V,T+=w}o+=F}}const r=6*(4*Math.PI)/6/l;return I.scaleInPlace(r),I.convertIncidentRadianceToIrradiance(),I.convertIrradianceToLambertianRadiance(),O.e.FromHarmonics(I)}}s._FileFaces=[new F("right",new w.dI(1,0,0),new w.dI(0,0,-1),new w.dI(0,-1,0)),new F("left",new w.dI(-1,0,0),new w.dI(0,0,1),new w.dI(0,-1,0)),new F("up",new w.dI(0,1,0),new w.dI(1,0,0),new w.dI(0,0,1)),new F("down",new w.dI(0,-1,0),new w.dI(1,0,0),new w.dI(0,0,-1)),new F("front",new w.dI(0,0,1),new w.dI(1,0,0),new w.dI(0,-1,0)),new F("back",new w.dI(0,0,-1),new w.dI(-1,0,0),new w.dI(0,-1,0))],s.MAX_HDRI_VALUE=4096,s.PRESERVE_CLAMPED_COLORS=!1},15190:(q,I,l)=>{l.d(I,{DDSTools:()=>d});var w=l(12761),t=l(12591),O=l(13245),c=l(12975);l(14412);const a=131072,F=131072;function s(q){return q.charCodeAt(0)+(q.charCodeAt(1)<<8)+(q.charCodeAt(2)<<16)+(q.charCodeAt(3)<<24)}const Z=s("DXT1"),r=s("DXT3"),x=s("DXT5"),o=s("DX10");class d{static GetDDSInfo(q){const I=new Int32Array(q.buffer,q.byteOffset,31),l=new Int32Array(q.buffer,q.byteOffset,35);let w=1;I[2]&a&&(w=Math.max(1,I[7]));const t=I[21],O=t===o?l[32]:0;let c=0;switch(t){case 113:c=2;break;case 116:c=1;break;case o:if(10===O){c=2;break}if(2===O){c=1;break}}return{width:I[4],height:I[3],mipmapCount:w,isFourCC:4===(4&I[20]),isRGB:64===(64&I[20]),isLuminance:(I[20]&F)===F,isCube:512===(512&I[28]),isCompressed:t===Z||t===r||t===x,dxgiFormat:O,textureType:c}}static _GetHalfFloatAsFloatRGBAArrayBuffer(q,I,l,w,t,O){const a=new Float32Array(w),F=new Uint16Array(t,l);let s=0;for(let Z=0;Z<I;Z++)for(let I=0;I<q;I++){const l=4*(I+Z*q);a[s]=(0,c.d)(F[l]),a[s+1]=(0,c.d)(F[l+1]),a[s+2]=(0,c.d)(F[l+2]),d.StoreLODInAlphaChannel?a[s+3]=O:a[s+3]=(0,c.d)(F[l+3]),s+=4}return a}static _GetHalfFloatRGBAArrayBuffer(q,I,l,w,t,O){if(d.StoreLODInAlphaChannel){const a=new Uint16Array(w),F=new Uint16Array(t,l);let s=0;for(let l=0;l<I;l++)for(let I=0;I<q;I++){const w=4*(I+l*q);a[s]=F[w],a[s+1]=F[w+1],a[s+2]=F[w+2],a[s+3]=(0,c.l)(O),s+=4}return a}return new Uint16Array(t,l,w)}static _GetFloatRGBAArrayBuffer(q,I,l,w,t,O){if(d.StoreLODInAlphaChannel){const c=new Float32Array(w),a=new Float32Array(t,l);let F=0;for(let l=0;l<I;l++)for(let I=0;I<q;I++){const w=4*(I+l*q);c[F]=a[w],c[F+1]=a[w+1],c[F+2]=a[w+2],c[F+3]=O,F+=4}return c}return new Float32Array(t,l,w)}static _GetFloatAsHalfFloatRGBAArrayBuffer(q,I,l,w,t,O){const a=new Uint16Array(w),F=new Float32Array(t,l);let s=0;for(let Z=0;Z<I;Z++)for(let I=0;I<q;I++)a[s]=(0,c.l)(F[s]),a[s+1]=(0,c.l)(F[s+1]),a[s+2]=(0,c.l)(F[s+2]),d.StoreLODInAlphaChannel?a[s+3]=(0,c.l)(O):a[s+3]=(0,c.l)(F[s+3]),s+=4;return a}static _GetFloatAsUIntRGBAArrayBuffer(q,I,l,t,O,c){const a=new Uint8Array(t),F=new Float32Array(O,l);let s=0;for(let Z=0;Z<I;Z++)for(let I=0;I<q;I++){const l=4*(I+Z*q);a[s]=255*(0,w.Clamp)(F[l]),a[s+1]=255*(0,w.Clamp)(F[l+1]),a[s+2]=255*(0,w.Clamp)(F[l+2]),d.StoreLODInAlphaChannel?a[s+3]=c:a[s+3]=255*(0,w.Clamp)(F[l+3]),s+=4}return a}static _GetHalfFloatAsUIntRGBAArrayBuffer(q,I,l,t,O,a){const F=new Uint8Array(t),s=new Uint16Array(O,l);let Z=0;for(let r=0;r<I;r++)for(let I=0;I<q;I++){const l=4*(I+r*q);F[Z]=255*(0,w.Clamp)((0,c.d)(s[l])),F[Z+1]=255*(0,w.Clamp)((0,c.d)(s[l+1])),F[Z+2]=255*(0,w.Clamp)((0,c.d)(s[l+2])),d.StoreLODInAlphaChannel?F[Z+3]=a:F[Z+3]=255*(0,w.Clamp)((0,c.d)(s[l+3])),Z+=4}return F}static _GetRGBAArrayBuffer(q,I,l,w,t,O,c,a,F){const s=new Uint8Array(w),Z=new Uint8Array(t,l);let r=0;for(let x=0;x<I;x++)for(let I=0;I<q;I++){const l=4*(I+x*q);s[r]=Z[l+O],s[r+1]=Z[l+c],s[r+2]=Z[l+a],s[r+3]=Z[l+F],r+=4}return s}static _ExtractLongWordOrder(q){return 0===q||255===q||-16777216===q?0:1+d._ExtractLongWordOrder(q>>8)}static _GetRGBArrayBuffer(q,I,l,w,t,O,c,a){const F=new Uint8Array(w),s=new Uint8Array(t,l);let Z=0;for(let r=0;r<I;r++)for(let I=0;I<q;I++){const l=3*(I+r*q);F[Z]=s[l+O],F[Z+1]=s[l+c],F[Z+2]=s[l+a],Z+=3}return F}static _GetLuminanceArrayBuffer(q,I,l,w,t){const O=new Uint8Array(w),c=new Uint8Array(t,l);let a=0;for(let F=0;F<I;F++)for(let I=0;I<q;I++){const l=I+F*q;O[a]=c[l],a++}return O}static UploadDDSLevels(q,I,l,w,c,F){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,T=arguments.length>7?arguments[7]:void 0,V=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],U=null;w.sphericalPolynomial&&(U=[]);const B=!!q.getCaps().s3tc;I.generateMipMaps=c;const v=new Int32Array(l.buffer,l.byteOffset,31);let k,C,R,W,e,i,S,g=0,p=0,X=1;if(542327876!==v[0])return void t.b.Error("Invalid magic number in DDS header");if(!w.isFourCC&&!w.isRGB&&!w.isLuminance)return void t.b.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(w.isCompressed&&!B)return void t.b.Error("Compressed textures are not supported on this platform.");let K=v[22];W=v[1]+4;let D=!1;if(w.isFourCC)switch(k=v[21],k){case Z:X=8,p=33777;break;case r:X=16,p=33778;break;case x:X=16,p=33779;break;case 113:D=!0,K=64;break;case 116:D=!0,K=128;break;case o:{W+=20;let q=!1;switch(w.dxgiFormat){case 10:D=!0,K=64,q=!0;break;case 2:D=!0,K=128,q=!0;break;case 88:w.isRGB=!0,w.isFourCC=!1,K=32,q=!0}if(q)break}default:return void t.b.Error(["Unsupported FourCC code:",(M=k,String.fromCharCode(255&M,M>>8&255,M>>16&255,M>>24&255))])}var M;const n=d._ExtractLongWordOrder(v[23]),f=d._ExtractLongWordOrder(v[24]),L=d._ExtractLongWordOrder(v[25]),E=d._ExtractLongWordOrder(v[26]);D&&(p=q._getRGBABufferInternalSizedFormat(w.textureType)),i=1,v[2]&a&&!1!==c&&(i=Math.max(1,v[7]));const j=T||0,h=q.getCaps();for(let t=j;t<F;t++){for(C=v[4],R=v[3],S=0;S<i;++S){if(-1===s||s===S){const O=-1===s?S:0;if(!w.isCompressed&&w.isFourCC){I.format=5,g=C*R*4;let w=null;if(q._badOS||q._badDesktopOS||!h.textureHalfFloat&&!h.textureFloat)128===K?(w=d._GetFloatAsUIntRGBAArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,O),U&&0==O&&U.push(d._GetFloatRGBAArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,O))):64===K&&(w=d._GetHalfFloatAsUIntRGBAArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,O),U&&0==O&&U.push(d._GetHalfFloatAsFloatRGBAArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,O))),I.type=0;else{const q=h.textureFloat&&(V&&h.textureFloatLinearFiltering||!V),t=h.textureHalfFloat&&(V&&h.textureHalfFloatLinearFiltering||!V),c=(128===K||64===K&&!t)&&q?1:(64===K||128===K&&!q)&&t?2:0;let a,F=null;if(128===K)switch(c){case 1:a=d._GetFloatRGBAArrayBuffer,F=null;break;case 2:a=d._GetFloatAsHalfFloatRGBAArrayBuffer,F=d._GetFloatRGBAArrayBuffer;break;case 0:a=d._GetFloatAsUIntRGBAArrayBuffer,F=d._GetFloatRGBAArrayBuffer}else switch(c){case 1:a=d._GetHalfFloatAsFloatRGBAArrayBuffer,F=null;break;case 2:a=d._GetHalfFloatRGBAArrayBuffer,F=d._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:a=d._GetHalfFloatAsUIntRGBAArrayBuffer,F=d._GetHalfFloatAsFloatRGBAArrayBuffer}I.type=c,w=a(C,R,l.byteOffset+W,g,l.buffer,O),U&&0==O&&U.push(F?F(C,R,l.byteOffset+W,g,l.buffer,O):w)}w&&q._uploadDataToTextureDirectly(I,w,t,O)}else if(w.isRGB)I.type=0,24===K?(I.format=4,g=C*R*3,e=d._GetRGBArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,n,f,L),q._uploadDataToTextureDirectly(I,e,t,O)):(I.format=5,g=C*R*4,e=d._GetRGBAArrayBuffer(C,R,l.byteOffset+W,g,l.buffer,n,f,L,E),q._uploadDataToTextureDirectly(I,e,t,O));else if(w.isLuminance){const w=q._getUnpackAlignement(),c=C;g=Math.floor((C+w-1)/w)*w*(R-1)+c,e=d._GetLuminanceArrayBuffer(C,R,l.byteOffset+W,g,l.buffer),I.format=1,I.type=0,q._uploadDataToTextureDirectly(I,e,t,O)}else g=Math.max(4,C)/4*Math.max(4,R)/4*X,e=new Uint8Array(l.buffer,l.byteOffset+W,g),I.type=0,q._uploadCompressedDataToTextureDirectly(I,p,C,R,e,t,O)}W+=K?C*R*(K/8):g,C*=.5,R*=.5,C=Math.max(1,C),R=Math.max(1,R)}if(void 0!==T)break}U&&U.length>0?w.sphericalPolynomial=O.b.ConvertCubeMapToSphericalPolynomial({size:v[4],right:U[0],left:U[1],up:U[2],down:U[3],front:U[4],back:U[5],format:5,type:1,gammaSpace:!1}):w.sphericalPolynomial=void 0}}d.StoreLODInAlphaChannel=!1}}]);