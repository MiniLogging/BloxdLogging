"use strict";(self.zjjkhojdx1=self.zjjkhojdx1||[]).push([[28,29],{12907:(k,h,o)=>{var x=o(11180),I=o(11098),q=o(11127),Y=o(11208),J=o(11151),G=o(11191);J.e.prototype._partialLoadFile=function(k,h,o,x){let I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(k,(k=>{o[h]=k,o._internalCount++,6===o._internalCount&&x(o)}),void 0,void 0,!0,((k,h)=>{I&&k&&I(k.status+" "+k.statusText,h)}))},J.e.prototype._cascadeLoadFiles=function(k,h,o){let x=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const I=[];I._internalCount=0;for(let q=0;q<6;q++)this._partialLoadFile(o[q],q,I,h,x)},J.e.prototype._cascadeLoadImgs=function(k,h,o,x){let I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,q=arguments.length>5?arguments[5]:void 0;const Y=[];Y._internalCount=0;for(let J=0;J<6;J++)this._partialLoadImg(x[J],J,Y,k,h,o,I,q)},J.e.prototype._partialLoadImg=function(k,h,o,x,I,J){let G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7?arguments[7]:void 0;const A=(0,Y.b)();(0,q.s)(k,(k=>{o[h]=k,o._internalCount++,x&&x.removePendingData(A),6===o._internalCount&&J&&J(I,o)}),((k,h)=>{x&&x.removePendingData(A),G&&G(k,h)}),x?x.offlineProvider:null,l),x&&x.addPendingData(A)},J.e.prototype.createCubeTextureBase=function(k,h,o,q){let Y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6?arguments[6]:void 0,A=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,K=arguments.length>8&&void 0!==arguments[8]&&arguments[8],a=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,N=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,X=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,c=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,W=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,f=arguments.length>14&&void 0!==arguments[14]&&arguments[14],M=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const T=X||new x.c(this,7);T.isCube=!0,T.url=k,T.generateMipMaps=!q,T._lodGenerationScale=a,T._lodGenerationOffset=N,T._useSRGBBuffer=!!f&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!q),T!==X&&(T.label=k.substring(0,60)),this._doNotHandleContextLost||(T._extension=A,T._files=o,T._buffer=M);const j=k;this._transformTextureUrl&&!X&&(k=this._transformTextureUrl(k));const d=A??function(k){const h=k.split("?")[0],o=h.lastIndexOf(".");return o>-1?h.substring(o).toLowerCase():""}(k),b=(0,G.d)(d),V=(k,h)=>{T.dispose(),J?J(k,h):k&&I.c.Warn(k)},i=(x,J)=>{k===j?x&&V(x.status+" "+x.statusText,J):(I.c.Warn(`Failed to load ${k}, falling back to the ${j}`),this.createCubeTextureBase(j,h,o,!!q,Y,V,l,A,K,a,N,T,c,W,f,M))};if(b)b.then((x=>{const I=k=>{c&&c(T,k),x.loadCubeData(k,T,K,Y,((k,h)=>{V(k,h)}))};M?I(M):o&&6===o.length?x.supportCascades?this._cascadeLoadFiles(h,(k=>I(k.map((k=>new Uint8Array(k))))),o,V):V("Textures type does not support cascades."):this._loadFile(k,(k=>I(new Uint8Array(k))),void 0,void 0,!0,i)}));else{if(!o||0===o.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(h,T,((k,h)=>{W&&W(k,h)}),o,V)}return this._internalTexturesCache.push(T),T}},13651:(k,h,o)=>{o.r(h),o.d(h,{_DDSTextureLoader:()=>q});var x=o(11428),I=o(13654);class q{constructor(){this.supportCascades=!0}loadCubeData(k,h,o,q){const Y=h.getEngine();let J,G=!1,l=1e3;if(Array.isArray(k))for(let x=0;x<k.length;x++){const o=k[x];J=I.DDSTools.GetDDSInfo(o),h.width=J.width,h.height=J.height,G=(J.isRGB||J.isLuminance||J.mipmapCount>1)&&h.generateMipMaps,Y._unpackFlipY(J.isCompressed),I.DDSTools.UploadDDSLevels(Y,h,o,J,G,6,-1,x),J.isFourCC||1!==J.mipmapCount?l=J.mipmapCount-1:Y.generateMipMapsForCubemap(h)}else{const q=k;J=I.DDSTools.GetDDSInfo(q),h.width=J.width,h.height=J.height,o&&(J.sphericalPolynomial=new x.e),G=(J.isRGB||J.isLuminance||J.mipmapCount>1)&&h.generateMipMaps,Y._unpackFlipY(J.isCompressed),I.DDSTools.UploadDDSLevels(Y,h,q,J,G,6),J.isFourCC||1!==J.mipmapCount?l=J.mipmapCount-1:Y.generateMipMapsForCubemap(h,!1)}Y._setCubeMapTextureParams(h,G,l),h.isReady=!0,h.onLoadedObservable.notifyObservers(h),h.onLoadedObservable.clear(),q&&q({isDDS:!0,width:h.width,info:J,data:k,texture:h})}loadData(k,h,o){const x=I.DDSTools.GetDDSInfo(k),q=(x.isRGB||x.isLuminance||x.mipmapCount>1)&&h.generateMipMaps&&Math.max(x.width,x.height)>>x.mipmapCount-1===1;o(x.width,x.height,q,x.isFourCC,(()=>{I.DDSTools.UploadDDSLevels(h.getEngine(),h,k,x,q,1)}))}}},11780:(k,h,o)=>{o.d(h,{d:()=>l});var x=o(11239),I=o(11260),q=o(11428),Y=o(11248),J=o(11281);class G{constructor(k,h,o,x){this.name=k,this.worldAxisForNormal=h,this.worldAxisForFileX=o,this.worldAxisForFileY=x}}class l{static ConvertCubeMapTextureToSphericalPolynomial(k){var h;if(!k.isCube)return null;null===(h=k.ik())||void 0===h||h.getEngine().flushFramebuffer();const o=k.getSize().width,x=k.readPixels(0,void 0,void 0,!1),I=k.readPixels(1,void 0,void 0,!1);let q,Y;k.isRenderTarget?(q=k.readPixels(3,void 0,void 0,!1),Y=k.readPixels(2,void 0,void 0,!1)):(q=k.readPixels(2,void 0,void 0,!1),Y=k.readPixels(3,void 0,void 0,!1));const J=k.readPixels(4,void 0,void 0,!1),G=k.readPixels(5,void 0,void 0,!1),l=k.gammaSpace;let A=0;return 1!=k.textureType&&2!=k.textureType||(A=1),new Promise((k=>{Promise.all([I,x,q,Y,J,G]).then((h=>{let[x,I,q,Y,J,G]=h;const K={size:o,right:I,left:x,up:q,down:Y,front:J,back:G,format:5,type:A,gammaSpace:l};k(this.ConvertCubeMapToSphericalPolynomial(K))}))}))}static _AreaElement(k,h){return Math.atan2(k*h,Math.sqrt(k*k+h*h+1))}static ConvertCubeMapToSphericalPolynomial(k){const h=new q.b;let o=0;const x=2/k.size,G=x,l=.5*x,A=l-1;for(let q=0;q<6;q++){const K=this._FileFaces[q],a=k[K.name];let N=A;const X=5===k.format?4:3;for(let q=0;q<k.size;q++){let c=A;for(let G=0;G<k.size;G++){const A=K.worldAxisForFileX.scale(c).add(K.worldAxisForFileY.scale(N)).add(K.worldAxisForNormal);A.normalize();const W=this._AreaElement(c-l,N-l)-this._AreaElement(c-l,N+l)-this._AreaElement(c+l,N-l)+this._AreaElement(c+l,N+l);let f=a[q*k.size*X+G*X+0],M=a[q*k.size*X+G*X+1],T=a[q*k.size*X+G*X+2];isNaN(f)&&(f=0),isNaN(M)&&(M=0),isNaN(T)&&(T=0),0===k.type&&(f/=255,M/=255,T/=255),k.gammaSpace&&(f=Math.pow((0,I.Clamp)(f),Y.i),M=Math.pow((0,I.Clamp)(M),Y.i),T=Math.pow((0,I.Clamp)(T),Y.i));const j=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const k=Math.max(f,M,T);if(k>j){const h=j/k;f*=h,M*=h,T*=h}}else f=(0,I.Clamp)(f,0,j),M=(0,I.Clamp)(M,0,j),T=(0,I.Clamp)(T,0,j);const d=new J.Zh(f,M,T);h.addLight(A,d,W),o+=W,c+=x}N+=G}}const K=6*(4*Math.PI)/6/o;return h.scaleInPlace(K),h.convertIncidentRadianceToIrradiance(),h.convertIrradianceToLambertianRadiance(),q.e.FromHarmonics(h)}}l._FileFaces=[new G("right",new x.Vh(1,0,0),new x.Vh(0,0,-1),new x.Vh(0,-1,0)),new G("left",new x.Vh(-1,0,0),new x.Vh(0,0,1),new x.Vh(0,-1,0)),new G("up",new x.Vh(0,1,0),new x.Vh(1,0,0),new x.Vh(0,0,1)),new G("down",new x.Vh(0,-1,0),new x.Vh(1,0,0),new x.Vh(0,0,-1)),new G("front",new x.Vh(0,0,1),new x.Vh(1,0,0),new x.Vh(0,-1,0)),new G("back",new x.Vh(0,0,-1),new x.Vh(-1,0,0),new x.Vh(0,-1,0))],l.MAX_HDRI_VALUE=4096,l.PRESERVE_CLAMPED_COLORS=!1},13654:(k,h,o)=>{o.d(h,{DDSTools:()=>X});var x=o(11260),I=o(11098),q=o(11780),Y=o(11461);o(12907);const J=131072,G=131072;function l(k){return k.charCodeAt(0)+(k.charCodeAt(1)<<8)+(k.charCodeAt(2)<<16)+(k.charCodeAt(3)<<24)}const A=l("DXT1"),K=l("DXT3"),a=l("DXT5"),N=l("DX10");class X{static GetDDSInfo(k){const h=new Int32Array(k.buffer,k.byteOffset,31),o=new Int32Array(k.buffer,k.byteOffset,35);let x=1;h[2]&J&&(x=Math.max(1,h[7]));const I=h[21],q=I===N?o[32]:0;let Y=0;switch(I){case 113:Y=2;break;case 116:Y=1;break;case N:if(10===q){Y=2;break}if(2===q){Y=1;break}}return{width:h[4],height:h[3],mipmapCount:x,isFourCC:4===(4&h[20]),isRGB:64===(64&h[20]),isLuminance:(h[20]&G)===G,isCube:512===(512&h[28]),isCompressed:I===A||I===K||I===a,dxgiFormat:q,textureType:Y}}static _GetHalfFloatAsFloatRGBAArrayBuffer(k,h,o,x,I,q){const J=new Float32Array(x),G=new Uint16Array(I,o);let l=0;for(let A=0;A<h;A++)for(let h=0;h<k;h++){const o=4*(h+A*k);J[l]=(0,Y.e)(G[o]),J[l+1]=(0,Y.e)(G[o+1]),J[l+2]=(0,Y.e)(G[o+2]),X.StoreLODInAlphaChannel?J[l+3]=q:J[l+3]=(0,Y.e)(G[o+3]),l+=4}return J}static _GetHalfFloatRGBAArrayBuffer(k,h,o,x,I,q){if(X.StoreLODInAlphaChannel){const J=new Uint16Array(x),G=new Uint16Array(I,o);let l=0;for(let o=0;o<h;o++)for(let h=0;h<k;h++){const x=4*(h+o*k);J[l]=G[x],J[l+1]=G[x+1],J[l+2]=G[x+2],J[l+3]=(0,Y.l)(q),l+=4}return J}return new Uint16Array(I,o,x)}static _GetFloatRGBAArrayBuffer(k,h,o,x,I,q){if(X.StoreLODInAlphaChannel){const Y=new Float32Array(x),J=new Float32Array(I,o);let G=0;for(let o=0;o<h;o++)for(let h=0;h<k;h++){const x=4*(h+o*k);Y[G]=J[x],Y[G+1]=J[x+1],Y[G+2]=J[x+2],Y[G+3]=q,G+=4}return Y}return new Float32Array(I,o,x)}static _GetFloatAsHalfFloatRGBAArrayBuffer(k,h,o,x,I,q){const J=new Uint16Array(x),G=new Float32Array(I,o);let l=0;for(let A=0;A<h;A++)for(let h=0;h<k;h++)J[l]=(0,Y.l)(G[l]),J[l+1]=(0,Y.l)(G[l+1]),J[l+2]=(0,Y.l)(G[l+2]),X.StoreLODInAlphaChannel?J[l+3]=(0,Y.l)(q):J[l+3]=(0,Y.l)(G[l+3]),l+=4;return J}static _GetFloatAsUIntRGBAArrayBuffer(k,h,o,I,q,Y){const J=new Uint8Array(I),G=new Float32Array(q,o);let l=0;for(let A=0;A<h;A++)for(let h=0;h<k;h++){const o=4*(h+A*k);J[l]=255*(0,x.Clamp)(G[o]),J[l+1]=255*(0,x.Clamp)(G[o+1]),J[l+2]=255*(0,x.Clamp)(G[o+2]),X.StoreLODInAlphaChannel?J[l+3]=Y:J[l+3]=255*(0,x.Clamp)(G[o+3]),l+=4}return J}static _GetHalfFloatAsUIntRGBAArrayBuffer(k,h,o,I,q,J){const G=new Uint8Array(I),l=new Uint16Array(q,o);let A=0;for(let K=0;K<h;K++)for(let h=0;h<k;h++){const o=4*(h+K*k);G[A]=255*(0,x.Clamp)((0,Y.e)(l[o])),G[A+1]=255*(0,x.Clamp)((0,Y.e)(l[o+1])),G[A+2]=255*(0,x.Clamp)((0,Y.e)(l[o+2])),X.StoreLODInAlphaChannel?G[A+3]=J:G[A+3]=255*(0,x.Clamp)((0,Y.e)(l[o+3])),A+=4}return G}static _GetRGBAArrayBuffer(k,h,o,x,I,q,Y,J,G){const l=new Uint8Array(x),A=new Uint8Array(I,o);let K=0;for(let a=0;a<h;a++)for(let h=0;h<k;h++){const o=4*(h+a*k);l[K]=A[o+q],l[K+1]=A[o+Y],l[K+2]=A[o+J],l[K+3]=A[o+G],K+=4}return l}static _ExtractLongWordOrder(k){return 0===k||255===k||-16777216===k?0:1+X._ExtractLongWordOrder(k>>8)}static _GetRGBArrayBuffer(k,h,o,x,I,q,Y,J){const G=new Uint8Array(x),l=new Uint8Array(I,o);let A=0;for(let K=0;K<h;K++)for(let h=0;h<k;h++){const o=3*(h+K*k);G[A]=l[o+q],G[A+1]=l[o+Y],G[A+2]=l[o+J],A+=3}return G}static _GetLuminanceArrayBuffer(k,h,o,x,I){const q=new Uint8Array(x),Y=new Uint8Array(I,o);let J=0;for(let G=0;G<h;G++)for(let h=0;h<k;h++){const o=h+G*k;q[J]=Y[o],J++}return q}static UploadDDSLevels(k,h,o,x,Y,G){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,c=arguments.length>7?arguments[7]:void 0,W=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],f=null;x.sphericalPolynomial&&(f=[]);const M=!!k.getCaps().s3tc;h.generateMipMaps=Y;const T=new Int32Array(o.buffer,o.byteOffset,31);let j,d,b,V,i,F,R,s=0,Z=0,w=1;if(542327876!==T[0])return void I.c.Error("Invalid magic number in DDS header");if(!x.isFourCC&&!x.isRGB&&!x.isLuminance)return void I.c.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(x.isCompressed&&!M)return void I.c.Error("Compressed textures are not supported on this platform.");let D=T[22];V=T[1]+4;let U=!1;if(x.isFourCC)switch(j=T[21],j){case A:w=8,Z=33777;break;case K:w=16,Z=33778;break;case a:w=16,Z=33779;break;case 113:U=!0,D=64;break;case 116:U=!0,D=128;break;case N:{V+=20;let k=!1;switch(x.dxgiFormat){case 10:U=!0,D=64,k=!0;break;case 2:U=!0,D=128,k=!0;break;case 88:x.isRGB=!0,x.isFourCC=!1,D=32,k=!0}if(k)break}default:return void I.c.Error(["Unsupported FourCC code:",(Q=j,String.fromCharCode(255&Q,Q>>8&255,Q>>16&255,Q>>24&255))])}var Q;const B=X._ExtractLongWordOrder(T[23]),E=X._ExtractLongWordOrder(T[24]),n=X._ExtractLongWordOrder(T[25]),H=X._ExtractLongWordOrder(T[26]);U&&(Z=k._getRGBABufferInternalSizedFormat(x.textureType)),F=1,T[2]&J&&!1!==Y&&(F=Math.max(1,T[7]));const y=c||0,O=k.getCaps();for(let I=y;I<G;I++){for(d=T[4],b=T[3],R=0;R<F;++R){if(-1===l||l===R){const q=-1===l?R:0;if(!x.isCompressed&&x.isFourCC){h.format=5,s=d*b*4;let x=null;if(k._badOS||k._badDesktopOS||!O.textureHalfFloat&&!O.textureFloat)128===D?(x=X._GetFloatAsUIntRGBAArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,q),f&&0==q&&f.push(X._GetFloatRGBAArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,q))):64===D&&(x=X._GetHalfFloatAsUIntRGBAArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,q),f&&0==q&&f.push(X._GetHalfFloatAsFloatRGBAArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,q))),h.type=0;else{const k=O.textureFloat&&(W&&O.textureFloatLinearFiltering||!W),I=O.textureHalfFloat&&(W&&O.textureHalfFloatLinearFiltering||!W),Y=(128===D||64===D&&!I)&&k?1:(64===D||128===D&&!k)&&I?2:0;let J,G=null;if(128===D)switch(Y){case 1:J=X._GetFloatRGBAArrayBuffer,G=null;break;case 2:J=X._GetFloatAsHalfFloatRGBAArrayBuffer,G=X._GetFloatRGBAArrayBuffer;break;case 0:J=X._GetFloatAsUIntRGBAArrayBuffer,G=X._GetFloatRGBAArrayBuffer}else switch(Y){case 1:J=X._GetHalfFloatAsFloatRGBAArrayBuffer,G=null;break;case 2:J=X._GetHalfFloatRGBAArrayBuffer,G=X._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:J=X._GetHalfFloatAsUIntRGBAArrayBuffer,G=X._GetHalfFloatAsFloatRGBAArrayBuffer}h.type=Y,x=J(d,b,o.byteOffset+V,s,o.buffer,q),f&&0==q&&f.push(G?G(d,b,o.byteOffset+V,s,o.buffer,q):x)}x&&k._uploadDataToTextureDirectly(h,x,I,q)}else if(x.isRGB)h.type=0,24===D?(h.format=4,s=d*b*3,i=X._GetRGBArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,B,E,n),k._uploadDataToTextureDirectly(h,i,I,q)):(h.format=5,s=d*b*4,i=X._GetRGBAArrayBuffer(d,b,o.byteOffset+V,s,o.buffer,B,E,n,H),k._uploadDataToTextureDirectly(h,i,I,q));else if(x.isLuminance){const x=k._getUnpackAlignement(),Y=d;s=Math.floor((d+x-1)/x)*x*(b-1)+Y,i=X._GetLuminanceArrayBuffer(d,b,o.byteOffset+V,s,o.buffer),h.format=1,h.type=0,k._uploadDataToTextureDirectly(h,i,I,q)}else s=Math.max(4,d)/4*Math.max(4,b)/4*w,i=new Uint8Array(o.buffer,o.byteOffset+V,s),h.type=0,k._uploadCompressedDataToTextureDirectly(h,Z,d,b,i,I,q)}V+=D?d*b*(D/8):s,d*=.5,b*=.5,d=Math.max(1,d),b=Math.max(1,b)}if(void 0!==c)break}f&&f.length>0?x.sphericalPolynomial=q.d.ConvertCubeMapToSphericalPolynomial({size:T[4],right:f[0],left:f[1],up:f[2],down:f[3],front:f[4],back:f[5],format:5,type:1,gammaSpace:!1}):x.sphericalPolynomial=void 0}}X.StoreLODInAlphaChannel=!1}}]);