"use strict";(self.ksd6jhs1yr=self.ksd6jhs1yr||[]).push([[28,29],{14092:(C,c,d)=>{var b=d(12316),X=d(12233),P=d(12258),V=d(12352),R=d(12283),p=d(12329);R.c.prototype._partialLoadFile=function(C,c,d,b){let X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(C,(C=>{d[c]=C,d._internalCount++,6===d._internalCount&&b(d)}),void 0,void 0,!0,((C,c)=>{X&&C&&X(C.status+" "+C.statusText,c)}))},R.c.prototype._cascadeLoadFiles=function(C,c,d){let b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const X=[];X._internalCount=0;for(let P=0;P<6;P++)this._partialLoadFile(d[P],P,X,c,b)},R.c.prototype._cascadeLoadImgs=function(C,c,d,b){let X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,P=arguments.length>5?arguments[5]:void 0;const V=[];V._internalCount=0;for(let R=0;R<6;R++)this._partialLoadImg(b[R],R,V,C,c,d,X,P)},R.c.prototype._partialLoadImg=function(C,c,d,b,X,R){let p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,j=arguments.length>7?arguments[7]:void 0;const g=(0,V.c)();(0,P.t)(C,(C=>{d[c]=C,d._internalCount++,b&&b.removePendingData(g),6===d._internalCount&&R&&R(X,d)}),((C,c)=>{b&&b.removePendingData(g),p&&p(C,c)}),b?b.offlineProvider:null,j),b&&b.addPendingData(g)},R.c.prototype.createCubeTextureBase=function(C,c,d,P){let V=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,j=arguments.length>6?arguments[6]:void 0,g=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,k=arguments.length>8&&void 0!==arguments[8]&&arguments[8],Z=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,U=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,A=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,u=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,q=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,B=arguments.length>14&&void 0!==arguments[14]&&arguments[14],t=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const e=A||new b.d(this,7);e.isCube=!0,e.url=C,e.generateMipMaps=!P,e._lodGenerationScale=Z,e._lodGenerationOffset=U,e._useSRGBBuffer=!!B&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!P),e!==A&&(e.label=C.substring(0,60)),this._doNotHandleContextLost||(e._extension=g,e._files=d,e._buffer=t);const n=C;this._transformTextureUrl&&!A&&(C=this._transformTextureUrl(C));const W=g??function(C){const c=C.split("?")[0],d=c.lastIndexOf(".");return d>-1?c.substring(d).toLowerCase():""}(C),E=(0,p.e)(W),N=(C,c)=>{e.dispose(),R?R(C,c):C&&X.d.Warn(C)},r=(b,R)=>{C===n?b&&N(b.status+" "+b.statusText,R):(X.d.Warn(`Failed to load ${C}, falling back to the ${n}`),this.createCubeTextureBase(n,c,d,!!P,V,N,j,g,k,Z,U,e,u,q,B,t))};if(E)E.then((b=>{const X=C=>{u&&u(e,C),b.loadCubeData(C,e,k,V,((C,c)=>{N(C,c)}))};t?X(t):d&&6===d.length?b.supportCascades?this._cascadeLoadFiles(c,(C=>X(C.map((C=>new Uint8Array(C))))),d,N):N("Textures type does not support cascades."):this._loadFile(C,(C=>X(new Uint8Array(C))),void 0,void 0,!0,r)}));else{if(!d||0===d.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(c,e,((C,c)=>{q&&q(C,c)}),d,N)}return this._internalTexturesCache.push(e),e}},14881:(C,c,d)=>{d.r(c),d.d(c,{_DDSTextureLoader:()=>P});var b=d(12595),X=d(14886);class P{constructor(){this.supportCascades=!0}loadCubeData(C,c,d,P){const V=c.getEngine();let R,p=!1,j=1e3;if(Array.isArray(C))for(let b=0;b<C.length;b++){const d=C[b];R=X.DDSTools.GetDDSInfo(d),c.width=R.width,c.height=R.height,p=(R.isRGB||R.isLuminance||R.mipmapCount>1)&&c.generateMipMaps,V._unpackFlipY(R.isCompressed),X.DDSTools.UploadDDSLevels(V,c,d,R,p,6,-1,b),R.isFourCC||1!==R.mipmapCount?j=R.mipmapCount-1:V.generateMipMapsForCubemap(c)}else{const P=C;R=X.DDSTools.GetDDSInfo(P),c.width=R.width,c.height=R.height,d&&(R.sphericalPolynomial=new b.e),p=(R.isRGB||R.isLuminance||R.mipmapCount>1)&&c.generateMipMaps,V._unpackFlipY(R.isCompressed),X.DDSTools.UploadDDSLevels(V,c,P,R,p,6),R.isFourCC||1!==R.mipmapCount?j=R.mipmapCount-1:V.generateMipMapsForCubemap(c,!1)}V._setCubeMapTextureParams(c,p,j),c.isReady=!0,c.onLoadedObservable.notifyObservers(c),c.onLoadedObservable.clear(),P&&P({isDDS:!0,width:c.width,info:R,data:C,texture:c})}loadData(C,c,d){const b=X.DDSTools.GetDDSInfo(C),P=(b.isRGB||b.isLuminance||b.mipmapCount>1)&&c.generateMipMaps&&Math.max(b.width,b.height)>>b.mipmapCount-1===1;d(b.width,b.height,P,b.isFourCC,(()=>{X.DDSTools.UploadDDSLevels(c.getEngine(),c,C,b,P,1)}))}}},12921:(C,c,d)=>{d.d(c,{c:()=>j});var b=d(12403),X=d(12418),P=d(12595),V=d(12412),R=d(12438);class p{constructor(C,c,d,b){this.name=C,this.worldAxisForNormal=c,this.worldAxisForFileX=d,this.worldAxisForFileY=b}}class j{static ConvertCubeMapTextureToSphericalPolynomial(C){var c;if(!C.isCube)return null;null===(c=C.NC())||void 0===c||c.getEngine().flushFramebuffer();const d=C.getSize().width,b=C.readPixels(0,void 0,void 0,!1),X=C.readPixels(1,void 0,void 0,!1);let P,V;C.isRenderTarget?(P=C.readPixels(3,void 0,void 0,!1),V=C.readPixels(2,void 0,void 0,!1)):(P=C.readPixels(2,void 0,void 0,!1),V=C.readPixels(3,void 0,void 0,!1));const R=C.readPixels(4,void 0,void 0,!1),p=C.readPixels(5,void 0,void 0,!1),j=C.gammaSpace;let g=0;return 1!=C.textureType&&2!=C.textureType||(g=1),new Promise((C=>{Promise.all([X,b,P,V,R,p]).then((c=>{let[b,X,P,V,R,p]=c;const k={size:d,right:X,left:b,up:P,down:V,front:R,back:p,format:5,type:g,gammaSpace:j};C(this.ConvertCubeMapToSphericalPolynomial(k))}))}))}static _AreaElement(C,c){return Math.atan2(C*c,Math.sqrt(C*C+c*c+1))}static ConvertCubeMapToSphericalPolynomial(C){const c=new P.d;let d=0;const b=2/C.size,p=b,j=.5*b,g=j-1;for(let P=0;P<6;P++){const k=this._FileFaces[P],Z=C[k.name];let U=g;const A=5===C.format?4:3;for(let P=0;P<C.size;P++){let u=g;for(let p=0;p<C.size;p++){const g=k.worldAxisForFileX.scale(u).add(k.worldAxisForFileY.scale(U)).add(k.worldAxisForNormal);g.normalize();const q=this._AreaElement(u-j,U-j)-this._AreaElement(u-j,U+j)-this._AreaElement(u+j,U-j)+this._AreaElement(u+j,U+j);let B=Z[P*C.size*A+p*A+0],t=Z[P*C.size*A+p*A+1],e=Z[P*C.size*A+p*A+2];isNaN(B)&&(B=0),isNaN(t)&&(t=0),isNaN(e)&&(e=0),0===C.type&&(B/=255,t/=255,e/=255),C.gammaSpace&&(B=Math.pow((0,X.Clamp)(B),V.l),t=Math.pow((0,X.Clamp)(t),V.l),e=Math.pow((0,X.Clamp)(e),V.l));const n=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const C=Math.max(B,t,e);if(C>n){const c=n/C;B*=c,t*=c,e*=c}}else B=(0,X.Clamp)(B,0,n),t=(0,X.Clamp)(t,0,n),e=(0,X.Clamp)(e,0,n);const W=new R.pd(B,t,e);c.addLight(g,W,q),d+=q,u+=b}U+=p}}const k=6*(4*Math.PI)/6/d;return c.scaleInPlace(k),c.convertIncidentRadianceToIrradiance(),c.convertIrradianceToLambertianRadiance(),P.e.FromHarmonics(c)}}j._FileFaces=[new p("right",new b.dd(1,0,0),new b.dd(0,0,-1),new b.dd(0,-1,0)),new p("left",new b.dd(-1,0,0),new b.dd(0,0,1),new b.dd(0,-1,0)),new p("up",new b.dd(0,1,0),new b.dd(1,0,0),new b.dd(0,0,1)),new p("down",new b.dd(0,-1,0),new b.dd(1,0,0),new b.dd(0,0,-1)),new p("front",new b.dd(0,0,1),new b.dd(1,0,0),new b.dd(0,-1,0)),new p("back",new b.dd(0,0,-1),new b.dd(-1,0,0),new b.dd(0,-1,0))],j.MAX_HDRI_VALUE=4096,j.PRESERVE_CLAMPED_COLORS=!1},14886:(C,c,d)=>{d.d(c,{DDSTools:()=>A});var b=d(12418),X=d(12233),P=d(12921),V=d(12628);d(14092);const R=131072,p=131072;function j(C){return C.charCodeAt(0)+(C.charCodeAt(1)<<8)+(C.charCodeAt(2)<<16)+(C.charCodeAt(3)<<24)}const g=j("DXT1"),k=j("DXT3"),Z=j("DXT5"),U=j("DX10");class A{static GetDDSInfo(C){const c=new Int32Array(C.buffer,C.byteOffset,31),d=new Int32Array(C.buffer,C.byteOffset,35);let b=1;c[2]&R&&(b=Math.max(1,c[7]));const X=c[21],P=X===U?d[32]:0;let V=0;switch(X){case 113:V=2;break;case 116:V=1;break;case U:if(10===P){V=2;break}if(2===P){V=1;break}}return{width:c[4],height:c[3],mipmapCount:b,isFourCC:4===(4&c[20]),isRGB:64===(64&c[20]),isLuminance:(c[20]&p)===p,isCube:512===(512&c[28]),isCompressed:X===g||X===k||X===Z,dxgiFormat:P,textureType:V}}static _GetHalfFloatAsFloatRGBAArrayBuffer(C,c,d,b,X,P){const R=new Float32Array(b),p=new Uint16Array(X,d);let j=0;for(let g=0;g<c;g++)for(let c=0;c<C;c++){const d=4*(c+g*C);R[j]=(0,V.d)(p[d]),R[j+1]=(0,V.d)(p[d+1]),R[j+2]=(0,V.d)(p[d+2]),A.StoreLODInAlphaChannel?R[j+3]=P:R[j+3]=(0,V.d)(p[d+3]),j+=4}return R}static _GetHalfFloatRGBAArrayBuffer(C,c,d,b,X,P){if(A.StoreLODInAlphaChannel){const R=new Uint16Array(b),p=new Uint16Array(X,d);let j=0;for(let d=0;d<c;d++)for(let c=0;c<C;c++){const b=4*(c+d*C);R[j]=p[b],R[j+1]=p[b+1],R[j+2]=p[b+2],R[j+3]=(0,V.g)(P),j+=4}return R}return new Uint16Array(X,d,b)}static _GetFloatRGBAArrayBuffer(C,c,d,b,X,P){if(A.StoreLODInAlphaChannel){const V=new Float32Array(b),R=new Float32Array(X,d);let p=0;for(let d=0;d<c;d++)for(let c=0;c<C;c++){const b=4*(c+d*C);V[p]=R[b],V[p+1]=R[b+1],V[p+2]=R[b+2],V[p+3]=P,p+=4}return V}return new Float32Array(X,d,b)}static _GetFloatAsHalfFloatRGBAArrayBuffer(C,c,d,b,X,P){const R=new Uint16Array(b),p=new Float32Array(X,d);let j=0;for(let g=0;g<c;g++)for(let c=0;c<C;c++)R[j]=(0,V.g)(p[j]),R[j+1]=(0,V.g)(p[j+1]),R[j+2]=(0,V.g)(p[j+2]),A.StoreLODInAlphaChannel?R[j+3]=(0,V.g)(P):R[j+3]=(0,V.g)(p[j+3]),j+=4;return R}static _GetFloatAsUIntRGBAArrayBuffer(C,c,d,X,P,V){const R=new Uint8Array(X),p=new Float32Array(P,d);let j=0;for(let g=0;g<c;g++)for(let c=0;c<C;c++){const d=4*(c+g*C);R[j]=255*(0,b.Clamp)(p[d]),R[j+1]=255*(0,b.Clamp)(p[d+1]),R[j+2]=255*(0,b.Clamp)(p[d+2]),A.StoreLODInAlphaChannel?R[j+3]=V:R[j+3]=255*(0,b.Clamp)(p[d+3]),j+=4}return R}static _GetHalfFloatAsUIntRGBAArrayBuffer(C,c,d,X,P,R){const p=new Uint8Array(X),j=new Uint16Array(P,d);let g=0;for(let k=0;k<c;k++)for(let c=0;c<C;c++){const d=4*(c+k*C);p[g]=255*(0,b.Clamp)((0,V.d)(j[d])),p[g+1]=255*(0,b.Clamp)((0,V.d)(j[d+1])),p[g+2]=255*(0,b.Clamp)((0,V.d)(j[d+2])),A.StoreLODInAlphaChannel?p[g+3]=R:p[g+3]=255*(0,b.Clamp)((0,V.d)(j[d+3])),g+=4}return p}static _GetRGBAArrayBuffer(C,c,d,b,X,P,V,R,p){const j=new Uint8Array(b),g=new Uint8Array(X,d);let k=0;for(let Z=0;Z<c;Z++)for(let c=0;c<C;c++){const d=4*(c+Z*C);j[k]=g[d+P],j[k+1]=g[d+V],j[k+2]=g[d+R],j[k+3]=g[d+p],k+=4}return j}static _ExtractLongWordOrder(C){return 0===C||255===C||-16777216===C?0:1+A._ExtractLongWordOrder(C>>8)}static _GetRGBArrayBuffer(C,c,d,b,X,P,V,R){const p=new Uint8Array(b),j=new Uint8Array(X,d);let g=0;for(let k=0;k<c;k++)for(let c=0;c<C;c++){const d=3*(c+k*C);p[g]=j[d+P],p[g+1]=j[d+V],p[g+2]=j[d+R],g+=3}return p}static _GetLuminanceArrayBuffer(C,c,d,b,X){const P=new Uint8Array(b),V=new Uint8Array(X,d);let R=0;for(let p=0;p<c;p++)for(let c=0;c<C;c++){const d=c+p*C;P[R]=V[d],R++}return P}static UploadDDSLevels(C,c,d,b,V,p){let j=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,u=arguments.length>7?arguments[7]:void 0,q=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],B=null;b.sphericalPolynomial&&(B=[]);const t=!!C.getCaps().s3tc;c.generateMipMaps=V;const e=new Int32Array(d.buffer,d.byteOffset,31);let n,W,E,N,r,M,K,i=0,h=0,L=1;if(542327876!==e[0])return void X.d.Error("Invalid magic number in DDS header");if(!b.isFourCC&&!b.isRGB&&!b.isLuminance)return void X.d.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(b.isCompressed&&!t)return void X.d.Error("Compressed textures are not supported on this platform.");let f=e[22];N=e[1]+4;let T=!1;if(b.isFourCC)switch(n=e[21],n){case g:L=8,h=33777;break;case k:L=16,h=33778;break;case Z:L=16,h=33779;break;case 113:T=!0,f=64;break;case 116:T=!0,f=128;break;case U:{N+=20;let C=!1;switch(b.dxgiFormat){case 10:T=!0,f=64,C=!0;break;case 2:T=!0,f=128,C=!0;break;case 88:b.isRGB=!0,b.isFourCC=!1,f=32,C=!0}if(C)break}default:return void X.d.Error(["Unsupported FourCC code:",(z=n,String.fromCharCode(255&z,z>>8&255,z>>16&255,z>>24&255))])}var z;const w=A._ExtractLongWordOrder(e[23]),J=A._ExtractLongWordOrder(e[24]),y=A._ExtractLongWordOrder(e[25]),x=A._ExtractLongWordOrder(e[26]);T&&(h=C._getRGBABufferInternalSizedFormat(b.textureType)),M=1,e[2]&R&&!1!==V&&(M=Math.max(1,e[7]));const H=u||0,v=C.getCaps();for(let X=H;X<p;X++){for(W=e[4],E=e[3],K=0;K<M;++K){if(-1===j||j===K){const P=-1===j?K:0;if(!b.isCompressed&&b.isFourCC){c.format=5,i=W*E*4;let b=null;if(C._badOS||C._badDesktopOS||!v.textureHalfFloat&&!v.textureFloat)128===f?(b=A._GetFloatAsUIntRGBAArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,P),B&&0==P&&B.push(A._GetFloatRGBAArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,P))):64===f&&(b=A._GetHalfFloatAsUIntRGBAArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,P),B&&0==P&&B.push(A._GetHalfFloatAsFloatRGBAArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,P))),c.type=0;else{const C=v.textureFloat&&(q&&v.textureFloatLinearFiltering||!q),X=v.textureHalfFloat&&(q&&v.textureHalfFloatLinearFiltering||!q),V=(128===f||64===f&&!X)&&C?1:(64===f||128===f&&!C)&&X?2:0;let R,p=null;if(128===f)switch(V){case 1:R=A._GetFloatRGBAArrayBuffer,p=null;break;case 2:R=A._GetFloatAsHalfFloatRGBAArrayBuffer,p=A._GetFloatRGBAArrayBuffer;break;case 0:R=A._GetFloatAsUIntRGBAArrayBuffer,p=A._GetFloatRGBAArrayBuffer}else switch(V){case 1:R=A._GetHalfFloatAsFloatRGBAArrayBuffer,p=null;break;case 2:R=A._GetHalfFloatRGBAArrayBuffer,p=A._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:R=A._GetHalfFloatAsUIntRGBAArrayBuffer,p=A._GetHalfFloatAsFloatRGBAArrayBuffer}c.type=V,b=R(W,E,d.byteOffset+N,i,d.buffer,P),B&&0==P&&B.push(p?p(W,E,d.byteOffset+N,i,d.buffer,P):b)}b&&C._uploadDataToTextureDirectly(c,b,X,P)}else if(b.isRGB)c.type=0,24===f?(c.format=4,i=W*E*3,r=A._GetRGBArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,w,J,y),C._uploadDataToTextureDirectly(c,r,X,P)):(c.format=5,i=W*E*4,r=A._GetRGBAArrayBuffer(W,E,d.byteOffset+N,i,d.buffer,w,J,y,x),C._uploadDataToTextureDirectly(c,r,X,P));else if(b.isLuminance){const b=C._getUnpackAlignement(),V=W;i=Math.floor((W+b-1)/b)*b*(E-1)+V,r=A._GetLuminanceArrayBuffer(W,E,d.byteOffset+N,i,d.buffer),c.format=1,c.type=0,C._uploadDataToTextureDirectly(c,r,X,P)}else i=Math.max(4,W)/4*Math.max(4,E)/4*L,r=new Uint8Array(d.buffer,d.byteOffset+N,i),c.type=0,C._uploadCompressedDataToTextureDirectly(c,h,W,E,r,X,P)}N+=f?W*E*(f/8):i,W*=.5,E*=.5,W=Math.max(1,W),E=Math.max(1,E)}if(void 0!==u)break}B&&B.length>0?b.sphericalPolynomial=P.c.ConvertCubeMapToSphericalPolynomial({size:e[4],right:B[0],left:B[1],up:B[2],down:B[3],front:B[4],back:B[5],format:5,type:1,gammaSpace:!1}):b.sphericalPolynomial=void 0}}A.StoreLODInAlphaChannel=!1}}]);