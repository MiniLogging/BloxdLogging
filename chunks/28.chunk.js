"use strict";(self.jr1pmf6bwuf=self.jr1pmf6bwuf||[]).push([[28,29],{14427:(Y,c,h)=>{var C=h(12805),E=h(12700),N=h(12728),Q=h(12832),b=h(12761),H=h(12817);b.c.prototype._partialLoadFile=function(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(Y,(Y=>{h[c]=Y,h._internalCount++,6===h._internalCount&&C(h)}),void 0,void 0,!0,((Y,c)=>{E&&Y&&E(Y.status+" "+Y.statusText,c)}))},b.c.prototype._cascadeLoadFiles=function(Y,c,h){let C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const E=[];E._internalCount=0;for(let N=0;N<6;N++)this._partialLoadFile(h[N],N,E,c,C)},b.c.prototype._cascadeLoadImgs=function(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,N=arguments.length>5?arguments[5]:void 0;const Q=[];Q._internalCount=0;for(let b=0;b<6;b++)this._partialLoadImg(C[b],b,Q,Y,c,h,E,N)},b.c.prototype._partialLoadImg=function(Y,c,h,C,E,b){let H=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,w=arguments.length>7?arguments[7]:void 0;const W=(0,Q.e)();(0,N.u)(Y,(Y=>{h[c]=Y,h._internalCount++,C&&C.removePendingData(W),6===h._internalCount&&b&&b(E,h)}),((Y,c)=>{C&&C.removePendingData(W),H&&H(Y,c)}),C?C.offlineProvider:null,w),C&&C.addPendingData(W)},b.c.prototype.createCubeTextureBase=function(Y,c,h,N){let Q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,b=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,w=arguments.length>6?arguments[6]:void 0,W=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,q=arguments.length>8&&void 0!==arguments[8]&&arguments[8],k=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,M=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,p=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,P=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,y=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,d=arguments.length>14&&void 0!==arguments[14]&&arguments[14],D=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const T=p||new C.c(this,7);T.isCube=!0,T.url=Y,T.generateMipMaps=!N,T._lodGenerationScale=k,T._lodGenerationOffset=M,T._useSRGBBuffer=!!d&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!N),T!==p&&(T.label=Y.substring(0,60)),this._doNotHandleContextLost||(T._extension=W,T._files=h,T._buffer=D);const e=Y;this._transformTextureUrl&&!p&&(Y=this._transformTextureUrl(Y));const r=W??function(Y){const c=Y.split("?")[0],h=c.lastIndexOf(".");return h>-1?c.substring(h).toLowerCase():""}(Y),X=(0,H.b)(r),Z=(Y,c)=>{T.dispose(),b?b(Y,c):Y&&E.e.Warn(Y)},a=(C,b)=>{Y===e?C&&Z(C.status+" "+C.statusText,b):(E.e.Warn(`Failed to load ${Y}, falling back to the ${e}`),this.createCubeTextureBase(e,c,h,!!N,Q,Z,w,W,q,k,M,T,P,y,d,D))};if(X)X.then((C=>{const E=Y=>{P&&P(T,Y),C.loadCubeData(Y,T,q,Q,((Y,c)=>{Z(Y,c)}))};D?E(D):h&&6===h.length?C.supportCascades?this._cascadeLoadFiles(c,(Y=>E(Y.map((Y=>new Uint8Array(Y))))),h,Z):Z("Textures type does not support cascades."):this._loadFile(Y,(Y=>E(new Uint8Array(Y))),void 0,void 0,!0,a)}));else{if(!h||0===h.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(c,T,((Y,c)=>{y&&y(Y,c)}),h,Z)}return this._internalTexturesCache.push(T),T}},15403:(Y,c,h)=>{h.r(c),h.d(c,{_DDSTextureLoader:()=>N});var C=h(13068),E=h(15409);class N{constructor(){this.supportCascades=!0}loadCubeData(Y,c,h,N){const Q=c.getEngine();let b,H=!1,w=1e3;if(Array.isArray(Y))for(let C=0;C<Y.length;C++){const h=Y[C];b=E.DDSTools.GetDDSInfo(h),c.width=b.width,c.height=b.height,H=(b.isRGB||b.isLuminance||b.mipmapCount>1)&&c.generateMipMaps,Q._unpackFlipY(b.isCompressed),E.DDSTools.UploadDDSLevels(Q,c,h,b,H,6,-1,C),b.isFourCC||1!==b.mipmapCount?w=b.mipmapCount-1:Q.generateMipMapsForCubemap(c)}else{const N=Y;b=E.DDSTools.GetDDSInfo(N),c.width=b.width,c.height=b.height,h&&(b.sphericalPolynomial=new C.f),H=(b.isRGB||b.isLuminance||b.mipmapCount>1)&&c.generateMipMaps,Q._unpackFlipY(b.isCompressed),E.DDSTools.UploadDDSLevels(Q,c,N,b,H,6),b.isFourCC||1!==b.mipmapCount?w=b.mipmapCount-1:Q.generateMipMapsForCubemap(c,!1)}Q._setCubeMapTextureParams(c,H,w),c.isReady=!0,c.onLoadedObservable.notifyObservers(c),c.onLoadedObservable.clear(),N&&N({isDDS:!0,width:c.width,info:b,data:Y,texture:c})}loadData(Y,c,h){const C=E.DDSTools.GetDDSInfo(Y),N=(C.isRGB||C.isLuminance||C.mipmapCount>1)&&c.generateMipMaps&&Math.max(C.width,C.height)>>C.mipmapCount-1===1;h(C.width,C.height,N,C.isFourCC,(()=>{E.DDSTools.UploadDDSLevels(c.getEngine(),c,Y,C,N,1)}))}}},13388:(Y,c,h)=>{h.d(c,{e:()=>w});var C=h(12869),E=h(12883),N=h(13068),Q=h(12874),b=h(12920);class H{constructor(Y,c,h,C){this.name=Y,this.worldAxisForNormal=c,this.worldAxisForFileX=h,this.worldAxisForFileY=C}}class w{static ConvertCubeMapTextureToSphericalPolynomial(Y){var c;if(!Y.isCube)return null;null===(c=Y.ZY())||void 0===c||c.getEngine().flushFramebuffer();const h=Y.getSize().width,C=Y.readPixels(0,void 0,void 0,!1),E=Y.readPixels(1,void 0,void 0,!1);let N,Q;Y.isRenderTarget?(N=Y.readPixels(3,void 0,void 0,!1),Q=Y.readPixels(2,void 0,void 0,!1)):(N=Y.readPixels(2,void 0,void 0,!1),Q=Y.readPixels(3,void 0,void 0,!1));const b=Y.readPixels(4,void 0,void 0,!1),H=Y.readPixels(5,void 0,void 0,!1),w=Y.gammaSpace;let W=0;return 1!=Y.textureType&&2!=Y.textureType||(W=1),new Promise((Y=>{Promise.all([E,C,N,Q,b,H]).then((c=>{let[C,E,N,Q,b,H]=c;const q={size:h,right:E,left:C,up:N,down:Q,front:b,back:H,format:5,type:W,gammaSpace:w};Y(this.ConvertCubeMapToSphericalPolynomial(q))}))}))}static _AreaElement(Y,c){return Math.atan2(Y*c,Math.sqrt(Y*Y+c*c+1))}static ConvertCubeMapToSphericalPolynomial(Y){const c=new N.e;let h=0;const C=2/Y.size,H=C,w=.5*C,W=w-1;for(let N=0;N<6;N++){const q=this._FileFaces[N],k=Y[q.name];let M=W;const p=5===Y.format?4:3;for(let N=0;N<Y.size;N++){let P=W;for(let H=0;H<Y.size;H++){const W=q.worldAxisForFileX.scale(P).add(q.worldAxisForFileY.scale(M)).add(q.worldAxisForNormal);W.normalize();const y=this._AreaElement(P-w,M-w)-this._AreaElement(P-w,M+w)-this._AreaElement(P+w,M-w)+this._AreaElement(P+w,M+w);let d=k[N*Y.size*p+H*p+0],D=k[N*Y.size*p+H*p+1],T=k[N*Y.size*p+H*p+2];isNaN(d)&&(d=0),isNaN(D)&&(D=0),isNaN(T)&&(T=0),0===Y.type&&(d/=255,D/=255,T/=255),Y.gammaSpace&&(d=Math.pow((0,E.Clamp)(d),Q.l),D=Math.pow((0,E.Clamp)(D),Q.l),T=Math.pow((0,E.Clamp)(T),Q.l));const e=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const Y=Math.max(d,D,T);if(Y>e){const c=e/Y;d*=c,D*=c,T*=c}}else d=(0,E.Clamp)(d,0,e),D=(0,E.Clamp)(D,0,e),T=(0,E.Clamp)(T,0,e);const r=new b.ph(d,D,T);c.addLight(W,r,y),h+=y,P+=C}M+=H}}const q=6*(4*Math.PI)/6/h;return c.scaleInPlace(q),c.convertIncidentRadianceToIrradiance(),c.convertIrradianceToLambertianRadiance(),N.f.FromHarmonics(c)}}w._FileFaces=[new H("right",new C.bh(1,0,0),new C.bh(0,0,-1),new C.bh(0,-1,0)),new H("left",new C.bh(-1,0,0),new C.bh(0,0,1),new C.bh(0,-1,0)),new H("up",new C.bh(0,1,0),new C.bh(1,0,0),new C.bh(0,0,1)),new H("down",new C.bh(0,-1,0),new C.bh(1,0,0),new C.bh(0,0,-1)),new H("front",new C.bh(0,0,1),new C.bh(1,0,0),new C.bh(0,-1,0)),new H("back",new C.bh(0,0,-1),new C.bh(-1,0,0),new C.bh(0,-1,0))],w.MAX_HDRI_VALUE=4096,w.PRESERVE_CLAMPED_COLORS=!1},15409:(Y,c,h)=>{h.d(c,{DDSTools:()=>p});var C=h(12883),E=h(12700),N=h(13388),Q=h(13102);h(14427);const b=131072,H=131072;function w(Y){return Y.charCodeAt(0)+(Y.charCodeAt(1)<<8)+(Y.charCodeAt(2)<<16)+(Y.charCodeAt(3)<<24)}const W=w("DXT1"),q=w("DXT3"),k=w("DXT5"),M=w("DX10");class p{static GetDDSInfo(Y){const c=new Int32Array(Y.buffer,Y.byteOffset,31),h=new Int32Array(Y.buffer,Y.byteOffset,35);let C=1;c[2]&b&&(C=Math.max(1,c[7]));const E=c[21],N=E===M?h[32]:0;let Q=0;switch(E){case 113:Q=2;break;case 116:Q=1;break;case M:if(10===N){Q=2;break}if(2===N){Q=1;break}}return{width:c[4],height:c[3],mipmapCount:C,isFourCC:4===(4&c[20]),isRGB:64===(64&c[20]),isLuminance:(c[20]&H)===H,isCube:512===(512&c[28]),isCompressed:E===W||E===q||E===k,dxgiFormat:N,textureType:Q}}static _GetHalfFloatAsFloatRGBAArrayBuffer(Y,c,h,C,E,N){const b=new Float32Array(C),H=new Uint16Array(E,h);let w=0;for(let W=0;W<c;W++)for(let c=0;c<Y;c++){const h=4*(c+W*Y);b[w]=(0,Q.f)(H[h]),b[w+1]=(0,Q.f)(H[h+1]),b[w+2]=(0,Q.f)(H[h+2]),p.StoreLODInAlphaChannel?b[w+3]=N:b[w+3]=(0,Q.f)(H[h+3]),w+=4}return b}static _GetHalfFloatRGBAArrayBuffer(Y,c,h,C,E,N){if(p.StoreLODInAlphaChannel){const b=new Uint16Array(C),H=new Uint16Array(E,h);let w=0;for(let h=0;h<c;h++)for(let c=0;c<Y;c++){const C=4*(c+h*Y);b[w]=H[C],b[w+1]=H[C+1],b[w+2]=H[C+2],b[w+3]=(0,Q.m)(N),w+=4}return b}return new Uint16Array(E,h,C)}static _GetFloatRGBAArrayBuffer(Y,c,h,C,E,N){if(p.StoreLODInAlphaChannel){const Q=new Float32Array(C),b=new Float32Array(E,h);let H=0;for(let h=0;h<c;h++)for(let c=0;c<Y;c++){const C=4*(c+h*Y);Q[H]=b[C],Q[H+1]=b[C+1],Q[H+2]=b[C+2],Q[H+3]=N,H+=4}return Q}return new Float32Array(E,h,C)}static _GetFloatAsHalfFloatRGBAArrayBuffer(Y,c,h,C,E,N){const b=new Uint16Array(C),H=new Float32Array(E,h);let w=0;for(let W=0;W<c;W++)for(let c=0;c<Y;c++)b[w]=(0,Q.m)(H[w]),b[w+1]=(0,Q.m)(H[w+1]),b[w+2]=(0,Q.m)(H[w+2]),p.StoreLODInAlphaChannel?b[w+3]=(0,Q.m)(N):b[w+3]=(0,Q.m)(H[w+3]),w+=4;return b}static _GetFloatAsUIntRGBAArrayBuffer(Y,c,h,E,N,Q){const b=new Uint8Array(E),H=new Float32Array(N,h);let w=0;for(let W=0;W<c;W++)for(let c=0;c<Y;c++){const h=4*(c+W*Y);b[w]=255*(0,C.Clamp)(H[h]),b[w+1]=255*(0,C.Clamp)(H[h+1]),b[w+2]=255*(0,C.Clamp)(H[h+2]),p.StoreLODInAlphaChannel?b[w+3]=Q:b[w+3]=255*(0,C.Clamp)(H[h+3]),w+=4}return b}static _GetHalfFloatAsUIntRGBAArrayBuffer(Y,c,h,E,N,b){const H=new Uint8Array(E),w=new Uint16Array(N,h);let W=0;for(let q=0;q<c;q++)for(let c=0;c<Y;c++){const h=4*(c+q*Y);H[W]=255*(0,C.Clamp)((0,Q.f)(w[h])),H[W+1]=255*(0,C.Clamp)((0,Q.f)(w[h+1])),H[W+2]=255*(0,C.Clamp)((0,Q.f)(w[h+2])),p.StoreLODInAlphaChannel?H[W+3]=b:H[W+3]=255*(0,C.Clamp)((0,Q.f)(w[h+3])),W+=4}return H}static _GetRGBAArrayBuffer(Y,c,h,C,E,N,Q,b,H){const w=new Uint8Array(C),W=new Uint8Array(E,h);let q=0;for(let k=0;k<c;k++)for(let c=0;c<Y;c++){const h=4*(c+k*Y);w[q]=W[h+N],w[q+1]=W[h+Q],w[q+2]=W[h+b],w[q+3]=W[h+H],q+=4}return w}static _ExtractLongWordOrder(Y){return 0===Y||255===Y||-16777216===Y?0:1+p._ExtractLongWordOrder(Y>>8)}static _GetRGBArrayBuffer(Y,c,h,C,E,N,Q,b){const H=new Uint8Array(C),w=new Uint8Array(E,h);let W=0;for(let q=0;q<c;q++)for(let c=0;c<Y;c++){const h=3*(c+q*Y);H[W]=w[h+N],H[W+1]=w[h+Q],H[W+2]=w[h+b],W+=3}return H}static _GetLuminanceArrayBuffer(Y,c,h,C,E){const N=new Uint8Array(C),Q=new Uint8Array(E,h);let b=0;for(let H=0;H<c;H++)for(let c=0;c<Y;c++){const h=c+H*Y;N[b]=Q[h],b++}return N}static UploadDDSLevels(Y,c,h,C,Q,H){let w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,P=arguments.length>7?arguments[7]:void 0,y=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],d=null;C.sphericalPolynomial&&(d=[]);const D=!!Y.getCaps().s3tc;c.generateMipMaps=Q;const T=new Int32Array(h.buffer,h.byteOffset,31);let e,r,X,Z,a,G,K,I=0,s=0,x=1;if(542327876!==T[0])return void E.e.Error("Invalid magic number in DDS header");if(!C.isFourCC&&!C.isRGB&&!C.isLuminance)return void E.e.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(C.isCompressed&&!D)return void E.e.Error("Compressed textures are not supported on this platform.");let A=T[22];Z=T[1]+4;let V=!1;if(C.isFourCC)switch(e=T[21],e){case W:x=8,s=33777;break;case q:x=16,s=33778;break;case k:x=16,s=33779;break;case 113:V=!0,A=64;break;case 116:V=!0,A=128;break;case M:{Z+=20;let Y=!1;switch(C.dxgiFormat){case 10:V=!0,A=64,Y=!0;break;case 2:V=!0,A=128,Y=!0;break;case 88:C.isRGB=!0,C.isFourCC=!1,A=32,Y=!0}if(Y)break}default:return void E.e.Error(["Unsupported FourCC code:",(U=e,String.fromCharCode(255&U,U>>8&255,U>>16&255,U>>24&255))])}var U;const l=p._ExtractLongWordOrder(T[23]),n=p._ExtractLongWordOrder(T[24]),v=p._ExtractLongWordOrder(T[25]),g=p._ExtractLongWordOrder(T[26]);V&&(s=Y._getRGBABufferInternalSizedFormat(C.textureType)),G=1,T[2]&b&&!1!==Q&&(G=Math.max(1,T[7]));const z=P||0,O=Y.getCaps();for(let E=z;E<H;E++){for(r=T[4],X=T[3],K=0;K<G;++K){if(-1===w||w===K){const N=-1===w?K:0;if(!C.isCompressed&&C.isFourCC){c.format=5,I=r*X*4;let C=null;if(Y._badOS||Y._badDesktopOS||!O.textureHalfFloat&&!O.textureFloat)128===A?(C=p._GetFloatAsUIntRGBAArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,N),d&&0==N&&d.push(p._GetFloatRGBAArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,N))):64===A&&(C=p._GetHalfFloatAsUIntRGBAArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,N),d&&0==N&&d.push(p._GetHalfFloatAsFloatRGBAArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,N))),c.type=0;else{const Y=O.textureFloat&&(y&&O.textureFloatLinearFiltering||!y),E=O.textureHalfFloat&&(y&&O.textureHalfFloatLinearFiltering||!y),Q=(128===A||64===A&&!E)&&Y?1:(64===A||128===A&&!Y)&&E?2:0;let b,H=null;if(128===A)switch(Q){case 1:b=p._GetFloatRGBAArrayBuffer,H=null;break;case 2:b=p._GetFloatAsHalfFloatRGBAArrayBuffer,H=p._GetFloatRGBAArrayBuffer;break;case 0:b=p._GetFloatAsUIntRGBAArrayBuffer,H=p._GetFloatRGBAArrayBuffer}else switch(Q){case 1:b=p._GetHalfFloatAsFloatRGBAArrayBuffer,H=null;break;case 2:b=p._GetHalfFloatRGBAArrayBuffer,H=p._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:b=p._GetHalfFloatAsUIntRGBAArrayBuffer,H=p._GetHalfFloatAsFloatRGBAArrayBuffer}c.type=Q,C=b(r,X,h.byteOffset+Z,I,h.buffer,N),d&&0==N&&d.push(H?H(r,X,h.byteOffset+Z,I,h.buffer,N):C)}C&&Y._uploadDataToTextureDirectly(c,C,E,N)}else if(C.isRGB)c.type=0,24===A?(c.format=4,I=r*X*3,a=p._GetRGBArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,l,n,v),Y._uploadDataToTextureDirectly(c,a,E,N)):(c.format=5,I=r*X*4,a=p._GetRGBAArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer,l,n,v,g),Y._uploadDataToTextureDirectly(c,a,E,N));else if(C.isLuminance){const C=Y._getUnpackAlignement(),Q=r;I=Math.floor((r+C-1)/C)*C*(X-1)+Q,a=p._GetLuminanceArrayBuffer(r,X,h.byteOffset+Z,I,h.buffer),c.format=1,c.type=0,Y._uploadDataToTextureDirectly(c,a,E,N)}else I=Math.max(4,r)/4*Math.max(4,X)/4*x,a=new Uint8Array(h.buffer,h.byteOffset+Z,I),c.type=0,Y._uploadCompressedDataToTextureDirectly(c,s,r,X,a,E,N)}Z+=A?r*X*(A/8):I,r*=.5,X*=.5,r=Math.max(1,r),X=Math.max(1,X)}if(void 0!==P)break}d&&d.length>0?C.sphericalPolynomial=N.e.ConvertCubeMapToSphericalPolynomial({size:T[4],right:d[0],left:d[1],up:d[2],down:d[3],front:d[4],back:d[5],format:5,type:1,gammaSpace:!1}):C.sphericalPolynomial=void 0}}p.StoreLODInAlphaChannel=!1}}]);