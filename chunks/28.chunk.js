"use strict";(self.wy695la1oic=self.wy695la1oic||[]).push([[28,29],{13082:(S,v,D)=>{var z=D(11301),e=D(11190),N=D(11229),m=D(11336),B=D(11269),g=D(11314);B.d.prototype._partialLoadFile=function(S,v,D,z){let e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(S,(S=>{D[v]=S,D._internalCount++,6===D._internalCount&&z(D)}),void 0,void 0,!0,((S,v)=>{e&&S&&e(S.status+" "+S.statusText,v)}))},B.d.prototype._cascadeLoadFiles=function(S,v,D){let z=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const e=[];e._internalCount=0;for(let N=0;N<6;N++)this._partialLoadFile(D[N],N,e,v,z)},B.d.prototype._cascadeLoadImgs=function(S,v,D,z){let e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,N=arguments.length>5?arguments[5]:void 0;const m=[];m._internalCount=0;for(let B=0;B<6;B++)this._partialLoadImg(z[B],B,m,S,v,D,e,N)},B.d.prototype._partialLoadImg=function(S,v,D,z,e,B){let g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,E=arguments.length>7?arguments[7]:void 0;const h=(0,m.e)();(0,N.n)(S,(S=>{D[v]=S,D._internalCount++,z&&z.removePendingData(h),6===D._internalCount&&B&&B(e,D)}),((S,v)=>{z&&z.removePendingData(h),g&&g(S,v)}),z?z.offlineProvider:null,E),z&&z.addPendingData(h)},B.d.prototype.createCubeTextureBase=function(S,v,D,N){let m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,E=arguments.length>6?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,A=arguments.length>8&&void 0!==arguments[8]&&arguments[8],w=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,n=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,R=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,O=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,I=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,K=arguments.length>14&&void 0!==arguments[14]&&arguments[14],q=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const u=R||new z.b(this,7);u.isCube=!0,u.url=S,u.generateMipMaps=!N,u._lodGenerationScale=w,u._lodGenerationOffset=n,u._useSRGBBuffer=!!K&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!N),u!==R&&(u.label=S.substring(0,60)),this._doNotHandleContextLost||(u._extension=h,u._files=D,u._buffer=q);const s=S;this._transformTextureUrl&&!R&&(S=this._transformTextureUrl(S));const r=h??function(S){const v=S.split("?")[0],D=v.lastIndexOf(".");return D>-1?v.substring(D).toLowerCase():""}(S),d=(0,g.c)(r),x=(S,v)=>{u.dispose(),B?B(S,v):S&&e.b.Warn(S)},W=(z,B)=>{S===s?z&&x(z.status+" "+z.statusText,B):(e.b.Warn(`Failed to load ${S}, falling back to the ${s}`),this.createCubeTextureBase(s,v,D,!!N,m,x,E,h,A,w,n,u,O,I,K,q))};if(d)d.then((z=>{const e=S=>{O&&O(u,S),z.loadCubeData(S,u,A,m,((S,v)=>{x(S,v)}))};q?e(q):D&&6===D.length?z.supportCascades?this._cascadeLoadFiles(v,(S=>e(S.map((S=>new Uint8Array(S))))),D,x):x("Textures type does not support cascades."):this._loadFile(S,(S=>e(new Uint8Array(S))),void 0,void 0,!0,W)}));else{if(!D||0===D.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(v,u,((S,v)=>{I&&I(S,v)}),D,x)}return this._internalTexturesCache.push(u),u}},13843:(S,v,D)=>{D.r(v),D.d(v,{_DDSTextureLoader:()=>N});var z=D(11573),e=D(13850);class N{constructor(){this.supportCascades=!0}loadCubeData(S,v,D,N){const m=v.getEngine();let B,g=!1,E=1e3;if(Array.isArray(S))for(let z=0;z<S.length;z++){const D=S[z];B=e.DDSTools.GetDDSInfo(D),v.width=B.width,v.height=B.height,g=(B.isRGB||B.isLuminance||B.mipmapCount>1)&&v.generateMipMaps,m._unpackFlipY(B.isCompressed),e.DDSTools.UploadDDSLevels(m,v,D,B,g,6,-1,z),B.isFourCC||1!==B.mipmapCount?E=B.mipmapCount-1:m.generateMipMapsForCubemap(v)}else{const N=S;B=e.DDSTools.GetDDSInfo(N),v.width=B.width,v.height=B.height,D&&(B.sphericalPolynomial=new z.g),g=(B.isRGB||B.isLuminance||B.mipmapCount>1)&&v.generateMipMaps,m._unpackFlipY(B.isCompressed),e.DDSTools.UploadDDSLevels(m,v,N,B,g,6),B.isFourCC||1!==B.mipmapCount?E=B.mipmapCount-1:m.generateMipMapsForCubemap(v,!1)}m._setCubeMapTextureParams(v,g,E),v.isReady=!0,v.onLoadedObservable.notifyObservers(v),v.onLoadedObservable.clear(),N&&N({isDDS:!0,width:v.width,info:B,data:S,texture:v})}loadData(S,v,D){const z=e.DDSTools.GetDDSInfo(S),N=(z.isRGB||z.isLuminance||z.mipmapCount>1)&&v.generateMipMaps&&Math.max(z.width,z.height)>>z.mipmapCount-1===1;D(z.width,z.height,N,z.isFourCC,(()=>{e.DDSTools.UploadDDSLevels(v.getEngine(),v,S,z,N,1)}))}}},11881:(S,v,D)=>{D.d(v,{d:()=>E});var z=D(11371),e=D(11393),N=D(11573),m=D(11377),B=D(11425);class g{constructor(S,v,D,z){this.name=S,this.worldAxisForNormal=v,this.worldAxisForFileX=D,this.worldAxisForFileY=z}}class E{static ConvertCubeMapTextureToSphericalPolynomial(S){var v;if(!S.isCube)return null;null===(v=S.xS())||void 0===v||v.getEngine().flushFramebuffer();const D=S.getSize().width,z=S.readPixels(0,void 0,void 0,!1),e=S.readPixels(1,void 0,void 0,!1);let N,m;S.isRenderTarget?(N=S.readPixels(3,void 0,void 0,!1),m=S.readPixels(2,void 0,void 0,!1)):(N=S.readPixels(2,void 0,void 0,!1),m=S.readPixels(3,void 0,void 0,!1));const B=S.readPixels(4,void 0,void 0,!1),g=S.readPixels(5,void 0,void 0,!1),E=S.gammaSpace;let h=0;return 1!=S.textureType&&2!=S.textureType||(h=1),new Promise((S=>{Promise.all([e,z,N,m,B,g]).then((v=>{let[z,e,N,m,B,g]=v;const A={size:D,right:e,left:z,up:N,down:m,front:B,back:g,format:5,type:h,gammaSpace:E};S(this.ConvertCubeMapToSphericalPolynomial(A))}))}))}static _AreaElement(S,v){return Math.atan2(S*v,Math.sqrt(S*S+v*v+1))}static ConvertCubeMapToSphericalPolynomial(S){const v=new N.d;let D=0;const z=2/S.size,g=z,E=.5*z,h=E-1;for(let N=0;N<6;N++){const A=this._FileFaces[N],w=S[A.name];let n=h;const R=5===S.format?4:3;for(let N=0;N<S.size;N++){let O=h;for(let g=0;g<S.size;g++){const h=A.worldAxisForFileX.scale(O).add(A.worldAxisForFileY.scale(n)).add(A.worldAxisForNormal);h.normalize();const I=this._AreaElement(O-E,n-E)-this._AreaElement(O-E,n+E)-this._AreaElement(O+E,n-E)+this._AreaElement(O+E,n+E);let K=w[N*S.size*R+g*R+0],q=w[N*S.size*R+g*R+1],u=w[N*S.size*R+g*R+2];isNaN(K)&&(K=0),isNaN(q)&&(q=0),isNaN(u)&&(u=0),0===S.type&&(K/=255,q/=255,u/=255),S.gammaSpace&&(K=Math.pow((0,e.Clamp)(K),m.m),q=Math.pow((0,e.Clamp)(q),m.m),u=Math.pow((0,e.Clamp)(u),m.m));const s=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const S=Math.max(K,q,u);if(S>s){const v=s/S;K*=v,q*=v,u*=v}}else K=(0,e.Clamp)(K,0,s),q=(0,e.Clamp)(q,0,s),u=(0,e.Clamp)(u,0,s);const r=new B.qv(K,q,u);v.addLight(h,r,I),D+=I,O+=z}n+=g}}const A=6*(4*Math.PI)/6/D;return v.scaleInPlace(A),v.convertIncidentRadianceToIrradiance(),v.convertIrradianceToLambertianRadiance(),N.g.FromHarmonics(v)}}E._FileFaces=[new g("right",new z.Rv(1,0,0),new z.Rv(0,0,-1),new z.Rv(0,-1,0)),new g("left",new z.Rv(-1,0,0),new z.Rv(0,0,1),new z.Rv(0,-1,0)),new g("up",new z.Rv(0,1,0),new z.Rv(1,0,0),new z.Rv(0,0,1)),new g("down",new z.Rv(0,-1,0),new z.Rv(1,0,0),new z.Rv(0,0,-1)),new g("front",new z.Rv(0,0,1),new z.Rv(1,0,0),new z.Rv(0,-1,0)),new g("back",new z.Rv(0,0,-1),new z.Rv(-1,0,0),new z.Rv(0,-1,0))],E.MAX_HDRI_VALUE=4096,E.PRESERVE_CLAMPED_COLORS=!1},13850:(S,v,D)=>{D.d(v,{DDSTools:()=>R});var z=D(11393),e=D(11190),N=D(11881),m=D(11607);D(13082);const B=131072,g=131072;function E(S){return S.charCodeAt(0)+(S.charCodeAt(1)<<8)+(S.charCodeAt(2)<<16)+(S.charCodeAt(3)<<24)}const h=E("DXT1"),A=E("DXT3"),w=E("DXT5"),n=E("DX10");class R{static GetDDSInfo(S){const v=new Int32Array(S.buffer,S.byteOffset,31),D=new Int32Array(S.buffer,S.byteOffset,35);let z=1;v[2]&B&&(z=Math.max(1,v[7]));const e=v[21],N=e===n?D[32]:0;let m=0;switch(e){case 113:m=2;break;case 116:m=1;break;case n:if(10===N){m=2;break}if(2===N){m=1;break}}return{width:v[4],height:v[3],mipmapCount:z,isFourCC:4===(4&v[20]),isRGB:64===(64&v[20]),isLuminance:(v[20]&g)===g,isCube:512===(512&v[28]),isCompressed:e===h||e===A||e===w,dxgiFormat:N,textureType:m}}static _GetHalfFloatAsFloatRGBAArrayBuffer(S,v,D,z,e,N){const B=new Float32Array(z),g=new Uint16Array(e,D);let E=0;for(let h=0;h<v;h++)for(let v=0;v<S;v++){const D=4*(v+h*S);B[E]=(0,m.g)(g[D]),B[E+1]=(0,m.g)(g[D+1]),B[E+2]=(0,m.g)(g[D+2]),R.StoreLODInAlphaChannel?B[E+3]=N:B[E+3]=(0,m.g)(g[D+3]),E+=4}return B}static _GetHalfFloatRGBAArrayBuffer(S,v,D,z,e,N){if(R.StoreLODInAlphaChannel){const B=new Uint16Array(z),g=new Uint16Array(e,D);let E=0;for(let D=0;D<v;D++)for(let v=0;v<S;v++){const z=4*(v+D*S);B[E]=g[z],B[E+1]=g[z+1],B[E+2]=g[z+2],B[E+3]=(0,m.n)(N),E+=4}return B}return new Uint16Array(e,D,z)}static _GetFloatRGBAArrayBuffer(S,v,D,z,e,N){if(R.StoreLODInAlphaChannel){const m=new Float32Array(z),B=new Float32Array(e,D);let g=0;for(let D=0;D<v;D++)for(let v=0;v<S;v++){const z=4*(v+D*S);m[g]=B[z],m[g+1]=B[z+1],m[g+2]=B[z+2],m[g+3]=N,g+=4}return m}return new Float32Array(e,D,z)}static _GetFloatAsHalfFloatRGBAArrayBuffer(S,v,D,z,e,N){const B=new Uint16Array(z),g=new Float32Array(e,D);let E=0;for(let h=0;h<v;h++)for(let v=0;v<S;v++)B[E]=(0,m.n)(g[E]),B[E+1]=(0,m.n)(g[E+1]),B[E+2]=(0,m.n)(g[E+2]),R.StoreLODInAlphaChannel?B[E+3]=(0,m.n)(N):B[E+3]=(0,m.n)(g[E+3]),E+=4;return B}static _GetFloatAsUIntRGBAArrayBuffer(S,v,D,e,N,m){const B=new Uint8Array(e),g=new Float32Array(N,D);let E=0;for(let h=0;h<v;h++)for(let v=0;v<S;v++){const D=4*(v+h*S);B[E]=255*(0,z.Clamp)(g[D]),B[E+1]=255*(0,z.Clamp)(g[D+1]),B[E+2]=255*(0,z.Clamp)(g[D+2]),R.StoreLODInAlphaChannel?B[E+3]=m:B[E+3]=255*(0,z.Clamp)(g[D+3]),E+=4}return B}static _GetHalfFloatAsUIntRGBAArrayBuffer(S,v,D,e,N,B){const g=new Uint8Array(e),E=new Uint16Array(N,D);let h=0;for(let A=0;A<v;A++)for(let v=0;v<S;v++){const D=4*(v+A*S);g[h]=255*(0,z.Clamp)((0,m.g)(E[D])),g[h+1]=255*(0,z.Clamp)((0,m.g)(E[D+1])),g[h+2]=255*(0,z.Clamp)((0,m.g)(E[D+2])),R.StoreLODInAlphaChannel?g[h+3]=B:g[h+3]=255*(0,z.Clamp)((0,m.g)(E[D+3])),h+=4}return g}static _GetRGBAArrayBuffer(S,v,D,z,e,N,m,B,g){const E=new Uint8Array(z),h=new Uint8Array(e,D);let A=0;for(let w=0;w<v;w++)for(let v=0;v<S;v++){const D=4*(v+w*S);E[A]=h[D+N],E[A+1]=h[D+m],E[A+2]=h[D+B],E[A+3]=h[D+g],A+=4}return E}static _ExtractLongWordOrder(S){return 0===S||255===S||-16777216===S?0:1+R._ExtractLongWordOrder(S>>8)}static _GetRGBArrayBuffer(S,v,D,z,e,N,m,B){const g=new Uint8Array(z),E=new Uint8Array(e,D);let h=0;for(let A=0;A<v;A++)for(let v=0;v<S;v++){const D=3*(v+A*S);g[h]=E[D+N],g[h+1]=E[D+m],g[h+2]=E[D+B],h+=3}return g}static _GetLuminanceArrayBuffer(S,v,D,z,e){const N=new Uint8Array(z),m=new Uint8Array(e,D);let B=0;for(let g=0;g<v;g++)for(let v=0;v<S;v++){const D=v+g*S;N[B]=m[D],B++}return N}static UploadDDSLevels(S,v,D,z,m,g){let E=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,O=arguments.length>7?arguments[7]:void 0,I=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],K=null;z.sphericalPolynomial&&(K=[]);const q=!!S.getCaps().s3tc;v.generateMipMaps=m;const u=new Int32Array(D.buffer,D.byteOffset,31);let s,r,d,x,W,p,b,k=0,Z=0,i=1;if(542327876!==u[0])return void e.b.Error("Invalid magic number in DDS header");if(!z.isFourCC&&!z.isRGB&&!z.isLuminance)return void e.b.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(z.isCompressed&&!q)return void e.b.Error("Compressed textures are not supported on this platform.");let t=u[22];x=u[1]+4;let X=!1;if(z.isFourCC)switch(s=u[21],s){case h:i=8,Z=33777;break;case A:i=16,Z=33778;break;case w:i=16,Z=33779;break;case 113:X=!0,t=64;break;case 116:X=!0,t=128;break;case n:{x+=20;let S=!1;switch(z.dxgiFormat){case 10:X=!0,t=64,S=!0;break;case 2:X=!0,t=128,S=!0;break;case 88:z.isRGB=!0,z.isFourCC=!1,t=32,S=!0}if(S)break}default:return void e.b.Error(["Unsupported FourCC code:",(a=s,String.fromCharCode(255&a,a>>8&255,a>>16&255,a>>24&255))])}var a;const o=R._ExtractLongWordOrder(u[23]),M=R._ExtractLongWordOrder(u[24]),c=R._ExtractLongWordOrder(u[25]),J=R._ExtractLongWordOrder(u[26]);X&&(Z=S._getRGBABufferInternalSizedFormat(z.textureType)),p=1,u[2]&B&&!1!==m&&(p=Math.max(1,u[7]));const H=O||0,T=S.getCaps();for(let e=H;e<g;e++){for(r=u[4],d=u[3],b=0;b<p;++b){if(-1===E||E===b){const N=-1===E?b:0;if(!z.isCompressed&&z.isFourCC){v.format=5,k=r*d*4;let z=null;if(S._badOS||S._badDesktopOS||!T.textureHalfFloat&&!T.textureFloat)128===t?(z=R._GetFloatAsUIntRGBAArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,N),K&&0==N&&K.push(R._GetFloatRGBAArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,N))):64===t&&(z=R._GetHalfFloatAsUIntRGBAArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,N),K&&0==N&&K.push(R._GetHalfFloatAsFloatRGBAArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,N))),v.type=0;else{const S=T.textureFloat&&(I&&T.textureFloatLinearFiltering||!I),e=T.textureHalfFloat&&(I&&T.textureHalfFloatLinearFiltering||!I),m=(128===t||64===t&&!e)&&S?1:(64===t||128===t&&!S)&&e?2:0;let B,g=null;if(128===t)switch(m){case 1:B=R._GetFloatRGBAArrayBuffer,g=null;break;case 2:B=R._GetFloatAsHalfFloatRGBAArrayBuffer,g=R._GetFloatRGBAArrayBuffer;break;case 0:B=R._GetFloatAsUIntRGBAArrayBuffer,g=R._GetFloatRGBAArrayBuffer}else switch(m){case 1:B=R._GetHalfFloatAsFloatRGBAArrayBuffer,g=null;break;case 2:B=R._GetHalfFloatRGBAArrayBuffer,g=R._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:B=R._GetHalfFloatAsUIntRGBAArrayBuffer,g=R._GetHalfFloatAsFloatRGBAArrayBuffer}v.type=m,z=B(r,d,D.byteOffset+x,k,D.buffer,N),K&&0==N&&K.push(g?g(r,d,D.byteOffset+x,k,D.buffer,N):z)}z&&S._uploadDataToTextureDirectly(v,z,e,N)}else if(z.isRGB)v.type=0,24===t?(v.format=4,k=r*d*3,W=R._GetRGBArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,o,M,c),S._uploadDataToTextureDirectly(v,W,e,N)):(v.format=5,k=r*d*4,W=R._GetRGBAArrayBuffer(r,d,D.byteOffset+x,k,D.buffer,o,M,c,J),S._uploadDataToTextureDirectly(v,W,e,N));else if(z.isLuminance){const z=S._getUnpackAlignement(),m=r;k=Math.floor((r+z-1)/z)*z*(d-1)+m,W=R._GetLuminanceArrayBuffer(r,d,D.byteOffset+x,k,D.buffer),v.format=1,v.type=0,S._uploadDataToTextureDirectly(v,W,e,N)}else k=Math.max(4,r)/4*Math.max(4,d)/4*i,W=new Uint8Array(D.buffer,D.byteOffset+x,k),v.type=0,S._uploadCompressedDataToTextureDirectly(v,Z,r,d,W,e,N)}x+=t?r*d*(t/8):k,r*=.5,d*=.5,r=Math.max(1,r),d=Math.max(1,d)}if(void 0!==O)break}K&&K.length>0?z.sphericalPolynomial=N.d.ConvertCubeMapToSphericalPolynomial({size:u[4],right:K[0],left:K[1],up:K[2],down:K[3],front:K[4],back:K[5],format:5,type:1,gammaSpace:!1}):z.sphericalPolynomial=void 0}}R.StoreLODInAlphaChannel=!1}}]);