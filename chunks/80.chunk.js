"use strict";(self.fjf2z1c8il8=self.fjf2z1c8il8||[]).push([[80],{15711:(g,i,a)=>{a.r(i),a.d(i,{FlowGraphStopAnimationBlock:()=>k});var n=a(14214),L=a(12415),d=a(12292),b=a(14265);class k extends b.d{constructor(g){super(g),this.animationGroup=this.registerDataInput("animationGroup",n.d),this.stopAtFrame=this.registerDataInput("stopAtFrame",n.q,-1)}_preparePendingTasks(g){const i=this.animationGroup.getValue(g),a=this.stopAtFrame.getValue(g)??-1,n=g._getGlobalContextVariable("pendingStopAnimations",[]);n.push({uniqueId:i.uniqueId,stopAtFrame:a}),g._setGlobalContextVariable("pendingStopAnimations",n)}_cancelPendingTasks(g){const i=this.animationGroup.getValue(g),a=g._getGlobalContextVariable("pendingStopAnimations",[]);for(let n=0;n<a.length;n++)if(a[n].uniqueId===i.uniqueId){a.splice(n,1),g._setGlobalContextVariable("pendingStopAnimations",a);break}}_execute(g){const i=this.animationGroup.getValue(g),a=this.stopAtFrame.getValue(g)??-1;return i?isNaN(a)?this._reportError(g,"Invalid stop time."):(a>0?this._startPendingTasks(g):this._stopAnimation(i,g),void this.out._activateSignal(g)):(d.b.Warn("No animation group provided to stop."),this._reportError(g,"No animation group provided to stop."))}_executeOnTick(g){const i=this.animationGroup.getValue(g),a=g._getGlobalContextVariable("pendingStopAnimations",[]);for(let n=0;n<a.length;n++)if(a[n].uniqueId===i.uniqueId&&i.getCurrentFrame()>=a[n].stopAtFrame){this._stopAnimation(i,g),a.splice(n,1),g._setGlobalContextVariable("pendingStopAnimations",a),this.done._activateSignal(g),g._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(g,i){const a=i._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),n=a.indexOf(g.uniqueId);-1!==n&&(g.stop(),a.splice(n,1),i._setGlobalContextVariable("currentlyRunningAnimationGroups",a))}}(0,L.e)("FlowGraphStopAnimationBlock",k)}}]);