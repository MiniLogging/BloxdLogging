"use strict";(self.wx5iyvo7rvn=self.wx5iyvo7rvn||[]).push([[80],{14233:(P,e,n)=>{n.r(e),n.d(e,{FlowGraphStopAnimationBlock:()=>m});var H=n(12819),S=n(11096),p=n(10988),k=n(12857);class m extends k.b{constructor(P){super(P),this.animationGroup=this.registerDataInput("animationGroup",H.b),this.stopAtFrame=this.registerDataInput("stopAtFrame",H.r,-1)}_preparePendingTasks(P){const e=this.animationGroup.getValue(P),n=this.stopAtFrame.getValue(P)??-1,H=P._getGlobalContextVariable("pendingStopAnimations",[]);H.push({uniqueId:e.uniqueId,stopAtFrame:n}),P._setGlobalContextVariable("pendingStopAnimations",H)}_cancelPendingTasks(P){const e=this.animationGroup.getValue(P),n=P._getGlobalContextVariable("pendingStopAnimations",[]);for(let H=0;H<n.length;H++)if(n[H].uniqueId===e.uniqueId){n.splice(H,1),P._setGlobalContextVariable("pendingStopAnimations",n);break}}_execute(P){const e=this.animationGroup.getValue(P),n=this.stopAtFrame.getValue(P)??-1;return e?isNaN(n)?this._reportError(P,"Invalid stop time."):(n>0?this._startPendingTasks(P):this._stopAnimation(e,P),void this.out._activateSignal(P)):(p.c.Warn("No animation group provided to stop."),this._reportError(P,"No animation group provided to stop."))}_executeOnTick(P){const e=this.animationGroup.getValue(P),n=P._getGlobalContextVariable("pendingStopAnimations",[]);for(let H=0;H<n.length;H++)if(n[H].uniqueId===e.uniqueId&&e.getCurrentFrame()>=n[H].stopAtFrame){this._stopAnimation(e,P),n.splice(H,1),P._setGlobalContextVariable("pendingStopAnimations",n),this.done._activateSignal(P),P._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(P,e){const n=e._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),H=n.indexOf(P.uniqueId);-1!==H&&(P.stop(),n.splice(H,1),e._setGlobalContextVariable("currentlyRunningAnimationGroups",n))}}(0,S.h)("FlowGraphStopAnimationBlock",m)}}]);