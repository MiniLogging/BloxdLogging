"use strict";(self.ksd6jhs1yr=self.ksd6jhs1yr||[]).push([[80],{15571:(C,c,d)=>{d.r(c),d.d(c,{FlowGraphStopAnimationBlock:()=>R});var b=d(14126),X=d(12345),P=d(12233),V=d(14178);class R extends V.c{constructor(C){super(C),this.animationGroup=this.registerDataInput("animationGroup",b.b),this.stopAtFrame=this.registerDataInput("stopAtFrame",b.q,-1)}_preparePendingTasks(C){const c=this.animationGroup.getValue(C),d=this.stopAtFrame.getValue(C)??-1,b=C._getGlobalContextVariable("pendingStopAnimations",[]);b.push({uniqueId:c.uniqueId,stopAtFrame:d}),C._setGlobalContextVariable("pendingStopAnimations",b)}_cancelPendingTasks(C){const c=this.animationGroup.getValue(C),d=C._getGlobalContextVariable("pendingStopAnimations",[]);for(let b=0;b<d.length;b++)if(d[b].uniqueId===c.uniqueId){d.splice(b,1),C._setGlobalContextVariable("pendingStopAnimations",d);break}}_execute(C){const c=this.animationGroup.getValue(C),d=this.stopAtFrame.getValue(C)??-1;return c?isNaN(d)?this._reportError(C,"Invalid stop time."):(d>0?this._startPendingTasks(C):this._stopAnimation(c,C),void this.out._activateSignal(C)):(P.d.Warn("No animation group provided to stop."),this._reportError(C,"No animation group provided to stop."))}_executeOnTick(C){const c=this.animationGroup.getValue(C),d=C._getGlobalContextVariable("pendingStopAnimations",[]);for(let b=0;b<d.length;b++)if(d[b].uniqueId===c.uniqueId&&c.getCurrentFrame()>=d[b].stopAtFrame){this._stopAnimation(c,C),d.splice(b,1),C._setGlobalContextVariable("pendingStopAnimations",d),this.done._activateSignal(C),C._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(C,c){const d=c._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),b=d.indexOf(C.uniqueId);-1!==b&&(C.stop(),d.splice(b,1),c._setGlobalContextVariable("currentlyRunningAnimationGroups",d))}}(0,X.e)("FlowGraphStopAnimationBlock",R)}}]);