"use strict";(self.b15p7b72fr8=self.b15p7b72fr8||[]).push([[80],{15805:(s,k,h)=>{h.r(k),h.d(k,{FlowGraphStopAnimationBlock:()=>K});var A=h(14315),g=h(12543),ms=h(12422),i=h(14344);class K extends i.b{constructor(s){super(s),this.animationGroup=this.registerDataInput("animationGroup",A.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",A.m,-1)}_preparePendingTasks(s){const k=this.animationGroup.getValue(s),h=this.stopAtFrame.getValue(s)??-1,A=s._getGlobalContextVariable("pendingStopAnimations",[]);A.push({uniqueId:k.uniqueId,stopAtFrame:h}),s._setGlobalContextVariable("pendingStopAnimations",A)}_cancelPendingTasks(s){const k=this.animationGroup.getValue(s),h=s._getGlobalContextVariable("pendingStopAnimations",[]);for(let A=0;A<h.length;A++)if(h[A].uniqueId===k.uniqueId){h.splice(A,1),s._setGlobalContextVariable("pendingStopAnimations",h);break}}_execute(s){const k=this.animationGroup.getValue(s),h=this.stopAtFrame.getValue(s)??-1;return k?isNaN(h)?this._reportError(s,"Invalid stop time."):(h>0?this._startPendingTasks(s):this._stopAnimation(k,s),void this.out._activateSignal(s)):(ms.c.Warn("No animation group provided to stop."),this._reportError(s,"No animation group provided to stop."))}_executeOnTick(s){const k=this.animationGroup.getValue(s),h=s._getGlobalContextVariable("pendingStopAnimations",[]);for(let A=0;A<h.length;A++)if(h[A].uniqueId===k.uniqueId&&k.getCurrentFrame()>=h[A].stopAtFrame){this._stopAnimation(k,s),h.splice(A,1),s._setGlobalContextVariable("pendingStopAnimations",h),this.done._activateSignal(s),s._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(s,k){const h=k._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),A=h.indexOf(s.uniqueId);-1!==A&&(s.stop(),h.splice(A,1),k._setGlobalContextVariable("currentlyRunningAnimationGroups",h))}}(0,g.f)("FlowGraphStopAnimationBlock",K)}}]);