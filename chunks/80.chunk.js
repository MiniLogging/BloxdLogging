"use strict";(self.ipz2em9uj1g=self.ipz2em9uj1g||[]).push([[80],{15823:(r,O,W)=>{W.r(O),W.d(O,{FlowGraphStopAnimationBlock:()=>h});var q=W(14274),Q=W(12560),C=W(12453),T=W(14319);class h extends T.c{constructor(r){super(r),this.animationGroup=this.registerDataInput("animationGroup",q.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",q.r,-1)}_preparePendingTasks(r){const O=this.animationGroup.getValue(r),W=this.stopAtFrame.getValue(r)??-1,q=r._getGlobalContextVariable("pendingStopAnimations",[]);q.push({uniqueId:O.uniqueId,stopAtFrame:W}),r._setGlobalContextVariable("pendingStopAnimations",q)}_cancelPendingTasks(r){const O=this.animationGroup.getValue(r),W=r._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<W.length;q++)if(W[q].uniqueId===O.uniqueId){W.splice(q,1),r._setGlobalContextVariable("pendingStopAnimations",W);break}}_execute(r){const O=this.animationGroup.getValue(r),W=this.stopAtFrame.getValue(r)??-1;return O?isNaN(W)?this._reportError(r,"Invalid stop time."):(W>0?this._startPendingTasks(r):this._stopAnimation(O,r),void this.out._activateSignal(r)):(C.b.Warn("No animation group provided to stop."),this._reportError(r,"No animation group provided to stop."))}_executeOnTick(r){const O=this.animationGroup.getValue(r),W=r._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<W.length;q++)if(W[q].uniqueId===O.uniqueId&&O.getCurrentFrame()>=W[q].stopAtFrame){this._stopAnimation(O,r),W.splice(q,1),r._setGlobalContextVariable("pendingStopAnimations",W),this.done._activateSignal(r),r._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(r,O){const W=O._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),q=W.indexOf(r.uniqueId);-1!==q&&(r.stop(),W.splice(q,1),O._setGlobalContextVariable("currentlyRunningAnimationGroups",W))}}(0,Q.e)("FlowGraphStopAnimationBlock",h)}}]);