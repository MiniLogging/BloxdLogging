"use strict";(self.u4k1rqylno=self.u4k1rqylno||[]).push([[80],{14848:(e,E,H)=>{H.r(E),H.d(E,{FlowGraphStopAnimationBlock:()=>M});var N=H(13415),u=H(11690),z=H(11548),P=H(13467);class M extends P.b{constructor(e){super(e),this.animationGroup=this.registerDataInput("animationGroup",N.b),this.stopAtFrame=this.registerDataInput("stopAtFrame",N.t,-1)}_preparePendingTasks(e){const E=this.animationGroup.getValue(e),H=this.stopAtFrame.getValue(e)??-1,N=e._getGlobalContextVariable("pendingStopAnimations",[]);N.push({uniqueId:E.uniqueId,stopAtFrame:H}),e._setGlobalContextVariable("pendingStopAnimations",N)}_cancelPendingTasks(e){const E=this.animationGroup.getValue(e),H=e._getGlobalContextVariable("pendingStopAnimations",[]);for(let N=0;N<H.length;N++)if(H[N].uniqueId===E.uniqueId){H.splice(N,1),e._setGlobalContextVariable("pendingStopAnimations",H);break}}_execute(e){const E=this.animationGroup.getValue(e),H=this.stopAtFrame.getValue(e)??-1;return E?isNaN(H)?this._reportError(e,"Invalid stop time."):(H>0?this._startPendingTasks(e):this._stopAnimation(E,e),void this.out._activateSignal(e)):(z.d.Warn("No animation group provided to stop."),this._reportError(e,"No animation group provided to stop."))}_executeOnTick(e){const E=this.animationGroup.getValue(e),H=e._getGlobalContextVariable("pendingStopAnimations",[]);for(let N=0;N<H.length;N++)if(H[N].uniqueId===E.uniqueId&&E.getCurrentFrame()>=H[N].stopAtFrame){this._stopAnimation(E,e),H.splice(N,1),e._setGlobalContextVariable("pendingStopAnimations",H),this.done._activateSignal(e),e._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(e,E){const H=E._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),N=H.indexOf(e.uniqueId);-1!==N&&(e.stop(),H.splice(N,1),E._setGlobalContextVariable("currentlyRunningAnimationGroups",H))}}(0,u.g)("FlowGraphStopAnimationBlock",M)}}]);