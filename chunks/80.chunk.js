"use strict";(self.fyqbdzs5tyo=self.fyqbdzs5tyo||[]).push([[80],{14314:(V,I,A)=>{A.r(I),A.d(I,{FlowGraphStopAnimationBlock:()=>H});var B=A(12954),F=A(11189),E=A(11064),Y=A(13003);class H extends Y.c{constructor(V){super(V),this.animationGroup=this.registerDataInput("animationGroup",B.e),this.stopAtFrame=this.registerDataInput("stopAtFrame",B.v,-1)}_preparePendingTasks(V){const I=this.animationGroup.getValue(V),A=this.stopAtFrame.getValue(V)??-1,B=V._getGlobalContextVariable("pendingStopAnimations",[]);B.push({uniqueId:I.uniqueId,stopAtFrame:A}),V._setGlobalContextVariable("pendingStopAnimations",B)}_cancelPendingTasks(V){const I=this.animationGroup.getValue(V),A=V._getGlobalContextVariable("pendingStopAnimations",[]);for(let B=0;B<A.length;B++)if(A[B].uniqueId===I.uniqueId){A.splice(B,1),V._setGlobalContextVariable("pendingStopAnimations",A);break}}_execute(V){const I=this.animationGroup.getValue(V),A=this.stopAtFrame.getValue(V)??-1;return I?isNaN(A)?this._reportError(V,"Invalid stop time."):(A>0?this._startPendingTasks(V):this._stopAnimation(I,V),void this.out._activateSignal(V)):(E.b.Warn("No animation group provided to stop."),this._reportError(V,"No animation group provided to stop."))}_executeOnTick(V){const I=this.animationGroup.getValue(V),A=V._getGlobalContextVariable("pendingStopAnimations",[]);for(let B=0;B<A.length;B++)if(A[B].uniqueId===I.uniqueId&&I.getCurrentFrame()>=A[B].stopAtFrame){this._stopAnimation(I,V),A.splice(B,1),V._setGlobalContextVariable("pendingStopAnimations",A),this.done._activateSignal(V),V._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(V,I){const A=I._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),B=A.indexOf(V.uniqueId);-1!==B&&(V.stop(),A.splice(B,1),I._setGlobalContextVariable("currentlyRunningAnimationGroups",A))}}(0,F.e)("FlowGraphStopAnimationBlock",H)}}]);