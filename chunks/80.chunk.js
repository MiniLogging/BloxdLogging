"use strict";(self.v2pspxy442l=self.v2pspxy442l||[]).push([[80],{15606:(l,a,N)=>{N.r(a),N.d(a,{FlowGraphStopAnimationBlock:()=>w});var U=N(14145),c=N(12394),K=N(12268),Z=N(14192);class w extends Z.b{constructor(l){super(l),this.animationGroup=this.registerDataInput("animationGroup",U.d),this.stopAtFrame=this.registerDataInput("stopAtFrame",U.t,-1)}_preparePendingTasks(l){const a=this.animationGroup.getValue(l),N=this.stopAtFrame.getValue(l)??-1,U=l._getGlobalContextVariable("pendingStopAnimations",[]);U.push({uniqueId:a.uniqueId,stopAtFrame:N}),l._setGlobalContextVariable("pendingStopAnimations",U)}_cancelPendingTasks(l){const a=this.animationGroup.getValue(l),N=l._getGlobalContextVariable("pendingStopAnimations",[]);for(let U=0;U<N.length;U++)if(N[U].uniqueId===a.uniqueId){N.splice(U,1),l._setGlobalContextVariable("pendingStopAnimations",N);break}}_execute(l){const a=this.animationGroup.getValue(l),N=this.stopAtFrame.getValue(l)??-1;return a?isNaN(N)?this._reportError(l,"Invalid stop time."):(N>0?this._startPendingTasks(l):this._stopAnimation(a,l),void this.out._activateSignal(l)):(K.b.Warn("No animation group provided to stop."),this._reportError(l,"No animation group provided to stop."))}_executeOnTick(l){const a=this.animationGroup.getValue(l),N=l._getGlobalContextVariable("pendingStopAnimations",[]);for(let U=0;U<N.length;U++)if(N[U].uniqueId===a.uniqueId&&a.getCurrentFrame()>=N[U].stopAtFrame){this._stopAnimation(a,l),N.splice(U,1),l._setGlobalContextVariable("pendingStopAnimations",N),this.done._activateSignal(l),l._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(l,a){const N=a._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),U=N.indexOf(l.uniqueId);-1!==U&&(l.stop(),N.splice(U,1),a._setGlobalContextVariable("currentlyRunningAnimationGroups",N))}}(0,c.g)("FlowGraphStopAnimationBlock",w)}}]);