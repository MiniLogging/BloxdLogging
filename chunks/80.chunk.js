"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[80],{14320:(h,V,i)=>{i.r(V),i.d(V,{FlowGraphStopAnimationBlock:()=>q});var S=i(12805),l=i(11091),Y=i(10967),g=i(12855);class q extends g.e{constructor(h){super(h),this.animationGroup=this.registerDataInput("animationGroup",S.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",S.u,-1)}_preparePendingTasks(h){const V=this.animationGroup.getValue(h),i=this.stopAtFrame.getValue(h)??-1,S=h._getGlobalContextVariable("pendingStopAnimations",[]);S.push({uniqueId:V.uniqueId,stopAtFrame:i}),h._setGlobalContextVariable("pendingStopAnimations",S)}_cancelPendingTasks(h){const V=this.animationGroup.getValue(h),i=h._getGlobalContextVariable("pendingStopAnimations",[]);for(let S=0;S<i.length;S++)if(i[S].uniqueId===V.uniqueId){i.splice(S,1),h._setGlobalContextVariable("pendingStopAnimations",i);break}}_execute(h){const V=this.animationGroup.getValue(h),i=this.stopAtFrame.getValue(h)??-1;return V?isNaN(i)?this._reportError(h,"Invalid stop time."):(i>0?this._startPendingTasks(h):this._stopAnimation(V,h),void this.out._activateSignal(h)):(Y.d.Warn("No animation group provided to stop."),this._reportError(h,"No animation group provided to stop."))}_executeOnTick(h){const V=this.animationGroup.getValue(h),i=h._getGlobalContextVariable("pendingStopAnimations",[]);for(let S=0;S<i.length;S++)if(i[S].uniqueId===V.uniqueId&&V.getCurrentFrame()>=i[S].stopAtFrame){this._stopAnimation(V,h),i.splice(S,1),h._setGlobalContextVariable("pendingStopAnimations",i),this.done._activateSignal(h),h._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(h,V){const i=V._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),S=i.indexOf(h.uniqueId);-1!==S&&(h.stop(),i.splice(S,1),V._setGlobalContextVariable("currentlyRunningAnimationGroups",i))}}(0,l.f)("FlowGraphStopAnimationBlock",q)}}]);