"use strict";(self.zcqpiao938m=self.zcqpiao938m||[]).push([[80],{14950:(C,U,K)=>{K.r(U),K.d(U,{FlowGraphStopAnimationBlock:()=>e});var m=K(13514),O=K(11789),X=K(11679),A=K(13559);class e extends A.c{constructor(C){super(C),this.animationGroup=this.registerDataInput("animationGroup",m.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",m.w,-1)}_preparePendingTasks(C){const U=this.animationGroup.getValue(C),K=this.stopAtFrame.getValue(C)??-1,m=C._getGlobalContextVariable("pendingStopAnimations",[]);m.push({uniqueId:U.uniqueId,stopAtFrame:K}),C._setGlobalContextVariable("pendingStopAnimations",m)}_cancelPendingTasks(C){const U=this.animationGroup.getValue(C),K=C._getGlobalContextVariable("pendingStopAnimations",[]);for(let m=0;m<K.length;m++)if(K[m].uniqueId===U.uniqueId){K.splice(m,1),C._setGlobalContextVariable("pendingStopAnimations",K);break}}_execute(C){const U=this.animationGroup.getValue(C),K=this.stopAtFrame.getValue(C)??-1;return U?isNaN(K)?this._reportError(C,"Invalid stop time."):(K>0?this._startPendingTasks(C):this._stopAnimation(U,C),void this.out._activateSignal(C)):(X.d.Warn("No animation group provided to stop."),this._reportError(C,"No animation group provided to stop."))}_executeOnTick(C){const U=this.animationGroup.getValue(C),K=C._getGlobalContextVariable("pendingStopAnimations",[]);for(let m=0;m<K.length;m++)if(K[m].uniqueId===U.uniqueId&&U.getCurrentFrame()>=K[m].stopAtFrame){this._stopAnimation(U,C),K.splice(m,1),C._setGlobalContextVariable("pendingStopAnimations",K),this.done._activateSignal(C),C._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(C,U){const K=U._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),m=K.indexOf(C.uniqueId);-1!==m&&(C.stop(),K.splice(m,1),U._setGlobalContextVariable("currentlyRunningAnimationGroups",K))}}(0,O.h)("FlowGraphStopAnimationBlock",e)}}]);