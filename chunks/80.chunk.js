"use strict";(self["80dd64vgxnn"]=self["80dd64vgxnn"]||[]).push([[80],{15757:(mm,o,u)=>{u.r(o),u.d(o,{FlowGraphStopAnimationBlock:()=>w});var f=u(14257),B=u(12702),O=u(12565),r=u(14299);class w extends r.c{constructor(mm){super(mm),this.animationGroup=this.registerDataInput("animationGroup",f.b),this.stopAtFrame=this.registerDataInput("stopAtFrame",f.r,-1)}_preparePendingTasks(mm){const o=this.animationGroup.getValue(mm),u=this.stopAtFrame.getValue(mm)??-1,f=mm._getGlobalContextVariable("pendingStopAnimations",[]);f.push({uniqueId:o.uniqueId,stopAtFrame:u}),mm._setGlobalContextVariable("pendingStopAnimations",f)}_cancelPendingTasks(mm){const o=this.animationGroup.getValue(mm),u=mm._getGlobalContextVariable("pendingStopAnimations",[]);for(let f=0;f<u.length;f++)if(u[f].uniqueId===o.uniqueId){u.splice(f,1),mm._setGlobalContextVariable("pendingStopAnimations",u);break}}_execute(mm){const o=this.animationGroup.getValue(mm),u=this.stopAtFrame.getValue(mm)??-1;return o?isNaN(u)?this._reportError(mm,"Invalid stop time."):(u>0?this._startPendingTasks(mm):this._stopAnimation(o,mm),void this.out._activateSignal(mm)):(O.e.Warn("No animation group provided to stop."),this._reportError(mm,"No animation group provided to stop."))}_executeOnTick(mm){const o=this.animationGroup.getValue(mm),u=mm._getGlobalContextVariable("pendingStopAnimations",[]);for(let f=0;f<u.length;f++)if(u[f].uniqueId===o.uniqueId&&o.getCurrentFrame()>=u[f].stopAtFrame){this._stopAnimation(o,mm),u.splice(f,1),mm._setGlobalContextVariable("pendingStopAnimations",u),this.done._activateSignal(mm),mm._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(mm,o){const u=o._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),f=u.indexOf(mm.uniqueId);-1!==f&&(mm.stop(),u.splice(f,1),o._setGlobalContextVariable("currentlyRunningAnimationGroups",u))}}(0,B.c)("FlowGraphStopAnimationBlock",w)}}]);