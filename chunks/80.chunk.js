"use strict";(self.vfdo5lmva5i=self.vfdo5lmva5i||[]).push([[80],{14992:(w,o,H)=>{H.r(o),H.d(o,{FlowGraphStopAnimationBlock:()=>t});var h=H(13455),E=H(11666),e=H(11551),D=H(13500);class t extends D.d{constructor(w){super(w),this.animationGroup=this.registerDataInput("animationGroup",h.e),this.stopAtFrame=this.registerDataInput("stopAtFrame",h.p,-1)}_preparePendingTasks(w){const o=this.animationGroup.getValue(w),H=this.stopAtFrame.getValue(w)??-1,h=w._getGlobalContextVariable("pendingStopAnimations",[]);h.push({uniqueId:o.uniqueId,stopAtFrame:H}),w._setGlobalContextVariable("pendingStopAnimations",h)}_cancelPendingTasks(w){const o=this.animationGroup.getValue(w),H=w._getGlobalContextVariable("pendingStopAnimations",[]);for(let h=0;h<H.length;h++)if(H[h].uniqueId===o.uniqueId){H.splice(h,1),w._setGlobalContextVariable("pendingStopAnimations",H);break}}_execute(w){const o=this.animationGroup.getValue(w),H=this.stopAtFrame.getValue(w)??-1;return o?isNaN(H)?this._reportError(w,"Invalid stop time."):(H>0?this._startPendingTasks(w):this._stopAnimation(o,w),void this.out._activateSignal(w)):(e.d.Warn("No animation group provided to stop."),this._reportError(w,"No animation group provided to stop."))}_executeOnTick(w){const o=this.animationGroup.getValue(w),H=w._getGlobalContextVariable("pendingStopAnimations",[]);for(let h=0;h<H.length;h++)if(H[h].uniqueId===o.uniqueId&&o.getCurrentFrame()>=H[h].stopAtFrame){this._stopAnimation(o,w),H.splice(h,1),w._setGlobalContextVariable("pendingStopAnimations",H),this.done._activateSignal(w),w._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(w,o){const H=o._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),h=H.indexOf(w.uniqueId);-1!==h&&(w.stop(),H.splice(h,1),o._setGlobalContextVariable("currentlyRunningAnimationGroups",H))}}(0,E.g)("FlowGraphStopAnimationBlock",t)}}]);