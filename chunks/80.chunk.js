"use strict";(self["9jl1vn4ei5r"]=self["9jl1vn4ei5r"]||[]).push([[80],{14929:(M,p,b)=>{b.r(p),b.d(p,{FlowGraphStopAnimationBlock:()=>u});var Q=b(13477),q=b(11757),B=b(11637),k=b(13516);class u extends k.b{constructor(M){super(M),this.animationGroup=this.registerDataInput("animationGroup",Q.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",Q.q,-1)}_preparePendingTasks(M){const p=this.animationGroup.getValue(M),b=this.stopAtFrame.getValue(M)??-1,Q=M._getGlobalContextVariable("pendingStopAnimations",[]);Q.push({uniqueId:p.uniqueId,stopAtFrame:b}),M._setGlobalContextVariable("pendingStopAnimations",Q)}_cancelPendingTasks(M){const p=this.animationGroup.getValue(M),b=M._getGlobalContextVariable("pendingStopAnimations",[]);for(let Q=0;Q<b.length;Q++)if(b[Q].uniqueId===p.uniqueId){b.splice(Q,1),M._setGlobalContextVariable("pendingStopAnimations",b);break}}_execute(M){const p=this.animationGroup.getValue(M),b=this.stopAtFrame.getValue(M)??-1;return p?isNaN(b)?this._reportError(M,"Invalid stop time."):(b>0?this._startPendingTasks(M):this._stopAnimation(p,M),void this.out._activateSignal(M)):(B.c.Warn("No animation group provided to stop."),this._reportError(M,"No animation group provided to stop."))}_executeOnTick(M){const p=this.animationGroup.getValue(M),b=M._getGlobalContextVariable("pendingStopAnimations",[]);for(let Q=0;Q<b.length;Q++)if(b[Q].uniqueId===p.uniqueId&&p.getCurrentFrame()>=b[Q].stopAtFrame){this._stopAnimation(p,M),b.splice(Q,1),M._setGlobalContextVariable("pendingStopAnimations",b),this.done._activateSignal(M),M._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(M,p){const b=p._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),Q=b.indexOf(M.uniqueId);-1!==Q&&(M.stop(),b.splice(Q,1),p._setGlobalContextVariable("currentlyRunningAnimationGroups",b))}}(0,q.g)("FlowGraphStopAnimationBlock",u)}}]);