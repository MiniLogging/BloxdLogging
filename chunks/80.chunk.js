"use strict";(self.g111kvdsqxc=self.g111kvdsqxc||[]).push([[80],{14433:(K,H,M)=>{M.r(H),M.d(H,{FlowGraphStopAnimationBlock:()=>h});var q=M(13004),w=M(11242),u=M(11112),y=M(13045);class h extends y.c{constructor(K){super(K),this.animationGroup=this.registerDataInput("animationGroup",q.d),this.stopAtFrame=this.registerDataInput("stopAtFrame",q.x,-1)}_preparePendingTasks(K){const H=this.animationGroup.getValue(K),M=this.stopAtFrame.getValue(K)??-1,q=K._getGlobalContextVariable("pendingStopAnimations",[]);q.push({uniqueId:H.uniqueId,stopAtFrame:M}),K._setGlobalContextVariable("pendingStopAnimations",q)}_cancelPendingTasks(K){const H=this.animationGroup.getValue(K),M=K._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<M.length;q++)if(M[q].uniqueId===H.uniqueId){M.splice(q,1),K._setGlobalContextVariable("pendingStopAnimations",M);break}}_execute(K){const H=this.animationGroup.getValue(K),M=this.stopAtFrame.getValue(K)??-1;return H?isNaN(M)?this._reportError(K,"Invalid stop time."):(M>0?this._startPendingTasks(K):this._stopAnimation(H,K),void this.out._activateSignal(K)):(u.e.Warn("No animation group provided to stop."),this._reportError(K,"No animation group provided to stop."))}_executeOnTick(K){const H=this.animationGroup.getValue(K),M=K._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<M.length;q++)if(M[q].uniqueId===H.uniqueId&&H.getCurrentFrame()>=M[q].stopAtFrame){this._stopAnimation(H,K),M.splice(q,1),K._setGlobalContextVariable("pendingStopAnimations",M),this.done._activateSignal(K),K._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(K,H){const M=H._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),q=M.indexOf(K.uniqueId);-1!==q&&(K.stop(),M.splice(q,1),H._setGlobalContextVariable("currentlyRunningAnimationGroups",M))}}(0,w.f)("FlowGraphStopAnimationBlock",h)}}]);