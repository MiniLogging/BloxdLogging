"use strict";(self["3nlrbof8msu"]=self["3nlrbof8msu"]||[]).push([[80],{15909:(t,b,Z)=>{Z.r(b),Z.d(b,{FlowGraphStopAnimationBlock:()=>h});var J=Z(14405),S=Z(12688),P=Z(12557),v=Z(14458);class h extends v.c{constructor(t){super(t),this.animationGroup=this.registerDataInput("animationGroup",J.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",J.q,-1)}_preparePendingTasks(t){const b=this.animationGroup.getValue(t),Z=this.stopAtFrame.getValue(t)??-1,J=t._getGlobalContextVariable("pendingStopAnimations",[]);J.push({uniqueId:b.uniqueId,stopAtFrame:Z}),t._setGlobalContextVariable("pendingStopAnimations",J)}_cancelPendingTasks(t){const b=this.animationGroup.getValue(t),Z=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let J=0;J<Z.length;J++)if(Z[J].uniqueId===b.uniqueId){Z.splice(J,1),t._setGlobalContextVariable("pendingStopAnimations",Z);break}}_execute(t){const b=this.animationGroup.getValue(t),Z=this.stopAtFrame.getValue(t)??-1;return b?isNaN(Z)?this._reportError(t,"Invalid stop time."):(Z>0?this._startPendingTasks(t):this._stopAnimation(b,t),void this.out._activateSignal(t)):(P.c.Warn("No animation group provided to stop."),this._reportError(t,"No animation group provided to stop."))}_executeOnTick(t){const b=this.animationGroup.getValue(t),Z=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let J=0;J<Z.length;J++)if(Z[J].uniqueId===b.uniqueId&&b.getCurrentFrame()>=Z[J].stopAtFrame){this._stopAnimation(b,t),Z.splice(J,1),t._setGlobalContextVariable("pendingStopAnimations",Z),this.done._activateSignal(t),t._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(t,b){const Z=b._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),J=Z.indexOf(t.uniqueId);-1!==J&&(t.stop(),Z.splice(J,1),b._setGlobalContextVariable("currentlyRunningAnimationGroups",Z))}}(0,S.f)("FlowGraphStopAnimationBlock",h)}}]);