"use strict";(self.ufnpnb83drd=self.ufnpnb83drd||[]).push([[80],{15538:(E,U,g)=>{g.r(U),g.d(U,{FlowGraphStopAnimationBlock:()=>u});var N=g(14058),L=g(12292),D=g(12186),S=g(14094);class u extends S.e{constructor(E){super(E),this.animationGroup=this.registerDataInput("animationGroup",N.e),this.stopAtFrame=this.registerDataInput("stopAtFrame",N.t,-1)}_preparePendingTasks(E){const U=this.animationGroup.getValue(E),g=this.stopAtFrame.getValue(E)??-1,N=E._getGlobalContextVariable("pendingStopAnimations",[]);N.push({uniqueId:U.uniqueId,stopAtFrame:g}),E._setGlobalContextVariable("pendingStopAnimations",N)}_cancelPendingTasks(E){const U=this.animationGroup.getValue(E),g=E._getGlobalContextVariable("pendingStopAnimations",[]);for(let N=0;N<g.length;N++)if(g[N].uniqueId===U.uniqueId){g.splice(N,1),E._setGlobalContextVariable("pendingStopAnimations",g);break}}_execute(E){const U=this.animationGroup.getValue(E),g=this.stopAtFrame.getValue(E)??-1;return U?isNaN(g)?this._reportError(E,"Invalid stop time."):(g>0?this._startPendingTasks(E):this._stopAnimation(U,E),void this.out._activateSignal(E)):(D.d.Warn("No animation group provided to stop."),this._reportError(E,"No animation group provided to stop."))}_executeOnTick(E){const U=this.animationGroup.getValue(E),g=E._getGlobalContextVariable("pendingStopAnimations",[]);for(let N=0;N<g.length;N++)if(g[N].uniqueId===U.uniqueId&&U.getCurrentFrame()>=g[N].stopAtFrame){this._stopAnimation(U,E),g.splice(N,1),E._setGlobalContextVariable("pendingStopAnimations",g),this.done._activateSignal(E),E._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(E,U){const g=U._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),N=g.indexOf(E.uniqueId);-1!==N&&(E.stop(),g.splice(N,1),U._setGlobalContextVariable("currentlyRunningAnimationGroups",g))}}(0,L.f)("FlowGraphStopAnimationBlock",u)}}]);