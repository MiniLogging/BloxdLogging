"use strict";(self.bjbkv7h3qsd=self.bjbkv7h3qsd||[]).push([[80],{14393:(G,A,j)=>{j.r(A),j.d(A,{FlowGraphStopAnimationBlock:()=>s});var u=j(12880),k=j(11181),B=j(11065),x=j(12920);class s extends x.d{constructor(G){super(G),this.animationGroup=this.registerDataInput("animationGroup",u.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",u.s,-1)}_preparePendingTasks(G){const A=this.animationGroup.getValue(G),j=this.stopAtFrame.getValue(G)??-1,u=G._getGlobalContextVariable("pendingStopAnimations",[]);u.push({uniqueId:A.uniqueId,stopAtFrame:j}),G._setGlobalContextVariable("pendingStopAnimations",u)}_cancelPendingTasks(G){const A=this.animationGroup.getValue(G),j=G._getGlobalContextVariable("pendingStopAnimations",[]);for(let u=0;u<j.length;u++)if(j[u].uniqueId===A.uniqueId){j.splice(u,1),G._setGlobalContextVariable("pendingStopAnimations",j);break}}_execute(G){const A=this.animationGroup.getValue(G),j=this.stopAtFrame.getValue(G)??-1;return A?isNaN(j)?this._reportError(G,"Invalid stop time."):(j>0?this._startPendingTasks(G):this._stopAnimation(A,G),void this.out._activateSignal(G)):(B.e.Warn("No animation group provided to stop."),this._reportError(G,"No animation group provided to stop."))}_executeOnTick(G){const A=this.animationGroup.getValue(G),j=G._getGlobalContextVariable("pendingStopAnimations",[]);for(let u=0;u<j.length;u++)if(j[u].uniqueId===A.uniqueId&&A.getCurrentFrame()>=j[u].stopAtFrame){this._stopAnimation(A,G),j.splice(u,1),G._setGlobalContextVariable("pendingStopAnimations",j),this.done._activateSignal(G),G._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(G,A){const j=A._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),u=j.indexOf(G.uniqueId);-1!==u&&(G.stop(),j.splice(u,1),A._setGlobalContextVariable("currentlyRunningAnimationGroups",j))}}(0,k.h)("FlowGraphStopAnimationBlock",s)}}]);