"use strict";(self.h66iwo8dvgq=self.h66iwo8dvgq||[]).push([[80],{15139:(b,X,P)=>{P.r(X),P.d(X,{FlowGraphStopAnimationBlock:()=>a});var Q=P(13631),S=P(11802),d=P(11700),N=P(13670);class a extends N.b{constructor(b){super(b),this.animationGroup=this.registerDataInput("animationGroup",Q.e),this.stopAtFrame=this.registerDataInput("stopAtFrame",Q.t,-1)}_preparePendingTasks(b){const X=this.animationGroup.getValue(b),P=this.stopAtFrame.getValue(b)??-1,Q=b._getGlobalContextVariable("pendingStopAnimations",[]);Q.push({uniqueId:X.uniqueId,stopAtFrame:P}),b._setGlobalContextVariable("pendingStopAnimations",Q)}_cancelPendingTasks(b){const X=this.animationGroup.getValue(b),P=b._getGlobalContextVariable("pendingStopAnimations",[]);for(let Q=0;Q<P.length;Q++)if(P[Q].uniqueId===X.uniqueId){P.splice(Q,1),b._setGlobalContextVariable("pendingStopAnimations",P);break}}_execute(b){const X=this.animationGroup.getValue(b),P=this.stopAtFrame.getValue(b)??-1;return X?isNaN(P)?this._reportError(b,"Invalid stop time."):(P>0?this._startPendingTasks(b):this._stopAnimation(X,b),void this.out._activateSignal(b)):(d.b.Warn("No animation group provided to stop."),this._reportError(b,"No animation group provided to stop."))}_executeOnTick(b){const X=this.animationGroup.getValue(b),P=b._getGlobalContextVariable("pendingStopAnimations",[]);for(let Q=0;Q<P.length;Q++)if(P[Q].uniqueId===X.uniqueId&&X.getCurrentFrame()>=P[Q].stopAtFrame){this._stopAnimation(X,b),P.splice(Q,1),b._setGlobalContextVariable("pendingStopAnimations",P),this.done._activateSignal(b),b._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(b,X){const P=X._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),Q=P.indexOf(b.uniqueId);-1!==Q&&(b.stop(),P.splice(Q,1),X._setGlobalContextVariable("currentlyRunningAnimationGroups",P))}}(0,S.h)("FlowGraphStopAnimationBlock",a)}}]);