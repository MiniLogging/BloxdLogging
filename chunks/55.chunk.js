"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[55],{13801:(J,T,b)=>{b.r(T),b.d(T,{FlowGraphStopAnimationBlock:()=>Y});var q=b(12603),t=b(639),j=b(519),B=b(12644);class Y extends B.b{constructor(J){super(J),this.animationGroup=this.registerDataInput("animationGroup",q.c),this.stopAtFrame=this.registerDataInput("stopAtFrame",q.r,-1)}_preparePendingTasks(J){const T=this.animationGroup.getValue(J),b=this.stopAtFrame.getValue(J)??-1,q=J._getGlobalContextVariable("pendingStopAnimations",[]);q.push({uniqueId:T.uniqueId,stopAtFrame:b}),J._setGlobalContextVariable("pendingStopAnimations",q)}_cancelPendingTasks(J){const T=this.animationGroup.getValue(J),b=J._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<b.length;q++)if(b[q].uniqueId===T.uniqueId){b.splice(q,1),J._setGlobalContextVariable("pendingStopAnimations",b);break}}_execute(J){const T=this.animationGroup.getValue(J),b=this.stopAtFrame.getValue(J)??-1;return T?isNaN(b)?this._reportError(J,"Invalid stop time."):(b>0?this._startPendingTasks(J):this._stopAnimation(T,J),void this.out._activateSignal(J)):(j.d.Warn("No animation group provided to stop."),this._reportError(J,"No animation group provided to stop."))}_executeOnTick(J){const T=this.animationGroup.getValue(J),b=J._getGlobalContextVariable("pendingStopAnimations",[]);for(let q=0;q<b.length;q++)if(b[q].uniqueId===T.uniqueId&&T.getCurrentFrame()>=b[q].stopAtFrame){this._stopAnimation(T,J),b.splice(q,1),J._setGlobalContextVariable("pendingStopAnimations",b),this.done._activateSignal(J),J._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(J,T){const b=T._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),q=b.indexOf(J.uniqueId);-1!==q&&(J.stop(),b.splice(q,1),T._setGlobalContextVariable("currentlyRunningAnimationGroups",b))}}(0,t.g)("FlowGraphStopAnimationBlock",Y)}}]);