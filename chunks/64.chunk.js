"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[64],{13929:(U,W,l)=>{l.r(W),l.d(W,{FlowGraphStopAnimationBlock:()=>B});var M=l(12704),t=l(655),L=l(512),p=l(12761);class B extends p.b{constructor(U){super(U),this.animationGroup=this.registerDataInput("animationGroup",M.d),this.stopAtFrame=this.registerDataInput("stopAtFrame",M.s,-1)}_preparePendingTasks(U){const W=this.animationGroup.getValue(U),l=this.stopAtFrame.getValue(U)??-1,M=U._getGlobalContextVariable("pendingStopAnimations",[]);M.push({uniqueId:W.uniqueId,stopAtFrame:l}),U._setGlobalContextVariable("pendingStopAnimations",M)}_cancelPendingTasks(U){const W=this.animationGroup.getValue(U),l=U._getGlobalContextVariable("pendingStopAnimations",[]);for(let M=0;M<l.length;M++)if(l[M].uniqueId===W.uniqueId){l.splice(M,1),U._setGlobalContextVariable("pendingStopAnimations",l);break}}_execute(U){const W=this.animationGroup.getValue(U),l=this.stopAtFrame.getValue(U)??-1;return W?isNaN(l)?this._reportError(U,"Invalid stop time."):(l>0?this._startPendingTasks(U):this._stopAnimation(W,U),void this.out._activateSignal(U)):(L.b.Warn("No animation group provided to stop."),this._reportError(U,"No animation group provided to stop."))}_executeOnTick(U){const W=this.animationGroup.getValue(U),l=U._getGlobalContextVariable("pendingStopAnimations",[]);for(let M=0;M<l.length;M++)if(l[M].uniqueId===W.uniqueId&&W.getCurrentFrame()>=l[M].stopAtFrame){this._stopAnimation(W,U),l.splice(M,1),U._setGlobalContextVariable("pendingStopAnimations",l),this.done._activateSignal(U),U._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(U,W){const l=W._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),M=l.indexOf(U.uniqueId);-1!==M&&(U.stop(),l.splice(M,1),W._setGlobalContextVariable("currentlyRunningAnimationGroups",l))}}(0,t.f)("FlowGraphStopAnimationBlock",B)}}]);