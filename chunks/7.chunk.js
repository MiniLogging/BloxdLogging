"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10354:(R,N,q)=>{q.r(N),q.d(N,{Dispose:()=>F,DumpData:()=>j,DumpDataAsync:()=>a,DumpFramebuffer:()=>y,DumpTools:()=>S});var w=q(1515),u=q(1177),M=q(1001),v=q(997);let G,J=null;async function y(R,N,q,w){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",M=arguments.length>5?arguments[5]:void 0,v=arguments.length>6?arguments[6]:void 0;const G=await q.readPixels(0,0,R,N);j(R,N,new Uint8Array(G.buffer),w,u,M,!0,void 0,v)}function a(R,N,q){let w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",u=arguments.length>4?arguments[4]:void 0,M=arguments.length>5&&void 0!==arguments[5]&&arguments[5],v=arguments.length>6&&void 0!==arguments[6]&&arguments[6],G=arguments.length>7?arguments[7]:void 0;return new Promise((J=>{j(R,N,q,(R=>J(R)),w,u,M,v,G)}))}function j(R,N,y,a){let j=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",S=arguments.length>5?arguments[5]:void 0,H=arguments.length>6&&void 0!==arguments[6]&&arguments[6],W=arguments.length>7&&void 0!==arguments[7]&&arguments[7],k=arguments.length>8?arguments[8]:void 0;(async function(){return J||(J=new Promise(((R,N)=>{let u,M=null;const J={fe:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(q.bind(q,1411)).then((y=>{let{ThinEngine:a}=y;try{u=new OffscreenCanvas(100,100),M=new a(u,!1,J)}catch(S){u=document.createElement("canvas"),M=new a(u,!1,J)}v.e.Instances.pop(),v.e.OnEnginesDisposedObservable.add((R=>{M&&R!==M&&!M.u&&0===v.e.Instances.length&&F()})),M.getCaps().parallelShaderCompile=void 0;const j=new w.b(M);q.e(32).then(q.bind(q,11023)).then((q=>{let{passPixelShader:v}=q;if(!M)return void N("Engine is not defined");const J=new w.e({vd:M,name:v.name,fragmentShader:v.shader,samplerNames:["textureSampler"]});G={canvas:u,vd:M,renderer:j,wrapper:J},R(G)}))})).catch(N)}))),await J})().then((q=>{if(q.vd.setSize(R,N,!0),y instanceof Float32Array){const R=new Uint8Array(y.length);let N=y.length;for(;N--;){const q=y[N];R[N]=Math.round(255*(0,M.b)(q))}y=R}const w=q.vd.createRawTexture(y,R,N,5,!1,!H,1);q.renderer.setViewport(),q.renderer.applyEffectWrapper(q.wrapper),q.wrapper.effect._bindTexture("textureSampler",w),q.renderer.draw(),W?u.i.ToBlob(q.canvas,(R=>{const N=new FileReader;N.onload=R=>{const N=R.target.result;a&&a(N)},N.readAsArrayBuffer(R)}),j,k):u.i.EncodeScreenshotCanvasData(q.canvas,a,j,S,k),w.dispose()}))}function F(){var R;G?(G.wrapper.dispose(),G.renderer.dispose(),G.vd.dispose()):null===(R=J)||void 0===R||R.then((R=>{R.wrapper.dispose(),R.renderer.dispose(),R.vd.dispose()}));J=null,G=null}const S={DumpData:j,DumpDataAsync:a,DumpFramebuffer:y,Dispose:F};u.i.DumpData=j,u.i.DumpDataAsync=a,u.i.DumpFramebuffer=y}}]);