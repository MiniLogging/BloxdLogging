"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10678:(t,b,Y)=>{Y.r(b),Y.d(b,{Dispose:()=>p,DumpData:()=>C,DumpDataAsync:()=>U,DumpFramebuffer:()=>E,DumpTools:()=>W});var o=Y(1606),x=Y(1265),F=Y(1058),r=Y(1051);let R,d=null;async function E(t,b,Y,o){let x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",F=arguments.length>5?arguments[5]:void 0,r=arguments.length>6?arguments[6]:void 0;const R=await Y.readPixels(0,0,t,b);C(t,b,new Uint8Array(R.buffer),o,x,F,!0,void 0,r)}function U(t,b,Y){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",x=arguments.length>4?arguments[4]:void 0,F=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],R=arguments.length>7?arguments[7]:void 0;return new Promise((d=>{C(t,b,Y,(t=>d(t)),o,x,F,r,R)}))}function C(t,b,E,U){let C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",W=arguments.length>5?arguments[5]:void 0,T=arguments.length>6&&void 0!==arguments[6]&&arguments[6],y=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=arguments.length>8?arguments[8]:void 0;(async function(){return d||(d=new Promise(((t,b)=>{let x,F=null;const d={re:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(Y.bind(Y,1502)).then((E=>{let{ThinEngine:U}=E;try{x=new OffscreenCanvas(100,100),F=new U(x,!1,d)}catch(W){x=document.createElement("canvas"),F=new U(x,!1,d)}r.d.Instances.pop(),r.d.OnEnginesDisposedObservable.add((t=>{F&&t!==F&&!F.u&&0===r.d.Instances.length&&p()})),F.getCaps().parallelShaderCompile=void 0;const C=new o.c(F);Y.e(32).then(Y.bind(Y,11382)).then((Y=>{let{passPixelShader:r}=Y;if(!F)return void b("Engine is not defined");const d=new o.e({Id:F,name:r.name,fragmentShader:r.shader,samplerNames:["textureSampler"]});R={canvas:x,Id:F,renderer:C,wrapper:d},t(R)}))})).catch(b)}))),await d})().then((Y=>{if(Y.Id.setSize(t,b,!0),E instanceof Float32Array){const t=new Uint8Array(E.length);let b=E.length;for(;b--;){const Y=E[b];t[b]=Math.round(255*(0,F.e)(Y))}E=t}const o=Y.Id.createRawTexture(E,t,b,5,!1,!T,1);Y.renderer.setViewport(),Y.renderer.applyEffectWrapper(Y.wrapper),Y.wrapper.effect._bindTexture("textureSampler",o),Y.renderer.draw(),y?x.f.ToBlob(Y.canvas,(t=>{const b=new FileReader;b.onload=t=>{const b=t.target.result;U&&U(b)},b.readAsArrayBuffer(t)}),C,v):x.f.EncodeScreenshotCanvasData(Y.canvas,U,C,W,v),o.dispose()}))}function p(){var t;R?(R.wrapper.dispose(),R.renderer.dispose(),R.Id.dispose()):null===(t=d)||void 0===t||t.then((t=>{t.wrapper.dispose(),t.renderer.dispose(),t.Id.dispose()}));d=null,R=null}const W={DumpData:C,DumpDataAsync:U,DumpFramebuffer:E,Dispose:p};x.f.DumpData=C,x.f.DumpDataAsync=U,x.f.DumpFramebuffer=E}}]);