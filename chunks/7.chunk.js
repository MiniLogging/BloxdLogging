"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10255:(B,q,C)=>{C.r(q),C.d(q,{Dispose:()=>W,DumpData:()=>z,DumpDataAsync:()=>l,DumpFramebuffer:()=>T,DumpTools:()=>Z});var v=C(1487),m=C(1161),O=C(981),S=C(978);let D,R=null;async function T(B,q,C,v){let m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",O=arguments.length>5?arguments[5]:void 0,S=arguments.length>6?arguments[6]:void 0;const D=await C.readPixels(0,0,B,q);z(B,q,new Uint8Array(D.buffer),v,m,O,!0,void 0,S)}function l(B,q,C){let v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",m=arguments.length>4?arguments[4]:void 0,O=arguments.length>5&&void 0!==arguments[5]&&arguments[5],S=arguments.length>6&&void 0!==arguments[6]&&arguments[6],D=arguments.length>7?arguments[7]:void 0;return new Promise((R=>{z(B,q,C,(B=>R(B)),v,m,O,S,D)}))}function z(B,q,T,l){let z=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",Z=arguments.length>5?arguments[5]:void 0,G=arguments.length>6&&void 0!==arguments[6]&&arguments[6],y=arguments.length>7&&void 0!==arguments[7]&&arguments[7],e=arguments.length>8?arguments[8]:void 0;(async function(){return R||(R=new Promise(((B,q)=>{let m,O=null;const R={af:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(C.bind(C,1387)).then((T=>{let{ThinEngine:l}=T;try{m=new OffscreenCanvas(100,100),O=new l(m,!1,R)}catch(Z){m=document.createElement("canvas"),O=new l(m,!1,R)}S.e.Instances.pop(),S.e.OnEnginesDisposedObservable.add((B=>{O&&B!==O&&!O.u&&0===S.e.Instances.length&&W()})),O.getCaps().parallelShaderCompile=void 0;const z=new v.e(O);C.e(32).then(C.bind(C,10912)).then((C=>{let{passPixelShader:S}=C;if(!O)return void q("Engine is not defined");const R=new v.g({Fb:O,name:S.name,fragmentShader:S.shader,samplerNames:["textureSampler"]});D={canvas:m,Fb:O,renderer:z,wrapper:R},B(D)}))})).catch(q)}))),await R})().then((C=>{if(C.Fb.setSize(B,q,!0),T instanceof Float32Array){const B=new Uint8Array(T.length);let q=T.length;for(;q--;){const C=T[q];B[q]=Math.round(255*(0,O.c)(C))}T=B}const v=C.Fb.createRawTexture(T,B,q,5,!1,!G,1);C.renderer.setViewport(),C.renderer.applyEffectWrapper(C.wrapper),C.wrapper.effect._bindTexture("textureSampler",v),C.renderer.draw(),y?m.f.ToBlob(C.canvas,(B=>{const q=new FileReader;q.onload=B=>{const q=B.target.result;l&&l(q)},q.readAsArrayBuffer(B)}),z,e):m.f.EncodeScreenshotCanvasData(C.canvas,l,z,Z,e),v.dispose()}))}function W(){var B;D?(D.wrapper.dispose(),D.renderer.dispose(),D.Fb.dispose()):null===(B=R)||void 0===B||B.then((B=>{B.wrapper.dispose(),B.renderer.dispose(),B.Fb.dispose()}));R=null,D=null}const Z={DumpData:z,DumpDataAsync:l,DumpFramebuffer:T,Dispose:W};m.f.DumpData=z,m.f.DumpDataAsync=l,m.f.DumpFramebuffer=T}}]);