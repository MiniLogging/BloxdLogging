"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10868:(Q,z,I)=>{I.r(z),I.d(z,{Dispose:()=>k,DumpData:()=>D,DumpDataAsync:()=>j,DumpFramebuffer:()=>f,DumpTools:()=>s});var P=I(1524),w=I(1180),T=I(1015),A=I(1012);let e,m=null;async function f(Q,z,I,P){let w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",T=arguments.length>5?arguments[5]:void 0,A=arguments.length>6?arguments[6]:void 0;const e=await I.readPixels(0,0,Q,z);D(Q,z,new Uint8Array(e.buffer),P,w,T,!0,void 0,A)}function j(Q,z,I){let P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",w=arguments.length>4?arguments[4]:void 0,T=arguments.length>5&&void 0!==arguments[5]&&arguments[5],A=arguments.length>6&&void 0!==arguments[6]&&arguments[6],e=arguments.length>7?arguments[7]:void 0;return new Promise((m=>{D(Q,z,I,(Q=>m(Q)),P,w,T,A,e)}))}function D(Q,z,f,j){let D=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",s=arguments.length>5?arguments[5]:void 0,J=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],X=arguments.length>8?arguments[8]:void 0;(async function(){return m||(m=new Promise(((Q,z)=>{let w,T=null;const m={gf:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(I.bind(I,1408)).then((f=>{let{ThinEngine:j}=f;try{w=new OffscreenCanvas(100,100),T=new j(w,!1,m)}catch(s){w=document.createElement("canvas"),T=new j(w,!1,m)}A.d.Instances.pop(),A.d.OnEnginesDisposedObservable.add((Q=>{T&&Q!==T&&!T.u&&0===A.d.Instances.length&&k()})),T.getCaps().parallelShaderCompile=void 0;const D=new P.d(T);I.e(32).then(I.bind(I,11507)).then((I=>{let{passPixelShader:A}=I;if(!T)return void z("Engine is not defined");const m=new P.h({ub:T,name:A.name,fragmentShader:A.shader,samplerNames:["textureSampler"]});e={canvas:w,ub:T,renderer:D,wrapper:m},Q(e)}))})).catch(z)}))),await m})().then((I=>{if(I.ub.setSize(Q,z,!0),f instanceof Float32Array){const Q=new Uint8Array(f.length);let z=f.length;for(;z--;){const I=f[z];Q[z]=Math.round(255*(0,T.b)(I))}f=Q}const P=I.ub.createRawTexture(f,Q,z,5,!1,!J,1);I.renderer.setViewport(),I.renderer.applyEffectWrapper(I.wrapper),I.wrapper.effect._bindTexture("textureSampler",P),I.renderer.draw(),l?w.h.ToBlob(I.canvas,(Q=>{const z=new FileReader;z.onload=Q=>{const z=Q.target.result;j&&j(z)},z.readAsArrayBuffer(Q)}),D,X):w.h.EncodeScreenshotCanvasData(I.canvas,j,D,s,X),P.dispose()}))}function k(){var Q;e?(e.wrapper.dispose(),e.renderer.dispose(),e.ub.dispose()):null===(Q=m)||void 0===Q||Q.then((Q=>{Q.wrapper.dispose(),Q.renderer.dispose(),Q.ub.dispose()}));m=null,e=null}const s={DumpData:D,DumpDataAsync:j,DumpFramebuffer:f,Dispose:k};w.h.DumpData=D,w.h.DumpDataAsync=j,w.h.DumpFramebuffer=f}}]);