"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10629:(p,O,E)=>{E.r(O),E.d(O,{Dispose:()=>Z,DumpData:()=>D,DumpDataAsync:()=>s,DumpFramebuffer:()=>B,DumpTools:()=>m});var e=E(1500),x=E(1177),F=E(1027),q=E(1025);let a,Y=null;async function B(p,O,E,e){let x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",F=arguments.length>5?arguments[5]:void 0,q=arguments.length>6?arguments[6]:void 0;const a=await E.readPixels(0,0,p,O);D(p,O,new Uint8Array(a.buffer),e,x,F,!0,void 0,q)}function s(p,O,E){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",x=arguments.length>4?arguments[4]:void 0,F=arguments.length>5&&void 0!==arguments[5]&&arguments[5],q=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7?arguments[7]:void 0;return new Promise((Y=>{D(p,O,E,(p=>Y(p)),e,x,F,q,a)}))}function D(p,O,B,s){let D=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",m=arguments.length>5?arguments[5]:void 0,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],T=arguments.length>7&&void 0!==arguments[7]&&arguments[7],A=arguments.length>8?arguments[8]:void 0;(async function(){return Y||(Y=new Promise(((p,O)=>{let x,F=null;const Y={uf:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(E.bind(E,1402)).then((B=>{let{ThinEngine:s}=B;try{x=new OffscreenCanvas(100,100),F=new s(x,!1,Y)}catch(m){x=document.createElement("canvas"),F=new s(x,!1,Y)}q.c.Instances.pop(),q.c.OnEnginesDisposedObservable.add((p=>{F&&p!==F&&!F.u&&0===q.c.Instances.length&&Z()})),F.getCaps().parallelShaderCompile=void 0;const D=new e.d(F);E.e(32).then(E.bind(E,11263)).then((E=>{let{passPixelShader:q}=E;if(!F)return void O("Engine is not defined");const Y=new e.e({Ob:F,name:q.name,fragmentShader:q.shader,samplerNames:["textureSampler"]});a={canvas:x,Ob:F,renderer:D,wrapper:Y},p(a)}))})).catch(O)}))),await Y})().then((E=>{if(E.Ob.setSize(p,O,!0),B instanceof Float32Array){const p=new Uint8Array(B.length);let O=B.length;for(;O--;){const E=B[O];p[O]=Math.round(255*(0,F.b)(E))}B=p}const e=E.Ob.createRawTexture(B,p,O,5,!1,!h,1);E.renderer.setViewport(),E.renderer.applyEffectWrapper(E.wrapper),E.wrapper.effect._bindTexture("textureSampler",e),E.renderer.draw(),T?x.d.ToBlob(E.canvas,(p=>{const O=new FileReader;O.onload=p=>{const O=p.target.result;s&&s(O)},O.readAsArrayBuffer(p)}),D,A):x.d.EncodeScreenshotCanvasData(E.canvas,s,D,m,A),e.dispose()}))}function Z(){var p;a?(a.wrapper.dispose(),a.renderer.dispose(),a.Ob.dispose()):null===(p=Y)||void 0===p||p.then((p=>{p.wrapper.dispose(),p.renderer.dispose(),p.Ob.dispose()}));Y=null,a=null}const m={DumpData:D,DumpDataAsync:s,DumpFramebuffer:B,Dispose:Z};x.d.DumpData=D,x.d.DumpDataAsync=s,x.d.DumpFramebuffer=B}}]);