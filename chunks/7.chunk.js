"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10453:(U,b,e)=>{e.r(b),e.d(b,{Dispose:()=>f,DumpData:()=>W,DumpDataAsync:()=>r,DumpFramebuffer:()=>u,DumpTools:()=>l});var K=e(1509),p=e(1147),m=e(979),i=e(975);let D,S=null;async function u(U,b,e,K){let p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",m=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;const D=await e.readPixels(0,0,U,b);W(U,b,new Uint8Array(D.buffer),K,p,m,!0,void 0,i)}function r(U,b,e){let K=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",p=arguments.length>4?arguments[4]:void 0,m=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],D=arguments.length>7?arguments[7]:void 0;return new Promise((S=>{W(U,b,e,(U=>S(U)),K,p,m,i,D)}))}function W(U,b,u,r){let W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",l=arguments.length>5?arguments[5]:void 0,P=arguments.length>6&&void 0!==arguments[6]&&arguments[6],G=arguments.length>7&&void 0!==arguments[7]&&arguments[7],E=arguments.length>8?arguments[8]:void 0;(async function(){return S||(S=new Promise(((U,b)=>{let p,m=null;const S={Ye:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(e.bind(e,1395)).then((u=>{let{ThinEngine:r}=u;try{p=new OffscreenCanvas(100,100),m=new r(p,!1,S)}catch(l){p=document.createElement("canvas"),m=new r(p,!1,S)}i.e.Instances.pop(),i.e.OnEnginesDisposedObservable.add((U=>{m&&U!==m&&!m.u&&0===i.e.Instances.length&&f()})),m.getCaps().parallelShaderCompile=void 0;const W=new K.d(m);e.e(32).then(e.bind(e,11131)).then((e=>{let{passPixelShader:i}=e;if(!m)return void b("Engine is not defined");const S=new K.f({Jb:m,name:i.name,fragmentShader:i.shader,samplerNames:["textureSampler"]});D={canvas:p,Jb:m,renderer:W,wrapper:S},U(D)}))})).catch(b)}))),await S})().then((e=>{if(e.Jb.setSize(U,b,!0),u instanceof Float32Array){const U=new Uint8Array(u.length);let b=u.length;for(;b--;){const e=u[b];U[b]=Math.round(255*(0,m.b)(e))}u=U}const K=e.Jb.createRawTexture(u,U,b,5,!1,!P,1);e.renderer.setViewport(),e.renderer.applyEffectWrapper(e.wrapper),e.wrapper.effect._bindTexture("textureSampler",K),e.renderer.draw(),G?p.g.ToBlob(e.canvas,(U=>{const b=new FileReader;b.onload=U=>{const b=U.target.result;r&&r(b)},b.readAsArrayBuffer(U)}),W,E):p.g.EncodeScreenshotCanvasData(e.canvas,r,W,l,E),K.dispose()}))}function f(){var U;D?(D.wrapper.dispose(),D.renderer.dispose(),D.Jb.dispose()):null===(U=S)||void 0===U||U.then((U=>{U.wrapper.dispose(),U.renderer.dispose(),U.Jb.dispose()}));S=null,D=null}const l={DumpData:W,DumpDataAsync:r,DumpFramebuffer:u,Dispose:f};p.g.DumpData=W,p.g.DumpDataAsync=r,p.g.DumpFramebuffer=u}}]);