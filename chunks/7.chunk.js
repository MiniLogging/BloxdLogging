"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{11261:(x,Z,l)=>{l.r(Z),l.d(Z,{Dispose:()=>c,DumpData:()=>Q,DumpDataAsync:()=>V,DumpFramebuffer:()=>j,DumpTools:()=>a});var t=l(1617),L=l(1274),z=l(1076),A=l(1070);let P,C=null;async function j(x,Z,l,t){let L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",z=arguments.length>5?arguments[5]:void 0,A=arguments.length>6?arguments[6]:void 0;const P=await l.readPixels(0,0,x,Z);Q(x,Z,new Uint8Array(P.buffer),t,L,z,!0,void 0,A)}function V(x,Z,l){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",L=arguments.length>4?arguments[4]:void 0,z=arguments.length>5&&void 0!==arguments[5]&&arguments[5],A=arguments.length>6&&void 0!==arguments[6]&&arguments[6],P=arguments.length>7?arguments[7]:void 0;return new Promise((C=>{Q(x,Z,l,(x=>C(x)),t,L,z,A,P)}))}function Q(x,Z,j,V){let Q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",a=arguments.length>5?arguments[5]:void 0,I=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],n=arguments.length>8?arguments[8]:void 0;(async function(){return C||(C=new Promise(((x,Z)=>{let L,z=null;const C={we:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(l.bind(l,1508)).then((j=>{let{ThinEngine:V}=j;try{L=new OffscreenCanvas(100,100),z=new V(L,!1,C)}catch(a){L=document.createElement("canvas"),z=new V(L,!1,C)}A.d.Instances.pop(),A.d.OnEnginesDisposedObservable.add((x=>{z&&x!==z&&!z.u&&0===A.d.Instances.length&&c()})),z.getCaps().parallelShaderCompile=void 0;const Q=new t.e(z);l.e(32).then(l.bind(l,11906)).then((l=>{let{passPixelShader:A}=l;if(!z)return void Z("Engine is not defined");const C=new t.f({Ld:z,name:A.name,fragmentShader:A.shader,samplerNames:["textureSampler"]});P={canvas:L,Ld:z,renderer:Q,wrapper:C},x(P)}))})).catch(Z)}))),await C})().then((l=>{if(l.Ld.setSize(x,Z,!0),j instanceof Float32Array){const x=new Uint8Array(j.length);let Z=j.length;for(;Z--;){const l=j[Z];x[Z]=Math.round(255*(0,z.d)(l))}j=x}const t=l.Ld.createRawTexture(j,x,Z,5,!1,!I,1);l.renderer.setViewport(),l.renderer.applyEffectWrapper(l.wrapper),l.wrapper.effect._bindTexture("textureSampler",t),l.renderer.draw(),u?L.f.ToBlob(l.canvas,(x=>{const Z=new FileReader;Z.onload=x=>{const Z=x.target.result;V&&V(Z)},Z.readAsArrayBuffer(x)}),Q,n):L.f.EncodeScreenshotCanvasData(l.canvas,V,Q,a,n),t.dispose()}))}function c(){var x;P?(P.wrapper.dispose(),P.renderer.dispose(),P.Ld.dispose()):null===(x=C)||void 0===x||x.then((x=>{x.wrapper.dispose(),x.renderer.dispose(),x.Ld.dispose()}));C=null,P=null}const a={DumpData:Q,DumpDataAsync:V,DumpFramebuffer:j,Dispose:c};L.f.DumpData=Q,L.f.DumpDataAsync=V,L.f.DumpFramebuffer=j}}]);