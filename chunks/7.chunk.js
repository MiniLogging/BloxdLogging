"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10971:(I,S,d)=>{d.r(S),d.d(S,{Dispose:()=>E,DumpData:()=>p,DumpDataAsync:()=>Y,DumpFramebuffer:()=>f,DumpTools:()=>o});var N=d(1562),O=d(1216),g=d(1037),T=d(1035);let q,a=null;async function f(I,S,d,N){let O=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",g=arguments.length>5?arguments[5]:void 0,T=arguments.length>6?arguments[6]:void 0;const q=await d.readPixels(0,0,I,S);p(I,S,new Uint8Array(q.buffer),N,O,g,!0,void 0,T)}function Y(I,S,d){let N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",O=arguments.length>4?arguments[4]:void 0,g=arguments.length>5&&void 0!==arguments[5]&&arguments[5],T=arguments.length>6&&void 0!==arguments[6]&&arguments[6],q=arguments.length>7?arguments[7]:void 0;return new Promise((a=>{p(I,S,d,(I=>a(I)),N,O,g,T,q)}))}function p(I,S,f,Y){let p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",o=arguments.length>5?arguments[5]:void 0,k=arguments.length>6&&void 0!==arguments[6]&&arguments[6],U=arguments.length>7&&void 0!==arguments[7]&&arguments[7],i=arguments.length>8?arguments[8]:void 0;(async function(){return a||(a=new Promise(((I,S)=>{let O,g=null;const a={tf:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(d.bind(d,1455)).then((f=>{let{ThinEngine:Y}=f;try{O=new OffscreenCanvas(100,100),g=new Y(O,!1,a)}catch(o){O=document.createElement("canvas"),g=new Y(O,!1,a)}T.e.Instances.pop(),T.e.OnEnginesDisposedObservable.add((I=>{g&&I!==g&&!g.u&&0===T.e.Instances.length&&E()})),g.getCaps().parallelShaderCompile=void 0;const p=new N.c(g);d.e(32).then(d.bind(d,11690)).then((d=>{let{passPixelShader:T}=d;if(!g)return void S("Engine is not defined");const a=new N.d({pb:g,name:T.name,fragmentShader:T.shader,samplerNames:["textureSampler"]});q={canvas:O,pb:g,renderer:p,wrapper:a},I(q)}))})).catch(S)}))),await a})().then((d=>{if(d.pb.setSize(I,S,!0),f instanceof Float32Array){const I=new Uint8Array(f.length);let S=f.length;for(;S--;){const d=f[S];I[S]=Math.round(255*(0,g.e)(d))}f=I}const N=d.pb.createRawTexture(f,I,S,5,!1,!k,1);d.renderer.setViewport(),d.renderer.applyEffectWrapper(d.wrapper),d.wrapper.effect._bindTexture("textureSampler",N),d.renderer.draw(),U?O.d.ToBlob(d.canvas,(I=>{const S=new FileReader;S.onload=I=>{const S=I.target.result;Y&&Y(S)},S.readAsArrayBuffer(I)}),p,i):O.d.EncodeScreenshotCanvasData(d.canvas,Y,p,o,i),N.dispose()}))}function E(){var I;q?(q.wrapper.dispose(),q.renderer.dispose(),q.pb.dispose()):null===(I=a)||void 0===I||I.then((I=>{I.wrapper.dispose(),I.renderer.dispose(),I.pb.dispose()}));a=null,q=null}const o={DumpData:p,DumpDataAsync:Y,DumpFramebuffer:f,Dispose:E};O.d.DumpData=p,O.d.DumpDataAsync=Y,O.d.DumpFramebuffer=f}}]);