"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{11025:(b,o,l)=>{l.r(o),l.d(o,{Dispose:()=>C,DumpData:()=>w,DumpDataAsync:()=>A,DumpFramebuffer:()=>t,DumpTools:()=>U});var g=l(1599),I=l(1262),v=l(1089),W=l(1086);let n,T=null;async function t(b,o,l,g){let I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",v=arguments.length>5?arguments[5]:void 0,W=arguments.length>6?arguments[6]:void 0;const n=await l.readPixels(0,0,b,o);w(b,o,new Uint8Array(n.buffer),g,I,v,!0,void 0,W)}function A(b,o,l){let g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",I=arguments.length>4?arguments[4]:void 0,v=arguments.length>5&&void 0!==arguments[5]&&arguments[5],W=arguments.length>6&&void 0!==arguments[6]&&arguments[6],n=arguments.length>7?arguments[7]:void 0;return new Promise((T=>{w(b,o,l,(b=>T(b)),g,I,v,W,n)}))}function w(b,o,t,A){let w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",U=arguments.length>5?arguments[5]:void 0,m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],N=arguments.length>7&&void 0!==arguments[7]&&arguments[7],x=arguments.length>8?arguments[8]:void 0;(async function(){return T||(T=new Promise(((b,o)=>{let I,v=null;const T={ff:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(l.bind(l,1489)).then((t=>{let{ThinEngine:A}=t;try{I=new OffscreenCanvas(100,100),v=new A(I,!1,T)}catch(U){I=document.createElement("canvas"),v=new A(I,!1,T)}W.e.Instances.pop(),W.e.OnEnginesDisposedObservable.add((b=>{v&&b!==v&&!v.u&&0===W.e.Instances.length&&C()})),v.getCaps().parallelShaderCompile=void 0;const w=new g.c(v);l.e(32).then(l.bind(l,11724)).then((l=>{let{passPixelShader:W}=l;if(!v)return void o("Engine is not defined");const T=new g.d({mb:v,name:W.name,fragmentShader:W.shader,samplerNames:["textureSampler"]});n={canvas:I,mb:v,renderer:w,wrapper:T},b(n)}))})).catch(o)}))),await T})().then((l=>{if(l.mb.setSize(b,o,!0),t instanceof Float32Array){const b=new Uint8Array(t.length);let o=t.length;for(;o--;){const l=t[o];b[o]=Math.round(255*(0,v.b)(l))}t=b}const g=l.mb.createRawTexture(t,b,o,5,!1,!m,1);l.renderer.setViewport(),l.renderer.applyEffectWrapper(l.wrapper),l.wrapper.effect._bindTexture("textureSampler",g),l.renderer.draw(),N?I.c.ToBlob(l.canvas,(b=>{const o=new FileReader;o.onload=b=>{const o=b.target.result;A&&A(o)},o.readAsArrayBuffer(b)}),w,x):I.c.EncodeScreenshotCanvasData(l.canvas,A,w,U,x),g.dispose()}))}function C(){var b;n?(n.wrapper.dispose(),n.renderer.dispose(),n.mb.dispose()):null===(b=T)||void 0===b||b.then((b=>{b.wrapper.dispose(),b.renderer.dispose(),b.mb.dispose()}));T=null,n=null}const U={DumpData:w,DumpDataAsync:A,DumpFramebuffer:t,Dispose:C};I.c.DumpData=w,I.c.DumpDataAsync=A,I.c.DumpFramebuffer=t}}]);