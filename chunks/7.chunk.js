"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10915:(F,e,a)=>{a.r(e),a.d(e,{Dispose:()=>s,DumpData:()=>L,DumpDataAsync:()=>y,DumpFramebuffer:()=>p,DumpTools:()=>Z});var k=a(1527),h=a(1220),z=a(1038),x=a(1034);let t,H=null;async function p(F,e,a,k){let h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",z=arguments.length>5?arguments[5]:void 0,x=arguments.length>6?arguments[6]:void 0;const t=await a.readPixels(0,0,F,e);L(F,e,new Uint8Array(t.buffer),k,h,z,!0,void 0,x)}function y(F,e,a){let k=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",h=arguments.length>4?arguments[4]:void 0,z=arguments.length>5&&void 0!==arguments[5]&&arguments[5],x=arguments.length>6&&void 0!==arguments[6]&&arguments[6],t=arguments.length>7?arguments[7]:void 0;return new Promise((H=>{L(F,e,a,(F=>H(F)),k,h,z,x,t)}))}function L(F,e,p,y){let L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",Z=arguments.length>5?arguments[5]:void 0,A=arguments.length>6&&void 0!==arguments[6]&&arguments[6],w=arguments.length>7&&void 0!==arguments[7]&&arguments[7],I=arguments.length>8?arguments[8]:void 0;(async function(){return H||(H=new Promise(((F,e)=>{let h,z=null;const H={Xe:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(a.bind(a,1438)).then((p=>{let{ThinEngine:y}=p;try{h=new OffscreenCanvas(100,100),z=new y(h,!1,H)}catch(Z){h=document.createElement("canvas"),z=new y(h,!1,H)}x.b.Instances.pop(),x.b.OnEnginesDisposedObservable.add((F=>{z&&F!==z&&!z.u&&0===x.b.Instances.length&&s()})),z.getCaps().parallelShaderCompile=void 0;const L=new k.c(z);a.e(32).then(a.bind(a,11605)).then((a=>{let{passPixelShader:x}=a;if(!z)return void e("Engine is not defined");const H=new k.e({ob:z,name:x.name,fragmentShader:x.shader,samplerNames:["textureSampler"]});t={canvas:h,ob:z,renderer:L,wrapper:H},F(t)}))})).catch(e)}))),await H})().then((a=>{if(a.ob.setSize(F,e,!0),p instanceof Float32Array){const F=new Uint8Array(p.length);let e=p.length;for(;e--;){const a=p[e];F[e]=Math.round(255*(0,z.d)(a))}p=F}const k=a.ob.createRawTexture(p,F,e,5,!1,!A,1);a.renderer.setViewport(),a.renderer.applyEffectWrapper(a.wrapper),a.wrapper.effect._bindTexture("textureSampler",k),a.renderer.draw(),w?h.c.ToBlob(a.canvas,(F=>{const e=new FileReader;e.onload=F=>{const e=F.target.result;y&&y(e)},e.readAsArrayBuffer(F)}),L,I):h.c.EncodeScreenshotCanvasData(a.canvas,y,L,Z,I),k.dispose()}))}function s(){var F;t?(t.wrapper.dispose(),t.renderer.dispose(),t.ob.dispose()):null===(F=H)||void 0===F||F.then((F=>{F.wrapper.dispose(),F.renderer.dispose(),F.ob.dispose()}));H=null,t=null}const Z={DumpData:L,DumpDataAsync:y,DumpFramebuffer:p,Dispose:s};h.c.DumpData=L,h.c.DumpDataAsync=y,h.c.DumpFramebuffer=p}}]);