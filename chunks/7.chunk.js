"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[7],{10953:(o,i,p)=>{p.r(i),p.d(i,{Dispose:()=>O,DumpData:()=>G,DumpDataAsync:()=>a,DumpFramebuffer:()=>J,DumpTools:()=>C});var b=p(1479),k=p(1175),u=p(1008),j=p(1003);let z,g=null;async function J(o,i,p,b){let k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",u=arguments.length>5?arguments[5]:void 0,j=arguments.length>6?arguments[6]:void 0;const z=await p.readPixels(0,0,o,i);G(o,i,new Uint8Array(z.buffer),b,k,u,!0,void 0,j)}function a(o,i,p){let b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",k=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],j=arguments.length>6&&void 0!==arguments[6]&&arguments[6],z=arguments.length>7?arguments[7]:void 0;return new Promise((g=>{G(o,i,p,(o=>g(o)),b,k,u,j,z)}))}function G(o,i,J,a){let G=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",C=arguments.length>5?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],R=arguments.length>7&&void 0!==arguments[7]&&arguments[7],E=arguments.length>8?arguments[8]:void 0;(async function(){return g||(g=new Promise(((o,i)=>{let k,u=null;const g={pf:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(p.bind(p,1387)).then((J=>{let{ThinEngine:a}=J;try{k=new OffscreenCanvas(100,100),u=new a(k,!1,g)}catch(C){k=document.createElement("canvas"),u=new a(k,!1,g)}j.e.Instances.pop(),j.e.OnEnginesDisposedObservable.add((o=>{u&&o!==u&&!u.u&&0===j.e.Instances.length&&O()})),u.getCaps().parallelShaderCompile=void 0;const G=new b.c(u);p.e(32).then(p.bind(p,11643)).then((p=>{let{passPixelShader:j}=p;if(!u)return void i("Engine is not defined");const g=new b.e({Hb:u,name:j.name,fragmentShader:j.shader,samplerNames:["textureSampler"]});z={canvas:k,Hb:u,renderer:G,wrapper:g},o(z)}))})).catch(i)}))),await g})().then((p=>{if(p.Hb.setSize(o,i,!0),J instanceof Float32Array){const o=new Uint8Array(J.length);let i=J.length;for(;i--;){const p=J[i];o[i]=Math.round(255*(0,u.d)(p))}J=o}const b=p.Hb.createRawTexture(J,o,i,5,!1,!l,1);p.renderer.setViewport(),p.renderer.applyEffectWrapper(p.wrapper),p.wrapper.effect._bindTexture("textureSampler",b),p.renderer.draw(),R?k.h.ToBlob(p.canvas,(o=>{const i=new FileReader;i.onload=o=>{const i=o.target.result;a&&a(i)},i.readAsArrayBuffer(o)}),G,E):k.h.EncodeScreenshotCanvasData(p.canvas,a,G,C,E),b.dispose()}))}function O(){var o;z?(z.wrapper.dispose(),z.renderer.dispose(),z.Hb.dispose()):null===(o=g)||void 0===o||o.then((o=>{o.wrapper.dispose(),o.renderer.dispose(),o.Hb.dispose()}));g=null,z=null}const C={DumpData:G,DumpDataAsync:a,DumpFramebuffer:J,Dispose:O};k.h.DumpData=G,k.h.DumpDataAsync=a,k.h.DumpFramebuffer=J}}]);