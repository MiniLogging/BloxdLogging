"use strict";(self["3b8bnhi4gzj"]=self["3b8bnhi4gzj"]||[]).push([[93],{15186:(Z,h,V)=>{V.r(h),V.d(h,{FlowGraphJsonPointerParserBlock:()=>N});var v=V(13450),A=V(13459);const H=new RegExp(/\/\{(\w+)\}(?=\/|$)/g);class K{constructor(Z,h){this.path=Z,this.ownerBlock=h,this.templatedInputs=[];let V=H.exec(Z);const K=new Set;for(;V;){const[,d]=V;if(K.has(d))throw new Error("Duplicate template variable detected.");K.add(d),this.templatedInputs.push(h.registerDataInput(d,A.h,new v.b(0))),V=H.exec(Z)}}getAccessor(Z,h){let V=this.path;for(const v of this.templatedInputs){const Z=v.getValue(h).value;if("number"!==typeof Z||Z<0)throw new Error("Invalid value for templated input.");V=V.replace(`{${v.name}}`,Z.toString())}return Z.convert(V)}}var d=V(11691),a=V(11729),n=V(11781),x=V(15015);class N extends x.c{constructor(Z){super(A.c,Z),this.config=Z,this.object=this.registerDataOutput("object",A.c),this.propertyName=this.registerDataOutput("propertyName",A.c),this.setterFunction=this.registerDataOutput("setFunction",A.c,this._setPropertyValue.bind(this)),this.getterFunction=this.registerDataOutput("getFunction",A.c,this._getPropertyValue.bind(this)),this.generateAnimationsFunction=this.registerDataOutput("generateAnimationsFunction",A.c,this._getInterpolationAnimationPropertyInfo.bind(this)),this.templateComponent=new K(Z.jsonPointer,this)}_doOperation(Z){var h,V,v;const A=this.templateComponent.getAccessor(this.config.pathConverter,Z),H=A.info.get(A.object),K=null===(h=(V=A.info).getTarget)||void 0===h?void 0:h.call(V,A.object),d=null===(v=A.info.getPropertyName)||void 0===v?void 0:v[0](A.object);if(!K)throw new Error("Object is undefined");return this.object.setValue(K,Z),d&&this.propertyName.setValue(d,Z),H}_setPropertyValue(Z,h,V,v){var A,H;const K=this.templateComponent.getAccessor(this.config.pathConverter,v),d=K.info.type;d.startsWith("Color")&&(V=D(V,d)),null===(A=(H=K.info).set)||void 0===A||A.call(H,V,K.object)}_getPropertyValue(Z,h,V){const v=this.templateComponent.getAccessor(this.config.pathConverter,V),A=v.info.type,H=v.info.get(v.object);return A.startsWith("Color")?function(Z){if(Z instanceof n.Ih)return new a.Ch(Z.r,Z.g,Z.b);if(Z instanceof n.nd)return new a.Vector4(Z.r,Z.g,Z.b,Z.a);throw new Error("Invalid color type")}(H):H}_getInterpolationAnimationPropertyInfo(Z,h,V){const v=this.templateComponent.getAccessor(this.config.pathConverter,V);return(Z,h,V,A)=>{var H;const K=[],d=v.info.type;return d.startsWith("Color")&&(Z=Z.map((Z=>({frame:Z.frame,value:D(Z.value,d)})))),null===(H=v.info.interpolation)||void 0===H||H.forEach(((h,H)=>{var d;const a=(null===(d=v.info.getPropertyName)||void 0===d?void 0:d[H](v.object))||"Animation-interpolation-"+H;let n=Z;V!==h.type&&(n=Z.map((Z=>({frame:Z.frame,value:h.getValue(void 0,Z.value.mh?Z.value.mh():[Z.value],0,1)}))));const x=h.buildAnimations(v.object,a,60,n);for(const Z of x)A&&Z.babylonAnimation.setEasingFunction(A),K.push(Z.babylonAnimation)})),K}}getClassName(){return"FlowGraphJsonPointerParserBlock"}}function D(Z,h){return Z.getClassName().startsWith("Color")?Z:"Ih"===h?new n.Ih(Z.x,Z.y,Z.z):"nd"===h?new n.nd(Z.x,Z.y,Z.z,Z.w):Z}(0,d.i)("FlowGraphJsonPointerParserBlock",N)},15015:(Z,h,V)=>{V.d(h,{c:()=>d});var v=V(13480),A=V(13459);const H="cachedOperationValue",K="cachedExecutionId";class d extends v.d{constructor(Z,h){super(h),this.value=this.registerDataOutput("value",Z),this.isValid=this.registerDataOutput("isValid",A.f)}_updateOutputs(Z){const h=Z._getExecutionVariable(this,K,-1),V=Z._getExecutionVariable(this,H,null);if(void 0!==V&&null!==V&&h===Z.executionId)this.isValid.setValue(!0,Z),this.value.setValue(V,Z);else try{const h=this._doOperation(Z);if(void 0===h||null===h)return void this.isValid.setValue(!1,Z);Z._setExecutionVariable(this,H,h),Z._setExecutionVariable(this,K,Z.executionId),this.value.setValue(h,Z),this.isValid.setValue(!0,Z)}catch(v){this.isValid.setValue(!1,Z)}}}}}]);