"use strict";(self.lfntwv94xlc=self.lfntwv94xlc||[]).push([[93],{14772:(m,S,h)=>{h.r(S),h.d(S,{FlowGraphJsonPointerParserBlock:()=>I});var l=h(13056),M=h(13060);const O=new RegExp(/\/\{(\w+)\}(?=\/|$)/g);class u{constructor(m,S){this.path=m,this.ownerBlock=S,this.templatedInputs=[];let h=O.exec(m);const u=new Set;for(;h;){const[,b]=h;if(u.has(b))throw new Error("Duplicate template variable detected.");u.add(b),this.templatedInputs.push(S.registerDataInput(b,M.f,new l.b(0))),h=O.exec(m)}}getAccessor(m,S){let h=this.path;for(const l of this.templatedInputs){const m=l.getValue(S).value;if("number"!==typeof m||m<0)throw new Error("Invalid value for templated input.");h=h.replace(`{${l.name}}`,m.toString())}return m.convert(h)}}var b=h(11293),q=h(11347),Y=h(11387),V=h(14620);class I extends V.d{constructor(m){super(M.b,m),this.config=m,this.object=this.registerDataOutput("object",M.b),this.propertyName=this.registerDataOutput("propertyName",M.b),this.setterFunction=this.registerDataOutput("setFunction",M.b,this._setPropertyValue.bind(this)),this.getterFunction=this.registerDataOutput("getFunction",M.b,this._getPropertyValue.bind(this)),this.generateAnimationsFunction=this.registerDataOutput("generateAnimationsFunction",M.b,this._getInterpolationAnimationPropertyInfo.bind(this)),this.templateComponent=new u(m.jsonPointer,this)}_doOperation(m){var S,h,l;const M=this.templateComponent.getAccessor(this.config.pathConverter,m),O=M.info.get(M.object),u=null===(S=(h=M.info).getTarget)||void 0===S?void 0:S.call(h,M.object),b=null===(l=M.info.getPropertyName)||void 0===l?void 0:l[0](M.object);if(!u)throw new Error("Object is undefined");return this.object.setValue(u,m),b&&this.propertyName.setValue(b,m),O}_setPropertyValue(m,S,h,l){var M,O;const u=this.templateComponent.getAccessor(this.config.pathConverter,l),b=u.info.type;b.startsWith("Color")&&(h=Z(h,b)),null===(M=(O=u.info).set)||void 0===M||M.call(O,h,u.object)}_getPropertyValue(m,S,h){const l=this.templateComponent.getAccessor(this.config.pathConverter,h),M=l.info.type,O=l.info.get(l.object);return M.startsWith("Color")?function(m){if(m instanceof Y.RS)return new q.nS(m.r,m.g,m.b);if(m instanceof Y.Bb)return new q.Vector4(m.r,m.g,m.b,m.a);throw new Error("Invalid color type")}(O):O}_getInterpolationAnimationPropertyInfo(m,S,h){const l=this.templateComponent.getAccessor(this.config.pathConverter,h);return(m,S,h,M)=>{var O;const u=[],b=l.info.type;return b.startsWith("Color")&&(m=m.map((m=>({frame:m.frame,value:Z(m.value,b)})))),null===(O=l.info.interpolation)||void 0===O||O.forEach(((S,O)=>{var b;const q=(null===(b=l.info.getPropertyName)||void 0===b?void 0:b[O](l.object))||"Animation-interpolation-"+O;let Y=m;h!==S.type&&(Y=m.map((m=>({frame:m.frame,value:S.getValue(void 0,m.value.DM?m.value.DM():[m.value],0,1)}))));const V=S.buildAnimations(l.object,q,60,Y);for(const m of V)M&&m.babylonAnimation.setEasingFunction(M),u.push(m.babylonAnimation)})),u}}getClassName(){return"FlowGraphJsonPointerParserBlock"}}function Z(m,S){return m.getClassName().startsWith("Color")?m:"RS"===S?new Y.RS(m.x,m.y,m.z):"Bb"===S?new Y.Bb(m.x,m.y,m.z,m.w):m}(0,b.e)("FlowGraphJsonPointerParserBlock",I)},14620:(m,S,h)=>{h.d(S,{d:()=>b});var l=h(13074),M=h(13060);const O="cachedOperationValue",u="cachedExecutionId";class b extends l.d{constructor(m,S){super(S),this.value=this.registerDataOutput("value",m),this.isValid=this.registerDataOutput("isValid",M.e)}_updateOutputs(m){const S=m._getExecutionVariable(this,u,-1),h=m._getExecutionVariable(this,O,null);if(void 0!==h&&null!==h&&S===m.executionId)this.isValid.setValue(!0,m),this.value.setValue(h,m);else try{const S=this._doOperation(m);if(void 0===S||null===S)return void this.isValid.setValue(!1,m);m._setExecutionVariable(this,O,S),m._setExecutionVariable(this,u,m.executionId),this.value.setValue(S,m),this.isValid.setValue(!0,m)}catch(l){this.isValid.setValue(!1,m)}}}}}]);