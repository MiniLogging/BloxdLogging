"use strict";(self.jr1pmf6bwuf=self.jr1pmf6bwuf||[]).push([[93],{16341:(Y,c,h)=>{h.r(c),h.d(c,{FlowGraphJsonPointerParserBlock:()=>q});var C=h(14450),E=h(14459);const N=new RegExp(/\/\{(\w+)\}(?=\/|$)/g);class Q{constructor(Y,c){this.path=Y,this.ownerBlock=c,this.templatedInputs=[];let h=N.exec(Y);const Q=new Set;for(;h;){const[,b]=h;if(Q.has(b))throw new Error("Duplicate template variable detected.");Q.add(b),this.templatedInputs.push(c.registerDataInput(b,E.h,new C.c(0))),h=N.exec(Y)}}getAccessor(Y,c){let h=this.path;for(const C of this.templatedInputs){const Y=C.getValue(c).value;if("number"!==typeof Y||Y<0)throw new Error("Invalid value for templated input.");h=h.replace(`{${C.name}}`,Y.toString())}return Y.convert(h)}}var b=h(12825),H=h(12869),w=h(12920),W=h(16201);class q extends W.d{constructor(Y){super(E.c,Y),this.config=Y,this.object=this.registerDataOutput("object",E.c),this.propertyName=this.registerDataOutput("propertyName",E.c),this.setterFunction=this.registerDataOutput("setFunction",E.c,this._setPropertyValue.bind(this)),this.getterFunction=this.registerDataOutput("getFunction",E.c,this._getPropertyValue.bind(this)),this.generateAnimationsFunction=this.registerDataOutput("generateAnimationsFunction",E.c,this._getInterpolationAnimationPropertyInfo.bind(this)),this.templateComponent=new Q(Y.jsonPointer,this)}_doOperation(Y){var c,h,C;const E=this.templateComponent.getAccessor(this.config.pathConverter,Y),N=E.info.get(E.object),Q=null===(c=(h=E.info).getTarget)||void 0===c?void 0:c.call(h,E.object),b=null===(C=E.info.getPropertyName)||void 0===C?void 0:C[0](E.object);if(!Q)throw new Error("Object is undefined");return this.object.setValue(Q,Y),b&&this.propertyName.setValue(b,Y),N}_setPropertyValue(Y,c,h,C){var E,N;const Q=this.templateComponent.getAccessor(this.config.pathConverter,C),b=Q.info.type;b.startsWith("Color")&&(h=k(h,b)),null===(E=(N=Q.info).set)||void 0===E||E.call(N,h,Q.object)}_getPropertyValue(Y,c,h){const C=this.templateComponent.getAccessor(this.config.pathConverter,h),E=C.info.type,N=C.info.get(C.object);return E.startsWith("Color")?function(Y){if(Y instanceof w.ph)return new H.bh(Y.r,Y.g,Y.b);if(Y instanceof w.vc)return new H.Vector4(Y.r,Y.g,Y.b,Y.a);throw new Error("Invalid color type")}(N):N}_getInterpolationAnimationPropertyInfo(Y,c,h){const C=this.templateComponent.getAccessor(this.config.pathConverter,h);return(Y,c,h,E)=>{var N;const Q=[],b=C.info.type;return b.startsWith("Color")&&(Y=Y.map((Y=>({frame:Y.frame,value:k(Y.value,b)})))),null===(N=C.info.interpolation)||void 0===N||N.forEach(((c,N)=>{var b;const H=(null===(b=C.info.getPropertyName)||void 0===b?void 0:b[N](C.object))||"Animation-interpolation-"+N;let w=Y;h!==c.type&&(w=Y.map((Y=>({frame:Y.frame,value:c.getValue(void 0,Y.value.Xc?Y.value.Xc():[Y.value],0,1)}))));const W=c.buildAnimations(C.object,H,60,w);for(const Y of W)E&&Y.babylonAnimation.setEasingFunction(E),Q.push(Y.babylonAnimation)})),Q}}getClassName(){return"FlowGraphJsonPointerParserBlock"}}function k(Y,c){return Y.getClassName().startsWith("Color")?Y:"ph"===c?new w.ph(Y.x,Y.y,Y.z):"vc"===c?new w.vc(Y.x,Y.y,Y.z,Y.w):Y}(0,b.e)("FlowGraphJsonPointerParserBlock",q)},16201:(Y,c,h)=>{h.d(c,{d:()=>b});var C=h(14482),E=h(14459);const N="cachedOperationValue",Q="cachedExecutionId";class b extends C.b{constructor(Y,c){super(c),this.value=this.registerDataOutput("value",Y),this.isValid=this.registerDataOutput("isValid",E.d)}_updateOutputs(Y){const c=Y._getExecutionVariable(this,Q,-1),h=Y._getExecutionVariable(this,N,null);if(void 0!==h&&null!==h&&c===Y.executionId)this.isValid.setValue(!0,Y),this.value.setValue(h,Y);else try{const c=this._doOperation(Y);if(void 0===c||null===c)return void this.isValid.setValue(!1,Y);Y._setExecutionVariable(this,N,c),Y._setExecutionVariable(this,Q,Y.executionId),this.value.setValue(c,Y),this.isValid.setValue(!0,Y)}catch(C){this.isValid.setValue(!1,Y)}}}}}]);