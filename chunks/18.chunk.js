"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[18],{12650:(K,b,e)=>{e.r(b),e.d(b,{_ExrTextureLoader:()=>H});var z=e(10696),k=e(10984);const j=65536,T=14,F=65537,l=16384;var Y,A;!function(K){K[K.NO_COMPRESSION=0]="NO_COMPRESSION",K[K.RLE_COMPRESSION=1]="RLE_COMPRESSION",K[K.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",K[K.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",K[K.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",K[K.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(Y||(Y={})),function(K){K[K.INCREASING_Y=0]="INCREASING_Y",K[K.DECREASING_Y=1]="DECREASING_Y"}(A||(A={}));const X=function(){const K=new ArrayBuffer(4),b=new Float32Array(K),e=new Uint32Array(K),z=new Uint32Array(512),k=new Uint32Array(512);for(let l=0;l<256;++l){const K=l-127;K<-27?(z[l]=0,z[256|l]=32768,k[l]=24,k[256|l]=24):K<-14?(z[l]=1024>>-K-14,z[256|l]=1024>>-K-14|32768,k[l]=-K-1,k[256|l]=-K-1):K<=15?(z[l]=K+15<<10,z[256|l]=K+15<<10|32768,k[l]=13,k[256|l]=13):K<128?(z[l]=31744,z[256|l]=64512,k[l]=24,k[256|l]=24):(z[l]=31744,z[256|l]=64512,k[l]=13,k[256|l]=13)}const j=new Uint32Array(2048),T=new Uint32Array(64),F=new Uint32Array(64);for(let l=1;l<1024;++l){let K=l<<13,b=0;for(;0===(8388608&K);)K<<=1,b-=8388608;K&=-8388609,b+=947912704,j[l]=K|b}for(let l=1024;l<2048;++l)j[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)T[l]=l<<23;T[31]=1199570944,T[32]=2147483648;for(let l=33;l<63;++l)T[l]=2147483648+(l-32<<23);T[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(F[l]=1024);return{floatView:b,uint32View:e,baseTable:z,shiftTable:k,mantissaTable:j,exponentTable:T,offsetTable:F}}();function t(K,b){const e=new Uint8Array(K);let z=0;for(;0!=e[b.value+z];)z+=1;const k=(new TextDecoder).decode(e.slice(b.value,b.value+z));return b.value=b.value+z+1,k}function U(K,b){const e=K.getInt32(b.value,!0);return b.value+=4,e}function B(K,b){const e=K.getUint32(b.value,!0);return b.value+=4,e}function u(K,b){const e=K.getUint8(b.value);return b.value+=1,e}function m(K,b){const e=K.getUint16(b.value,!0);return b.value+=2,e}function D(K,b){const e=K[b.value];return b.value+=1,e}function I(K,b){let e;return e="getBigInt64"in DataView.prototype?Number(K.getBigInt64(b.value,!0)):K.getUint32(b.value+4,!0)+Number(K.getUint32(b.value,!0)<<32),b.value+=8,e}function x(K,b){const e=K.getFloat32(b.value,!0);return b.value+=4,e}function Q(K,b){return function(K){const b=(31744&K)>>10,e=1023&K;return(K>>15?-1:1)*(b?31===b?e?NaN:1/0:Math.pow(2,b-15)*(1+e/1024):e/1024*6103515625e-14)}(m(K,b))}function G(K,b){return function(K){if(Math.abs(K)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");K=(0,k.e)(K,-65504,65504),X.floatView[0]=K;const b=X.uint32View[0],e=b>>23&511;return X.baseTable[e]+((8388607&b)>>X.shiftTable[e])}(x(K,b))}function i(K,b,e,z){switch(e){case"string":case"stringvector":case"iccProfile":return function(K,b,e){const z=(new TextDecoder).decode(new Uint8Array(K).slice(b.value,b.value+e));return b.value=b.value+e,z}(K.buffer,b,z);case"chlist":return function(K,b,e){const z=b.value,k=[];for(;b.value<z+e-1;){const e=t(K.buffer,b),z=U(K,b),j=u(K,b);b.value+=3;const T=U(K,b),F=U(K,b);k.push({name:e,pixelType:z,pLinear:j,xSampling:T,ySampling:F})}return b.value+=1,k}(K,b,z);case"chromaticities":return function(K,b){return{redX:x(K,b),redY:x(K,b),greenX:x(K,b),greenY:x(K,b),blueX:x(K,b),blueY:x(K,b),whiteX:x(K,b),whiteY:x(K,b)}}(K,b);case"compression":return function(K,b){return u(K,b)}(K,b);case"box2i":return function(K,b){return{xMin:U(K,b),yMin:U(K,b),xMax:U(K,b),yMax:U(K,b)}}(K,b);case"lineOrder":return function(K,b){const e=u(K,b);return A[e]}(K,b);case"float":return x(K,b);case"v2f":return function(K,b){return[x(K,b),x(K,b)]}(K,b);case"v3f":return function(K,b){return[x(K,b),x(K,b),x(K,b)]}(K,b);case"int":return U(K,b);case"rational":return function(K,b){return[U(K,b),B(K,b)]}(K,b);case"timecode":return function(K,b){return[B(K,b),B(K,b)]}(K,b);case"preview":return b.value+=z,"skipped";default:return void(b.value+=z)}}function S(K){for(let b=1;b<K.length;b++){const e=K[b-1]+K[b]-128;K[b]=e}}function M(K,b){let e=0,z=Math.floor((K.length+1)/2),k=0;const j=K.length-1;for(;!(k>j)&&(b[k++]=K[e++],!(k>j));)b[k++]=K[z++]}function r(K,b,e,z,k){for(;e<K;)b=b<<8|D(z,k),e+=8;return{l:b>>(e-=K)&(1<<K)-1,c:b,lc:e}}function L(K,b,e,z){return{c:K=K<<8|D(e,z),lc:b+=8}}function c(K,b,e,z,k,j,T,F,l){if(K==b){if(z<8){const K=L(e,z,k,j);e=K.c,z=K.lc}let K=e>>(z-=8);if(K=new Uint8Array([K])[0],F.value+K>l)return null;const b=T[F.value-1];for(;K-- >0;)T[F.value++]=b}else{if(!(F.value<l))return null;T[F.value++]=K}return{c:e,lc:z}}const v=new Array(59);function w(K,b,e,z,k,j){const T=b;let l=0,Y=0;for(;z<=k;z++){if(T.value-b.value>e)return;let F=r(6,l,Y,K,T);const A=F.l;if(l=F.c,Y=F.lc,j[z]=A,63==A){if(T.value-b.value>e)throw new Error("Error in HufUnpackEncTable");F=r(8,l,Y,K,T);let A=F.l+6;if(l=F.c,Y=F.lc,z+A>k+1)throw new Error("Error in HufUnpackEncTable");for(;A--;)j[z++]=0;z--}else if(A>=59){let K=A-59+2;if(z+K>k+1)throw new Error("Error in HufUnpackEncTable");for(;K--;)j[z++]=0;z--}}!function(K){for(let e=0;e<=58;++e)v[e]=0;for(let e=0;e<F;++e)v[K[e]]+=1;let b=0;for(let e=58;e>0;--e){const K=b+v[e]>>1;v[e]=b,b=K}for(let e=0;e<F;++e){const b=K[e];b>0&&(K[e]=b|v[b]++<<6)}}(j)}function h(K){return 63&K}function R(K){return K>>6}function n(K,b,e,z,k,j){const Y=e.value,A=B(b,e),X=B(b,e);e.value+=4;const t=B(b,e);if(e.value+=4,A<0||A>=F||X<0||X>=F)throw new Error("Wrong HUF_ENCSIZE");const U=new Array(F),u=new Array(l);!function(K){for(let b=0;b<l;b++)K[b]={},K[b].len=0,K[b].lit=0,K[b].p=null}(u);if(w(K,e,z-(e.value-Y),A,X,U),t>8*(z-(e.value-Y)))throw new Error("Wrong hufUncompress");!function(K,b,e,z){for(;b<=e;b++){const e=R(K[b]),k=h(K[b]);if(e>>k)throw new Error("Invalid table entry");if(k>T){const K=z[e>>k-T];if(K.len)throw new Error("Invalid table entry");if(K.lit++,K.p){const b=K.p;K.p=new Array(K.lit);for(let e=0;e<K.lit-1;++e)K.p[e]=b[e]}else K.p=new Array(1);K.p[K.lit-1]=b}else if(k){let K=0;for(let j=1<<T-k;j>0;j--){const j=z[(e<<T-k)+K];if(j.len||j.p)throw new Error("Invalid table entry");j.len=k,j.lit=b,K++}}}}(U,A,X,u),function(K,b,e,z,k,j,F,l,Y){let A=0,X=0;const t=F,U=Math.trunc(z.value+(k+7)/8);for(;z.value<U;){let k=L(A,X,e,z);for(A=k.c,X=k.lc;X>=T;){const F=b[A>>X-T&16383];if(F.len){X-=F.len;const K=c(F.lit,j,A,X,e,z,l,Y,t);K&&(A=K.c,X=K.lc)}else{if(!F.p)throw new Error("hufDecode issues");let b;for(b=0;b<F.lit;b++){const T=h(K[F.p[b]]);for(;X<T&&z.value<U;)k=L(A,X,e,z),A=k.c,X=k.lc;if(X>=T&&R(K[F.p[b]])==(A>>X-T&(1<<T)-1)){X-=T;const K=c(F.p[b],j,A,X,e,z,l,Y,t);K&&(A=K.c,X=K.lc);break}}if(b==F.lit)throw new Error("HufDecode issues")}}}const B=8-k&7;for(A>>=B,X-=B;X>0;){const K=b[A<<T-X&16383];if(!K.len)throw new Error("HufDecode issues");{X-=K.len;const b=c(K.lit,j,A,X,e,z,l,Y,t);b&&(A=b.c,X=b.lc)}}}(U,u,K,e,t,X,j,k,{value:0})}function P(K){return 65535&K}function d(K){const b=P(K);return b>32767?b-65536:b}function p(K,b){const e=d(K),z=d(b),k=e+(1&z)+(z>>1);return{a:k,b:k-z}}function a(K,b){const e=P(K),z=P(b),k=e-(z>>1)&65535;return{a:z+k-32768&65535,b:k}}function O(K,b,e,z,k,j,T){const F=T<16384,l=e>k?k:e;let Y,A,X=1;for(;X<=l;)X<<=1;for(X>>=1,Y=X,X>>=1;X>=1;){A=0;const T=A+j*(k-Y),l=j*X,t=j*Y,U=z*X,B=z*Y;let u,m,D,I;for(;A<=T;A+=t){let k=A;const j=A+z*(e-Y);for(;k<=j;k+=B){const e=k+U,z=k+l,j=z+U;if(F){let T=p(K[k+b],K[z+b]);u=T.a,D=T.b,T=p(K[e+b],K[j+b]),m=T.a,I=T.b,T=p(u,m),K[k+b]=T.a,K[e+b]=T.b,T=p(D,I),K[z+b]=T.a,K[j+b]=T.b}else{let T=a(K[k+b],K[z+b]);u=T.a,D=T.b,T=a(K[e+b],K[j+b]),m=T.a,I=T.b,T=a(u,m),K[k+b]=T.a,K[e+b]=T.b,T=a(D,I),K[z+b]=T.a,K[j+b]=T.b}}if(e&X){const e=k+l;let z;z=F?p(K[k+b],K[e+b]):a(K[k+b],K[e+b]),u=z.a,K[e+b]=z.b,K[k+b]=u}}if(k&X){let k=A;const j=A+z*(e-Y);for(;k<=j;k+=B){const e=k+U;let z;z=F?p(K[k+b],K[e+b]):a(K[k+b],K[e+b]),u=z.a,K[e+b]=z.b,K[k+b]=u}}Y=X,X>>=1}return A}function g(K){return new DataView(K.array.buffer,K.offset.value,K.size)}function N(K){const b=K.viewer.buffer.slice(K.offset.value,K.offset.value+K.size),e=new Uint8Array(function(K){let b=K.byteLength;const e=new Array;let z=0;const k=new DataView(K);for(;b>0;){const K=k.getInt8(z++);if(K<0){const j=-K;b-=j+1;for(let K=0;K<j;K++)e.push(k.getUint8(z++))}else{const j=K;b-=2;const T=k.getUint8(z++);for(let K=0;K<j+1;K++)e.push(T)}}return e}(b)),z=new Uint8Array(e.length);return S(e),M(e,z),new DataView(z.buffer)}function Z(K){const b=K.array.slice(K.offset.value,K.offset.value+K.size),e=fflate.unzlibSync(b),z=new Uint8Array(e.length);return S(e),M(e,z),new DataView(z.buffer)}function y(K){const b=K.array.slice(K.offset.value,K.offset.value+K.size),e=fflate.unzlibSync(b),z=K.lines*K.channels*K.width,k=1==K.type?new Uint16Array(z):new Uint32Array(z);let j=0,T=0;const F=new Array(4);for(let l=0;l<K.lines;l++)for(let b=0;b<K.channels;b++){let b=0;switch(K.type){case 1:F[0]=j,F[1]=F[0]+K.width,j=F[1]+K.width;for(let z=0;z<K.width;++z){b+=e[F[0]++]<<8|e[F[1]++],k[T]=b,T++}break;case 2:F[0]=j,F[1]=F[0]+K.width,F[2]=F[1]+K.width,j=F[2]+K.width;for(let z=0;z<K.width;++z){b+=e[F[0]++]<<24|e[F[1]++]<<16|e[F[2]++]<<8,k[T]=b,T++}}}return new DataView(k.buffer)}function s(K){const b=K.viewer,e={value:K.offset.value},z=new Uint16Array(K.width*K.scanlineBlockSize*(K.channels*K.type)),k=new Uint8Array(8192);let T=0;const F=new Array(K.channels);for(let j=0;j<K.channels;j++)F[j]={},F[j].start=T,F[j].end=F[j].start,F[j].nx=K.width,F[j].ny=K.lines,F[j].size=K.type,T+=F[j].nx*F[j].ny*F[j].size;const l=m(b,e),Y=m(b,e);if(Y>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(l<=Y)for(let j=0;j<Y-l+1;j++)k[j+l]=u(b,e);const A=new Uint16Array(j),X=function(K,b){let e=0;for(let k=0;k<j;++k)(0==k||K[k>>3]&1<<(7&k))&&(b[e++]=k);const z=e-1;for(;e<j;)b[e++]=0;return z}(k,A),t=B(b,e);n(K.array,b,e,t,z,T);for(let j=0;j<K.channels;++j){const K=F[j];for(let b=0;b<F[j].size;++b)O(z,K.start+b,K.nx,K.size,K.ny,K.nx*K.size,X)}!function(K,b,e){for(let z=0;z<e;++z)b[z]=K[b[z]]}(A,z,T);let U=0;const D=new Uint8Array(z.buffer.byteLength);for(let j=0;j<K.lines;j++)for(let b=0;b<K.channels;b++){const K=F[b],e=K.nx*K.size,k=new Uint8Array(z.buffer,2*K.end,2*e);D.set(k,U),U+=2*e,K.end+=e}return new DataView(D.buffer)}var E,o=e(10686);!function(K){K[K.Float=0]="Float",K[K.HalfFloat=1]="HalfFloat"}(E||(E={}));class C{}C.DefaultOutputType=E.HalfFloat,C.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class H{constructor(){this.supportCascades=!1}loadCubeData(K,b,e,z,k){throw".exr not supported in Cube."}async loadData(K,b,e){const k=new DataView(K.buffer),j={value:0},T=function(K,b){if(20000630!=K.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const e=K.getUint8(4),k=K.getUint8(5),j={singleTile:!!(2&k),longName:!!(4&k),deepFormat:!!(8&k),multiPart:!!(16&k)};b.value=8;const T={};let F=!0;for(;F;){const e=t(K.buffer,b);if(e){const k=t(K.buffer,b),j=i(K,b,k,B(K,b));void 0===j?z.b.Warn(`Unknown header attribute type ${k}'.`):T[e]=j}else F=!1}if(0!=(-5&k))throw new Error("Unsupported file format");return{version:e,spec:j,...T}}(k,j),F=await async function(K,b,e,z){const k={size:0,viewer:b,array:new Uint8Array(b.buffer),offset:e,width:K.dataWindow.xMax-K.dataWindow.xMin+1,height:K.dataWindow.yMax-K.dataWindow.yMin+1,channels:K.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(K.compression){case Y.NO_COMPRESSION:k.lines=1,k.uncompress=g;break;case Y.RLE_COMPRESSION:k.lines=1,k.uncompress=N;break;case Y.ZIPS_COMPRESSION:k.lines=1,k.uncompress=Z,await o.f.LoadScriptAsync(C.FFLATEUrl);break;case Y.ZIP_COMPRESSION:k.lines=16,k.uncompress=Z,await o.f.LoadScriptAsync(C.FFLATEUrl);break;case Y.PIZ_COMPRESSION:k.lines=32,k.uncompress=s;break;case Y.PXR24_COMPRESSION:k.lines=16,k.uncompress=y,await o.f.LoadScriptAsync(C.FFLATEUrl);break;default:throw new Error(Y[K.compression]+" is unsupported")}k.scanlineBlockSize=k.lines;const j={};for(const Y of K.channels)switch(Y.name){case"Y":case"R":case"G":case"B":case"A":j[Y.name]=!0,k.type=Y.pixelType}let T=!1;if(j.R&&j.G&&j.B)T=!j.A,k.outputChannels=4,k.decodeChannels={R:0,G:1,B:2,A:3};else{if(!j.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");k.outputChannels=1,k.decodeChannels={Y:0}}if(1===k.type)switch(z){case E.Float:k.getter=Q,k.inputSize=2;break;case E.HalfFloat:k.getter=m,k.inputSize=2}else{if(2!==k.type)throw new Error("Unsupported pixelType "+k.type+" for "+K.compression);switch(z){case E.Float:k.getter=x,k.inputSize=4;break;case E.HalfFloat:k.getter=G,k.inputSize=4}}k.blockCount=k.height/k.scanlineBlockSize;for(let Y=0;Y<k.blockCount;Y++)I(b,e);const F=k.width*k.height*k.outputChannels;switch(z){case E.Float:k.byteArray=new Float32Array(F),k.textureType=1,T&&k.byteArray.fill(1,0,F);break;case E.HalfFloat:k.byteArray=new Uint16Array(F),k.textureType=2,T&&k.byteArray.fill(15360,0,F);break;default:throw new Error("Unsupported type: "+z)}let l=0;for(const Y of K.channels)void 0!==k.decodeChannels[Y.name]&&(k.channelLineOffsets[Y.name]=l*k.width),l+=2*Y.pixelType;return k.bytesPerLine=k.width*l,k.outLineWidth=k.width*k.outputChannels,"INCREASING_Y"===K.lineOrder?k.scanOrder=K=>K:k.scanOrder=K=>k.height-1-K,4==k.outputChannels?(k.format=5,k.linearSpace=!0):(k.format=6,k.linearSpace=!1),k}(T,k,j,C.DefaultOutputType);!function(K,b,e,z){const k={value:0};for(let j=0;j<K.height/K.scanlineBlockSize;j++){const T=U(e,z)-b.dataWindow.yMin;K.size=B(e,z),K.lines=T+K.scanlineBlockSize>K.height?K.height-T:K.scanlineBlockSize;const F=K.size<K.lines*K.bytesPerLine&&K.uncompress?K.uncompress(K):g(K);z.value+=K.size;for(let e=0;e<K.scanlineBlockSize;e++){const z=j*K.scanlineBlockSize,T=e+K.scanOrder(z);if(T>=K.height)continue;const l=e*K.bytesPerLine,Y=(K.height-1-T)*K.outLineWidth;for(let e=0;e<K.channels;e++){const z=b.channels[e].name,j=K.channelLineOffsets[z],T=K.decodeChannels[z];if(void 0!==T){k.value=l+j;for(let b=0;b<K.width;b++){const e=Y+b*K.outputChannels+T;K.byteArray&&(K.byteArray[e]=K.getter(F,k))}}}}}}(F,T,k,j);e(T.dataWindow.xMax-T.dataWindow.xMin+1,T.dataWindow.yMax-T.dataWindow.yMin+1,b.generateMipMaps,!1,(()=>{const K=b.getEngine();b.format=T.format,b.type=F.textureType,b.invertY=!1,b._gammaSpace=!T.linearSpace,F.byteArray&&K._uploadDataToTextureDirectly(b,F.byteArray,0,0,void 0,!0)}))}}}}]);