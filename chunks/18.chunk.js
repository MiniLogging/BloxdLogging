"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[18],{12631:(z,a,K)=>{K.r(a),K.d(a,{_ExrTextureLoader:()=>R});var v=K(10648),T=K(10959);const m=65536,p=14,j=65537,s=16384;var M,r;!function(z){z[z.NO_COMPRESSION=0]="NO_COMPRESSION",z[z.RLE_COMPRESSION=1]="RLE_COMPRESSION",z[z.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",z[z.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",z[z.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",z[z.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(M||(M={})),function(z){z[z.INCREASING_Y=0]="INCREASING_Y",z[z.DECREASING_Y=1]="DECREASING_Y"}(r||(r={}));const W=function(){const z=new ArrayBuffer(4),a=new Float32Array(z),K=new Uint32Array(z),v=new Uint32Array(512),T=new Uint32Array(512);for(let s=0;s<256;++s){const z=s-127;z<-27?(v[s]=0,v[256|s]=32768,T[s]=24,T[256|s]=24):z<-14?(v[s]=1024>>-z-14,v[256|s]=1024>>-z-14|32768,T[s]=-z-1,T[256|s]=-z-1):z<=15?(v[s]=z+15<<10,v[256|s]=z+15<<10|32768,T[s]=13,T[256|s]=13):z<128?(v[s]=31744,v[256|s]=64512,T[s]=24,T[256|s]=24):(v[s]=31744,v[256|s]=64512,T[s]=13,T[256|s]=13)}const m=new Uint32Array(2048),p=new Uint32Array(64),j=new Uint32Array(64);for(let s=1;s<1024;++s){let z=s<<13,a=0;for(;0===(8388608&z);)z<<=1,a-=8388608;z&=-8388609,a+=947912704,m[s]=z|a}for(let s=1024;s<2048;++s)m[s]=939524096+(s-1024<<13);for(let s=1;s<31;++s)p[s]=s<<23;p[31]=1199570944,p[32]=2147483648;for(let s=33;s<63;++s)p[s]=2147483648+(s-32<<23);p[63]=3347054592;for(let s=1;s<64;++s)32!==s&&(j[s]=1024);return{floatView:a,uint32View:K,baseTable:v,shiftTable:T,mantissaTable:m,exponentTable:p,offsetTable:j}}();function F(z,a){const K=new Uint8Array(z);let v=0;for(;0!=K[a.value+v];)v+=1;const T=(new TextDecoder).decode(K.slice(a.value,a.value+v));return a.value=a.value+v+1,T}function G(z,a){const K=z.getInt32(a.value,!0);return a.value+=4,K}function l(z,a){const K=z.getUint32(a.value,!0);return a.value+=4,K}function V(z,a){const K=z.getUint8(a.value);return a.value+=1,K}function c(z,a){const K=z.getUint16(a.value,!0);return a.value+=2,K}function C(z,a){const K=z[a.value];return a.value+=1,K}function w(z,a){let K;return K="getBigInt64"in DataView.prototype?Number(z.getBigInt64(a.value,!0)):z.getUint32(a.value+4,!0)+Number(z.getUint32(a.value,!0)<<32),a.value+=8,K}function H(z,a){const K=z.getFloat32(a.value,!0);return a.value+=4,K}function f(z,a){return function(z){const a=(31744&z)>>10,K=1023&z;return(z>>15?-1:1)*(a?31===a?K?NaN:1/0:Math.pow(2,a-15)*(1+K/1024):K/1024*6103515625e-14)}(c(z,a))}function Y(z,a){return function(z){if(Math.abs(z)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");z=(0,T.e)(z,-65504,65504),W.floatView[0]=z;const a=W.uint32View[0],K=a>>23&511;return W.baseTable[K]+((8388607&a)>>W.shiftTable[K])}(H(z,a))}function I(z,a,K,v){switch(K){case"string":case"stringvector":case"iccProfile":return function(z,a,K){const v=(new TextDecoder).decode(new Uint8Array(z).slice(a.value,a.value+K));return a.value=a.value+K,v}(z.buffer,a,v);case"chlist":return function(z,a,K){const v=a.value,T=[];for(;a.value<v+K-1;){const K=F(z.buffer,a),v=G(z,a),m=V(z,a);a.value+=3;const p=G(z,a),j=G(z,a);T.push({name:K,pixelType:v,pLinear:m,xSampling:p,ySampling:j})}return a.value+=1,T}(z,a,v);case"chromaticities":return function(z,a){return{redX:H(z,a),redY:H(z,a),greenX:H(z,a),greenY:H(z,a),blueX:H(z,a),blueY:H(z,a),whiteX:H(z,a),whiteY:H(z,a)}}(z,a);case"compression":return function(z,a){return V(z,a)}(z,a);case"box2i":return function(z,a){return{xMin:G(z,a),yMin:G(z,a),xMax:G(z,a),yMax:G(z,a)}}(z,a);case"lineOrder":return function(z,a){const K=V(z,a);return r[K]}(z,a);case"float":return H(z,a);case"v2f":return function(z,a){return[H(z,a),H(z,a)]}(z,a);case"v3f":return function(z,a){return[H(z,a),H(z,a),H(z,a)]}(z,a);case"int":return G(z,a);case"rational":return function(z,a){return[G(z,a),l(z,a)]}(z,a);case"timecode":return function(z,a){return[l(z,a),l(z,a)]}(z,a);case"preview":return a.value+=v,"skipped";default:return void(a.value+=v)}}function q(z){for(let a=1;a<z.length;a++){const K=z[a-1]+z[a]-128;z[a]=K}}function B(z,a){let K=0,v=Math.floor((z.length+1)/2),T=0;const m=z.length-1;for(;!(T>m)&&(a[T++]=z[K++],!(T>m));)a[T++]=z[v++]}function x(z,a,K,v,T){for(;K<z;)a=a<<8|C(v,T),K+=8;return{l:a>>(K-=z)&(1<<z)-1,c:a,lc:K}}function Z(z,a,K,v){return{c:z=z<<8|C(K,v),lc:a+=8}}function y(z,a,K,v,T,m,p,j,s){if(z==a){if(v<8){const z=Z(K,v,T,m);K=z.c,v=z.lc}let z=K>>(v-=8);if(z=new Uint8Array([z])[0],j.value+z>s)return null;const a=p[j.value-1];for(;z-- >0;)p[j.value++]=a}else{if(!(j.value<s))return null;p[j.value++]=z}return{c:K,lc:v}}const i=new Array(59);function n(z,a,K,v,T,m){const p=a;let s=0,M=0;for(;v<=T;v++){if(p.value-a.value>K)return;let j=x(6,s,M,z,p);const r=j.l;if(s=j.c,M=j.lc,m[v]=r,63==r){if(p.value-a.value>K)throw new Error("Error in HufUnpackEncTable");j=x(8,s,M,z,p);let r=j.l+6;if(s=j.c,M=j.lc,v+r>T+1)throw new Error("Error in HufUnpackEncTable");for(;r--;)m[v++]=0;v--}else if(r>=59){let z=r-59+2;if(v+z>T+1)throw new Error("Error in HufUnpackEncTable");for(;z--;)m[v++]=0;v--}}!function(z){for(let K=0;K<=58;++K)i[K]=0;for(let K=0;K<j;++K)i[z[K]]+=1;let a=0;for(let K=58;K>0;--K){const z=a+i[K]>>1;i[K]=a,a=z}for(let K=0;K<j;++K){const a=z[K];a>0&&(z[K]=a|i[a]++<<6)}}(m)}function X(z){return 63&z}function P(z){return z>>6}function J(z,a,K,v,T,m){const M=K.value,r=l(a,K),W=l(a,K);K.value+=4;const F=l(a,K);if(K.value+=4,r<0||r>=j||W<0||W>=j)throw new Error("Wrong HUF_ENCSIZE");const G=new Array(j),V=new Array(s);!function(z){for(let a=0;a<s;a++)z[a]={},z[a].len=0,z[a].lit=0,z[a].p=null}(V);if(n(z,K,v-(K.value-M),r,W,G),F>8*(v-(K.value-M)))throw new Error("Wrong hufUncompress");!function(z,a,K,v){for(;a<=K;a++){const K=P(z[a]),T=X(z[a]);if(K>>T)throw new Error("Invalid table entry");if(T>p){const z=v[K>>T-p];if(z.len)throw new Error("Invalid table entry");if(z.lit++,z.p){const a=z.p;z.p=new Array(z.lit);for(let K=0;K<z.lit-1;++K)z.p[K]=a[K]}else z.p=new Array(1);z.p[z.lit-1]=a}else if(T){let z=0;for(let m=1<<p-T;m>0;m--){const m=v[(K<<p-T)+z];if(m.len||m.p)throw new Error("Invalid table entry");m.len=T,m.lit=a,z++}}}}(G,r,W,V),function(z,a,K,v,T,m,j,s,M){let r=0,W=0;const F=j,G=Math.trunc(v.value+(T+7)/8);for(;v.value<G;){let T=Z(r,W,K,v);for(r=T.c,W=T.lc;W>=p;){const j=a[r>>W-p&16383];if(j.len){W-=j.len;const z=y(j.lit,m,r,W,K,v,s,M,F);z&&(r=z.c,W=z.lc)}else{if(!j.p)throw new Error("hufDecode issues");let a;for(a=0;a<j.lit;a++){const p=X(z[j.p[a]]);for(;W<p&&v.value<G;)T=Z(r,W,K,v),r=T.c,W=T.lc;if(W>=p&&P(z[j.p[a]])==(r>>W-p&(1<<p)-1)){W-=p;const z=y(j.p[a],m,r,W,K,v,s,M,F);z&&(r=z.c,W=z.lc);break}}if(a==j.lit)throw new Error("HufDecode issues")}}}const l=8-T&7;for(r>>=l,W-=l;W>0;){const z=a[r<<p-W&16383];if(!z.len)throw new Error("HufDecode issues");{W-=z.len;const a=y(z.lit,m,r,W,K,v,s,M,F);a&&(r=a.c,W=a.lc)}}}(G,V,z,K,F,W,m,T,{value:0})}function o(z){return 65535&z}function N(z){const a=o(z);return a>32767?a-65536:a}function A(z,a){const K=N(z),v=N(a),T=K+(1&v)+(v>>1);return{a:T,b:T-v}}function g(z,a){const K=o(z),v=o(a),T=K-(v>>1)&65535;return{a:v+T-32768&65535,b:T}}function d(z,a,K,v,T,m,p){const j=p<16384,s=K>T?T:K;let M,r,W=1;for(;W<=s;)W<<=1;for(W>>=1,M=W,W>>=1;W>=1;){r=0;const p=r+m*(T-M),s=m*W,F=m*M,G=v*W,l=v*M;let V,c,C,w;for(;r<=p;r+=F){let T=r;const m=r+v*(K-M);for(;T<=m;T+=l){const K=T+G,v=T+s,m=v+G;if(j){let p=A(z[T+a],z[v+a]);V=p.a,C=p.b,p=A(z[K+a],z[m+a]),c=p.a,w=p.b,p=A(V,c),z[T+a]=p.a,z[K+a]=p.b,p=A(C,w),z[v+a]=p.a,z[m+a]=p.b}else{let p=g(z[T+a],z[v+a]);V=p.a,C=p.b,p=g(z[K+a],z[m+a]),c=p.a,w=p.b,p=g(V,c),z[T+a]=p.a,z[K+a]=p.b,p=g(C,w),z[v+a]=p.a,z[m+a]=p.b}}if(K&W){const K=T+s;let v;v=j?A(z[T+a],z[K+a]):g(z[T+a],z[K+a]),V=v.a,z[K+a]=v.b,z[T+a]=V}}if(T&W){let T=r;const m=r+v*(K-M);for(;T<=m;T+=l){const K=T+G;let v;v=j?A(z[T+a],z[K+a]):g(z[T+a],z[K+a]),V=v.a,z[K+a]=v.b,z[T+a]=V}}M=W,W>>=1}return r}function t(z){return new DataView(z.array.buffer,z.offset.value,z.size)}function e(z){const a=z.viewer.buffer.slice(z.offset.value,z.offset.value+z.size),K=new Uint8Array(function(z){let a=z.byteLength;const K=new Array;let v=0;const T=new DataView(z);for(;a>0;){const z=T.getInt8(v++);if(z<0){const m=-z;a-=m+1;for(let z=0;z<m;z++)K.push(T.getUint8(v++))}else{const m=z;a-=2;const p=T.getUint8(v++);for(let z=0;z<m+1;z++)K.push(p)}}return K}(a)),v=new Uint8Array(K.length);return q(K),B(K,v),new DataView(v.buffer)}function L(z){const a=z.array.slice(z.offset.value,z.offset.value+z.size),K=fflate.unzlibSync(a),v=new Uint8Array(K.length);return q(K),B(K,v),new DataView(v.buffer)}function E(z){const a=z.array.slice(z.offset.value,z.offset.value+z.size),K=fflate.unzlibSync(a),v=z.lines*z.channels*z.width,T=1==z.type?new Uint16Array(v):new Uint32Array(v);let m=0,p=0;const j=new Array(4);for(let s=0;s<z.lines;s++)for(let a=0;a<z.channels;a++){let a=0;switch(z.type){case 1:j[0]=m,j[1]=j[0]+z.width,m=j[1]+z.width;for(let v=0;v<z.width;++v){a+=K[j[0]++]<<8|K[j[1]++],T[p]=a,p++}break;case 2:j[0]=m,j[1]=j[0]+z.width,j[2]=j[1]+z.width,m=j[2]+z.width;for(let v=0;v<z.width;++v){a+=K[j[0]++]<<24|K[j[1]++]<<16|K[j[2]++]<<8,T[p]=a,p++}}}return new DataView(T.buffer)}function b(z){const a=z.viewer,K={value:z.offset.value},v=new Uint16Array(z.width*z.scanlineBlockSize*(z.channels*z.type)),T=new Uint8Array(8192);let p=0;const j=new Array(z.channels);for(let m=0;m<z.channels;m++)j[m]={},j[m].start=p,j[m].end=j[m].start,j[m].nx=z.width,j[m].ny=z.lines,j[m].size=z.type,p+=j[m].nx*j[m].ny*j[m].size;const s=c(a,K),M=c(a,K);if(M>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(s<=M)for(let m=0;m<M-s+1;m++)T[m+s]=V(a,K);const r=new Uint16Array(m),W=function(z,a){let K=0;for(let T=0;T<m;++T)(0==T||z[T>>3]&1<<(7&T))&&(a[K++]=T);const v=K-1;for(;K<m;)a[K++]=0;return v}(T,r),F=l(a,K);J(z.array,a,K,F,v,p);for(let m=0;m<z.channels;++m){const z=j[m];for(let a=0;a<j[m].size;++a)d(v,z.start+a,z.nx,z.size,z.ny,z.nx*z.size,W)}!function(z,a,K){for(let v=0;v<K;++v)a[v]=z[a[v]]}(r,v,p);let G=0;const C=new Uint8Array(v.buffer.byteLength);for(let m=0;m<z.lines;m++)for(let a=0;a<z.channels;a++){const z=j[a],K=z.nx*z.size,T=new Uint8Array(v.buffer,2*z.end,2*K);C.set(T,G),G+=2*K,z.end+=K}return new DataView(C.buffer)}var D,u=K(10631);!function(z){z[z.Float=0]="Float",z[z.HalfFloat=1]="HalfFloat"}(D||(D={}));class U{}U.DefaultOutputType=D.HalfFloat,U.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class R{constructor(){this.supportCascades=!1}loadCubeData(z,a,K,v,T){throw".exr not supported in Cube."}async loadData(z,a,K){const T=new DataView(z.buffer),m={value:0},p=function(z,a){if(20000630!=z.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const K=z.getUint8(4),T=z.getUint8(5),m={singleTile:!!(2&T),longName:!!(4&T),deepFormat:!!(8&T),multiPart:!!(16&T)};a.value=8;const p={};let j=!0;for(;j;){const K=F(z.buffer,a);if(K){const T=F(z.buffer,a),m=I(z,a,T,l(z,a));void 0===m?v.c.Warn(`Unknown header attribute type ${T}'.`):p[K]=m}else j=!1}if(0!=(-5&T))throw new Error("Unsupported file format");return{version:K,spec:m,...p}}(T,m),j=await async function(z,a,K,v){const T={size:0,viewer:a,array:new Uint8Array(a.buffer),offset:K,width:z.dataWindow.xMax-z.dataWindow.xMin+1,height:z.dataWindow.yMax-z.dataWindow.yMin+1,channels:z.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(z.compression){case M.NO_COMPRESSION:T.lines=1,T.uncompress=t;break;case M.RLE_COMPRESSION:T.lines=1,T.uncompress=e;break;case M.ZIPS_COMPRESSION:T.lines=1,T.uncompress=L,await u.h.LoadScriptAsync(U.FFLATEUrl);break;case M.ZIP_COMPRESSION:T.lines=16,T.uncompress=L,await u.h.LoadScriptAsync(U.FFLATEUrl);break;case M.PIZ_COMPRESSION:T.lines=32,T.uncompress=b;break;case M.PXR24_COMPRESSION:T.lines=16,T.uncompress=E,await u.h.LoadScriptAsync(U.FFLATEUrl);break;default:throw new Error(M[z.compression]+" is unsupported")}T.scanlineBlockSize=T.lines;const m={};for(const M of z.channels)switch(M.name){case"Y":case"R":case"G":case"B":case"A":m[M.name]=!0,T.type=M.pixelType}let p=!1;if(m.R&&m.G&&m.B)p=!m.A,T.outputChannels=4,T.decodeChannels={R:0,G:1,B:2,A:3};else{if(!m.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");T.outputChannels=1,T.decodeChannels={Y:0}}if(1===T.type)switch(v){case D.Float:T.getter=f,T.inputSize=2;break;case D.HalfFloat:T.getter=c,T.inputSize=2}else{if(2!==T.type)throw new Error("Unsupported pixelType "+T.type+" for "+z.compression);switch(v){case D.Float:T.getter=H,T.inputSize=4;break;case D.HalfFloat:T.getter=Y,T.inputSize=4}}T.blockCount=T.height/T.scanlineBlockSize;for(let M=0;M<T.blockCount;M++)w(a,K);const j=T.width*T.height*T.outputChannels;switch(v){case D.Float:T.byteArray=new Float32Array(j),T.textureType=1,p&&T.byteArray.fill(1,0,j);break;case D.HalfFloat:T.byteArray=new Uint16Array(j),T.textureType=2,p&&T.byteArray.fill(15360,0,j);break;default:throw new Error("Unsupported type: "+v)}let s=0;for(const M of z.channels)void 0!==T.decodeChannels[M.name]&&(T.channelLineOffsets[M.name]=s*T.width),s+=2*M.pixelType;return T.bytesPerLine=T.width*s,T.outLineWidth=T.width*T.outputChannels,"INCREASING_Y"===z.lineOrder?T.scanOrder=z=>z:T.scanOrder=z=>T.height-1-z,4==T.outputChannels?(T.format=5,T.linearSpace=!0):(T.format=6,T.linearSpace=!1),T}(p,T,m,U.DefaultOutputType);!function(z,a,K,v){const T={value:0};for(let m=0;m<z.height/z.scanlineBlockSize;m++){const p=G(K,v)-a.dataWindow.yMin;z.size=l(K,v),z.lines=p+z.scanlineBlockSize>z.height?z.height-p:z.scanlineBlockSize;const j=z.size<z.lines*z.bytesPerLine&&z.uncompress?z.uncompress(z):t(z);v.value+=z.size;for(let K=0;K<z.scanlineBlockSize;K++){const v=m*z.scanlineBlockSize,p=K+z.scanOrder(v);if(p>=z.height)continue;const s=K*z.bytesPerLine,M=(z.height-1-p)*z.outLineWidth;for(let K=0;K<z.channels;K++){const v=a.channels[K].name,m=z.channelLineOffsets[v],p=z.decodeChannels[v];if(void 0!==p){T.value=s+m;for(let a=0;a<z.width;a++){const K=M+a*z.outputChannels+p;z.byteArray&&(z.byteArray[K]=z.getter(j,T))}}}}}}(j,p,T,m);K(p.dataWindow.xMax-p.dataWindow.xMin+1,p.dataWindow.yMax-p.dataWindow.yMin+1,a.generateMipMaps,!1,(()=>{const z=a.getEngine();a.format=p.format,a.type=j.textureType,a.invertY=!1,a._gammaSpace=!p.linearSpace,j.byteArray&&z._uploadDataToTextureDirectly(a,j.byteArray,0,0,void 0,!0)}))}}}}]);