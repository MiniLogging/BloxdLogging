"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[18],{12859:(E,b,h)=>{h.r(b),h.d(b,{_ExrTextureLoader:()=>C});var a=h(10834),k=h(11186);const G=65536,V=14,l=65537,O=16384;var v,s;!function(E){E[E.NO_COMPRESSION=0]="NO_COMPRESSION",E[E.RLE_COMPRESSION=1]="RLE_COMPRESSION",E[E.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",E[E.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",E[E.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",E[E.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(v||(v={})),function(E){E[E.INCREASING_Y=0]="INCREASING_Y",E[E.DECREASING_Y=1]="DECREASING_Y"}(s||(s={}));const U=function(){const E=new ArrayBuffer(4),b=new Float32Array(E),h=new Uint32Array(E),a=new Uint32Array(512),k=new Uint32Array(512);for(let O=0;O<256;++O){const E=O-127;E<-27?(a[O]=0,a[256|O]=32768,k[O]=24,k[256|O]=24):E<-14?(a[O]=1024>>-E-14,a[256|O]=1024>>-E-14|32768,k[O]=-E-1,k[256|O]=-E-1):E<=15?(a[O]=E+15<<10,a[256|O]=E+15<<10|32768,k[O]=13,k[256|O]=13):E<128?(a[O]=31744,a[256|O]=64512,k[O]=24,k[256|O]=24):(a[O]=31744,a[256|O]=64512,k[O]=13,k[256|O]=13)}const G=new Uint32Array(2048),V=new Uint32Array(64),l=new Uint32Array(64);for(let O=1;O<1024;++O){let E=O<<13,b=0;for(;0===(8388608&E);)E<<=1,b-=8388608;E&=-8388609,b+=947912704,G[O]=E|b}for(let O=1024;O<2048;++O)G[O]=939524096+(O-1024<<13);for(let O=1;O<31;++O)V[O]=O<<23;V[31]=1199570944,V[32]=2147483648;for(let O=33;O<63;++O)V[O]=2147483648+(O-32<<23);V[63]=3347054592;for(let O=1;O<64;++O)32!==O&&(l[O]=1024);return{floatView:b,uint32View:h,baseTable:a,shiftTable:k,mantissaTable:G,exponentTable:V,offsetTable:l}}();function B(E,b){const h=new Uint8Array(E);let a=0;for(;0!=h[b.value+a];)a+=1;const k=(new TextDecoder).decode(h.slice(b.value,b.value+a));return b.value=b.value+a+1,k}function o(E,b){const h=E.getInt32(b.value,!0);return b.value+=4,h}function u(E,b){const h=E.getUint32(b.value,!0);return b.value+=4,h}function D(E,b){const h=E.getUint8(b.value);return b.value+=1,h}function g(E,b){const h=E.getUint16(b.value,!0);return b.value+=2,h}function S(E,b){const h=E[b.value];return b.value+=1,h}function M(E,b){let h;return h="getBigInt64"in DataView.prototype?Number(E.getBigInt64(b.value,!0)):E.getUint32(b.value+4,!0)+Number(E.getUint32(b.value,!0)<<32),b.value+=8,h}function I(E,b){const h=E.getFloat32(b.value,!0);return b.value+=4,h}function j(E,b){return function(E){const b=(31744&E)>>10,h=1023&E;return(E>>15?-1:1)*(b?31===b?h?NaN:1/0:Math.pow(2,b-15)*(1+h/1024):h/1024*6103515625e-14)}(g(E,b))}function P(E,b){return function(E){if(Math.abs(E)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");E=(0,k.b)(E,-65504,65504),U.floatView[0]=E;const b=U.uint32View[0],h=b>>23&511;return U.baseTable[h]+((8388607&b)>>U.shiftTable[h])}(I(E,b))}function A(E,b,h,a){switch(h){case"string":case"stringvector":case"iccProfile":return function(E,b,h){const a=(new TextDecoder).decode(new Uint8Array(E).slice(b.value,b.value+h));return b.value=b.value+h,a}(E.buffer,b,a);case"chlist":return function(E,b,h){const a=b.value,k=[];for(;b.value<a+h-1;){const h=B(E.buffer,b),a=o(E,b),G=D(E,b);b.value+=3;const V=o(E,b),l=o(E,b);k.push({name:h,pixelType:a,pLinear:G,xSampling:V,ySampling:l})}return b.value+=1,k}(E,b,a);case"chromaticities":return function(E,b){return{redX:I(E,b),redY:I(E,b),greenX:I(E,b),greenY:I(E,b),blueX:I(E,b),blueY:I(E,b),whiteX:I(E,b),whiteY:I(E,b)}}(E,b);case"compression":return function(E,b){return D(E,b)}(E,b);case"box2i":return function(E,b){return{xMin:o(E,b),yMin:o(E,b),xMax:o(E,b),yMax:o(E,b)}}(E,b);case"lineOrder":return function(E,b){const h=D(E,b);return s[h]}(E,b);case"float":return I(E,b);case"v2f":return function(E,b){return[I(E,b),I(E,b)]}(E,b);case"v3f":return function(E,b){return[I(E,b),I(E,b),I(E,b)]}(E,b);case"int":return o(E,b);case"rational":return function(E,b){return[o(E,b),u(E,b)]}(E,b);case"timecode":return function(E,b){return[u(E,b),u(E,b)]}(E,b);case"preview":return b.value+=a,"skipped";default:return void(b.value+=a)}}function n(E){for(let b=1;b<E.length;b++){const h=E[b-1]+E[b]-128;E[b]=h}}function d(E,b){let h=0,a=Math.floor((E.length+1)/2),k=0;const G=E.length-1;for(;!(k>G)&&(b[k++]=E[h++],!(k>G));)b[k++]=E[a++]}function c(E,b,h,a,k){for(;h<E;)b=b<<8|S(a,k),h+=8;return{l:b>>(h-=E)&(1<<E)-1,c:b,lc:h}}function z(E,b,h,a){return{c:E=E<<8|S(h,a),lc:b+=8}}function Z(E,b,h,a,k,G,V,l,O){if(E==b){if(a<8){const E=z(h,a,k,G);h=E.c,a=E.lc}let E=h>>(a-=8);if(E=new Uint8Array([E])[0],l.value+E>O)return null;const b=V[l.value-1];for(;E-- >0;)V[l.value++]=b}else{if(!(l.value<O))return null;V[l.value++]=E}return{c:h,lc:a}}const Y=new Array(59);function r(E,b,h,a,k,G){const V=b;let O=0,v=0;for(;a<=k;a++){if(V.value-b.value>h)return;let l=c(6,O,v,E,V);const s=l.l;if(O=l.c,v=l.lc,G[a]=s,63==s){if(V.value-b.value>h)throw new Error("Error in HufUnpackEncTable");l=c(8,O,v,E,V);let s=l.l+6;if(O=l.c,v=l.lc,a+s>k+1)throw new Error("Error in HufUnpackEncTable");for(;s--;)G[a++]=0;a--}else if(s>=59){let E=s-59+2;if(a+E>k+1)throw new Error("Error in HufUnpackEncTable");for(;E--;)G[a++]=0;a--}}!function(E){for(let h=0;h<=58;++h)Y[h]=0;for(let h=0;h<l;++h)Y[E[h]]+=1;let b=0;for(let h=58;h>0;--h){const E=b+Y[h]>>1;Y[h]=b,b=E}for(let h=0;h<l;++h){const b=E[h];b>0&&(E[h]=b|Y[b]++<<6)}}(G)}function w(E){return 63&E}function N(E){return E>>6}function H(E,b,h,a,k,G){const v=h.value,s=u(b,h),U=u(b,h);h.value+=4;const B=u(b,h);if(h.value+=4,s<0||s>=l||U<0||U>=l)throw new Error("Wrong HUF_ENCSIZE");const o=new Array(l),D=new Array(O);!function(E){for(let b=0;b<O;b++)E[b]={},E[b].len=0,E[b].lit=0,E[b].p=null}(D);if(r(E,h,a-(h.value-v),s,U,o),B>8*(a-(h.value-v)))throw new Error("Wrong hufUncompress");!function(E,b,h,a){for(;b<=h;b++){const h=N(E[b]),k=w(E[b]);if(h>>k)throw new Error("Invalid table entry");if(k>V){const E=a[h>>k-V];if(E.len)throw new Error("Invalid table entry");if(E.lit++,E.p){const b=E.p;E.p=new Array(E.lit);for(let h=0;h<E.lit-1;++h)E.p[h]=b[h]}else E.p=new Array(1);E.p[E.lit-1]=b}else if(k){let E=0;for(let G=1<<V-k;G>0;G--){const G=a[(h<<V-k)+E];if(G.len||G.p)throw new Error("Invalid table entry");G.len=k,G.lit=b,E++}}}}(o,s,U,D),function(E,b,h,a,k,G,l,O,v){let s=0,U=0;const B=l,o=Math.trunc(a.value+(k+7)/8);for(;a.value<o;){let k=z(s,U,h,a);for(s=k.c,U=k.lc;U>=V;){const l=b[s>>U-V&16383];if(l.len){U-=l.len;const E=Z(l.lit,G,s,U,h,a,O,v,B);E&&(s=E.c,U=E.lc)}else{if(!l.p)throw new Error("hufDecode issues");let b;for(b=0;b<l.lit;b++){const V=w(E[l.p[b]]);for(;U<V&&a.value<o;)k=z(s,U,h,a),s=k.c,U=k.lc;if(U>=V&&N(E[l.p[b]])==(s>>U-V&(1<<V)-1)){U-=V;const E=Z(l.p[b],G,s,U,h,a,O,v,B);E&&(s=E.c,U=E.lc);break}}if(b==l.lit)throw new Error("HufDecode issues")}}}const u=8-k&7;for(s>>=u,U-=u;U>0;){const E=b[s<<V-U&16383];if(!E.len)throw new Error("HufDecode issues");{U-=E.len;const b=Z(E.lit,G,s,U,h,a,O,v,B);b&&(s=b.c,U=b.lc)}}}(o,D,E,h,B,U,G,k,{value:0})}function f(E){return 65535&E}function F(E){const b=f(E);return b>32767?b-65536:b}function y(E,b){const h=F(E),a=F(b),k=h+(1&a)+(a>>1);return{a:k,b:k-a}}function e(E,b){const h=f(E),a=f(b),k=h-(a>>1)&65535;return{a:a+k-32768&65535,b:k}}function J(E,b,h,a,k,G,V){const l=V<16384,O=h>k?k:h;let v,s,U=1;for(;U<=O;)U<<=1;for(U>>=1,v=U,U>>=1;U>=1;){s=0;const V=s+G*(k-v),O=G*U,B=G*v,o=a*U,u=a*v;let D,g,S,M;for(;s<=V;s+=B){let k=s;const G=s+a*(h-v);for(;k<=G;k+=u){const h=k+o,a=k+O,G=a+o;if(l){let V=y(E[k+b],E[a+b]);D=V.a,S=V.b,V=y(E[h+b],E[G+b]),g=V.a,M=V.b,V=y(D,g),E[k+b]=V.a,E[h+b]=V.b,V=y(S,M),E[a+b]=V.a,E[G+b]=V.b}else{let V=e(E[k+b],E[a+b]);D=V.a,S=V.b,V=e(E[h+b],E[G+b]),g=V.a,M=V.b,V=e(D,g),E[k+b]=V.a,E[h+b]=V.b,V=e(S,M),E[a+b]=V.a,E[G+b]=V.b}}if(h&U){const h=k+O;let a;a=l?y(E[k+b],E[h+b]):e(E[k+b],E[h+b]),D=a.a,E[h+b]=a.b,E[k+b]=D}}if(k&U){let k=s;const G=s+a*(h-v);for(;k<=G;k+=u){const h=k+o;let a;a=l?y(E[k+b],E[h+b]):e(E[k+b],E[h+b]),D=a.a,E[h+b]=a.b,E[k+b]=D}}v=U,U>>=1}return s}function m(E){return new DataView(E.array.buffer,E.offset.value,E.size)}function K(E){const b=E.viewer.buffer.slice(E.offset.value,E.offset.value+E.size),h=new Uint8Array(function(E){let b=E.byteLength;const h=new Array;let a=0;const k=new DataView(E);for(;b>0;){const E=k.getInt8(a++);if(E<0){const G=-E;b-=G+1;for(let E=0;E<G;E++)h.push(k.getUint8(a++))}else{const G=E;b-=2;const V=k.getUint8(a++);for(let E=0;E<G+1;E++)h.push(V)}}return h}(b)),a=new Uint8Array(h.length);return n(h),d(h,a),new DataView(a.buffer)}function x(E){const b=E.array.slice(E.offset.value,E.offset.value+E.size),h=fflate.unzlibSync(b),a=new Uint8Array(h.length);return n(h),d(h,a),new DataView(a.buffer)}function W(E){const b=E.array.slice(E.offset.value,E.offset.value+E.size),h=fflate.unzlibSync(b),a=E.lines*E.channels*E.width,k=1==E.type?new Uint16Array(a):new Uint32Array(a);let G=0,V=0;const l=new Array(4);for(let O=0;O<E.lines;O++)for(let b=0;b<E.channels;b++){let b=0;switch(E.type){case 1:l[0]=G,l[1]=l[0]+E.width,G=l[1]+E.width;for(let a=0;a<E.width;++a){b+=h[l[0]++]<<8|h[l[1]++],k[V]=b,V++}break;case 2:l[0]=G,l[1]=l[0]+E.width,l[2]=l[1]+E.width,G=l[2]+E.width;for(let a=0;a<E.width;++a){b+=h[l[0]++]<<24|h[l[1]++]<<16|h[l[2]++]<<8,k[V]=b,V++}}}return new DataView(k.buffer)}function L(E){const b=E.viewer,h={value:E.offset.value},a=new Uint16Array(E.width*E.scanlineBlockSize*(E.channels*E.type)),k=new Uint8Array(8192);let V=0;const l=new Array(E.channels);for(let G=0;G<E.channels;G++)l[G]={},l[G].start=V,l[G].end=l[G].start,l[G].nx=E.width,l[G].ny=E.lines,l[G].size=E.type,V+=l[G].nx*l[G].ny*l[G].size;const O=g(b,h),v=g(b,h);if(v>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(O<=v)for(let G=0;G<v-O+1;G++)k[G+O]=D(b,h);const s=new Uint16Array(G),U=function(E,b){let h=0;for(let k=0;k<G;++k)(0==k||E[k>>3]&1<<(7&k))&&(b[h++]=k);const a=h-1;for(;h<G;)b[h++]=0;return a}(k,s),B=u(b,h);H(E.array,b,h,B,a,V);for(let G=0;G<E.channels;++G){const E=l[G];for(let b=0;b<l[G].size;++b)J(a,E.start+b,E.nx,E.size,E.ny,E.nx*E.size,U)}!function(E,b,h){for(let a=0;a<h;++a)b[a]=E[b[a]]}(s,a,V);let o=0;const S=new Uint8Array(a.buffer.byteLength);for(let G=0;G<E.lines;G++)for(let b=0;b<E.channels;b++){const E=l[b],h=E.nx*E.size,k=new Uint8Array(a.buffer,2*E.end,2*h);S.set(k,o),o+=2*h,E.end+=h}return new DataView(S.buffer)}var t,T=h(10821);!function(E){E[E.Float=0]="Float",E[E.HalfFloat=1]="HalfFloat"}(t||(t={}));class X{}X.DefaultOutputType=t.HalfFloat,X.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class C{constructor(){this.supportCascades=!1}loadCubeData(E,b,h,a,k){throw".exr not supported in Cube."}async loadData(E,b,h){const k=new DataView(E.buffer),G={value:0},V=function(E,b){if(20000630!=E.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const h=E.getUint8(4),k=E.getUint8(5),G={singleTile:!!(2&k),longName:!!(4&k),deepFormat:!!(8&k),multiPart:!!(16&k)};b.value=8;const V={};let l=!0;for(;l;){const h=B(E.buffer,b);if(h){const k=B(E.buffer,b),G=A(E,b,k,u(E,b));void 0===G?a.c.Warn(`Unknown header attribute type ${k}'.`):V[h]=G}else l=!1}if(0!=(-5&k))throw new Error("Unsupported file format");return{version:h,spec:G,...V}}(k,G),l=await async function(E,b,h,a){const k={size:0,viewer:b,array:new Uint8Array(b.buffer),offset:h,width:E.dataWindow.xMax-E.dataWindow.xMin+1,height:E.dataWindow.yMax-E.dataWindow.yMin+1,channels:E.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(E.compression){case v.NO_COMPRESSION:k.lines=1,k.uncompress=m;break;case v.RLE_COMPRESSION:k.lines=1,k.uncompress=K;break;case v.ZIPS_COMPRESSION:k.lines=1,k.uncompress=x,await T.g.LoadScriptAsync(X.FFLATEUrl);break;case v.ZIP_COMPRESSION:k.lines=16,k.uncompress=x,await T.g.LoadScriptAsync(X.FFLATEUrl);break;case v.PIZ_COMPRESSION:k.lines=32,k.uncompress=L;break;case v.PXR24_COMPRESSION:k.lines=16,k.uncompress=W,await T.g.LoadScriptAsync(X.FFLATEUrl);break;default:throw new Error(v[E.compression]+" is unsupported")}k.scanlineBlockSize=k.lines;const G={};for(const v of E.channels)switch(v.name){case"Y":case"R":case"G":case"B":case"A":G[v.name]=!0,k.type=v.pixelType}let V=!1;if(G.R&&G.G&&G.B)V=!G.A,k.outputChannels=4,k.decodeChannels={R:0,G:1,B:2,A:3};else{if(!G.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");k.outputChannels=1,k.decodeChannels={Y:0}}if(1===k.type)switch(a){case t.Float:k.getter=j,k.inputSize=2;break;case t.HalfFloat:k.getter=g,k.inputSize=2}else{if(2!==k.type)throw new Error("Unsupported pixelType "+k.type+" for "+E.compression);switch(a){case t.Float:k.getter=I,k.inputSize=4;break;case t.HalfFloat:k.getter=P,k.inputSize=4}}k.blockCount=k.height/k.scanlineBlockSize;for(let v=0;v<k.blockCount;v++)M(b,h);const l=k.width*k.height*k.outputChannels;switch(a){case t.Float:k.byteArray=new Float32Array(l),k.textureType=1,V&&k.byteArray.fill(1,0,l);break;case t.HalfFloat:k.byteArray=new Uint16Array(l),k.textureType=2,V&&k.byteArray.fill(15360,0,l);break;default:throw new Error("Unsupported type: "+a)}let O=0;for(const v of E.channels)void 0!==k.decodeChannels[v.name]&&(k.channelLineOffsets[v.name]=O*k.width),O+=2*v.pixelType;return k.bytesPerLine=k.width*O,k.outLineWidth=k.width*k.outputChannels,"INCREASING_Y"===E.lineOrder?k.scanOrder=E=>E:k.scanOrder=E=>k.height-1-E,4==k.outputChannels?(k.format=5,k.linearSpace=!0):(k.format=6,k.linearSpace=!1),k}(V,k,G,X.DefaultOutputType);!function(E,b,h,a){const k={value:0};for(let G=0;G<E.height/E.scanlineBlockSize;G++){const V=o(h,a)-b.dataWindow.yMin;E.size=u(h,a),E.lines=V+E.scanlineBlockSize>E.height?E.height-V:E.scanlineBlockSize;const l=E.size<E.lines*E.bytesPerLine&&E.uncompress?E.uncompress(E):m(E);a.value+=E.size;for(let h=0;h<E.scanlineBlockSize;h++){const a=G*E.scanlineBlockSize,V=h+E.scanOrder(a);if(V>=E.height)continue;const O=h*E.bytesPerLine,v=(E.height-1-V)*E.outLineWidth;for(let h=0;h<E.channels;h++){const a=b.channels[h].name,G=E.channelLineOffsets[a],V=E.decodeChannels[a];if(void 0!==V){k.value=O+G;for(let b=0;b<E.width;b++){const h=v+b*E.outputChannels+V;E.byteArray&&(E.byteArray[h]=E.getter(l,k))}}}}}}(l,V,k,G);h(V.dataWindow.xMax-V.dataWindow.xMin+1,V.dataWindow.yMax-V.dataWindow.yMin+1,b.generateMipMaps,!1,(()=>{const E=b.getEngine();b.format=V.format,b.type=l.textureType,b.invertY=!1,b._gammaSpace=!V.linearSpace,l.byteArray&&E._uploadDataToTextureDirectly(b,l.byteArray,0,0,void 0,!0)}))}}}}]);