"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[18],{12789:(d,t,A)=>{A.r(t),A.d(t,{_ExrTextureLoader:()=>x});var w=A(10740),N=A(11087);const p=65536,B=14,X=65537,W=16384;var a,D;!function(d){d[d.NO_COMPRESSION=0]="NO_COMPRESSION",d[d.RLE_COMPRESSION=1]="RLE_COMPRESSION",d[d.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",d[d.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",d[d.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",d[d.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(a||(a={})),function(d){d[d.INCREASING_Y=0]="INCREASING_Y",d[d.DECREASING_Y=1]="DECREASING_Y"}(D||(D={}));const i=function(){const d=new ArrayBuffer(4),t=new Float32Array(d),A=new Uint32Array(d),w=new Uint32Array(512),N=new Uint32Array(512);for(let W=0;W<256;++W){const d=W-127;d<-27?(w[W]=0,w[256|W]=32768,N[W]=24,N[256|W]=24):d<-14?(w[W]=1024>>-d-14,w[256|W]=1024>>-d-14|32768,N[W]=-d-1,N[256|W]=-d-1):d<=15?(w[W]=d+15<<10,w[256|W]=d+15<<10|32768,N[W]=13,N[256|W]=13):d<128?(w[W]=31744,w[256|W]=64512,N[W]=24,N[256|W]=24):(w[W]=31744,w[256|W]=64512,N[W]=13,N[256|W]=13)}const p=new Uint32Array(2048),B=new Uint32Array(64),X=new Uint32Array(64);for(let W=1;W<1024;++W){let d=W<<13,t=0;for(;0===(8388608&d);)d<<=1,t-=8388608;d&=-8388609,t+=947912704,p[W]=d|t}for(let W=1024;W<2048;++W)p[W]=939524096+(W-1024<<13);for(let W=1;W<31;++W)B[W]=W<<23;B[31]=1199570944,B[32]=2147483648;for(let W=33;W<63;++W)B[W]=2147483648+(W-32<<23);B[63]=3347054592;for(let W=1;W<64;++W)32!==W&&(X[W]=1024);return{floatView:t,uint32View:A,baseTable:w,shiftTable:N,mantissaTable:p,exponentTable:B,offsetTable:X}}();function k(d,t){const A=new Uint8Array(d);let w=0;for(;0!=A[t.value+w];)w+=1;const N=(new TextDecoder).decode(A.slice(t.value,t.value+w));return t.value=t.value+w+1,N}function b(d,t){const A=d.getInt32(t.value,!0);return t.value+=4,A}function Q(d,t){const A=d.getUint32(t.value,!0);return t.value+=4,A}function P(d,t){const A=d.getUint8(t.value);return t.value+=1,A}function J(d,t){const A=d.getUint16(t.value,!0);return t.value+=2,A}function U(d,t){const A=d[t.value];return t.value+=1,A}function T(d,t){let A;return A="getBigInt64"in DataView.prototype?Number(d.getBigInt64(t.value,!0)):d.getUint32(t.value+4,!0)+Number(d.getUint32(t.value,!0)<<32),t.value+=8,A}function F(d,t){const A=d.getFloat32(t.value,!0);return t.value+=4,A}function q(d,t){return function(d){const t=(31744&d)>>10,A=1023&d;return(d>>15?-1:1)*(t?31===t?A?NaN:1/0:Math.pow(2,t-15)*(1+A/1024):A/1024*6103515625e-14)}(J(d,t))}function H(d,t){return function(d){if(Math.abs(d)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");d=(0,N.e)(d,-65504,65504),i.floatView[0]=d;const t=i.uint32View[0],A=t>>23&511;return i.baseTable[A]+((8388607&t)>>i.shiftTable[A])}(F(d,t))}function f(d,t,A,w){switch(A){case"string":case"stringvector":case"iccProfile":return function(d,t,A){const w=(new TextDecoder).decode(new Uint8Array(d).slice(t.value,t.value+A));return t.value=t.value+A,w}(d.buffer,t,w);case"chlist":return function(d,t,A){const w=t.value,N=[];for(;t.value<w+A-1;){const A=k(d.buffer,t),w=b(d,t),p=P(d,t);t.value+=3;const B=b(d,t),X=b(d,t);N.push({name:A,pixelType:w,pLinear:p,xSampling:B,ySampling:X})}return t.value+=1,N}(d,t,w);case"chromaticities":return function(d,t){return{redX:F(d,t),redY:F(d,t),greenX:F(d,t),greenY:F(d,t),blueX:F(d,t),blueY:F(d,t),whiteX:F(d,t),whiteY:F(d,t)}}(d,t);case"compression":return function(d,t){return P(d,t)}(d,t);case"box2i":return function(d,t){return{xMin:b(d,t),yMin:b(d,t),xMax:b(d,t),yMax:b(d,t)}}(d,t);case"lineOrder":return function(d,t){const A=P(d,t);return D[A]}(d,t);case"float":return F(d,t);case"v2f":return function(d,t){return[F(d,t),F(d,t)]}(d,t);case"v3f":return function(d,t){return[F(d,t),F(d,t),F(d,t)]}(d,t);case"int":return b(d,t);case"rational":return function(d,t){return[b(d,t),Q(d,t)]}(d,t);case"timecode":return function(d,t){return[Q(d,t),Q(d,t)]}(d,t);case"preview":return t.value+=w,"skipped";default:return void(t.value+=w)}}function v(d){for(let t=1;t<d.length;t++){const A=d[t-1]+d[t]-128;d[t]=A}}function m(d,t){let A=0,w=Math.floor((d.length+1)/2),N=0;const p=d.length-1;for(;!(N>p)&&(t[N++]=d[A++],!(N>p));)t[N++]=d[w++]}function j(d,t,A,w,N){for(;A<d;)t=t<<8|U(w,N),A+=8;return{l:t>>(A-=d)&(1<<d)-1,c:t,lc:A}}function n(d,t,A,w){return{c:d=d<<8|U(A,w),lc:t+=8}}function R(d,t,A,w,N,p,B,X,W){if(d==t){if(w<8){const d=n(A,w,N,p);A=d.c,w=d.lc}let d=A>>(w-=8);if(d=new Uint8Array([d])[0],X.value+d>W)return null;const t=B[X.value-1];for(;d-- >0;)B[X.value++]=t}else{if(!(X.value<W))return null;B[X.value++]=d}return{c:A,lc:w}}const Z=new Array(59);function L(d,t,A,w,N,p){const B=t;let W=0,a=0;for(;w<=N;w++){if(B.value-t.value>A)return;let X=j(6,W,a,d,B);const D=X.l;if(W=X.c,a=X.lc,p[w]=D,63==D){if(B.value-t.value>A)throw new Error("Error in HufUnpackEncTable");X=j(8,W,a,d,B);let D=X.l+6;if(W=X.c,a=X.lc,w+D>N+1)throw new Error("Error in HufUnpackEncTable");for(;D--;)p[w++]=0;w--}else if(D>=59){let d=D-59+2;if(w+d>N+1)throw new Error("Error in HufUnpackEncTable");for(;d--;)p[w++]=0;w--}}!function(d){for(let A=0;A<=58;++A)Z[A]=0;for(let A=0;A<X;++A)Z[d[A]]+=1;let t=0;for(let A=58;A>0;--A){const d=t+Z[A]>>1;Z[A]=t,t=d}for(let A=0;A<X;++A){const t=d[A];t>0&&(d[A]=t|Z[t]++<<6)}}(p)}function I(d){return 63&d}function u(d){return d>>6}function V(d,t,A,w,N,p){const a=A.value,D=Q(t,A),i=Q(t,A);A.value+=4;const k=Q(t,A);if(A.value+=4,D<0||D>=X||i<0||i>=X)throw new Error("Wrong HUF_ENCSIZE");const b=new Array(X),P=new Array(W);!function(d){for(let t=0;t<W;t++)d[t]={},d[t].len=0,d[t].lit=0,d[t].p=null}(P);if(L(d,A,w-(A.value-a),D,i,b),k>8*(w-(A.value-a)))throw new Error("Wrong hufUncompress");!function(d,t,A,w){for(;t<=A;t++){const A=u(d[t]),N=I(d[t]);if(A>>N)throw new Error("Invalid table entry");if(N>B){const d=w[A>>N-B];if(d.len)throw new Error("Invalid table entry");if(d.lit++,d.p){const t=d.p;d.p=new Array(d.lit);for(let A=0;A<d.lit-1;++A)d.p[A]=t[A]}else d.p=new Array(1);d.p[d.lit-1]=t}else if(N){let d=0;for(let p=1<<B-N;p>0;p--){const p=w[(A<<B-N)+d];if(p.len||p.p)throw new Error("Invalid table entry");p.len=N,p.lit=t,d++}}}}(b,D,i,P),function(d,t,A,w,N,p,X,W,a){let D=0,i=0;const k=X,b=Math.trunc(w.value+(N+7)/8);for(;w.value<b;){let N=n(D,i,A,w);for(D=N.c,i=N.lc;i>=B;){const X=t[D>>i-B&16383];if(X.len){i-=X.len;const d=R(X.lit,p,D,i,A,w,W,a,k);d&&(D=d.c,i=d.lc)}else{if(!X.p)throw new Error("hufDecode issues");let t;for(t=0;t<X.lit;t++){const B=I(d[X.p[t]]);for(;i<B&&w.value<b;)N=n(D,i,A,w),D=N.c,i=N.lc;if(i>=B&&u(d[X.p[t]])==(D>>i-B&(1<<B)-1)){i-=B;const d=R(X.p[t],p,D,i,A,w,W,a,k);d&&(D=d.c,i=d.lc);break}}if(t==X.lit)throw new Error("HufDecode issues")}}}const Q=8-N&7;for(D>>=Q,i-=Q;i>0;){const d=t[D<<B-i&16383];if(!d.len)throw new Error("HufDecode issues");{i-=d.len;const t=R(d.lit,p,D,i,A,w,W,a,k);t&&(D=t.c,i=t.lc)}}}(b,P,d,A,k,i,p,N,{value:0})}function h(d){return 65535&d}function l(d){const t=h(d);return t>32767?t-65536:t}function y(d,t){const A=l(d),w=l(t),N=A+(1&w)+(w>>1);return{a:N,b:N-w}}function s(d,t){const A=h(d),w=h(t),N=A-(w>>1)&65535;return{a:w+N-32768&65535,b:N}}function Y(d,t,A,w,N,p,B){const X=B<16384,W=A>N?N:A;let a,D,i=1;for(;i<=W;)i<<=1;for(i>>=1,a=i,i>>=1;i>=1;){D=0;const B=D+p*(N-a),W=p*i,k=p*a,b=w*i,Q=w*a;let P,J,U,T;for(;D<=B;D+=k){let N=D;const p=D+w*(A-a);for(;N<=p;N+=Q){const A=N+b,w=N+W,p=w+b;if(X){let B=y(d[N+t],d[w+t]);P=B.a,U=B.b,B=y(d[A+t],d[p+t]),J=B.a,T=B.b,B=y(P,J),d[N+t]=B.a,d[A+t]=B.b,B=y(U,T),d[w+t]=B.a,d[p+t]=B.b}else{let B=s(d[N+t],d[w+t]);P=B.a,U=B.b,B=s(d[A+t],d[p+t]),J=B.a,T=B.b,B=s(P,J),d[N+t]=B.a,d[A+t]=B.b,B=s(U,T),d[w+t]=B.a,d[p+t]=B.b}}if(A&i){const A=N+W;let w;w=X?y(d[N+t],d[A+t]):s(d[N+t],d[A+t]),P=w.a,d[A+t]=w.b,d[N+t]=P}}if(N&i){let N=D;const p=D+w*(A-a);for(;N<=p;N+=Q){const A=N+b;let w;w=X?y(d[N+t],d[A+t]):s(d[N+t],d[A+t]),P=w.a,d[A+t]=w.b,d[N+t]=P}}a=i,i>>=1}return D}function r(d){return new DataView(d.array.buffer,d.offset.value,d.size)}function K(d){const t=d.viewer.buffer.slice(d.offset.value,d.offset.value+d.size),A=new Uint8Array(function(d){let t=d.byteLength;const A=new Array;let w=0;const N=new DataView(d);for(;t>0;){const d=N.getInt8(w++);if(d<0){const p=-d;t-=p+1;for(let d=0;d<p;d++)A.push(N.getUint8(w++))}else{const p=d;t-=2;const B=N.getUint8(w++);for(let d=0;d<p+1;d++)A.push(B)}}return A}(t)),w=new Uint8Array(A.length);return v(A),m(A,w),new DataView(w.buffer)}function G(d){const t=d.array.slice(d.offset.value,d.offset.value+d.size),A=fflate.unzlibSync(t),w=new Uint8Array(A.length);return v(A),m(A,w),new DataView(w.buffer)}function O(d){const t=d.array.slice(d.offset.value,d.offset.value+d.size),A=fflate.unzlibSync(t),w=d.lines*d.channels*d.width,N=1==d.type?new Uint16Array(w):new Uint32Array(w);let p=0,B=0;const X=new Array(4);for(let W=0;W<d.lines;W++)for(let t=0;t<d.channels;t++){let t=0;switch(d.type){case 1:X[0]=p,X[1]=X[0]+d.width,p=X[1]+d.width;for(let w=0;w<d.width;++w){t+=A[X[0]++]<<8|A[X[1]++],N[B]=t,B++}break;case 2:X[0]=p,X[1]=X[0]+d.width,X[2]=X[1]+d.width,p=X[2]+d.width;for(let w=0;w<d.width;++w){t+=A[X[0]++]<<24|A[X[1]++]<<16|A[X[2]++]<<8,N[B]=t,B++}}}return new DataView(N.buffer)}function z(d){const t=d.viewer,A={value:d.offset.value},w=new Uint16Array(d.width*d.scanlineBlockSize*(d.channels*d.type)),N=new Uint8Array(8192);let B=0;const X=new Array(d.channels);for(let p=0;p<d.channels;p++)X[p]={},X[p].start=B,X[p].end=X[p].start,X[p].nx=d.width,X[p].ny=d.lines,X[p].size=d.type,B+=X[p].nx*X[p].ny*X[p].size;const W=J(t,A),a=J(t,A);if(a>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(W<=a)for(let p=0;p<a-W+1;p++)N[p+W]=P(t,A);const D=new Uint16Array(p),i=function(d,t){let A=0;for(let N=0;N<p;++N)(0==N||d[N>>3]&1<<(7&N))&&(t[A++]=N);const w=A-1;for(;A<p;)t[A++]=0;return w}(N,D),k=Q(t,A);V(d.array,t,A,k,w,B);for(let p=0;p<d.channels;++p){const d=X[p];for(let t=0;t<X[p].size;++t)Y(w,d.start+t,d.nx,d.size,d.ny,d.nx*d.size,i)}!function(d,t,A){for(let w=0;w<A;++w)t[w]=d[t[w]]}(D,w,B);let b=0;const U=new Uint8Array(w.buffer.byteLength);for(let p=0;p<d.lines;p++)for(let t=0;t<d.channels;t++){const d=X[t],A=d.nx*d.size,N=new Uint8Array(w.buffer,2*d.end,2*A);U.set(N,b),b+=2*A,d.end+=A}return new DataView(U.buffer)}var c,e=A(10727);!function(d){d[d.Float=0]="Float",d[d.HalfFloat=1]="HalfFloat"}(c||(c={}));class M{}M.DefaultOutputType=c.HalfFloat,M.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class x{constructor(){this.supportCascades=!1}loadCubeData(d,t,A,w,N){throw".exr not supported in Cube."}async loadData(d,t,A){const N=new DataView(d.buffer),p={value:0},B=function(d,t){if(20000630!=d.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const A=d.getUint8(4),N=d.getUint8(5),p={singleTile:!!(2&N),longName:!!(4&N),deepFormat:!!(8&N),multiPart:!!(16&N)};t.value=8;const B={};let X=!0;for(;X;){const A=k(d.buffer,t);if(A){const N=k(d.buffer,t),p=f(d,t,N,Q(d,t));void 0===p?w.e.Warn(`Unknown header attribute type ${N}'.`):B[A]=p}else X=!1}if(0!=(-5&N))throw new Error("Unsupported file format");return{version:A,spec:p,...B}}(N,p),X=await async function(d,t,A,w){const N={size:0,viewer:t,array:new Uint8Array(t.buffer),offset:A,width:d.dataWindow.xMax-d.dataWindow.xMin+1,height:d.dataWindow.yMax-d.dataWindow.yMin+1,channels:d.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(d.compression){case a.NO_COMPRESSION:N.lines=1,N.uncompress=r;break;case a.RLE_COMPRESSION:N.lines=1,N.uncompress=K;break;case a.ZIPS_COMPRESSION:N.lines=1,N.uncompress=G,await e.g.LoadScriptAsync(M.FFLATEUrl);break;case a.ZIP_COMPRESSION:N.lines=16,N.uncompress=G,await e.g.LoadScriptAsync(M.FFLATEUrl);break;case a.PIZ_COMPRESSION:N.lines=32,N.uncompress=z;break;case a.PXR24_COMPRESSION:N.lines=16,N.uncompress=O,await e.g.LoadScriptAsync(M.FFLATEUrl);break;default:throw new Error(a[d.compression]+" is unsupported")}N.scanlineBlockSize=N.lines;const p={};for(const a of d.channels)switch(a.name){case"Y":case"R":case"G":case"B":case"A":p[a.name]=!0,N.type=a.pixelType}let B=!1;if(p.R&&p.G&&p.B)B=!p.A,N.outputChannels=4,N.decodeChannels={R:0,G:1,B:2,A:3};else{if(!p.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");N.outputChannels=1,N.decodeChannels={Y:0}}if(1===N.type)switch(w){case c.Float:N.getter=q,N.inputSize=2;break;case c.HalfFloat:N.getter=J,N.inputSize=2}else{if(2!==N.type)throw new Error("Unsupported pixelType "+N.type+" for "+d.compression);switch(w){case c.Float:N.getter=F,N.inputSize=4;break;case c.HalfFloat:N.getter=H,N.inputSize=4}}N.blockCount=N.height/N.scanlineBlockSize;for(let a=0;a<N.blockCount;a++)T(t,A);const X=N.width*N.height*N.outputChannels;switch(w){case c.Float:N.byteArray=new Float32Array(X),N.textureType=1,B&&N.byteArray.fill(1,0,X);break;case c.HalfFloat:N.byteArray=new Uint16Array(X),N.textureType=2,B&&N.byteArray.fill(15360,0,X);break;default:throw new Error("Unsupported type: "+w)}let W=0;for(const a of d.channels)void 0!==N.decodeChannels[a.name]&&(N.channelLineOffsets[a.name]=W*N.width),W+=2*a.pixelType;return N.bytesPerLine=N.width*W,N.outLineWidth=N.width*N.outputChannels,"INCREASING_Y"===d.lineOrder?N.scanOrder=d=>d:N.scanOrder=d=>N.height-1-d,4==N.outputChannels?(N.format=5,N.linearSpace=!0):(N.format=6,N.linearSpace=!1),N}(B,N,p,M.DefaultOutputType);!function(d,t,A,w){const N={value:0};for(let p=0;p<d.height/d.scanlineBlockSize;p++){const B=b(A,w)-t.dataWindow.yMin;d.size=Q(A,w),d.lines=B+d.scanlineBlockSize>d.height?d.height-B:d.scanlineBlockSize;const X=d.size<d.lines*d.bytesPerLine&&d.uncompress?d.uncompress(d):r(d);w.value+=d.size;for(let A=0;A<d.scanlineBlockSize;A++){const w=p*d.scanlineBlockSize,B=A+d.scanOrder(w);if(B>=d.height)continue;const W=A*d.bytesPerLine,a=(d.height-1-B)*d.outLineWidth;for(let A=0;A<d.channels;A++){const w=t.channels[A].name,p=d.channelLineOffsets[w],B=d.decodeChannels[w];if(void 0!==B){N.value=W+p;for(let t=0;t<d.width;t++){const A=a+t*d.outputChannels+B;d.byteArray&&(d.byteArray[A]=d.getter(X,N))}}}}}}(X,B,N,p);A(B.dataWindow.xMax-B.dataWindow.xMin+1,B.dataWindow.yMax-B.dataWindow.yMin+1,t.generateMipMaps,!1,(()=>{const d=t.getEngine();t.format=B.format,t.type=X.textureType,t.invertY=!1,t._gammaSpace=!B.linearSpace,X.byteArray&&d._uploadDataToTextureDirectly(t,X.byteArray,0,0,void 0,!0)}))}}}}]);