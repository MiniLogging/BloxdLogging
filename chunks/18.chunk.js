"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[18],{13046:(y,g,f)=>{f.r(g),f.d(g,{_ExrTextureLoader:()=>O});var p=f(10736),S=f(11079);const k=65536,i=14,H=65537,U=16384;var l,c;!function(y){y[y.NO_COMPRESSION=0]="NO_COMPRESSION",y[y.RLE_COMPRESSION=1]="RLE_COMPRESSION",y[y.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",y[y.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",y[y.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",y[y.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(l||(l={})),function(y){y[y.INCREASING_Y=0]="INCREASING_Y",y[y.DECREASING_Y=1]="DECREASING_Y"}(c||(c={}));const Z=function(){const y=new ArrayBuffer(4),g=new Float32Array(y),f=new Uint32Array(y),p=new Uint32Array(512),S=new Uint32Array(512);for(let U=0;U<256;++U){const y=U-127;y<-27?(p[U]=0,p[256|U]=32768,S[U]=24,S[256|U]=24):y<-14?(p[U]=1024>>-y-14,p[256|U]=1024>>-y-14|32768,S[U]=-y-1,S[256|U]=-y-1):y<=15?(p[U]=y+15<<10,p[256|U]=y+15<<10|32768,S[U]=13,S[256|U]=13):y<128?(p[U]=31744,p[256|U]=64512,S[U]=24,S[256|U]=24):(p[U]=31744,p[256|U]=64512,S[U]=13,S[256|U]=13)}const k=new Uint32Array(2048),i=new Uint32Array(64),H=new Uint32Array(64);for(let U=1;U<1024;++U){let y=U<<13,g=0;for(;0===(8388608&y);)y<<=1,g-=8388608;y&=-8388609,g+=947912704,k[U]=y|g}for(let U=1024;U<2048;++U)k[U]=939524096+(U-1024<<13);for(let U=1;U<31;++U)i[U]=U<<23;i[31]=1199570944,i[32]=2147483648;for(let U=33;U<63;++U)i[U]=2147483648+(U-32<<23);i[63]=3347054592;for(let U=1;U<64;++U)32!==U&&(H[U]=1024);return{floatView:g,uint32View:f,baseTable:p,shiftTable:S,mantissaTable:k,exponentTable:i,offsetTable:H}}();function C(y,g){const f=new Uint8Array(y);let p=0;for(;0!=f[g.value+p];)p+=1;const S=(new TextDecoder).decode(f.slice(g.value,g.value+p));return g.value=g.value+p+1,S}function q(y,g){const f=y.getInt32(g.value,!0);return g.value+=4,f}function W(y,g){const f=y.getUint32(g.value,!0);return g.value+=4,f}function j(y,g){const f=y.getUint8(g.value);return g.value+=1,f}function P(y,g){const f=y.getUint16(g.value,!0);return g.value+=2,f}function B(y,g){const f=y[g.value];return g.value+=1,f}function R(y,g){let f;return f="getBigInt64"in DataView.prototype?Number(y.getBigInt64(g.value,!0)):y.getUint32(g.value+4,!0)+Number(y.getUint32(g.value,!0)<<32),g.value+=8,f}function G(y,g){const f=y.getFloat32(g.value,!0);return g.value+=4,f}function z(y,g){return function(y){const g=(31744&y)>>10,f=1023&y;return(y>>15?-1:1)*(g?31===g?f?NaN:1/0:Math.pow(2,g-15)*(1+f/1024):f/1024*6103515625e-14)}(P(y,g))}function T(y,g){return function(y){if(Math.abs(y)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");y=(0,S.d)(y,-65504,65504),Z.floatView[0]=y;const g=Z.uint32View[0],f=g>>23&511;return Z.baseTable[f]+((8388607&g)>>Z.shiftTable[f])}(G(y,g))}function Q(y,g,f,p){switch(f){case"string":case"stringvector":case"iccProfile":return function(y,g,f){const p=(new TextDecoder).decode(new Uint8Array(y).slice(g.value,g.value+f));return g.value=g.value+f,p}(y.buffer,g,p);case"chlist":return function(y,g,f){const p=g.value,S=[];for(;g.value<p+f-1;){const f=C(y.buffer,g),p=q(y,g),k=j(y,g);g.value+=3;const i=q(y,g),H=q(y,g);S.push({name:f,pixelType:p,pLinear:k,xSampling:i,ySampling:H})}return g.value+=1,S}(y,g,p);case"chromaticities":return function(y,g){return{redX:G(y,g),redY:G(y,g),greenX:G(y,g),greenY:G(y,g),blueX:G(y,g),blueY:G(y,g),whiteX:G(y,g),whiteY:G(y,g)}}(y,g);case"compression":return function(y,g){return j(y,g)}(y,g);case"box2i":return function(y,g){return{xMin:q(y,g),yMin:q(y,g),xMax:q(y,g),yMax:q(y,g)}}(y,g);case"lineOrder":return function(y,g){const f=j(y,g);return c[f]}(y,g);case"float":return G(y,g);case"v2f":return function(y,g){return[G(y,g),G(y,g)]}(y,g);case"v3f":return function(y,g){return[G(y,g),G(y,g),G(y,g)]}(y,g);case"int":return q(y,g);case"rational":return function(y,g){return[q(y,g),W(y,g)]}(y,g);case"timecode":return function(y,g){return[W(y,g),W(y,g)]}(y,g);case"preview":return g.value+=p,"skipped";default:return void(g.value+=p)}}function m(y){for(let g=1;g<y.length;g++){const f=y[g-1]+y[g]-128;y[g]=f}}function a(y,g){let f=0,p=Math.floor((y.length+1)/2),S=0;const k=y.length-1;for(;!(S>k)&&(g[S++]=y[f++],!(S>k));)g[S++]=y[p++]}function w(y,g,f,p,S){for(;f<y;)g=g<<8|B(p,S),f+=8;return{l:g>>(f-=y)&(1<<y)-1,c:g,lc:f}}function o(y,g,f,p){return{c:y=y<<8|B(f,p),lc:g+=8}}function I(y,g,f,p,S,k,i,H,U){if(y==g){if(p<8){const y=o(f,p,S,k);f=y.c,p=y.lc}let y=f>>(p-=8);if(y=new Uint8Array([y])[0],H.value+y>U)return null;const g=i[H.value-1];for(;y-- >0;)i[H.value++]=g}else{if(!(H.value<U))return null;i[H.value++]=y}return{c:f,lc:p}}const Y=new Array(59);function n(y,g,f,p,S,k){const i=g;let U=0,l=0;for(;p<=S;p++){if(i.value-g.value>f)return;let H=w(6,U,l,y,i);const c=H.l;if(U=H.c,l=H.lc,k[p]=c,63==c){if(i.value-g.value>f)throw new Error("Error in HufUnpackEncTable");H=w(8,U,l,y,i);let c=H.l+6;if(U=H.c,l=H.lc,p+c>S+1)throw new Error("Error in HufUnpackEncTable");for(;c--;)k[p++]=0;p--}else if(c>=59){let y=c-59+2;if(p+y>S+1)throw new Error("Error in HufUnpackEncTable");for(;y--;)k[p++]=0;p--}}!function(y){for(let f=0;f<=58;++f)Y[f]=0;for(let f=0;f<H;++f)Y[y[f]]+=1;let g=0;for(let f=58;f>0;--f){const y=g+Y[f]>>1;Y[f]=g,g=y}for(let f=0;f<H;++f){const g=y[f];g>0&&(y[f]=g|Y[g]++<<6)}}(k)}function M(y){return 63&y}function r(y){return y>>6}function N(y,g,f,p,S,k){const l=f.value,c=W(g,f),Z=W(g,f);f.value+=4;const C=W(g,f);if(f.value+=4,c<0||c>=H||Z<0||Z>=H)throw new Error("Wrong HUF_ENCSIZE");const q=new Array(H),j=new Array(U);!function(y){for(let g=0;g<U;g++)y[g]={},y[g].len=0,y[g].lit=0,y[g].p=null}(j);if(n(y,f,p-(f.value-l),c,Z,q),C>8*(p-(f.value-l)))throw new Error("Wrong hufUncompress");!function(y,g,f,p){for(;g<=f;g++){const f=r(y[g]),S=M(y[g]);if(f>>S)throw new Error("Invalid table entry");if(S>i){const y=p[f>>S-i];if(y.len)throw new Error("Invalid table entry");if(y.lit++,y.p){const g=y.p;y.p=new Array(y.lit);for(let f=0;f<y.lit-1;++f)y.p[f]=g[f]}else y.p=new Array(1);y.p[y.lit-1]=g}else if(S){let y=0;for(let k=1<<i-S;k>0;k--){const k=p[(f<<i-S)+y];if(k.len||k.p)throw new Error("Invalid table entry");k.len=S,k.lit=g,y++}}}}(q,c,Z,j),function(y,g,f,p,S,k,H,U,l){let c=0,Z=0;const C=H,q=Math.trunc(p.value+(S+7)/8);for(;p.value<q;){let S=o(c,Z,f,p);for(c=S.c,Z=S.lc;Z>=i;){const H=g[c>>Z-i&16383];if(H.len){Z-=H.len;const y=I(H.lit,k,c,Z,f,p,U,l,C);y&&(c=y.c,Z=y.lc)}else{if(!H.p)throw new Error("hufDecode issues");let g;for(g=0;g<H.lit;g++){const i=M(y[H.p[g]]);for(;Z<i&&p.value<q;)S=o(c,Z,f,p),c=S.c,Z=S.lc;if(Z>=i&&r(y[H.p[g]])==(c>>Z-i&(1<<i)-1)){Z-=i;const y=I(H.p[g],k,c,Z,f,p,U,l,C);y&&(c=y.c,Z=y.lc);break}}if(g==H.lit)throw new Error("HufDecode issues")}}}const W=8-S&7;for(c>>=W,Z-=W;Z>0;){const y=g[c<<i-Z&16383];if(!y.len)throw new Error("HufDecode issues");{Z-=y.len;const g=I(y.lit,k,c,Z,f,p,U,l,C);g&&(c=g.c,Z=g.lc)}}}(q,j,y,f,C,Z,k,S,{value:0})}function b(y){return 65535&y}function s(y){const g=b(y);return g>32767?g-65536:g}function u(y,g){const f=s(y),p=s(g),S=f+(1&p)+(p>>1);return{a:S,b:S-p}}function F(y,g){const f=b(y),p=b(g),S=f-(p>>1)&65535;return{a:p+S-32768&65535,b:S}}function A(y,g,f,p,S,k,i){const H=i<16384,U=f>S?S:f;let l,c,Z=1;for(;Z<=U;)Z<<=1;for(Z>>=1,l=Z,Z>>=1;Z>=1;){c=0;const i=c+k*(S-l),U=k*Z,C=k*l,q=p*Z,W=p*l;let j,P,B,R;for(;c<=i;c+=C){let S=c;const k=c+p*(f-l);for(;S<=k;S+=W){const f=S+q,p=S+U,k=p+q;if(H){let i=u(y[S+g],y[p+g]);j=i.a,B=i.b,i=u(y[f+g],y[k+g]),P=i.a,R=i.b,i=u(j,P),y[S+g]=i.a,y[f+g]=i.b,i=u(B,R),y[p+g]=i.a,y[k+g]=i.b}else{let i=F(y[S+g],y[p+g]);j=i.a,B=i.b,i=F(y[f+g],y[k+g]),P=i.a,R=i.b,i=F(j,P),y[S+g]=i.a,y[f+g]=i.b,i=F(B,R),y[p+g]=i.a,y[k+g]=i.b}}if(f&Z){const f=S+U;let p;p=H?u(y[S+g],y[f+g]):F(y[S+g],y[f+g]),j=p.a,y[f+g]=p.b,y[S+g]=j}}if(S&Z){let S=c;const k=c+p*(f-l);for(;S<=k;S+=W){const f=S+q;let p;p=H?u(y[S+g],y[f+g]):F(y[S+g],y[f+g]),j=p.a,y[f+g]=p.b,y[S+g]=j}}l=Z,Z>>=1}return c}function J(y){return new DataView(y.array.buffer,y.offset.value,y.size)}function V(y){const g=y.viewer.buffer.slice(y.offset.value,y.offset.value+y.size),f=new Uint8Array(function(y){let g=y.byteLength;const f=new Array;let p=0;const S=new DataView(y);for(;g>0;){const y=S.getInt8(p++);if(y<0){const k=-y;g-=k+1;for(let y=0;y<k;y++)f.push(S.getUint8(p++))}else{const k=y;g-=2;const i=S.getUint8(p++);for(let y=0;y<k+1;y++)f.push(i)}}return f}(g)),p=new Uint8Array(f.length);return m(f),a(f,p),new DataView(p.buffer)}function e(y){const g=y.array.slice(y.offset.value,y.offset.value+y.size),f=fflate.unzlibSync(g),p=new Uint8Array(f.length);return m(f),a(f,p),new DataView(p.buffer)}function h(y){const g=y.array.slice(y.offset.value,y.offset.value+y.size),f=fflate.unzlibSync(g),p=y.lines*y.channels*y.width,S=1==y.type?new Uint16Array(p):new Uint32Array(p);let k=0,i=0;const H=new Array(4);for(let U=0;U<y.lines;U++)for(let g=0;g<y.channels;g++){let g=0;switch(y.type){case 1:H[0]=k,H[1]=H[0]+y.width,k=H[1]+y.width;for(let p=0;p<y.width;++p){g+=f[H[0]++]<<8|f[H[1]++],S[i]=g,i++}break;case 2:H[0]=k,H[1]=H[0]+y.width,H[2]=H[1]+y.width,k=H[2]+y.width;for(let p=0;p<y.width;++p){g+=f[H[0]++]<<24|f[H[1]++]<<16|f[H[2]++]<<8,S[i]=g,i++}}}return new DataView(S.buffer)}function D(y){const g=y.viewer,f={value:y.offset.value},p=new Uint16Array(y.width*y.scanlineBlockSize*(y.channels*y.type)),S=new Uint8Array(8192);let i=0;const H=new Array(y.channels);for(let k=0;k<y.channels;k++)H[k]={},H[k].start=i,H[k].end=H[k].start,H[k].nx=y.width,H[k].ny=y.lines,H[k].size=y.type,i+=H[k].nx*H[k].ny*H[k].size;const U=P(g,f),l=P(g,f);if(l>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(U<=l)for(let k=0;k<l-U+1;k++)S[k+U]=j(g,f);const c=new Uint16Array(k),Z=function(y,g){let f=0;for(let S=0;S<k;++S)(0==S||y[S>>3]&1<<(7&S))&&(g[f++]=S);const p=f-1;for(;f<k;)g[f++]=0;return p}(S,c),C=W(g,f);N(y.array,g,f,C,p,i);for(let k=0;k<y.channels;++k){const y=H[k];for(let g=0;g<H[k].size;++g)A(p,y.start+g,y.nx,y.size,y.ny,y.nx*y.size,Z)}!function(y,g,f){for(let p=0;p<f;++p)g[p]=y[g[p]]}(c,p,i);let q=0;const B=new Uint8Array(p.buffer.byteLength);for(let k=0;k<y.lines;k++)for(let g=0;g<y.channels;g++){const y=H[g],f=y.nx*y.size,S=new Uint8Array(p.buffer,2*y.end,2*f);B.set(S,q),q+=2*f,y.end+=f}return new DataView(B.buffer)}var K,X=f(10714);!function(y){y[y.Float=0]="Float",y[y.HalfFloat=1]="HalfFloat"}(K||(K={}));class E{}E.DefaultOutputType=K.HalfFloat,E.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class O{constructor(){this.supportCascades=!1}loadCubeData(y,g,f,p,S){throw".exr not supported in Cube."}async loadData(y,g,f){const S=new DataView(y.buffer),k={value:0},i=function(y,g){if(20000630!=y.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const f=y.getUint8(4),S=y.getUint8(5),k={singleTile:!!(2&S),longName:!!(4&S),deepFormat:!!(8&S),multiPart:!!(16&S)};g.value=8;const i={};let H=!0;for(;H;){const f=C(y.buffer,g);if(f){const S=C(y.buffer,g),k=Q(y,g,S,W(y,g));void 0===k?p.d.Warn(`Unknown header attribute type ${S}'.`):i[f]=k}else H=!1}if(0!=(-5&S))throw new Error("Unsupported file format");return{version:f,spec:k,...i}}(S,k),H=await async function(y,g,f,p){const S={size:0,viewer:g,array:new Uint8Array(g.buffer),offset:f,width:y.dataWindow.xMax-y.dataWindow.xMin+1,height:y.dataWindow.yMax-y.dataWindow.yMin+1,channels:y.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(y.compression){case l.NO_COMPRESSION:S.lines=1,S.uncompress=J;break;case l.RLE_COMPRESSION:S.lines=1,S.uncompress=V;break;case l.ZIPS_COMPRESSION:S.lines=1,S.uncompress=e,await X.e.LoadScriptAsync(E.FFLATEUrl);break;case l.ZIP_COMPRESSION:S.lines=16,S.uncompress=e,await X.e.LoadScriptAsync(E.FFLATEUrl);break;case l.PIZ_COMPRESSION:S.lines=32,S.uncompress=D;break;case l.PXR24_COMPRESSION:S.lines=16,S.uncompress=h,await X.e.LoadScriptAsync(E.FFLATEUrl);break;default:throw new Error(l[y.compression]+" is unsupported")}S.scanlineBlockSize=S.lines;const k={};for(const l of y.channels)switch(l.name){case"Y":case"R":case"G":case"B":case"A":k[l.name]=!0,S.type=l.pixelType}let i=!1;if(k.R&&k.G&&k.B)i=!k.A,S.outputChannels=4,S.decodeChannels={R:0,G:1,B:2,A:3};else{if(!k.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");S.outputChannels=1,S.decodeChannels={Y:0}}if(1===S.type)switch(p){case K.Float:S.getter=z,S.inputSize=2;break;case K.HalfFloat:S.getter=P,S.inputSize=2}else{if(2!==S.type)throw new Error("Unsupported pixelType "+S.type+" for "+y.compression);switch(p){case K.Float:S.getter=G,S.inputSize=4;break;case K.HalfFloat:S.getter=T,S.inputSize=4}}S.blockCount=S.height/S.scanlineBlockSize;for(let l=0;l<S.blockCount;l++)R(g,f);const H=S.width*S.height*S.outputChannels;switch(p){case K.Float:S.byteArray=new Float32Array(H),S.textureType=1,i&&S.byteArray.fill(1,0,H);break;case K.HalfFloat:S.byteArray=new Uint16Array(H),S.textureType=2,i&&S.byteArray.fill(15360,0,H);break;default:throw new Error("Unsupported type: "+p)}let U=0;for(const l of y.channels)void 0!==S.decodeChannels[l.name]&&(S.channelLineOffsets[l.name]=U*S.width),U+=2*l.pixelType;return S.bytesPerLine=S.width*U,S.outLineWidth=S.width*S.outputChannels,"INCREASING_Y"===y.lineOrder?S.scanOrder=y=>y:S.scanOrder=y=>S.height-1-y,4==S.outputChannels?(S.format=5,S.linearSpace=!0):(S.format=6,S.linearSpace=!1),S}(i,S,k,E.DefaultOutputType);!function(y,g,f,p){const S={value:0};for(let k=0;k<y.height/y.scanlineBlockSize;k++){const i=q(f,p)-g.dataWindow.yMin;y.size=W(f,p),y.lines=i+y.scanlineBlockSize>y.height?y.height-i:y.scanlineBlockSize;const H=y.size<y.lines*y.bytesPerLine&&y.uncompress?y.uncompress(y):J(y);p.value+=y.size;for(let f=0;f<y.scanlineBlockSize;f++){const p=k*y.scanlineBlockSize,i=f+y.scanOrder(p);if(i>=y.height)continue;const U=f*y.bytesPerLine,l=(y.height-1-i)*y.outLineWidth;for(let f=0;f<y.channels;f++){const p=g.channels[f].name,k=y.channelLineOffsets[p],i=y.decodeChannels[p];if(void 0!==i){S.value=U+k;for(let g=0;g<y.width;g++){const f=l+g*y.outputChannels+i;y.byteArray&&(y.byteArray[f]=y.getter(H,S))}}}}}}(H,i,S,k);f(i.dataWindow.xMax-i.dataWindow.xMin+1,i.dataWindow.yMax-i.dataWindow.yMin+1,g.generateMipMaps,!1,(()=>{const y=g.getEngine();g.format=i.format,g.type=H.textureType,g.invertY=!1,g._gammaSpace=!i.linearSpace,H.byteArray&&y._uploadDataToTextureDirectly(g,H.byteArray,0,0,void 0,!0)}))}}}}]);