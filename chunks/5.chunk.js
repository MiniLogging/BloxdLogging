"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2307:(Z,U,n)=>{n.d(U,{c:()=>y});var i=n(673),B=n(681),l=n(493),H=n(702),V=n(547),G=n(640),R=(n(551),n(2284));class d{get wrapU(){return this._wrapU}set wrapU(Z){this._wrapU=Z}get wrapV(){return this._wrapV}set wrapV(Z){this._wrapV=Z}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(Z){this._texture&&(this._texture.isCube=Z)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Z){this._texture&&(this._texture.is3D=Z)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Z){this._texture&&(this._texture.is2DArray=Z)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(Z){return void 0!==(null===Z||void 0===Z?void 0:Z.shareDepth)}constructor(Z){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=R.e.Zero(),this._cachedBaseSize=R.e.Zero(),this._initialSamplingMode=2,this._texture=d._IsRenderTargetWrapper(Z)?Z.texture:Z,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(Z){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(Z,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var F=n(733);class y extends d{set Jj(Z){this._hasAlpha!==Z&&(this._hasAlpha=Z,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))))}get Jj(){return this._hasAlpha}set getAlphaFromRGB(Z){this._getAlphaFromRGB!==Z&&(this._getAlphaFromRGB=Z,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(Z){this._coordinatesIndex!==Z&&(this._coordinatesIndex=Z,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(Z){this._coordinatesMode!==Z&&(this._coordinatesMode=Z,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(Z){this._wrapU=Z}get wrapV(){return this._wrapV}set wrapV(Z){this._wrapV=Z}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(Z){this._texture?this._texture.isCube=Z:this._isCube=Z}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Z){this._texture&&(this._texture.is3D=Z)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Z){this._texture&&(this._texture.is2DArray=Z)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(Z){var U;if(this._texture){if(this._texture._gammaSpace===Z)return;this._texture._gammaSpace=Z}else{if(this._gammaSpace===Z)return;this._gammaSpace=Z}null===(U=this.va())||void 0===U||U.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(Z){var U;Z!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=Z),null===(U=this.va())||void 0===U||U.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(Z){this._texture&&(this._texture._lodGenerationOffset=Z)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(Z){this._texture&&(this._texture._lodGenerationScale=Z)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(Z){this._texture&&(this._texture._linearSpecularLOD=Z)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(Z){this._texture&&(this._texture._irradianceTexture=Z)}get uid(){return this._uid||(this._uid=(0,G.e)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(Z){this._onDisposeObserver&&this.Oi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Oi.add(Z)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(Z){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=y.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Oi=new l.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,Z?y._IsScene(Z)?this._scene=Z:this._engine=Z:this._scene=V.b.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=U,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return H.b.IdentityReadOnly}getReflectionTextureMatrix(){return H.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(Z){}get canRescale(){return!1}_getFromCache(Z,U,n,i,B,l){const H=this._getEngine();if(!H)return null;const V=H._getUseSRGBBuffer(!!B,U),G=H.getLoadedTexturesCache();for(let R=0;R<G.length;R++){const H=G[R];if((void 0===B||V===H._useSRGBBuffer)&&(void 0===i||i===H.invertY)&&H.url===Z&&H.generateMipMaps===!U&&(!n||n===H.samplingMode)&&(void 0===l||l===H.isCube))return H.incrementReferences(),H}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const Z=this.va();Z&&Z.markAllMaterialsAsDirty(1)}readPixels(){let Z=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],B=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,H=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,G=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const R=this._getEngine();if(!R)return null;const d=this.getSize();let F=d.width,y=d.height;0!==U&&(F/=Math.pow(2,U),y/=Math.pow(2,U),F=Math.round(F),y=Math.round(y)),V=Math.min(F,V),G=Math.min(y,G);try{return this._texture.isCube?R._readTexturePixels(this._texture,V,G,Z,U,n,i,B,l,H):R._readTexturePixels(this._texture,V,G,-1,U,n,i,B,l,H)}catch(S){return null}}_readPixelsSync(){let Z=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],B=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const l=this.getSize();let H=l.width,V=l.height;const G=this._getEngine();if(!G)return null;0!=U&&(H/=Math.pow(2,U),V/=Math.pow(2,U),H=Math.round(H),V=Math.round(V));try{return this._texture.isCube?G._readTexturePixelsSync(this._texture,H,V,Z,U,n,i,B):G._readTexturePixelsSync(this._texture,H,V,-1,U,n,i,B)}catch(R){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const Z=this._scene.textures.indexOf(this);if(Z>=0&&this._scene.textures.splice(Z,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const Z=this._parentContainer.textures.indexOf(this);Z>-1&&this._parentContainer.textures.splice(Z,1),this._parentContainer=null}}this.Oi.notifyObservers(this),this.Oi.clear(),this.metadata=null,super.dispose()}serialize(){let Z=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!Z)return null;const U=F.d.Serialize(this);return F.d.AppendSerializedAnimations(this,U),U}static WhenAllReady(Z,U){let n=Z.length;if(0!==n)for(let i=0;i<Z.length;i++){const B=Z[i];if(B.isReady())0===--n&&U();else{const Z=B.onLoadObservable;Z?Z.addOnce((()=>{0===--n&&U()})):0===--n&&U()}}else U()}static _IsScene(Z){return"Scene"===Z.getClassName()}}y.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,i.c)([(0,B.D)()],y.prototype,"uniqueId",void 0),(0,i.c)([(0,B.D)()],y.prototype,"name",void 0),(0,i.c)([(0,B.D)()],y.prototype,"displayName",void 0),(0,i.c)([(0,B.D)()],y.prototype,"metadata",void 0),(0,i.c)([(0,B.D)("Jj")],y.prototype,"_hasAlpha",void 0),(0,i.c)([(0,B.D)("getAlphaFromRGB")],y.prototype,"_getAlphaFromRGB",void 0),(0,i.c)([(0,B.D)()],y.prototype,"level",void 0),(0,i.c)([(0,B.D)("coordinatesIndex")],y.prototype,"_coordinatesIndex",void 0),(0,i.c)([(0,B.D)()],y.prototype,"optimizeUVAllocation",void 0),(0,i.c)([(0,B.D)("coordinatesMode")],y.prototype,"_coordinatesMode",void 0),(0,i.c)([(0,B.D)()],y.prototype,"wrapU",null),(0,i.c)([(0,B.D)()],y.prototype,"wrapV",null),(0,i.c)([(0,B.D)()],y.prototype,"wrapR",void 0),(0,i.c)([(0,B.D)()],y.prototype,"anisotropicFilteringLevel",void 0),(0,i.c)([(0,B.D)()],y.prototype,"isCube",null),(0,i.c)([(0,B.D)()],y.prototype,"is3D",null),(0,i.c)([(0,B.D)()],y.prototype,"is2DArray",null),(0,i.c)([(0,B.D)()],y.prototype,"gammaSpace",null),(0,i.c)([(0,B.D)()],y.prototype,"invertZ",void 0),(0,i.c)([(0,B.D)()],y.prototype,"lodLevelInAlpha",void 0),(0,i.c)([(0,B.D)()],y.prototype,"lodGenerationOffset",null),(0,i.c)([(0,B.D)()],y.prototype,"lodGenerationScale",null),(0,i.c)([(0,B.D)()],y.prototype,"linearSpecularLOD",null),(0,i.c)([(0,B.A)()],y.prototype,"irradianceTexture",null),(0,i.c)([(0,B.D)()],y.prototype,"isRenderTarget",void 0)},2303:(Z,U,n)=>{n.d(U,{c:()=>E});var i=n(673),B=n(681),l=n(493),H=n(702),V=n(2307),G=n(633),R=n(537),d=n(578),F=n(628),y=n(756),S=n(561);function q(Z,U){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=U.width,B=U.height;if(Z instanceof Float32Array){let U=Z.byteLength/Z.BYTES_PER_ELEMENT;const n=new Uint8Array(U);for(;--U>=0;){let i=Z[U];i<0?i=0:i>1&&(i=1),n[U]=255*i}Z=n}const l=document.createElement("canvas");l.width=i,l.height=B;const H=l.getContext("2d");if(!H)return null;const V=H.createImageData(i,B);if(V.data.set(Z),H.putImageData(V,0,0),n){const Z=document.createElement("canvas");Z.width=i,Z.height=B;const U=Z.getContext("2d");return U?(U.translate(0,B),U.scale(1,-1),U.drawImage(l,0,0),Z.toDataURL("image/png")):null}return l.toDataURL("image/png")}function c(Z){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Z.getInternalTexture();if(!i)return null;const B=Z._readPixelsSync(U,n);return B?q(B,Z.getSize(),i.invertY):null}async function s(Z){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Z.getInternalTexture();if(!i)return null;const B=await Z.readPixels(U,n);return B?q(B,Z.getSize(),i.invertY):null}var z=n(841),O=n(733);class E extends V.c{static _CreateVideoTexture(Z,U,n){arguments.length>5&&void 0!==arguments[5]||E.TRILINEAR_SAMPLINGMODE;throw(0,R.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(Z){this._isBlocking=Z}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(Z,U,n,i){let B,H=arguments.length>4&&void 0!==arguments[4]?arguments[4]:E.TRILINEAR_SAMPLINGMODE,V=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,R=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,F=arguments.length>8&&void 0!==arguments[8]&&arguments[8],y=arguments.length>9?arguments[9]:void 0,S=arguments.length>10?arguments[10]:void 0,q=arguments.length>11?arguments[11]:void 0,c=arguments.length>12?arguments[12]:void 0,s=arguments.length>13?arguments[13]:void 0;super(U),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new l.e,this._isBlocking=!0,this.name=Z||"",this.url=Z;let O=!1,t=null,p=!0;"object"===typeof n&&null!==n?(B=n.noMipmap??!1,i=n.invertY??!z.e,H=n.samplingMode??E.TRILINEAR_SAMPLINGMODE,V=n.X??null,G=n.onError??null,R=n.buffer??null,F=n.deleteBuffer??!1,y=n.format,S=n.mimeType,q=n.loaderOptions,c=n.creationFlags,O=n.useSRGBBuffer??!1,t=n.internalTexture??null,p=n.gammaSpace??p,s=n.forcedExtension??s):B=!!n,this._gammaSpace=p,this._noMipmap=B,this._invertY=void 0===i?!z.e:i,this._initialSamplingMode=H,this._buffer=R,this._deleteBuffer=F,this._mimeType=S,this._loaderOptions=q,this._creationFlags=c,this._useSRGBBuffer=O,this._forcedExtension=s,void 0!==y&&(this._format=y);const K=this.va(),C=this._getEngine();if(!C)return;C.onBeforeTextureInitObservable.notifyObservers(this);const D=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),V&&V(),!this.isBlocking&&K&&K.resetCachedMaterial()},u=(Z,U)=>{this._loadingError=!0,this._errorObject={message:Z,exception:U},G&&G(Z,U),E.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!t)return this._delayedOnLoad=D,void(this._delayedOnError=u);if(this._texture=t??this._getFromCache(this.url,B,H,this._invertY,O,this.isCube),this._texture)if(this._texture.isReady)d.c.SetImmediate((()=>D()));else{const Z=this._texture.onLoadedObservable.add(D);this._texture.onErrorObservable.add((U=>{var n;u(U.message,U.exception),null===(n=this._texture)||void 0===n||n.onLoadedObservable.remove(Z)}))}else if(K&&K.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=D,this._delayedOnError=u;else{try{this._texture=C.createTexture(this.url,B,this._invertY,K,H,D,u,this._buffer,void 0,this._format,this._forcedExtension,S,q,c,O)}catch(j){throw u("error loading",j),j}F&&(this._buffer=null)}}updateURL(Z){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=Z),this.url=Z,this._buffer=U,this._forcedExtension=i,this.delayLoadState=4,n&&(this._delayedOnLoad=n),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const Z=this.va();Z&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?d.c.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=Z.getEngine().createTexture(this.url,this._noMipmap,this._invertY,Z,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(Z,U,n,i){Z*=this._cachedUScale,U*=this._cachedVScale,Z-=this.uRotationCenter*this._cachedUScale,U-=this.vRotationCenter*this._cachedVScale,n-=this.wRotationCenter,H.k.TransformCoordinatesFromFloatsToRef(Z,U,n,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}getTextureMatrix(){let Z=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*Z===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*Z,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=H.b.Zero(),this._rowGenerationMatrix=new H.b,this._t0=H.k.Zero(),this._t1=H.k.Zero(),this._t2=H.k.Zero()),H.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(H.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,H.g.Matrix[0]),H.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,H.g.Matrix[1]),H.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,H.g.Matrix[2]),H.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,H.g.Matrix[3]),H.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(H.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(H.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(H.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Wi(this._t0),this._t2.Wi(this._t0),H.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const U=this.va();if(!U)return this._cachedTextureMatrix;const n=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&n!==this._cachedIdentity3x2&&U.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const Z=this.va();if(!Z)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==E.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===Z.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=H.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=H.b.Zero());const U=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case E.PLANAR_MODE:H.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case E.PROJECTION_MODE:{H.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const U=Z.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=U.updateFlag,U.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:H.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return U&&Z.markAllMaterialsAsDirty(1,(Z=>Z.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const Z={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return O.d.Clone((()=>new E(this._texture?this._texture.url:null,this.va(),Z)),this)}serialize(){var Z;const U=this.name;E.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const n=super.serialize(E._SerializeInternalTextureUniqueId);if(!n)return null;if(E.SerializeBuffers||E.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))n.base64String=this._buffer,n.name=n.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const Z=this.mimeType||"image/png";n.base64String=`data:${Z};base64,${(0,S.k)(this._buffer)}`}else(E.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(n.base64String=!this._engine||this._engine._features.supportSyncTextureRead?c(this):s(this));var i;(n.invertY=this._invertY,n.samplingMode=this.samplingMode,n._creationFlags=this._creationFlags,n._useSRGBBuffer=this._useSRGBBuffer,E._SerializeInternalTextureUniqueId)&&(n.internalTextureUniqueId=null===(i=this._texture)||void 0===i?void 0:i.uniqueId);return n.internalTextureLabel=null===(Z=this._texture)||void 0===Z?void 0:Z.label,n.noMipmap=this._noMipmap,this.name=U,n}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(Z,U,n){if(Z.customType){const i=F.c.Instantiate(Z.customType).Parse(Z,U,n);return Z.samplingMode&&i.updateSamplingMode&&i._samplingMode&&i._samplingMode!==Z.samplingMode&&i.updateSamplingMode(Z.samplingMode),i}if(Z.isCube&&!Z.isRenderTarget)return E._CubeTextureParser(Z,U,n);const i=void 0!==Z.internalTextureUniqueId;if(!Z.name&&!Z.isRenderTarget&&!i)return null;let B;if(i){const n=U.getEngine().getLoadedTexturesCache();for(const U of n)if(U.uniqueId===Z.internalTextureUniqueId){B=U;break}}const l=U=>{if(U&&U._texture&&(U._texture._cachedWrapU=null,U._texture._cachedWrapV=null,U._texture._cachedWrapR=null),Z.samplingMode){const n=Z.samplingMode;U&&U.samplingMode!==n&&U.updateSamplingMode(n)}if(U&&Z.animations)for(let n=0;n<Z.animations.length;n++){const i=Z.animations[n],B=(0,G.c)("BABYLON.Animation");B&&U.animations.push(B.Parse(i))}U&&U._texture&&(i&&!B&&U._texture._setUniqueId(Z.internalTextureUniqueId),U._texture.label=Z.internalTextureLabel)};return O.d.Parse((()=>{let i=!0;if(Z.noMipmap&&(i=!1),Z.mirrorPlane){const n=E._CreateMirror(Z.name,Z.renderTargetSize,U,i);return n._waitingRenderList=Z.renderList,n.mirrorPlane=y.b.ri(Z.mirrorPlane),l(n),n}if(Z.isRenderTarget){let n=null;if(Z.isCube){if(U.reflectionProbes)for(let i=0;i<U.reflectionProbes.length;i++){const n=U.reflectionProbes[i];if(n.name===Z.name)return n.cubeTexture}}else n=E._CreateRenderTargetTexture(Z.name,Z.renderTargetSize,U,i,Z._creationFlags??0),n._waitingRenderList=Z.renderList;return l(n),n}if(Z.isVideo){const B=E._CreateVideoTexture(n+(Z.url||Z.name),n+(Z.src||Z.url),U,i,Z.invertY,Z.samplingMode,Z.settings||{});return l(B),B}{let H;if(Z.base64String&&!B)H=E.CreateFromBase64String(Z.base64String,Z.base64String,U,!i,Z.invertY,Z.samplingMode,(()=>{l(H)}),Z._creationFlags??0,Z._useSRGBBuffer??!1),H.name=Z.name;else{let V;V=Z.name&&(Z.name.indexOf("://")>0||Z.name.startsWith("data:"))?Z.name:n+Z.name,Z.url&&(Z.url.startsWith("data:")||E.UseSerializedUrlIfAny)&&(V=Z.url);const G={noMipmap:!i,invertY:Z.invertY,samplingMode:Z.samplingMode,X:()=>{l(H)},internalTexture:B};H=new E(V,U,G)}return H}}),Z,U)}static CreateFromBase64String(Z,U,n,i,B){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:E.TRILINEAR_SAMPLINGMODE;return new E("data:"+U,n,i,B,l,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Z,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(Z,U,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],B=arguments.length>4?arguments[4]:void 0,l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],H=arguments.length>6&&void 0!==arguments[6]?arguments[6]:E.TRILINEAR_SAMPLINGMODE,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,G=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,R=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,d=arguments.length>10?arguments[10]:void 0,F=arguments.length>11?arguments[11]:void 0;return"data:"!==Z.substring(0,5)&&(Z="data:"+Z),new E(Z,n,B,l,H,V,G,U,i,R,void 0,void 0,d,F)}}E.SerializeBuffers=!0,E.ForceSerializeBuffers=!1,E.OnTextureLoadErrorObservable=new l.e,E._SerializeInternalTextureUniqueId=!1,E._CubeTextureParser=(Z,U,n)=>{throw(0,R.e)("CubeTexture")},E._CreateMirror=(Z,U,n,i)=>{throw(0,R.e)("MirrorTexture")},E._CreateRenderTargetTexture=(Z,U,n,i,B)=>{throw(0,R.e)("RenderTargetTexture")},E.NEAREST_SAMPLINGMODE=1,E.NEAREST_NEAREST_MIPLINEAR=8,E.BILINEAR_SAMPLINGMODE=2,E.LINEAR_LINEAR_MIPNEAREST=11,E.TRILINEAR_SAMPLINGMODE=3,E.LINEAR_LINEAR_MIPLINEAR=3,E.NEAREST_NEAREST_MIPNEAREST=4,E.NEAREST_LINEAR_MIPNEAREST=5,E.NEAREST_LINEAR_MIPLINEAR=6,E.NEAREST_LINEAR=7,E.NEAREST_NEAREST=1,E.LINEAR_NEAREST_MIPNEAREST=9,E.LINEAR_NEAREST_MIPLINEAR=10,E.LINEAR_LINEAR=2,E.LINEAR_NEAREST=12,E.EXPLICIT_MODE=0,E.SPHERICAL_MODE=1,E.PLANAR_MODE=2,E.CUBIC_MODE=3,E.PROJECTION_MODE=4,E.SKYBOX_MODE=5,E.INVCUBIC_MODE=6,E.EQUIRECTANGULAR_MODE=7,E.FIXED_EQUIRECTANGULAR_MODE=8,E.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,E.CLAMP_ADDRESSMODE=0,E.WRAP_ADDRESSMODE=1,E.MIRROR_ADDRESSMODE=2,E.UseSerializedUrlIfAny=!1,(0,i.c)([(0,B.D)()],E.prototype,"url",void 0),(0,i.c)([(0,B.D)()],E.prototype,"uOffset",void 0),(0,i.c)([(0,B.D)()],E.prototype,"vOffset",void 0),(0,i.c)([(0,B.D)()],E.prototype,"uScale",void 0),(0,i.c)([(0,B.D)()],E.prototype,"vScale",void 0),(0,i.c)([(0,B.D)()],E.prototype,"uAng",void 0),(0,i.c)([(0,B.D)()],E.prototype,"vAng",void 0),(0,i.c)([(0,B.D)()],E.prototype,"wAng",void 0),(0,i.c)([(0,B.D)()],E.prototype,"uRotationCenter",void 0),(0,i.c)([(0,B.D)()],E.prototype,"vRotationCenter",void 0),(0,i.c)([(0,B.D)()],E.prototype,"wRotationCenter",void 0),(0,i.c)([(0,B.D)()],E.prototype,"homogeneousRotationInUVTransform",void 0),(0,i.c)([(0,B.D)()],E.prototype,"isBlocking",null),(0,G.g)("BABYLON.Texture",E),O.d._TextureParser=E.Parse},2284:(Z,U,n)=>{n.d(U,{e:()=>i});class i{constructor(Z,U){this.width=Z,this.height=U}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let Z=0|this.width;return Z=397*Z^this.height,Z}p(Z){this.width=Z.width,this.height=Z.height}li(Z,U){return this.width=Z,this.height=U,this}set(Z,U){return this.li(Z,U)}multiplyByFloats(Z,U){return new i(this.width*Z,this.height*U)}clone(){return new i(this.width,this.height)}equals(Z){return!!Z&&(this.width===Z.width&&this.height===Z.height)}get surface(){return this.width*this.height}static Zero(){return new i(0,0)}add(Z){return new i(this.width+Z.width,this.height+Z.height)}Qg(Z){return new i(this.width-Z.width,this.height-Z.height)}scale(Z){return new i(this.width*Z,this.height*Z)}static Lerp(Z,U,n){const B=Z.width+(U.width-Z.width)*n,l=Z.height+(U.height-Z.height)*n;return new i(B,l)}}}}]);