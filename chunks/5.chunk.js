"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2407:(u,F,z)=>{z.d(F,{b:()=>E});var p=z(706),b=z(714),R=z(523),c=z(730),I=z(575),G=z(670),X=(z(583),z(2378));class j{get wrapU(){return this._wrapU}set wrapU(u){this._wrapU=u}get wrapV(){return this._wrapV}set wrapV(u){this._wrapV=u}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(u){this._texture&&(this._texture.isCube=u)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(u){this._texture&&(this._texture.is3D=u)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(u){this._texture&&(this._texture.is2DArray=u)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(u){return void 0!==(null===u||void 0===u?void 0:u.shareDepth)}constructor(u){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=X.d.Zero(),this._cachedBaseSize=X.d.Zero(),this._initialSamplingMode=2,this._texture=j._IsRenderTargetWrapper(u)?u.texture:u,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(u){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(u,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var W=z(762);class E extends j{set qi(u){this._hasAlpha!==u&&(this._hasAlpha=u,this._scene&&this._scene.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))))}get qi(){return this._hasAlpha}set getAlphaFromRGB(u){this._getAlphaFromRGB!==u&&(this._getAlphaFromRGB=u,this._scene&&this._scene.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(u){this._coordinatesIndex!==u&&(this._coordinatesIndex=u,this._scene&&this._scene.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(u){this._coordinatesMode!==u&&(this._coordinatesMode=u,this._scene&&this._scene.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(u){this._wrapU=u}get wrapV(){return this._wrapV}set wrapV(u){this._wrapV=u}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(u){this._texture?this._texture.isCube=u:this._isCube=u}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(u){this._texture&&(this._texture.is3D=u)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(u){this._texture&&(this._texture.is2DArray=u)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(u){var F;if(this._texture){if(this._texture._gammaSpace===u)return;this._texture._gammaSpace=u}else{if(this._gammaSpace===u)return;this._gammaSpace=u}null===(F=this.va())||void 0===F||F.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(u){var F;u!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=u),null===(F=this.va())||void 0===F||F.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(u){this._texture&&(this._texture._lodGenerationOffset=u)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(u){this._texture&&(this._texture._lodGenerationScale=u)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(u){this._texture&&(this._texture._linearSpecularLOD=u)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(u){this._texture&&(this._texture._irradianceTexture=u)}get uid(){return this._uid||(this._uid=(0,G.c)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(u){this._onDisposeObserver&&this.dk.remove(this._onDisposeObserver),this._onDisposeObserver=this.dk.add(u)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(u){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=E.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.dk=new R.d,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,u?E._IsScene(u)?this._scene=u:this._engine=u:this._scene=I.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=F,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return c.b.IdentityReadOnly}getReflectionTextureMatrix(){return c.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(u){}get canRescale(){return!1}_getFromCache(u,F,z,p,b,R){const c=this._getEngine();if(!c)return null;const I=c._getUseSRGBBuffer(!!b,F),G=c.getLoadedTexturesCache();for(let X=0;X<G.length;X++){const c=G[X];if((void 0===b||I===c._useSRGBBuffer)&&(void 0===p||p===c.invertY)&&c.url===u&&c.generateMipMaps===!F&&(!z||z===c.samplingMode)&&(void 0===R||R===c.isCube))return c.incrementReferences(),c}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const u=this.va();u&&u.markAllMaterialsAsDirty(1)}readPixels(){let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],b=arguments.length>4&&void 0!==arguments[4]&&arguments[4],R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,I=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,G=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const X=this._getEngine();if(!X)return null;const j=this.getSize();let W=j.width,E=j.height;0!==F&&(W/=Math.pow(2,F),E/=Math.pow(2,F),W=Math.round(W),E=Math.round(E)),I=Math.min(W,I),G=Math.min(E,G);try{return this._texture.isCube?X._readTexturePixels(this._texture,I,G,u,F,z,p,b,R,c):X._readTexturePixels(this._texture,I,G,-1,F,z,p,b,R,c)}catch(L){return null}}_readPixelsSync(){let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],b=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const R=this.getSize();let c=R.width,I=R.height;const G=this._getEngine();if(!G)return null;0!=F&&(c/=Math.pow(2,F),I/=Math.pow(2,F),c=Math.round(c),I=Math.round(I));try{return this._texture.isCube?G._readTexturePixelsSync(this._texture,c,I,u,F,z,p,b):G._readTexturePixelsSync(this._texture,c,I,-1,F,z,p,b)}catch(X){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const u=this._scene.textures.indexOf(this);if(u>=0&&this._scene.textures.splice(u,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const u=this._parentContainer.textures.indexOf(this);u>-1&&this._parentContainer.textures.splice(u,1),this._parentContainer=null}}this.dk.notifyObservers(this),this.dk.clear(),this.metadata=null,super.dispose()}serialize(){let u=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!u)return null;const F=W.e.Serialize(this);return W.e.AppendSerializedAnimations(this,F),F}static WhenAllReady(u,F){let z=u.length;if(0!==z)for(let p=0;p<u.length;p++){const b=u[p];if(b.isReady())0===--z&&F();else{const u=b.onLoadObservable;u?u.addOnce((()=>{0===--z&&F()})):0===--z&&F()}}else F()}static _IsScene(u){return"Scene"===u.getClassName()}}E.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,p.e)([(0,b.E)()],E.prototype,"uniqueId",void 0),(0,p.e)([(0,b.E)()],E.prototype,"name",void 0),(0,p.e)([(0,b.E)()],E.prototype,"displayName",void 0),(0,p.e)([(0,b.E)()],E.prototype,"metadata",void 0),(0,p.e)([(0,b.E)("qi")],E.prototype,"_hasAlpha",void 0),(0,p.e)([(0,b.E)("getAlphaFromRGB")],E.prototype,"_getAlphaFromRGB",void 0),(0,p.e)([(0,b.E)()],E.prototype,"level",void 0),(0,p.e)([(0,b.E)("coordinatesIndex")],E.prototype,"_coordinatesIndex",void 0),(0,p.e)([(0,b.E)()],E.prototype,"optimizeUVAllocation",void 0),(0,p.e)([(0,b.E)("coordinatesMode")],E.prototype,"_coordinatesMode",void 0),(0,p.e)([(0,b.E)()],E.prototype,"wrapU",null),(0,p.e)([(0,b.E)()],E.prototype,"wrapV",null),(0,p.e)([(0,b.E)()],E.prototype,"wrapR",void 0),(0,p.e)([(0,b.E)()],E.prototype,"anisotropicFilteringLevel",void 0),(0,p.e)([(0,b.E)()],E.prototype,"isCube",null),(0,p.e)([(0,b.E)()],E.prototype,"is3D",null),(0,p.e)([(0,b.E)()],E.prototype,"is2DArray",null),(0,p.e)([(0,b.E)()],E.prototype,"gammaSpace",null),(0,p.e)([(0,b.E)()],E.prototype,"invertZ",void 0),(0,p.e)([(0,b.E)()],E.prototype,"lodLevelInAlpha",void 0),(0,p.e)([(0,b.E)()],E.prototype,"lodGenerationOffset",null),(0,p.e)([(0,b.E)()],E.prototype,"lodGenerationScale",null),(0,p.e)([(0,b.E)()],E.prototype,"linearSpecularLOD",null),(0,p.e)([(0,b.A)()],E.prototype,"irradianceTexture",null),(0,p.e)([(0,b.E)()],E.prototype,"isRenderTarget",void 0)},2403:(u,F,z)=>{z.d(F,{e:()=>C});var p=z(706),b=z(714),R=z(523),c=z(730),I=z(2407),G=z(668),X=z(561),j=z(601),W=z(664),E=z(789),L=z(590);function k(u,F){let z=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const p=F.width,b=F.height;if(u instanceof Float32Array){let F=u.byteLength/u.BYTES_PER_ELEMENT;const z=new Uint8Array(F);for(;--F>=0;){let p=u[F];p<0?p=0:p>1&&(p=1),z[F]=255*p}u=z}const R=document.createElement("canvas");R.width=p,R.height=b;const c=R.getContext("2d");if(!c)return null;const I=c.createImageData(p,b);if(I.data.set(u),c.putImageData(I,0,0),z){const u=document.createElement("canvas");u.width=p,u.height=b;const F=u.getContext("2d");return F?(F.translate(0,b),F.scale(1,-1),F.drawImage(R,0,0),u.toDataURL("image/png")):null}return R.toDataURL("image/png")}function N(u){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const p=u.getInternalTexture();if(!p)return null;const b=u._readPixelsSync(F,z);return b?k(b,u.getSize(),p.invertY):null}async function Y(u){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const p=u.getInternalTexture();if(!p)return null;const b=await u.readPixels(F,z);return b?k(b,u.getSize(),p.invertY):null}var e=z(877),d=z(762);class C extends I.b{static _CreateVideoTexture(u,F,z){arguments.length>5&&void 0!==arguments[5]||C.TRILINEAR_SAMPLINGMODE;throw(0,X.b)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(u){this._isBlocking=u}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(u,F,z,p){let b,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C.TRILINEAR_SAMPLINGMODE,I=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,X=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,W=arguments.length>8&&void 0!==arguments[8]&&arguments[8],E=arguments.length>9?arguments[9]:void 0,L=arguments.length>10?arguments[10]:void 0,k=arguments.length>11?arguments[11]:void 0,N=arguments.length>12?arguments[12]:void 0,Y=arguments.length>13?arguments[13]:void 0;super(F),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new R.d,this._isBlocking=!0,this.name=u||"",this.url=u;let d=!1,r=null,f=!0;"object"===typeof z&&null!==z?(b=z.noMipmap??!1,p=z.invertY??!e.c,c=z.samplingMode??C.TRILINEAR_SAMPLINGMODE,I=z.X??null,G=z.onError??null,X=z.buffer??null,W=z.deleteBuffer??!1,E=z.format,L=z.mimeType,k=z.loaderOptions,N=z.creationFlags,d=z.useSRGBBuffer??!1,r=z.internalTexture??null,f=z.gammaSpace??f,Y=z.forcedExtension??Y):b=!!z,this._gammaSpace=f,this._noMipmap=b,this._invertY=void 0===p?!e.c:p,this._initialSamplingMode=c,this._buffer=X,this._deleteBuffer=W,this._mimeType=L,this._loaderOptions=k,this._creationFlags=N,this._useSRGBBuffer=d,this._forcedExtension=Y,void 0!==E&&(this._format=E);const n=this.va(),T=this._getEngine();if(!T)return;T.onBeforeTextureInitObservable.notifyObservers(this);const H=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),I&&I(),!this.isBlocking&&n&&n.resetCachedMaterial()},y=(u,F)=>{this._loadingError=!0,this._errorObject={message:u,exception:F},G&&G(u,F),C.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!r)return this._delayedOnLoad=H,void(this._delayedOnError=y);if(this._texture=r??this._getFromCache(this.url,b,c,this._invertY,d,this.isCube),this._texture)if(this._texture.isReady)j.b.SetImmediate((()=>H()));else{const u=this._texture.onLoadedObservable.add(H);this._texture.onErrorObservable.add((F=>{var z;y(F.message,F.exception),null===(z=this._texture)||void 0===z||z.onLoadedObservable.remove(u)}))}else if(n&&n.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=H,this._delayedOnError=y;else{try{this._texture=T.createTexture(this.url,b,this._invertY,n,c,H,y,this._buffer,void 0,this._format,this._forcedExtension,L,k,N,d)}catch(U){throw y("error loading",U),U}W&&(this._buffer=null)}}updateURL(u){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2?arguments[2]:void 0,p=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(u=>u.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=u),this.url=u,this._buffer=F,this._forcedExtension=p,this.delayLoadState=4,z&&(this._delayedOnLoad=z),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const u=this.va();u&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?j.b.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=u.getEngine().createTexture(this.url,this._noMipmap,this._invertY,u,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(u,F,z,p){u*=this._cachedUScale,F*=this._cachedVScale,u-=this.uRotationCenter*this._cachedUScale,F-=this.vRotationCenter*this._cachedVScale,z-=this.wRotationCenter,c.l.TransformCoordinatesFromFloatsToRef(u,F,z,this._rowGenerationMatrix,p),p.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,p.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,p.z+=this.wRotationCenter}getTextureMatrix(){let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*u===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*u,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=c.b.Zero(),this._rowGenerationMatrix=new c.b,this._t0=c.l.Zero(),this._t1=c.l.Zero(),this._t2=c.l.Zero()),c.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(c.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,c.h.Matrix[0]),c.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,c.h.Matrix[1]),c.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,c.h.Matrix[2]),c.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,c.h.Matrix[3]),c.h.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(c.h.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(c.h.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(c.h.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.ak(this._t0),this._t2.ak(this._t0),c.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const F=this.va();if(!F)return this._cachedTextureMatrix;const z=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&z!==this._cachedIdentity3x2&&F.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const u=this.va();if(!u)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==C.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===u.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=c.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=c.b.Zero());const F=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case C.PLANAR_MODE:c.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case C.PROJECTION_MODE:{c.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const F=u.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=F.updateFlag,F.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:c.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return F&&u.markAllMaterialsAsDirty(1,(u=>u.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const u={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return d.e.Clone((()=>new C(this._texture?this._texture.url:null,this.va(),u)),this)}serialize(){var u;const F=this.name;C.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const z=super.serialize(C._SerializeInternalTextureUniqueId);if(!z)return null;if(C.SerializeBuffers||C.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))z.base64String=this._buffer,z.name=z.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const u=this.mimeType||"image/png";z.base64String=`data:${u};base64,${(0,L.l)(this._buffer)}`}else(C.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(z.base64String=!this._engine||this._engine._features.supportSyncTextureRead?N(this):Y(this));var p;(z.invertY=this._invertY,z.samplingMode=this.samplingMode,z._creationFlags=this._creationFlags,z._useSRGBBuffer=this._useSRGBBuffer,C._SerializeInternalTextureUniqueId)&&(z.internalTextureUniqueId=null===(p=this._texture)||void 0===p?void 0:p.uniqueId);return z.internalTextureLabel=null===(u=this._texture)||void 0===u?void 0:u.label,z.noMipmap=this._noMipmap,this.name=F,z}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(u,F,z){if(u.customType){const p=W.c.Instantiate(u.customType).Parse(u,F,z);return u.samplingMode&&p.updateSamplingMode&&p._samplingMode&&p._samplingMode!==u.samplingMode&&p.updateSamplingMode(u.samplingMode),p}if(u.isCube&&!u.isRenderTarget)return C._CubeTextureParser(u,F,z);const p=void 0!==u.internalTextureUniqueId;if(!u.name&&!u.isRenderTarget&&!p)return null;let b;if(p){const z=F.getEngine().getLoadedTexturesCache();for(const F of z)if(F.uniqueId===u.internalTextureUniqueId){b=F;break}}const R=F=>{if(F&&F._texture&&(F._texture._cachedWrapU=null,F._texture._cachedWrapV=null,F._texture._cachedWrapR=null),u.samplingMode){const z=u.samplingMode;F&&F.samplingMode!==z&&F.updateSamplingMode(z)}if(F&&u.animations)for(let z=0;z<u.animations.length;z++){const p=u.animations[z],b=(0,G.d)("BABYLON.Animation");b&&F.animations.push(b.Parse(p))}F&&F._texture&&(p&&!b&&F._texture._setUniqueId(u.internalTextureUniqueId),F._texture.label=u.internalTextureLabel)};return d.e.Parse((()=>{let p=!0;if(u.noMipmap&&(p=!1),u.mirrorPlane){const z=C._CreateMirror(u.name,u.renderTargetSize,F,p);return z._waitingRenderList=u.renderList,z.mirrorPlane=E.d.Yj(u.mirrorPlane),R(z),z}if(u.isRenderTarget){let z=null;if(u.isCube){if(F.reflectionProbes)for(let p=0;p<F.reflectionProbes.length;p++){const z=F.reflectionProbes[p];if(z.name===u.name)return z.cubeTexture}}else z=C._CreateRenderTargetTexture(u.name,u.renderTargetSize,F,p,u._creationFlags??0),z._waitingRenderList=u.renderList;return R(z),z}if(u.isVideo){const b=C._CreateVideoTexture(z+(u.url||u.name),z+(u.src||u.url),F,p,u.invertY,u.samplingMode,u.settings||{});return R(b),b}{let c;if(u.base64String&&!b)c=C.CreateFromBase64String(u.base64String,u.base64String,F,!p,u.invertY,u.samplingMode,(()=>{R(c)}),u._creationFlags??0,u._useSRGBBuffer??!1),c.name=u.name;else{let I;I=u.name&&(u.name.indexOf("://")>0||u.name.startsWith("data:"))?u.name:z+u.name,u.url&&(u.url.startsWith("data:")||C.UseSerializedUrlIfAny)&&(I=u.url);const G={noMipmap:!p,invertY:u.invertY,samplingMode:u.samplingMode,X:()=>{R(c)},internalTexture:b};c=new C(I,F,G)}return c}}),u,F)}static CreateFromBase64String(u,F,z,p,b){let R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:C.TRILINEAR_SAMPLINGMODE;return new C("data:"+F,z,p,b,R,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(u,F,z){let p=arguments.length>3&&void 0!==arguments[3]&&arguments[3],b=arguments.length>4?arguments[4]:void 0,R=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C.TRILINEAR_SAMPLINGMODE,I=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,G=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,X=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,j=arguments.length>10?arguments[10]:void 0,W=arguments.length>11?arguments[11]:void 0;return"data:"!==u.substring(0,5)&&(u="data:"+u),new C(u,z,b,R,c,I,G,F,p,X,void 0,void 0,j,W)}}C.SerializeBuffers=!0,C.ForceSerializeBuffers=!1,C.OnTextureLoadErrorObservable=new R.d,C._SerializeInternalTextureUniqueId=!1,C._CubeTextureParser=(u,F,z)=>{throw(0,X.b)("CubeTexture")},C._CreateMirror=(u,F,z,p)=>{throw(0,X.b)("MirrorTexture")},C._CreateRenderTargetTexture=(u,F,z,p,b)=>{throw(0,X.b)("RenderTargetTexture")},C.NEAREST_SAMPLINGMODE=1,C.NEAREST_NEAREST_MIPLINEAR=8,C.BILINEAR_SAMPLINGMODE=2,C.LINEAR_LINEAR_MIPNEAREST=11,C.TRILINEAR_SAMPLINGMODE=3,C.LINEAR_LINEAR_MIPLINEAR=3,C.NEAREST_NEAREST_MIPNEAREST=4,C.NEAREST_LINEAR_MIPNEAREST=5,C.NEAREST_LINEAR_MIPLINEAR=6,C.NEAREST_LINEAR=7,C.NEAREST_NEAREST=1,C.LINEAR_NEAREST_MIPNEAREST=9,C.LINEAR_NEAREST_MIPLINEAR=10,C.LINEAR_LINEAR=2,C.LINEAR_NEAREST=12,C.EXPLICIT_MODE=0,C.SPHERICAL_MODE=1,C.PLANAR_MODE=2,C.CUBIC_MODE=3,C.PROJECTION_MODE=4,C.SKYBOX_MODE=5,C.INVCUBIC_MODE=6,C.EQUIRECTANGULAR_MODE=7,C.FIXED_EQUIRECTANGULAR_MODE=8,C.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,C.CLAMP_ADDRESSMODE=0,C.WRAP_ADDRESSMODE=1,C.MIRROR_ADDRESSMODE=2,C.UseSerializedUrlIfAny=!1,(0,p.e)([(0,b.E)()],C.prototype,"url",void 0),(0,p.e)([(0,b.E)()],C.prototype,"uOffset",void 0),(0,p.e)([(0,b.E)()],C.prototype,"vOffset",void 0),(0,p.e)([(0,b.E)()],C.prototype,"uScale",void 0),(0,p.e)([(0,b.E)()],C.prototype,"vScale",void 0),(0,p.e)([(0,b.E)()],C.prototype,"uAng",void 0),(0,p.e)([(0,b.E)()],C.prototype,"vAng",void 0),(0,p.e)([(0,b.E)()],C.prototype,"wAng",void 0),(0,p.e)([(0,b.E)()],C.prototype,"uRotationCenter",void 0),(0,p.e)([(0,b.E)()],C.prototype,"vRotationCenter",void 0),(0,p.e)([(0,b.E)()],C.prototype,"wRotationCenter",void 0),(0,p.e)([(0,b.E)()],C.prototype,"homogeneousRotationInUVTransform",void 0),(0,p.e)([(0,b.E)()],C.prototype,"isBlocking",null),(0,G.h)("BABYLON.Texture",C),d.e._TextureParser=C.Parse},2378:(u,F,z)=>{z.d(F,{d:()=>p});class p{constructor(u,F){this.width=u,this.height=F}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let u=0|this.width;return u=397*u^this.height,u}p(u){this.width=u.width,this.height=u.height}ad(u,F){return this.width=u,this.height=F,this}set(u,F){return this.ad(u,F)}multiplyByFloats(u,F){return new p(this.width*u,this.height*F)}clone(){return new p(this.width,this.height)}equals(u){return!!u&&(this.width===u.width&&this.height===u.height)}get surface(){return this.width*this.height}static Zero(){return new p(0,0)}add(u){return new p(this.width+u.width,this.height+u.height)}Md(u){return new p(this.width-u.width,this.height-u.height)}scale(u){return new p(this.width*u,this.height*u)}static Lerp(u,F,z){const b=u.width+(F.width-u.width)*z,R=u.height+(F.height-u.height)*z;return new p(b,R)}}}}]);