"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2465:(P,Q,O)=>{O.d(Q,{e:()=>G});var b=O(732),F=O(740),g=O(537),m=O(751),q=O(598),R=O(703),X=(O(602),O(2436));class C{get wrapU(){return this._wrapU}set wrapU(P){this._wrapU=P}get wrapV(){return this._wrapV}set wrapV(P){this._wrapV=P}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(P){this._texture&&(this._texture.isCube=P)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(P){this._texture&&(this._texture.is3D=P)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(P){this._texture&&(this._texture.is2DArray=P)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(P){return void 0!==(null===P||void 0===P?void 0:P.shareDepth)}constructor(P){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=X.e.Zero(),this._cachedBaseSize=X.e.Zero(),this._initialSamplingMode=2,this._texture=C._IsRenderTargetWrapper(P)?P.texture:P,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(P){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(P,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var L=O(790);class G extends C{set wi(P){this._hasAlpha!==P&&(this._hasAlpha=P,this._scene&&this._scene.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))))}get wi(){return this._hasAlpha}set getAlphaFromRGB(P){this._getAlphaFromRGB!==P&&(this._getAlphaFromRGB=P,this._scene&&this._scene.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(P){this._coordinatesIndex!==P&&(this._coordinatesIndex=P,this._scene&&this._scene.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(P){this._coordinatesMode!==P&&(this._coordinatesMode=P,this._scene&&this._scene.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(P){this._wrapU=P}get wrapV(){return this._wrapV}set wrapV(P){this._wrapV=P}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(P){this._texture?this._texture.isCube=P:this._isCube=P}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(P){this._texture&&(this._texture.is3D=P)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(P){this._texture&&(this._texture.is2DArray=P)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(P){var Q;if(this._texture){if(this._texture._gammaSpace===P)return;this._texture._gammaSpace=P}else{if(this._gammaSpace===P)return;this._gammaSpace=P}null===(Q=this.va())||void 0===Q||Q.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(P){var Q;P!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=P),null===(Q=this.va())||void 0===Q||Q.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(P){this._texture&&(this._texture._lodGenerationOffset=P)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(P){this._texture&&(this._texture._lodGenerationScale=P)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(P){this._texture&&(this._texture._linearSpecularLOD=P)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(P){this._texture&&(this._texture._irradianceTexture=P)}get uid(){return this._uid||(this._uid=(0,R.c)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(P){this._onDisposeObserver&&this.ik.remove(this._onDisposeObserver),this._onDisposeObserver=this.ik.add(P)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(P){let Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=G.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.ik=new g.d,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,P?G._IsScene(P)?this._scene=P:this._engine=P:this._scene=q.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=Q,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return m.c.IdentityReadOnly}getReflectionTextureMatrix(){return m.c.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(P){}get canRescale(){return!1}_getFromCache(P,Q,O,b,F,g){const m=this._getEngine();if(!m)return null;const q=m._getUseSRGBBuffer(!!F,Q),R=m.getLoadedTexturesCache();for(let X=0;X<R.length;X++){const m=R[X];if((void 0===F||q===m._useSRGBBuffer)&&(void 0===b||b===m.invertY)&&m.url===P&&m.generateMipMaps===!Q&&(!O||O===m.samplingMode)&&(void 0===g||g===m.isCube))return m.incrementReferences(),m}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const P=this.va();P&&P.markAllMaterialsAsDirty(1)}readPixels(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,O=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,b=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],F=arguments.length>4&&void 0!==arguments[4]&&arguments[4],g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,m=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,q=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,R=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const X=this._getEngine();if(!X)return null;const C=this.getSize();let L=C.width,G=C.height;0!==Q&&(L/=Math.pow(2,Q),G/=Math.pow(2,Q),L=Math.round(L),G=Math.round(G)),q=Math.min(L,q),R=Math.min(G,R);try{return this._texture.isCube?X._readTexturePixels(this._texture,q,R,P,Q,O,b,F,g,m):X._readTexturePixels(this._texture,q,R,-1,Q,O,b,F,g,m)}catch(A){return null}}_readPixelsSync(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,O=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,b=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],F=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const g=this.getSize();let m=g.width,q=g.height;const R=this._getEngine();if(!R)return null;0!=Q&&(m/=Math.pow(2,Q),q/=Math.pow(2,Q),m=Math.round(m),q=Math.round(q));try{return this._texture.isCube?R._readTexturePixelsSync(this._texture,m,q,P,Q,O,b,F):R._readTexturePixelsSync(this._texture,m,q,-1,Q,O,b,F)}catch(X){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const P=this._scene.textures.indexOf(this);if(P>=0&&this._scene.textures.splice(P,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const P=this._parentContainer.textures.indexOf(this);P>-1&&this._parentContainer.textures.splice(P,1),this._parentContainer=null}}this.ik.notifyObservers(this),this.ik.clear(),this.metadata=null,super.dispose()}serialize(){let P=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!P)return null;const Q=L.c.Serialize(this);return L.c.AppendSerializedAnimations(this,Q),Q}static WhenAllReady(P,Q){let O=P.length;if(0!==O)for(let b=0;b<P.length;b++){const F=P[b];if(F.isReady())0===--O&&Q();else{const P=F.onLoadObservable;P?P.addOnce((()=>{0===--O&&Q()})):0===--O&&Q()}}else Q()}static _IsScene(P){return"Scene"===P.getClassName()}}G.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,b.c)([(0,F.N)()],G.prototype,"uniqueId",void 0),(0,b.c)([(0,F.N)()],G.prototype,"name",void 0),(0,b.c)([(0,F.N)()],G.prototype,"displayName",void 0),(0,b.c)([(0,F.N)()],G.prototype,"metadata",void 0),(0,b.c)([(0,F.N)("wi")],G.prototype,"_hasAlpha",void 0),(0,b.c)([(0,F.N)("getAlphaFromRGB")],G.prototype,"_getAlphaFromRGB",void 0),(0,b.c)([(0,F.N)()],G.prototype,"level",void 0),(0,b.c)([(0,F.N)("coordinatesIndex")],G.prototype,"_coordinatesIndex",void 0),(0,b.c)([(0,F.N)()],G.prototype,"optimizeUVAllocation",void 0),(0,b.c)([(0,F.N)("coordinatesMode")],G.prototype,"_coordinatesMode",void 0),(0,b.c)([(0,F.N)()],G.prototype,"wrapU",null),(0,b.c)([(0,F.N)()],G.prototype,"wrapV",null),(0,b.c)([(0,F.N)()],G.prototype,"wrapR",void 0),(0,b.c)([(0,F.N)()],G.prototype,"anisotropicFilteringLevel",void 0),(0,b.c)([(0,F.N)()],G.prototype,"isCube",null),(0,b.c)([(0,F.N)()],G.prototype,"is3D",null),(0,b.c)([(0,F.N)()],G.prototype,"is2DArray",null),(0,b.c)([(0,F.N)()],G.prototype,"gammaSpace",null),(0,b.c)([(0,F.N)()],G.prototype,"invertZ",void 0),(0,b.c)([(0,F.N)()],G.prototype,"lodLevelInAlpha",void 0),(0,b.c)([(0,F.N)()],G.prototype,"lodGenerationOffset",null),(0,b.c)([(0,F.N)()],G.prototype,"lodGenerationScale",null),(0,b.c)([(0,F.N)()],G.prototype,"linearSpecularLOD",null),(0,b.c)([(0,F.H)()],G.prototype,"irradianceTexture",null),(0,b.c)([(0,F.N)()],G.prototype,"isRenderTarget",void 0)},2460:(P,Q,O)=>{O.d(Q,{c:()=>T});var b=O(732),F=O(740),g=O(537),m=O(751),q=O(2465),R=O(696),X=O(582),C=O(630),L=O(693),G=O(808),A=O(610);function j(P,Q){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const b=Q.width,F=Q.height;if(P instanceof Float32Array){let Q=P.byteLength/P.BYTES_PER_ELEMENT;const O=new Uint8Array(Q);for(;--Q>=0;){let b=P[Q];b<0?b=0:b>1&&(b=1),O[Q]=255*b}P=O}const g=document.createElement("canvas");g.width=b,g.height=F;const m=g.getContext("2d");if(!m)return null;const q=m.createImageData(b,F);if(q.data.set(P),m.putImageData(q,0,0),O){const P=document.createElement("canvas");P.width=b,P.height=F;const Q=P.getContext("2d");return Q?(Q.translate(0,F),Q.scale(1,-1),Q.drawImage(g,0,0),P.toDataURL("image/png")):null}return g.toDataURL("image/png")}function w(P){let Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,O=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const b=P.getInternalTexture();if(!b)return null;const F=P._readPixelsSync(Q,O);return F?j(F,P.getSize(),b.invertY):null}async function W(P){let Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,O=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const b=P.getInternalTexture();if(!b)return null;const F=await P.readPixels(Q,O);return F?j(F,P.getSize(),b.invertY):null}var r=O(893),K=O(790);class T extends q.e{static _CreateVideoTexture(P,Q,O){arguments.length>5&&void 0!==arguments[5]||T.TRILINEAR_SAMPLINGMODE;throw(0,X.b)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(P){this._isBlocking=P}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(P,Q,O,b){let F,m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:T.TRILINEAR_SAMPLINGMODE,q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,R=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,X=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L=arguments.length>8&&void 0!==arguments[8]&&arguments[8],G=arguments.length>9?arguments[9]:void 0,A=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0,w=arguments.length>12?arguments[12]:void 0,W=arguments.length>13?arguments[13]:void 0;super(Q),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new g.d,this._isBlocking=!0,this.name=P||"",this.url=P;let K=!1,x=null,u=!0;"object"===typeof O&&null!==O?(F=O.noMipmap??!1,b=O.invertY??!r.b,m=O.samplingMode??T.TRILINEAR_SAMPLINGMODE,q=O.X??null,R=O.onError??null,X=O.buffer??null,L=O.deleteBuffer??!1,G=O.format,A=O.mimeType,j=O.loaderOptions,w=O.creationFlags,K=O.useSRGBBuffer??!1,x=O.internalTexture??null,u=O.gammaSpace??u,W=O.forcedExtension??W):F=!!O,this._gammaSpace=u,this._noMipmap=F,this._invertY=void 0===b?!r.b:b,this._initialSamplingMode=m,this._buffer=X,this._deleteBuffer=L,this._mimeType=A,this._loaderOptions=j,this._creationFlags=w,this._useSRGBBuffer=K,this._forcedExtension=W,void 0!==G&&(this._format=G);const H=this.va(),t=this._getEngine();if(!t)return;t.onBeforeTextureInitObservable.notifyObservers(this);const B=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),q&&q(),!this.isBlocking&&H&&H.resetCachedMaterial()},I=(P,Q)=>{this._loadingError=!0,this._errorObject={message:P,exception:Q},R&&R(P,Q),T.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!x)return this._delayedOnLoad=B,void(this._delayedOnError=I);if(this._texture=x??this._getFromCache(this.url,F,m,this._invertY,K,this.isCube),this._texture)if(this._texture.isReady)C.b.SetImmediate((()=>B()));else{const P=this._texture.onLoadedObservable.add(B);this._texture.onErrorObservable.add((Q=>{var O;I(Q.message,Q.exception),null===(O=this._texture)||void 0===O||O.onLoadedObservable.remove(P)}))}else if(H&&H.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=B,this._delayedOnError=I;else{try{this._texture=t.createTexture(this.url,F,this._invertY,H,m,B,I,this._buffer,void 0,this._format,this._forcedExtension,A,j,w,K)}catch(l){throw I("error loading",l),l}L&&(this._buffer=null)}}updateURL(P){let Q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,O=arguments.length>2?arguments[2]:void 0,b=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(P=>P.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=P),this.url=P,this._buffer=Q,this._forcedExtension=b,this.delayLoadState=4,O&&(this._delayedOnLoad=O),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const P=this.va();P&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?C.b.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=P.getEngine().createTexture(this.url,this._noMipmap,this._invertY,P,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(P,Q,O,b){P*=this._cachedUScale,Q*=this._cachedVScale,P-=this.uRotationCenter*this._cachedUScale,Q-=this.vRotationCenter*this._cachedVScale,O-=this.wRotationCenter,m.j.TransformCoordinatesFromFloatsToRef(P,Q,O,this._rowGenerationMatrix,b),b.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,b.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,b.z+=this.wRotationCenter}getTextureMatrix(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*P===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*P,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=m.c.Zero(),this._rowGenerationMatrix=new m.c,this._t0=m.j.Zero(),this._t1=m.j.Zero(),this._t2=m.j.Zero()),m.c.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(m.c.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,m.f.Matrix[0]),m.c.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,m.f.Matrix[1]),m.c.ScalingToRef(this._cachedUScale,this._cachedVScale,0,m.f.Matrix[2]),m.c.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,m.f.Matrix[3]),m.f.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(m.f.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(m.f.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(m.f.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.fk(this._t0),this._t2.fk(this._t0),m.c.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const Q=this.va();if(!Q)return this._cachedTextureMatrix;const O=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&O!==this._cachedIdentity3x2&&Q.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const P=this.va();if(!P)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==T.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===P.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=m.c.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=m.c.Zero());const Q=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case T.PLANAR_MODE:m.c.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case T.PROJECTION_MODE:{m.c.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const Q=P.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=Q.updateFlag,Q.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:m.c.IdentityToRef(this._cachedReflectionTextureMatrix)}return Q&&P.markAllMaterialsAsDirty(1,(P=>P.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const P={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return K.c.Clone((()=>new T(this._texture?this._texture.url:null,this.va(),P)),this)}serialize(){var P;const Q=this.name;T.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const O=super.serialize(T._SerializeInternalTextureUniqueId);if(!O)return null;if(T.SerializeBuffers||T.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))O.base64String=this._buffer,O.name=O.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const P=this.mimeType||"image/png";O.base64String=`data:${P};base64,${(0,A.j)(this._buffer)}`}else(T.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(O.base64String=!this._engine||this._engine._features.supportSyncTextureRead?w(this):W(this));var b;(O.invertY=this._invertY,O.samplingMode=this.samplingMode,O._creationFlags=this._creationFlags,O._useSRGBBuffer=this._useSRGBBuffer,T._SerializeInternalTextureUniqueId)&&(O.internalTextureUniqueId=null===(b=this._texture)||void 0===b?void 0:b.uniqueId);return O.internalTextureLabel=null===(P=this._texture)||void 0===P?void 0:P.label,O.noMipmap=this._noMipmap,this.name=Q,O}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(P,Q,O){if(P.customType){const b=L.e.Instantiate(P.customType).Parse(P,Q,O);return P.samplingMode&&b.updateSamplingMode&&b._samplingMode&&b._samplingMode!==P.samplingMode&&b.updateSamplingMode(P.samplingMode),b}if(P.isCube&&!P.isRenderTarget)return T._CubeTextureParser(P,Q,O);const b=void 0!==P.internalTextureUniqueId;if(!P.name&&!P.isRenderTarget&&!b)return null;let F;if(b){const O=Q.getEngine().getLoadedTexturesCache();for(const Q of O)if(Q.uniqueId===P.internalTextureUniqueId){F=Q;break}}const g=Q=>{if(Q&&Q._texture&&(Q._texture._cachedWrapU=null,Q._texture._cachedWrapV=null,Q._texture._cachedWrapR=null),P.samplingMode){const O=P.samplingMode;Q&&Q.samplingMode!==O&&Q.updateSamplingMode(O)}if(Q&&P.animations)for(let O=0;O<P.animations.length;O++){const b=P.animations[O],F=(0,R.b)("BABYLON.Animation");F&&Q.animations.push(F.Parse(b))}Q&&Q._texture&&(b&&!F&&Q._texture._setUniqueId(P.internalTextureUniqueId),Q._texture.label=P.internalTextureLabel)};return K.c.Parse((()=>{let b=!0;if(P.noMipmap&&(b=!1),P.mirrorPlane){const O=T._CreateMirror(P.name,P.renderTargetSize,Q,b);return O._waitingRenderList=P.renderList,O.mirrorPlane=G.c.bk(P.mirrorPlane),g(O),O}if(P.isRenderTarget){let O=null;if(P.isCube){if(Q.reflectionProbes)for(let b=0;b<Q.reflectionProbes.length;b++){const O=Q.reflectionProbes[b];if(O.name===P.name)return O.cubeTexture}}else O=T._CreateRenderTargetTexture(P.name,P.renderTargetSize,Q,b,P._creationFlags??0),O._waitingRenderList=P.renderList;return g(O),O}if(P.isVideo){const F=T._CreateVideoTexture(O+(P.url||P.name),O+(P.src||P.url),Q,b,P.invertY,P.samplingMode,P.settings||{});return g(F),F}{let m;if(P.base64String&&!F)m=T.CreateFromBase64String(P.base64String,P.base64String,Q,!b,P.invertY,P.samplingMode,(()=>{g(m)}),P._creationFlags??0,P._useSRGBBuffer??!1),m.name=P.name;else{let q;q=P.name&&(P.name.indexOf("://")>0||P.name.startsWith("data:"))?P.name:O+P.name,P.url&&(P.url.startsWith("data:")||T.UseSerializedUrlIfAny)&&(q=P.url);const R={noMipmap:!b,invertY:P.invertY,samplingMode:P.samplingMode,X:()=>{g(m)},internalTexture:F};m=new T(q,Q,R)}return m}}),P,Q)}static CreateFromBase64String(P,Q,O,b,F){let g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:T.TRILINEAR_SAMPLINGMODE;return new T("data:"+Q,O,b,F,g,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,P,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(P,Q,O){let b=arguments.length>3&&void 0!==arguments[3]&&arguments[3],F=arguments.length>4?arguments[4]:void 0,g=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],m=arguments.length>6&&void 0!==arguments[6]?arguments[6]:T.TRILINEAR_SAMPLINGMODE,q=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,R=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,X=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,C=arguments.length>10?arguments[10]:void 0,L=arguments.length>11?arguments[11]:void 0;return"data:"!==P.substring(0,5)&&(P="data:"+P),new T(P,O,F,g,m,q,R,Q,b,X,void 0,void 0,C,L)}}T.SerializeBuffers=!0,T.ForceSerializeBuffers=!1,T.OnTextureLoadErrorObservable=new g.d,T._SerializeInternalTextureUniqueId=!1,T._CubeTextureParser=(P,Q,O)=>{throw(0,X.b)("CubeTexture")},T._CreateMirror=(P,Q,O,b)=>{throw(0,X.b)("MirrorTexture")},T._CreateRenderTargetTexture=(P,Q,O,b,F)=>{throw(0,X.b)("RenderTargetTexture")},T.NEAREST_SAMPLINGMODE=1,T.NEAREST_NEAREST_MIPLINEAR=8,T.BILINEAR_SAMPLINGMODE=2,T.LINEAR_LINEAR_MIPNEAREST=11,T.TRILINEAR_SAMPLINGMODE=3,T.LINEAR_LINEAR_MIPLINEAR=3,T.NEAREST_NEAREST_MIPNEAREST=4,T.NEAREST_LINEAR_MIPNEAREST=5,T.NEAREST_LINEAR_MIPLINEAR=6,T.NEAREST_LINEAR=7,T.NEAREST_NEAREST=1,T.LINEAR_NEAREST_MIPNEAREST=9,T.LINEAR_NEAREST_MIPLINEAR=10,T.LINEAR_LINEAR=2,T.LINEAR_NEAREST=12,T.EXPLICIT_MODE=0,T.SPHERICAL_MODE=1,T.PLANAR_MODE=2,T.CUBIC_MODE=3,T.PROJECTION_MODE=4,T.SKYBOX_MODE=5,T.INVCUBIC_MODE=6,T.EQUIRECTANGULAR_MODE=7,T.FIXED_EQUIRECTANGULAR_MODE=8,T.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,T.CLAMP_ADDRESSMODE=0,T.WRAP_ADDRESSMODE=1,T.MIRROR_ADDRESSMODE=2,T.UseSerializedUrlIfAny=!1,(0,b.c)([(0,F.N)()],T.prototype,"url",void 0),(0,b.c)([(0,F.N)()],T.prototype,"uOffset",void 0),(0,b.c)([(0,F.N)()],T.prototype,"vOffset",void 0),(0,b.c)([(0,F.N)()],T.prototype,"uScale",void 0),(0,b.c)([(0,F.N)()],T.prototype,"vScale",void 0),(0,b.c)([(0,F.N)()],T.prototype,"uAng",void 0),(0,b.c)([(0,F.N)()],T.prototype,"vAng",void 0),(0,b.c)([(0,F.N)()],T.prototype,"wAng",void 0),(0,b.c)([(0,F.N)()],T.prototype,"uRotationCenter",void 0),(0,b.c)([(0,F.N)()],T.prototype,"vRotationCenter",void 0),(0,b.c)([(0,F.N)()],T.prototype,"wRotationCenter",void 0),(0,b.c)([(0,F.N)()],T.prototype,"homogeneousRotationInUVTransform",void 0),(0,b.c)([(0,F.N)()],T.prototype,"isBlocking",null),(0,R.f)("BABYLON.Texture",T),K.c._TextureParser=T.Parse},2436:(P,Q,O)=>{O.d(Q,{e:()=>b});class b{constructor(P,Q){this.width=P,this.height=Q}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let P=0|this.width;return P=397*P^this.height,P}p(P){this.width=P.width,this.height=P.height}rd(P,Q){return this.width=P,this.height=Q,this}set(P,Q){return this.rd(P,Q)}multiplyByFloats(P,Q){return new b(this.width*P,this.height*Q)}clone(){return new b(this.width,this.height)}equals(P){return!!P&&(this.width===P.width&&this.height===P.height)}get surface(){return this.width*this.height}static Zero(){return new b(0,0)}add(P){return new b(this.width+P.width,this.height+P.height)}ae(P){return new b(this.width-P.width,this.height-P.height)}scale(P){return new b(this.width*P,this.height*P)}static Lerp(P,Q,O){const F=P.width+(Q.width-P.width)*O,g=P.height+(Q.height-P.height)*O;return new b(F,g)}}}}]);