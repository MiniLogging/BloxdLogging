"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2323:(J,T,b)=>{b.d(T,{d:()=>P});var q=b(674),t=b(680),j=b(497),B=b(697),Y=b(550),C=b(644),F=(b(556),b(2295));class A{get wrapU(){return this._wrapU}set wrapU(J){this._wrapU=J}get wrapV(){return this._wrapV}set wrapV(J){this._wrapV=J}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(J){this._texture&&(this._texture.isCube=J)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(J){this._texture&&(this._texture.is3D=J)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(J){this._texture&&(this._texture.is2DArray=J)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(J){return void 0!==(null===J||void 0===J?void 0:J.shareDepth)}constructor(J){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=F.b.Zero(),this._cachedBaseSize=F.b.Zero(),this._initialSamplingMode=2,this._texture=A._IsRenderTargetWrapper(J)?J.texture:J,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(J){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(J,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var a=b(727);class P extends A{set Fj(J){this._hasAlpha!==J&&(this._hasAlpha=J,this._scene&&this._scene.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))))}get Fj(){return this._hasAlpha}set getAlphaFromRGB(J){this._getAlphaFromRGB!==J&&(this._getAlphaFromRGB=J,this._scene&&this._scene.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(J){this._coordinatesIndex!==J&&(this._coordinatesIndex=J,this._scene&&this._scene.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(J){this._coordinatesMode!==J&&(this._coordinatesMode=J,this._scene&&this._scene.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(J){this._wrapU=J}get wrapV(){return this._wrapV}set wrapV(J){this._wrapV=J}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(J){this._texture?this._texture.isCube=J:this._isCube=J}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(J){this._texture&&(this._texture.is3D=J)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(J){this._texture&&(this._texture.is2DArray=J)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(J){var T;if(this._texture){if(this._texture._gammaSpace===J)return;this._texture._gammaSpace=J}else{if(this._gammaSpace===J)return;this._gammaSpace=J}null===(T=this.va())||void 0===T||T.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(J){var T;J!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=J),null===(T=this.va())||void 0===T||T.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(J){this._texture&&(this._texture._lodGenerationOffset=J)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(J){this._texture&&(this._texture._lodGenerationScale=J)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(J){this._texture&&(this._texture._linearSpecularLOD=J)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(J){this._texture&&(this._texture._irradianceTexture=J)}get uid(){return this._uid||(this._uid=(0,C.e)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(J){this._onDisposeObserver&&this.Ki.remove(this._onDisposeObserver),this._onDisposeObserver=this.Ki.add(J)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(J){let T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=P.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Ki=new j.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,J?P._IsScene(J)?this._scene=J:this._engine=J:this._scene=Y.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=T,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return B.e.IdentityReadOnly}getReflectionTextureMatrix(){return B.e.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(J){}get canRescale(){return!1}_getFromCache(J,T,b,q,t,j){const B=this._getEngine();if(!B)return null;const Y=B._getUseSRGBBuffer(!!t,T),C=B.getLoadedTexturesCache();for(let F=0;F<C.length;F++){const B=C[F];if((void 0===t||Y===B._useSRGBBuffer)&&(void 0===q||q===B.invertY)&&B.url===J&&B.generateMipMaps===!T&&(!b||b===B.samplingMode)&&(void 0===j||j===B.isCube))return B.incrementReferences(),B}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const J=this.va();J&&J.markAllMaterialsAsDirty(1)}readPixels(){let J=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,q=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4],j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,Y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,C=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const F=this._getEngine();if(!F)return null;const A=this.getSize();let a=A.width,P=A.height;0!==T&&(a/=Math.pow(2,T),P/=Math.pow(2,T),a=Math.round(a),P=Math.round(P)),Y=Math.min(a,Y),C=Math.min(P,C);try{return this._texture.isCube?F._readTexturePixels(this._texture,Y,C,J,T,b,q,t,j,B):F._readTexturePixels(this._texture,Y,C,-1,T,b,q,t,j,B)}catch(v){return null}}_readPixelsSync(){let J=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,q=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const j=this.getSize();let B=j.width,Y=j.height;const C=this._getEngine();if(!C)return null;0!=T&&(B/=Math.pow(2,T),Y/=Math.pow(2,T),B=Math.round(B),Y=Math.round(Y));try{return this._texture.isCube?C._readTexturePixelsSync(this._texture,B,Y,J,T,b,q,t):C._readTexturePixelsSync(this._texture,B,Y,-1,T,b,q,t)}catch(F){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const J=this._scene.textures.indexOf(this);if(J>=0&&this._scene.textures.splice(J,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const J=this._parentContainer.textures.indexOf(this);J>-1&&this._parentContainer.textures.splice(J,1),this._parentContainer=null}}this.Ki.notifyObservers(this),this.Ki.clear(),this.metadata=null,super.dispose()}serialize(){let J=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!J)return null;const T=a.d.Serialize(this);return a.d.AppendSerializedAnimations(this,T),T}static WhenAllReady(J,T){let b=J.length;if(0!==b)for(let q=0;q<J.length;q++){const t=J[q];if(t.isReady())0===--b&&T();else{const J=t.onLoadObservable;J?J.addOnce((()=>{0===--b&&T()})):0===--b&&T()}}else T()}static _IsScene(J){return"Scene"===J.getClassName()}}P.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,q.e)([(0,t.M)()],P.prototype,"uniqueId",void 0),(0,q.e)([(0,t.M)()],P.prototype,"name",void 0),(0,q.e)([(0,t.M)()],P.prototype,"displayName",void 0),(0,q.e)([(0,t.M)()],P.prototype,"metadata",void 0),(0,q.e)([(0,t.M)("Fj")],P.prototype,"_hasAlpha",void 0),(0,q.e)([(0,t.M)("getAlphaFromRGB")],P.prototype,"_getAlphaFromRGB",void 0),(0,q.e)([(0,t.M)()],P.prototype,"level",void 0),(0,q.e)([(0,t.M)("coordinatesIndex")],P.prototype,"_coordinatesIndex",void 0),(0,q.e)([(0,t.M)()],P.prototype,"optimizeUVAllocation",void 0),(0,q.e)([(0,t.M)("coordinatesMode")],P.prototype,"_coordinatesMode",void 0),(0,q.e)([(0,t.M)()],P.prototype,"wrapU",null),(0,q.e)([(0,t.M)()],P.prototype,"wrapV",null),(0,q.e)([(0,t.M)()],P.prototype,"wrapR",void 0),(0,q.e)([(0,t.M)()],P.prototype,"anisotropicFilteringLevel",void 0),(0,q.e)([(0,t.M)()],P.prototype,"isCube",null),(0,q.e)([(0,t.M)()],P.prototype,"is3D",null),(0,q.e)([(0,t.M)()],P.prototype,"is2DArray",null),(0,q.e)([(0,t.M)()],P.prototype,"gammaSpace",null),(0,q.e)([(0,t.M)()],P.prototype,"invertZ",void 0),(0,q.e)([(0,t.M)()],P.prototype,"lodLevelInAlpha",void 0),(0,q.e)([(0,t.M)()],P.prototype,"lodGenerationOffset",null),(0,q.e)([(0,t.M)()],P.prototype,"lodGenerationScale",null),(0,q.e)([(0,t.M)()],P.prototype,"linearSpecularLOD",null),(0,q.e)([(0,t.D)()],P.prototype,"irradianceTexture",null),(0,q.e)([(0,t.M)()],P.prototype,"isRenderTarget",void 0)},2319:(J,T,b)=>{b.d(T,{b:()=>K});var q=b(674),t=b(680),j=b(497),B=b(697),Y=b(2323),C=b(639),F=b(533),A=b(575),a=b(634),P=b(749),v=b(563);function G(J,T){let b=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const q=T.width,t=T.height;if(J instanceof Float32Array){let T=J.byteLength/J.BYTES_PER_ELEMENT;const b=new Uint8Array(T);for(;--T>=0;){let q=J[T];q<0?q=0:q>1&&(q=1),b[T]=255*q}J=b}const j=document.createElement("canvas");j.width=q,j.height=t;const B=j.getContext("2d");if(!B)return null;const Y=B.createImageData(q,t);if(Y.data.set(J),B.putImageData(Y,0,0),b){const J=document.createElement("canvas");J.width=q,J.height=t;const T=J.getContext("2d");return T?(T.translate(0,t),T.scale(1,-1),T.drawImage(j,0,0),J.toDataURL("image/png")):null}return j.toDataURL("image/png")}function x(J){let T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const q=J.getInternalTexture();if(!q)return null;const t=J._readPixelsSync(T,b);return t?G(t,J.getSize(),q.invertY):null}async function I(J){let T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const q=J.getInternalTexture();if(!q)return null;const t=await J.readPixels(T,b);return t?G(t,J.getSize(),q.invertY):null}var u=b(830),U=b(727);class K extends Y.d{static _CreateVideoTexture(J,T,b){arguments.length>5&&void 0!==arguments[5]||K.TRILINEAR_SAMPLINGMODE;throw(0,F.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(J){this._isBlocking=J}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(J,T,b,q){let t,B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:K.TRILINEAR_SAMPLINGMODE,Y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,F=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,a=arguments.length>8&&void 0!==arguments[8]&&arguments[8],P=arguments.length>9?arguments[9]:void 0,v=arguments.length>10?arguments[10]:void 0,G=arguments.length>11?arguments[11]:void 0,x=arguments.length>12?arguments[12]:void 0,I=arguments.length>13?arguments[13]:void 0;super(T),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new j.b,this._isBlocking=!0,this.name=J||"",this.url=J;let U=!1,E=null,l=!0;"object"===typeof b&&null!==b?(t=b.noMipmap??!1,q=b.invertY??!u.c,B=b.samplingMode??K.TRILINEAR_SAMPLINGMODE,Y=b.X??null,C=b.onError??null,F=b.buffer??null,a=b.deleteBuffer??!1,P=b.format,v=b.mimeType,G=b.loaderOptions,x=b.creationFlags,U=b.useSRGBBuffer??!1,E=b.internalTexture??null,l=b.gammaSpace??l,I=b.forcedExtension??I):t=!!b,this._gammaSpace=l,this._noMipmap=t,this._invertY=void 0===q?!u.c:q,this._initialSamplingMode=B,this._buffer=F,this._deleteBuffer=a,this._mimeType=v,this._loaderOptions=G,this._creationFlags=x,this._useSRGBBuffer=U,this._forcedExtension=I,void 0!==P&&(this._format=P);const W=this.va(),p=this._getEngine();if(!p)return;p.onBeforeTextureInitObservable.notifyObservers(this);const o=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),Y&&Y(),!this.isBlocking&&W&&W.resetCachedMaterial()},S=(J,T)=>{this._loadingError=!0,this._errorObject={message:J,exception:T},C&&C(J,T),K.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!E)return this._delayedOnLoad=o,void(this._delayedOnError=S);if(this._texture=E??this._getFromCache(this.url,t,B,this._invertY,U,this.isCube),this._texture)if(this._texture.isReady)A.d.SetImmediate((()=>o()));else{const J=this._texture.onLoadedObservable.add(o);this._texture.onErrorObservable.add((T=>{var b;S(T.message,T.exception),null===(b=this._texture)||void 0===b||b.onLoadedObservable.remove(J)}))}else if(W&&W.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=o,this._delayedOnError=S;else{try{this._texture=p.createTexture(this.url,t,this._invertY,W,B,o,S,this._buffer,void 0,this._format,this._forcedExtension,v,G,x,U)}catch(H){throw S("error loading",H),H}a&&(this._buffer=null)}}updateURL(J){let T=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,b=arguments.length>2?arguments[2]:void 0,q=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(J=>J.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=J),this.url=J,this._buffer=T,this._forcedExtension=q,this.delayLoadState=4,b&&(this._delayedOnLoad=b),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const J=this.va();J&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?A.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=J.getEngine().createTexture(this.url,this._noMipmap,this._invertY,J,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(J,T,b,q){J*=this._cachedUScale,T*=this._cachedVScale,J-=this.uRotationCenter*this._cachedUScale,T-=this.vRotationCenter*this._cachedVScale,b-=this.wRotationCenter,B.n.TransformCoordinatesFromFloatsToRef(J,T,b,this._rowGenerationMatrix,q),q.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,q.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,q.z+=this.wRotationCenter}getTextureMatrix(){let J=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*J===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*J,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=B.e.Zero(),this._rowGenerationMatrix=new B.e,this._t0=B.n.Zero(),this._t1=B.n.Zero(),this._t2=B.n.Zero()),B.e.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(B.e.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,B.j.Matrix[0]),B.e.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,B.j.Matrix[1]),B.e.ScalingToRef(this._cachedUScale,this._cachedVScale,0,B.j.Matrix[2]),B.e.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,B.j.Matrix[3]),B.j.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.j.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.j.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(B.j.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Si(this._t0),this._t2.Si(this._t0),B.e.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const T=this.va();if(!T)return this._cachedTextureMatrix;const b=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&b!==this._cachedIdentity3x2&&T.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const J=this.va();if(!J)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==K.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===J.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=B.e.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=B.e.Zero());const T=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case K.PLANAR_MODE:B.e.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case K.PROJECTION_MODE:{B.e.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const T=J.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=T.updateFlag,T.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:B.e.IdentityToRef(this._cachedReflectionTextureMatrix)}return T&&J.markAllMaterialsAsDirty(1,(J=>J.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const J={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return U.d.Clone((()=>new K(this._texture?this._texture.url:null,this.va(),J)),this)}serialize(){var J;const T=this.name;K.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const b=super.serialize(K._SerializeInternalTextureUniqueId);if(!b)return null;if(K.SerializeBuffers||K.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))b.base64String=this._buffer,b.name=b.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const J=this.mimeType||"image/png";b.base64String=`data:${J};base64,${(0,v.h)(this._buffer)}`}else(K.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(b.base64String=!this._engine||this._engine._features.supportSyncTextureRead?x(this):I(this));var q;(b.invertY=this._invertY,b.samplingMode=this.samplingMode,b._creationFlags=this._creationFlags,b._useSRGBBuffer=this._useSRGBBuffer,K._SerializeInternalTextureUniqueId)&&(b.internalTextureUniqueId=null===(q=this._texture)||void 0===q?void 0:q.uniqueId);return b.internalTextureLabel=null===(J=this._texture)||void 0===J?void 0:J.label,b.noMipmap=this._noMipmap,this.name=T,b}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(J,T,b){if(J.customType){const q=a.b.Instantiate(J.customType).Parse(J,T,b);return J.samplingMode&&q.updateSamplingMode&&q._samplingMode&&q._samplingMode!==J.samplingMode&&q.updateSamplingMode(J.samplingMode),q}if(J.isCube&&!J.isRenderTarget)return K._CubeTextureParser(J,T,b);const q=void 0!==J.internalTextureUniqueId;if(!J.name&&!J.isRenderTarget&&!q)return null;let t;if(q){const b=T.getEngine().getLoadedTexturesCache();for(const T of b)if(T.uniqueId===J.internalTextureUniqueId){t=T;break}}const j=T=>{if(T&&T._texture&&(T._texture._cachedWrapU=null,T._texture._cachedWrapV=null,T._texture._cachedWrapR=null),J.samplingMode){const b=J.samplingMode;T&&T.samplingMode!==b&&T.updateSamplingMode(b)}if(T&&J.animations)for(let b=0;b<J.animations.length;b++){const q=J.animations[b],t=(0,C.c)("BABYLON.Animation");t&&T.animations.push(t.Parse(q))}T&&T._texture&&(q&&!t&&T._texture._setUniqueId(J.internalTextureUniqueId),T._texture.label=J.internalTextureLabel)};return U.d.Parse((()=>{let q=!0;if(J.noMipmap&&(q=!1),J.mirrorPlane){const b=K._CreateMirror(J.name,J.renderTargetSize,T,q);return b._waitingRenderList=J.renderList,b.mirrorPlane=P.e.ni(J.mirrorPlane),j(b),b}if(J.isRenderTarget){let b=null;if(J.isCube){if(T.reflectionProbes)for(let q=0;q<T.reflectionProbes.length;q++){const b=T.reflectionProbes[q];if(b.name===J.name)return b.cubeTexture}}else b=K._CreateRenderTargetTexture(J.name,J.renderTargetSize,T,q,J._creationFlags??0),b._waitingRenderList=J.renderList;return j(b),b}if(J.isVideo){const t=K._CreateVideoTexture(b+(J.url||J.name),b+(J.src||J.url),T,q,J.invertY,J.samplingMode,J.settings||{});return j(t),t}{let B;if(J.base64String&&!t)B=K.CreateFromBase64String(J.base64String,J.base64String,T,!q,J.invertY,J.samplingMode,(()=>{j(B)}),J._creationFlags??0,J._useSRGBBuffer??!1),B.name=J.name;else{let Y;Y=J.name&&(J.name.indexOf("://")>0||J.name.startsWith("data:"))?J.name:b+J.name,J.url&&(J.url.startsWith("data:")||K.UseSerializedUrlIfAny)&&(Y=J.url);const C={noMipmap:!q,invertY:J.invertY,samplingMode:J.samplingMode,X:()=>{j(B)},internalTexture:t};B=new K(Y,T,C)}return B}}),J,T)}static CreateFromBase64String(J,T,b,q,t){let j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:K.TRILINEAR_SAMPLINGMODE;return new K("data:"+T,b,q,t,j,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,J,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(J,T,b){let q=arguments.length>3&&void 0!==arguments[3]&&arguments[3],t=arguments.length>4?arguments[4]:void 0,j=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],B=arguments.length>6&&void 0!==arguments[6]?arguments[6]:K.TRILINEAR_SAMPLINGMODE,Y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,C=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,F=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,A=arguments.length>10?arguments[10]:void 0,a=arguments.length>11?arguments[11]:void 0;return"data:"!==J.substring(0,5)&&(J="data:"+J),new K(J,b,t,j,B,Y,C,T,q,F,void 0,void 0,A,a)}}K.SerializeBuffers=!0,K.ForceSerializeBuffers=!1,K.OnTextureLoadErrorObservable=new j.b,K._SerializeInternalTextureUniqueId=!1,K._CubeTextureParser=(J,T,b)=>{throw(0,F.e)("CubeTexture")},K._CreateMirror=(J,T,b,q)=>{throw(0,F.e)("MirrorTexture")},K._CreateRenderTargetTexture=(J,T,b,q,t)=>{throw(0,F.e)("RenderTargetTexture")},K.NEAREST_SAMPLINGMODE=1,K.NEAREST_NEAREST_MIPLINEAR=8,K.BILINEAR_SAMPLINGMODE=2,K.LINEAR_LINEAR_MIPNEAREST=11,K.TRILINEAR_SAMPLINGMODE=3,K.LINEAR_LINEAR_MIPLINEAR=3,K.NEAREST_NEAREST_MIPNEAREST=4,K.NEAREST_LINEAR_MIPNEAREST=5,K.NEAREST_LINEAR_MIPLINEAR=6,K.NEAREST_LINEAR=7,K.NEAREST_NEAREST=1,K.LINEAR_NEAREST_MIPNEAREST=9,K.LINEAR_NEAREST_MIPLINEAR=10,K.LINEAR_LINEAR=2,K.LINEAR_NEAREST=12,K.EXPLICIT_MODE=0,K.SPHERICAL_MODE=1,K.PLANAR_MODE=2,K.CUBIC_MODE=3,K.PROJECTION_MODE=4,K.SKYBOX_MODE=5,K.INVCUBIC_MODE=6,K.EQUIRECTANGULAR_MODE=7,K.FIXED_EQUIRECTANGULAR_MODE=8,K.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,K.CLAMP_ADDRESSMODE=0,K.WRAP_ADDRESSMODE=1,K.MIRROR_ADDRESSMODE=2,K.UseSerializedUrlIfAny=!1,(0,q.e)([(0,t.M)()],K.prototype,"url",void 0),(0,q.e)([(0,t.M)()],K.prototype,"uOffset",void 0),(0,q.e)([(0,t.M)()],K.prototype,"vOffset",void 0),(0,q.e)([(0,t.M)()],K.prototype,"uScale",void 0),(0,q.e)([(0,t.M)()],K.prototype,"vScale",void 0),(0,q.e)([(0,t.M)()],K.prototype,"uAng",void 0),(0,q.e)([(0,t.M)()],K.prototype,"vAng",void 0),(0,q.e)([(0,t.M)()],K.prototype,"wAng",void 0),(0,q.e)([(0,t.M)()],K.prototype,"uRotationCenter",void 0),(0,q.e)([(0,t.M)()],K.prototype,"vRotationCenter",void 0),(0,q.e)([(0,t.M)()],K.prototype,"wRotationCenter",void 0),(0,q.e)([(0,t.M)()],K.prototype,"homogeneousRotationInUVTransform",void 0),(0,q.e)([(0,t.M)()],K.prototype,"isBlocking",null),(0,C.g)("BABYLON.Texture",K),U.d._TextureParser=K.Parse},2295:(J,T,b)=>{b.d(T,{b:()=>q});class q{constructor(J,T){this.width=J,this.height=T}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let J=0|this.width;return J=397*J^this.height,J}p(J){this.width=J.width,this.height=J.height}hi(J,T){return this.width=J,this.height=T,this}set(J,T){return this.hi(J,T)}multiplyByFloats(J,T){return new q(this.width*J,this.height*T)}clone(){return new q(this.width,this.height)}equals(J){return!!J&&(this.width===J.width&&this.height===J.height)}get surface(){return this.width*this.height}static Zero(){return new q(0,0)}add(J){return new q(this.width+J.width,this.height+J.height)}Jg(J){return new q(this.width-J.width,this.height-J.height)}scale(J){return new q(this.width*J,this.height*J)}static Lerp(J,T,b){const t=J.width+(T.width-J.width)*b,j=J.height+(T.height-J.height)*b;return new q(t,j)}}}}]);