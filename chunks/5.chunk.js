"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2374:(U,M,b)=>{b.d(M,{c:()=>Z});var a=b(645),A=b(652),H=b(474),W=b(670),y=b(524),O=b(614),e=(b(531),b(2345));class x{get wrapU(){return this._wrapU}set wrapU(U){this._wrapU=U}get wrapV(){return this._wrapV}set wrapV(U){this._wrapV=U}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(U){this._texture&&(this._texture.isCube=U)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(U){this._texture&&(this._texture.is3D=U)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(U){this._texture&&(this._texture.is2DArray=U)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(U){return void 0!==(null===U||void 0===U?void 0:U.shareDepth)}constructor(U){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=e.b.Zero(),this._cachedBaseSize=e.b.Zero(),this._initialSamplingMode=2,this._texture=x._IsRenderTargetWrapper(U)?U.texture:U,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(U){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(U,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var P=b(698);class Z extends x{set Ei(U){this._hasAlpha!==U&&(this._hasAlpha=U,this._scene&&this._scene.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))))}get Ei(){return this._hasAlpha}set getAlphaFromRGB(U){this._getAlphaFromRGB!==U&&(this._getAlphaFromRGB=U,this._scene&&this._scene.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(U){this._coordinatesIndex!==U&&(this._coordinatesIndex=U,this._scene&&this._scene.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(U){this._coordinatesMode!==U&&(this._coordinatesMode=U,this._scene&&this._scene.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(U){this._wrapU=U}get wrapV(){return this._wrapV}set wrapV(U){this._wrapV=U}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(U){this._texture?this._texture.isCube=U:this._isCube=U}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(U){this._texture&&(this._texture.is3D=U)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(U){this._texture&&(this._texture.is2DArray=U)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(U){var M;if(this._texture){if(this._texture._gammaSpace===U)return;this._texture._gammaSpace=U}else{if(this._gammaSpace===U)return;this._gammaSpace=U}null===(M=this.va())||void 0===M||M.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(U){var M;U!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=U),null===(M=this.va())||void 0===M||M.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(U){this._texture&&(this._texture._lodGenerationOffset=U)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(U){this._texture&&(this._texture._lodGenerationScale=U)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(U){this._texture&&(this._texture._linearSpecularLOD=U)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(U){this._texture&&(this._texture._irradianceTexture=U)}get uid(){return this._uid||(this._uid=(0,O.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(U){this._onDisposeObserver&&this.rk.remove(this._onDisposeObserver),this._onDisposeObserver=this.rk.add(U)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(U){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=Z.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.rk=new H.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,U?Z._IsScene(U)?this._scene=U:this._engine=U:this._scene=y.d.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=M,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return W.b.IdentityReadOnly}getReflectionTextureMatrix(){return W.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(U){}get canRescale(){return!1}_getFromCache(U,M,b,a,A,H){const W=this._getEngine();if(!W)return null;const y=W._getUseSRGBBuffer(!!A,M),O=W.getLoadedTexturesCache();for(let e=0;e<O.length;e++){const W=O[e];if((void 0===A||y===W._useSRGBBuffer)&&(void 0===a||a===W.invertY)&&W.url===U&&W.generateMipMaps===!M&&(!b||b===W.samplingMode)&&(void 0===H||H===W.isCube))return W.incrementReferences(),W}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const U=this.va();U&&U.markAllMaterialsAsDirty(1)}readPixels(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],A=arguments.length>4&&void 0!==arguments[4]&&arguments[4],H=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,W=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,O=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const e=this._getEngine();if(!e)return null;const x=this.getSize();let P=x.width,Z=x.height;0!==M&&(P/=Math.pow(2,M),Z/=Math.pow(2,M),P=Math.round(P),Z=Math.round(Z)),y=Math.min(P,y),O=Math.min(Z,O);try{return this._texture.isCube?e._readTexturePixels(this._texture,y,O,U,M,b,a,A,H,W):e._readTexturePixels(this._texture,y,O,-1,M,b,a,A,H,W)}catch(C){return null}}_readPixelsSync(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],A=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const H=this.getSize();let W=H.width,y=H.height;const O=this._getEngine();if(!O)return null;0!=M&&(W/=Math.pow(2,M),y/=Math.pow(2,M),W=Math.round(W),y=Math.round(y));try{return this._texture.isCube?O._readTexturePixelsSync(this._texture,W,y,U,M,b,a,A):O._readTexturePixelsSync(this._texture,W,y,-1,M,b,a,A)}catch(e){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const U=this._scene.textures.indexOf(this);if(U>=0&&this._scene.textures.splice(U,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const U=this._parentContainer.textures.indexOf(this);U>-1&&this._parentContainer.textures.splice(U,1),this._parentContainer=null}}this.rk.notifyObservers(this),this.rk.clear(),this.metadata=null,super.dispose()}serialize(){let U=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!U)return null;const M=P.d.Serialize(this);return P.d.AppendSerializedAnimations(this,M),M}static WhenAllReady(U,M){let b=U.length;if(0!==b)for(let a=0;a<U.length;a++){const A=U[a];if(A.isReady())0===--b&&M();else{const U=A.onLoadObservable;U?U.addOnce((()=>{0===--b&&M()})):0===--b&&M()}}else M()}static _IsScene(U){return"Scene"===U.getClassName()}}Z.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,a.c)([(0,A.J)()],Z.prototype,"uniqueId",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"name",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"displayName",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"metadata",void 0),(0,a.c)([(0,A.J)("Ei")],Z.prototype,"_hasAlpha",void 0),(0,a.c)([(0,A.J)("getAlphaFromRGB")],Z.prototype,"_getAlphaFromRGB",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"level",void 0),(0,a.c)([(0,A.J)("coordinatesIndex")],Z.prototype,"_coordinatesIndex",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"optimizeUVAllocation",void 0),(0,a.c)([(0,A.J)("coordinatesMode")],Z.prototype,"_coordinatesMode",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"wrapU",null),(0,a.c)([(0,A.J)()],Z.prototype,"wrapV",null),(0,a.c)([(0,A.J)()],Z.prototype,"wrapR",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"anisotropicFilteringLevel",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"isCube",null),(0,a.c)([(0,A.J)()],Z.prototype,"is3D",null),(0,a.c)([(0,A.J)()],Z.prototype,"is2DArray",null),(0,a.c)([(0,A.J)()],Z.prototype,"gammaSpace",null),(0,a.c)([(0,A.J)()],Z.prototype,"invertZ",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"lodLevelInAlpha",void 0),(0,a.c)([(0,A.J)()],Z.prototype,"lodGenerationOffset",null),(0,a.c)([(0,A.J)()],Z.prototype,"lodGenerationScale",null),(0,a.c)([(0,A.J)()],Z.prototype,"linearSpecularLOD",null),(0,a.c)([(0,A.A)()],Z.prototype,"irradianceTexture",null),(0,a.c)([(0,A.J)()],Z.prototype,"isRenderTarget",void 0)},2371:(U,M,b)=>{b.d(M,{e:()=>L});var a=b(645),A=b(652),H=b(474),W=b(670),y=b(2374),O=b(609),e=b(509),x=b(557),P=b(604),Z=b(723),C=b(543);function r(U,M){let b=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=M.width,A=M.height;if(U instanceof Float32Array){let M=U.byteLength/U.BYTES_PER_ELEMENT;const b=new Uint8Array(M);for(;--M>=0;){let a=U[M];a<0?a=0:a>1&&(a=1),b[M]=255*a}U=b}const H=document.createElement("canvas");H.width=a,H.height=A;const W=H.getContext("2d");if(!W)return null;const y=W.createImageData(a,A);if(y.data.set(U),W.putImageData(y,0,0),b){const U=document.createElement("canvas");U.width=a,U.height=A;const M=U.getContext("2d");return M?(M.translate(0,A),M.scale(1,-1),M.drawImage(H,0,0),U.toDataURL("image/png")):null}return H.toDataURL("image/png")}function B(U){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=U.getInternalTexture();if(!a)return null;const A=U._readPixelsSync(M,b);return A?r(A,U.getSize(),a.invertY):null}async function J(U){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=U.getInternalTexture();if(!a)return null;const A=await U.readPixels(M,b);return A?r(A,U.getSize(),a.invertY):null}var F=b(784),f=b(698);class L extends y.c{static _CreateVideoTexture(U,M,b){arguments.length>5&&void 0!==arguments[5]||L.TRILINEAR_SAMPLINGMODE;throw(0,e.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(U){this._isBlocking=U}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(U,M,b,a){let A,W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:L.TRILINEAR_SAMPLINGMODE,y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,O=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,e=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,P=arguments.length>8&&void 0!==arguments[8]&&arguments[8],Z=arguments.length>9?arguments[9]:void 0,C=arguments.length>10?arguments[10]:void 0,r=arguments.length>11?arguments[11]:void 0,B=arguments.length>12?arguments[12]:void 0,J=arguments.length>13?arguments[13]:void 0;super(M),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new H.e,this._isBlocking=!0,this.name=U||"",this.url=U;let f=!1,z=null,o=!0;"object"===typeof b&&null!==b?(A=b.noMipmap??!1,a=b.invertY??!F.c,W=b.samplingMode??L.TRILINEAR_SAMPLINGMODE,y=b.X??null,O=b.onError??null,e=b.buffer??null,P=b.deleteBuffer??!1,Z=b.format,C=b.mimeType,r=b.loaderOptions,B=b.creationFlags,f=b.useSRGBBuffer??!1,z=b.internalTexture??null,o=b.gammaSpace??o,J=b.forcedExtension??J):A=!!b,this._gammaSpace=o,this._noMipmap=A,this._invertY=void 0===a?!F.c:a,this._initialSamplingMode=W,this._buffer=e,this._deleteBuffer=P,this._mimeType=C,this._loaderOptions=r,this._creationFlags=B,this._useSRGBBuffer=f,this._forcedExtension=J,void 0!==Z&&(this._format=Z);const S=this.va(),h=this._getEngine();if(!h)return;h.onBeforeTextureInitObservable.notifyObservers(this);const i=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),y&&y(),!this.isBlocking&&S&&S.resetCachedMaterial()},Y=(U,M)=>{this._loadingError=!0,this._errorObject={message:U,exception:M},O&&O(U,M),L.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!z)return this._delayedOnLoad=i,void(this._delayedOnError=Y);if(this._texture=z??this._getFromCache(this.url,A,W,this._invertY,f,this.isCube),this._texture)if(this._texture.isReady)x.d.SetImmediate((()=>i()));else{const U=this._texture.onLoadedObservable.add(i);this._texture.onErrorObservable.add((M=>{var b;Y(M.message,M.exception),null===(b=this._texture)||void 0===b||b.onLoadedObservable.remove(U)}))}else if(S&&S.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=i,this._delayedOnError=Y;else{try{this._texture=h.createTexture(this.url,A,this._invertY,S,W,i,Y,this._buffer,void 0,this._format,this._forcedExtension,C,r,B,f)}catch(d){throw Y("error loading",d),d}P&&(this._buffer=null)}}updateURL(U){let M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,b=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(U=>U.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=U),this.url=U,this._buffer=M,this._forcedExtension=a,this.delayLoadState=4,b&&(this._delayedOnLoad=b),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const U=this.va();U&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?x.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=U.getEngine().createTexture(this.url,this._noMipmap,this._invertY,U,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(U,M,b,a){U*=this._cachedUScale,M*=this._cachedVScale,U-=this.uRotationCenter*this._cachedUScale,M-=this.vRotationCenter*this._cachedVScale,b-=this.wRotationCenter,W.l.TransformCoordinatesFromFloatsToRef(U,M,b,this._rowGenerationMatrix,a),a.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,a.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,a.z+=this.wRotationCenter}getTextureMatrix(){let U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*U===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*U,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=W.b.Zero(),this._rowGenerationMatrix=new W.b,this._t0=W.l.Zero(),this._t1=W.l.Zero(),this._t2=W.l.Zero()),W.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(W.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,W.g.Matrix[0]),W.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,W.g.Matrix[1]),W.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,W.g.Matrix[2]),W.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,W.g.Matrix[3]),W.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(W.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.nk(this._t0),this._t2.nk(this._t0),W.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const M=this.va();if(!M)return this._cachedTextureMatrix;const b=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&b!==this._cachedIdentity3x2&&M.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const U=this.va();if(!U)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==L.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===U.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=W.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=W.b.Zero());const M=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case L.PLANAR_MODE:W.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case L.PROJECTION_MODE:{W.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const M=U.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=M.updateFlag,M.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:W.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return M&&U.markAllMaterialsAsDirty(1,(U=>U.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const U={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return f.d.Clone((()=>new L(this._texture?this._texture.url:null,this.va(),U)),this)}serialize(){var U;const M=this.name;L.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const b=super.serialize(L._SerializeInternalTextureUniqueId);if(!b)return null;if(L.SerializeBuffers||L.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))b.base64String=this._buffer,b.name=b.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const U=this.mimeType||"image/png";b.base64String=`data:${U};base64,${(0,C.m)(this._buffer)}`}else(L.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(b.base64String=!this._engine||this._engine._features.supportSyncTextureRead?B(this):J(this));var a;(b.invertY=this._invertY,b.samplingMode=this.samplingMode,b._creationFlags=this._creationFlags,b._useSRGBBuffer=this._useSRGBBuffer,L._SerializeInternalTextureUniqueId)&&(b.internalTextureUniqueId=null===(a=this._texture)||void 0===a?void 0:a.uniqueId);return b.internalTextureLabel=null===(U=this._texture)||void 0===U?void 0:U.label,b.noMipmap=this._noMipmap,this.name=M,b}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(U,M,b){if(U.customType){const a=P.b.Instantiate(U.customType).Parse(U,M,b);return U.samplingMode&&a.updateSamplingMode&&a._samplingMode&&a._samplingMode!==U.samplingMode&&a.updateSamplingMode(U.samplingMode),a}if(U.isCube&&!U.isRenderTarget)return L._CubeTextureParser(U,M,b);const a=void 0!==U.internalTextureUniqueId;if(!U.name&&!U.isRenderTarget&&!a)return null;let A;if(a){const b=M.getEngine().getLoadedTexturesCache();for(const M of b)if(M.uniqueId===U.internalTextureUniqueId){A=M;break}}const H=M=>{if(M&&M._texture&&(M._texture._cachedWrapU=null,M._texture._cachedWrapV=null,M._texture._cachedWrapR=null),U.samplingMode){const b=U.samplingMode;M&&M.samplingMode!==b&&M.updateSamplingMode(b)}if(M&&U.animations)for(let b=0;b<U.animations.length;b++){const a=U.animations[b],A=(0,O.e)("BABYLON.Animation");A&&M.animations.push(A.Parse(a))}M&&M._texture&&(a&&!A&&M._texture._setUniqueId(U.internalTextureUniqueId),M._texture.label=U.internalTextureLabel)};return f.d.Parse((()=>{let a=!0;if(U.noMipmap&&(a=!1),U.mirrorPlane){const b=L._CreateMirror(U.name,U.renderTargetSize,M,a);return b._waitingRenderList=U.renderList,b.mirrorPlane=Z.b.jk(U.mirrorPlane),H(b),b}if(U.isRenderTarget){let b=null;if(U.isCube){if(M.reflectionProbes)for(let a=0;a<M.reflectionProbes.length;a++){const b=M.reflectionProbes[a];if(b.name===U.name)return b.cubeTexture}}else b=L._CreateRenderTargetTexture(U.name,U.renderTargetSize,M,a,U._creationFlags??0),b._waitingRenderList=U.renderList;return H(b),b}if(U.isVideo){const A=L._CreateVideoTexture(b+(U.url||U.name),b+(U.src||U.url),M,a,U.invertY,U.samplingMode,U.settings||{});return H(A),A}{let W;if(U.base64String&&!A)W=L.CreateFromBase64String(U.base64String,U.base64String,M,!a,U.invertY,U.samplingMode,(()=>{H(W)}),U._creationFlags??0,U._useSRGBBuffer??!1),W.name=U.name;else{let y;y=U.name&&(U.name.indexOf("://")>0||U.name.startsWith("data:"))?U.name:b+U.name,U.url&&(U.url.startsWith("data:")||L.UseSerializedUrlIfAny)&&(y=U.url);const O={noMipmap:!a,invertY:U.invertY,samplingMode:U.samplingMode,X:()=>{H(W)},internalTexture:A};W=new L(y,M,O)}return W}}),U,M)}static CreateFromBase64String(U,M,b,a,A){let H=arguments.length>5&&void 0!==arguments[5]?arguments[5]:L.TRILINEAR_SAMPLINGMODE;return new L("data:"+M,b,a,A,H,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,U,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(U,M,b){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],A=arguments.length>4?arguments[4]:void 0,H=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],W=arguments.length>6&&void 0!==arguments[6]?arguments[6]:L.TRILINEAR_SAMPLINGMODE,y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,O=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,e=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,x=arguments.length>10?arguments[10]:void 0,P=arguments.length>11?arguments[11]:void 0;return"data:"!==U.substring(0,5)&&(U="data:"+U),new L(U,b,A,H,W,y,O,M,a,e,void 0,void 0,x,P)}}L.SerializeBuffers=!0,L.ForceSerializeBuffers=!1,L.OnTextureLoadErrorObservable=new H.e,L._SerializeInternalTextureUniqueId=!1,L._CubeTextureParser=(U,M,b)=>{throw(0,e.c)("CubeTexture")},L._CreateMirror=(U,M,b,a)=>{throw(0,e.c)("MirrorTexture")},L._CreateRenderTargetTexture=(U,M,b,a,A)=>{throw(0,e.c)("RenderTargetTexture")},L.NEAREST_SAMPLINGMODE=1,L.NEAREST_NEAREST_MIPLINEAR=8,L.BILINEAR_SAMPLINGMODE=2,L.LINEAR_LINEAR_MIPNEAREST=11,L.TRILINEAR_SAMPLINGMODE=3,L.LINEAR_LINEAR_MIPLINEAR=3,L.NEAREST_NEAREST_MIPNEAREST=4,L.NEAREST_LINEAR_MIPNEAREST=5,L.NEAREST_LINEAR_MIPLINEAR=6,L.NEAREST_LINEAR=7,L.NEAREST_NEAREST=1,L.LINEAR_NEAREST_MIPNEAREST=9,L.LINEAR_NEAREST_MIPLINEAR=10,L.LINEAR_LINEAR=2,L.LINEAR_NEAREST=12,L.EXPLICIT_MODE=0,L.SPHERICAL_MODE=1,L.PLANAR_MODE=2,L.CUBIC_MODE=3,L.PROJECTION_MODE=4,L.SKYBOX_MODE=5,L.INVCUBIC_MODE=6,L.EQUIRECTANGULAR_MODE=7,L.FIXED_EQUIRECTANGULAR_MODE=8,L.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,L.CLAMP_ADDRESSMODE=0,L.WRAP_ADDRESSMODE=1,L.MIRROR_ADDRESSMODE=2,L.UseSerializedUrlIfAny=!1,(0,a.c)([(0,A.J)()],L.prototype,"url",void 0),(0,a.c)([(0,A.J)()],L.prototype,"uOffset",void 0),(0,a.c)([(0,A.J)()],L.prototype,"vOffset",void 0),(0,a.c)([(0,A.J)()],L.prototype,"uScale",void 0),(0,a.c)([(0,A.J)()],L.prototype,"vScale",void 0),(0,a.c)([(0,A.J)()],L.prototype,"uAng",void 0),(0,a.c)([(0,A.J)()],L.prototype,"vAng",void 0),(0,a.c)([(0,A.J)()],L.prototype,"wAng",void 0),(0,a.c)([(0,A.J)()],L.prototype,"uRotationCenter",void 0),(0,a.c)([(0,A.J)()],L.prototype,"vRotationCenter",void 0),(0,a.c)([(0,A.J)()],L.prototype,"wRotationCenter",void 0),(0,a.c)([(0,A.J)()],L.prototype,"homogeneousRotationInUVTransform",void 0),(0,a.c)([(0,A.J)()],L.prototype,"isBlocking",null),(0,O.i)("BABYLON.Texture",L),f.d._TextureParser=L.Parse},2345:(U,M,b)=>{b.d(M,{b:()=>a});class a{constructor(U,M){this.width=U,this.height=M}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let U=0|this.width;return U=397*U^this.height,U}p(U){this.width=U.width,this.height=U.height}vd(U,M){return this.width=U,this.height=M,this}set(U,M){return this.vd(U,M)}multiplyByFloats(U,M){return new a(this.width*U,this.height*M)}clone(){return new a(this.width,this.height)}equals(U){return!!U&&(this.width===U.width&&this.height===U.height)}get surface(){return this.width*this.height}static Zero(){return new a(0,0)}add(U){return new a(this.width+U.width,this.height+U.height)}je(U){return new a(this.width-U.width,this.height-U.height)}scale(U){return new a(this.width*U,this.height*U)}static Lerp(U,M,b){const A=U.width+(M.width-U.width)*b,H=U.height+(M.height-U.height)*b;return new a(A,H)}}}}]);