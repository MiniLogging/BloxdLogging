"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2288:(A,X,s)=>{s.d(X,{b:()=>c});var N=s(657),f=s(666),E=s(454),g=s(678),K=s(503),r=s(624),i=(s(508),s(2257));class Y{get wrapU(){return this._wrapU}set wrapU(A){this._wrapU=A}get wrapV(){return this._wrapV}set wrapV(A){this._wrapV=A}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(A){this._texture&&(this._texture.isCube=A)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(A){this._texture&&(this._texture.is3D=A)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(A){this._texture&&(this._texture.is2DArray=A)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(A){return void 0!==(null===A||void 0===A?void 0:A.shareDepth)}constructor(A){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=i.e.Zero(),this._cachedBaseSize=i.e.Zero(),this._initialSamplingMode=2,this._texture=Y._IsRenderTargetWrapper(A)?A.texture:A,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(A){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(A,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var v=s(707);class c extends Y{set Ej(A){this._hasAlpha!==A&&(this._hasAlpha=A,this._scene&&this._scene.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))))}get Ej(){return this._hasAlpha}set getAlphaFromRGB(A){this._getAlphaFromRGB!==A&&(this._getAlphaFromRGB=A,this._scene&&this._scene.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(A){this._coordinatesIndex!==A&&(this._coordinatesIndex=A,this._scene&&this._scene.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(A){this._coordinatesMode!==A&&(this._coordinatesMode=A,this._scene&&this._scene.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(A){this._wrapU=A}get wrapV(){return this._wrapV}set wrapV(A){this._wrapV=A}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(A){this._texture?this._texture.isCube=A:this._isCube=A}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(A){this._texture&&(this._texture.is3D=A)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(A){this._texture&&(this._texture.is2DArray=A)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(A){var X;if(this._texture){if(this._texture._gammaSpace===A)return;this._texture._gammaSpace=A}else{if(this._gammaSpace===A)return;this._gammaSpace=A}null===(X=this.va())||void 0===X||X.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(A){var X;A!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=A),null===(X=this.va())||void 0===X||X.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(A){this._texture&&(this._texture._lodGenerationOffset=A)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(A){this._texture&&(this._texture._lodGenerationScale=A)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(A){this._texture&&(this._texture._linearSpecularLOD=A)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(A){this._texture&&(this._texture._irradianceTexture=A)}get uid(){return this._uid||(this._uid=(0,r.c)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(A){this._onDisposeObserver&&this.Ji.remove(this._onDisposeObserver),this._onDisposeObserver=this.Ji.add(A)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(A){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Ji=new E.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,A?c._IsScene(A)?this._scene=A:this._engine=A:this._scene=K.b.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=X,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return g.c.IdentityReadOnly}getReflectionTextureMatrix(){return g.c.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(A){}get canRescale(){return!1}_getFromCache(A,X,s,N,f,E){const g=this._getEngine();if(!g)return null;const K=g._getUseSRGBBuffer(!!f,X),r=g.getLoadedTexturesCache();for(let i=0;i<r.length;i++){const g=r[i];if((void 0===f||K===g._useSRGBBuffer)&&(void 0===N||N===g.invertY)&&g.url===A&&g.generateMipMaps===!X&&(!s||s===g.samplingMode)&&(void 0===E||E===g.isCube))return g.incrementReferences(),g}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const A=this.va();A&&A.markAllMaterialsAsDirty(1)}readPixels(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,N=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],f=arguments.length>4&&void 0!==arguments[4]&&arguments[4],E=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,K=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const i=this._getEngine();if(!i)return null;const Y=this.getSize();let v=Y.width,c=Y.height;0!==X&&(v/=Math.pow(2,X),c/=Math.pow(2,X),v=Math.round(v),c=Math.round(c)),K=Math.min(v,K),r=Math.min(c,r);try{return this._texture.isCube?i._readTexturePixels(this._texture,K,r,A,X,s,N,f,E,g):i._readTexturePixels(this._texture,K,r,-1,X,s,N,f,E,g)}catch(M){return null}}_readPixelsSync(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,N=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],f=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const E=this.getSize();let g=E.width,K=E.height;const r=this._getEngine();if(!r)return null;0!=X&&(g/=Math.pow(2,X),K/=Math.pow(2,X),g=Math.round(g),K=Math.round(K));try{return this._texture.isCube?r._readTexturePixelsSync(this._texture,g,K,A,X,s,N,f):r._readTexturePixelsSync(this._texture,g,K,-1,X,s,N,f)}catch(i){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const A=this._scene.textures.indexOf(this);if(A>=0&&this._scene.textures.splice(A,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const A=this._parentContainer.textures.indexOf(this);A>-1&&this._parentContainer.textures.splice(A,1),this._parentContainer=null}}this.Ji.notifyObservers(this),this.Ji.clear(),this.metadata=null,super.dispose()}serialize(){let A=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!A)return null;const X=v.c.Serialize(this);return v.c.AppendSerializedAnimations(this,X),X}static WhenAllReady(A,X){let s=A.length;if(0!==s)for(let N=0;N<A.length;N++){const f=A[N];if(f.isReady())0===--s&&X();else{const A=f.onLoadObservable;A?A.addOnce((()=>{0===--s&&X()})):0===--s&&X()}}else X()}static _IsScene(A){return"Scene"===A.getClassName()}}c.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,N.e)([(0,f.M)()],c.prototype,"uniqueId",void 0),(0,N.e)([(0,f.M)()],c.prototype,"name",void 0),(0,N.e)([(0,f.M)()],c.prototype,"displayName",void 0),(0,N.e)([(0,f.M)()],c.prototype,"metadata",void 0),(0,N.e)([(0,f.M)("Ej")],c.prototype,"_hasAlpha",void 0),(0,N.e)([(0,f.M)("getAlphaFromRGB")],c.prototype,"_getAlphaFromRGB",void 0),(0,N.e)([(0,f.M)()],c.prototype,"level",void 0),(0,N.e)([(0,f.M)("coordinatesIndex")],c.prototype,"_coordinatesIndex",void 0),(0,N.e)([(0,f.M)()],c.prototype,"optimizeUVAllocation",void 0),(0,N.e)([(0,f.M)("coordinatesMode")],c.prototype,"_coordinatesMode",void 0),(0,N.e)([(0,f.M)()],c.prototype,"wrapU",null),(0,N.e)([(0,f.M)()],c.prototype,"wrapV",null),(0,N.e)([(0,f.M)()],c.prototype,"wrapR",void 0),(0,N.e)([(0,f.M)()],c.prototype,"anisotropicFilteringLevel",void 0),(0,N.e)([(0,f.M)()],c.prototype,"isCube",null),(0,N.e)([(0,f.M)()],c.prototype,"is3D",null),(0,N.e)([(0,f.M)()],c.prototype,"is2DArray",null),(0,N.e)([(0,f.M)()],c.prototype,"gammaSpace",null),(0,N.e)([(0,f.M)()],c.prototype,"invertZ",void 0),(0,N.e)([(0,f.M)()],c.prototype,"lodLevelInAlpha",void 0),(0,N.e)([(0,f.M)()],c.prototype,"lodGenerationOffset",null),(0,N.e)([(0,f.M)()],c.prototype,"lodGenerationScale",null),(0,N.e)([(0,f.M)()],c.prototype,"linearSpecularLOD",null),(0,N.e)([(0,f.G)()],c.prototype,"irradianceTexture",null),(0,N.e)([(0,f.M)()],c.prototype,"isRenderTarget",void 0)},2281:(A,X,s)=>{s.d(X,{d:()=>J});var N=s(657),f=s(666),E=s(454),g=s(678),K=s(2288),r=s(616),i=s(495),Y=s(542),v=s(607),c=s(725),M=s(519);function d(A,X){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const N=X.width,f=X.height;if(A instanceof Float32Array){let X=A.byteLength/A.BYTES_PER_ELEMENT;const s=new Uint8Array(X);for(;--X>=0;){let N=A[X];N<0?N=0:N>1&&(N=1),s[X]=255*N}A=s}const E=document.createElement("canvas");E.width=N,E.height=f;const g=E.getContext("2d");if(!g)return null;const K=g.createImageData(N,f);if(K.data.set(A),g.putImageData(K,0,0),s){const A=document.createElement("canvas");A.width=N,A.height=f;const X=A.getContext("2d");return X?(X.translate(0,f),X.scale(1,-1),X.drawImage(E,0,0),A.toDataURL("image/png")):null}return E.toDataURL("image/png")}function Q(A){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const N=A.getInternalTexture();if(!N)return null;const f=A._readPixelsSync(X,s);return f?d(f,A.getSize(),N.invertY):null}async function w(A){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const N=A.getInternalTexture();if(!N)return null;const f=await A.readPixels(X,s);return f?d(f,A.getSize(),N.invertY):null}var R=s(795),C=s(707);class J extends K.b{static _CreateVideoTexture(A,X,s){arguments.length>5&&void 0!==arguments[5]||J.TRILINEAR_SAMPLINGMODE;throw(0,i.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(A){this._isBlocking=A}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(A,X,s,N){let f,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:J.TRILINEAR_SAMPLINGMODE,K=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,v=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=arguments.length>9?arguments[9]:void 0,M=arguments.length>10?arguments[10]:void 0,d=arguments.length>11?arguments[11]:void 0,Q=arguments.length>12?arguments[12]:void 0,w=arguments.length>13?arguments[13]:void 0;super(X),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new E.b,this._isBlocking=!0,this.name=A||"",this.url=A;let C=!1,a=null,u=!0;"object"===typeof s&&null!==s?(f=s.noMipmap??!1,N=s.invertY??!R.b,g=s.samplingMode??J.TRILINEAR_SAMPLINGMODE,K=s.X??null,r=s.onError??null,i=s.buffer??null,v=s.deleteBuffer??!1,c=s.format,M=s.mimeType,d=s.loaderOptions,Q=s.creationFlags,C=s.useSRGBBuffer??!1,a=s.internalTexture??null,u=s.gammaSpace??u,w=s.forcedExtension??w):f=!!s,this._gammaSpace=u,this._noMipmap=f,this._invertY=void 0===N?!R.b:N,this._initialSamplingMode=g,this._buffer=i,this._deleteBuffer=v,this._mimeType=M,this._loaderOptions=d,this._creationFlags=Q,this._useSRGBBuffer=C,this._forcedExtension=w,void 0!==c&&(this._format=c);const z=this.va(),m=this._getEngine();if(!m)return;m.onBeforeTextureInitObservable.notifyObservers(this);const b=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),K&&K(),!this.isBlocking&&z&&z.resetCachedMaterial()},y=(A,X)=>{this._loadingError=!0,this._errorObject={message:A,exception:X},r&&r(A,X),J.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!a)return this._delayedOnLoad=b,void(this._delayedOnError=y);if(this._texture=a??this._getFromCache(this.url,f,g,this._invertY,C,this.isCube),this._texture)if(this._texture.isReady)Y.e.SetImmediate((()=>b()));else{const A=this._texture.onLoadedObservable.add(b);this._texture.onErrorObservable.add((X=>{var s;y(X.message,X.exception),null===(s=this._texture)||void 0===s||s.onLoadedObservable.remove(A)}))}else if(z&&z.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=b,this._delayedOnError=y;else{try{this._texture=m.createTexture(this.url,f,this._invertY,z,g,b,y,this._buffer,void 0,this._format,this._forcedExtension,M,d,Q,C)}catch(j){throw y("error loading",j),j}v&&(this._buffer=null)}}updateURL(A){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2?arguments[2]:void 0,N=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(A=>A.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=A),this.url=A,this._buffer=X,this._forcedExtension=N,this.delayLoadState=4,s&&(this._delayedOnLoad=s),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const A=this.va();A&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?Y.e.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=A.getEngine().createTexture(this.url,this._noMipmap,this._invertY,A,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(A,X,s,N){A*=this._cachedUScale,X*=this._cachedVScale,A-=this.uRotationCenter*this._cachedUScale,X-=this.vRotationCenter*this._cachedVScale,s-=this.wRotationCenter,g.k.TransformCoordinatesFromFloatsToRef(A,X,s,this._rowGenerationMatrix,N),N.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,N.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,N.z+=this.wRotationCenter}getTextureMatrix(){let A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*A===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*A,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=g.c.Zero(),this._rowGenerationMatrix=new g.c,this._t0=g.k.Zero(),this._t1=g.k.Zero(),this._t2=g.k.Zero()),g.c.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(g.c.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,g.f.Matrix[0]),g.c.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,g.f.Matrix[1]),g.c.ScalingToRef(this._cachedUScale,this._cachedVScale,0,g.f.Matrix[2]),g.c.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,g.f.Matrix[3]),g.f.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(g.f.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(g.f.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(g.f.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Ri(this._t0),this._t2.Ri(this._t0),g.c.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const X=this.va();if(!X)return this._cachedTextureMatrix;const s=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&s!==this._cachedIdentity3x2&&X.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const A=this.va();if(!A)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==J.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===A.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=g.c.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=g.c.Zero());const X=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case J.PLANAR_MODE:g.c.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case J.PROJECTION_MODE:{g.c.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const X=A.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=X.updateFlag,X.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:g.c.IdentityToRef(this._cachedReflectionTextureMatrix)}return X&&A.markAllMaterialsAsDirty(1,(A=>A.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const A={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return C.c.Clone((()=>new J(this._texture?this._texture.url:null,this.va(),A)),this)}serialize(){var A;const X=this.name;J.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const s=super.serialize(J._SerializeInternalTextureUniqueId);if(!s)return null;if(J.SerializeBuffers||J.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))s.base64String=this._buffer,s.name=s.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const A=this.mimeType||"image/png";s.base64String=`data:${A};base64,${(0,M.i)(this._buffer)}`}else(J.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(s.base64String=!this._engine||this._engine._features.supportSyncTextureRead?Q(this):w(this));var N;(s.invertY=this._invertY,s.samplingMode=this.samplingMode,s._creationFlags=this._creationFlags,s._useSRGBBuffer=this._useSRGBBuffer,J._SerializeInternalTextureUniqueId)&&(s.internalTextureUniqueId=null===(N=this._texture)||void 0===N?void 0:N.uniqueId);return s.internalTextureLabel=null===(A=this._texture)||void 0===A?void 0:A.label,s.noMipmap=this._noMipmap,this.name=X,s}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(A,X,s){if(A.customType){const N=v.e.Instantiate(A.customType).Parse(A,X,s);return A.samplingMode&&N.updateSamplingMode&&N._samplingMode&&N._samplingMode!==A.samplingMode&&N.updateSamplingMode(A.samplingMode),N}if(A.isCube&&!A.isRenderTarget)return J._CubeTextureParser(A,X,s);const N=void 0!==A.internalTextureUniqueId;if(!A.name&&!A.isRenderTarget&&!N)return null;let f;if(N){const s=X.getEngine().getLoadedTexturesCache();for(const X of s)if(X.uniqueId===A.internalTextureUniqueId){f=X;break}}const E=X=>{if(X&&X._texture&&(X._texture._cachedWrapU=null,X._texture._cachedWrapV=null,X._texture._cachedWrapR=null),A.samplingMode){const s=A.samplingMode;X&&X.samplingMode!==s&&X.updateSamplingMode(s)}if(X&&A.animations)for(let s=0;s<A.animations.length;s++){const N=A.animations[s],f=(0,r.d)("BABYLON.Animation");f&&X.animations.push(f.Parse(N))}X&&X._texture&&(N&&!f&&X._texture._setUniqueId(A.internalTextureUniqueId),X._texture.label=A.internalTextureLabel)};return C.c.Parse((()=>{let N=!0;if(A.noMipmap&&(N=!1),A.mirrorPlane){const s=J._CreateMirror(A.name,A.renderTargetSize,X,N);return s._waitingRenderList=A.renderList,s.mirrorPlane=c.e.mi(A.mirrorPlane),E(s),s}if(A.isRenderTarget){let s=null;if(A.isCube){if(X.reflectionProbes)for(let N=0;N<X.reflectionProbes.length;N++){const s=X.reflectionProbes[N];if(s.name===A.name)return s.cubeTexture}}else s=J._CreateRenderTargetTexture(A.name,A.renderTargetSize,X,N,A._creationFlags??0),s._waitingRenderList=A.renderList;return E(s),s}if(A.isVideo){const f=J._CreateVideoTexture(s+(A.url||A.name),s+(A.src||A.url),X,N,A.invertY,A.samplingMode,A.settings||{});return E(f),f}{let g;if(A.base64String&&!f)g=J.CreateFromBase64String(A.base64String,A.base64String,X,!N,A.invertY,A.samplingMode,(()=>{E(g)}),A._creationFlags??0,A._useSRGBBuffer??!1),g.name=A.name;else{let K;K=A.name&&(A.name.indexOf("://")>0||A.name.startsWith("data:"))?A.name:s+A.name,A.url&&(A.url.startsWith("data:")||J.UseSerializedUrlIfAny)&&(K=A.url);const r={noMipmap:!N,invertY:A.invertY,samplingMode:A.samplingMode,X:()=>{E(g)},internalTexture:f};g=new J(K,X,r)}return g}}),A,X)}static CreateFromBase64String(A,X,s,N,f){let E=arguments.length>5&&void 0!==arguments[5]?arguments[5]:J.TRILINEAR_SAMPLINGMODE;return new J("data:"+X,s,N,f,E,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,A,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(A,X,s){let N=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=arguments.length>4?arguments[4]:void 0,E=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:J.TRILINEAR_SAMPLINGMODE,K=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,i=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,Y=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0;return"data:"!==A.substring(0,5)&&(A="data:"+A),new J(A,s,f,E,g,K,r,X,N,i,void 0,void 0,Y,v)}}J.SerializeBuffers=!0,J.ForceSerializeBuffers=!1,J.OnTextureLoadErrorObservable=new E.b,J._SerializeInternalTextureUniqueId=!1,J._CubeTextureParser=(A,X,s)=>{throw(0,i.e)("CubeTexture")},J._CreateMirror=(A,X,s,N)=>{throw(0,i.e)("MirrorTexture")},J._CreateRenderTargetTexture=(A,X,s,N,f)=>{throw(0,i.e)("RenderTargetTexture")},J.NEAREST_SAMPLINGMODE=1,J.NEAREST_NEAREST_MIPLINEAR=8,J.BILINEAR_SAMPLINGMODE=2,J.LINEAR_LINEAR_MIPNEAREST=11,J.TRILINEAR_SAMPLINGMODE=3,J.LINEAR_LINEAR_MIPLINEAR=3,J.NEAREST_NEAREST_MIPNEAREST=4,J.NEAREST_LINEAR_MIPNEAREST=5,J.NEAREST_LINEAR_MIPLINEAR=6,J.NEAREST_LINEAR=7,J.NEAREST_NEAREST=1,J.LINEAR_NEAREST_MIPNEAREST=9,J.LINEAR_NEAREST_MIPLINEAR=10,J.LINEAR_LINEAR=2,J.LINEAR_NEAREST=12,J.EXPLICIT_MODE=0,J.SPHERICAL_MODE=1,J.PLANAR_MODE=2,J.CUBIC_MODE=3,J.PROJECTION_MODE=4,J.SKYBOX_MODE=5,J.INVCUBIC_MODE=6,J.EQUIRECTANGULAR_MODE=7,J.FIXED_EQUIRECTANGULAR_MODE=8,J.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,J.CLAMP_ADDRESSMODE=0,J.WRAP_ADDRESSMODE=1,J.MIRROR_ADDRESSMODE=2,J.UseSerializedUrlIfAny=!1,(0,N.e)([(0,f.M)()],J.prototype,"url",void 0),(0,N.e)([(0,f.M)()],J.prototype,"uOffset",void 0),(0,N.e)([(0,f.M)()],J.prototype,"vOffset",void 0),(0,N.e)([(0,f.M)()],J.prototype,"uScale",void 0),(0,N.e)([(0,f.M)()],J.prototype,"vScale",void 0),(0,N.e)([(0,f.M)()],J.prototype,"uAng",void 0),(0,N.e)([(0,f.M)()],J.prototype,"vAng",void 0),(0,N.e)([(0,f.M)()],J.prototype,"wAng",void 0),(0,N.e)([(0,f.M)()],J.prototype,"uRotationCenter",void 0),(0,N.e)([(0,f.M)()],J.prototype,"vRotationCenter",void 0),(0,N.e)([(0,f.M)()],J.prototype,"wRotationCenter",void 0),(0,N.e)([(0,f.M)()],J.prototype,"homogeneousRotationInUVTransform",void 0),(0,N.e)([(0,f.M)()],J.prototype,"isBlocking",null),(0,r.f)("BABYLON.Texture",J),C.c._TextureParser=J.Parse},2257:(A,X,s)=>{s.d(X,{e:()=>N});class N{constructor(A,X){this.width=A,this.height=X}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let A=0|this.width;return A=397*A^this.height,A}p(A){this.width=A.width,this.height=A.height}gi(A,X){return this.width=A,this.height=X,this}set(A,X){return this.gi(A,X)}multiplyByFloats(A,X){return new N(this.width*A,this.height*X)}clone(){return new N(this.width,this.height)}equals(A){return!!A&&(this.width===A.width&&this.height===A.height)}get surface(){return this.width*this.height}static Zero(){return new N(0,0)}add(A){return new N(this.width+A.width,this.height+A.height)}Pg(A){return new N(this.width-A.width,this.height-A.height)}scale(A){return new N(this.width*A,this.height*A)}static Lerp(A,X,s){const f=A.width+(X.width-A.width)*s,E=A.height+(X.height-A.height)*s;return new N(f,E)}}}}]);