"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2073:(c,b,A)=>{A.d(b,{b:()=>R});var o=A(672),t=A(674),n=A(518),h=A(688),s=A(550),L=A(640),C=(A(552),A(2048));class J{get wrapU(){return this._wrapU}set wrapU(c){this._wrapU=c}get wrapV(){return this._wrapV}set wrapV(c){this._wrapV=c}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(c){this._texture&&(this._texture.isCube=c)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(c){this._texture&&(this._texture.is3D=c)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(c){this._texture&&(this._texture.is2DArray=c)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(c){return void 0!==(null===c||void 0===c?void 0:c.shareDepth)}constructor(c){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=C.e.Zero(),this._cachedBaseSize=C.e.Zero(),this._initialSamplingMode=2,this._texture=J._IsRenderTargetWrapper(c)?c.texture:c,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(c){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(c,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var X=A(714);class R extends J{set pi(c){this._hasAlpha!==c&&(this._hasAlpha=c,this._scene&&this._scene.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))))}get pi(){return this._hasAlpha}set getAlphaFromRGB(c){this._getAlphaFromRGB!==c&&(this._getAlphaFromRGB=c,this._scene&&this._scene.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(c){this._coordinatesIndex!==c&&(this._coordinatesIndex=c,this._scene&&this._scene.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(c){this._coordinatesMode!==c&&(this._coordinatesMode=c,this._scene&&this._scene.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(c){this._wrapU=c}get wrapV(){return this._wrapV}set wrapV(c){this._wrapV=c}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(c){this._texture?this._texture.isCube=c:this._isCube=c}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(c){this._texture&&(this._texture.is3D=c)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(c){this._texture&&(this._texture.is2DArray=c)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(c){var b;if(this._texture){if(this._texture._gammaSpace===c)return;this._texture._gammaSpace=c}else{if(this._gammaSpace===c)return;this._gammaSpace=c}null===(b=this.va())||void 0===b||b.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(c){var b;c!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=c),null===(b=this.va())||void 0===b||b.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(c){this._texture&&(this._texture._lodGenerationOffset=c)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(c){this._texture&&(this._texture._lodGenerationScale=c)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(c){this._texture&&(this._texture._linearSpecularLOD=c)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(c){this._texture&&(this._texture._irradianceTexture=c)}get uid(){return this._uid||(this._uid=(0,L.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(c){this._onDisposeObserver&&this.fk.remove(this._onDisposeObserver),this._onDisposeObserver=this.fk.add(c)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(c){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=R.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.fk=new n.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,c?R._IsScene(c)?this._scene=c:this._engine=c:this._scene=s.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=b,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return h.b.IdentityReadOnly}getReflectionTextureMatrix(){return h.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(c){}get canRescale(){return!1}_getFromCache(c,b,A,o,t,n){const h=this._getEngine();if(!h)return null;const s=h._getUseSRGBBuffer(!!t,b),L=h.getLoadedTexturesCache();for(let C=0;C<L.length;C++){const h=L[C];if((void 0===t||s===h._useSRGBBuffer)&&(void 0===o||o===h.invertY)&&h.url===c&&h.generateMipMaps===!b&&(!A||A===h.samplingMode)&&(void 0===n||n===h.isCube))return h.incrementReferences(),h}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const c=this.va();c&&c.markAllMaterialsAsDirty(1)}readPixels(){let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,L=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const C=this._getEngine();if(!C)return null;const J=this.getSize();let X=J.width,R=J.height;0!==b&&(X/=Math.pow(2,b),R/=Math.pow(2,b),X=Math.round(X),R=Math.round(R)),s=Math.min(X,s),L=Math.min(R,L);try{return this._texture.isCube?C._readTexturePixels(this._texture,s,L,c,b,A,o,t,n,h):C._readTexturePixels(this._texture,s,L,-1,b,A,o,t,n,h)}catch(N){return null}}_readPixelsSync(){let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],t=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const n=this.getSize();let h=n.width,s=n.height;const L=this._getEngine();if(!L)return null;0!=b&&(h/=Math.pow(2,b),s/=Math.pow(2,b),h=Math.round(h),s=Math.round(s));try{return this._texture.isCube?L._readTexturePixelsSync(this._texture,h,s,c,b,A,o,t):L._readTexturePixelsSync(this._texture,h,s,-1,b,A,o,t)}catch(C){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const c=this._scene.textures.indexOf(this);if(c>=0&&this._scene.textures.splice(c,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const c=this._parentContainer.textures.indexOf(this);c>-1&&this._parentContainer.textures.splice(c,1),this._parentContainer=null}}this.fk.notifyObservers(this),this.fk.clear(),this.metadata=null,super.dispose()}serialize(){let c=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!c)return null;const b=X.c.Serialize(this);return X.c.AppendSerializedAnimations(this,b),b}static WhenAllReady(c,b){let A=c.length;if(0!==A)for(let o=0;o<c.length;o++){const t=c[o];if(t.isReady())0===--A&&b();else{const c=t.onLoadObservable;c?c.addOnce((()=>{0===--A&&b()})):0===--A&&b()}}else b()}static _IsScene(c){return"Scene"===c.getClassName()}}R.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,o.e)([(0,t.J)()],R.prototype,"uniqueId",void 0),(0,o.e)([(0,t.J)()],R.prototype,"name",void 0),(0,o.e)([(0,t.J)()],R.prototype,"displayName",void 0),(0,o.e)([(0,t.J)()],R.prototype,"metadata",void 0),(0,o.e)([(0,t.J)("pi")],R.prototype,"_hasAlpha",void 0),(0,o.e)([(0,t.J)("getAlphaFromRGB")],R.prototype,"_getAlphaFromRGB",void 0),(0,o.e)([(0,t.J)()],R.prototype,"level",void 0),(0,o.e)([(0,t.J)("coordinatesIndex")],R.prototype,"_coordinatesIndex",void 0),(0,o.e)([(0,t.J)()],R.prototype,"optimizeUVAllocation",void 0),(0,o.e)([(0,t.J)("coordinatesMode")],R.prototype,"_coordinatesMode",void 0),(0,o.e)([(0,t.J)()],R.prototype,"wrapU",null),(0,o.e)([(0,t.J)()],R.prototype,"wrapV",null),(0,o.e)([(0,t.J)()],R.prototype,"wrapR",void 0),(0,o.e)([(0,t.J)()],R.prototype,"anisotropicFilteringLevel",void 0),(0,o.e)([(0,t.J)()],R.prototype,"isCube",null),(0,o.e)([(0,t.J)()],R.prototype,"is3D",null),(0,o.e)([(0,t.J)()],R.prototype,"is2DArray",null),(0,o.e)([(0,t.J)()],R.prototype,"gammaSpace",null),(0,o.e)([(0,t.J)()],R.prototype,"invertZ",void 0),(0,o.e)([(0,t.J)()],R.prototype,"lodLevelInAlpha",void 0),(0,o.e)([(0,t.J)()],R.prototype,"lodGenerationOffset",null),(0,o.e)([(0,t.J)()],R.prototype,"lodGenerationScale",null),(0,o.e)([(0,t.J)()],R.prototype,"linearSpecularLOD",null),(0,o.e)([(0,t.F)()],R.prototype,"irradianceTexture",null),(0,o.e)([(0,t.J)()],R.prototype,"isRenderTarget",void 0)},2070:(c,b,A)=>{A.d(b,{d:()=>F});var o=A(672),t=A(674),n=A(518),h=A(688),s=A(2073),L=A(633),C=A(543),J=A(580),X=A(631),R=A(744),N=A(566);function k(c,b){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=b.width,t=b.height;if(c instanceof Float32Array){let b=c.byteLength/c.BYTES_PER_ELEMENT;const A=new Uint8Array(b);for(;--b>=0;){let o=c[b];o<0?o=0:o>1&&(o=1),A[b]=255*o}c=A}const n=document.createElement("canvas");n.width=o,n.height=t;const h=n.getContext("2d");if(!h)return null;const s=h.createImageData(o,t);if(s.data.set(c),h.putImageData(s,0,0),A){const c=document.createElement("canvas");c.width=o,c.height=t;const b=c.getContext("2d");return b?(b.translate(0,t),b.scale(1,-1),b.drawImage(n,0,0),c.toDataURL("image/png")):null}return n.toDataURL("image/png")}function E(c){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=c.getInternalTexture();if(!o)return null;const t=c._readPixelsSync(b,A);return t?k(t,c.getSize(),o.invertY):null}async function V(c){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=c.getInternalTexture();if(!o)return null;const t=await c.readPixels(b,A);return t?k(t,c.getSize(),o.invertY):null}var y=A(816),j=A(714);class F extends s.b{static _CreateVideoTexture(c,b,A){arguments.length>5&&void 0!==arguments[5]||F.TRILINEAR_SAMPLINGMODE;throw(0,C.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(c){this._isBlocking=c}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(c,b,A,o){let t,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:F.TRILINEAR_SAMPLINGMODE,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,L=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,X=arguments.length>8&&void 0!==arguments[8]&&arguments[8],R=arguments.length>9?arguments[9]:void 0,N=arguments.length>10?arguments[10]:void 0,k=arguments.length>11?arguments[11]:void 0,E=arguments.length>12?arguments[12]:void 0,V=arguments.length>13?arguments[13]:void 0;super(b),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new n.b,this._isBlocking=!0,this.name=c||"",this.url=c;let j=!1,M=null,W=!0;"object"===typeof A&&null!==A?(t=A.noMipmap??!1,o=A.invertY??!y.b,h=A.samplingMode??F.TRILINEAR_SAMPLINGMODE,s=A.X??null,L=A.onError??null,C=A.buffer??null,X=A.deleteBuffer??!1,R=A.format,N=A.mimeType,k=A.loaderOptions,E=A.creationFlags,j=A.useSRGBBuffer??!1,M=A.internalTexture??null,W=A.gammaSpace??W,V=A.forcedExtension??V):t=!!A,this._gammaSpace=W,this._noMipmap=t,this._invertY=void 0===o?!y.b:o,this._initialSamplingMode=h,this._buffer=C,this._deleteBuffer=X,this._mimeType=N,this._loaderOptions=k,this._creationFlags=E,this._useSRGBBuffer=j,this._forcedExtension=V,void 0!==R&&(this._format=R);const d=this.va(),r=this._getEngine();if(!r)return;r.onBeforeTextureInitObservable.notifyObservers(this);const z=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),s&&s(),!this.isBlocking&&d&&d.resetCachedMaterial()},Y=(c,b)=>{this._loadingError=!0,this._errorObject={message:c,exception:b},L&&L(c,b),F.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!M)return this._delayedOnLoad=z,void(this._delayedOnError=Y);if(this._texture=M??this._getFromCache(this.url,t,h,this._invertY,j,this.isCube),this._texture)if(this._texture.isReady)J.b.SetImmediate((()=>z()));else{const c=this._texture.onLoadedObservable.add(z);this._texture.onErrorObservable.add((b=>{var A;Y(b.message,b.exception),null===(A=this._texture)||void 0===A||A.onLoadedObservable.remove(c)}))}else if(d&&d.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=z,this._delayedOnError=Y;else{try{this._texture=r.createTexture(this.url,t,this._invertY,d,h,z,Y,this._buffer,void 0,this._format,this._forcedExtension,N,k,E,j)}catch(D){throw Y("error loading",D),D}X&&(this._buffer=null)}}updateURL(c){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,A=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(c=>c.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=c),this.url=c,this._buffer=b,this._forcedExtension=o,this.delayLoadState=4,A&&(this._delayedOnLoad=A),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const c=this.va();c&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?J.b.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=c.getEngine().createTexture(this.url,this._noMipmap,this._invertY,c,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(c,b,A,o){c*=this._cachedUScale,b*=this._cachedVScale,c-=this.uRotationCenter*this._cachedUScale,b-=this.vRotationCenter*this._cachedVScale,A-=this.wRotationCenter,h.k.TransformCoordinatesFromFloatsToRef(c,b,A,this._rowGenerationMatrix,o),o.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,o.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,o.z+=this.wRotationCenter}getTextureMatrix(){let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*c===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*c,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=h.b.Zero(),this._rowGenerationMatrix=new h.b,this._t0=h.k.Zero(),this._t1=h.k.Zero(),this._t2=h.k.Zero()),h.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(h.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,h.f.Matrix[0]),h.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,h.f.Matrix[1]),h.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,h.f.Matrix[2]),h.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,h.f.Matrix[3]),h.f.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.f.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.f.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.f.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.ck(this._t0),this._t2.ck(this._t0),h.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const b=this.va();if(!b)return this._cachedTextureMatrix;const A=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&A!==this._cachedIdentity3x2&&b.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const c=this.va();if(!c)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==F.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===c.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=h.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=h.b.Zero());const b=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case F.PLANAR_MODE:h.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case F.PROJECTION_MODE:{h.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const b=c.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=b.updateFlag,b.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:h.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return b&&c.markAllMaterialsAsDirty(1,(c=>c.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const c={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return j.c.Clone((()=>new F(this._texture?this._texture.url:null,this.va(),c)),this)}serialize(){var c;const b=this.name;F.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const A=super.serialize(F._SerializeInternalTextureUniqueId);if(!A)return null;if(F.SerializeBuffers||F.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))A.base64String=this._buffer,A.name=A.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const c=this.mimeType||"image/png";A.base64String=`data:${c};base64,${(0,N.i)(this._buffer)}`}else(F.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(A.base64String=!this._engine||this._engine._features.supportSyncTextureRead?E(this):V(this));var o;(A.invertY=this._invertY,A.samplingMode=this.samplingMode,A._creationFlags=this._creationFlags,A._useSRGBBuffer=this._useSRGBBuffer,F._SerializeInternalTextureUniqueId)&&(A.internalTextureUniqueId=null===(o=this._texture)||void 0===o?void 0:o.uniqueId);return A.internalTextureLabel=null===(c=this._texture)||void 0===c?void 0:c.label,A.noMipmap=this._noMipmap,this.name=b,A}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(c,b,A){if(c.customType){const o=X.e.Instantiate(c.customType).Parse(c,b,A);return c.samplingMode&&o.updateSamplingMode&&o._samplingMode&&o._samplingMode!==c.samplingMode&&o.updateSamplingMode(c.samplingMode),o}if(c.isCube&&!c.isRenderTarget)return F._CubeTextureParser(c,b,A);const o=void 0!==c.internalTextureUniqueId;if(!c.name&&!c.isRenderTarget&&!o)return null;let t;if(o){const A=b.getEngine().getLoadedTexturesCache();for(const b of A)if(b.uniqueId===c.internalTextureUniqueId){t=b;break}}const n=b=>{if(b&&b._texture&&(b._texture._cachedWrapU=null,b._texture._cachedWrapV=null,b._texture._cachedWrapR=null),c.samplingMode){const A=c.samplingMode;b&&b.samplingMode!==A&&b.updateSamplingMode(A)}if(b&&c.animations)for(let A=0;A<c.animations.length;A++){const o=c.animations[A],t=(0,L.c)("BABYLON.Animation");t&&b.animations.push(t.Parse(o))}b&&b._texture&&(o&&!t&&b._texture._setUniqueId(c.internalTextureUniqueId),b._texture.label=c.internalTextureLabel)};return j.c.Parse((()=>{let o=!0;if(c.noMipmap&&(o=!1),c.mirrorPlane){const A=F._CreateMirror(c.name,c.renderTargetSize,b,o);return A._waitingRenderList=c.renderList,A.mirrorPlane=R.c.$j(c.mirrorPlane),n(A),A}if(c.isRenderTarget){let A=null;if(c.isCube){if(b.reflectionProbes)for(let o=0;o<b.reflectionProbes.length;o++){const A=b.reflectionProbes[o];if(A.name===c.name)return A.cubeTexture}}else A=F._CreateRenderTargetTexture(c.name,c.renderTargetSize,b,o,c._creationFlags??0),A._waitingRenderList=c.renderList;return n(A),A}if(c.isVideo){const t=F._CreateVideoTexture(A+(c.url||c.name),A+(c.src||c.url),b,o,c.invertY,c.samplingMode,c.settings||{});return n(t),t}{let h;if(c.base64String&&!t)h=F.CreateFromBase64String(c.base64String,c.base64String,b,!o,c.invertY,c.samplingMode,(()=>{n(h)}),c._creationFlags??0,c._useSRGBBuffer??!1),h.name=c.name;else{let s;s=c.name&&(c.name.indexOf("://")>0||c.name.startsWith("data:"))?c.name:A+c.name,c.url&&(c.url.startsWith("data:")||F.UseSerializedUrlIfAny)&&(s=c.url);const L={noMipmap:!o,invertY:c.invertY,samplingMode:c.samplingMode,X:()=>{n(h)},internalTexture:t};h=new F(s,b,L)}return h}}),c,b)}static CreateFromBase64String(c,b,A,o,t){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:F.TRILINEAR_SAMPLINGMODE;return new F("data:"+b,A,o,t,n,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(c,b,A){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],t=arguments.length>4?arguments[4]:void 0,n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:F.TRILINEAR_SAMPLINGMODE,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,C=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,J=arguments.length>10?arguments[10]:void 0,X=arguments.length>11?arguments[11]:void 0;return"data:"!==c.substring(0,5)&&(c="data:"+c),new F(c,A,t,n,h,s,L,b,o,C,void 0,void 0,J,X)}}F.SerializeBuffers=!0,F.ForceSerializeBuffers=!1,F.OnTextureLoadErrorObservable=new n.b,F._SerializeInternalTextureUniqueId=!1,F._CubeTextureParser=(c,b,A)=>{throw(0,C.c)("CubeTexture")},F._CreateMirror=(c,b,A,o)=>{throw(0,C.c)("MirrorTexture")},F._CreateRenderTargetTexture=(c,b,A,o,t)=>{throw(0,C.c)("RenderTargetTexture")},F.NEAREST_SAMPLINGMODE=1,F.NEAREST_NEAREST_MIPLINEAR=8,F.BILINEAR_SAMPLINGMODE=2,F.LINEAR_LINEAR_MIPNEAREST=11,F.TRILINEAR_SAMPLINGMODE=3,F.LINEAR_LINEAR_MIPLINEAR=3,F.NEAREST_NEAREST_MIPNEAREST=4,F.NEAREST_LINEAR_MIPNEAREST=5,F.NEAREST_LINEAR_MIPLINEAR=6,F.NEAREST_LINEAR=7,F.NEAREST_NEAREST=1,F.LINEAR_NEAREST_MIPNEAREST=9,F.LINEAR_NEAREST_MIPLINEAR=10,F.LINEAR_LINEAR=2,F.LINEAR_NEAREST=12,F.EXPLICIT_MODE=0,F.SPHERICAL_MODE=1,F.PLANAR_MODE=2,F.CUBIC_MODE=3,F.PROJECTION_MODE=4,F.SKYBOX_MODE=5,F.INVCUBIC_MODE=6,F.EQUIRECTANGULAR_MODE=7,F.FIXED_EQUIRECTANGULAR_MODE=8,F.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,F.CLAMP_ADDRESSMODE=0,F.WRAP_ADDRESSMODE=1,F.MIRROR_ADDRESSMODE=2,F.UseSerializedUrlIfAny=!1,(0,o.e)([(0,t.J)()],F.prototype,"url",void 0),(0,o.e)([(0,t.J)()],F.prototype,"uOffset",void 0),(0,o.e)([(0,t.J)()],F.prototype,"vOffset",void 0),(0,o.e)([(0,t.J)()],F.prototype,"uScale",void 0),(0,o.e)([(0,t.J)()],F.prototype,"vScale",void 0),(0,o.e)([(0,t.J)()],F.prototype,"uAng",void 0),(0,o.e)([(0,t.J)()],F.prototype,"vAng",void 0),(0,o.e)([(0,t.J)()],F.prototype,"wAng",void 0),(0,o.e)([(0,t.J)()],F.prototype,"uRotationCenter",void 0),(0,o.e)([(0,t.J)()],F.prototype,"vRotationCenter",void 0),(0,o.e)([(0,t.J)()],F.prototype,"wRotationCenter",void 0),(0,o.e)([(0,t.J)()],F.prototype,"homogeneousRotationInUVTransform",void 0),(0,o.e)([(0,t.J)()],F.prototype,"isBlocking",null),(0,L.d)("BABYLON.Texture",F),j.c._TextureParser=F.Parse},2048:(c,b,A)=>{A.d(b,{e:()=>o});class o{constructor(c,b){this.width=c,this.height=b}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let c=0|this.width;return c=397*c^this.height,c}p(c){this.width=c.width,this.height=c.height}jd(c,b){return this.width=c,this.height=b,this}set(c,b){return this.jd(c,b)}multiplyByFloats(c,b){return new o(this.width*c,this.height*b)}clone(){return new o(this.width,this.height)}equals(c){return!!c&&(this.width===c.width&&this.height===c.height)}get surface(){return this.width*this.height}static Zero(){return new o(0,0)}add(c){return new o(this.width+c.width,this.height+c.height)}Xd(c){return new o(this.width-c.width,this.height-c.height)}scale(c){return new o(this.width*c,this.height*c)}static Lerp(c,b,A){const t=c.width+(b.width-c.width)*A,n=c.height+(b.height-c.height)*A;return new o(t,n)}}}}]);