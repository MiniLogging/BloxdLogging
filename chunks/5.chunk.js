"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2319:(R,x,H)=>{H.d(x,{e:()=>g});var k=H(643),c=H(647),t=H(476),A=H(661),D=H(513),U=H(612),J=(H(517),H(2292));class V{get wrapU(){return this._wrapU}set wrapU(R){this._wrapU=R}get wrapV(){return this._wrapV}set wrapV(R){this._wrapV=R}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(R){this._texture&&(this._texture.isCube=R)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(R){this._texture&&(this._texture.is3D=R)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(R){this._texture&&(this._texture.is2DArray=R)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(R){return void 0!==(null===R||void 0===R?void 0:R.shareDepth)}constructor(R){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=J.d.Zero(),this._cachedBaseSize=J.d.Zero(),this._initialSamplingMode=2,this._texture=V._IsRenderTargetWrapper(R)?R.texture:R,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(R){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(R,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var n=H(687);class g extends V{set Qj(R){this._hasAlpha!==R&&(this._hasAlpha=R,this._scene&&this._scene.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))))}get Qj(){return this._hasAlpha}set getAlphaFromRGB(R){this._getAlphaFromRGB!==R&&(this._getAlphaFromRGB=R,this._scene&&this._scene.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(R){this._coordinatesIndex!==R&&(this._coordinatesIndex=R,this._scene&&this._scene.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(R){this._coordinatesMode!==R&&(this._coordinatesMode=R,this._scene&&this._scene.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(R){this._wrapU=R}get wrapV(){return this._wrapV}set wrapV(R){this._wrapV=R}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(R){this._texture?this._texture.isCube=R:this._isCube=R}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(R){this._texture&&(this._texture.is3D=R)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(R){this._texture&&(this._texture.is2DArray=R)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(R){var x;if(this._texture){if(this._texture._gammaSpace===R)return;this._texture._gammaSpace=R}else{if(this._gammaSpace===R)return;this._gammaSpace=R}null===(x=this.va())||void 0===x||x.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(R){var x;R!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=R),null===(x=this.va())||void 0===x||x.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(R){this._texture&&(this._texture._lodGenerationOffset=R)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(R){this._texture&&(this._texture._lodGenerationScale=R)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(R){this._texture&&(this._texture._linearSpecularLOD=R)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(R){this._texture&&(this._texture._irradianceTexture=R)}get uid(){return this._uid||(this._uid=(0,U.e)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(R){this._onDisposeObserver&&this.Vi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Vi.add(R)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(R){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=g.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Vi=new t.d,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,R?g._IsScene(R)?this._scene=R:this._engine=R:this._scene=D.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=x,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return A.e.IdentityReadOnly}getReflectionTextureMatrix(){return A.e.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(R){}get canRescale(){return!1}_getFromCache(R,x,H,k,c,t){const A=this._getEngine();if(!A)return null;const D=A._getUseSRGBBuffer(!!c,x),U=A.getLoadedTexturesCache();for(let J=0;J<U.length;J++){const A=U[J];if((void 0===c||D===A._useSRGBBuffer)&&(void 0===k||k===A.invertY)&&A.url===R&&A.generateMipMaps===!x&&(!H||H===A.samplingMode)&&(void 0===t||t===A.isCube))return A.incrementReferences(),A}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const R=this.va();R&&R.markAllMaterialsAsDirty(1)}readPixels(){let R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,k=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],t=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,D=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,U=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const J=this._getEngine();if(!J)return null;const V=this.getSize();let n=V.width,g=V.height;0!==x&&(n/=Math.pow(2,x),g/=Math.pow(2,x),n=Math.round(n),g=Math.round(g)),D=Math.min(n,D),U=Math.min(g,U);try{return this._texture.isCube?J._readTexturePixels(this._texture,D,U,R,x,H,k,c,t,A):J._readTexturePixels(this._texture,D,U,-1,x,H,k,c,t,A)}catch(I){return null}}_readPixelsSync(){let R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,k=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const t=this.getSize();let A=t.width,D=t.height;const U=this._getEngine();if(!U)return null;0!=x&&(A/=Math.pow(2,x),D/=Math.pow(2,x),A=Math.round(A),D=Math.round(D));try{return this._texture.isCube?U._readTexturePixelsSync(this._texture,A,D,R,x,H,k,c):U._readTexturePixelsSync(this._texture,A,D,-1,x,H,k,c)}catch(J){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const R=this._scene.textures.indexOf(this);if(R>=0&&this._scene.textures.splice(R,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const R=this._parentContainer.textures.indexOf(this);R>-1&&this._parentContainer.textures.splice(R,1),this._parentContainer=null}}this.Vi.notifyObservers(this),this.Vi.clear(),this.metadata=null,super.dispose()}serialize(){let R=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!R)return null;const x=n.d.Serialize(this);return n.d.AppendSerializedAnimations(this,x),x}static WhenAllReady(R,x){let H=R.length;if(0!==H)for(let k=0;k<R.length;k++){const c=R[k];if(c.isReady())0===--H&&x();else{const R=c.onLoadObservable;R?R.addOnce((()=>{0===--H&&x()})):0===--H&&x()}}else x()}static _IsScene(R){return"Scene"===R.getClassName()}}g.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,k.d)([(0,c.Q)()],g.prototype,"uniqueId",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"name",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"displayName",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"metadata",void 0),(0,k.d)([(0,c.Q)("Qj")],g.prototype,"_hasAlpha",void 0),(0,k.d)([(0,c.Q)("getAlphaFromRGB")],g.prototype,"_getAlphaFromRGB",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"level",void 0),(0,k.d)([(0,c.Q)("coordinatesIndex")],g.prototype,"_coordinatesIndex",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"optimizeUVAllocation",void 0),(0,k.d)([(0,c.Q)("coordinatesMode")],g.prototype,"_coordinatesMode",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"wrapU",null),(0,k.d)([(0,c.Q)()],g.prototype,"wrapV",null),(0,k.d)([(0,c.Q)()],g.prototype,"wrapR",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"anisotropicFilteringLevel",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"isCube",null),(0,k.d)([(0,c.Q)()],g.prototype,"is3D",null),(0,k.d)([(0,c.Q)()],g.prototype,"is2DArray",null),(0,k.d)([(0,c.Q)()],g.prototype,"gammaSpace",null),(0,k.d)([(0,c.Q)()],g.prototype,"invertZ",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"lodLevelInAlpha",void 0),(0,k.d)([(0,c.Q)()],g.prototype,"lodGenerationOffset",null),(0,k.d)([(0,c.Q)()],g.prototype,"lodGenerationScale",null),(0,k.d)([(0,c.Q)()],g.prototype,"linearSpecularLOD",null),(0,k.d)([(0,c.F)()],g.prototype,"irradianceTexture",null),(0,k.d)([(0,c.Q)()],g.prototype,"isRenderTarget",void 0)},2311:(R,x,H)=>{H.d(x,{d:()=>C});var k=H(643),c=H(647),t=H(476),A=H(661),D=H(2319),U=H(610),J=H(502),V=H(546),n=H(602),g=H(717),I=H(529);function i(R,x){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const k=x.width,c=x.height;if(R instanceof Float32Array){let x=R.byteLength/R.BYTES_PER_ELEMENT;const H=new Uint8Array(x);for(;--x>=0;){let k=R[x];k<0?k=0:k>1&&(k=1),H[x]=255*k}R=H}const t=document.createElement("canvas");t.width=k,t.height=c;const A=t.getContext("2d");if(!A)return null;const D=A.createImageData(k,c);if(D.data.set(R),A.putImageData(D,0,0),H){const R=document.createElement("canvas");R.width=k,R.height=c;const x=R.getContext("2d");return x?(x.translate(0,c),x.scale(1,-1),x.drawImage(t,0,0),R.toDataURL("image/png")):null}return t.toDataURL("image/png")}function q(R){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const k=R.getInternalTexture();if(!k)return null;const c=R._readPixelsSync(x,H);return c?i(c,R.getSize(),k.invertY):null}async function S(R){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const k=R.getInternalTexture();if(!k)return null;const c=await R.readPixels(x,H);return c?i(c,R.getSize(),k.invertY):null}var L=H(809),b=H(687);class C extends D.e{static _CreateVideoTexture(R,x,H){arguments.length>5&&void 0!==arguments[5]||C.TRILINEAR_SAMPLINGMODE;throw(0,J.d)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(R){this._isBlocking=R}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(R,x,H,k){let c,A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:C.TRILINEAR_SAMPLINGMODE,D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,U=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,J=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,n=arguments.length>8&&void 0!==arguments[8]&&arguments[8],g=arguments.length>9?arguments[9]:void 0,I=arguments.length>10?arguments[10]:void 0,i=arguments.length>11?arguments[11]:void 0,q=arguments.length>12?arguments[12]:void 0,S=arguments.length>13?arguments[13]:void 0;super(x),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new t.d,this._isBlocking=!0,this.name=R||"",this.url=R;let b=!1,F=null,d=!0;"object"===typeof H&&null!==H?(c=H.noMipmap??!1,k=H.invertY??!L.e,A=H.samplingMode??C.TRILINEAR_SAMPLINGMODE,D=H.X??null,U=H.onError??null,J=H.buffer??null,n=H.deleteBuffer??!1,g=H.format,I=H.mimeType,i=H.loaderOptions,q=H.creationFlags,b=H.useSRGBBuffer??!1,F=H.internalTexture??null,d=H.gammaSpace??d,S=H.forcedExtension??S):c=!!H,this._gammaSpace=d,this._noMipmap=c,this._invertY=void 0===k?!L.e:k,this._initialSamplingMode=A,this._buffer=J,this._deleteBuffer=n,this._mimeType=I,this._loaderOptions=i,this._creationFlags=q,this._useSRGBBuffer=b,this._forcedExtension=S,void 0!==g&&(this._format=g);const P=this.va(),a=this._getEngine();if(!a)return;a.onBeforeTextureInitObservable.notifyObservers(this);const X=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),D&&D(),!this.isBlocking&&P&&P.resetCachedMaterial()},M=(R,x)=>{this._loadingError=!0,this._errorObject={message:R,exception:x},U&&U(R,x),C.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!F)return this._delayedOnLoad=X,void(this._delayedOnError=M);if(this._texture=F??this._getFromCache(this.url,c,A,this._invertY,b,this.isCube),this._texture)if(this._texture.isReady)V.d.SetImmediate((()=>X()));else{const R=this._texture.onLoadedObservable.add(X);this._texture.onErrorObservable.add((x=>{var H;M(x.message,x.exception),null===(H=this._texture)||void 0===H||H.onLoadedObservable.remove(R)}))}else if(P&&P.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=X,this._delayedOnError=M;else{try{this._texture=a.createTexture(this.url,c,this._invertY,P,A,X,M,this._buffer,void 0,this._format,this._forcedExtension,I,i,q,b)}catch(B){throw M("error loading",B),B}n&&(this._buffer=null)}}updateURL(R){let x=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,H=arguments.length>2?arguments[2]:void 0,k=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(R=>R.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=R),this.url=R,this._buffer=x,this._forcedExtension=k,this.delayLoadState=4,H&&(this._delayedOnLoad=H),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const R=this.va();R&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?V.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=R.getEngine().createTexture(this.url,this._noMipmap,this._invertY,R,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(R,x,H,k){R*=this._cachedUScale,x*=this._cachedVScale,R-=this.uRotationCenter*this._cachedUScale,x-=this.vRotationCenter*this._cachedVScale,H-=this.wRotationCenter,A.o.TransformCoordinatesFromFloatsToRef(R,x,H,this._rowGenerationMatrix,k),k.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,k.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,k.z+=this.wRotationCenter}getTextureMatrix(){let R=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*R===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*R,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=A.e.Zero(),this._rowGenerationMatrix=new A.e,this._t0=A.o.Zero(),this._t1=A.o.Zero(),this._t2=A.o.Zero()),A.e.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(A.e.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,A.g.Matrix[0]),A.e.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,A.g.Matrix[1]),A.e.ScalingToRef(this._cachedUScale,this._cachedVScale,0,A.g.Matrix[2]),A.e.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,A.g.Matrix[3]),A.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(A.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.cj(this._t0),this._t2.cj(this._t0),A.e.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const x=this.va();if(!x)return this._cachedTextureMatrix;const H=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&H!==this._cachedIdentity3x2&&x.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const R=this.va();if(!R)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==C.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===R.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=A.e.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=A.e.Zero());const x=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case C.PLANAR_MODE:A.e.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case C.PROJECTION_MODE:{A.e.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const x=R.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=x.updateFlag,x.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:A.e.IdentityToRef(this._cachedReflectionTextureMatrix)}return x&&R.markAllMaterialsAsDirty(1,(R=>R.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const R={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return b.d.Clone((()=>new C(this._texture?this._texture.url:null,this.va(),R)),this)}serialize(){var R;const x=this.name;C.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const H=super.serialize(C._SerializeInternalTextureUniqueId);if(!H)return null;if(C.SerializeBuffers||C.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))H.base64String=this._buffer,H.name=H.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const R=this.mimeType||"image/png";H.base64String=`data:${R};base64,${(0,I.l)(this._buffer)}`}else(C.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(H.base64String=!this._engine||this._engine._features.supportSyncTextureRead?q(this):S(this));var k;(H.invertY=this._invertY,H.samplingMode=this.samplingMode,H._creationFlags=this._creationFlags,H._useSRGBBuffer=this._useSRGBBuffer,C._SerializeInternalTextureUniqueId)&&(H.internalTextureUniqueId=null===(k=this._texture)||void 0===k?void 0:k.uniqueId);return H.internalTextureLabel=null===(R=this._texture)||void 0===R?void 0:R.label,H.noMipmap=this._noMipmap,this.name=x,H}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(R,x,H){if(R.customType){const k=n.e.Instantiate(R.customType).Parse(R,x,H);return R.samplingMode&&k.updateSamplingMode&&k._samplingMode&&k._samplingMode!==R.samplingMode&&k.updateSamplingMode(R.samplingMode),k}if(R.isCube&&!R.isRenderTarget)return C._CubeTextureParser(R,x,H);const k=void 0!==R.internalTextureUniqueId;if(!R.name&&!R.isRenderTarget&&!k)return null;let c;if(k){const H=x.getEngine().getLoadedTexturesCache();for(const x of H)if(x.uniqueId===R.internalTextureUniqueId){c=x;break}}const t=x=>{if(x&&x._texture&&(x._texture._cachedWrapU=null,x._texture._cachedWrapV=null,x._texture._cachedWrapR=null),R.samplingMode){const H=R.samplingMode;x&&x.samplingMode!==H&&x.updateSamplingMode(H)}if(x&&R.animations)for(let H=0;H<R.animations.length;H++){const k=R.animations[H],c=(0,U.e)("BABYLON.Animation");c&&x.animations.push(c.Parse(k))}x&&x._texture&&(k&&!c&&x._texture._setUniqueId(R.internalTextureUniqueId),x._texture.label=R.internalTextureLabel)};return b.d.Parse((()=>{let k=!0;if(R.noMipmap&&(k=!1),R.mirrorPlane){const H=C._CreateMirror(R.name,R.renderTargetSize,x,k);return H._waitingRenderList=R.renderList,H.mirrorPlane=g.e.zi(R.mirrorPlane),t(H),H}if(R.isRenderTarget){let H=null;if(R.isCube){if(x.reflectionProbes)for(let k=0;k<x.reflectionProbes.length;k++){const H=x.reflectionProbes[k];if(H.name===R.name)return H.cubeTexture}}else H=C._CreateRenderTargetTexture(R.name,R.renderTargetSize,x,k,R._creationFlags??0),H._waitingRenderList=R.renderList;return t(H),H}if(R.isVideo){const c=C._CreateVideoTexture(H+(R.url||R.name),H+(R.src||R.url),x,k,R.invertY,R.samplingMode,R.settings||{});return t(c),c}{let A;if(R.base64String&&!c)A=C.CreateFromBase64String(R.base64String,R.base64String,x,!k,R.invertY,R.samplingMode,(()=>{t(A)}),R._creationFlags??0,R._useSRGBBuffer??!1),A.name=R.name;else{let D;D=R.name&&(R.name.indexOf("://")>0||R.name.startsWith("data:"))?R.name:H+R.name,R.url&&(R.url.startsWith("data:")||C.UseSerializedUrlIfAny)&&(D=R.url);const U={noMipmap:!k,invertY:R.invertY,samplingMode:R.samplingMode,X:()=>{t(A)},internalTexture:c};A=new C(D,x,U)}return A}}),R,x)}static CreateFromBase64String(R,x,H,k,c){let t=arguments.length>5&&void 0!==arguments[5]?arguments[5]:C.TRILINEAR_SAMPLINGMODE;return new C("data:"+x,H,k,c,t,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,R,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(R,x,H){let k=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4?arguments[4]:void 0,t=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C.TRILINEAR_SAMPLINGMODE,D=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,U=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,J=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,V=arguments.length>10?arguments[10]:void 0,n=arguments.length>11?arguments[11]:void 0;return"data:"!==R.substring(0,5)&&(R="data:"+R),new C(R,H,c,t,A,D,U,x,k,J,void 0,void 0,V,n)}}C.SerializeBuffers=!0,C.ForceSerializeBuffers=!1,C.OnTextureLoadErrorObservable=new t.d,C._SerializeInternalTextureUniqueId=!1,C._CubeTextureParser=(R,x,H)=>{throw(0,J.d)("CubeTexture")},C._CreateMirror=(R,x,H,k)=>{throw(0,J.d)("MirrorTexture")},C._CreateRenderTargetTexture=(R,x,H,k,c)=>{throw(0,J.d)("RenderTargetTexture")},C.NEAREST_SAMPLINGMODE=1,C.NEAREST_NEAREST_MIPLINEAR=8,C.BILINEAR_SAMPLINGMODE=2,C.LINEAR_LINEAR_MIPNEAREST=11,C.TRILINEAR_SAMPLINGMODE=3,C.LINEAR_LINEAR_MIPLINEAR=3,C.NEAREST_NEAREST_MIPNEAREST=4,C.NEAREST_LINEAR_MIPNEAREST=5,C.NEAREST_LINEAR_MIPLINEAR=6,C.NEAREST_LINEAR=7,C.NEAREST_NEAREST=1,C.LINEAR_NEAREST_MIPNEAREST=9,C.LINEAR_NEAREST_MIPLINEAR=10,C.LINEAR_LINEAR=2,C.LINEAR_NEAREST=12,C.EXPLICIT_MODE=0,C.SPHERICAL_MODE=1,C.PLANAR_MODE=2,C.CUBIC_MODE=3,C.PROJECTION_MODE=4,C.SKYBOX_MODE=5,C.INVCUBIC_MODE=6,C.EQUIRECTANGULAR_MODE=7,C.FIXED_EQUIRECTANGULAR_MODE=8,C.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,C.CLAMP_ADDRESSMODE=0,C.WRAP_ADDRESSMODE=1,C.MIRROR_ADDRESSMODE=2,C.UseSerializedUrlIfAny=!1,(0,k.d)([(0,c.Q)()],C.prototype,"url",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"uOffset",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"vOffset",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"uScale",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"vScale",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"uAng",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"vAng",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"wAng",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"uRotationCenter",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"vRotationCenter",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"wRotationCenter",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"homogeneousRotationInUVTransform",void 0),(0,k.d)([(0,c.Q)()],C.prototype,"isBlocking",null),(0,U.h)("BABYLON.Texture",C),b.d._TextureParser=C.Parse},2292:(R,x,H)=>{H.d(x,{d:()=>k});class k{constructor(R,x){this.width=R,this.height=x}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let R=0|this.width;return R=397*R^this.height,R}p(R){this.width=R.width,this.height=R.height}si(R,x){return this.width=R,this.height=x,this}set(R,x){return this.si(R,x)}multiplyByFloats(R,x){return new k(this.width*R,this.height*x)}clone(){return new k(this.width,this.height)}equals(R){return!!R&&(this.width===R.width&&this.height===R.height)}get surface(){return this.width*this.height}static Zero(){return new k(0,0)}add(R){return new k(this.width+R.width,this.height+R.height)}Pg(R){return new k(this.width-R.width,this.height-R.height)}scale(R){return new k(this.width*R,this.height*R)}static Lerp(R,x,H){const c=R.width+(x.width-R.width)*H,t=R.height+(x.height-R.height)*H;return new k(c,t)}}}}]);