"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2342:(n,k,T)=>{T.d(k,{b:()=>W});var c=T(706),K=T(712),Q=T(539),G=T(730),w=T(588),E=T(684),I=(T(591),T(2313));class S{get wrapU(){return this._wrapU}set wrapU(n){this._wrapU=n}get wrapV(){return this._wrapV}set wrapV(n){this._wrapV=n}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(n){this._texture&&(this._texture.isCube=n)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(n){this._texture&&(this._texture.is3D=n)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(n){this._texture&&(this._texture.is2DArray=n)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(n){return void 0!==(null===n||void 0===n?void 0:n.shareDepth)}constructor(n){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=I.e.Zero(),this._cachedBaseSize=I.e.Zero(),this._initialSamplingMode=2,this._texture=S._IsRenderTargetWrapper(n)?n.texture:n,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(n){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(n,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var P=T(760);class W extends S{set Bj(n){this._hasAlpha!==n&&(this._hasAlpha=n,this._scene&&this._scene.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))))}get Bj(){return this._hasAlpha}set getAlphaFromRGB(n){this._getAlphaFromRGB!==n&&(this._getAlphaFromRGB=n,this._scene&&this._scene.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(n){this._coordinatesIndex!==n&&(this._coordinatesIndex=n,this._scene&&this._scene.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(n){this._coordinatesMode!==n&&(this._coordinatesMode=n,this._scene&&this._scene.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(n){this._wrapU=n}get wrapV(){return this._wrapV}set wrapV(n){this._wrapV=n}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(n){this._texture?this._texture.isCube=n:this._isCube=n}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(n){this._texture&&(this._texture.is3D=n)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(n){this._texture&&(this._texture.is2DArray=n)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(n){var k;if(this._texture){if(this._texture._gammaSpace===n)return;this._texture._gammaSpace=n}else{if(this._gammaSpace===n)return;this._gammaSpace=n}null===(k=this.va())||void 0===k||k.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(n){var k;n!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=n),null===(k=this.va())||void 0===k||k.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(n){this._texture&&(this._texture._lodGenerationOffset=n)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(n){this._texture&&(this._texture._lodGenerationScale=n)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(n){this._texture&&(this._texture._linearSpecularLOD=n)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(n){this._texture&&(this._texture._irradianceTexture=n)}get uid(){return this._uid||(this._uid=(0,E.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(n){this._onDisposeObserver&&this.Gi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Gi.add(n)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(n){let k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=W.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Gi=new Q.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,n?W._IsScene(n)?this._scene=n:this._engine=n:this._scene=w.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=k,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return G.d.IdentityReadOnly}getReflectionTextureMatrix(){return G.d.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(n){}get canRescale(){return!1}_getFromCache(n,k,T,c,K,Q){const G=this._getEngine();if(!G)return null;const w=G._getUseSRGBBuffer(!!K,k),E=G.getLoadedTexturesCache();for(let I=0;I<E.length;I++){const G=E[I];if((void 0===K||w===G._useSRGBBuffer)&&(void 0===c||c===G.invertY)&&G.url===n&&G.generateMipMaps===!k&&(!T||T===G.samplingMode)&&(void 0===Q||Q===G.isCube))return G.incrementReferences(),G}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const n=this.va();n&&n.markAllMaterialsAsDirty(1)}readPixels(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],K=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,w=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,E=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const I=this._getEngine();if(!I)return null;const S=this.getSize();let P=S.width,W=S.height;0!==k&&(P/=Math.pow(2,k),W/=Math.pow(2,k),P=Math.round(P),W=Math.round(W)),w=Math.min(P,w),E=Math.min(W,E);try{return this._texture.isCube?I._readTexturePixels(this._texture,w,E,n,k,T,c,K,Q,G):I._readTexturePixels(this._texture,w,E,-1,k,T,c,K,Q,G)}catch(J){return null}}_readPixelsSync(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],K=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const Q=this.getSize();let G=Q.width,w=Q.height;const E=this._getEngine();if(!E)return null;0!=k&&(G/=Math.pow(2,k),w/=Math.pow(2,k),G=Math.round(G),w=Math.round(w));try{return this._texture.isCube?E._readTexturePixelsSync(this._texture,G,w,n,k,T,c,K):E._readTexturePixelsSync(this._texture,G,w,-1,k,T,c,K)}catch(I){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const n=this._scene.textures.indexOf(this);if(n>=0&&this._scene.textures.splice(n,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const n=this._parentContainer.textures.indexOf(this);n>-1&&this._parentContainer.textures.splice(n,1),this._parentContainer=null}}this.Gi.notifyObservers(this),this.Gi.clear(),this.metadata=null,super.dispose()}serialize(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!n)return null;const k=P.d.Serialize(this);return P.d.AppendSerializedAnimations(this,k),k}static WhenAllReady(n,k){let T=n.length;if(0!==T)for(let c=0;c<n.length;c++){const K=n[c];if(K.isReady())0===--T&&k();else{const n=K.onLoadObservable;n?n.addOnce((()=>{0===--T&&k()})):0===--T&&k()}}else k()}static _IsScene(n){return"Scene"===n.getClassName()}}W.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,c.e)([(0,K.K)()],W.prototype,"uniqueId",void 0),(0,c.e)([(0,K.K)()],W.prototype,"name",void 0),(0,c.e)([(0,K.K)()],W.prototype,"displayName",void 0),(0,c.e)([(0,K.K)()],W.prototype,"metadata",void 0),(0,c.e)([(0,K.K)("Bj")],W.prototype,"_hasAlpha",void 0),(0,c.e)([(0,K.K)("getAlphaFromRGB")],W.prototype,"_getAlphaFromRGB",void 0),(0,c.e)([(0,K.K)()],W.prototype,"level",void 0),(0,c.e)([(0,K.K)("coordinatesIndex")],W.prototype,"_coordinatesIndex",void 0),(0,c.e)([(0,K.K)()],W.prototype,"optimizeUVAllocation",void 0),(0,c.e)([(0,K.K)("coordinatesMode")],W.prototype,"_coordinatesMode",void 0),(0,c.e)([(0,K.K)()],W.prototype,"wrapU",null),(0,c.e)([(0,K.K)()],W.prototype,"wrapV",null),(0,c.e)([(0,K.K)()],W.prototype,"wrapR",void 0),(0,c.e)([(0,K.K)()],W.prototype,"anisotropicFilteringLevel",void 0),(0,c.e)([(0,K.K)()],W.prototype,"isCube",null),(0,c.e)([(0,K.K)()],W.prototype,"is3D",null),(0,c.e)([(0,K.K)()],W.prototype,"is2DArray",null),(0,c.e)([(0,K.K)()],W.prototype,"gammaSpace",null),(0,c.e)([(0,K.K)()],W.prototype,"invertZ",void 0),(0,c.e)([(0,K.K)()],W.prototype,"lodLevelInAlpha",void 0),(0,c.e)([(0,K.K)()],W.prototype,"lodGenerationOffset",null),(0,c.e)([(0,K.K)()],W.prototype,"lodGenerationScale",null),(0,c.e)([(0,K.K)()],W.prototype,"linearSpecularLOD",null),(0,c.e)([(0,K.D)()],W.prototype,"irradianceTexture",null),(0,c.e)([(0,K.K)()],W.prototype,"isRenderTarget",void 0)},2334:(n,k,T)=>{T.d(k,{b:()=>r});var c=T(706),K=T(712),Q=T(539),G=T(730),w=T(2342),E=T(675),I=T(576),S=T(610),P=T(666),W=T(775),J=T(598);function H(n,k){let T=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const c=k.width,K=k.height;if(n instanceof Float32Array){let k=n.byteLength/n.BYTES_PER_ELEMENT;const T=new Uint8Array(k);for(;--k>=0;){let c=n[k];c<0?c=0:c>1&&(c=1),T[k]=255*c}n=T}const Q=document.createElement("canvas");Q.width=c,Q.height=K;const G=Q.getContext("2d");if(!G)return null;const w=G.createImageData(c,K);if(w.data.set(n),G.putImageData(w,0,0),T){const n=document.createElement("canvas");n.width=c,n.height=K;const k=n.getContext("2d");return k?(k.translate(0,K),k.scale(1,-1),k.drawImage(Q,0,0),n.toDataURL("image/png")):null}return Q.toDataURL("image/png")}function s(n){let k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=n.getInternalTexture();if(!c)return null;const K=n._readPixelsSync(k,T);return K?H(K,n.getSize(),c.invertY):null}async function b(n){let k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=n.getInternalTexture();if(!c)return null;const K=await n.readPixels(k,T);return K?H(K,n.getSize(),c.invertY):null}var C=T(871),z=T(760);class r extends w.b{static _CreateVideoTexture(n,k,T){arguments.length>5&&void 0!==arguments[5]||r.TRILINEAR_SAMPLINGMODE;throw(0,I.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(n){this._isBlocking=n}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(n,k,T,c){let K,G=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.TRILINEAR_SAMPLINGMODE,w=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,E=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,I=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,P=arguments.length>8&&void 0!==arguments[8]&&arguments[8],W=arguments.length>9?arguments[9]:void 0,J=arguments.length>10?arguments[10]:void 0,H=arguments.length>11?arguments[11]:void 0,s=arguments.length>12?arguments[12]:void 0,b=arguments.length>13?arguments[13]:void 0;super(k),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new Q.b,this._isBlocking=!0,this.name=n||"",this.url=n;let z=!1,q=null,O=!0;"object"===typeof T&&null!==T?(K=T.noMipmap??!1,c=T.invertY??!C.e,G=T.samplingMode??r.TRILINEAR_SAMPLINGMODE,w=T.X??null,E=T.onError??null,I=T.buffer??null,P=T.deleteBuffer??!1,W=T.format,J=T.mimeType,H=T.loaderOptions,s=T.creationFlags,z=T.useSRGBBuffer??!1,q=T.internalTexture??null,O=T.gammaSpace??O,b=T.forcedExtension??b):K=!!T,this._gammaSpace=O,this._noMipmap=K,this._invertY=void 0===c?!C.e:c,this._initialSamplingMode=G,this._buffer=I,this._deleteBuffer=P,this._mimeType=J,this._loaderOptions=H,this._creationFlags=s,this._useSRGBBuffer=z,this._forcedExtension=b,void 0!==W&&(this._format=W);const u=this.va(),f=this._getEngine();if(!f)return;f.onBeforeTextureInitObservable.notifyObservers(this);const A=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),w&&w(),!this.isBlocking&&u&&u.resetCachedMaterial()},v=(n,k)=>{this._loadingError=!0,this._errorObject={message:n,exception:k},E&&E(n,k),r.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!q)return this._delayedOnLoad=A,void(this._delayedOnError=v);if(this._texture=q??this._getFromCache(this.url,K,G,this._invertY,z,this.isCube),this._texture)if(this._texture.isReady)S.d.SetImmediate((()=>A()));else{const n=this._texture.onLoadedObservable.add(A);this._texture.onErrorObservable.add((k=>{var T;v(k.message,k.exception),null===(T=this._texture)||void 0===T||T.onLoadedObservable.remove(n)}))}else if(u&&u.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=A,this._delayedOnError=v;else{try{this._texture=f.createTexture(this.url,K,this._invertY,u,G,A,v,this._buffer,void 0,this._format,this._forcedExtension,J,H,s,z)}catch(F){throw v("error loading",F),F}P&&(this._buffer=null)}}updateURL(n){let k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,T=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(n=>n.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=n),this.url=n,this._buffer=k,this._forcedExtension=c,this.delayLoadState=4,T&&(this._delayedOnLoad=T),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const n=this.va();n&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?S.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=n.getEngine().createTexture(this.url,this._noMipmap,this._invertY,n,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(n,k,T,c){n*=this._cachedUScale,k*=this._cachedVScale,n-=this.uRotationCenter*this._cachedUScale,k-=this.vRotationCenter*this._cachedVScale,T-=this.wRotationCenter,G.o.TransformCoordinatesFromFloatsToRef(n,k,T,this._rowGenerationMatrix,c),c.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,c.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,c.z+=this.wRotationCenter}getTextureMatrix(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*n===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*n,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=G.d.Zero(),this._rowGenerationMatrix=new G.d,this._t0=G.o.Zero(),this._t1=G.o.Zero(),this._t2=G.o.Zero()),G.d.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(G.d.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,G.l.Matrix[0]),G.d.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,G.l.Matrix[1]),G.d.ScalingToRef(this._cachedUScale,this._cachedVScale,0,G.l.Matrix[2]),G.d.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,G.l.Matrix[3]),G.l.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(G.l.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(G.l.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(G.l.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Oi(this._t0),this._t2.Oi(this._t0),G.d.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const k=this.va();if(!k)return this._cachedTextureMatrix;const T=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&T!==this._cachedIdentity3x2&&k.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const n=this.va();if(!n)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==r.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===n.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=G.d.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=G.d.Zero());const k=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case r.PLANAR_MODE:G.d.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case r.PROJECTION_MODE:{G.d.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const k=n.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=k.updateFlag,k.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:G.d.IdentityToRef(this._cachedReflectionTextureMatrix)}return k&&n.markAllMaterialsAsDirty(1,(n=>n.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const n={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return z.d.Clone((()=>new r(this._texture?this._texture.url:null,this.va(),n)),this)}serialize(){var n;const k=this.name;r.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const T=super.serialize(r._SerializeInternalTextureUniqueId);if(!T)return null;if(r.SerializeBuffers||r.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))T.base64String=this._buffer,T.name=T.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const n=this.mimeType||"image/png";T.base64String=`data:${n};base64,${(0,J.j)(this._buffer)}`}else(r.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(T.base64String=!this._engine||this._engine._features.supportSyncTextureRead?s(this):b(this));var c;(T.invertY=this._invertY,T.samplingMode=this.samplingMode,T._creationFlags=this._creationFlags,T._useSRGBBuffer=this._useSRGBBuffer,r._SerializeInternalTextureUniqueId)&&(T.internalTextureUniqueId=null===(c=this._texture)||void 0===c?void 0:c.uniqueId);return T.internalTextureLabel=null===(n=this._texture)||void 0===n?void 0:n.label,T.noMipmap=this._noMipmap,this.name=k,T}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(n,k,T){if(n.customType){const c=P.b.Instantiate(n.customType).Parse(n,k,T);return n.samplingMode&&c.updateSamplingMode&&c._samplingMode&&c._samplingMode!==n.samplingMode&&c.updateSamplingMode(n.samplingMode),c}if(n.isCube&&!n.isRenderTarget)return r._CubeTextureParser(n,k,T);const c=void 0!==n.internalTextureUniqueId;if(!n.name&&!n.isRenderTarget&&!c)return null;let K;if(c){const T=k.getEngine().getLoadedTexturesCache();for(const k of T)if(k.uniqueId===n.internalTextureUniqueId){K=k;break}}const Q=k=>{if(k&&k._texture&&(k._texture._cachedWrapU=null,k._texture._cachedWrapV=null,k._texture._cachedWrapR=null),n.samplingMode){const T=n.samplingMode;k&&k.samplingMode!==T&&k.updateSamplingMode(T)}if(k&&n.animations)for(let T=0;T<n.animations.length;T++){const c=n.animations[T],K=(0,E.b)("BABYLON.Animation");K&&k.animations.push(K.Parse(c))}k&&k._texture&&(c&&!K&&k._texture._setUniqueId(n.internalTextureUniqueId),k._texture.label=n.internalTextureLabel)};return z.d.Parse((()=>{let c=!0;if(n.noMipmap&&(c=!1),n.mirrorPlane){const T=r._CreateMirror(n.name,n.renderTargetSize,k,c);return T._waitingRenderList=n.renderList,T.mirrorPlane=W.c.ji(n.mirrorPlane),Q(T),T}if(n.isRenderTarget){let T=null;if(n.isCube){if(k.reflectionProbes)for(let c=0;c<k.reflectionProbes.length;c++){const T=k.reflectionProbes[c];if(T.name===n.name)return T.cubeTexture}}else T=r._CreateRenderTargetTexture(n.name,n.renderTargetSize,k,c,n._creationFlags??0),T._waitingRenderList=n.renderList;return Q(T),T}if(n.isVideo){const K=r._CreateVideoTexture(T+(n.url||n.name),T+(n.src||n.url),k,c,n.invertY,n.samplingMode,n.settings||{});return Q(K),K}{let G;if(n.base64String&&!K)G=r.CreateFromBase64String(n.base64String,n.base64String,k,!c,n.invertY,n.samplingMode,(()=>{Q(G)}),n._creationFlags??0,n._useSRGBBuffer??!1),G.name=n.name;else{let w;w=n.name&&(n.name.indexOf("://")>0||n.name.startsWith("data:"))?n.name:T+n.name,n.url&&(n.url.startsWith("data:")||r.UseSerializedUrlIfAny)&&(w=n.url);const E={noMipmap:!c,invertY:n.invertY,samplingMode:n.samplingMode,X:()=>{Q(G)},internalTexture:K};G=new r(w,k,E)}return G}}),n,k)}static CreateFromBase64String(n,k,T,c,K){let Q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r.TRILINEAR_SAMPLINGMODE;return new r("data:"+k,T,c,K,Q,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,n,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(n,k,T){let c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],K=arguments.length>4?arguments[4]:void 0,Q=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],G=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r.TRILINEAR_SAMPLINGMODE,w=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,E=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,I=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,S=arguments.length>10?arguments[10]:void 0,P=arguments.length>11?arguments[11]:void 0;return"data:"!==n.substring(0,5)&&(n="data:"+n),new r(n,T,K,Q,G,w,E,k,c,I,void 0,void 0,S,P)}}r.SerializeBuffers=!0,r.ForceSerializeBuffers=!1,r.OnTextureLoadErrorObservable=new Q.b,r._SerializeInternalTextureUniqueId=!1,r._CubeTextureParser=(n,k,T)=>{throw(0,I.e)("CubeTexture")},r._CreateMirror=(n,k,T,c)=>{throw(0,I.e)("MirrorTexture")},r._CreateRenderTargetTexture=(n,k,T,c,K)=>{throw(0,I.e)("RenderTargetTexture")},r.NEAREST_SAMPLINGMODE=1,r.NEAREST_NEAREST_MIPLINEAR=8,r.BILINEAR_SAMPLINGMODE=2,r.LINEAR_LINEAR_MIPNEAREST=11,r.TRILINEAR_SAMPLINGMODE=3,r.LINEAR_LINEAR_MIPLINEAR=3,r.NEAREST_NEAREST_MIPNEAREST=4,r.NEAREST_LINEAR_MIPNEAREST=5,r.NEAREST_LINEAR_MIPLINEAR=6,r.NEAREST_LINEAR=7,r.NEAREST_NEAREST=1,r.LINEAR_NEAREST_MIPNEAREST=9,r.LINEAR_NEAREST_MIPLINEAR=10,r.LINEAR_LINEAR=2,r.LINEAR_NEAREST=12,r.EXPLICIT_MODE=0,r.SPHERICAL_MODE=1,r.PLANAR_MODE=2,r.CUBIC_MODE=3,r.PROJECTION_MODE=4,r.SKYBOX_MODE=5,r.INVCUBIC_MODE=6,r.EQUIRECTANGULAR_MODE=7,r.FIXED_EQUIRECTANGULAR_MODE=8,r.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,r.CLAMP_ADDRESSMODE=0,r.WRAP_ADDRESSMODE=1,r.MIRROR_ADDRESSMODE=2,r.UseSerializedUrlIfAny=!1,(0,c.e)([(0,K.K)()],r.prototype,"url",void 0),(0,c.e)([(0,K.K)()],r.prototype,"uOffset",void 0),(0,c.e)([(0,K.K)()],r.prototype,"vOffset",void 0),(0,c.e)([(0,K.K)()],r.prototype,"uScale",void 0),(0,c.e)([(0,K.K)()],r.prototype,"vScale",void 0),(0,c.e)([(0,K.K)()],r.prototype,"uAng",void 0),(0,c.e)([(0,K.K)()],r.prototype,"vAng",void 0),(0,c.e)([(0,K.K)()],r.prototype,"wAng",void 0),(0,c.e)([(0,K.K)()],r.prototype,"uRotationCenter",void 0),(0,c.e)([(0,K.K)()],r.prototype,"vRotationCenter",void 0),(0,c.e)([(0,K.K)()],r.prototype,"wRotationCenter",void 0),(0,c.e)([(0,K.K)()],r.prototype,"homogeneousRotationInUVTransform",void 0),(0,c.e)([(0,K.K)()],r.prototype,"isBlocking",null),(0,E.f)("BABYLON.Texture",r),z.d._TextureParser=r.Parse},2313:(n,k,T)=>{T.d(k,{e:()=>c});class c{constructor(n,k){this.width=n,this.height=k}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let n=0|this.width;return n=397*n^this.height,n}p(n){this.width=n.width,this.height=n.height}di(n,k){return this.width=n,this.height=k,this}set(n,k){return this.di(n,k)}multiplyByFloats(n,k){return new c(this.width*n,this.height*k)}clone(){return new c(this.width,this.height)}equals(n){return!!n&&(this.width===n.width&&this.height===n.height)}get surface(){return this.width*this.height}static Zero(){return new c(0,0)}add(n){return new c(this.width+n.width,this.height+n.height)}Fg(n){return new c(this.width-n.width,this.height-n.height)}scale(n){return new c(this.width*n,this.height*n)}static Lerp(n,k,T){const K=n.width+(k.width-n.width)*T,Q=n.height+(k.height-n.height)*T;return new c(K,Q)}}}}]);