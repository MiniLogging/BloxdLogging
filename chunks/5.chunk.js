"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2404:(Q,X,C)=>{C.d(X,{d:()=>w});var l=C(644),h=C(650),M=C(482),f=C(668),O=C(524),m=C(627),W=(C(526),C(2374));class U{get wrapU(){return this._wrapU}set wrapU(Q){this._wrapU=Q}get wrapV(){return this._wrapV}set wrapV(Q){this._wrapV=Q}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(Q){this._texture&&(this._texture.isCube=Q)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Q){this._texture&&(this._texture.is3D=Q)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Q){this._texture&&(this._texture.is2DArray=Q)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(Q){return void 0!==(null===Q||void 0===Q?void 0:Q.shareDepth)}constructor(Q){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=W.d.Zero(),this._cachedBaseSize=W.d.Zero(),this._initialSamplingMode=2,this._texture=U._IsRenderTargetWrapper(Q)?Q.texture:Q,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(Q){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(Q,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var L=C(695);class w extends U{set mi(Q){this._hasAlpha!==Q&&(this._hasAlpha=Q,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))))}get mi(){return this._hasAlpha}set getAlphaFromRGB(Q){this._getAlphaFromRGB!==Q&&(this._getAlphaFromRGB=Q,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(Q){this._coordinatesIndex!==Q&&(this._coordinatesIndex=Q,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(Q){this._coordinatesMode!==Q&&(this._coordinatesMode=Q,this._scene&&this._scene.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(Q){this._wrapU=Q}get wrapV(){return this._wrapV}set wrapV(Q){this._wrapV=Q}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(Q){this._texture?this._texture.isCube=Q:this._isCube=Q}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(Q){this._texture&&(this._texture.is3D=Q)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(Q){this._texture&&(this._texture.is2DArray=Q)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(Q){var X;if(this._texture){if(this._texture._gammaSpace===Q)return;this._texture._gammaSpace=Q}else{if(this._gammaSpace===Q)return;this._gammaSpace=Q}null===(X=this.va())||void 0===X||X.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(Q){var X;Q!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=Q),null===(X=this.va())||void 0===X||X.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(Q){this._texture&&(this._texture._lodGenerationOffset=Q)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(Q){this._texture&&(this._texture._lodGenerationScale=Q)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(Q){this._texture&&(this._texture._linearSpecularLOD=Q)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(Q){this._texture&&(this._texture._irradianceTexture=Q)}get uid(){return this._uid||(this._uid=(0,m.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(Q){this._onDisposeObserver&&this.bk.remove(this._onDisposeObserver),this._onDisposeObserver=this.bk.add(Q)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(Q){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=w.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.bk=new M.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,Q?w._IsScene(Q)?this._scene=Q:this._engine=Q:this._scene=O.b.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=X,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return f.b.IdentityReadOnly}getReflectionTextureMatrix(){return f.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(Q){}get canRescale(){return!1}_getFromCache(Q,X,C,l,h,M){const f=this._getEngine();if(!f)return null;const O=f._getUseSRGBBuffer(!!h,X),m=f.getLoadedTexturesCache();for(let W=0;W<m.length;W++){const f=m[W];if((void 0===h||O===f._useSRGBBuffer)&&(void 0===l||l===f.invertY)&&f.url===Q&&f.generateMipMaps===!X&&(!C||C===f.samplingMode)&&(void 0===M||M===f.isCube))return f.incrementReferences(),f}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const Q=this.va();Q&&Q.markAllMaterialsAsDirty(1)}readPixels(){let Q=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4],M=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,O=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const W=this._getEngine();if(!W)return null;const U=this.getSize();let L=U.width,w=U.height;0!==X&&(L/=Math.pow(2,X),w/=Math.pow(2,X),L=Math.round(L),w=Math.round(w)),O=Math.min(L,O),m=Math.min(w,m);try{return this._texture.isCube?W._readTexturePixels(this._texture,O,m,Q,X,C,l,h,M,f):W._readTexturePixels(this._texture,O,m,-1,X,C,l,h,M,f)}catch(i){return null}}_readPixelsSync(){let Q=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const M=this.getSize();let f=M.width,O=M.height;const m=this._getEngine();if(!m)return null;0!=X&&(f/=Math.pow(2,X),O/=Math.pow(2,X),f=Math.round(f),O=Math.round(O));try{return this._texture.isCube?m._readTexturePixelsSync(this._texture,f,O,Q,X,C,l,h):m._readTexturePixelsSync(this._texture,f,O,-1,X,C,l,h)}catch(W){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const Q=this._scene.textures.indexOf(this);if(Q>=0&&this._scene.textures.splice(Q,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const Q=this._parentContainer.textures.indexOf(this);Q>-1&&this._parentContainer.textures.splice(Q,1),this._parentContainer=null}}this.bk.notifyObservers(this),this.bk.clear(),this.metadata=null,super.dispose()}serialize(){let Q=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!Q)return null;const X=L.d.Serialize(this);return L.d.AppendSerializedAnimations(this,X),X}static WhenAllReady(Q,X){let C=Q.length;if(0!==C)for(let l=0;l<Q.length;l++){const h=Q[l];if(h.isReady())0===--C&&X();else{const Q=h.onLoadObservable;Q?Q.addOnce((()=>{0===--C&&X()})):0===--C&&X()}}else X()}static _IsScene(Q){return"Scene"===Q.getClassName()}}w.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,l.c)([(0,h.N)()],w.prototype,"uniqueId",void 0),(0,l.c)([(0,h.N)()],w.prototype,"name",void 0),(0,l.c)([(0,h.N)()],w.prototype,"displayName",void 0),(0,l.c)([(0,h.N)()],w.prototype,"metadata",void 0),(0,l.c)([(0,h.N)("mi")],w.prototype,"_hasAlpha",void 0),(0,l.c)([(0,h.N)("getAlphaFromRGB")],w.prototype,"_getAlphaFromRGB",void 0),(0,l.c)([(0,h.N)()],w.prototype,"level",void 0),(0,l.c)([(0,h.N)("coordinatesIndex")],w.prototype,"_coordinatesIndex",void 0),(0,l.c)([(0,h.N)()],w.prototype,"optimizeUVAllocation",void 0),(0,l.c)([(0,h.N)("coordinatesMode")],w.prototype,"_coordinatesMode",void 0),(0,l.c)([(0,h.N)()],w.prototype,"wrapU",null),(0,l.c)([(0,h.N)()],w.prototype,"wrapV",null),(0,l.c)([(0,h.N)()],w.prototype,"wrapR",void 0),(0,l.c)([(0,h.N)()],w.prototype,"anisotropicFilteringLevel",void 0),(0,l.c)([(0,h.N)()],w.prototype,"isCube",null),(0,l.c)([(0,h.N)()],w.prototype,"is3D",null),(0,l.c)([(0,h.N)()],w.prototype,"is2DArray",null),(0,l.c)([(0,h.N)()],w.prototype,"gammaSpace",null),(0,l.c)([(0,h.N)()],w.prototype,"invertZ",void 0),(0,l.c)([(0,h.N)()],w.prototype,"lodLevelInAlpha",void 0),(0,l.c)([(0,h.N)()],w.prototype,"lodGenerationOffset",null),(0,l.c)([(0,h.N)()],w.prototype,"lodGenerationScale",null),(0,l.c)([(0,h.N)()],w.prototype,"linearSpecularLOD",null),(0,l.c)([(0,h.G)()],w.prototype,"irradianceTexture",null),(0,l.c)([(0,h.N)()],w.prototype,"isRenderTarget",void 0)},2397:(Q,X,C)=>{C.d(X,{e:()=>r});var l=C(644),h=C(650),M=C(482),f=C(668),O=C(2404),m=C(620),W=C(509),U=C(550),L=C(612),w=C(719),i=C(537);function a(Q,X){let C=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=X.width,h=X.height;if(Q instanceof Float32Array){let X=Q.byteLength/Q.BYTES_PER_ELEMENT;const C=new Uint8Array(X);for(;--X>=0;){let l=Q[X];l<0?l=0:l>1&&(l=1),C[X]=255*l}Q=C}const M=document.createElement("canvas");M.width=l,M.height=h;const f=M.getContext("2d");if(!f)return null;const O=f.createImageData(l,h);if(O.data.set(Q),f.putImageData(O,0,0),C){const Q=document.createElement("canvas");Q.width=l,Q.height=h;const X=Q.getContext("2d");return X?(X.translate(0,h),X.scale(1,-1),X.drawImage(M,0,0),Q.toDataURL("image/png")):null}return M.toDataURL("image/png")}function F(Q){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=Q.getInternalTexture();if(!l)return null;const h=Q._readPixelsSync(X,C);return h?a(h,Q.getSize(),l.invertY):null}async function s(Q){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=Q.getInternalTexture();if(!l)return null;const h=await Q.readPixels(X,C);return h?a(h,Q.getSize(),l.invertY):null}var z=C(795),x=C(695);class r extends O.d{static _CreateVideoTexture(Q,X,C){arguments.length>5&&void 0!==arguments[5]||r.TRILINEAR_SAMPLINGMODE;throw(0,W.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(Q){this._isBlocking=Q}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(Q,X,C,l){let h,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.TRILINEAR_SAMPLINGMODE,O=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,m=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,W=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L=arguments.length>8&&void 0!==arguments[8]&&arguments[8],w=arguments.length>9?arguments[9]:void 0,i=arguments.length>10?arguments[10]:void 0,a=arguments.length>11?arguments[11]:void 0,F=arguments.length>12?arguments[12]:void 0,s=arguments.length>13?arguments[13]:void 0;super(X),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new M.e,this._isBlocking=!0,this.name=Q||"",this.url=Q;let x=!1,P=null,j=!0;"object"===typeof C&&null!==C?(h=C.noMipmap??!1,l=C.invertY??!z.b,f=C.samplingMode??r.TRILINEAR_SAMPLINGMODE,O=C.X??null,m=C.onError??null,W=C.buffer??null,L=C.deleteBuffer??!1,w=C.format,i=C.mimeType,a=C.loaderOptions,F=C.creationFlags,x=C.useSRGBBuffer??!1,P=C.internalTexture??null,j=C.gammaSpace??j,s=C.forcedExtension??s):h=!!C,this._gammaSpace=j,this._noMipmap=h,this._invertY=void 0===l?!z.b:l,this._initialSamplingMode=f,this._buffer=W,this._deleteBuffer=L,this._mimeType=i,this._loaderOptions=a,this._creationFlags=F,this._useSRGBBuffer=x,this._forcedExtension=s,void 0!==w&&(this._format=w);const v=this.va(),Z=this._getEngine();if(!Z)return;Z.onBeforeTextureInitObservable.notifyObservers(this);const g=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),O&&O(),!this.isBlocking&&v&&v.resetCachedMaterial()},S=(Q,X)=>{this._loadingError=!0,this._errorObject={message:Q,exception:X},m&&m(Q,X),r.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!P)return this._delayedOnLoad=g,void(this._delayedOnError=S);if(this._texture=P??this._getFromCache(this.url,h,f,this._invertY,x,this.isCube),this._texture)if(this._texture.isReady)U.c.SetImmediate((()=>g()));else{const Q=this._texture.onLoadedObservable.add(g);this._texture.onErrorObservable.add((X=>{var C;S(X.message,X.exception),null===(C=this._texture)||void 0===C||C.onLoadedObservable.remove(Q)}))}else if(v&&v.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=g,this._delayedOnError=S;else{try{this._texture=Z.createTexture(this.url,h,this._invertY,v,f,g,S,this._buffer,void 0,this._format,this._forcedExtension,i,a,F,x)}catch(e){throw S("error loading",e),e}L&&(this._buffer=null)}}updateURL(Q){let X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,C=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=Q),this.url=Q,this._buffer=X,this._forcedExtension=l,this.delayLoadState=4,C&&(this._delayedOnLoad=C),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const Q=this.va();Q&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?U.c.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=Q.getEngine().createTexture(this.url,this._noMipmap,this._invertY,Q,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(Q,X,C,l){Q*=this._cachedUScale,X*=this._cachedVScale,Q-=this.uRotationCenter*this._cachedUScale,X-=this.vRotationCenter*this._cachedVScale,C-=this.wRotationCenter,f.k.TransformCoordinatesFromFloatsToRef(Q,X,C,this._rowGenerationMatrix,l),l.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,l.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,l.z+=this.wRotationCenter}getTextureMatrix(){let Q=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*Q===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*Q,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=f.b.Zero(),this._rowGenerationMatrix=new f.b,this._t0=f.k.Zero(),this._t1=f.k.Zero(),this._t2=f.k.Zero()),f.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(f.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,f.e.Matrix[0]),f.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,f.e.Matrix[1]),f.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,f.e.Matrix[2]),f.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,f.e.Matrix[3]),f.e.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.e.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.e.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(f.e.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.$j(this._t0),this._t2.$j(this._t0),f.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const X=this.va();if(!X)return this._cachedTextureMatrix;const C=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&C!==this._cachedIdentity3x2&&X.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const Q=this.va();if(!Q)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==r.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===Q.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=f.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=f.b.Zero());const X=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case r.PLANAR_MODE:f.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case r.PROJECTION_MODE:{f.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const X=Q.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=X.updateFlag,X.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:f.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return X&&Q.markAllMaterialsAsDirty(1,(Q=>Q.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const Q={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return x.d.Clone((()=>new r(this._texture?this._texture.url:null,this.va(),Q)),this)}serialize(){var Q;const X=this.name;r.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const C=super.serialize(r._SerializeInternalTextureUniqueId);if(!C)return null;if(r.SerializeBuffers||r.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))C.base64String=this._buffer,C.name=C.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const Q=this.mimeType||"image/png";C.base64String=`data:${Q};base64,${(0,i.l)(this._buffer)}`}else(r.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(C.base64String=!this._engine||this._engine._features.supportSyncTextureRead?F(this):s(this));var l;(C.invertY=this._invertY,C.samplingMode=this.samplingMode,C._creationFlags=this._creationFlags,C._useSRGBBuffer=this._useSRGBBuffer,r._SerializeInternalTextureUniqueId)&&(C.internalTextureUniqueId=null===(l=this._texture)||void 0===l?void 0:l.uniqueId);return C.internalTextureLabel=null===(Q=this._texture)||void 0===Q?void 0:Q.label,C.noMipmap=this._noMipmap,this.name=X,C}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(Q,X,C){if(Q.customType){const l=L.c.Instantiate(Q.customType).Parse(Q,X,C);return Q.samplingMode&&l.updateSamplingMode&&l._samplingMode&&l._samplingMode!==Q.samplingMode&&l.updateSamplingMode(Q.samplingMode),l}if(Q.isCube&&!Q.isRenderTarget)return r._CubeTextureParser(Q,X,C);const l=void 0!==Q.internalTextureUniqueId;if(!Q.name&&!Q.isRenderTarget&&!l)return null;let h;if(l){const C=X.getEngine().getLoadedTexturesCache();for(const X of C)if(X.uniqueId===Q.internalTextureUniqueId){h=X;break}}const M=X=>{if(X&&X._texture&&(X._texture._cachedWrapU=null,X._texture._cachedWrapV=null,X._texture._cachedWrapR=null),Q.samplingMode){const C=Q.samplingMode;X&&X.samplingMode!==C&&X.updateSamplingMode(C)}if(X&&Q.animations)for(let C=0;C<Q.animations.length;C++){const l=Q.animations[C],h=(0,m.e)("BABYLON.Animation");h&&X.animations.push(h.Parse(l))}X&&X._texture&&(l&&!h&&X._texture._setUniqueId(Q.internalTextureUniqueId),X._texture.label=Q.internalTextureLabel)};return x.d.Parse((()=>{let l=!0;if(Q.noMipmap&&(l=!1),Q.mirrorPlane){const C=r._CreateMirror(Q.name,Q.renderTargetSize,X,l);return C._waitingRenderList=Q.renderList,C.mirrorPlane=w.b.Wj(Q.mirrorPlane),M(C),C}if(Q.isRenderTarget){let C=null;if(Q.isCube){if(X.reflectionProbes)for(let l=0;l<X.reflectionProbes.length;l++){const C=X.reflectionProbes[l];if(C.name===Q.name)return C.cubeTexture}}else C=r._CreateRenderTargetTexture(Q.name,Q.renderTargetSize,X,l,Q._creationFlags??0),C._waitingRenderList=Q.renderList;return M(C),C}if(Q.isVideo){const h=r._CreateVideoTexture(C+(Q.url||Q.name),C+(Q.src||Q.url),X,l,Q.invertY,Q.samplingMode,Q.settings||{});return M(h),h}{let f;if(Q.base64String&&!h)f=r.CreateFromBase64String(Q.base64String,Q.base64String,X,!l,Q.invertY,Q.samplingMode,(()=>{M(f)}),Q._creationFlags??0,Q._useSRGBBuffer??!1),f.name=Q.name;else{let O;O=Q.name&&(Q.name.indexOf("://")>0||Q.name.startsWith("data:"))?Q.name:C+Q.name,Q.url&&(Q.url.startsWith("data:")||r.UseSerializedUrlIfAny)&&(O=Q.url);const m={noMipmap:!l,invertY:Q.invertY,samplingMode:Q.samplingMode,X:()=>{M(f)},internalTexture:h};f=new r(O,X,m)}return f}}),Q,X)}static CreateFromBase64String(Q,X,C,l,h){let M=arguments.length>5&&void 0!==arguments[5]?arguments[5]:r.TRILINEAR_SAMPLINGMODE;return new r("data:"+X,C,l,h,M,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Q,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(Q,X,C){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],h=arguments.length>4?arguments[4]:void 0,M=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:r.TRILINEAR_SAMPLINGMODE,O=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,W=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,U=arguments.length>10?arguments[10]:void 0,L=arguments.length>11?arguments[11]:void 0;return"data:"!==Q.substring(0,5)&&(Q="data:"+Q),new r(Q,C,h,M,f,O,m,X,l,W,void 0,void 0,U,L)}}r.SerializeBuffers=!0,r.ForceSerializeBuffers=!1,r.OnTextureLoadErrorObservable=new M.e,r._SerializeInternalTextureUniqueId=!1,r._CubeTextureParser=(Q,X,C)=>{throw(0,W.c)("CubeTexture")},r._CreateMirror=(Q,X,C,l)=>{throw(0,W.c)("MirrorTexture")},r._CreateRenderTargetTexture=(Q,X,C,l,h)=>{throw(0,W.c)("RenderTargetTexture")},r.NEAREST_SAMPLINGMODE=1,r.NEAREST_NEAREST_MIPLINEAR=8,r.BILINEAR_SAMPLINGMODE=2,r.LINEAR_LINEAR_MIPNEAREST=11,r.TRILINEAR_SAMPLINGMODE=3,r.LINEAR_LINEAR_MIPLINEAR=3,r.NEAREST_NEAREST_MIPNEAREST=4,r.NEAREST_LINEAR_MIPNEAREST=5,r.NEAREST_LINEAR_MIPLINEAR=6,r.NEAREST_LINEAR=7,r.NEAREST_NEAREST=1,r.LINEAR_NEAREST_MIPNEAREST=9,r.LINEAR_NEAREST_MIPLINEAR=10,r.LINEAR_LINEAR=2,r.LINEAR_NEAREST=12,r.EXPLICIT_MODE=0,r.SPHERICAL_MODE=1,r.PLANAR_MODE=2,r.CUBIC_MODE=3,r.PROJECTION_MODE=4,r.SKYBOX_MODE=5,r.INVCUBIC_MODE=6,r.EQUIRECTANGULAR_MODE=7,r.FIXED_EQUIRECTANGULAR_MODE=8,r.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,r.CLAMP_ADDRESSMODE=0,r.WRAP_ADDRESSMODE=1,r.MIRROR_ADDRESSMODE=2,r.UseSerializedUrlIfAny=!1,(0,l.c)([(0,h.N)()],r.prototype,"url",void 0),(0,l.c)([(0,h.N)()],r.prototype,"uOffset",void 0),(0,l.c)([(0,h.N)()],r.prototype,"vOffset",void 0),(0,l.c)([(0,h.N)()],r.prototype,"uScale",void 0),(0,l.c)([(0,h.N)()],r.prototype,"vScale",void 0),(0,l.c)([(0,h.N)()],r.prototype,"uAng",void 0),(0,l.c)([(0,h.N)()],r.prototype,"vAng",void 0),(0,l.c)([(0,h.N)()],r.prototype,"wAng",void 0),(0,l.c)([(0,h.N)()],r.prototype,"uRotationCenter",void 0),(0,l.c)([(0,h.N)()],r.prototype,"vRotationCenter",void 0),(0,l.c)([(0,h.N)()],r.prototype,"wRotationCenter",void 0),(0,l.c)([(0,h.N)()],r.prototype,"homogeneousRotationInUVTransform",void 0),(0,l.c)([(0,h.N)()],r.prototype,"isBlocking",null),(0,m.g)("BABYLON.Texture",r),x.d._TextureParser=r.Parse},2374:(Q,X,C)=>{C.d(X,{d:()=>l});class l{constructor(Q,X){this.width=Q,this.height=X}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let Q=0|this.width;return Q=397*Q^this.height,Q}p(Q){this.width=Q.width,this.height=Q.height}Yc(Q,X){return this.width=Q,this.height=X,this}set(Q,X){return this.Yc(Q,X)}multiplyByFloats(Q,X){return new l(this.width*Q,this.height*X)}clone(){return new l(this.width,this.height)}equals(Q){return!!Q&&(this.width===Q.width&&this.height===Q.height)}get surface(){return this.width*this.height}static Zero(){return new l(0,0)}add(Q){return new l(this.width+Q.width,this.height+Q.height)}Od(Q){return new l(this.width-Q.width,this.height-Q.height)}scale(Q){return new l(this.width*Q,this.height*Q)}static Lerp(Q,X,C){const h=Q.width+(X.width-Q.width)*C,M=Q.height+(X.height-Q.height)*C;return new l(h,M)}}}}]);