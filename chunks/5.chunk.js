"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2045:(v,d,Q)=>{Q.d(d,{e:()=>z});var n=Q(620),T=Q(629),L=Q(473),e=Q(651),F=Q(508),r=Q(593),C=(Q(512),Q(2021));class u{get wrapU(){return this._wrapU}set wrapU(v){this._wrapU=v}get wrapV(){return this._wrapV}set wrapV(v){this._wrapV=v}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(v){this._texture&&(this._texture.isCube=v)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(v){this._texture&&(this._texture.is3D=v)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(v){this._texture&&(this._texture.is2DArray=v)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(v){return void 0!==(null===v||void 0===v?void 0:v.shareDepth)}constructor(v){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=C.d.Zero(),this._cachedBaseSize=C.d.Zero(),this._initialSamplingMode=2,this._texture=u._IsRenderTargetWrapper(v)?v.texture:v,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(v){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(v,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var y=Q(677);class z extends u{set ui(v){this._hasAlpha!==v&&(this._hasAlpha=v,this._scene&&this._scene.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))))}get ui(){return this._hasAlpha}set getAlphaFromRGB(v){this._getAlphaFromRGB!==v&&(this._getAlphaFromRGB=v,this._scene&&this._scene.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(v){this._coordinatesIndex!==v&&(this._coordinatesIndex=v,this._scene&&this._scene.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(v){this._coordinatesMode!==v&&(this._coordinatesMode=v,this._scene&&this._scene.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(v){this._wrapU=v}get wrapV(){return this._wrapV}set wrapV(v){this._wrapV=v}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(v){this._texture?this._texture.isCube=v:this._isCube=v}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(v){this._texture&&(this._texture.is3D=v)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(v){this._texture&&(this._texture.is2DArray=v)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(v){var d;if(this._texture){if(this._texture._gammaSpace===v)return;this._texture._gammaSpace=v}else{if(this._gammaSpace===v)return;this._gammaSpace=v}null===(d=this.va())||void 0===d||d.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(v){var d;v!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=v),null===(d=this.va())||void 0===d||d.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(v){this._texture&&(this._texture._lodGenerationOffset=v)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(v){this._texture&&(this._texture._lodGenerationScale=v)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(v){this._texture&&(this._texture._linearSpecularLOD=v)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(v){this._texture&&(this._texture._irradianceTexture=v)}get uid(){return this._uid||(this._uid=(0,r.e)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(v){this._onDisposeObserver&&this.kk.remove(this._onDisposeObserver),this._onDisposeObserver=this.kk.add(v)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(v){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=z.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.kk=new L.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,v?z._IsScene(v)?this._scene=v:this._engine=v:this._scene=F.c.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=d,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return e.b.IdentityReadOnly}getReflectionTextureMatrix(){return e.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(v){}get canRescale(){return!1}_getFromCache(v,d,Q,n,T,L){const e=this._getEngine();if(!e)return null;const F=e._getUseSRGBBuffer(!!T,d),r=e.getLoadedTexturesCache();for(let C=0;C<r.length;C++){const e=r[C];if((void 0===T||F===e._useSRGBBuffer)&&(void 0===n||n===e.invertY)&&e.url===v&&e.generateMipMaps===!d&&(!Q||Q===e.samplingMode)&&(void 0===L||L===e.isCube))return e.incrementReferences(),e}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const v=this.va();v&&v.markAllMaterialsAsDirty(1)}readPixels(){let v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],T=arguments.length>4&&void 0!==arguments[4]&&arguments[4],L=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,e=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,F=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const C=this._getEngine();if(!C)return null;const u=this.getSize();let y=u.width,z=u.height;0!==d&&(y/=Math.pow(2,d),z/=Math.pow(2,d),y=Math.round(y),z=Math.round(z)),F=Math.min(y,F),r=Math.min(z,r);try{return this._texture.isCube?C._readTexturePixels(this._texture,F,r,v,d,Q,n,T,L,e):C._readTexturePixels(this._texture,F,r,-1,d,Q,n,T,L,e)}catch(B){return null}}_readPixelsSync(){let v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],T=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const L=this.getSize();let e=L.width,F=L.height;const r=this._getEngine();if(!r)return null;0!=d&&(e/=Math.pow(2,d),F/=Math.pow(2,d),e=Math.round(e),F=Math.round(F));try{return this._texture.isCube?r._readTexturePixelsSync(this._texture,e,F,v,d,Q,n,T):r._readTexturePixelsSync(this._texture,e,F,-1,d,Q,n,T)}catch(C){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const v=this._scene.textures.indexOf(this);if(v>=0&&this._scene.textures.splice(v,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const v=this._parentContainer.textures.indexOf(this);v>-1&&this._parentContainer.textures.splice(v,1),this._parentContainer=null}}this.kk.notifyObservers(this),this.kk.clear(),this.metadata=null,super.dispose()}serialize(){let v=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!v)return null;const d=y.e.Serialize(this);return y.e.AppendSerializedAnimations(this,d),d}static WhenAllReady(v,d){let Q=v.length;if(0!==Q)for(let n=0;n<v.length;n++){const T=v[n];if(T.isReady())0===--Q&&d();else{const v=T.onLoadObservable;v?v.addOnce((()=>{0===--Q&&d()})):0===--Q&&d()}}else d()}static _IsScene(v){return"Scene"===v.getClassName()}}z.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,n.b)([(0,T.F)()],z.prototype,"uniqueId",void 0),(0,n.b)([(0,T.F)()],z.prototype,"name",void 0),(0,n.b)([(0,T.F)()],z.prototype,"displayName",void 0),(0,n.b)([(0,T.F)()],z.prototype,"metadata",void 0),(0,n.b)([(0,T.F)("ui")],z.prototype,"_hasAlpha",void 0),(0,n.b)([(0,T.F)("getAlphaFromRGB")],z.prototype,"_getAlphaFromRGB",void 0),(0,n.b)([(0,T.F)()],z.prototype,"level",void 0),(0,n.b)([(0,T.F)("coordinatesIndex")],z.prototype,"_coordinatesIndex",void 0),(0,n.b)([(0,T.F)()],z.prototype,"optimizeUVAllocation",void 0),(0,n.b)([(0,T.F)("coordinatesMode")],z.prototype,"_coordinatesMode",void 0),(0,n.b)([(0,T.F)()],z.prototype,"wrapU",null),(0,n.b)([(0,T.F)()],z.prototype,"wrapV",null),(0,n.b)([(0,T.F)()],z.prototype,"wrapR",void 0),(0,n.b)([(0,T.F)()],z.prototype,"anisotropicFilteringLevel",void 0),(0,n.b)([(0,T.F)()],z.prototype,"isCube",null),(0,n.b)([(0,T.F)()],z.prototype,"is3D",null),(0,n.b)([(0,T.F)()],z.prototype,"is2DArray",null),(0,n.b)([(0,T.F)()],z.prototype,"gammaSpace",null),(0,n.b)([(0,T.F)()],z.prototype,"invertZ",void 0),(0,n.b)([(0,T.F)()],z.prototype,"lodLevelInAlpha",void 0),(0,n.b)([(0,T.F)()],z.prototype,"lodGenerationOffset",null),(0,n.b)([(0,T.F)()],z.prototype,"lodGenerationScale",null),(0,n.b)([(0,T.F)()],z.prototype,"linearSpecularLOD",null),(0,n.b)([(0,T.x)()],z.prototype,"irradianceTexture",null),(0,n.b)([(0,T.F)()],z.prototype,"isRenderTarget",void 0)},2041:(v,d,Q)=>{Q.d(d,{e:()=>A});var n=Q(620),T=Q(629),L=Q(473),e=Q(651),F=Q(2045),r=Q(591),C=Q(497),u=Q(539),y=Q(583),z=Q(702),B=Q(522);function X(v,d){let Q=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=d.width,T=d.height;if(v instanceof Float32Array){let d=v.byteLength/v.BYTES_PER_ELEMENT;const Q=new Uint8Array(d);for(;--d>=0;){let n=v[d];n<0?n=0:n>1&&(n=1),Q[d]=255*n}v=Q}const L=document.createElement("canvas");L.width=n,L.height=T;const e=L.getContext("2d");if(!e)return null;const F=e.createImageData(n,T);if(F.data.set(v),e.putImageData(F,0,0),Q){const v=document.createElement("canvas");v.width=n,v.height=T;const d=v.getContext("2d");return d?(d.translate(0,T),d.scale(1,-1),d.drawImage(L,0,0),v.toDataURL("image/png")):null}return L.toDataURL("image/png")}function m(v){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=v.getInternalTexture();if(!n)return null;const T=v._readPixelsSync(d,Q);return T?X(T,v.getSize(),n.invertY):null}async function V(v){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,Q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=v.getInternalTexture();if(!n)return null;const T=await v.readPixels(d,Q);return T?X(T,v.getSize(),n.invertY):null}var h=Q(791),S=Q(677);class A extends F.e{static _CreateVideoTexture(v,d,Q){arguments.length>5&&void 0!==arguments[5]||A.TRILINEAR_SAMPLINGMODE;throw(0,C.c)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(v){this._isBlocking=v}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(v,d,Q,n){let T,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:A.TRILINEAR_SAMPLINGMODE,F=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,y=arguments.length>8&&void 0!==arguments[8]&&arguments[8],z=arguments.length>9?arguments[9]:void 0,B=arguments.length>10?arguments[10]:void 0,X=arguments.length>11?arguments[11]:void 0,m=arguments.length>12?arguments[12]:void 0,V=arguments.length>13?arguments[13]:void 0;super(d),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new L.e,this._isBlocking=!0,this.name=v||"",this.url=v;let S=!1,f=null,P=!0;"object"===typeof Q&&null!==Q?(T=Q.noMipmap??!1,n=Q.invertY??!h.d,e=Q.samplingMode??A.TRILINEAR_SAMPLINGMODE,F=Q.X??null,r=Q.onError??null,C=Q.buffer??null,y=Q.deleteBuffer??!1,z=Q.format,B=Q.mimeType,X=Q.loaderOptions,m=Q.creationFlags,S=Q.useSRGBBuffer??!1,f=Q.internalTexture??null,P=Q.gammaSpace??P,V=Q.forcedExtension??V):T=!!Q,this._gammaSpace=P,this._noMipmap=T,this._invertY=void 0===n?!h.d:n,this._initialSamplingMode=e,this._buffer=C,this._deleteBuffer=y,this._mimeType=B,this._loaderOptions=X,this._creationFlags=m,this._useSRGBBuffer=S,this._forcedExtension=V,void 0!==z&&(this._format=z);const O=this.va(),J=this._getEngine();if(!J)return;J.onBeforeTextureInitObservable.notifyObservers(this);const K=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),F&&F(),!this.isBlocking&&O&&O.resetCachedMaterial()},o=(v,d)=>{this._loadingError=!0,this._errorObject={message:v,exception:d},r&&r(v,d),A.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!f)return this._delayedOnLoad=K,void(this._delayedOnError=o);if(this._texture=f??this._getFromCache(this.url,T,e,this._invertY,S,this.isCube),this._texture)if(this._texture.isReady)u.b.SetImmediate((()=>K()));else{const v=this._texture.onLoadedObservable.add(K);this._texture.onErrorObservable.add((d=>{var Q;o(d.message,d.exception),null===(Q=this._texture)||void 0===Q||Q.onLoadedObservable.remove(v)}))}else if(O&&O.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=K,this._delayedOnError=o;else{try{this._texture=J.createTexture(this.url,T,this._invertY,O,e,K,o,this._buffer,void 0,this._format,this._forcedExtension,B,X,m,S)}catch(g){throw o("error loading",g),g}y&&(this._buffer=null)}}updateURL(v){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,Q=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(v=>v.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=v),this.url=v,this._buffer=d,this._forcedExtension=n,this.delayLoadState=4,Q&&(this._delayedOnLoad=Q),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const v=this.va();v&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?u.b.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=v.getEngine().createTexture(this.url,this._noMipmap,this._invertY,v,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(v,d,Q,n){v*=this._cachedUScale,d*=this._cachedVScale,v-=this.uRotationCenter*this._cachedUScale,d-=this.vRotationCenter*this._cachedVScale,Q-=this.wRotationCenter,e.j.TransformCoordinatesFromFloatsToRef(v,d,Q,this._rowGenerationMatrix,n),n.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,n.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,n.z+=this.wRotationCenter}getTextureMatrix(){let v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*v===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*v,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=e.b.Zero(),this._rowGenerationMatrix=new e.b,this._t0=e.j.Zero(),this._t1=e.j.Zero(),this._t2=e.j.Zero()),e.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(e.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,e.g.Matrix[0]),e.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,e.g.Matrix[1]),e.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,e.g.Matrix[2]),e.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,e.g.Matrix[3]),e.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(e.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(e.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(e.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.hk(this._t0),this._t2.hk(this._t0),e.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const d=this.va();if(!d)return this._cachedTextureMatrix;const Q=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&Q!==this._cachedIdentity3x2&&d.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const v=this.va();if(!v)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==A.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===v.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=e.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=e.b.Zero());const d=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case A.PLANAR_MODE:e.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case A.PROJECTION_MODE:{e.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const d=v.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=d.updateFlag,d.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:e.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return d&&v.markAllMaterialsAsDirty(1,(v=>v.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const v={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return S.e.Clone((()=>new A(this._texture?this._texture.url:null,this.va(),v)),this)}serialize(){var v;const d=this.name;A.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const Q=super.serialize(A._SerializeInternalTextureUniqueId);if(!Q)return null;if(A.SerializeBuffers||A.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))Q.base64String=this._buffer,Q.name=Q.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const v=this.mimeType||"image/png";Q.base64String=`data:${v};base64,${(0,B.h)(this._buffer)}`}else(A.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(Q.base64String=!this._engine||this._engine._features.supportSyncTextureRead?m(this):V(this));var n;(Q.invertY=this._invertY,Q.samplingMode=this.samplingMode,Q._creationFlags=this._creationFlags,Q._useSRGBBuffer=this._useSRGBBuffer,A._SerializeInternalTextureUniqueId)&&(Q.internalTextureUniqueId=null===(n=this._texture)||void 0===n?void 0:n.uniqueId);return Q.internalTextureLabel=null===(v=this._texture)||void 0===v?void 0:v.label,Q.noMipmap=this._noMipmap,this.name=d,Q}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(v,d,Q){if(v.customType){const n=y.b.Instantiate(v.customType).Parse(v,d,Q);return v.samplingMode&&n.updateSamplingMode&&n._samplingMode&&n._samplingMode!==v.samplingMode&&n.updateSamplingMode(v.samplingMode),n}if(v.isCube&&!v.isRenderTarget)return A._CubeTextureParser(v,d,Q);const n=void 0!==v.internalTextureUniqueId;if(!v.name&&!v.isRenderTarget&&!n)return null;let T;if(n){const Q=d.getEngine().getLoadedTexturesCache();for(const d of Q)if(d.uniqueId===v.internalTextureUniqueId){T=d;break}}const L=d=>{if(d&&d._texture&&(d._texture._cachedWrapU=null,d._texture._cachedWrapV=null,d._texture._cachedWrapR=null),v.samplingMode){const Q=v.samplingMode;d&&d.samplingMode!==Q&&d.updateSamplingMode(Q)}if(d&&v.animations)for(let Q=0;Q<v.animations.length;Q++){const n=v.animations[Q],T=(0,r.e)("BABYLON.Animation");T&&d.animations.push(T.Parse(n))}d&&d._texture&&(n&&!T&&d._texture._setUniqueId(v.internalTextureUniqueId),d._texture.label=v.internalTextureLabel)};return S.e.Parse((()=>{let n=!0;if(v.noMipmap&&(n=!1),v.mirrorPlane){const Q=A._CreateMirror(v.name,v.renderTargetSize,d,n);return Q._waitingRenderList=v.renderList,Q.mirrorPlane=z.d.dk(v.mirrorPlane),L(Q),Q}if(v.isRenderTarget){let Q=null;if(v.isCube){if(d.reflectionProbes)for(let n=0;n<d.reflectionProbes.length;n++){const Q=d.reflectionProbes[n];if(Q.name===v.name)return Q.cubeTexture}}else Q=A._CreateRenderTargetTexture(v.name,v.renderTargetSize,d,n,v._creationFlags??0),Q._waitingRenderList=v.renderList;return L(Q),Q}if(v.isVideo){const T=A._CreateVideoTexture(Q+(v.url||v.name),Q+(v.src||v.url),d,n,v.invertY,v.samplingMode,v.settings||{});return L(T),T}{let e;if(v.base64String&&!T)e=A.CreateFromBase64String(v.base64String,v.base64String,d,!n,v.invertY,v.samplingMode,(()=>{L(e)}),v._creationFlags??0,v._useSRGBBuffer??!1),e.name=v.name;else{let F;F=v.name&&(v.name.indexOf("://")>0||v.name.startsWith("data:"))?v.name:Q+v.name,v.url&&(v.url.startsWith("data:")||A.UseSerializedUrlIfAny)&&(F=v.url);const r={noMipmap:!n,invertY:v.invertY,samplingMode:v.samplingMode,X:()=>{L(e)},internalTexture:T};e=new A(F,d,r)}return e}}),v,d)}static CreateFromBase64String(v,d,Q,n,T){let L=arguments.length>5&&void 0!==arguments[5]?arguments[5]:A.TRILINEAR_SAMPLINGMODE;return new A("data:"+d,Q,n,T,L,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,v,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(v,d,Q){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],T=arguments.length>4?arguments[4]:void 0,L=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],e=arguments.length>6&&void 0!==arguments[6]?arguments[6]:A.TRILINEAR_SAMPLINGMODE,F=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,r=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,C=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,u=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0;return"data:"!==v.substring(0,5)&&(v="data:"+v),new A(v,Q,T,L,e,F,r,d,n,C,void 0,void 0,u,y)}}A.SerializeBuffers=!0,A.ForceSerializeBuffers=!1,A.OnTextureLoadErrorObservable=new L.e,A._SerializeInternalTextureUniqueId=!1,A._CubeTextureParser=(v,d,Q)=>{throw(0,C.c)("CubeTexture")},A._CreateMirror=(v,d,Q,n)=>{throw(0,C.c)("MirrorTexture")},A._CreateRenderTargetTexture=(v,d,Q,n,T)=>{throw(0,C.c)("RenderTargetTexture")},A.NEAREST_SAMPLINGMODE=1,A.NEAREST_NEAREST_MIPLINEAR=8,A.BILINEAR_SAMPLINGMODE=2,A.LINEAR_LINEAR_MIPNEAREST=11,A.TRILINEAR_SAMPLINGMODE=3,A.LINEAR_LINEAR_MIPLINEAR=3,A.NEAREST_NEAREST_MIPNEAREST=4,A.NEAREST_LINEAR_MIPNEAREST=5,A.NEAREST_LINEAR_MIPLINEAR=6,A.NEAREST_LINEAR=7,A.NEAREST_NEAREST=1,A.LINEAR_NEAREST_MIPNEAREST=9,A.LINEAR_NEAREST_MIPLINEAR=10,A.LINEAR_LINEAR=2,A.LINEAR_NEAREST=12,A.EXPLICIT_MODE=0,A.SPHERICAL_MODE=1,A.PLANAR_MODE=2,A.CUBIC_MODE=3,A.PROJECTION_MODE=4,A.SKYBOX_MODE=5,A.INVCUBIC_MODE=6,A.EQUIRECTANGULAR_MODE=7,A.FIXED_EQUIRECTANGULAR_MODE=8,A.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,A.CLAMP_ADDRESSMODE=0,A.WRAP_ADDRESSMODE=1,A.MIRROR_ADDRESSMODE=2,A.UseSerializedUrlIfAny=!1,(0,n.b)([(0,T.F)()],A.prototype,"url",void 0),(0,n.b)([(0,T.F)()],A.prototype,"uOffset",void 0),(0,n.b)([(0,T.F)()],A.prototype,"vOffset",void 0),(0,n.b)([(0,T.F)()],A.prototype,"uScale",void 0),(0,n.b)([(0,T.F)()],A.prototype,"vScale",void 0),(0,n.b)([(0,T.F)()],A.prototype,"uAng",void 0),(0,n.b)([(0,T.F)()],A.prototype,"vAng",void 0),(0,n.b)([(0,T.F)()],A.prototype,"wAng",void 0),(0,n.b)([(0,T.F)()],A.prototype,"uRotationCenter",void 0),(0,n.b)([(0,T.F)()],A.prototype,"vRotationCenter",void 0),(0,n.b)([(0,T.F)()],A.prototype,"wRotationCenter",void 0),(0,n.b)([(0,T.F)()],A.prototype,"homogeneousRotationInUVTransform",void 0),(0,n.b)([(0,T.F)()],A.prototype,"isBlocking",null),(0,r.f)("BABYLON.Texture",A),S.e._TextureParser=A.Parse},2021:(v,d,Q)=>{Q.d(d,{d:()=>n});class n{constructor(v,d){this.width=v,this.height=d}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let v=0|this.width;return v=397*v^this.height,v}p(v){this.width=v.width,this.height=v.height}ld(v,d){return this.width=v,this.height=d,this}set(v,d){return this.ld(v,d)}multiplyByFloats(v,d){return new n(this.width*v,this.height*d)}clone(){return new n(this.width,this.height)}equals(v){return!!v&&(this.width===v.width&&this.height===v.height)}get surface(){return this.width*this.height}static Zero(){return new n(0,0)}add(v){return new n(this.width+v.width,this.height+v.height)}Wd(v){return new n(this.width-v.width,this.height-v.height)}scale(v){return new n(this.width*v,this.height*v)}static Lerp(v,d,Q){const T=v.width+(d.width-v.width)*Q,L=v.height+(d.height-v.height)*Q;return new n(T,L)}}}}]);