"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2343:(W,F,c)=>{c.d(F,{e:()=>N});var T=c(675),Y=c(680),Z=c(511),w=c(694),A=c(543),u=c(649),s=(c(551),c(2311));class x{get wrapU(){return this._wrapU}set wrapU(W){this._wrapU=W}get wrapV(){return this._wrapV}set wrapV(W){this._wrapV=W}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(W){this._texture&&(this._texture.isCube=W)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(W){this._texture&&(this._texture.is3D=W)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(W){this._texture&&(this._texture.is2DArray=W)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(W){return void 0!==(null===W||void 0===W?void 0:W.shareDepth)}constructor(W){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=s.c.Zero(),this._cachedBaseSize=s.c.Zero(),this._initialSamplingMode=2,this._texture=x._IsRenderTargetWrapper(W)?W.texture:W,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(W){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(W,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var j=c(721);class N extends x{set Ej(W){this._hasAlpha!==W&&(this._hasAlpha=W,this._scene&&this._scene.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))))}get Ej(){return this._hasAlpha}set getAlphaFromRGB(W){this._getAlphaFromRGB!==W&&(this._getAlphaFromRGB=W,this._scene&&this._scene.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(W){this._coordinatesIndex!==W&&(this._coordinatesIndex=W,this._scene&&this._scene.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(W){this._coordinatesMode!==W&&(this._coordinatesMode=W,this._scene&&this._scene.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(W){this._wrapU=W}get wrapV(){return this._wrapV}set wrapV(W){this._wrapV=W}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(W){this._texture?this._texture.isCube=W:this._isCube=W}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(W){this._texture&&(this._texture.is3D=W)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(W){this._texture&&(this._texture.is2DArray=W)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(W){var F;if(this._texture){if(this._texture._gammaSpace===W)return;this._texture._gammaSpace=W}else{if(this._gammaSpace===W)return;this._gammaSpace=W}null===(F=this.va())||void 0===F||F.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(W){var F;W!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=W),null===(F=this.va())||void 0===F||F.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(W){this._texture&&(this._texture._lodGenerationOffset=W)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(W){this._texture&&(this._texture._lodGenerationScale=W)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(W){this._texture&&(this._texture._linearSpecularLOD=W)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(W){this._texture&&(this._texture._irradianceTexture=W)}get uid(){return this._uid||(this._uid=(0,u.b)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(W){this._onDisposeObserver&&this.Ji.remove(this._onDisposeObserver),this._onDisposeObserver=this.Ji.add(W)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(W){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=N.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Ji=new Z.b,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,W?N._IsScene(W)?this._scene=W:this._engine=W:this._scene=A.e.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=F,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return w.b.IdentityReadOnly}getReflectionTextureMatrix(){return w.b.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(W){}get canRescale(){return!1}_getFromCache(W,F,c,T,Y,Z){const w=this._getEngine();if(!w)return null;const A=w._getUseSRGBBuffer(!!Y,F),u=w.getLoadedTexturesCache();for(let s=0;s<u.length;s++){const w=u[s];if((void 0===Y||A===w._useSRGBBuffer)&&(void 0===T||T===w.invertY)&&w.url===W&&w.generateMipMaps===!F&&(!c||c===w.samplingMode)&&(void 0===Z||Z===w.isCube))return w.incrementReferences(),w}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const W=this.va();W&&W.markAllMaterialsAsDirty(1)}readPixels(){let W=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,T=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],Y=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,A=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const s=this._getEngine();if(!s)return null;const x=this.getSize();let j=x.width,N=x.height;0!==F&&(j/=Math.pow(2,F),N/=Math.pow(2,F),j=Math.round(j),N=Math.round(N)),A=Math.min(j,A),u=Math.min(N,u);try{return this._texture.isCube?s._readTexturePixels(this._texture,A,u,W,F,c,T,Y,Z,w):s._readTexturePixels(this._texture,A,u,-1,F,c,T,Y,Z,w)}catch(q){return null}}_readPixelsSync(){let W=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,T=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],Y=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const Z=this.getSize();let w=Z.width,A=Z.height;const u=this._getEngine();if(!u)return null;0!=F&&(w/=Math.pow(2,F),A/=Math.pow(2,F),w=Math.round(w),A=Math.round(A));try{return this._texture.isCube?u._readTexturePixelsSync(this._texture,w,A,W,F,c,T,Y):u._readTexturePixelsSync(this._texture,w,A,-1,F,c,T,Y)}catch(s){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const W=this._scene.textures.indexOf(this);if(W>=0&&this._scene.textures.splice(W,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const W=this._parentContainer.textures.indexOf(this);W>-1&&this._parentContainer.textures.splice(W,1),this._parentContainer=null}}this.Ji.notifyObservers(this),this.Ji.clear(),this.metadata=null,super.dispose()}serialize(){let W=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!W)return null;const F=j.c.Serialize(this);return j.c.AppendSerializedAnimations(this,F),F}static WhenAllReady(W,F){let c=W.length;if(0!==c)for(let T=0;T<W.length;T++){const Y=W[T];if(Y.isReady())0===--c&&F();else{const W=Y.onLoadObservable;W?W.addOnce((()=>{0===--c&&F()})):0===--c&&F()}}else F()}static _IsScene(W){return"Scene"===W.getClassName()}}N.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,T.d)([(0,Y.O)()],N.prototype,"uniqueId",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"name",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"displayName",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"metadata",void 0),(0,T.d)([(0,Y.O)("Ej")],N.prototype,"_hasAlpha",void 0),(0,T.d)([(0,Y.O)("getAlphaFromRGB")],N.prototype,"_getAlphaFromRGB",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"level",void 0),(0,T.d)([(0,Y.O)("coordinatesIndex")],N.prototype,"_coordinatesIndex",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"optimizeUVAllocation",void 0),(0,T.d)([(0,Y.O)("coordinatesMode")],N.prototype,"_coordinatesMode",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"wrapU",null),(0,T.d)([(0,Y.O)()],N.prototype,"wrapV",null),(0,T.d)([(0,Y.O)()],N.prototype,"wrapR",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"anisotropicFilteringLevel",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"isCube",null),(0,T.d)([(0,Y.O)()],N.prototype,"is3D",null),(0,T.d)([(0,Y.O)()],N.prototype,"is2DArray",null),(0,T.d)([(0,Y.O)()],N.prototype,"gammaSpace",null),(0,T.d)([(0,Y.O)()],N.prototype,"invertZ",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"lodLevelInAlpha",void 0),(0,T.d)([(0,Y.O)()],N.prototype,"lodGenerationOffset",null),(0,T.d)([(0,Y.O)()],N.prototype,"lodGenerationScale",null),(0,T.d)([(0,Y.O)()],N.prototype,"linearSpecularLOD",null),(0,T.d)([(0,Y.D)()],N.prototype,"irradianceTexture",null),(0,T.d)([(0,Y.O)()],N.prototype,"isRenderTarget",void 0)},2337:(W,F,c)=>{c.d(F,{b:()=>O});var T=c(675),Y=c(680),Z=c(511),w=c(694),A=c(2343),u=c(642),s=c(533),x=c(579),j=c(634),N=c(735),q=c(559);function y(W,F){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const T=F.width,Y=F.height;if(W instanceof Float32Array){let F=W.byteLength/W.BYTES_PER_ELEMENT;const c=new Uint8Array(F);for(;--F>=0;){let T=W[F];T<0?T=0:T>1&&(T=1),c[F]=255*T}W=c}const Z=document.createElement("canvas");Z.width=T,Z.height=Y;const w=Z.getContext("2d");if(!w)return null;const A=w.createImageData(T,Y);if(A.data.set(W),w.putImageData(A,0,0),c){const W=document.createElement("canvas");W.width=T,W.height=Y;const F=W.getContext("2d");return F?(F.translate(0,Y),F.scale(1,-1),F.drawImage(Z,0,0),W.toDataURL("image/png")):null}return Z.toDataURL("image/png")}function i(W){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const T=W.getInternalTexture();if(!T)return null;const Y=W._readPixelsSync(F,c);return Y?y(Y,W.getSize(),T.invertY):null}async function e(W){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const T=W.getInternalTexture();if(!T)return null;const Y=await W.readPixels(F,c);return Y?y(Y,W.getSize(),T.invertY):null}var I=c(809),E=c(721);class O extends A.e{static _CreateVideoTexture(W,F,c){arguments.length>5&&void 0!==arguments[5]||O.TRILINEAR_SAMPLINGMODE;throw(0,s.e)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(W){this._isBlocking=W}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(W,F,c,T){let Y,w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:O.TRILINEAR_SAMPLINGMODE,A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,j=arguments.length>8&&void 0!==arguments[8]&&arguments[8],N=arguments.length>9?arguments[9]:void 0,q=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0,i=arguments.length>12?arguments[12]:void 0,e=arguments.length>13?arguments[13]:void 0;super(F),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new Z.b,this._isBlocking=!0,this.name=W||"",this.url=W;let E=!1,z=null,G=!0;"object"===typeof c&&null!==c?(Y=c.noMipmap??!1,T=c.invertY??!I.b,w=c.samplingMode??O.TRILINEAR_SAMPLINGMODE,A=c.X??null,u=c.onError??null,s=c.buffer??null,j=c.deleteBuffer??!1,N=c.format,q=c.mimeType,y=c.loaderOptions,i=c.creationFlags,E=c.useSRGBBuffer??!1,z=c.internalTexture??null,G=c.gammaSpace??G,e=c.forcedExtension??e):Y=!!c,this._gammaSpace=G,this._noMipmap=Y,this._invertY=void 0===T?!I.b:T,this._initialSamplingMode=w,this._buffer=s,this._deleteBuffer=j,this._mimeType=q,this._loaderOptions=y,this._creationFlags=i,this._useSRGBBuffer=E,this._forcedExtension=e,void 0!==N&&(this._format=N);const D=this.va(),v=this._getEngine();if(!v)return;v.onBeforeTextureInitObservable.notifyObservers(this);const C=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),A&&A(),!this.isBlocking&&D&&D.resetCachedMaterial()},n=(W,F)=>{this._loadingError=!0,this._errorObject={message:W,exception:F},u&&u(W,F),O.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!z)return this._delayedOnLoad=C,void(this._delayedOnError=n);if(this._texture=z??this._getFromCache(this.url,Y,w,this._invertY,E,this.isCube),this._texture)if(this._texture.isReady)x.d.SetImmediate((()=>C()));else{const W=this._texture.onLoadedObservable.add(C);this._texture.onErrorObservable.add((F=>{var c;n(F.message,F.exception),null===(c=this._texture)||void 0===c||c.onLoadedObservable.remove(W)}))}else if(D&&D.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=C,this._delayedOnError=n;else{try{this._texture=v.createTexture(this.url,Y,this._invertY,D,w,C,n,this._buffer,void 0,this._format,this._forcedExtension,q,y,i,E)}catch(X){throw n("error loading",X),X}j&&(this._buffer=null)}}updateURL(W){let F=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2?arguments[2]:void 0,T=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(W=>W.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=W),this.url=W,this._buffer=F,this._forcedExtension=T,this.delayLoadState=4,c&&(this._delayedOnLoad=c),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const W=this.va();W&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?x.d.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=W.getEngine().createTexture(this.url,this._noMipmap,this._invertY,W,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(W,F,c,T){W*=this._cachedUScale,F*=this._cachedVScale,W-=this.uRotationCenter*this._cachedUScale,F-=this.vRotationCenter*this._cachedVScale,c-=this.wRotationCenter,w.l.TransformCoordinatesFromFloatsToRef(W,F,c,this._rowGenerationMatrix,T),T.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,T.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,T.z+=this.wRotationCenter}getTextureMatrix(){let W=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*W===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*W,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=w.b.Zero(),this._rowGenerationMatrix=new w.b,this._t0=w.l.Zero(),this._t1=w.l.Zero(),this._t2=w.l.Zero()),w.b.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(w.b.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,w.g.Matrix[0]),w.b.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,w.g.Matrix[1]),w.b.ScalingToRef(this._cachedUScale,this._cachedVScale,0,w.g.Matrix[2]),w.b.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,w.g.Matrix[3]),w.g.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(w.g.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(w.g.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(w.g.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Ri(this._t0),this._t2.Ri(this._t0),w.b.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const F=this.va();if(!F)return this._cachedTextureMatrix;const c=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&c!==this._cachedIdentity3x2&&F.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const W=this.va();if(!W)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==O.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===W.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=w.b.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=w.b.Zero());const F=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case O.PLANAR_MODE:w.b.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case O.PROJECTION_MODE:{w.b.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const F=W.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=F.updateFlag,F.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:w.b.IdentityToRef(this._cachedReflectionTextureMatrix)}return F&&W.markAllMaterialsAsDirty(1,(W=>W.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const W={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return E.c.Clone((()=>new O(this._texture?this._texture.url:null,this.va(),W)),this)}serialize(){var W;const F=this.name;O.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const c=super.serialize(O._SerializeInternalTextureUniqueId);if(!c)return null;if(O.SerializeBuffers||O.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))c.base64String=this._buffer,c.name=c.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const W=this.mimeType||"image/png";c.base64String=`data:${W};base64,${(0,q.m)(this._buffer)}`}else(O.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(c.base64String=!this._engine||this._engine._features.supportSyncTextureRead?i(this):e(this));var T;(c.invertY=this._invertY,c.samplingMode=this.samplingMode,c._creationFlags=this._creationFlags,c._useSRGBBuffer=this._useSRGBBuffer,O._SerializeInternalTextureUniqueId)&&(c.internalTextureUniqueId=null===(T=this._texture)||void 0===T?void 0:T.uniqueId);return c.internalTextureLabel=null===(W=this._texture)||void 0===W?void 0:W.label,c.noMipmap=this._noMipmap,this.name=F,c}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(W,F,c){if(W.customType){const T=j.e.Instantiate(W.customType).Parse(W,F,c);return W.samplingMode&&T.updateSamplingMode&&T._samplingMode&&T._samplingMode!==W.samplingMode&&T.updateSamplingMode(W.samplingMode),T}if(W.isCube&&!W.isRenderTarget)return O._CubeTextureParser(W,F,c);const T=void 0!==W.internalTextureUniqueId;if(!W.name&&!W.isRenderTarget&&!T)return null;let Y;if(T){const c=F.getEngine().getLoadedTexturesCache();for(const F of c)if(F.uniqueId===W.internalTextureUniqueId){Y=F;break}}const Z=F=>{if(F&&F._texture&&(F._texture._cachedWrapU=null,F._texture._cachedWrapV=null,F._texture._cachedWrapR=null),W.samplingMode){const c=W.samplingMode;F&&F.samplingMode!==c&&F.updateSamplingMode(c)}if(F&&W.animations)for(let c=0;c<W.animations.length;c++){const T=W.animations[c],Y=(0,u.e)("BABYLON.Animation");Y&&F.animations.push(Y.Parse(T))}F&&F._texture&&(T&&!Y&&F._texture._setUniqueId(W.internalTextureUniqueId),F._texture.label=W.internalTextureLabel)};return E.c.Parse((()=>{let T=!0;if(W.noMipmap&&(T=!1),W.mirrorPlane){const c=O._CreateMirror(W.name,W.renderTargetSize,F,T);return c._waitingRenderList=W.renderList,c.mirrorPlane=N.c.mi(W.mirrorPlane),Z(c),c}if(W.isRenderTarget){let c=null;if(W.isCube){if(F.reflectionProbes)for(let T=0;T<F.reflectionProbes.length;T++){const c=F.reflectionProbes[T];if(c.name===W.name)return c.cubeTexture}}else c=O._CreateRenderTargetTexture(W.name,W.renderTargetSize,F,T,W._creationFlags??0),c._waitingRenderList=W.renderList;return Z(c),c}if(W.isVideo){const Y=O._CreateVideoTexture(c+(W.url||W.name),c+(W.src||W.url),F,T,W.invertY,W.samplingMode,W.settings||{});return Z(Y),Y}{let w;if(W.base64String&&!Y)w=O.CreateFromBase64String(W.base64String,W.base64String,F,!T,W.invertY,W.samplingMode,(()=>{Z(w)}),W._creationFlags??0,W._useSRGBBuffer??!1),w.name=W.name;else{let A;A=W.name&&(W.name.indexOf("://")>0||W.name.startsWith("data:"))?W.name:c+W.name,W.url&&(W.url.startsWith("data:")||O.UseSerializedUrlIfAny)&&(A=W.url);const u={noMipmap:!T,invertY:W.invertY,samplingMode:W.samplingMode,X:()=>{Z(w)},internalTexture:Y};w=new O(A,F,u)}return w}}),W,F)}static CreateFromBase64String(W,F,c,T,Y){let Z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O.TRILINEAR_SAMPLINGMODE;return new O("data:"+F,c,T,Y,Z,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,W,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(W,F,c){let T=arguments.length>3&&void 0!==arguments[3]&&arguments[3],Y=arguments.length>4?arguments[4]:void 0,Z=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:O.TRILINEAR_SAMPLINGMODE,A=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,x=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0;return"data:"!==W.substring(0,5)&&(W="data:"+W),new O(W,c,Y,Z,w,A,u,F,T,s,void 0,void 0,x,j)}}O.SerializeBuffers=!0,O.ForceSerializeBuffers=!1,O.OnTextureLoadErrorObservable=new Z.b,O._SerializeInternalTextureUniqueId=!1,O._CubeTextureParser=(W,F,c)=>{throw(0,s.e)("CubeTexture")},O._CreateMirror=(W,F,c,T)=>{throw(0,s.e)("MirrorTexture")},O._CreateRenderTargetTexture=(W,F,c,T,Y)=>{throw(0,s.e)("RenderTargetTexture")},O.NEAREST_SAMPLINGMODE=1,O.NEAREST_NEAREST_MIPLINEAR=8,O.BILINEAR_SAMPLINGMODE=2,O.LINEAR_LINEAR_MIPNEAREST=11,O.TRILINEAR_SAMPLINGMODE=3,O.LINEAR_LINEAR_MIPLINEAR=3,O.NEAREST_NEAREST_MIPNEAREST=4,O.NEAREST_LINEAR_MIPNEAREST=5,O.NEAREST_LINEAR_MIPLINEAR=6,O.NEAREST_LINEAR=7,O.NEAREST_NEAREST=1,O.LINEAR_NEAREST_MIPNEAREST=9,O.LINEAR_NEAREST_MIPLINEAR=10,O.LINEAR_LINEAR=2,O.LINEAR_NEAREST=12,O.EXPLICIT_MODE=0,O.SPHERICAL_MODE=1,O.PLANAR_MODE=2,O.CUBIC_MODE=3,O.PROJECTION_MODE=4,O.SKYBOX_MODE=5,O.INVCUBIC_MODE=6,O.EQUIRECTANGULAR_MODE=7,O.FIXED_EQUIRECTANGULAR_MODE=8,O.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,O.CLAMP_ADDRESSMODE=0,O.WRAP_ADDRESSMODE=1,O.MIRROR_ADDRESSMODE=2,O.UseSerializedUrlIfAny=!1,(0,T.d)([(0,Y.O)()],O.prototype,"url",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"uOffset",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"vOffset",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"uScale",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"vScale",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"uAng",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"vAng",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"wAng",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"uRotationCenter",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"vRotationCenter",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"wRotationCenter",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"homogeneousRotationInUVTransform",void 0),(0,T.d)([(0,Y.O)()],O.prototype,"isBlocking",null),(0,u.h)("BABYLON.Texture",O),E.c._TextureParser=O.Parse},2311:(W,F,c)=>{c.d(F,{c:()=>T});class T{constructor(W,F){this.width=W,this.height=F}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let W=0|this.width;return W=397*W^this.height,W}p(W){this.width=W.width,this.height=W.height}gi(W,F){return this.width=W,this.height=F,this}set(W,F){return this.gi(W,F)}multiplyByFloats(W,F){return new T(this.width*W,this.height*F)}clone(){return new T(this.width,this.height)}equals(W){return!!W&&(this.width===W.width&&this.height===W.height)}get surface(){return this.width*this.height}static Zero(){return new T(0,0)}add(W){return new T(this.width+W.width,this.height+W.height)}Bg(W){return new T(this.width-W.width,this.height-W.height)}scale(W){return new T(this.width*W,this.height*W)}static Lerp(W,F,c){const Y=W.width+(F.width-W.width)*c,Z=W.height+(F.height-W.height)*c;return new T(Y,Z)}}}}]);