"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[5],{2034:(L,j,P)=>{P.d(j,{c:()=>V});var A=P(636),R=P(639),o=P(469),Y=P(656),u=P(519),a=P(615),D=(P(528),P(2008));class S{get wrapU(){return this._wrapU}set wrapU(L){this._wrapU=L}get wrapV(){return this._wrapV}set wrapV(L){this._wrapV=L}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(L){this._texture&&(this._texture.isCube=L)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(L){this._texture&&(this._texture.is3D=L)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(L){this._texture&&(this._texture.is2DArray=L)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(L){return void 0!==(null===L||void 0===L?void 0:L.shareDepth)}constructor(L){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=D.d.Zero(),this._cachedBaseSize=D.d.Zero(),this._initialSamplingMode=2,this._texture=S._IsRenderTargetWrapper(L)?L.texture:L,this._texture&&(this._engine=this._texture.getEngine(),this.wrapU=this._texture._cachedWrapU??this.wrapU,this.wrapV=this._texture._cachedWrapV??this.wrapV,this.wrapR=this._texture._cachedWrapR??this.wrapR)}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(L){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(L,this._texture,this._texture.generateMipMaps)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}var g=P(680);class V extends S{set Jj(L){this._hasAlpha!==L&&(this._hasAlpha=L,this._scene&&this._scene.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))))}get Jj(){return this._hasAlpha}set getAlphaFromRGB(L){this._getAlphaFromRGB!==L&&(this._getAlphaFromRGB=L,this._scene&&this._scene.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(L){this._coordinatesIndex!==L&&(this._coordinatesIndex=L,this._scene&&this._scene.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(L){this._coordinatesMode!==L&&(this._coordinatesMode=L,this._scene&&this._scene.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(L){this._wrapU=L}get wrapV(){return this._wrapV}set wrapV(L){this._wrapV=L}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(L){this._texture?this._texture.isCube=L:this._isCube=L}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(L){this._texture&&(this._texture.is3D=L)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(L){this._texture&&(this._texture.is2DArray=L)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(L){var j;if(this._texture){if(this._texture._gammaSpace===L)return;this._texture._gammaSpace=L}else{if(this._gammaSpace===L)return;this._gammaSpace=L}null===(j=this.va())||void 0===j||j.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this)))}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(L){var j;L!==this.isRGBD&&(this._texture&&(this._texture._isRGBD=L),null===(j=this.va())||void 0===j||j.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))))}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(L){this._texture&&(this._texture._lodGenerationOffset=L)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(L){this._texture&&(this._texture._lodGenerationScale=L)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(L){this._texture&&(this._texture._linearSpecularLOD=L)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(L){this._texture&&(this._texture._irradianceTexture=L)}get uid(){return this._uid||(this._uid=(0,a.d)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(L){this._onDisposeObserver&&this.Oi.remove(this._onDisposeObserver),this._onDisposeObserver=this.Oi.add(L)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=V.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this._dominantDirection=null,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=[],this.Oi=new o.e,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,L?V._IsScene(L)?this._scene=L:this._engine=L:this._scene=u.b.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=j,this._uid=null}va(){return this._scene}_getEngine(){return this._engine}getTextureMatrix(){return Y.e.IdentityReadOnly}getReflectionTextureMatrix(){return Y.e.IdentityReadOnly}getRefractionTextureMatrix(){return this.getReflectionTextureMatrix()}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(L){}get canRescale(){return!1}_getFromCache(L,j,P,A,R,o){const Y=this._getEngine();if(!Y)return null;const u=Y._getUseSRGBBuffer(!!R,j),a=Y.getLoadedTexturesCache();for(let D=0;D<a.length;D++){const Y=a[D];if((void 0===R||u===Y._useSRGBBuffer)&&(void 0===A||A===Y.invertY)&&Y.url===L&&Y.generateMipMaps===!j&&(!P||P===Y.samplingMode)&&(void 0===o||o===Y.isCube))return Y.incrementReferences(),Y}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const L=this.va();L&&L.markAllMaterialsAsDirty(1)}readPixels(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],R=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,Y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,a=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const D=this._getEngine();if(!D)return null;const S=this.getSize();let g=S.width,V=S.height;0!==j&&(g/=Math.pow(2,j),V/=Math.pow(2,j),g=Math.round(g),V=Math.round(V)),u=Math.min(g,u),a=Math.min(V,a);try{return this._texture.isCube?D._readTexturePixels(this._texture,u,a,L,j,P,A,R,o,Y):D._readTexturePixels(this._texture,u,a,-1,j,P,A,R,o,Y)}catch(N){return null}}_readPixelsSync(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],R=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const o=this.getSize();let Y=o.width,u=o.height;const a=this._getEngine();if(!a)return null;0!=j&&(Y/=Math.pow(2,j),u/=Math.pow(2,j),Y=Math.round(Y),u=Math.round(u));try{return this._texture.isCube?a._readTexturePixelsSync(this._texture,Y,u,L,j,P,A,R):a._readTexturePixelsSync(this._texture,Y,u,-1,j,P,A,R)}catch(D){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const L=this._scene.textures.indexOf(this);if(L>=0&&this._scene.textures.splice(L,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const L=this._parentContainer.textures.indexOf(this);L>-1&&this._parentContainer.textures.splice(L,1),this._parentContainer=null}}this.Oi.notifyObservers(this),this.Oi.clear(),this.metadata=null,super.dispose()}serialize(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!L)return null;const j=g.e.Serialize(this);return g.e.AppendSerializedAnimations(this,j),j}static WhenAllReady(L,j){let P=L.length;if(0!==P)for(let A=0;A<L.length;A++){const R=L[A];if(R.isReady())0===--P&&j();else{const L=R.onLoadObservable;L?L.addOnce((()=>{0===--P&&j()})):0===--P&&j()}}else j()}static _IsScene(L){return"Scene"===L.getClassName()}}V.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,A.b)([(0,R.K)()],V.prototype,"uniqueId",void 0),(0,A.b)([(0,R.K)()],V.prototype,"name",void 0),(0,A.b)([(0,R.K)()],V.prototype,"displayName",void 0),(0,A.b)([(0,R.K)()],V.prototype,"metadata",void 0),(0,A.b)([(0,R.K)("Jj")],V.prototype,"_hasAlpha",void 0),(0,A.b)([(0,R.K)("getAlphaFromRGB")],V.prototype,"_getAlphaFromRGB",void 0),(0,A.b)([(0,R.K)()],V.prototype,"level",void 0),(0,A.b)([(0,R.K)("coordinatesIndex")],V.prototype,"_coordinatesIndex",void 0),(0,A.b)([(0,R.K)()],V.prototype,"optimizeUVAllocation",void 0),(0,A.b)([(0,R.K)("coordinatesMode")],V.prototype,"_coordinatesMode",void 0),(0,A.b)([(0,R.K)()],V.prototype,"wrapU",null),(0,A.b)([(0,R.K)()],V.prototype,"wrapV",null),(0,A.b)([(0,R.K)()],V.prototype,"wrapR",void 0),(0,A.b)([(0,R.K)()],V.prototype,"anisotropicFilteringLevel",void 0),(0,A.b)([(0,R.K)()],V.prototype,"isCube",null),(0,A.b)([(0,R.K)()],V.prototype,"is3D",null),(0,A.b)([(0,R.K)()],V.prototype,"is2DArray",null),(0,A.b)([(0,R.K)()],V.prototype,"gammaSpace",null),(0,A.b)([(0,R.K)()],V.prototype,"invertZ",void 0),(0,A.b)([(0,R.K)()],V.prototype,"lodLevelInAlpha",void 0),(0,A.b)([(0,R.K)()],V.prototype,"lodGenerationOffset",null),(0,A.b)([(0,R.K)()],V.prototype,"lodGenerationScale",null),(0,A.b)([(0,R.K)()],V.prototype,"linearSpecularLOD",null),(0,A.b)([(0,R.E)()],V.prototype,"irradianceTexture",null),(0,A.b)([(0,R.K)()],V.prototype,"isRenderTarget",void 0)},2032:(L,j,P)=>{P.d(j,{e:()=>v});var A=P(636),R=P(639),o=P(469),Y=P(656),u=P(2034),a=P(606),D=P(505),S=P(550),g=P(604),V=P(701),N=P(533);function C(L,j){let P=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const A=j.width,R=j.height;if(L instanceof Float32Array){let j=L.byteLength/L.BYTES_PER_ELEMENT;const P=new Uint8Array(j);for(;--j>=0;){let A=L[j];A<0?A=0:A>1&&(A=1),P[j]=255*A}L=P}const o=document.createElement("canvas");o.width=A,o.height=R;const Y=o.getContext("2d");if(!Y)return null;const u=Y.createImageData(A,R);if(u.data.set(L),Y.putImageData(u,0,0),P){const L=document.createElement("canvas");L.width=A,L.height=R;const j=L.getContext("2d");return j?(j.translate(0,R),j.scale(1,-1),j.drawImage(o,0,0),L.toDataURL("image/png")):null}return o.toDataURL("image/png")}function b(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const A=L.getInternalTexture();if(!A)return null;const R=L._readPixelsSync(j,P);return R?C(R,L.getSize(),A.invertY):null}async function f(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const A=L.getInternalTexture();if(!A)return null;const R=await L.readPixels(j,P);return R?C(R,L.getSize(),A.invertY):null}var h=P(771),K=P(680);class v extends u.c{static _CreateVideoTexture(L,j,P){arguments.length>5&&void 0!==arguments[5]||v.TRILINEAR_SAMPLINGMODE;throw(0,D.b)("VideoTexture")}get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(L){this._isBlocking=L}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(L,j,P,A){let R,Y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v.TRILINEAR_SAMPLINGMODE,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,D=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,g=arguments.length>8&&void 0!==arguments[8]&&arguments[8],V=arguments.length>9?arguments[9]:void 0,N=arguments.length>10?arguments[10]:void 0,C=arguments.length>11?arguments[11]:void 0,b=arguments.length>12?arguments[12]:void 0,f=arguments.length>13?arguments[13]:void 0;super(j),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedIdentity3x2=!0,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new o.e,this._isBlocking=!0,this.name=L||"",this.url=L;let K=!1,q=null,y=!0;"object"===typeof P&&null!==P?(R=P.noMipmap??!1,A=P.invertY??!h.c,Y=P.samplingMode??v.TRILINEAR_SAMPLINGMODE,u=P.X??null,a=P.onError??null,D=P.buffer??null,g=P.deleteBuffer??!1,V=P.format,N=P.mimeType,C=P.loaderOptions,b=P.creationFlags,K=P.useSRGBBuffer??!1,q=P.internalTexture??null,y=P.gammaSpace??y,f=P.forcedExtension??f):R=!!P,this._gammaSpace=y,this._noMipmap=R,this._invertY=void 0===A?!h.c:A,this._initialSamplingMode=Y,this._buffer=D,this._deleteBuffer=g,this._mimeType=N,this._loaderOptions=C,this._creationFlags=b,this._useSRGBBuffer=K,this._forcedExtension=f,void 0!==V&&(this._format=V);const T=this.va(),G=this._getEngine();if(!G)return;G.onBeforeTextureInitObservable.notifyObservers(this);const M=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),u&&u(),!this.isBlocking&&T&&T.resetCachedMaterial()},Q=(L,j)=>{this._loadingError=!0,this._errorObject={message:L,exception:j},a&&a(L,j),v.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!q)return this._delayedOnLoad=M,void(this._delayedOnError=Q);if(this._texture=q??this._getFromCache(this.url,R,Y,this._invertY,K,this.isCube),this._texture)if(this._texture.isReady)S.c.SetImmediate((()=>M()));else{const L=this._texture.onLoadedObservable.add(M);this._texture.onErrorObservable.add((j=>{var P;Q(j.message,j.exception),null===(P=this._texture)||void 0===P||P.onLoadedObservable.remove(L)}))}else if(T&&T.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=M,this._delayedOnError=Q;else{try{this._texture=G.createTexture(this.url,R,this._invertY,T,Y,M,Q,this._buffer,void 0,this._format,this._forcedExtension,N,C,b,K)}catch(l){throw Q("error loading",l),l}g&&(this._buffer=null)}}updateURL(L){let j=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,P=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.va().markAllMaterialsAsDirty(1,(L=>L.hasTexture(this)))),this.name&&!this.name.startsWith("data:")||(this.name=L),this.url=L,this._buffer=j,this._forcedExtension=A,this.delayLoadState=4,P&&(this._delayedOnLoad=P),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const L=this.va();L&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer,this.isCube),this._texture?this._delayedOnLoad&&(this._texture.isReady?S.c.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=L.getEngine().createTexture(this.url,this._noMipmap,this._invertY,L,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(L,j,P,A){L*=this._cachedUScale,j*=this._cachedVScale,L-=this.uRotationCenter*this._cachedUScale,j-=this.vRotationCenter*this._cachedVScale,P-=this.wRotationCenter,Y.r.TransformCoordinatesFromFloatsToRef(L,j,P,this._rowGenerationMatrix,A),A.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,A.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,A.z+=this.wRotationCenter}getTextureMatrix(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*L===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*L,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=Y.e.Zero(),this._rowGenerationMatrix=new Y.e,this._t0=Y.r.Zero(),this._t1=Y.r.Zero(),this._t2=Y.r.Zero()),Y.e.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(Y.e.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,Y.m.Matrix[0]),Y.e.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,Y.m.Matrix[1]),Y.e.ScalingToRef(this._cachedUScale,this._cachedVScale,0,Y.m.Matrix[2]),Y.e.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,Y.m.Matrix[3]),Y.m.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(Y.m.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(Y.m.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(Y.m.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.Wi(this._t0),this._t2.Wi(this._t0),Y.e.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const j=this.va();if(!j)return this._cachedTextureMatrix;const P=this._cachedIdentity3x2;return this._cachedIdentity3x2=this._cachedTextureMatrix.isIdentityAs3x2(),this.optimizeUVAllocation&&P!==this._cachedIdentity3x2&&j.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))),this._cachedTextureMatrix}getReflectionTextureMatrix(){const L=this.va();if(!L)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==v.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===L.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=Y.e.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=Y.e.Zero());const j=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case v.PLANAR_MODE:Y.e.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case v.PROJECTION_MODE:{Y.e.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const j=L.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=j.updateFlag,j.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:Y.e.IdentityToRef(this._cachedReflectionTextureMatrix)}return j&&L.markAllMaterialsAsDirty(1,(L=>L.hasTexture(this))),this._cachedReflectionTextureMatrix}clone(){const L={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,X:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return K.e.Clone((()=>new v(this._texture?this._texture.url:null,this.va(),L)),this)}serialize(){var L;const j=this.name;v.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const P=super.serialize(v._SerializeInternalTextureUniqueId);if(!P)return null;if(v.SerializeBuffers||v.ForceSerializeBuffers)if("string"===typeof this._buffer&&this._buffer.startsWith("data:"))P.base64String=this._buffer,P.name=P.name.replace("data:","");else if(this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array){const L=this.mimeType||"image/png";P.base64String=`data:${L};base64,${(0,N.i)(this._buffer)}`}else(v.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(P.base64String=!this._engine||this._engine._features.supportSyncTextureRead?b(this):f(this));var A;(P.invertY=this._invertY,P.samplingMode=this.samplingMode,P._creationFlags=this._creationFlags,P._useSRGBBuffer=this._useSRGBBuffer,v._SerializeInternalTextureUniqueId)&&(P.internalTextureUniqueId=null===(A=this._texture)||void 0===A?void 0:A.uniqueId);return P.internalTextureLabel=null===(L=this._texture)||void 0===L?void 0:L.label,P.noMipmap=this._noMipmap,this.name=j,P}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(L,j,P){if(L.customType){const A=g.c.Instantiate(L.customType).Parse(L,j,P);return L.samplingMode&&A.updateSamplingMode&&A._samplingMode&&A._samplingMode!==L.samplingMode&&A.updateSamplingMode(L.samplingMode),A}if(L.isCube&&!L.isRenderTarget)return v._CubeTextureParser(L,j,P);const A=void 0!==L.internalTextureUniqueId;if(!L.name&&!L.isRenderTarget&&!A)return null;let R;if(A){const P=j.getEngine().getLoadedTexturesCache();for(const j of P)if(j.uniqueId===L.internalTextureUniqueId){R=j;break}}const o=j=>{if(j&&j._texture&&(j._texture._cachedWrapU=null,j._texture._cachedWrapV=null,j._texture._cachedWrapR=null),L.samplingMode){const P=L.samplingMode;j&&j.samplingMode!==P&&j.updateSamplingMode(P)}if(j&&L.animations)for(let P=0;P<L.animations.length;P++){const A=L.animations[P],R=(0,a.e)("BABYLON.Animation");R&&j.animations.push(R.Parse(A))}j&&j._texture&&(A&&!R&&j._texture._setUniqueId(L.internalTextureUniqueId),j._texture.label=L.internalTextureLabel)};return K.e.Parse((()=>{let A=!0;if(L.noMipmap&&(A=!1),L.mirrorPlane){const P=v._CreateMirror(L.name,L.renderTargetSize,j,A);return P._waitingRenderList=L.renderList,P.mirrorPlane=V.c.ri(L.mirrorPlane),o(P),P}if(L.isRenderTarget){let P=null;if(L.isCube){if(j.reflectionProbes)for(let A=0;A<j.reflectionProbes.length;A++){const P=j.reflectionProbes[A];if(P.name===L.name)return P.cubeTexture}}else P=v._CreateRenderTargetTexture(L.name,L.renderTargetSize,j,A,L._creationFlags??0),P._waitingRenderList=L.renderList;return o(P),P}if(L.isVideo){const R=v._CreateVideoTexture(P+(L.url||L.name),P+(L.src||L.url),j,A,L.invertY,L.samplingMode,L.settings||{});return o(R),R}{let Y;if(L.base64String&&!R)Y=v.CreateFromBase64String(L.base64String,L.base64String,j,!A,L.invertY,L.samplingMode,(()=>{o(Y)}),L._creationFlags??0,L._useSRGBBuffer??!1),Y.name=L.name;else{let u;u=L.name&&(L.name.indexOf("://")>0||L.name.startsWith("data:"))?L.name:P+L.name,L.url&&(L.url.startsWith("data:")||v.UseSerializedUrlIfAny)&&(u=L.url);const a={noMipmap:!A,invertY:L.invertY,samplingMode:L.samplingMode,X:()=>{o(Y)},internalTexture:R};Y=new v(u,j,a)}return Y}}),L,j)}static CreateFromBase64String(L,j,P,A,R){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v.TRILINEAR_SAMPLINGMODE;return new v("data:"+j,P,A,R,o,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,L,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0,arguments.length>10?arguments[10]:void 0)}static LoadFromDataString(L,j,P){let A=arguments.length>3&&void 0!==arguments[3]&&arguments[3],R=arguments.length>4?arguments[4]:void 0,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],Y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:v.TRILINEAR_SAMPLINGMODE,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,a=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,D=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,S=arguments.length>10?arguments[10]:void 0,g=arguments.length>11?arguments[11]:void 0;return"data:"!==L.substring(0,5)&&(L="data:"+L),new v(L,P,R,o,Y,u,a,j,A,D,void 0,void 0,S,g)}}v.SerializeBuffers=!0,v.ForceSerializeBuffers=!1,v.OnTextureLoadErrorObservable=new o.e,v._SerializeInternalTextureUniqueId=!1,v._CubeTextureParser=(L,j,P)=>{throw(0,D.b)("CubeTexture")},v._CreateMirror=(L,j,P,A)=>{throw(0,D.b)("MirrorTexture")},v._CreateRenderTargetTexture=(L,j,P,A,R)=>{throw(0,D.b)("RenderTargetTexture")},v.NEAREST_SAMPLINGMODE=1,v.NEAREST_NEAREST_MIPLINEAR=8,v.BILINEAR_SAMPLINGMODE=2,v.LINEAR_LINEAR_MIPNEAREST=11,v.TRILINEAR_SAMPLINGMODE=3,v.LINEAR_LINEAR_MIPLINEAR=3,v.NEAREST_NEAREST_MIPNEAREST=4,v.NEAREST_LINEAR_MIPNEAREST=5,v.NEAREST_LINEAR_MIPLINEAR=6,v.NEAREST_LINEAR=7,v.NEAREST_NEAREST=1,v.LINEAR_NEAREST_MIPNEAREST=9,v.LINEAR_NEAREST_MIPLINEAR=10,v.LINEAR_LINEAR=2,v.LINEAR_NEAREST=12,v.EXPLICIT_MODE=0,v.SPHERICAL_MODE=1,v.PLANAR_MODE=2,v.CUBIC_MODE=3,v.PROJECTION_MODE=4,v.SKYBOX_MODE=5,v.INVCUBIC_MODE=6,v.EQUIRECTANGULAR_MODE=7,v.FIXED_EQUIRECTANGULAR_MODE=8,v.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,v.CLAMP_ADDRESSMODE=0,v.WRAP_ADDRESSMODE=1,v.MIRROR_ADDRESSMODE=2,v.UseSerializedUrlIfAny=!1,(0,A.b)([(0,R.K)()],v.prototype,"url",void 0),(0,A.b)([(0,R.K)()],v.prototype,"uOffset",void 0),(0,A.b)([(0,R.K)()],v.prototype,"vOffset",void 0),(0,A.b)([(0,R.K)()],v.prototype,"uScale",void 0),(0,A.b)([(0,R.K)()],v.prototype,"vScale",void 0),(0,A.b)([(0,R.K)()],v.prototype,"uAng",void 0),(0,A.b)([(0,R.K)()],v.prototype,"vAng",void 0),(0,A.b)([(0,R.K)()],v.prototype,"wAng",void 0),(0,A.b)([(0,R.K)()],v.prototype,"uRotationCenter",void 0),(0,A.b)([(0,R.K)()],v.prototype,"vRotationCenter",void 0),(0,A.b)([(0,R.K)()],v.prototype,"wRotationCenter",void 0),(0,A.b)([(0,R.K)()],v.prototype,"homogeneousRotationInUVTransform",void 0),(0,A.b)([(0,R.K)()],v.prototype,"isBlocking",null),(0,a.h)("BABYLON.Texture",v),K.e._TextureParser=v.Parse},2008:(L,j,P)=>{P.d(j,{d:()=>A});class A{constructor(L,j){this.width=L,this.height=j}toString(){return`{W: ${this.width}, H: ${this.height}}`}getClassName(){return"Size"}getHashCode(){let L=0|this.width;return L=397*L^this.height,L}p(L){this.width=L.width,this.height=L.height}li(L,j){return this.width=L,this.height=j,this}set(L,j){return this.li(L,j)}multiplyByFloats(L,j){return new A(this.width*L,this.height*j)}clone(){return new A(this.width,this.height)}equals(L){return!!L&&(this.width===L.width&&this.height===L.height)}get surface(){return this.width*this.height}static Zero(){return new A(0,0)}add(L){return new A(this.width+L.width,this.height+L.height)}xg(L){return new A(this.width-L.width,this.height-L.height)}scale(L){return new A(this.width*L,this.height*L)}static Lerp(L,j,P){const R=L.width+(j.width-L.width)*P,o=L.height+(j.height-L.height)*P;return new A(R,o)}}}}]);