"use strict";(self.kdlk57exiqh=self.kdlk57exiqh||[]).push([[29],{13839:(i,x,e)=>{var j=e(12181),E=e(12072),a=e(12115),Y=e(12213),J=e(12150),u=e(12194);J.c.prototype._partialLoadFile=function(i,x,e,j){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(i,(i=>{e[x]=i,e._internalCount++,6===e._internalCount&&j(e)}),void 0,void 0,!0,((i,x)=>{E&&i&&E(i.status+" "+i.statusText,x)}))},J.c.prototype._cascadeLoadFiles=function(i,x,e){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const E=[];E._internalCount=0;for(let a=0;a<6;a++)this._partialLoadFile(e[a],a,E,x,j)},J.c.prototype._cascadeLoadImgs=function(i,x,e,j){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5?arguments[5]:void 0;const Y=[];Y._internalCount=0;for(let J=0;J<6;J++)this._partialLoadImg(j[J],J,Y,i,x,e,E,a)},J.c.prototype._partialLoadImg=function(i,x,e,j,E,J){let u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,b=arguments.length>7?arguments[7]:void 0;const g=(0,Y.b)();(0,a.r)(i,(i=>{e[x]=i,e._internalCount++,j&&j.removePendingData(g),6===e._internalCount&&J&&J(E,e)}),((i,x)=>{j&&j.removePendingData(g),u&&u(i,x)}),j?j.offlineProvider:null,b),j&&j.addPendingData(g)},J.c.prototype.createCubeTextureBase=function(i,x,e,a){let Y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,b=arguments.length>6?arguments[6]:void 0,g=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,A=arguments.length>8&&void 0!==arguments[8]&&arguments[8],K=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,L=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,o=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,M=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,z=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,T=arguments.length>14&&void 0!==arguments[14]&&arguments[14],Q=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const t=o||new j.b(this,7);t.isCube=!0,t.url=i,t.generateMipMaps=!a,t._lodGenerationScale=K,t._lodGenerationOffset=L,t._useSRGBBuffer=!!T&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!a),t!==o&&(t.label=i.substring(0,60)),this._doNotHandleContextLost||(t._extension=g,t._files=e,t._buffer=Q);const V=i;this._transformTextureUrl&&!o&&(i=this._transformTextureUrl(i));const S=g??function(i){const x=i.split("?")[0],e=x.lastIndexOf(".");return e>-1?x.substring(e).toLowerCase():""}(i),f=(0,u.e)(S),w=(i,x)=>{t.dispose(),J?J(i,x):i&&E.c.Warn(i)},O=(j,J)=>{i===V?j&&w(j.status+" "+j.statusText,J):(E.c.Warn(`Failed to load ${i}, falling back to the ${V}`),this.createCubeTextureBase(V,x,e,!!a,Y,w,b,g,A,K,L,t,M,z,T,Q))};if(f)f.then((j=>{const E=i=>{M&&M(t,i),j.loadCubeData(i,t,A,Y,((i,x)=>{w(i,x)}))};Q?E(Q):e&&6===e.length?j.supportCascades?this._cascadeLoadFiles(x,(i=>E(i.map((i=>new Uint8Array(i))))),e,w):w("Textures type does not support cascades."):this._loadFile(i,(i=>E(new Uint8Array(i))),void 0,void 0,!0,O)}));else{if(!e||0===e.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(x,t,((i,x)=>{z&&z(i,x)}),e,w)}return this._internalTexturesCache.push(t),t}},12747:(i,x,e)=>{e.d(x,{b:()=>b});var j=e(12250),E=e(12264),a=e(12413),Y=e(12253),J=e(12286);class u{constructor(i,x,e,j){this.name=i,this.worldAxisForNormal=x,this.worldAxisForFileX=e,this.worldAxisForFileY=j}}class b{static ConvertCubeMapTextureToSphericalPolynomial(i){var x;if(!i.isCube)return null;null===(x=i.wi())||void 0===x||x.getEngine().flushFramebuffer();const e=i.getSize().width,j=i.readPixels(0,void 0,void 0,!1),E=i.readPixels(1,void 0,void 0,!1);let a,Y;i.isRenderTarget?(a=i.readPixels(3,void 0,void 0,!1),Y=i.readPixels(2,void 0,void 0,!1)):(a=i.readPixels(2,void 0,void 0,!1),Y=i.readPixels(3,void 0,void 0,!1));const J=i.readPixels(4,void 0,void 0,!1),u=i.readPixels(5,void 0,void 0,!1),b=i.gammaSpace;let g=0;return 1!=i.textureType&&2!=i.textureType||(g=1),new Promise((i=>{Promise.all([E,j,a,Y,J,u]).then((x=>{let[j,E,a,Y,J,u]=x;const A={size:e,right:E,left:j,up:a,down:Y,front:J,back:u,format:5,type:g,gammaSpace:b};i(this.ConvertCubeMapToSphericalPolynomial(A))}))}))}static _AreaElement(i,x){return Math.atan2(i*x,Math.sqrt(i*i+x*x+1))}static ConvertCubeMapToSphericalPolynomial(i){const x=new a.d;let e=0;const j=2/i.size,u=j,b=.5*j,g=b-1;for(let a=0;a<6;a++){const A=this._FileFaces[a],K=i[A.name];let L=g;const o=5===i.format?4:3;for(let a=0;a<i.size;a++){let M=g;for(let u=0;u<i.size;u++){const g=A.worldAxisForFileX.scale(M).add(A.worldAxisForFileY.scale(L)).add(A.worldAxisForNormal);g.normalize();const z=this._AreaElement(M-b,L-b)-this._AreaElement(M-b,L+b)-this._AreaElement(M+b,L-b)+this._AreaElement(M+b,L+b);let T=K[a*i.size*o+u*o+0],Q=K[a*i.size*o+u*o+1],t=K[a*i.size*o+u*o+2];isNaN(T)&&(T=0),isNaN(Q)&&(Q=0),isNaN(t)&&(t=0),0===i.type&&(T/=255,Q/=255,t/=255),i.gammaSpace&&(T=Math.pow((0,E.Clamp)(T),Y.m),Q=Math.pow((0,E.Clamp)(Q),Y.m),t=Math.pow((0,E.Clamp)(t),Y.m));const V=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const i=Math.max(T,Q,t);if(i>V){const x=V/i;T*=x,Q*=x,t*=x}}else T=(0,E.Clamp)(T,0,V),Q=(0,E.Clamp)(Q,0,V),t=(0,E.Clamp)(t,0,V);const S=new J.MJ(T,Q,t);x.addLight(g,S,z),e+=z,M+=j}L+=u}}const A=6*(4*Math.PI)/6/e;return x.scaleInPlace(A),x.convertIncidentRadianceToIrradiance(),x.convertIrradianceToLambertianRadiance(),a.g.FromHarmonics(x)}}b._FileFaces=[new u("right",new j.KJ(1,0,0),new j.KJ(0,0,-1),new j.KJ(0,-1,0)),new u("left",new j.KJ(-1,0,0),new j.KJ(0,0,1),new j.KJ(0,-1,0)),new u("up",new j.KJ(0,1,0),new j.KJ(1,0,0),new j.KJ(0,0,1)),new u("down",new j.KJ(0,-1,0),new j.KJ(1,0,0),new j.KJ(0,0,-1)),new u("front",new j.KJ(0,0,1),new j.KJ(1,0,0),new j.KJ(0,-1,0)),new u("back",new j.KJ(0,0,-1),new j.KJ(-1,0,0),new j.KJ(0,-1,0))],b.MAX_HDRI_VALUE=4096,b.PRESERVE_CLAMPED_COLORS=!1},14601:(i,x,e)=>{e.d(x,{DDSTools:()=>o});var j=e(12264),E=e(12072),a=e(12747),Y=e(12442);e(13839);const J=131072,u=131072;function b(i){return i.charCodeAt(0)+(i.charCodeAt(1)<<8)+(i.charCodeAt(2)<<16)+(i.charCodeAt(3)<<24)}const g=b("DXT1"),A=b("DXT3"),K=b("DXT5"),L=b("DX10");class o{static GetDDSInfo(i){const x=new Int32Array(i.buffer,i.byteOffset,31),e=new Int32Array(i.buffer,i.byteOffset,35);let j=1;x[2]&J&&(j=Math.max(1,x[7]));const E=x[21],a=E===L?e[32]:0;let Y=0;switch(E){case 113:Y=2;break;case 116:Y=1;break;case L:if(10===a){Y=2;break}if(2===a){Y=1;break}}return{width:x[4],height:x[3],mipmapCount:j,isFourCC:4===(4&x[20]),isRGB:64===(64&x[20]),isLuminance:(x[20]&u)===u,isCube:512===(512&x[28]),isCompressed:E===g||E===A||E===K,dxgiFormat:a,textureType:Y}}static _GetHalfFloatAsFloatRGBAArrayBuffer(i,x,e,j,E,a){const J=new Float32Array(j),u=new Uint16Array(E,e);let b=0;for(let g=0;g<x;g++)for(let x=0;x<i;x++){const e=4*(x+g*i);J[b]=(0,Y.e)(u[e]),J[b+1]=(0,Y.e)(u[e+1]),J[b+2]=(0,Y.e)(u[e+2]),o.StoreLODInAlphaChannel?J[b+3]=a:J[b+3]=(0,Y.e)(u[e+3]),b+=4}return J}static _GetHalfFloatRGBAArrayBuffer(i,x,e,j,E,a){if(o.StoreLODInAlphaChannel){const J=new Uint16Array(j),u=new Uint16Array(E,e);let b=0;for(let e=0;e<x;e++)for(let x=0;x<i;x++){const j=4*(x+e*i);J[b]=u[j],J[b+1]=u[j+1],J[b+2]=u[j+2],J[b+3]=(0,Y.k)(a),b+=4}return J}return new Uint16Array(E,e,j)}static _GetFloatRGBAArrayBuffer(i,x,e,j,E,a){if(o.StoreLODInAlphaChannel){const Y=new Float32Array(j),J=new Float32Array(E,e);let u=0;for(let e=0;e<x;e++)for(let x=0;x<i;x++){const j=4*(x+e*i);Y[u]=J[j],Y[u+1]=J[j+1],Y[u+2]=J[j+2],Y[u+3]=a,u+=4}return Y}return new Float32Array(E,e,j)}static _GetFloatAsHalfFloatRGBAArrayBuffer(i,x,e,j,E,a){const J=new Uint16Array(j),u=new Float32Array(E,e);let b=0;for(let g=0;g<x;g++)for(let x=0;x<i;x++)J[b]=(0,Y.k)(u[b]),J[b+1]=(0,Y.k)(u[b+1]),J[b+2]=(0,Y.k)(u[b+2]),o.StoreLODInAlphaChannel?J[b+3]=(0,Y.k)(a):J[b+3]=(0,Y.k)(u[b+3]),b+=4;return J}static _GetFloatAsUIntRGBAArrayBuffer(i,x,e,E,a,Y){const J=new Uint8Array(E),u=new Float32Array(a,e);let b=0;for(let g=0;g<x;g++)for(let x=0;x<i;x++){const e=4*(x+g*i);J[b]=255*(0,j.Clamp)(u[e]),J[b+1]=255*(0,j.Clamp)(u[e+1]),J[b+2]=255*(0,j.Clamp)(u[e+2]),o.StoreLODInAlphaChannel?J[b+3]=Y:J[b+3]=255*(0,j.Clamp)(u[e+3]),b+=4}return J}static _GetHalfFloatAsUIntRGBAArrayBuffer(i,x,e,E,a,J){const u=new Uint8Array(E),b=new Uint16Array(a,e);let g=0;for(let A=0;A<x;A++)for(let x=0;x<i;x++){const e=4*(x+A*i);u[g]=255*(0,j.Clamp)((0,Y.e)(b[e])),u[g+1]=255*(0,j.Clamp)((0,Y.e)(b[e+1])),u[g+2]=255*(0,j.Clamp)((0,Y.e)(b[e+2])),o.StoreLODInAlphaChannel?u[g+3]=J:u[g+3]=255*(0,j.Clamp)((0,Y.e)(b[e+3])),g+=4}return u}static _GetRGBAArrayBuffer(i,x,e,j,E,a,Y,J,u){const b=new Uint8Array(j),g=new Uint8Array(E,e);let A=0;for(let K=0;K<x;K++)for(let x=0;x<i;x++){const e=4*(x+K*i);b[A]=g[e+a],b[A+1]=g[e+Y],b[A+2]=g[e+J],b[A+3]=g[e+u],A+=4}return b}static _ExtractLongWordOrder(i){return 0===i||255===i||-16777216===i?0:1+o._ExtractLongWordOrder(i>>8)}static _GetRGBArrayBuffer(i,x,e,j,E,a,Y,J){const u=new Uint8Array(j),b=new Uint8Array(E,e);let g=0;for(let A=0;A<x;A++)for(let x=0;x<i;x++){const e=3*(x+A*i);u[g]=b[e+a],u[g+1]=b[e+Y],u[g+2]=b[e+J],g+=3}return u}static _GetLuminanceArrayBuffer(i,x,e,j,E){const a=new Uint8Array(j),Y=new Uint8Array(E,e);let J=0;for(let u=0;u<x;u++)for(let x=0;x<i;x++){const e=x+u*i;a[J]=Y[e],J++}return a}static UploadDDSLevels(i,x,e,j,Y,u){let b=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,M=arguments.length>7?arguments[7]:void 0,z=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],T=null;j.sphericalPolynomial&&(T=[]);const Q=!!i.getCaps().s3tc;x.generateMipMaps=Y;const t=new Int32Array(e.buffer,e.byteOffset,31);let V,S,f,w,O,l,Z,B=0,k=0,N=1;if(542327876!==t[0])return void E.c.Error("Invalid magic number in DDS header");if(!j.isFourCC&&!j.isRGB&&!j.isLuminance)return void E.c.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(j.isCompressed&&!Q)return void E.c.Error("Compressed textures are not supported on this platform.");let mi=t[22];w=t[1]+4;let X=!1;if(j.isFourCC)switch(V=t[21],V){case g:N=8,k=33777;break;case A:N=16,k=33778;break;case K:N=16,k=33779;break;case 113:X=!0,mi=64;break;case 116:X=!0,mi=128;break;case L:{w+=20;let i=!1;switch(j.dxgiFormat){case 10:X=!0,mi=64,i=!0;break;case 2:X=!0,mi=128,i=!0;break;case 88:j.isRGB=!0,j.isFourCC=!1,mi=32,i=!0}if(i)break}default:return void E.c.Error(["Unsupported FourCC code:",(C=V,String.fromCharCode(255&C,C>>8&255,C>>16&255,C>>24&255))])}var C;const n=o._ExtractLongWordOrder(t[23]),I=o._ExtractLongWordOrder(t[24]),d=o._ExtractLongWordOrder(t[25]),p=o._ExtractLongWordOrder(t[26]);X&&(k=i._getRGBABufferInternalSizedFormat(j.textureType)),l=1,t[2]&J&&!1!==Y&&(l=Math.max(1,t[7]));const H=M||0,U=i.getCaps();for(let E=H;E<u;E++){for(S=t[4],f=t[3],Z=0;Z<l;++Z){if(-1===b||b===Z){const a=-1===b?Z:0;if(!j.isCompressed&&j.isFourCC){x.format=5,B=S*f*4;let j=null;if(i._badOS||i._badDesktopOS||!U.textureHalfFloat&&!U.textureFloat)128===mi?(j=o._GetFloatAsUIntRGBAArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,a),T&&0==a&&T.push(o._GetFloatRGBAArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,a))):64===mi&&(j=o._GetHalfFloatAsUIntRGBAArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,a),T&&0==a&&T.push(o._GetHalfFloatAsFloatRGBAArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,a))),x.type=0;else{const i=U.textureFloat&&(z&&U.textureFloatLinearFiltering||!z),E=U.textureHalfFloat&&(z&&U.textureHalfFloatLinearFiltering||!z),Y=(128===mi||64===mi&&!E)&&i?1:(64===mi||128===mi&&!i)&&E?2:0;let J,u=null;if(128===mi)switch(Y){case 1:J=o._GetFloatRGBAArrayBuffer,u=null;break;case 2:J=o._GetFloatAsHalfFloatRGBAArrayBuffer,u=o._GetFloatRGBAArrayBuffer;break;case 0:J=o._GetFloatAsUIntRGBAArrayBuffer,u=o._GetFloatRGBAArrayBuffer}else switch(Y){case 1:J=o._GetHalfFloatAsFloatRGBAArrayBuffer,u=null;break;case 2:J=o._GetHalfFloatRGBAArrayBuffer,u=o._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:J=o._GetHalfFloatAsUIntRGBAArrayBuffer,u=o._GetHalfFloatAsFloatRGBAArrayBuffer}x.type=Y,j=J(S,f,e.byteOffset+w,B,e.buffer,a),T&&0==a&&T.push(u?u(S,f,e.byteOffset+w,B,e.buffer,a):j)}j&&i._uploadDataToTextureDirectly(x,j,E,a)}else if(j.isRGB)x.type=0,24===mi?(x.format=4,B=S*f*3,O=o._GetRGBArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,n,I,d),i._uploadDataToTextureDirectly(x,O,E,a)):(x.format=5,B=S*f*4,O=o._GetRGBAArrayBuffer(S,f,e.byteOffset+w,B,e.buffer,n,I,d,p),i._uploadDataToTextureDirectly(x,O,E,a));else if(j.isLuminance){const j=i._getUnpackAlignement(),Y=S;B=Math.floor((S+j-1)/j)*j*(f-1)+Y,O=o._GetLuminanceArrayBuffer(S,f,e.byteOffset+w,B,e.buffer),x.format=1,x.type=0,i._uploadDataToTextureDirectly(x,O,E,a)}else B=Math.max(4,S)/4*Math.max(4,f)/4*N,O=new Uint8Array(e.buffer,e.byteOffset+w,B),x.type=0,i._uploadCompressedDataToTextureDirectly(x,k,S,f,O,E,a)}w+=mi?S*f*(mi/8):B,S*=.5,f*=.5,S=Math.max(1,S),f=Math.max(1,f)}if(void 0!==M)break}T&&T.length>0?j.sphericalPolynomial=a.b.ConvertCubeMapToSphericalPolynomial({size:t[4],right:T[0],left:T[1],up:T[2],down:T[3],front:T[4],back:T[5],format:5,type:1,gammaSpace:!1}):j.sphericalPolynomial=void 0}}o.StoreLODInAlphaChannel=!1}}]);