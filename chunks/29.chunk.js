"use strict";(self["80dd64vgxnn"]=self["80dd64vgxnn"]||[]).push([[29],{14234:(mm,o,u)=>{var f=u(12675),B=u(12565),O=u(12605),r=u(12711),w=u(12638),p=u(12687);w.c.prototype._partialLoadFile=function(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(mm,(mm=>{u[o]=mm,u._internalCount++,6===u._internalCount&&f(u)}),void 0,void 0,!0,((mm,o)=>{B&&mm&&B(mm.status+" "+mm.statusText,o)}))},w.c.prototype._cascadeLoadFiles=function(mm,o,u){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const B=[];B._internalCount=0;for(let O=0;O<6;O++)this._partialLoadFile(u[O],O,B,o,f)},w.c.prototype._cascadeLoadImgs=function(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,O=arguments.length>5?arguments[5]:void 0;const r=[];r._internalCount=0;for(let w=0;w<6;w++)this._partialLoadImg(f[w],w,r,mm,o,u,B,O)},w.c.prototype._partialLoadImg=function(mm,o,u,f,B,w){let p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,K=arguments.length>7?arguments[7]:void 0;const z=(0,r.d)();(0,O.q)(mm,(mm=>{u[o]=mm,u._internalCount++,f&&f.removePendingData(z),6===u._internalCount&&w&&w(B,u)}),((mm,o)=>{f&&f.removePendingData(z),p&&p(mm,o)}),f?f.offlineProvider:null,K),f&&f.addPendingData(z)},w.c.prototype.createCubeTextureBase=function(mm,o,u,O){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,w=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,K=arguments.length>6?arguments[6]:void 0,z=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Y=arguments.length>8&&void 0!==arguments[8]&&arguments[8],q=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,x=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,H=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,E=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,M=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,l=arguments.length>14&&void 0!==arguments[14]&&arguments[14],t=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const Q=H||new f.e(this,7);Q.isCube=!0,Q.url=mm,Q.generateMipMaps=!O,Q._lodGenerationScale=q,Q._lodGenerationOffset=x,Q._useSRGBBuffer=!!l&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!O),Q!==H&&(Q.label=mm.substring(0,60)),this._doNotHandleContextLost||(Q._extension=z,Q._files=u,Q._buffer=t);const b=mm;this._transformTextureUrl&&!H&&(mm=this._transformTextureUrl(mm));const J=z??function(mm){const o=mm.split("?")[0],u=o.lastIndexOf(".");return u>-1?o.substring(u).toLowerCase():""}(mm),N=(0,p.e)(J),S=(mm,o)=>{Q.dispose(),w?w(mm,o):mm&&B.e.Warn(mm)},P=(f,w)=>{mm===b?f&&S(f.status+" "+f.statusText,w):(B.e.Warn(`Failed to load ${mm}, falling back to the ${b}`),this.createCubeTextureBase(b,o,u,!!O,r,S,K,z,Y,q,x,Q,E,M,l,t))};if(N)N.then((f=>{const B=mm=>{E&&E(Q,mm),f.loadCubeData(mm,Q,Y,r,((mm,o)=>{S(mm,o)}))};t?B(t):u&&6===u.length?f.supportCascades?this._cascadeLoadFiles(o,(mm=>B(mm.map((mm=>new Uint8Array(mm))))),u,S):S("Textures type does not support cascades."):this._loadFile(mm,(mm=>B(new Uint8Array(mm))),void 0,void 0,!0,P)}));else{if(!u||0===u.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(o,Q,((mm,o)=>{M&&M(mm,o)}),u,S)}return this._internalTexturesCache.push(Q),Q}},13225:(mm,o,u)=>{u.d(o,{b:()=>K});var f=u(12740),B=u(12752),O=u(12912),r=u(12746),w=u(12780);class p{constructor(mm,o,u,f){this.name=mm,this.worldAxisForNormal=o,this.worldAxisForFileX=u,this.worldAxisForFileY=f}}class K{static ConvertCubeMapTextureToSphericalPolynomial(mm){var o;if(!mm.isCube)return null;null===(o=mm.Pm())||void 0===o||o.getEngine().flushFramebuffer();const u=mm.getSize().width,f=mm.readPixels(0,void 0,void 0,!1),B=mm.readPixels(1,void 0,void 0,!1);let O,r;mm.isRenderTarget?(O=mm.readPixels(3,void 0,void 0,!1),r=mm.readPixels(2,void 0,void 0,!1)):(O=mm.readPixels(2,void 0,void 0,!1),r=mm.readPixels(3,void 0,void 0,!1));const w=mm.readPixels(4,void 0,void 0,!1),p=mm.readPixels(5,void 0,void 0,!1),K=mm.gammaSpace;let z=0;return 1!=mm.textureType&&2!=mm.textureType||(z=1),new Promise((mm=>{Promise.all([B,f,O,r,w,p]).then((o=>{let[f,B,O,r,w,p]=o;const Y={size:u,right:B,left:f,up:O,down:r,front:w,back:p,format:5,type:z,gammaSpace:K};mm(this.ConvertCubeMapToSphericalPolynomial(Y))}))}))}static _AreaElement(mm,o){return Math.atan2(mm*o,Math.sqrt(mm*mm+o*o+1))}static ConvertCubeMapToSphericalPolynomial(mm){const o=new O.b;let u=0;const f=2/mm.size,p=f,K=.5*f,z=K-1;for(let O=0;O<6;O++){const Y=this._FileFaces[O],q=mm[Y.name];let x=z;const H=5===mm.format?4:3;for(let O=0;O<mm.size;O++){let E=z;for(let p=0;p<mm.size;p++){const z=Y.worldAxisForFileX.scale(E).add(Y.worldAxisForFileY.scale(x)).add(Y.worldAxisForNormal);z.normalize();const M=this._AreaElement(E-K,x-K)-this._AreaElement(E-K,x+K)-this._AreaElement(E+K,x-K)+this._AreaElement(E+K,x+K);let l=q[O*mm.size*H+p*H+0],t=q[O*mm.size*H+p*H+1],Q=q[O*mm.size*H+p*H+2];isNaN(l)&&(l=0),isNaN(t)&&(t=0),isNaN(Q)&&(Q=0),0===mm.type&&(l/=255,t/=255,Q/=255),mm.gammaSpace&&(l=Math.pow((0,B.Clamp)(l),r.l),t=Math.pow((0,B.Clamp)(t),r.l),Q=Math.pow((0,B.Clamp)(Q),r.l));const b=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const mm=Math.max(l,t,Q);if(mm>b){const o=b/mm;l*=o,t*=o,Q*=o}}else l=(0,B.Clamp)(l,0,b),t=(0,B.Clamp)(t,0,b),Q=(0,B.Clamp)(Q,0,b);const J=new w.No(l,t,Q);o.addLight(z,J,M),u+=M,E+=f}x+=p}}const Y=6*(4*Math.PI)/6/u;return o.scaleInPlace(Y),o.convertIncidentRadianceToIrradiance(),o.convertIrradianceToLambertianRadiance(),O.c.FromHarmonics(o)}}K._FileFaces=[new p("right",new f.lo(1,0,0),new f.lo(0,0,-1),new f.lo(0,-1,0)),new p("left",new f.lo(-1,0,0),new f.lo(0,0,1),new f.lo(0,-1,0)),new p("up",new f.lo(0,1,0),new f.lo(1,0,0),new f.lo(0,0,1)),new p("down",new f.lo(0,-1,0),new f.lo(1,0,0),new f.lo(0,0,-1)),new p("front",new f.lo(0,0,1),new f.lo(1,0,0),new f.lo(0,-1,0)),new p("back",new f.lo(0,0,-1),new f.lo(-1,0,0),new f.lo(0,-1,0))],K.MAX_HDRI_VALUE=4096,K.PRESERVE_CLAMPED_COLORS=!1},15059:(mm,o,u)=>{u.d(o,{DDSTools:()=>H});var f=u(12752),B=u(12565),O=u(13225),r=u(12952);u(14234);const w=131072,p=131072;function K(mm){return mm.charCodeAt(0)+(mm.charCodeAt(1)<<8)+(mm.charCodeAt(2)<<16)+(mm.charCodeAt(3)<<24)}const z=K("DXT1"),Y=K("DXT3"),q=K("DXT5"),x=K("DX10");class H{static GetDDSInfo(mm){const o=new Int32Array(mm.buffer,mm.byteOffset,31),u=new Int32Array(mm.buffer,mm.byteOffset,35);let f=1;o[2]&w&&(f=Math.max(1,o[7]));const B=o[21],O=B===x?u[32]:0;let r=0;switch(B){case 113:r=2;break;case 116:r=1;break;case x:if(10===O){r=2;break}if(2===O){r=1;break}}return{width:o[4],height:o[3],mipmapCount:f,isFourCC:4===(4&o[20]),isRGB:64===(64&o[20]),isLuminance:(o[20]&p)===p,isCube:512===(512&o[28]),isCompressed:B===z||B===Y||B===q,dxgiFormat:O,textureType:r}}static _GetHalfFloatAsFloatRGBAArrayBuffer(mm,o,u,f,B,O){const w=new Float32Array(f),p=new Uint16Array(B,u);let K=0;for(let z=0;z<o;z++)for(let o=0;o<mm;o++){const u=4*(o+z*mm);w[K]=(0,r.e)(p[u]),w[K+1]=(0,r.e)(p[u+1]),w[K+2]=(0,r.e)(p[u+2]),H.StoreLODInAlphaChannel?w[K+3]=O:w[K+3]=(0,r.e)(p[u+3]),K+=4}return w}static _GetHalfFloatRGBAArrayBuffer(mm,o,u,f,B,O){if(H.StoreLODInAlphaChannel){const w=new Uint16Array(f),p=new Uint16Array(B,u);let K=0;for(let u=0;u<o;u++)for(let o=0;o<mm;o++){const f=4*(o+u*mm);w[K]=p[f],w[K+1]=p[f+1],w[K+2]=p[f+2],w[K+3]=(0,r.k)(O),K+=4}return w}return new Uint16Array(B,u,f)}static _GetFloatRGBAArrayBuffer(mm,o,u,f,B,O){if(H.StoreLODInAlphaChannel){const r=new Float32Array(f),w=new Float32Array(B,u);let p=0;for(let u=0;u<o;u++)for(let o=0;o<mm;o++){const f=4*(o+u*mm);r[p]=w[f],r[p+1]=w[f+1],r[p+2]=w[f+2],r[p+3]=O,p+=4}return r}return new Float32Array(B,u,f)}static _GetFloatAsHalfFloatRGBAArrayBuffer(mm,o,u,f,B,O){const w=new Uint16Array(f),p=new Float32Array(B,u);let K=0;for(let z=0;z<o;z++)for(let o=0;o<mm;o++)w[K]=(0,r.k)(p[K]),w[K+1]=(0,r.k)(p[K+1]),w[K+2]=(0,r.k)(p[K+2]),H.StoreLODInAlphaChannel?w[K+3]=(0,r.k)(O):w[K+3]=(0,r.k)(p[K+3]),K+=4;return w}static _GetFloatAsUIntRGBAArrayBuffer(mm,o,u,B,O,r){const w=new Uint8Array(B),p=new Float32Array(O,u);let K=0;for(let z=0;z<o;z++)for(let o=0;o<mm;o++){const u=4*(o+z*mm);w[K]=255*(0,f.Clamp)(p[u]),w[K+1]=255*(0,f.Clamp)(p[u+1]),w[K+2]=255*(0,f.Clamp)(p[u+2]),H.StoreLODInAlphaChannel?w[K+3]=r:w[K+3]=255*(0,f.Clamp)(p[u+3]),K+=4}return w}static _GetHalfFloatAsUIntRGBAArrayBuffer(mm,o,u,B,O,w){const p=new Uint8Array(B),K=new Uint16Array(O,u);let z=0;for(let Y=0;Y<o;Y++)for(let o=0;o<mm;o++){const u=4*(o+Y*mm);p[z]=255*(0,f.Clamp)((0,r.e)(K[u])),p[z+1]=255*(0,f.Clamp)((0,r.e)(K[u+1])),p[z+2]=255*(0,f.Clamp)((0,r.e)(K[u+2])),H.StoreLODInAlphaChannel?p[z+3]=w:p[z+3]=255*(0,f.Clamp)((0,r.e)(K[u+3])),z+=4}return p}static _GetRGBAArrayBuffer(mm,o,u,f,B,O,r,w,p){const K=new Uint8Array(f),z=new Uint8Array(B,u);let Y=0;for(let q=0;q<o;q++)for(let o=0;o<mm;o++){const u=4*(o+q*mm);K[Y]=z[u+O],K[Y+1]=z[u+r],K[Y+2]=z[u+w],K[Y+3]=z[u+p],Y+=4}return K}static _ExtractLongWordOrder(mm){return 0===mm||255===mm||-16777216===mm?0:1+H._ExtractLongWordOrder(mm>>8)}static _GetRGBArrayBuffer(mm,o,u,f,B,O,r,w){const p=new Uint8Array(f),K=new Uint8Array(B,u);let z=0;for(let Y=0;Y<o;Y++)for(let o=0;o<mm;o++){const u=3*(o+Y*mm);p[z]=K[u+O],p[z+1]=K[u+r],p[z+2]=K[u+w],z+=3}return p}static _GetLuminanceArrayBuffer(mm,o,u,f,B){const O=new Uint8Array(f),r=new Uint8Array(B,u);let w=0;for(let p=0;p<o;p++)for(let o=0;o<mm;o++){const u=o+p*mm;O[w]=r[u],w++}return O}static UploadDDSLevels(mm,o,u,f,r,p){let K=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,E=arguments.length>7?arguments[7]:void 0,M=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],l=null;f.sphericalPolynomial&&(l=[]);const t=!!mm.getCaps().s3tc;o.generateMipMaps=r;const Q=new Int32Array(u.buffer,u.byteOffset,31);let b,J,N,S,P,R,g,W=0,F=0,c=1;if(542327876!==Q[0])return void B.e.Error("Invalid magic number in DDS header");if(!f.isFourCC&&!f.isRGB&&!f.isLuminance)return void B.e.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(f.isCompressed&&!t)return void B.e.Error("Compressed textures are not supported on this platform.");let A=Q[22];S=Q[1]+4;let y=!1;if(f.isFourCC)switch(b=Q[21],b){case z:c=8,F=33777;break;case Y:c=16,F=33778;break;case q:c=16,F=33779;break;case 113:y=!0,A=64;break;case 116:y=!0,A=128;break;case x:{S+=20;let mm=!1;switch(f.dxgiFormat){case 10:y=!0,A=64,mm=!0;break;case 2:y=!0,A=128,mm=!0;break;case 88:f.isRGB=!0,f.isFourCC=!1,A=32,mm=!0}if(mm)break}default:return void B.e.Error(["Unsupported FourCC code:",(I=b,String.fromCharCode(255&I,I>>8&255,I>>16&255,I>>24&255))])}var I;const s=H._ExtractLongWordOrder(Q[23]),j=H._ExtractLongWordOrder(Q[24]),a=H._ExtractLongWordOrder(Q[25]),X=H._ExtractLongWordOrder(Q[26]);y&&(F=mm._getRGBABufferInternalSizedFormat(f.textureType)),R=1,Q[2]&w&&!1!==r&&(R=Math.max(1,Q[7]));const G=E||0,k=mm.getCaps();for(let B=G;B<p;B++){for(J=Q[4],N=Q[3],g=0;g<R;++g){if(-1===K||K===g){const O=-1===K?g:0;if(!f.isCompressed&&f.isFourCC){o.format=5,W=J*N*4;let f=null;if(mm._badOS||mm._badDesktopOS||!k.textureHalfFloat&&!k.textureFloat)128===A?(f=H._GetFloatAsUIntRGBAArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,O),l&&0==O&&l.push(H._GetFloatRGBAArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,O))):64===A&&(f=H._GetHalfFloatAsUIntRGBAArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,O),l&&0==O&&l.push(H._GetHalfFloatAsFloatRGBAArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,O))),o.type=0;else{const mm=k.textureFloat&&(M&&k.textureFloatLinearFiltering||!M),B=k.textureHalfFloat&&(M&&k.textureHalfFloatLinearFiltering||!M),r=(128===A||64===A&&!B)&&mm?1:(64===A||128===A&&!mm)&&B?2:0;let w,p=null;if(128===A)switch(r){case 1:w=H._GetFloatRGBAArrayBuffer,p=null;break;case 2:w=H._GetFloatAsHalfFloatRGBAArrayBuffer,p=H._GetFloatRGBAArrayBuffer;break;case 0:w=H._GetFloatAsUIntRGBAArrayBuffer,p=H._GetFloatRGBAArrayBuffer}else switch(r){case 1:w=H._GetHalfFloatAsFloatRGBAArrayBuffer,p=null;break;case 2:w=H._GetHalfFloatRGBAArrayBuffer,p=H._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:w=H._GetHalfFloatAsUIntRGBAArrayBuffer,p=H._GetHalfFloatAsFloatRGBAArrayBuffer}o.type=r,f=w(J,N,u.byteOffset+S,W,u.buffer,O),l&&0==O&&l.push(p?p(J,N,u.byteOffset+S,W,u.buffer,O):f)}f&&mm._uploadDataToTextureDirectly(o,f,B,O)}else if(f.isRGB)o.type=0,24===A?(o.format=4,W=J*N*3,P=H._GetRGBArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,s,j,a),mm._uploadDataToTextureDirectly(o,P,B,O)):(o.format=5,W=J*N*4,P=H._GetRGBAArrayBuffer(J,N,u.byteOffset+S,W,u.buffer,s,j,a,X),mm._uploadDataToTextureDirectly(o,P,B,O));else if(f.isLuminance){const f=mm._getUnpackAlignement(),r=J;W=Math.floor((J+f-1)/f)*f*(N-1)+r,P=H._GetLuminanceArrayBuffer(J,N,u.byteOffset+S,W,u.buffer),o.format=1,o.type=0,mm._uploadDataToTextureDirectly(o,P,B,O)}else W=Math.max(4,J)/4*Math.max(4,N)/4*c,P=new Uint8Array(u.buffer,u.byteOffset+S,W),o.type=0,mm._uploadCompressedDataToTextureDirectly(o,F,J,N,P,B,O)}S+=A?J*N*(A/8):W,J*=.5,N*=.5,J=Math.max(1,J),N=Math.max(1,N)}if(void 0!==E)break}l&&l.length>0?f.sphericalPolynomial=O.b.ConvertCubeMapToSphericalPolynomial({size:Q[4],right:l[0],left:l[1],up:l[2],down:l[3],front:l[4],back:l[5],format:5,type:1,gammaSpace:!1}):f.sphericalPolynomial=void 0}}H.StoreLODInAlphaChannel=!1}}]);