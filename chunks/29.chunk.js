"use strict";(self["7c63p8lin4r"]=self["7c63p8lin4r"]||[]).push([[29],{14159:(z,u,U)=>{var J=U(12853),v=U(12760),f=U(12800),g=U(12880),w=U(12827),P=U(12865);w.b.prototype._partialLoadFile=function(z,u,U,J){let v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(z,(z=>{U[u]=z,U._internalCount++,6===U._internalCount&&J(U)}),void 0,void 0,!0,((z,u)=>{v&&z&&v(z.status+" "+z.statusText,u)}))},w.b.prototype._cascadeLoadFiles=function(z,u,U){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const v=[];v._internalCount=0;for(let f=0;f<6;f++)this._partialLoadFile(U[f],f,v,u,J)},w.b.prototype._cascadeLoadImgs=function(z,u,U,J){let v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5?arguments[5]:void 0;const g=[];g._internalCount=0;for(let w=0;w<6;w++)this._partialLoadImg(J[w],w,g,z,u,U,v,f)},w.b.prototype._partialLoadImg=function(z,u,U,J,v,w){let P=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,R=arguments.length>7?arguments[7]:void 0;const S=(0,g.d)();(0,f.r)(z,(z=>{U[u]=z,U._internalCount++,J&&J.removePendingData(S),6===U._internalCount&&w&&w(v,U)}),((z,u)=>{J&&J.removePendingData(S),P&&P(z,u)}),J?J.offlineProvider:null,R),J&&J.addPendingData(S)},w.b.prototype.createCubeTextureBase=function(z,u,U,f){let g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,w=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,R=arguments.length>6?arguments[6]:void 0,S=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,d=arguments.length>8&&void 0!==arguments[8]&&arguments[8],mz=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,Z=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,A=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,E=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,C=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,r=arguments.length>14&&void 0!==arguments[14]&&arguments[14],M=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const T=A||new J.c(this,7);T.isCube=!0,T.url=z,T.generateMipMaps=!f,T._lodGenerationScale=mz,T._lodGenerationOffset=Z,T._useSRGBBuffer=!!r&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!f),T!==A&&(T.label=z.substring(0,60)),this._doNotHandleContextLost||(T._extension=S,T._files=U,T._buffer=M);const X=z;this._transformTextureUrl&&!A&&(z=this._transformTextureUrl(z));const h=null!==S&&void 0!==S?S:function(z){const u=z.split("?")[0],U=u.lastIndexOf(".");return U>-1?u.substring(U).toLowerCase():""}(z),t=(0,P.b)(h),V=(z,u)=>{T.dispose(),w?w(z,u):z&&v.d.Warn(z)},L=(J,w)=>{z===X?J&&V(J.status+" "+J.statusText,w):(v.d.Warn("Failed to load ".concat(z,", falling back to the ").concat(X)),this.createCubeTextureBase(X,u,U,!!f,g,V,R,S,d,mz,Z,T,E,C,r,M))};if(t)t.then((J=>{const v=z=>{E&&E(T,z),J.loadCubeData(z,T,d,g,((z,u)=>{V(z,u)}))};M?v(M):U&&6===U.length?J.supportCascades?this._cascadeLoadFiles(u,(z=>v(z.map((z=>new Uint8Array(z))))),U,V):V("Textures type does not support cascades."):this._loadFile(z,(z=>v(new Uint8Array(z))),void 0,void 0,!0,L)}));else{if(!U||0===U.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(u,T,((z,u)=>{C&&C(z,u)}),U,V)}return this._internalTexturesCache.push(T),T}},13397:(z,u,U)=>{U.d(u,{c:()=>R});var J=U(12914),v=U(12935),f=U(13116),g=U(12917),w=U(12967);class P{constructor(z,u,U,J){this.name=z,this.worldAxisForNormal=u,this.worldAxisForFileX=U,this.worldAxisForFileY=J}}class R{static ConvertCubeMapTextureToSphericalPolynomial(z){var u;if(!z.isCube)return null;null===(u=z.Vz())||void 0===u||u.getEngine().flushFramebuffer();const U=z.getSize().width,J=z.readPixels(0,void 0,void 0,!1),v=z.readPixels(1,void 0,void 0,!1);let f,g;z.isRenderTarget?(f=z.readPixels(3,void 0,void 0,!1),g=z.readPixels(2,void 0,void 0,!1)):(f=z.readPixels(2,void 0,void 0,!1),g=z.readPixels(3,void 0,void 0,!1));const w=z.readPixels(4,void 0,void 0,!1),P=z.readPixels(5,void 0,void 0,!1),R=z.gammaSpace;let S=0;return 1!=z.textureType&&2!=z.textureType||(S=1),new Promise((z=>{Promise.all([v,J,f,g,w,P]).then((u=>{let[J,v,f,g,w,P]=u;const d={size:U,right:v,left:J,up:f,down:g,front:w,back:P,format:5,type:S,gammaSpace:R};z(this.ConvertCubeMapToSphericalPolynomial(d))}))}))}static _AreaElement(z,u){return Math.atan2(z*u,Math.sqrt(z*z+u*u+1))}static ConvertCubeMapToSphericalPolynomial(z){const u=new f.c;let U=0;const J=2/z.size,P=J,R=.5*J,S=R-1;for(let f=0;f<6;f++){const d=this._FileFaces[f],mz=z[d.name];let Z=S;const A=5===z.format?4:3;for(let f=0;f<z.size;f++){let E=S;for(let P=0;P<z.size;P++){const S=d.worldAxisForFileX.scale(E).add(d.worldAxisForFileY.scale(Z)).add(d.worldAxisForNormal);S.normalize();const C=this._AreaElement(E-R,Z-R)-this._AreaElement(E-R,Z+R)-this._AreaElement(E+R,Z-R)+this._AreaElement(E+R,Z+R);let r=mz[f*z.size*A+P*A+0],M=mz[f*z.size*A+P*A+1],T=mz[f*z.size*A+P*A+2];isNaN(r)&&(r=0),isNaN(M)&&(M=0),isNaN(T)&&(T=0),0===z.type&&(r/=255,M/=255,T/=255),z.gammaSpace&&(r=Math.pow((0,v.Clamp)(r),g.l),M=Math.pow((0,v.Clamp)(M),g.l),T=Math.pow((0,v.Clamp)(T),g.l));const X=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const z=Math.max(r,M,T);if(z>X){const u=X/z;r*=u,M*=u,T*=u}}else r=(0,v.Clamp)(r,0,X),M=(0,v.Clamp)(M,0,X),T=(0,v.Clamp)(T,0,X);const h=new w.Tu(r,M,T);u.addLight(S,h,C),U+=C,E+=J}Z+=P}}const d=6*(4*Math.PI)/6/U;return u.scaleInPlace(d),u.convertIncidentRadianceToIrradiance(),u.convertIrradianceToLambertianRadiance(),f.f.FromHarmonics(u)}}R._FileFaces=[new P("right",new J.Eu(1,0,0),new J.Eu(0,0,-1),new J.Eu(0,-1,0)),new P("left",new J.Eu(-1,0,0),new J.Eu(0,0,1),new J.Eu(0,-1,0)),new P("up",new J.Eu(0,1,0),new J.Eu(1,0,0),new J.Eu(0,0,1)),new P("down",new J.Eu(0,-1,0),new J.Eu(1,0,0),new J.Eu(0,0,-1)),new P("front",new J.Eu(0,0,1),new J.Eu(1,0,0),new J.Eu(0,-1,0)),new P("back",new J.Eu(0,0,-1),new J.Eu(-1,0,0),new J.Eu(0,-1,0))],R.MAX_HDRI_VALUE=4096,R.PRESERVE_CLAMPED_COLORS=!1},14991:(z,u,U)=>{U.d(u,{DDSTools:()=>A});var J=U(12935),v=U(12760),f=U(13397),g=U(13148);U(14159);const w=131072,P=131072;function R(z){return z.charCodeAt(0)+(z.charCodeAt(1)<<8)+(z.charCodeAt(2)<<16)+(z.charCodeAt(3)<<24)}const S=R("DXT1"),d=R("DXT3"),mz=R("DXT5"),Z=R("DX10");class A{static GetDDSInfo(z){const u=new Int32Array(z.buffer,z.byteOffset,31),U=new Int32Array(z.buffer,z.byteOffset,35);let J=1;u[2]&w&&(J=Math.max(1,u[7]));const v=u[21],f=v===Z?U[32]:0;let g=0;switch(v){case 113:g=2;break;case 116:g=1;break;case Z:if(10===f){g=2;break}if(2===f){g=1;break}}return{width:u[4],height:u[3],mipmapCount:J,isFourCC:4===(4&u[20]),isRGB:64===(64&u[20]),isLuminance:(u[20]&P)===P,isCube:512===(512&u[28]),isCompressed:v===S||v===d||v===mz,dxgiFormat:f,textureType:g}}static _GetHalfFloatAsFloatRGBAArrayBuffer(z,u,U,J,v,f){const w=new Float32Array(J),P=new Uint16Array(v,U);let R=0;for(let S=0;S<u;S++)for(let u=0;u<z;u++){const U=4*(u+S*z);w[R]=(0,g.f)(P[U]),w[R+1]=(0,g.f)(P[U+1]),w[R+2]=(0,g.f)(P[U+2]),A.StoreLODInAlphaChannel?w[R+3]=f:w[R+3]=(0,g.f)(P[U+3]),R+=4}return w}static _GetHalfFloatRGBAArrayBuffer(z,u,U,J,v,f){if(A.StoreLODInAlphaChannel){const w=new Uint16Array(J),P=new Uint16Array(v,U);let R=0;for(let U=0;U<u;U++)for(let u=0;u<z;u++){const J=4*(u+U*z);w[R]=P[J],w[R+1]=P[J+1],w[R+2]=P[J+2],w[R+3]=(0,g.n)(f),R+=4}return w}return new Uint16Array(v,U,J)}static _GetFloatRGBAArrayBuffer(z,u,U,J,v,f){if(A.StoreLODInAlphaChannel){const g=new Float32Array(J),w=new Float32Array(v,U);let P=0;for(let U=0;U<u;U++)for(let u=0;u<z;u++){const J=4*(u+U*z);g[P]=w[J],g[P+1]=w[J+1],g[P+2]=w[J+2],g[P+3]=f,P+=4}return g}return new Float32Array(v,U,J)}static _GetFloatAsHalfFloatRGBAArrayBuffer(z,u,U,J,v,f){const w=new Uint16Array(J),P=new Float32Array(v,U);let R=0;for(let S=0;S<u;S++)for(let u=0;u<z;u++)w[R]=(0,g.n)(P[R]),w[R+1]=(0,g.n)(P[R+1]),w[R+2]=(0,g.n)(P[R+2]),A.StoreLODInAlphaChannel?w[R+3]=(0,g.n)(f):w[R+3]=(0,g.n)(P[R+3]),R+=4;return w}static _GetFloatAsUIntRGBAArrayBuffer(z,u,U,v,f,g){const w=new Uint8Array(v),P=new Float32Array(f,U);let R=0;for(let S=0;S<u;S++)for(let u=0;u<z;u++){const U=4*(u+S*z);w[R]=255*(0,J.Clamp)(P[U]),w[R+1]=255*(0,J.Clamp)(P[U+1]),w[R+2]=255*(0,J.Clamp)(P[U+2]),A.StoreLODInAlphaChannel?w[R+3]=g:w[R+3]=255*(0,J.Clamp)(P[U+3]),R+=4}return w}static _GetHalfFloatAsUIntRGBAArrayBuffer(z,u,U,v,f,w){const P=new Uint8Array(v),R=new Uint16Array(f,U);let S=0;for(let d=0;d<u;d++)for(let u=0;u<z;u++){const U=4*(u+d*z);P[S]=255*(0,J.Clamp)((0,g.f)(R[U])),P[S+1]=255*(0,J.Clamp)((0,g.f)(R[U+1])),P[S+2]=255*(0,J.Clamp)((0,g.f)(R[U+2])),A.StoreLODInAlphaChannel?P[S+3]=w:P[S+3]=255*(0,J.Clamp)((0,g.f)(R[U+3])),S+=4}return P}static _GetRGBAArrayBuffer(z,u,U,J,v,f,g,w,P){const R=new Uint8Array(J),S=new Uint8Array(v,U);let d=0;for(let mz=0;mz<u;mz++)for(let u=0;u<z;u++){const U=4*(u+mz*z);R[d]=S[U+f],R[d+1]=S[U+g],R[d+2]=S[U+w],R[d+3]=S[U+P],d+=4}return R}static _ExtractLongWordOrder(z){return 0===z||255===z||-16777216===z?0:1+A._ExtractLongWordOrder(z>>8)}static _GetRGBArrayBuffer(z,u,U,J,v,f,g,w){const P=new Uint8Array(J),R=new Uint8Array(v,U);let S=0;for(let d=0;d<u;d++)for(let u=0;u<z;u++){const U=3*(u+d*z);P[S]=R[U+f],P[S+1]=R[U+g],P[S+2]=R[U+w],S+=3}return P}static _GetLuminanceArrayBuffer(z,u,U,J,v){const f=new Uint8Array(J),g=new Uint8Array(v,U);let w=0;for(let P=0;P<u;P++)for(let u=0;u<z;u++){const U=u+P*z;f[w]=g[U],w++}return f}static UploadDDSLevels(z,u,U,J,g,P){let R=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,E=arguments.length>7?arguments[7]:void 0,C=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],r=null;J.sphericalPolynomial&&(r=[]);const M=!!z.getCaps().s3tc;u.generateMipMaps=g;const T=new Int32Array(U.buffer,U.byteOffset,31);let X,h,t,V,L,O,x,Q=0,K=0,Y=1;if(542327876!==T[0])return void v.d.Error("Invalid magic number in DDS header");if(!J.isFourCC&&!J.isRGB&&!J.isLuminance)return void v.d.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(J.isCompressed&&!M)return void v.d.Error("Compressed textures are not supported on this platform.");let p=T[22];V=T[1]+4;let N=!1;if(J.isFourCC)switch(X=T[21],X){case S:Y=8,K=33777;break;case d:Y=16,K=33778;break;case mz:Y=16,K=33779;break;case 113:N=!0,p=64;break;case 116:N=!0,p=128;break;case Z:{V+=20;let z=!1;switch(J.dxgiFormat){case 10:N=!0,p=64,z=!0;break;case 2:N=!0,p=128,z=!0;break;case 88:J.isRGB=!0,J.isFourCC=!1,p=32,z=!0}if(z)break}default:return void v.d.Error(["Unsupported FourCC code:",(D=X,String.fromCharCode(255&D,D>>8&255,D>>16&255,D>>24&255))])}var D;const c=A._ExtractLongWordOrder(T[23]),W=A._ExtractLongWordOrder(T[24]),j=A._ExtractLongWordOrder(T[25]),I=A._ExtractLongWordOrder(T[26]);N&&(K=z._getRGBABufferInternalSizedFormat(J.textureType)),O=1,T[2]&w&&!1!==g&&(O=Math.max(1,T[7]));const F=E||0,b=z.getCaps();for(let v=F;v<P;v++){for(h=T[4],t=T[3],x=0;x<O;++x){if(-1===R||R===x){const f=-1===R?x:0;if(!J.isCompressed&&J.isFourCC){u.format=5,Q=h*t*4;let J=null;if(z._badOS||z._badDesktopOS||!b.textureHalfFloat&&!b.textureFloat)128===p?(J=A._GetFloatAsUIntRGBAArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,f),r&&0==f&&r.push(A._GetFloatRGBAArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,f))):64===p&&(J=A._GetHalfFloatAsUIntRGBAArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,f),r&&0==f&&r.push(A._GetHalfFloatAsFloatRGBAArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,f))),u.type=0;else{const z=b.textureFloat&&(C&&b.textureFloatLinearFiltering||!C),v=b.textureHalfFloat&&(C&&b.textureHalfFloatLinearFiltering||!C),g=(128===p||64===p&&!v)&&z?1:(64===p||128===p&&!z)&&v?2:0;let w,P=null;if(128===p)switch(g){case 1:w=A._GetFloatRGBAArrayBuffer,P=null;break;case 2:w=A._GetFloatAsHalfFloatRGBAArrayBuffer,P=A._GetFloatRGBAArrayBuffer;break;case 0:w=A._GetFloatAsUIntRGBAArrayBuffer,P=A._GetFloatRGBAArrayBuffer}else switch(g){case 1:w=A._GetHalfFloatAsFloatRGBAArrayBuffer,P=null;break;case 2:w=A._GetHalfFloatRGBAArrayBuffer,P=A._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:w=A._GetHalfFloatAsUIntRGBAArrayBuffer,P=A._GetHalfFloatAsFloatRGBAArrayBuffer}u.type=g,J=w(h,t,U.byteOffset+V,Q,U.buffer,f),r&&0==f&&r.push(P?P(h,t,U.byteOffset+V,Q,U.buffer,f):J)}J&&z._uploadDataToTextureDirectly(u,J,v,f)}else if(J.isRGB)u.type=0,24===p?(u.format=4,Q=h*t*3,L=A._GetRGBArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,c,W,j),z._uploadDataToTextureDirectly(u,L,v,f)):(u.format=5,Q=h*t*4,L=A._GetRGBAArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer,c,W,j,I),z._uploadDataToTextureDirectly(u,L,v,f));else if(J.isLuminance){const J=z._getUnpackAlignement(),g=h;Q=Math.floor((h+J-1)/J)*J*(t-1)+g,L=A._GetLuminanceArrayBuffer(h,t,U.byteOffset+V,Q,U.buffer),u.format=1,u.type=0,z._uploadDataToTextureDirectly(u,L,v,f)}else Q=Math.max(4,h)/4*Math.max(4,t)/4*Y,L=new Uint8Array(U.buffer,U.byteOffset+V,Q),u.type=0,z._uploadCompressedDataToTextureDirectly(u,K,h,t,L,v,f)}V+=p?h*t*(p/8):Q,h*=.5,t*=.5,h=Math.max(1,h),t=Math.max(1,t)}if(void 0!==E)break}r&&r.length>0?J.sphericalPolynomial=f.c.ConvertCubeMapToSphericalPolynomial({size:T[4],right:r[0],left:r[1],up:r[2],down:r[3],front:r[4],back:r[5],format:5,type:1,gammaSpace:!1}):J.sphericalPolynomial=void 0}}A.StoreLODInAlphaChannel=!1}}]);