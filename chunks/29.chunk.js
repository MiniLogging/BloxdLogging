"use strict";(self.c2c3ycupenc=self.c2c3ycupenc||[]).push([[29],{13364:(c,r,D)=>{var W=D(11615),B=D(11509),t=D(11545),u=D(11646),a=D(11584),H=D(11624);a.b.prototype._partialLoadFile=function(c,r,D,W){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(c,(c=>{D[r]=c,D._internalCount++,6===D._internalCount&&W(D)}),void 0,void 0,!0,((c,r)=>{B&&c&&B(c.status+" "+c.statusText,r)}))},a.b.prototype._cascadeLoadFiles=function(c,r,D){let W=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const B=[];B._internalCount=0;for(let t=0;t<6;t++)this._partialLoadFile(D[t],t,B,r,W)},a.b.prototype._cascadeLoadImgs=function(c,r,D,W){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,t=arguments.length>5?arguments[5]:void 0;const u=[];u._internalCount=0;for(let a=0;a<6;a++)this._partialLoadImg(W[a],a,u,c,r,D,B,t)},a.b.prototype._partialLoadImg=function(c,r,D,W,B,a){let H=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,x=arguments.length>7?arguments[7]:void 0;const M=(0,u.c)();(0,t.q)(c,(c=>{D[r]=c,D._internalCount++,W&&W.removePendingData(M),6===D._internalCount&&a&&a(B,D)}),((c,r)=>{W&&W.removePendingData(M),H&&H(c,r)}),W?W.offlineProvider:null,x),W&&W.addPendingData(M)},a.b.prototype.createCubeTextureBase=function(c,r,D,t){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,x=arguments.length>6?arguments[6]:void 0,M=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,E=arguments.length>8&&void 0!==arguments[8]&&arguments[8],m=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,Y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,v=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,k=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,w=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,Z=arguments.length>14&&void 0!==arguments[14]&&arguments[14],J=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const q=v||new W.e(this,7);q.isCube=!0,q.url=c,q.generateMipMaps=!t,q._lodGenerationScale=m,q._lodGenerationOffset=Y,q._useSRGBBuffer=!!Z&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!t),q!==v&&(q.label=c.substring(0,60)),this._doNotHandleContextLost||(q._extension=M,q._files=D,q._buffer=J);const j=c;this._transformTextureUrl&&!v&&(c=this._transformTextureUrl(c));const X=M??function(c){const r=c.split("?")[0],D=r.lastIndexOf(".");return D>-1?r.substring(D).toLowerCase():""}(c),e=(0,H.e)(X),y=(c,r)=>{q.dispose(),a?a(c,r):c&&B.e.Warn(c)},U=(W,a)=>{c===j?W&&y(W.status+" "+W.statusText,a):(B.e.Warn(`Failed to load ${c}, falling back to the ${j}`),this.createCubeTextureBase(j,r,D,!!t,u,y,x,M,E,m,Y,q,k,w,Z,J))};if(e)e.then((W=>{const B=c=>{k&&k(q,c),W.loadCubeData(c,q,E,u,((c,r)=>{y(c,r)}))};J?B(J):D&&6===D.length?W.supportCascades?this._cascadeLoadFiles(r,(c=>B(c.map((c=>new Uint8Array(c))))),D,y):y("Textures type does not support cascades."):this._loadFile(c,(c=>B(new Uint8Array(c))),void 0,void 0,!0,U)}));else{if(!D||0===D.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(r,q,((c,r)=>{w&&w(c,r)}),D,y)}return this._internalTexturesCache.push(q),q}},12197:(c,r,D)=>{D.d(r,{d:()=>x});var W=D(11683),B=D(11696),t=D(11868),u=D(11687),a=D(11722);class H{constructor(c,r,D,W){this.name=c,this.worldAxisForNormal=r,this.worldAxisForFileX=D,this.worldAxisForFileY=W}}class x{static ConvertCubeMapTextureToSphericalPolynomial(c){var r;if(!c.isCube)return null;null===(r=c.yc())||void 0===r||r.getEngine().flushFramebuffer();const D=c.getSize().width,W=c.readPixels(0,void 0,void 0,!1),B=c.readPixels(1,void 0,void 0,!1);let t,u;c.isRenderTarget?(t=c.readPixels(3,void 0,void 0,!1),u=c.readPixels(2,void 0,void 0,!1)):(t=c.readPixels(2,void 0,void 0,!1),u=c.readPixels(3,void 0,void 0,!1));const a=c.readPixels(4,void 0,void 0,!1),H=c.readPixels(5,void 0,void 0,!1),x=c.gammaSpace;let M=0;return 1!=c.textureType&&2!=c.textureType||(M=1),new Promise((c=>{Promise.all([B,W,t,u,a,H]).then((r=>{let[W,B,t,u,a,H]=r;const E={size:D,right:B,left:W,up:t,down:u,front:a,back:H,format:5,type:M,gammaSpace:x};c(this.ConvertCubeMapToSphericalPolynomial(E))}))}))}static _AreaElement(c,r){return Math.atan2(c*r,Math.sqrt(c*c+r*r+1))}static ConvertCubeMapToSphericalPolynomial(c){const r=new t.c;let D=0;const W=2/c.size,H=W,x=.5*W,M=x-1;for(let t=0;t<6;t++){const E=this._FileFaces[t],m=c[E.name];let Y=M;const v=5===c.format?4:3;for(let t=0;t<c.size;t++){let k=M;for(let H=0;H<c.size;H++){const M=E.worldAxisForFileX.scale(k).add(E.worldAxisForFileY.scale(Y)).add(E.worldAxisForNormal);M.normalize();const w=this._AreaElement(k-x,Y-x)-this._AreaElement(k-x,Y+x)-this._AreaElement(k+x,Y-x)+this._AreaElement(k+x,Y+x);let Z=m[t*c.size*v+H*v+0],J=m[t*c.size*v+H*v+1],q=m[t*c.size*v+H*v+2];isNaN(Z)&&(Z=0),isNaN(J)&&(J=0),isNaN(q)&&(q=0),0===c.type&&(Z/=255,J/=255,q/=255),c.gammaSpace&&(Z=Math.pow((0,B.Clamp)(Z),u.k),J=Math.pow((0,B.Clamp)(J),u.k),q=Math.pow((0,B.Clamp)(q),u.k));const j=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const c=Math.max(Z,J,q);if(c>j){const r=j/c;Z*=r,J*=r,q*=r}}else Z=(0,B.Clamp)(Z,0,j),J=(0,B.Clamp)(J,0,j),q=(0,B.Clamp)(q,0,j);const X=new a.Xr(Z,J,q);r.addLight(M,X,w),D+=w,k+=W}Y+=H}}const E=6*(4*Math.PI)/6/D;return r.scaleInPlace(E),r.convertIncidentRadianceToIrradiance(),r.convertIrradianceToLambertianRadiance(),t.e.FromHarmonics(r)}}x._FileFaces=[new H("right",new W.Zr(1,0,0),new W.Zr(0,0,-1),new W.Zr(0,-1,0)),new H("left",new W.Zr(-1,0,0),new W.Zr(0,0,1),new W.Zr(0,-1,0)),new H("up",new W.Zr(0,1,0),new W.Zr(1,0,0),new W.Zr(0,0,1)),new H("down",new W.Zr(0,-1,0),new W.Zr(1,0,0),new W.Zr(0,0,-1)),new H("front",new W.Zr(0,0,1),new W.Zr(1,0,0),new W.Zr(0,-1,0)),new H("back",new W.Zr(0,0,-1),new W.Zr(-1,0,0),new W.Zr(0,-1,0))],x.MAX_HDRI_VALUE=4096,x.PRESERVE_CLAMPED_COLORS=!1},14117:(c,r,D)=>{D.d(r,{DDSTools:()=>v});var W=D(11696),B=D(11509),t=D(12197),u=D(11907);D(13364);const a=131072,H=131072;function x(c){return c.charCodeAt(0)+(c.charCodeAt(1)<<8)+(c.charCodeAt(2)<<16)+(c.charCodeAt(3)<<24)}const M=x("DXT1"),E=x("DXT3"),m=x("DXT5"),Y=x("DX10");class v{static GetDDSInfo(c){const r=new Int32Array(c.buffer,c.byteOffset,31),D=new Int32Array(c.buffer,c.byteOffset,35);let W=1;r[2]&a&&(W=Math.max(1,r[7]));const B=r[21],t=B===Y?D[32]:0;let u=0;switch(B){case 113:u=2;break;case 116:u=1;break;case Y:if(10===t){u=2;break}if(2===t){u=1;break}}return{width:r[4],height:r[3],mipmapCount:W,isFourCC:4===(4&r[20]),isRGB:64===(64&r[20]),isLuminance:(r[20]&H)===H,isCube:512===(512&r[28]),isCompressed:B===M||B===E||B===m,dxgiFormat:t,textureType:u}}static _GetHalfFloatAsFloatRGBAArrayBuffer(c,r,D,W,B,t){const a=new Float32Array(W),H=new Uint16Array(B,D);let x=0;for(let M=0;M<r;M++)for(let r=0;r<c;r++){const D=4*(r+M*c);a[x]=(0,u.f)(H[D]),a[x+1]=(0,u.f)(H[D+1]),a[x+2]=(0,u.f)(H[D+2]),v.StoreLODInAlphaChannel?a[x+3]=t:a[x+3]=(0,u.f)(H[D+3]),x+=4}return a}static _GetHalfFloatRGBAArrayBuffer(c,r,D,W,B,t){if(v.StoreLODInAlphaChannel){const a=new Uint16Array(W),H=new Uint16Array(B,D);let x=0;for(let D=0;D<r;D++)for(let r=0;r<c;r++){const W=4*(r+D*c);a[x]=H[W],a[x+1]=H[W+1],a[x+2]=H[W+2],a[x+3]=(0,u.q)(t),x+=4}return a}return new Uint16Array(B,D,W)}static _GetFloatRGBAArrayBuffer(c,r,D,W,B,t){if(v.StoreLODInAlphaChannel){const u=new Float32Array(W),a=new Float32Array(B,D);let H=0;for(let D=0;D<r;D++)for(let r=0;r<c;r++){const W=4*(r+D*c);u[H]=a[W],u[H+1]=a[W+1],u[H+2]=a[W+2],u[H+3]=t,H+=4}return u}return new Float32Array(B,D,W)}static _GetFloatAsHalfFloatRGBAArrayBuffer(c,r,D,W,B,t){const a=new Uint16Array(W),H=new Float32Array(B,D);let x=0;for(let M=0;M<r;M++)for(let r=0;r<c;r++)a[x]=(0,u.q)(H[x]),a[x+1]=(0,u.q)(H[x+1]),a[x+2]=(0,u.q)(H[x+2]),v.StoreLODInAlphaChannel?a[x+3]=(0,u.q)(t):a[x+3]=(0,u.q)(H[x+3]),x+=4;return a}static _GetFloatAsUIntRGBAArrayBuffer(c,r,D,B,t,u){const a=new Uint8Array(B),H=new Float32Array(t,D);let x=0;for(let M=0;M<r;M++)for(let r=0;r<c;r++){const D=4*(r+M*c);a[x]=255*(0,W.Clamp)(H[D]),a[x+1]=255*(0,W.Clamp)(H[D+1]),a[x+2]=255*(0,W.Clamp)(H[D+2]),v.StoreLODInAlphaChannel?a[x+3]=u:a[x+3]=255*(0,W.Clamp)(H[D+3]),x+=4}return a}static _GetHalfFloatAsUIntRGBAArrayBuffer(c,r,D,B,t,a){const H=new Uint8Array(B),x=new Uint16Array(t,D);let M=0;for(let E=0;E<r;E++)for(let r=0;r<c;r++){const D=4*(r+E*c);H[M]=255*(0,W.Clamp)((0,u.f)(x[D])),H[M+1]=255*(0,W.Clamp)((0,u.f)(x[D+1])),H[M+2]=255*(0,W.Clamp)((0,u.f)(x[D+2])),v.StoreLODInAlphaChannel?H[M+3]=a:H[M+3]=255*(0,W.Clamp)((0,u.f)(x[D+3])),M+=4}return H}static _GetRGBAArrayBuffer(c,r,D,W,B,t,u,a,H){const x=new Uint8Array(W),M=new Uint8Array(B,D);let E=0;for(let m=0;m<r;m++)for(let r=0;r<c;r++){const D=4*(r+m*c);x[E]=M[D+t],x[E+1]=M[D+u],x[E+2]=M[D+a],x[E+3]=M[D+H],E+=4}return x}static _ExtractLongWordOrder(c){return 0===c||255===c||-16777216===c?0:1+v._ExtractLongWordOrder(c>>8)}static _GetRGBArrayBuffer(c,r,D,W,B,t,u,a){const H=new Uint8Array(W),x=new Uint8Array(B,D);let M=0;for(let E=0;E<r;E++)for(let r=0;r<c;r++){const D=3*(r+E*c);H[M]=x[D+t],H[M+1]=x[D+u],H[M+2]=x[D+a],M+=3}return H}static _GetLuminanceArrayBuffer(c,r,D,W,B){const t=new Uint8Array(W),u=new Uint8Array(B,D);let a=0;for(let H=0;H<r;H++)for(let r=0;r<c;r++){const D=r+H*c;t[a]=u[D],a++}return t}static UploadDDSLevels(c,r,D,W,u,H){let x=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,k=arguments.length>7?arguments[7]:void 0,w=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],Z=null;W.sphericalPolynomial&&(Z=[]);const J=!!c.getCaps().s3tc;r.generateMipMaps=u;const q=new Int32Array(D.buffer,D.byteOffset,31);let j,X,e,y,U,N,g,z=0,S=0,K=1;if(542327876!==q[0])return void B.e.Error("Invalid magic number in DDS header");if(!W.isFourCC&&!W.isRGB&&!W.isLuminance)return void B.e.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(W.isCompressed&&!J)return void B.e.Error("Compressed textures are not supported on this platform.");let f=q[22];y=q[1]+4;let A=!1;if(W.isFourCC)switch(j=q[21],j){case M:K=8,S=33777;break;case E:K=16,S=33778;break;case m:K=16,S=33779;break;case 113:A=!0,f=64;break;case 116:A=!0,f=128;break;case Y:{y+=20;let c=!1;switch(W.dxgiFormat){case 10:A=!0,f=64,c=!0;break;case 2:A=!0,f=128,c=!0;break;case 88:W.isRGB=!0,W.isFourCC=!1,f=32,c=!0}if(c)break}default:return void B.e.Error(["Unsupported FourCC code:",(h=j,String.fromCharCode(255&h,h>>8&255,h>>16&255,h>>24&255))])}var h;const L=v._ExtractLongWordOrder(q[23]),P=v._ExtractLongWordOrder(q[24]),G=v._ExtractLongWordOrder(q[25]),d=v._ExtractLongWordOrder(q[26]);A&&(S=c._getRGBABufferInternalSizedFormat(W.textureType)),N=1,q[2]&a&&!1!==u&&(N=Math.max(1,q[7]));const T=k||0,b=c.getCaps();for(let B=T;B<H;B++){for(X=q[4],e=q[3],g=0;g<N;++g){if(-1===x||x===g){const t=-1===x?g:0;if(!W.isCompressed&&W.isFourCC){r.format=5,z=X*e*4;let W=null;if(c._badOS||c._badDesktopOS||!b.textureHalfFloat&&!b.textureFloat)128===f?(W=v._GetFloatAsUIntRGBAArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,t),Z&&0==t&&Z.push(v._GetFloatRGBAArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,t))):64===f&&(W=v._GetHalfFloatAsUIntRGBAArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,t),Z&&0==t&&Z.push(v._GetHalfFloatAsFloatRGBAArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,t))),r.type=0;else{const c=b.textureFloat&&(w&&b.textureFloatLinearFiltering||!w),B=b.textureHalfFloat&&(w&&b.textureHalfFloatLinearFiltering||!w),u=(128===f||64===f&&!B)&&c?1:(64===f||128===f&&!c)&&B?2:0;let a,H=null;if(128===f)switch(u){case 1:a=v._GetFloatRGBAArrayBuffer,H=null;break;case 2:a=v._GetFloatAsHalfFloatRGBAArrayBuffer,H=v._GetFloatRGBAArrayBuffer;break;case 0:a=v._GetFloatAsUIntRGBAArrayBuffer,H=v._GetFloatRGBAArrayBuffer}else switch(u){case 1:a=v._GetHalfFloatAsFloatRGBAArrayBuffer,H=null;break;case 2:a=v._GetHalfFloatRGBAArrayBuffer,H=v._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:a=v._GetHalfFloatAsUIntRGBAArrayBuffer,H=v._GetHalfFloatAsFloatRGBAArrayBuffer}r.type=u,W=a(X,e,D.byteOffset+y,z,D.buffer,t),Z&&0==t&&Z.push(H?H(X,e,D.byteOffset+y,z,D.buffer,t):W)}W&&c._uploadDataToTextureDirectly(r,W,B,t)}else if(W.isRGB)r.type=0,24===f?(r.format=4,z=X*e*3,U=v._GetRGBArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,L,P,G),c._uploadDataToTextureDirectly(r,U,B,t)):(r.format=5,z=X*e*4,U=v._GetRGBAArrayBuffer(X,e,D.byteOffset+y,z,D.buffer,L,P,G,d),c._uploadDataToTextureDirectly(r,U,B,t));else if(W.isLuminance){const W=c._getUnpackAlignement(),u=X;z=Math.floor((X+W-1)/W)*W*(e-1)+u,U=v._GetLuminanceArrayBuffer(X,e,D.byteOffset+y,z,D.buffer),r.format=1,r.type=0,c._uploadDataToTextureDirectly(r,U,B,t)}else z=Math.max(4,X)/4*Math.max(4,e)/4*K,U=new Uint8Array(D.buffer,D.byteOffset+y,z),r.type=0,c._uploadCompressedDataToTextureDirectly(r,S,X,e,U,B,t)}y+=f?X*e*(f/8):z,X*=.5,e*=.5,X=Math.max(1,X),e=Math.max(1,e)}if(void 0!==k)break}Z&&Z.length>0?W.sphericalPolynomial=t.d.ConvertCubeMapToSphericalPolynomial({size:q[4],right:Z[0],left:Z[1],up:Z[2],down:Z[3],front:Z[4],back:Z[5],format:5,type:1,gammaSpace:!1}):W.sphericalPolynomial=void 0}}v.StoreLODInAlphaChannel=!1}}]);