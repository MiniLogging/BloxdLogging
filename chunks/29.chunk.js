"use strict";(self["6xhfpmwgjr5"]=self["6xhfpmwgjr5"]||[]).push([[29],{14494:(P,a,R)=>{var S=R(12359),A=R(12248),Z=R(12285),p=R(12383),j=R(12323),U=R(12367);j.e.prototype._partialLoadFile=function(P,a,R,S){let A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._loadFile(P,(P=>{R[a]=P,R._internalCount++,6===R._internalCount&&S(R)}),void 0,void 0,!0,((P,a)=>{A&&P&&A(P.status+" "+P.statusText,a)}))},j.e.prototype._cascadeLoadFiles=function(P,a,R){let S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const A=[];A._internalCount=0;for(let Z=0;Z<6;Z++)this._partialLoadFile(R[Z],Z,A,a,S)},j.e.prototype._cascadeLoadImgs=function(P,a,R,S){let A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,Z=arguments.length>5?arguments[5]:void 0;const p=[];p._internalCount=0;for(let j=0;j<6;j++)this._partialLoadImg(S[j],j,p,P,a,R,A,Z)},j.e.prototype._partialLoadImg=function(P,a,R,S,A,j){let U=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,Q=arguments.length>7?arguments[7]:void 0;const h=(0,p.b)();(0,Z.r)(P,(P=>{R[a]=P,R._internalCount++,S&&S.removePendingData(h),6===R._internalCount&&j&&j(A,R)}),((P,a)=>{S&&S.removePendingData(h),U&&U(P,a)}),S?S.offlineProvider:null,Q),S&&S.addPendingData(h)},j.e.prototype.createCubeTextureBase=function(P,a,R,Z){let p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,Q=arguments.length>6?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],V=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,O=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,q=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,y=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,t=arguments.length>14&&void 0!==arguments[14]&&arguments[14],W=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null;const k=O||new S.c(this,7);k.isCube=!0,k.url=P,k.generateMipMaps=!Z,k._lodGenerationScale=V,k._lodGenerationOffset=f,k._useSRGBBuffer=!!t&&this._caps.supportSRGBBuffers&&(this.version>1||this.isWebGPU||!!Z),k!==O&&(k.label=P.substring(0,60)),this._doNotHandleContextLost||(k._extension=h,k._files=R,k._buffer=W);const x=P;this._transformTextureUrl&&!O&&(P=this._transformTextureUrl(P));const s=h??function(P){const a=P.split("?")[0],R=a.lastIndexOf(".");return R>-1?a.substring(R).toLowerCase():""}(P),d=(0,U.c)(s),G=(P,a)=>{k.dispose(),j?j(P,a):P&&A.c.Warn(P)},H=(S,j)=>{P===x?S&&G(S.status+" "+S.statusText,j):(A.c.Warn(`Failed to load ${P}, falling back to the ${x}`),this.createCubeTextureBase(x,a,R,!!Z,p,G,Q,h,l,V,f,k,q,y,t,W))};if(d)d.then((S=>{const A=P=>{q&&q(k,P),S.loadCubeData(P,k,l,p,((P,a)=>{G(P,a)}))};W?A(W):R&&6===R.length?S.supportCascades?this._cascadeLoadFiles(a,(P=>A(P.map((P=>new Uint8Array(P))))),R,G):G("Textures type does not support cascades."):this._loadFile(P,(P=>A(new Uint8Array(P))),void 0,void 0,!0,H)}));else{if(!R||0===R.length)throw new Error("Cannot load cubemap because files were not defined, or the correct loader was not found.");this._cascadeLoadImgs(a,k,((P,a)=>{y&&y(P,a)}),R,G)}return this._internalTexturesCache.push(k),k}},12900:(P,a,R)=>{R.d(a,{b:()=>Q});var S=R(12415),A=R(12430),Z=R(12591),p=R(12418),j=R(12456);class U{constructor(P,a,R,S){this.name=P,this.worldAxisForNormal=a,this.worldAxisForFileX=R,this.worldAxisForFileY=S}}class Q{static ConvertCubeMapTextureToSphericalPolynomial(P){var a;if(!P.isCube)return null;null===(a=P.GP())||void 0===a||a.getEngine().flushFramebuffer();const R=P.getSize().width,S=P.readPixels(0,void 0,void 0,!1),A=P.readPixels(1,void 0,void 0,!1);let Z,p;P.isRenderTarget?(Z=P.readPixels(3,void 0,void 0,!1),p=P.readPixels(2,void 0,void 0,!1)):(Z=P.readPixels(2,void 0,void 0,!1),p=P.readPixels(3,void 0,void 0,!1));const j=P.readPixels(4,void 0,void 0,!1),U=P.readPixels(5,void 0,void 0,!1),Q=P.gammaSpace;let h=0;return 1!=P.textureType&&2!=P.textureType||(h=1),new Promise((P=>{Promise.all([A,S,Z,p,j,U]).then((a=>{let[S,A,Z,p,j,U]=a;const l={size:R,right:A,left:S,up:Z,down:p,front:j,back:U,format:5,type:h,gammaSpace:Q};P(this.ConvertCubeMapToSphericalPolynomial(l))}))}))}static _AreaElement(P,a){return Math.atan2(P*a,Math.sqrt(P*P+a*a+1))}static ConvertCubeMapToSphericalPolynomial(P){const a=new Z.e;let R=0;const S=2/P.size,U=S,Q=.5*S,h=Q-1;for(let Z=0;Z<6;Z++){const l=this._FileFaces[Z],V=P[l.name];let f=h;const O=5===P.format?4:3;for(let Z=0;Z<P.size;Z++){let q=h;for(let U=0;U<P.size;U++){const h=l.worldAxisForFileX.scale(q).add(l.worldAxisForFileY.scale(f)).add(l.worldAxisForNormal);h.normalize();const y=this._AreaElement(q-Q,f-Q)-this._AreaElement(q-Q,f+Q)-this._AreaElement(q+Q,f-Q)+this._AreaElement(q+Q,f+Q);let t=V[Z*P.size*O+U*O+0],W=V[Z*P.size*O+U*O+1],k=V[Z*P.size*O+U*O+2];isNaN(t)&&(t=0),isNaN(W)&&(W=0),isNaN(k)&&(k=0),0===P.type&&(t/=255,W/=255,k/=255),P.gammaSpace&&(t=Math.pow((0,A.Clamp)(t),p.m),W=Math.pow((0,A.Clamp)(W),p.m),k=Math.pow((0,A.Clamp)(k),p.m));const x=this.MAX_HDRI_VALUE;if(this.PRESERVE_CLAMPED_COLORS){const P=Math.max(t,W,k);if(P>x){const a=x/P;t*=a,W*=a,k*=a}}else t=(0,A.Clamp)(t,0,x),W=(0,A.Clamp)(W,0,x),k=(0,A.Clamp)(k,0,x);const s=new j.Wa(t,W,k);a.addLight(h,s,y),R+=y,q+=S}f+=U}}const l=6*(4*Math.PI)/6/R;return a.scaleInPlace(l),a.convertIncidentRadianceToIrradiance(),a.convertIrradianceToLambertianRadiance(),Z.f.FromHarmonics(a)}}Q._FileFaces=[new U("right",new S.Oa(1,0,0),new S.Oa(0,0,-1),new S.Oa(0,-1,0)),new U("left",new S.Oa(-1,0,0),new S.Oa(0,0,1),new S.Oa(0,-1,0)),new U("up",new S.Oa(0,1,0),new S.Oa(1,0,0),new S.Oa(0,0,1)),new U("down",new S.Oa(0,-1,0),new S.Oa(1,0,0),new S.Oa(0,0,-1)),new U("front",new S.Oa(0,0,1),new S.Oa(1,0,0),new S.Oa(0,-1,0)),new U("back",new S.Oa(0,0,-1),new S.Oa(-1,0,0),new S.Oa(0,-1,0))],Q.MAX_HDRI_VALUE=4096,Q.PRESERVE_CLAMPED_COLORS=!1},15704:(P,a,R)=>{R.d(a,{DDSTools:()=>O});var S=R(12430),A=R(12248),Z=R(12900),p=R(12626);R(14494);const j=131072,U=131072;function Q(P){return P.charCodeAt(0)+(P.charCodeAt(1)<<8)+(P.charCodeAt(2)<<16)+(P.charCodeAt(3)<<24)}const h=Q("DXT1"),l=Q("DXT3"),V=Q("DXT5"),f=Q("DX10");class O{static GetDDSInfo(P){const a=new Int32Array(P.buffer,P.byteOffset,31),R=new Int32Array(P.buffer,P.byteOffset,35);let S=1;a[2]&j&&(S=Math.max(1,a[7]));const A=a[21],Z=A===f?R[32]:0;let p=0;switch(A){case 113:p=2;break;case 116:p=1;break;case f:if(10===Z){p=2;break}if(2===Z){p=1;break}}return{width:a[4],height:a[3],mipmapCount:S,isFourCC:4===(4&a[20]),isRGB:64===(64&a[20]),isLuminance:(a[20]&U)===U,isCube:512===(512&a[28]),isCompressed:A===h||A===l||A===V,dxgiFormat:Z,textureType:p}}static _GetHalfFloatAsFloatRGBAArrayBuffer(P,a,R,S,A,Z){const j=new Float32Array(S),U=new Uint16Array(A,R);let Q=0;for(let h=0;h<a;h++)for(let a=0;a<P;a++){const R=4*(a+h*P);j[Q]=(0,p.g)(U[R]),j[Q+1]=(0,p.g)(U[R+1]),j[Q+2]=(0,p.g)(U[R+2]),O.StoreLODInAlphaChannel?j[Q+3]=Z:j[Q+3]=(0,p.g)(U[R+3]),Q+=4}return j}static _GetHalfFloatRGBAArrayBuffer(P,a,R,S,A,Z){if(O.StoreLODInAlphaChannel){const j=new Uint16Array(S),U=new Uint16Array(A,R);let Q=0;for(let R=0;R<a;R++)for(let a=0;a<P;a++){const S=4*(a+R*P);j[Q]=U[S],j[Q+1]=U[S+1],j[Q+2]=U[S+2],j[Q+3]=(0,p.o)(Z),Q+=4}return j}return new Uint16Array(A,R,S)}static _GetFloatRGBAArrayBuffer(P,a,R,S,A,Z){if(O.StoreLODInAlphaChannel){const p=new Float32Array(S),j=new Float32Array(A,R);let U=0;for(let R=0;R<a;R++)for(let a=0;a<P;a++){const S=4*(a+R*P);p[U]=j[S],p[U+1]=j[S+1],p[U+2]=j[S+2],p[U+3]=Z,U+=4}return p}return new Float32Array(A,R,S)}static _GetFloatAsHalfFloatRGBAArrayBuffer(P,a,R,S,A,Z){const j=new Uint16Array(S),U=new Float32Array(A,R);let Q=0;for(let h=0;h<a;h++)for(let a=0;a<P;a++)j[Q]=(0,p.o)(U[Q]),j[Q+1]=(0,p.o)(U[Q+1]),j[Q+2]=(0,p.o)(U[Q+2]),O.StoreLODInAlphaChannel?j[Q+3]=(0,p.o)(Z):j[Q+3]=(0,p.o)(U[Q+3]),Q+=4;return j}static _GetFloatAsUIntRGBAArrayBuffer(P,a,R,A,Z,p){const j=new Uint8Array(A),U=new Float32Array(Z,R);let Q=0;for(let h=0;h<a;h++)for(let a=0;a<P;a++){const R=4*(a+h*P);j[Q]=255*(0,S.Clamp)(U[R]),j[Q+1]=255*(0,S.Clamp)(U[R+1]),j[Q+2]=255*(0,S.Clamp)(U[R+2]),O.StoreLODInAlphaChannel?j[Q+3]=p:j[Q+3]=255*(0,S.Clamp)(U[R+3]),Q+=4}return j}static _GetHalfFloatAsUIntRGBAArrayBuffer(P,a,R,A,Z,j){const U=new Uint8Array(A),Q=new Uint16Array(Z,R);let h=0;for(let l=0;l<a;l++)for(let a=0;a<P;a++){const R=4*(a+l*P);U[h]=255*(0,S.Clamp)((0,p.g)(Q[R])),U[h+1]=255*(0,S.Clamp)((0,p.g)(Q[R+1])),U[h+2]=255*(0,S.Clamp)((0,p.g)(Q[R+2])),O.StoreLODInAlphaChannel?U[h+3]=j:U[h+3]=255*(0,S.Clamp)((0,p.g)(Q[R+3])),h+=4}return U}static _GetRGBAArrayBuffer(P,a,R,S,A,Z,p,j,U){const Q=new Uint8Array(S),h=new Uint8Array(A,R);let l=0;for(let V=0;V<a;V++)for(let a=0;a<P;a++){const R=4*(a+V*P);Q[l]=h[R+Z],Q[l+1]=h[R+p],Q[l+2]=h[R+j],Q[l+3]=h[R+U],l+=4}return Q}static _ExtractLongWordOrder(P){return 0===P||255===P||-16777216===P?0:1+O._ExtractLongWordOrder(P>>8)}static _GetRGBArrayBuffer(P,a,R,S,A,Z,p,j){const U=new Uint8Array(S),Q=new Uint8Array(A,R);let h=0;for(let l=0;l<a;l++)for(let a=0;a<P;a++){const R=3*(a+l*P);U[h]=Q[R+Z],U[h+1]=Q[R+p],U[h+2]=Q[R+j],h+=3}return U}static _GetLuminanceArrayBuffer(P,a,R,S,A){const Z=new Uint8Array(S),p=new Uint8Array(A,R);let j=0;for(let U=0;U<a;U++)for(let a=0;a<P;a++){const R=a+U*P;Z[j]=p[R],j++}return Z}static UploadDDSLevels(P,a,R,S,p,U){let Q=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1,q=arguments.length>7?arguments[7]:void 0,y=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],t=null;S.sphericalPolynomial&&(t=[]);const W=!!P.getCaps().s3tc;a.generateMipMaps=p;const k=new Int32Array(R.buffer,R.byteOffset,31);let x,s,d,G,H,mP,N,D=0,L=0,c=1;if(542327876!==k[0])return void A.c.Error("Invalid magic number in DDS header");if(!S.isFourCC&&!S.isRGB&&!S.isLuminance)return void A.c.Error("Unsupported format, must contain a FourCC, RGB or LUMINANCE code");if(S.isCompressed&&!W)return void A.c.Error("Compressed textures are not supported on this platform.");let u=k[22];G=k[1]+4;let Y=!1;if(S.isFourCC)switch(x=k[21],x){case h:c=8,L=33777;break;case l:c=16,L=33778;break;case V:c=16,L=33779;break;case 113:Y=!0,u=64;break;case 116:Y=!0,u=128;break;case f:{G+=20;let P=!1;switch(S.dxgiFormat){case 10:Y=!0,u=64,P=!0;break;case 2:Y=!0,u=128,P=!0;break;case 88:S.isRGB=!0,S.isFourCC=!1,u=32,P=!0}if(P)break}default:return void A.c.Error(["Unsupported FourCC code:",(J=x,String.fromCharCode(255&J,J>>8&255,J>>16&255,J>>24&255))])}var J;const n=O._ExtractLongWordOrder(k[23]),b=O._ExtractLongWordOrder(k[24]),B=O._ExtractLongWordOrder(k[25]),o=O._ExtractLongWordOrder(k[26]);Y&&(L=P._getRGBABufferInternalSizedFormat(S.textureType)),mP=1,k[2]&j&&!1!==p&&(mP=Math.max(1,k[7]));const r=q||0,v=P.getCaps();for(let A=r;A<U;A++){for(s=k[4],d=k[3],N=0;N<mP;++N){if(-1===Q||Q===N){const Z=-1===Q?N:0;if(!S.isCompressed&&S.isFourCC){a.format=5,D=s*d*4;let S=null;if(P._badOS||P._badDesktopOS||!v.textureHalfFloat&&!v.textureFloat)128===u?(S=O._GetFloatAsUIntRGBAArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,Z),t&&0==Z&&t.push(O._GetFloatRGBAArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,Z))):64===u&&(S=O._GetHalfFloatAsUIntRGBAArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,Z),t&&0==Z&&t.push(O._GetHalfFloatAsFloatRGBAArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,Z))),a.type=0;else{const P=v.textureFloat&&(y&&v.textureFloatLinearFiltering||!y),A=v.textureHalfFloat&&(y&&v.textureHalfFloatLinearFiltering||!y),p=(128===u||64===u&&!A)&&P?1:(64===u||128===u&&!P)&&A?2:0;let j,U=null;if(128===u)switch(p){case 1:j=O._GetFloatRGBAArrayBuffer,U=null;break;case 2:j=O._GetFloatAsHalfFloatRGBAArrayBuffer,U=O._GetFloatRGBAArrayBuffer;break;case 0:j=O._GetFloatAsUIntRGBAArrayBuffer,U=O._GetFloatRGBAArrayBuffer}else switch(p){case 1:j=O._GetHalfFloatAsFloatRGBAArrayBuffer,U=null;break;case 2:j=O._GetHalfFloatRGBAArrayBuffer,U=O._GetHalfFloatAsFloatRGBAArrayBuffer;break;case 0:j=O._GetHalfFloatAsUIntRGBAArrayBuffer,U=O._GetHalfFloatAsFloatRGBAArrayBuffer}a.type=p,S=j(s,d,R.byteOffset+G,D,R.buffer,Z),t&&0==Z&&t.push(U?U(s,d,R.byteOffset+G,D,R.buffer,Z):S)}S&&P._uploadDataToTextureDirectly(a,S,A,Z)}else if(S.isRGB)a.type=0,24===u?(a.format=4,D=s*d*3,H=O._GetRGBArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,n,b,B),P._uploadDataToTextureDirectly(a,H,A,Z)):(a.format=5,D=s*d*4,H=O._GetRGBAArrayBuffer(s,d,R.byteOffset+G,D,R.buffer,n,b,B,o),P._uploadDataToTextureDirectly(a,H,A,Z));else if(S.isLuminance){const S=P._getUnpackAlignement(),p=s;D=Math.floor((s+S-1)/S)*S*(d-1)+p,H=O._GetLuminanceArrayBuffer(s,d,R.byteOffset+G,D,R.buffer),a.format=1,a.type=0,P._uploadDataToTextureDirectly(a,H,A,Z)}else D=Math.max(4,s)/4*Math.max(4,d)/4*c,H=new Uint8Array(R.buffer,R.byteOffset+G,D),a.type=0,P._uploadCompressedDataToTextureDirectly(a,L,s,d,H,A,Z)}G+=u?s*d*(u/8):D,s*=.5,d*=.5,s=Math.max(1,s),d=Math.max(1,d)}if(void 0!==q)break}t&&t.length>0?S.sphericalPolynomial=Z.b.ConvertCubeMapToSphericalPolynomial({size:k[4],right:t[0],left:t[1],up:t[2],down:t[3],front:t[4],back:t[5],format:5,type:1,gammaSpace:!1}):S.sphericalPolynomial=void 0}}O.StoreLODInAlphaChannel=!1}}]);