"use strict";(self.nyfa010khv=self.nyfa010khv||[]).push([[24],{12459:(L,r,p)=>{p.d(r,{b:()=>J});class J{constructor(L,r,p){this.bu=L,this.bv=r,this.distance=p,this.faceId=0,this.subMeshId=0}}},12474:(L,r,p)=>{p.d(r,{e:()=>j});var J=p(12149),i=p(12136),n=p(12140);class j{constructor(L,r,p){this.vectors=(0,J.e)(8,i.cr.Zero),this.center=i.cr.Zero(),this.centerWorld=i.cr.Zero(),this.extendSize=i.cr.Zero(),this.extendSizeWorld=i.cr.Zero(),this.directions=(0,J.e)(3,i.cr.Zero),this.vectorsWorld=(0,J.e)(8,i.cr.Zero),this.minimumWorld=i.cr.Zero(),this.maximumWorld=i.cr.Zero(),this.minimum=i.cr.Zero(),this.maximum=i.cr.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(L,r,p)}reConstruct(L,r,p){const J=L.x,n=L.y,j=L.z,z=r.x,G=r.y,C=r.z,t=this.vectors;this.minimum.Uz(J,n,j),this.maximum.Uz(z,G,C),t[0].Uz(J,n,j),t[1].Uz(z,G,C),t[2].Uz(z,n,j),t[3].Uz(J,G,j),t[4].Uz(J,n,C),t[5].Uz(z,G,j),t[6].Uz(J,G,C),t[7].Uz(z,n,C),r.addToRef(L,this.center).scaleInPlace(.5),r.subtractToRef(L,this.extendSize).scaleInPlace(.5),this._worldMatrix=p||i.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(L){const r=j._TmpVector3,p=this.maximum.subtractToRef(this.minimum,r[0]),J=p.length();p.normalizeFromLength(J);const i=J*L,n=p.scaleInPlace(.5*i),z=this.center.subtractToRef(n,r[1]),G=this.center.addToRef(n,r[2]);return this.reConstruct(z,G,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(L){const r=this.minimumWorld,p=this.maximumWorld,J=this.directions,n=this.vectorsWorld,j=this.vectors;if(L.isIdentity()){r.G(this.minimum),p.G(this.maximum);for(let L=0;L<8;++L)n[L].G(j[L]);this.extendSizeWorld.G(this.extendSize),this.centerWorld.G(this.center)}else{r.Bz(Number.MAX_VALUE),p.Bz(-Number.MAX_VALUE);for(let J=0;J<8;++J){const z=n[J];i.cr.TransformCoordinatesToRef(j[J],L,z),r.minimizeInPlace(z),p.maximizeInPlace(z)}p.subtractToRef(r,this.extendSizeWorld).scaleInPlace(.5),p.addToRef(r,this.centerWorld).scaleInPlace(.5)}i.cr.FromArrayToRef(L.m,0,J[0]),i.cr.FromArrayToRef(L.m,4,J[1]),i.cr.FromArrayToRef(L.m,8,J[2]),this._worldMatrix=L}isInFrustum(L){return j.IsInFrustum(this.vectorsWorld,L)}isCompletelyInFrustum(L){return j.IsCompletelyInFrustum(this.vectorsWorld,L)}intersectsPoint(L){const r=this.minimumWorld,p=this.maximumWorld,J=r.x,i=r.y,j=r.z,z=p.x,G=p.y,C=p.z,t=L.x,E=L.y,x=L.z,w=-n.d;return!(z-t<w||w>t-J)&&(!(G-E<w||w>E-i)&&!(C-x<w||w>x-j))}intersectsSphere(L){return j.IntersectsSphere(this.minimumWorld,this.maximumWorld,L.centerWorld,L.radiusWorld)}intersectsMinMax(L,r){const p=this.minimumWorld,J=this.maximumWorld,i=p.x,n=p.y,j=p.z,z=J.x,G=J.y,C=J.z,t=L.x,E=L.y,x=L.z,w=r.x,g=r.y,b=r.z;return!(z<t||i>w)&&(!(G<E||n>g)&&!(C<x||j>b))}dispose(){var L,r;null===(L=this._drawWrapperFront)||void 0===L||L.dispose(),null===(r=this._drawWrapperBack)||void 0===r||r.dispose()}static Intersects(L,r){return L.intersectsMinMax(r.minimumWorld,r.maximumWorld)}static IntersectsSphere(L,r,p,J){const n=j._TmpVector3[0];i.cr.ClampToRef(p,L,r,n);return i.cr.DistanceSquared(p,n)<=J*J}static IsCompletelyInFrustum(L,r){for(let p=0;p<6;++p){const J=r[p];for(let r=0;r<8;++r)if(J.dotCoordinate(L[r])<0)return!1}return!0}static IsInFrustum(L,r){for(let p=0;p<6;++p){let J=!0;const i=r[p];for(let r=0;r<8;++r)if(i.dotCoordinate(L[r])>=0){J=!1;break}if(J)return!1}return!0}}j._TmpVector3=(0,J.e)(3,i.cr.Zero)},12468:(L,r,p)=>{p.d(r,{d:()=>E});var J=p(12149),i=p(12136),n=p(12474),j=p(12480);const z={min:0,max:0},G={min:0,max:0},C=(L,r,p)=>{const J=i.cr.Dot(r.centerWorld,L),n=Math.abs(i.cr.Dot(r.directions[0],L))*r.extendSize.x+Math.abs(i.cr.Dot(r.directions[1],L))*r.extendSize.y+Math.abs(i.cr.Dot(r.directions[2],L))*r.extendSize.z;p.min=J-n,p.max=J+n},t=(L,r,p)=>(C(L,r,z),C(L,p,G),!(z.min>G.max||G.min>z.max));class E{constructor(L,r,p){this._isLocked=!1,this.boundingBox=new n.e(L,r,p),this.boundingSphere=new j.b(L,r,p)}reConstruct(L,r,p){this.boundingBox.reConstruct(L,r,p),this.boundingSphere.reConstruct(L,r,p)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(L){this._isLocked=L}update(L){this._isLocked||(this.boundingBox._update(L),this.boundingSphere._update(L))}centerOn(L,r){const p=E._TmpVector3[0].G(L).JE(r),J=E._TmpVector3[1].G(L).addInPlace(r);return this.boundingBox.reConstruct(p,J,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(p,J,this.boundingBox.getWorldMatrix()),this}encapsulate(L){const r=i.cr.Minimize(this.minimum,L),p=i.cr.Maximize(this.maximum,L);return this.reConstruct(r,p,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(L){const r=i.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(r);const p=i.TmpVectors.cr[0];return i.cr.TransformCoordinatesToRef(L.boundingBox.minimumWorld,r,p),this.encapsulate(p),i.cr.TransformCoordinatesToRef(L.boundingBox.maximumWorld,r,p),this.encapsulate(p),this}scale(L){return this.boundingBox.scale(L),this.boundingSphere.scale(L),this}isInFrustum(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===r||3===r)&&this.boundingSphere.isCenterInFrustum(L))return!0;if(!this.boundingSphere.isInFrustum(L))return!1;return!(1!==r&&3!==r)||this.boundingBox.isInFrustum(L)}get diagonalLength(){const L=this.boundingBox;return L.maximumWorld.subtractToRef(L.minimumWorld,E._TmpVector3[0]).length()}isCompletelyInFrustum(L){return this.boundingBox.isCompletelyInFrustum(L)}_checkCollision(L){return L._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(L){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(L)&&!!this.boundingBox.intersectsPoint(L))}intersects(L,r){if(!j.b.Intersects(this.boundingSphere,L.boundingSphere))return!1;if(!n.e.Intersects(this.boundingBox,L.boundingBox))return!1;if(!r)return!0;const p=this.boundingBox,J=L.boundingBox;return!!t(p.directions[0],p,J)&&(!!t(p.directions[1],p,J)&&(!!t(p.directions[2],p,J)&&(!!t(J.directions[0],p,J)&&(!!t(J.directions[1],p,J)&&(!!t(J.directions[2],p,J)&&(!!t(i.cr.Cross(p.directions[0],J.directions[0]),p,J)&&(!!t(i.cr.Cross(p.directions[0],J.directions[1]),p,J)&&(!!t(i.cr.Cross(p.directions[0],J.directions[2]),p,J)&&(!!t(i.cr.Cross(p.directions[1],J.directions[0]),p,J)&&(!!t(i.cr.Cross(p.directions[1],J.directions[1]),p,J)&&(!!t(i.cr.Cross(p.directions[1],J.directions[2]),p,J)&&(!!t(i.cr.Cross(p.directions[2],J.directions[0]),p,J)&&(!!t(i.cr.Cross(p.directions[2],J.directions[1]),p,J)&&!!t(i.cr.Cross(p.directions[2],J.directions[2]),p,J))))))))))))))}}E._TmpVector3=(0,J.e)(2,i.cr.Zero)},12480:(L,r,p)=>{p.d(r,{b:()=>n});var J=p(12149),i=p(12136);class n{constructor(L,r,p){this.center=i.cr.Zero(),this.centerWorld=i.cr.Zero(),this.minimum=i.cr.Zero(),this.maximum=i.cr.Zero(),this.reConstruct(L,r,p)}reConstruct(L,r,p){this.minimum.G(L),this.maximum.G(r);const J=i.cr.Distance(L,r);r.addToRef(L,this.center).scaleInPlace(.5),this.radius=.5*J,this._update(p||i.Matrix.IdentityReadOnly)}scale(L){const r=this.radius*L,p=n._TmpVector3,J=p[0].Bz(r),i=this.center.subtractToRef(J,p[1]),j=this.center.addToRef(J,p[2]);return this.reConstruct(i,j,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(L){if(L.isIdentity())this.centerWorld.G(this.center),this.radiusWorld=this.radius;else{i.cr.TransformCoordinatesToRef(this.center,L,this.centerWorld);const r=n._TmpVector3[0];i.cr.TransformNormalFromFloatsToRef(1,1,1,L,r),this.radiusWorld=Math.max(Math.abs(r.x),Math.abs(r.y),Math.abs(r.z))*this.radius}}isInFrustum(L){const r=this.centerWorld,p=this.radiusWorld;for(let J=0;J<6;J++)if(L[J].dotCoordinate(r)<=-p)return!1;return!0}isCenterInFrustum(L){const r=this.centerWorld;for(let p=0;p<6;p++)if(L[p].dotCoordinate(r)<0)return!1;return!0}intersectsPoint(L){const r=i.cr.DistanceSquared(this.centerWorld,L);return!(this.radiusWorld*this.radiusWorld<r)}static Intersects(L,r){const p=i.cr.DistanceSquared(L.centerWorld,r.centerWorld),J=L.radiusWorld+r.radiusWorld;return!(J*J<p)}static CreateFromCenterAndRadius(L,r,p){this._TmpVector3[0].G(L),this._TmpVector3[1].Uz(0,0,r),this._TmpVector3[2].G(L),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].JE(this._TmpVector3[1]);const J=new n(this._TmpVector3[0],this._TmpVector3[2]);return J._worldMatrix=p||i.Matrix.Identity(),J}}n._TmpVector3=(0,J.e)(3,i.cr.Zero)},12500:(L,r,p)=>{function J(L){-1===L.indexOf("vClipPlane")&&L.push("vClipPlane"),-1===L.indexOf("vClipPlane2")&&L.push("vClipPlane2"),-1===L.indexOf("vClipPlane3")&&L.push("vClipPlane3"),-1===L.indexOf("vClipPlane4")&&L.push("vClipPlane4"),-1===L.indexOf("vClipPlane5")&&L.push("vClipPlane5"),-1===L.indexOf("vClipPlane6")&&L.push("vClipPlane6")}function i(L,r,p){const J=!!(L.clipPlane??r.clipPlane),i=!!(L.clipPlane2??r.clipPlane2),n=!!(L.clipPlane3??r.clipPlane3),j=!!(L.clipPlane4??r.clipPlane4),z=!!(L.clipPlane5??r.clipPlane5),G=!!(L.clipPlane6??r.clipPlane6);J&&p.push("#define CLIPPLANE"),i&&p.push("#define CLIPPLANE2"),n&&p.push("#define CLIPPLANE3"),j&&p.push("#define CLIPPLANE4"),z&&p.push("#define CLIPPLANE5"),G&&p.push("#define CLIPPLANE6")}function n(L,r,p){let J=!1;const i=!!(L.clipPlane??r.clipPlane),n=!!(L.clipPlane2??r.clipPlane2),j=!!(L.clipPlane3??r.clipPlane3),z=!!(L.clipPlane4??r.clipPlane4),G=!!(L.clipPlane5??r.clipPlane5),C=!!(L.clipPlane6??r.clipPlane6);return p.CLIPPLANE!==i&&(p.CLIPPLANE=i,J=!0),p.CLIPPLANE2!==n&&(p.CLIPPLANE2=n,J=!0),p.CLIPPLANE3!==j&&(p.CLIPPLANE3=j,J=!0),p.CLIPPLANE4!==z&&(p.CLIPPLANE4=z,J=!0),p.CLIPPLANE5!==G&&(p.CLIPPLANE5=G,J=!0),p.CLIPPLANE6!==C&&(p.CLIPPLANE6=C,J=!0),J}function j(L,r,p){let J=r.clipPlane??p.clipPlane;z(L,"vClipPlane",J),J=r.clipPlane2??p.clipPlane2,z(L,"vClipPlane2",J),J=r.clipPlane3??p.clipPlane3,z(L,"vClipPlane3",J),J=r.clipPlane4??p.clipPlane4,z(L,"vClipPlane4",J),J=r.clipPlane5??p.clipPlane5,z(L,"vClipPlane5",J),J=r.clipPlane6??p.clipPlane6,z(L,"vClipPlane6",J)}function z(L,r,p){p&&L.setFloat4(r,p.normal.x,p.normal.y,p.normal.z,p.d)}p.d(r,{e:()=>J,g:()=>j,k:()=>n,m:()=>i})},12434:(L,r,p)=>{p.d(r,{e:()=>J});class J{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(L,r){this._defines[L]||(L<this._currentRank&&(this._currentRank=L),L>this._maxRank&&(this._maxRank=L),this._defines[L]=new Array),this._defines[L].push(r)}addCPUSkinningFallback(L,r){this._mesh=r,L<this._currentRank&&(this._currentRank=L),L>this._maxRank&&(this._maxRank=L)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(L,r){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,L=L.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),r._bonesComputationForcedToCPU=!0;const p=this._mesh.FL();for(let L=0;L<p.meshes.length;L++){const J=p.meshes[L];if(J.material){if(J.computeBonesUsingShaders&&0!==J.numBoneInfluencers)if(J.material.getEffect()===r)J.computeBonesUsingShaders=!1;else if(J.ln)for(const L of J.ln){if(L.effect===r){J.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&J.computeBonesUsingShaders&&J.numBoneInfluencers>0&&(J.computeBonesUsingShaders=!1)}}else{const r=this._defines[this._currentRank];if(r)for(let p=0;p<r.length;p++)L=L.replace("#define "+r[p],"");this._currentRank++}return L}}},12446:(L,r,p)=>{p.d(r,{d:()=>c});var J=p(12113),i=p(12122),n=p(11957),j=p(11964),z=p(12009),G=p(12450),C=p(12384),t=p(11975),E=p(12179),x=p(12247),w=p(12162);class g{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(L){this._func=L}get funcRef(){return this._funcRef}set funcRef(L){this._funcRef=L}get funcMask(){return this._funcMask}set funcMask(L){this._funcMask=L}get opStencilFail(){return this._opStencilFail}set opStencilFail(L){this._opStencilFail=L}get opDepthFail(){return this._opDepthFail}set opDepthFail(L){this._opDepthFail=L}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(L){this._opStencilDepthPass=L}get mask(){return this._mask}set mask(L){this._mask=L}get enabled(){return this._enabled}set enabled(L){this._enabled=L}getClassName(){return"MaterialStencilState"}copyTo(L){w.c.Clone((()=>L),this)}serialize(){return w.c.Serialize(this)}parse(L,r,p){w.c.Parse((()=>this),L,r,p)}}(0,J.e)([(0,i.E)()],g.prototype,"func",null),(0,J.e)([(0,i.E)()],g.prototype,"funcRef",null),(0,J.e)([(0,i.E)()],g.prototype,"funcMask",null),(0,J.e)([(0,i.E)()],g.prototype,"opStencilFail",null),(0,J.e)([(0,i.E)()],g.prototype,"opDepthFail",null),(0,J.e)([(0,i.E)()],g.prototype,"opStencilDepthPass",null),(0,J.e)([(0,i.E)()],g.prototype,"mask",null),(0,J.e)([(0,i.E)()],g.prototype,"enabled",null);var b=p(12493);class c{get _supportGlowLayer(){return!1}set _glowModeEnabled(L){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(L){if(this._alpha===L)return;const r=this._alpha;this._alpha=L,1!==r&&1!==L||this.HC(c.MiscDirtyFlag+c.PrePassDirtyFlag)}get alpha(){return this._alpha}set hz(L){this._backFaceCulling!==L&&(this._backFaceCulling=L,this.HC(c.TextureDirtyFlag))}get hz(){return this._backFaceCulling}set cullBackFaces(L){this._cullBackFaces!==L&&(this._cullBackFaces=L,this.HC(c.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(L){this._blockDirtyMechanism!==L&&(this._blockDirtyMechanism=L,L||this.HE())}atomicMaterialsUpdate(L){this.blockDirtyMechanism=!0;try{L(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(L){this._onDisposeObserver&&this.ji.remove(this._onDisposeObserver),this._onDisposeObserver=this.ji.add(L)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new j.c),this._onBindObservable}set onBind(L){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(L)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new j.c),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new j.c),this._onEffectCreatedObservable}set alphaMode(L){this._alphaMode!==L&&(this._alphaMode=L,this.HC(c.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(L){this._needDepthPrePass!==L&&(this._needDepthPrePass=L,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(L){this._fogEnabled!==L&&(this._fogEnabled=L,this.HC(c.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case c.WireFrameFillMode:case c.LineListDrawMode:case c.LineLoopDrawMode:case c.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(L){this.fillMode=L?c.WireFrameFillMode:c.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case c.PointFillMode:case c.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(L){this.fillMode=L?c.PointFillMode:c.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(L){this._fillMode!==L&&(this._fillMode=L,this.HC(c.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(L){const r=this.FL().getEngine().getCaps().fragmentDepthSupported;L&&!r&&t.d.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=L&&r,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(L){this._drawWrapper=L}constructor(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.ji=new j.c,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.ti=new g,this._useUBO=!1,this._fillMode=c.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=L;const i=r||z.c.LastCreatedScene;i&&(this._scene=i,this._dirtyCallbacks={},this._forceGLSL=J,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=L||n.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new x.d(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new C.d(this._scene.getEngine(),void 0,void 0,L),this._useUBO=this.FL().getEngine().supportsUniformBuffers,this._createUniformBuffer(),p||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),c.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var L;const r=this.FL().getEngine();null===(L=this._uniformBuffer)||void 0===L||L.dispose(),r.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new C.d(r,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new C.d(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(L){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.HE(),this.checkReadyOnlyOnce=!0}unfreeze(){this.HE(),this.checkReadyOnlyOnce=!1}isReady(L,r){return!0}isReadyForSubMesh(L,r,p){const J=r.materialDefines;return!!J&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=J,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}FL(){return this._scene}_getEffectiveOrientation(L){return null!==this.sideOrientation?this.sideOrientation:L.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(L){this._transparencyMode!==L&&(this._transparencyMode=L,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===c.MATERIAL_ALPHABLEND||this._transparencyMode===c.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===c.MATERIAL_ALPHATEST||this._transparencyMode===c.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===c.MATERIAL_OPAQUE||this._transparencyMode===c.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(L){return this._hasTransparencyMode?this._transparencyModeIsBlend:L.visibility<1||!this._disableAlphaBlending&&(L.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(L){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(L)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}HE(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=this.FL().meshes;for(const p of r)if(p.ln)for(const r of p.ln)if(r.lL()===this)for(const p of r._drawWrappers)p&&this._materialContext===p.materialContext&&(p._wasPreviouslyReady=!1,p._wasPreviouslyUsingInstances=null,p._forceRebindOnNextCall=L);L&&this.HC(c.AllDirtyFlag)}_preBind(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const p=this._scene.getEngine(),J=(null==r?this.sideOrientation:r)===c.ClockWiseSideOrientation;return p.enableEffect(L||this._getDrawWrapper()),p.setState(this.hz,this.zOffset,!1,J,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.ti,this.zOffsetUnits),J}bind(L,r){}buildUniformLayout(){const L=this._uniformBuffer;this._eventInfo.ubo=L,this._callbackPluginEventGeneric(8,this._eventInfo),L.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(L,r,p){const J=p._drawWrapper;this._eventInfo.subMesh=p,this._callbackPluginEventBindForSubMesh(this._eventInfo),J._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(L){}bindView(L){this._useUBO?this._needToBindSceneUbo=!0:L.setMatrix("view",this.FL().getViewMatrix())}bindViewProjection(L){this._useUBO?this._needToBindSceneUbo=!0:(L.setMatrix("viewProjection",this.FL().getTransformMatrix()),L.setMatrix("projection",this.FL().getProjectionMatrix()))}bindEyePosition(L,r){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(L,r)}_afterBind(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&r&&(this._needToBindSceneUbo=!1,(0,b.s)(r,this.FL().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=L?L.visibility:1,this._onBindObservable&&L&&this._onBindObservable.notifyObservers(L),this.disableDepthWrite){const L=this._scene.getEngine();this._cachedDepthWriteState=L.getDepthWrite(),L.setDepthWrite(!1)}if(this.disableColorWrite){const L=this._scene.getEngine();this._cachedColorWriteState=L.getColorWrite(),L.setColorWrite(!1)}if(0!==this.depthFunction){const L=this._scene.getEngine();this._cachedDepthFunctionState=L.getDepthFunction()||0,L.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(L){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=L,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(L){return null}_clonePlugins(L,r){const p={};if(this._serializePlugins(p),c._ParsePlugins(p,L,this._scene,r),this.pluginManager)for(const J of this.pluginManager._plugins){const r=L.pluginManager.getPlugin(J.name);r&&J.copyTo(r)}}getBindedMeshes(){if(this.meshMap){const L=[];for(const r in this.meshMap){const p=this.meshMap[r];p&&L.push(p)}return L}return this._scene.meshes.filter((L=>L.material===this))}forceCompilation(L,r,p,J){const i={clipPlane:!1,useInstances:!1,...p},n=this.FL(),j=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const z=()=>{if(!this._scene||!this._scene.getEngine())return;const p=n.clipPlane;if(i.clipPlane&&(n.clipPlane=new E.c(0,0,0,1)),this._storeEffectOnSubMeshes){let p=!0,n=null;if(L.ln){const r=new G.c(0,0,0,0,0,L,void 0,!1,!1);r.materialDefines&&(r.materialDefines._renderId=-1),this.isReadyForSubMesh(L,r,i.useInstances)||(r.effect&&r.effect.getCompilationError()&&r.effect.allFallbacksProcessed()?n=r.effect.getCompilationError():(p=!1,setTimeout(z,16)))}p&&(this.allowShaderHotSwapping=j,n&&J&&J(n),r&&r(this))}else this.isReady()?(this.allowShaderHotSwapping=j,r&&r(this)):setTimeout(z,16);i.clipPlane&&(n.clipPlane=p)};z()}async forceCompilationAsync(L,r){return await new Promise(((p,J)=>{this.forceCompilation(L,(()=>{p()}),r,(L=>{J(L)}))}))}HC(L){this.FL().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(c._DirtyCallbackArray.length=0,L&c.ImageProcessingDirtyFlag&&c._DirtyCallbackArray.push(c._ImageProcessingDirtyCallBack),L&c.TextureDirtyFlag&&c._DirtyCallbackArray.push(c._TextureDirtyCallBack),L&c.LightDirtyFlag&&c._DirtyCallbackArray.push(c._LightsDirtyCallBack),L&c.FresnelDirtyFlag&&c._DirtyCallbackArray.push(c._FresnelDirtyCallBack),L&c.AttributesDirtyFlag&&c._DirtyCallbackArray.push(c._AttributeDirtyCallBack),L&c.MiscDirtyFlag&&c._DirtyCallbackArray.push(c._MiscDirtyCallBack),L&c.PrePassDirtyFlag&&c._DirtyCallbackArray.push(c._PrePassDirtyCallBack),c._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(c._RunDirtyCallBacks),this.FL().resetCachedMaterial())}resetDrawCache(){const L=this.FL().meshes;for(const r of L)if(r.ln)for(const L of r.ln)L.lL()===this&&L.resetDrawCache()}_markAllSubMeshesAsDirty(L){const r=this.FL();if(r.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const p=r.meshes;for(const J of p)if(J.ln)for(const p of J.ln){if((p.lL()||(r._hasDefaultMaterial?r.defaultMaterial:null))===this)for(const r of p._drawWrappers)r&&r.defines&&r.defines.markAllAsDirty&&this._materialContext===r.materialContext&&L(r.defines)}}_markScenePrePassDirty(){if(this.FL().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const L=this.FL().enablePrePassRenderer();L&&L.HC()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(c._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(c._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(c._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(c._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(c._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(c._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(c._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(c._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(c._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(c._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const L=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.ji.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(L)}))}}setPrePassRenderer(L){return!1}dispose(L,r,p){const J=this.FL();if(J.stopAnimation(this),J.freeProcessedMaterials(),J.removeMaterial(this),this._eventInfo.forceDisposeTextures=r,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const L=this._parentContainer.materials.indexOf(this);L>-1&&this._parentContainer.materials.splice(L,1),this._parentContainer=null}if(!0!==p)if(this.meshMap)for(const i in this.meshMap){const L=this.meshMap[i];this._disposeMeshResources(L)}else{const L=J.meshes;for(const r of L)this._disposeMeshResources(r)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.ji.notifyObservers(this),this.ji.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(L){if(!L)return;const r=L.Pz,p=L._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(L.ln&&p)for(const i of L.ln){const L=i._drawWrappers;for(let n=0;n<L.length;n++){var J;const j=null===(J=L[n])||void 0===J?void 0:J.effect;if(!j)continue;p[n]===this&&(null===r||void 0===r||r._releaseVertexArrayObject(j),i._removeDrawWrapper(n,!0,!0))}}}else null===r||void 0===r||r._releaseVertexArrayObject(this._drawWrapper.effect);L.material!==this||L.sourceMesh||(L.material=null)}serialize(){const L=w.c.Serialize(this);return L.ti=this.ti.serialize(),L.uniqueId=this.uniqueId,this._serializePlugins(L),L}_serializePlugins(L){if(L.plugins={},this.pluginManager)for(const r of this.pluginManager._plugins)r.doNotSerialize||(L.plugins[r.getClassName()]=r.serialize())}static Parse(L,r,p){if(L.customType){if("BABYLON.PBRMaterial"===L.customType&&L.overloadedAlbedo&&(L.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return t.d.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else L.customType="BABYLON.StandardMaterial";const J=n.Tools.Instantiate(L.customType).Parse(L,r,p);return J._loadedUniqueId=L.uniqueId,J}static _ParsePlugins(L,r,p,J){if(L.plugins)for(const z in L.plugins){var i,j;const G=L.plugins[z];let C=null===(i=r.pluginManager)||void 0===i?void 0:i.getPlugin(G.name);if(!C){const L=n.Tools.Instantiate("BABYLON."+z);L&&(C=new L(r))}null===(j=C)||void 0===j||j.parse(G,p,J)}}}c.TriangleFillMode=0,c.WireFrameFillMode=1,c.PointFillMode=2,c.PointListDrawMode=3,c.LineListDrawMode=4,c.LineLoopDrawMode=5,c.LineStripDrawMode=6,c.TriangleStripDrawMode=7,c.TriangleFanDrawMode=8,c.ClockWiseSideOrientation=0,c.CounterClockWiseSideOrientation=1,c.ImageProcessingDirtyFlag=64,c.TextureDirtyFlag=1,c.LightDirtyFlag=2,c.FresnelDirtyFlag=4,c.AttributesDirtyFlag=8,c.MiscDirtyFlag=16,c.PrePassDirtyFlag=32,c.AllDirtyFlag=127,c.MATERIAL_OPAQUE=0,c.MATERIAL_ALPHATEST=1,c.MATERIAL_ALPHABLEND=2,c.MATERIAL_ALPHATESTANDBLEND=3,c.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,c.MATERIAL_NORMALBLENDMETHOD_RNM=1,c.OnEventObservable=new j.c,c._AllDirtyCallBack=L=>L.markAllAsDirty(),c._ImageProcessingDirtyCallBack=L=>L.markAsImageProcessingDirty(),c._TextureDirtyCallBack=L=>L.markAsTexturesDirty(),c._FresnelDirtyCallBack=L=>L.markAsFresnelDirty(),c._MiscDirtyCallBack=L=>L.markAsMiscDirty(),c._PrePassDirtyCallBack=L=>L.markAsPrePassDirty(),c._LightsDirtyCallBack=L=>L.markAsLightDirty(),c._AttributeDirtyCallBack=L=>L.markAsAttributesDirty(),c._FresnelAndMiscDirtyCallBack=L=>{c._FresnelDirtyCallBack(L),c._MiscDirtyCallBack(L)},c._TextureAndMiscDirtyCallBack=L=>{c._TextureDirtyCallBack(L),c._MiscDirtyCallBack(L)},c._DirtyCallbackArray=[],c._RunDirtyCallBacks=L=>{for(const r of c._DirtyCallbackArray)r(L)},(0,J.e)([(0,i.E)()],c.prototype,"id",void 0),(0,J.e)([(0,i.E)()],c.prototype,"uniqueId",void 0),(0,J.e)([(0,i.E)()],c.prototype,"name",void 0),(0,J.e)([(0,i.E)()],c.prototype,"metadata",void 0),(0,J.e)([(0,i.E)()],c.prototype,"checkReadyOnEveryCall",void 0),(0,J.e)([(0,i.E)()],c.prototype,"checkReadyOnlyOnce",void 0),(0,J.e)([(0,i.E)()],c.prototype,"state",void 0),(0,J.e)([(0,i.E)("alpha")],c.prototype,"_alpha",void 0),(0,J.e)([(0,i.E)("hz")],c.prototype,"_backFaceCulling",void 0),(0,J.e)([(0,i.E)("cullBackFaces")],c.prototype,"_cullBackFaces",void 0),(0,J.e)([(0,i.E)()],c.prototype,"sideOrientation",void 0),(0,J.e)([(0,i.E)("alphaMode")],c.prototype,"_alphaMode",void 0),(0,J.e)([(0,i.E)()],c.prototype,"_needDepthPrePass",void 0),(0,J.e)([(0,i.E)()],c.prototype,"disableDepthWrite",void 0),(0,J.e)([(0,i.E)()],c.prototype,"disableColorWrite",void 0),(0,J.e)([(0,i.E)()],c.prototype,"forceDepthWrite",void 0),(0,J.e)([(0,i.E)()],c.prototype,"depthFunction",void 0),(0,J.e)([(0,i.E)()],c.prototype,"separateCullingPass",void 0),(0,J.e)([(0,i.E)("fogEnabled")],c.prototype,"_fogEnabled",void 0),(0,J.e)([(0,i.E)()],c.prototype,"pointSize",void 0),(0,J.e)([(0,i.E)()],c.prototype,"zOffset",void 0),(0,J.e)([(0,i.E)()],c.prototype,"zOffsetUnits",void 0),(0,J.e)([(0,i.E)()],c.prototype,"pointsCloud",null),(0,J.e)([(0,i.E)()],c.prototype,"fillMode",null),(0,J.e)([(0,i.E)()],c.prototype,"useLogarithmicDepth",null),(0,J.e)([(0,i.E)()],c.prototype,"transparencyMode",null)},12493:(L,r,p)=>{p.d(r,{A:()=>h,E:()=>F,F:()=>Q,I:()=>w,L:()=>x,N:()=>a,R:()=>u,U:()=>y,V:()=>P,W:()=>v,X:()=>q,_:()=>Z,cb:()=>X,db:()=>l,e:()=>U,fb:()=>g,h:()=>E,j:()=>B,n:()=>t,o:()=>b,s:()=>c,v:()=>O,y:()=>e});var J=p(11975),i=p(12170),n=p(12009),j=p(12431),z=p(12500);const G=i.Wr.Black(),C={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function t(L,r,p){if(!L||L.LOGARITHMICDEPTH||L.indexOf&&L.indexOf("LOGARITHMICDEPTH")>=0){const L=p.activeCamera;1===L.mode&&J.d.Error("Logarithmic depth is not compatible with orthographic cameras!",20),r.setFloat("logarithmicDepthConstant",2/(Math.log(L.maxZ+1)/Math.LN2))}}function E(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]&&arguments[3];p&&L.fogEnabled&&(!r||r.applyFog)&&0!==L.fogMode&&(p.setFloat4("vFogInfos",L.fogMode,L.fogStart,L.fogEnd,L.fogDensity),J?(L.fogColor.toLinearSpaceToRef(G,L.getEngine().useExactSrgbConversions),p.setColor3("vFogColor",G)):p.setColor3("vFogColor",L.fogColor))}function x(L,r,p,J,i,n,j,z,G,t){const E=L.numMaxInfluencers||L.numInfluencers;return E<=0?0:(r.push("#define MORPHTARGETS"),L.hasPositions&&r.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),L.hasNormals&&r.push("#define MORPHTARGETTEXTURE_HASNORMALS"),L.hasTangents&&r.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),L.hasUVs&&r.push("#define MORPHTARGETTEXTURE_HASUVS"),L.hasUV2s&&r.push("#define MORPHTARGETTEXTURE_HASUV2S"),L.hasColors&&r.push("#define MORPHTARGETTEXTURE_HASCOLORS"),L.supportsPositions&&i&&r.push("#define MORPHTARGETS_POSITION"),L.supportsNormals&&n&&r.push("#define MORPHTARGETS_NORMAL"),L.supportsTangents&&j&&r.push("#define MORPHTARGETS_TANGENT"),L.supportsUVs&&z&&r.push("#define MORPHTARGETS_UV"),L.supportsUV2s&&G&&r.push("#define MORPHTARGETS_UV2"),L.supportsColors&&t&&r.push("#define MORPHTARGETS_COLOR"),r.push("#define NUM_MORPH_INFLUENCERS "+E),L.isUsingTextureForTargets&&r.push("#define MORPHTARGETS_TEXTURE"),C.NUM_MORPH_INFLUENCERS=E,C.NORMAL=n,C.TANGENT=j,C.UV=z,C.UV2=G,C.COLOR=t,w(p,J,C,i),E)}function w(L,r,p){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const j=p.NUM_MORPH_INFLUENCERS;if(j>0&&n.c.LastCreatedEngine){const z=n.c.LastCreatedEngine.getCaps().maxVertexAttribs,G=r.morphTargetManager;if(null!==G&&void 0!==G&&G.isUsingTextureForTargets)return;const C=G&&G.supportsPositions&&i,t=G&&G.supportsNormals&&p.NORMAL,E=G&&G.supportsTangents&&p.TANGENT,x=G&&G.supportsUVs&&p.UV1,w=G&&G.supportsUV2s&&p.UV2,g=G&&G.supportsColors&&p.VERTEXCOLOR;for(let p=0;p<j;p++)C&&L.push("position"+p),t&&L.push("normal"+p),E&&L.push("tangent"+p),x&&L.push("uv_"+p),w&&L.push("uv2_"+p),g&&L.push("color"+p),L.length>z&&J.d.Error("Cannot add more vertex attributes for mesh "+r.name)}}function g(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];L.push("world0"),L.push("world1"),L.push("world2"),L.push("world3"),r&&(L.push("previousWorld0"),L.push("previousWorld1"),L.push("previousWorld2"),L.push("previousWorld3"))}function b(L,r){const p=L.morphTargetManager;L&&p&&r.setFloatArray("morphTargetInfluences",p.influences)}function c(L,r){r.bindToEffect(L,"Scene")}function P(L,r,p){r._needUVs=!0,r[p]=!0,L.optimizeUVAllocation&&L.getTextureMatrix().isIdentityAs3x2()?(r[p+"DIRECTUV"]=L.coordinatesIndex+1,r["MAINUV"+(L.coordinatesIndex+1)]=!0):r[p+"DIRECTUV"]=0}function O(L,r,p){const J=L.getTextureMatrix();r.tz(p+"Matrix",J)}function h(L,r,p){p.BAKED_VERTEX_ANIMATION_TEXTURE&&p.INSTANCES&&L.push("bakedVertexAnimationSettingsInstanced")}function U(L,r,p){var J;if(r&&L&&(L.computeBonesUsingShaders&&r._bonesComputationForcedToCPU&&(L.computeBonesUsingShaders=!1),L.useBones&&L.computeBonesUsingShaders&&L.skeleton)){const i=L.skeleton;if(i.isUsingTextureForMatrices&&r.getUniformIndex("boneTextureWidth")>-1){const p=i.getTransformMatrixTexture(L);r.setTexture("boneSampler",p),r.setFloat("boneTextureWidth",4*(i.bones.length+1))}else{const n=i.getTransformMatrices(L);n&&(r.setMatrices("mBones",n),p&&L.FL().prePassRenderer&&L.FL().prePassRenderer.getIndex(2)&&(p.previousBones[L.uniqueId]||(p.previousBones[L.uniqueId]=n.slice()),r.setMatrices("mPreviousBones",p.previousBones[L.uniqueId]),J=n,p.previousBones[L.uniqueId].set(J)))}}}function W(L,r,p,J,i){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];L._bindLight(r,p,J,i,n)}function B(L,r,p,J){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const n=Math.min(r.lightSources.length,i);for(let j=0;j<n;j++){W(r.lightSources[j],j,L,p,"boolean"===typeof J?J:J.SPECULARTERM,r.receiveShadows)}}function F(L,r,p,J){p.NUM_BONE_INFLUENCERS>0&&(J.addCPUSkinningFallback(0,r),L.push("matricesIndices"),L.push("matricesWeights"),p.NUM_BONE_INFLUENCERS>4&&(L.push("matricesIndicesExtra"),L.push("matricesWeightsExtra")))}function Q(L,r){(r.INSTANCES||r.THIN_INSTANCES)&&g(L,!!r.PREPASS_VELOCITY),r.INSTANCESCOLOR&&L.push("instanceColor")}function e(L,r){let p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=0;for(let n=0;n<p&&L["LIGHT"+n];n++)n>0&&(i=J+n,r.addFallback(i,"LIGHT"+n)),L.SHADOWS||(L["SHADOW"+n]&&r.addFallback(J,"SHADOW"+n),L["SHADOWPCF"+n]&&r.addFallback(J,"SHADOWPCF"+n),L["SHADOWPCSS"+n]&&r.addFallback(J,"SHADOWPCSS"+n),L["SHADOWPOISSON"+n]&&r.addFallback(J,"SHADOWPOISSON"+n),L["SHADOWESM"+n]&&r.addFallback(J,"SHADOWESM"+n),L["SHADOWCLOSEESM"+n]&&r.addFallback(J,"SHADOWCLOSEESM"+n));return i++}function v(L,r,p,J,i,n,j){let z=arguments.length>7&&void 0!==arguments[7]&&arguments[7];j._areMiscDirty&&(j.LOGARITHMICDEPTH=p,j.POINTSIZE=J,j.FOG=i&&function(L,r){return r.fogEnabled&&L.applyFog&&0!==r.fogMode}(L,r),j.NONUNIFORMSCALING=L.nonUniformScaling,j.ALPHATEST=n,j.DECAL_AFTER_DETAIL=z)}function y(L,r,p,J){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!p._areLightsDirty)return p._needNormals;let j=0;const z={needNormals:p._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(L.lightsEnabled&&!n)for(const C of r.lightSources)if(A(L,r,C,j,p,J,z),j++,j===i)break;p.SPECULARTERM=z.specularEnabled,p.SHADOWS=z.shadowEnabled;for(let C=j;C<i;C++)void 0!==p["LIGHT"+C]&&(p["LIGHT"+C]=!1,p["HEMILIGHT"+C]=!1,p["POINTLIGHT"+C]=!1,p["DIRLIGHT"+C]=!1,p["SPOTLIGHT"+C]=!1,p["AREALIGHT"+C]=!1,p["SHADOW"+C]=!1,p["SHADOWCSM"+C]=!1,p["SHADOWCSMDEBUG"+C]=!1,p["SHADOWCSMNUM_CASCADES"+C]=!1,p["SHADOWCSMUSESHADOWMAXZ"+C]=!1,p["SHADOWCSMNOBLEND"+C]=!1,p["SHADOWCSM_RIGHTHANDED"+C]=!1,p["SHADOWPCF"+C]=!1,p["SHADOWPCSS"+C]=!1,p["SHADOWPOISSON"+C]=!1,p["SHADOWESM"+C]=!1,p["SHADOWCLOSEESM"+C]=!1,p["SHADOWCUBE"+C]=!1,p["SHADOWLOWQUALITY"+C]=!1,p["SHADOWMEDIUMQUALITY"+C]=!1);const G=L.getEngine().getCaps();return void 0===p.SHADOWFLOAT&&(z.needRebuild=!0),p.SHADOWFLOAT=z.shadowEnabled&&(G.textureFloatRender&&G.textureFloatLinearFiltering||G.textureHalfFloatRender&&G.textureHalfFloatLinearFiltering),p.LIGHTMAPEXCLUDED=z.lightmapMode,z.needRebuild&&p.rebuild(),z.needNormals}function A(L,r,p,J,i,n,z){switch(z.needNormals=!0,void 0===i["LIGHT"+J]&&(z.needRebuild=!0),i["LIGHT"+J]=!0,i["SPOTLIGHT"+J]=!1,i["HEMILIGHT"+J]=!1,i["POINTLIGHT"+J]=!1,i["DIRLIGHT"+J]=!1,i["AREALIGHT"+J]=!1,p.prepareLightSpecificDefines(i,J),i["LIGHT_FALLOFF_PHYSICAL"+J]=!1,i["LIGHT_FALLOFF_GLTF"+J]=!1,i["LIGHT_FALLOFF_STANDARD"+J]=!1,p.falloffType){case j.d.FALLOFF_GLTF:i["LIGHT_FALLOFF_GLTF"+J]=!0;break;case j.d.FALLOFF_PHYSICAL:i["LIGHT_FALLOFF_PHYSICAL"+J]=!0;break;case j.d.FALLOFF_STANDARD:i["LIGHT_FALLOFF_STANDARD"+J]=!0}if(n&&!p.gt.equalsFloats(0,0,0)&&(z.specularEnabled=!0),i["SHADOW"+J]=!1,i["SHADOWCSM"+J]=!1,i["SHADOWCSMDEBUG"+J]=!1,i["SHADOWCSMNUM_CASCADES"+J]=!1,i["SHADOWCSMUSESHADOWMAXZ"+J]=!1,i["SHADOWCSMNOBLEND"+J]=!1,i["SHADOWCSM_RIGHTHANDED"+J]=!1,i["SHADOWPCF"+J]=!1,i["SHADOWPCSS"+J]=!1,i["SHADOWPOISSON"+J]=!1,i["SHADOWESM"+J]=!1,i["SHADOWCLOSEESM"+J]=!1,i["SHADOWCUBE"+J]=!1,i["SHADOWLOWQUALITY"+J]=!1,i["SHADOWMEDIUMQUALITY"+J]=!1,r&&r.receiveShadows&&L.shadowsEnabled&&p.shadowEnabled){const r=p.getShadowGenerator(L.activeCamera)??p.getShadowGenerator();if(r){const L=r.getShadowMap();L&&L.renderList&&L.renderList.length>0&&(z.shadowEnabled=!0,r.prepareDefines(i,J))}}p.lightmapMode!=j.d.LIGHTMAP_DEFAULT?(z.lightmapMode=!0,i["LIGHTMAPEXCLUDED"+J]=!0,i["LIGHTMAPNOSPECULAR"+J]=p.lightmapMode==j.d.LIGHTMAP_SHADOWSONLY):(i["LIGHTMAPEXCLUDED"+J]=!1,i["LIGHTMAPNOSPECULAR"+J]=!1)}function u(L,r,p,J,i){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,j=arguments.length>6&&void 0!==arguments[6]&&arguments[6],G=function(L,r){let p=!1;if(L.activeCamera){const J=r.CAMERA_ORTHOGRAPHIC?1:0,i=r.CAMERA_PERSPECTIVE?1:0,n=1===L.activeCamera.mode?1:0,j=0===L.activeCamera.mode?1:0;(J^n||i^j)&&(r.CAMERA_ORTHOGRAPHIC=1===n,r.CAMERA_PERSPECTIVE=1===j,p=!0)}return p}(L,J);!1!==n&&(G=(0,z.k)(p,L,J)),J.DEPTHPREPASS!==!r.getColorWrite()&&(J.DEPTHPREPASS=!J.DEPTHPREPASS,G=!0),J.INSTANCES!==i&&(J.INSTANCES=i,G=!0),J.THIN_INSTANCES!==j&&(J.THIN_INSTANCES=j,G=!0),G&&J.markAsUnprocessed()}function a(L,r,p,J){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],j=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!r._areAttributesDirty&&r._needNormals===r._normals&&r._needUVs===r._uvs)return!1;r._normals=r._needNormals,r._uvs=r._needUVs,r.NORMAL=r._needNormals&&L.isVerticesDataPresent("normal"),r._needNormals&&L.isVerticesDataPresent("tangent")&&(r.TANGENT=!0);for(let z=1;z<=6;++z)r["UV"+z]=!!r._needUVs&&L.isVerticesDataPresent(`uv${1===z?"":z}`);if(p){const p=L.useVertexColors&&L.isVerticesDataPresent("color");r.VERTEXCOLOR=p,r.VERTEXALPHA=L.hasVertexAlpha&&p&&n}return L.isVerticesDataPresent("instanceColor")&&(L.hasInstances||L.hasThinInstances)&&(r.INSTANCESCOLOR=!0),J&&function(L,r){if(L.useBones&&L.computeBonesUsingShaders&&L.skeleton){r.NUM_BONE_INFLUENCERS=L.numBoneInfluencers;const p=void 0!==r.BONETEXTURE;if(L.skeleton.isUsingTextureForMatrices&&p)r.BONETEXTURE=!0;else{r.BonesPerMesh=L.skeleton.bones.length+1,r.BONETEXTURE=!p&&void 0;const J=L.FL().prePassRenderer;if(J&&J.enabled){const p=-1===J.excludedSkinnedMesh.indexOf(L);r.BONES_VELOCITY_ENABLED=p}}}else r.NUM_BONE_INFLUENCERS=0,r.BonesPerMesh=0,void 0!==r.BONETEXTURE&&(r.BONETEXTURE=!1)}(L,r),i&&function(L,r){const p=L.morphTargetManager;p?(r.MORPHTARGETS_UV=p.supportsUVs&&r.UV1,r.MORPHTARGETS_UV2=p.supportsUV2s&&r.UV2,r.MORPHTARGETS_TANGENT=p.supportsTangents&&r.TANGENT,r.MORPHTARGETS_NORMAL=p.supportsNormals&&r.NORMAL,r.MORPHTARGETS_POSITION=p.supportsPositions,r.MORPHTARGETS_COLOR=p.supportsColors,r.MORPHTARGETTEXTURE_HASUVS=p.hasUVs,r.MORPHTARGETTEXTURE_HASUV2S=p.hasUV2s,r.MORPHTARGETTEXTURE_HASTANGENTS=p.hasTangents,r.MORPHTARGETTEXTURE_HASNORMALS=p.hasNormals,r.MORPHTARGETTEXTURE_HASPOSITIONS=p.hasPositions,r.MORPHTARGETTEXTURE_HASCOLORS=p.hasColors,r.NUM_MORPH_INFLUENCERS=p.numMaxInfluencers||p.numInfluencers,r.MORPHTARGETS=r.NUM_MORPH_INFLUENCERS>0,r.MORPHTARGETS_TEXTURE=p.isUsingTextureForTargets):(r.MORPHTARGETS_UV=!1,r.MORPHTARGETS_UV2=!1,r.MORPHTARGETS_TANGENT=!1,r.MORPHTARGETS_NORMAL=!1,r.MORPHTARGETS_POSITION=!1,r.MORPHTARGETS_COLOR=!1,r.MORPHTARGETTEXTURE_HASUVS=!1,r.MORPHTARGETTEXTURE_HASUV2S=!1,r.MORPHTARGETTEXTURE_HASTANGENTS=!1,r.MORPHTARGETTEXTURE_HASNORMALS=!1,r.MORPHTARGETTEXTURE_HASPOSITIONS=!1,r.MORPHTARGETTEXTURE_HAS_COLORS=!1,r.MORPHTARGETS=!1,r.NUM_MORPH_INFLUENCERS=0)}(L,r),j&&function(L,r){const p=L.bakedVertexAnimationManager;r.BAKED_VERTEX_ANIMATION_TEXTURE=!(!p||!p.isEnabled)}(L,r),!0}function q(L,r){if(L.activeCamera){const p=r.MULTIVIEW;r.MULTIVIEW=null!==L.activeCamera.outputRenderTarget&&L.activeCamera.outputRenderTarget.getViewCount()>1,r.MULTIVIEW!=p&&r.markAsUnprocessed()}}function Z(L,r,p){const J=r.ORDER_INDEPENDENT_TRANSPARENCY,i=r.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;r.ORDER_INDEPENDENT_TRANSPARENCY=L.useOrderIndependentTransparency&&p,r.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!L.getEngine().getCaps().textureFloatLinearFiltering,J===r.ORDER_INDEPENDENT_TRANSPARENCY&&i===r.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||r.markAsUnprocessed()}function X(L,r,p){const J=r.PREPASS;if(!r._arePrePassDirty)return;const i=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(L.prePassRenderer&&L.prePassRenderer.enabled&&p){r.PREPASS=!0,r.SCENE_MRT_COUNT=L.prePassRenderer.mrtCount,r.PREPASS_NORMAL_WORLDSPACE=L.prePassRenderer.generateNormalsInWorldSpace,r.PREPASS_COLOR=!0,r.PREPASS_COLOR_INDEX=0;for(let p=0;p<i.length;p++){const J=L.prePassRenderer.getIndex(i[p].type);-1!==J?(r[i[p].define]=!0,r[i[p].index]=J):r[i[p].define]=!1}}else{r.PREPASS=!1;for(let L=0;L<i.length;L++)r[i[L].define]=!1}r.PREPASS!=J&&(r.markAsUnprocessed(),r.markAsImageProcessingDirty())}function D(L,r,p,J){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],j=arguments.length>6&&void 0!==arguments[6]&&arguments[6];i&&i.push("Light"+L),n||(r.push("vLightData"+L,"vLightDiffuse"+L,"vLightSpecular"+L,"vLightDirection"+L,"vLightWidth"+L,"vLightHeight"+L,"vLightFalloff"+L,"vLightGround"+L,"lightMatrix"+L,"shadowsInfo"+L,"depthValues"+L),p.push("shadowTexture"+L),p.push("depthTexture"+L),r.push("viewFrustumZ"+L,"cascadeBlendFactor"+L,"lightSizeUVCorrection"+L,"depthCorrection"+L,"penumbraDarkness"+L,"frustumLengths"+L),J&&(p.push("projectionLightTexture"+L),r.push("textureProjectionMatrix"+L)),j&&p.push("iesLightTexture"+L))}function l(L,r,p){let J,i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(L.uniformsNames){const j=L;J=j.uniformsNames,i=j.uniformBuffersNames,r=j.samplers,p=j.defines,n=j.maxSimultaneousLights||0}else J=L,r||(r=[]);for(let j=0;j<n&&p["LIGHT"+j];j++)D(j,J,r,p["PROJECTEDLIGHTTEXTURE"+j],i,!1,p["IESLIGHTTEXTURE"+j]);p.NUM_MORPH_INFLUENCERS&&(J.push("morphTargetInfluences"),J.push("morphTargetCount")),p.BAKED_VERTEX_ANIMATION_TEXTURE&&(J.push("bakedVertexAnimationSettings"),J.push("bakedVertexAnimationTextureSizeInverted"),J.push("bakedVertexAnimationTime"),r.push("bakedVertexAnimationTexture"))}},12438:(L,r,p)=>{p.d(r,{c:()=>n});var J=p(12136),i=p(12446);class n extends i.d{constructor(L,r){let p=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(L,r,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new J.Matrix,this._storeEffectOnSubMeshes=p}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(L,r){return!!L&&(!this._storeEffectOnSubMeshes||(!L.ln||0===L.ln.length||this.isReadyForSubMesh(L,L.ln[0],r)))}_isReadyForSubMesh(L){const r=L.materialDefines;return!(this.checkReadyOnEveryCall||!L.effect||!r||r._renderId!==this.FL().getRenderId())}bindOnlyWorldMatrix(L){this._activeEffect.setMatrix("world",L)}bindOnlyNormalMatrix(L){this._activeEffect.setMatrix("normalMatrix",L)}bind(L,r){r&&this.bindForSubMesh(L,r,r.ln[0])}_afterBind(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,p=arguments.length>2?arguments[2]:void 0;super._afterBind(L,r,p),this.FL()._cachedEffect=r,p?p._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return p._drawWrapper._forceRebindOnNextCall||L.isCachedMaterialInvalid(this,r,J)}dispose(L,r,p){this._activeEffect=void 0,super.dispose(L,r,p)}}},12487:(L,r,p)=>{p.d(r,{e:()=>z,h:()=>G});var J=p(12113),i=p(12136),n=p(12122);class j{static extractMinAndMaxIndexed(L,r,p,J,i,n){for(let j=p;j<p+J;j++){const p=3*r[j],J=L[p],z=L[p+1],G=L[p+2];i.minimizeInPlaceFromFloats(J,z,G),n.maximizeInPlaceFromFloats(J,z,G)}}static extractMinAndMax(L,r,p,J,i,n){for(let j=r,z=r*J;j<r+p;j++,z+=J){const r=L[z],p=L[z+1],J=L[z+2];i.minimizeInPlaceFromFloats(r,p,J),n.maximizeInPlaceFromFloats(r,p,J)}}}function z(L,r,p,J){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const z=new i.cr(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),G=new i.cr(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return j.extractMinAndMaxIndexed(L,r,p,J,z,G),n&&(z.x-=z.x*n.x+n.y,z.y-=z.y*n.x+n.y,z.z-=z.z*n.x+n.y,G.x+=G.x*n.x+n.y,G.y+=G.y*n.x+n.y,G.z+=G.z*n.x+n.y),{minimum:z,maximum:G}}function G(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0;const z=new i.cr(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),G=new i.cr(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return n||(n=3),j.extractMinAndMax(L,r,p,n,z,G),J&&(z.x-=z.x*J.x+J.y,z.y-=z.y*J.x+J.y,z.z-=z.z*J.x+J.y,G.x+=G.x*J.x+J.y,G.y+=G.y*J.x+J.y,G.z+=G.z*J.x+J.y),{minimum:z,maximum:G}}(0,J.e)([n.c.filter((function(){for(var L=arguments.length,r=new Array(L),p=0;p<L;p++)r[p]=arguments[p];let[J,i]=r;return!Array.isArray(J)&&!Array.isArray(i)}))],j,"extractMinAndMaxIndexed",null),(0,J.e)([n.c.filter((function(){for(var L=arguments.length,r=new Array(L),p=0;p<L;p++)r[p]=arguments[p];let[J]=r;return!Array.isArray(J)}))],j,"extractMinAndMax",null)},12450:(L,r,p)=>{p.d(r,{c:()=>G});var J=p(12208),i=p(12459),n=p(12468),j=p(12487),z=p(12247);class G{get materialDefines(){var L;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(L=this._getDrawWrapper())||void 0===L?void 0:L.defines}set materialDefines(L){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=L}_getDrawWrapper(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];L=L??this._engine.currentRenderPassId;let p=this._drawWrappers[L];return!p&&r&&(this._drawWrappers[L]=p=new z.d(this._mesh.FL().getEngine())),p}_removeDrawWrapper(L){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var p;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(p=this._drawWrappers[L])||void 0===p||p.dispose(r));this._drawWrappers[L]=void 0}get effect(){var L;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(L=this._getDrawWrapper())||void 0===L?void 0:L.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(L){this._mainDrawWrapperOverride=L}setEffect(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,p=arguments.length>2?arguments[2]:void 0,J=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=this._drawWrapper;i.setEffect(L,r,J),void 0!==p&&(i.materialContext=p),L||(i.defines=null,i.materialContext=void 0)}resetDrawCache(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==L)return void this._removeDrawWrapper(L,!0,r);for(const L of this._drawWrappers)null===L||void 0===L||L.dispose(r)}this._drawWrappers=[]}static AddToMesh(L,r,p,J,i,n,j){return new G(L,r,p,J,i,n,j,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(L,r,p,J,i,n,j){let z=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],G=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=L,this.verticesStart=r,this.verticesCount=p,this.indexStart=J,this.indexCount=i,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=n,this._renderingMesh=j||n,G&&n.ln.push(this),this._engine=this._mesh.FL().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=n.ln.length-1,z&&(this.refreshBoundingInfo(),n.cz(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(L){return this._boundingInfo=L,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const L=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return L||this._renderingMesh}lL(){let L=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const r=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!r)return L&&this._mesh.FL()._hasDefaultMaterial?this._mesh.FL().defaultMaterial:null;if(this._isMultiMaterial(r)){const L=r.getSubMaterial(this.materialIndex);return this._currentMaterial!==L&&(this._currentMaterial=L,this.resetDrawCache()),L}return r}_isMultiMaterial(L){return void 0!==L.getSubMaterial}refreshBoundingInfo(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.Pz)return this;if(L||(L=this._renderingMesh.getVerticesData(J.e.PositionKind)),!L)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const r=this._renderingMesh.Oz();let p;if(0===this.indexStart&&this.indexCount===r.length){const L=this._renderingMesh.getBoundingInfo();p={minimum:L.minimum.clone(),maximum:L.maximum.clone()}}else p=(0,j.e)(L,r,this.indexStart,this.indexCount,this._renderingMesh.Pz.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(p.minimum,p.maximum):this._boundingInfo=new n.d(p.minimum,p.maximum),this}_checkCollision(L){return this.getBoundingInfo()._checkCollision(L)}updateBoundingInfo(L){let r=this.getBoundingInfo();return r||(this.refreshBoundingInfo(),r=this.getBoundingInfo()),r&&r.update(L),this}isInFrustum(L){const r=this.getBoundingInfo();return!!r&&r.isInFrustum(L,this._mesh.cE)}isCompletelyInFrustum(L){const r=this.getBoundingInfo();return!!r&&r.isCompletelyInFrustum(L)}render(L){return this._renderingMesh.render(this,L,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(L,r){if(!this._linesIndexBuffer){const p=6*Math.floor(this.indexCount/3),J=this.verticesStart+this.verticesCount>65535?new Uint32Array(p):new Uint16Array(p);let i=0;if(0===L.length)for(let L=this.indexStart;L<this.indexStart+this.indexCount;L+=3)J[i++]=L,J[i++]=L+1,J[i++]=L+1,J[i++]=L+2,J[i++]=L+2,J[i++]=L;else for(let r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)J[i++]=L[r],J[i++]=L[r+1],J[i++]=L[r+1],J[i++]=L[r+2],J[i++]=L[r+2],J[i++]=L[r];this._linesIndexBuffer=r.createIndexBuffer(J),this._linesIndexCount=J.length}return this._linesIndexBuffer}canIntersects(L){const r=this.getBoundingInfo();return!!r&&L.intersectsBox(r.boundingBox)}intersects(L,r,p,J,i){const n=this.lL();if(!n)return null;let j=3,z=!1;switch(n.fillMode){case 3:case 5:case 6:case 8:return null;case 7:j=1,z=!0}return 4===n.fillMode?p.length?this._intersectLines(L,r,p,this._mesh.intersectionThreshold,J):this._intersectUnIndexedLines(L,r,p,this._mesh.intersectionThreshold,J):!p.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(L,r,p,J,i):this._intersectTriangles(L,r,p,j,z,J,i)}_intersectLines(L,r,p,J,n){let j=null;for(let z=this.indexStart;z<this.indexStart+this.indexCount;z+=2){const G=r[p[z]],C=r[p[z+1]],t=L.intersectionSegment(G,C,J);if(!(t<0)&&((n||!j||t<j.distance)&&(j=new i.b(null,null,t),j.faceId=z/2,n)))break}return j}_intersectUnIndexedLines(L,r,p,J,n){let j=null;for(let z=this.verticesStart;z<this.verticesStart+this.verticesCount;z+=2){const p=r[z],G=r[z+1],C=L.intersectionSegment(p,G,J);if(!(C<0)&&((n||!j||C<j.distance)&&(j=new i.b(null,null,C),j.faceId=z/2,n)))break}return j}_intersectTriangles(L,r,p,J,i,n,j){let z=null,G=-1;for(let C=this.indexStart;C<this.indexStart+this.indexCount-(3-J);C+=J){G++;const J=p[C],t=p[C+1],E=p[C+2];if(i&&4294967295===E){C+=2;continue}const x=r[J],w=r[t],g=r[E];if(!x||!w||!g)continue;if(j&&!j(x,w,g,L,J,t,E))continue;const b=L.intersectsTriangle(x,w,g);if(b){if(b.distance<0)continue;if((n||!z||b.distance<z.distance)&&(z=b,z.faceId=G,n))break}}return z}_intersectUnIndexedTriangles(L,r,p,J,i){let n=null;for(let j=this.verticesStart;j<this.verticesStart+this.verticesCount;j+=3){const p=r[j],z=r[j+1],G=r[j+2];if(i&&!i(p,z,G,L,-1,-1,-1))continue;const C=L.intersectsTriangle(p,z,G);if(C){if(C.distance<0)continue;if((J||!n||C.distance<n.distance)&&(n=C,n.faceId=j/3,J))break}}return n}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(L,r){const p=new G(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,L,r,!1);if(!this.IsGlobal){const L=this.getBoundingInfo();if(!L)return p;p._boundingInfo=new n.d(L.minimum,L.maximum)}return p}dispose(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.FL().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const r=this._mesh.ln.indexOf(this);this._mesh.ln.splice(r,1),this.resetDrawCache(void 0,L)}getClassName(){return"SubMesh"}static CreateFromIndices(L,r,p,J,i){let n=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],j=Number.MAX_VALUE,z=-Number.MAX_VALUE;const C=(i||J).Oz();for(let G=r;G<r+p;G++){const L=C[G];L<j&&(j=L),L>z&&(z=L)}return new G(L,j,z-j+1,r,p,J,i,n)}}}}]);