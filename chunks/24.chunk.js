"use strict";(self.jr1pmf6bwuf=self.jr1pmf6bwuf||[]).push([[24],{13208:(Y,c,h)=>{h.d(c,{d:()=>C});class C{constructor(Y,c,h){this.bu=Y,this.bv=c,this.distance=h,this.faceId=0,this.subMeshId=0}}},13219:(Y,c,h)=>{h.d(c,{b:()=>Q});var C=h(12877),E=h(12869),N=h(12874);class Q{constructor(Y,c,h){this.vectors=(0,C.b)(8,E.bh.Zero),this.center=E.bh.Zero(),this.centerWorld=E.bh.Zero(),this.extendSize=E.bh.Zero(),this.extendSizeWorld=E.bh.Zero(),this.directions=(0,C.b)(3,E.bh.Zero),this.vectorsWorld=(0,C.b)(8,E.bh.Zero),this.minimumWorld=E.bh.Zero(),this.maximumWorld=E.bh.Zero(),this.minimum=E.bh.Zero(),this.maximum=E.bh.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(Y,c,h)}reConstruct(Y,c,h){const C=Y.x,N=Y.y,Q=Y.z,b=c.x,H=c.y,w=c.z,W=this.vectors;this.minimum.Vc(C,N,Q),this.maximum.Vc(b,H,w),W[0].Vc(C,N,Q),W[1].Vc(b,H,w),W[2].Vc(b,N,Q),W[3].Vc(C,H,Q),W[4].Vc(C,N,w),W[5].Vc(b,H,Q),W[6].Vc(C,H,w),W[7].Vc(b,N,w),c.addToRef(Y,this.center).scaleInPlace(.5),c.subtractToRef(Y,this.extendSize).scaleInPlace(.5),this._worldMatrix=h||E.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(Y){const c=Q._TmpVector3,h=this.maximum.subtractToRef(this.minimum,c[0]),C=h.length();h.normalizeFromLength(C);const E=C*Y,N=h.scaleInPlace(.5*E),b=this.center.subtractToRef(N,c[1]),H=this.center.addToRef(N,c[2]);return this.reConstruct(b,H,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(Y){const c=this.minimumWorld,h=this.maximumWorld,C=this.directions,N=this.vectorsWorld,Q=this.vectors;if(Y.isIdentity()){c.N(this.minimum),h.N(this.maximum);for(let Y=0;Y<8;++Y)N[Y].N(Q[Y]);this.extendSizeWorld.N(this.extendSize),this.centerWorld.N(this.center)}else{c.nc(Number.MAX_VALUE),h.nc(-Number.MAX_VALUE);for(let C=0;C<8;++C){const b=N[C];E.bh.TransformCoordinatesToRef(Q[C],Y,b),c.minimizeInPlace(b),h.maximizeInPlace(b)}h.subtractToRef(c,this.extendSizeWorld).scaleInPlace(.5),h.addToRef(c,this.centerWorld).scaleInPlace(.5)}E.bh.FromArrayToRef(Y.m,0,C[0]),E.bh.FromArrayToRef(Y.m,4,C[1]),E.bh.FromArrayToRef(Y.m,8,C[2]),this._worldMatrix=Y}isInFrustum(Y){return Q.IsInFrustum(this.vectorsWorld,Y)}isCompletelyInFrustum(Y){return Q.IsCompletelyInFrustum(this.vectorsWorld,Y)}intersectsPoint(Y){const c=this.minimumWorld,h=this.maximumWorld,C=c.x,E=c.y,Q=c.z,b=h.x,H=h.y,w=h.z,W=Y.x,q=Y.y,k=Y.z,M=-N.d;return!(b-W<M||M>W-C)&&(!(H-q<M||M>q-E)&&!(w-k<M||M>k-Q))}intersectsSphere(Y){return Q.IntersectsSphere(this.minimumWorld,this.maximumWorld,Y.centerWorld,Y.radiusWorld)}intersectsMinMax(Y,c){const h=this.minimumWorld,C=this.maximumWorld,E=h.x,N=h.y,Q=h.z,b=C.x,H=C.y,w=C.z,W=Y.x,q=Y.y,k=Y.z,M=c.x,p=c.y,P=c.z;return!(b<W||E>M)&&(!(H<q||N>p)&&!(w<k||Q>P))}dispose(){var Y,c;null===(Y=this._drawWrapperFront)||void 0===Y||Y.dispose(),null===(c=this._drawWrapperBack)||void 0===c||c.dispose()}static Intersects(Y,c){return Y.intersectsMinMax(c.minimumWorld,c.maximumWorld)}static IntersectsSphere(Y,c,h,C){const N=Q._TmpVector3[0];E.bh.ClampToRef(h,Y,c,N);return E.bh.DistanceSquared(h,N)<=C*C}static IsCompletelyInFrustum(Y,c){for(let h=0;h<6;++h){const C=c[h];for(let c=0;c<8;++c)if(C.dotCoordinate(Y[c])<0)return!1}return!0}static IsInFrustum(Y,c){for(let h=0;h<6;++h){let C=!0;const E=c[h];for(let c=0;c<8;++c)if(E.dotCoordinate(Y[c])>=0){C=!1;break}if(C)return!1}return!0}}Q._TmpVector3=(0,C.b)(3,E.bh.Zero)},13212:(Y,c,h)=>{h.d(c,{d:()=>q});var C=h(12877),E=h(12869),N=h(13219),Q=h(13226);const b={min:0,max:0},H={min:0,max:0},w=(Y,c,h)=>{const C=E.bh.Dot(c.centerWorld,Y),N=Math.abs(E.bh.Dot(c.directions[0],Y))*c.extendSize.x+Math.abs(E.bh.Dot(c.directions[1],Y))*c.extendSize.y+Math.abs(E.bh.Dot(c.directions[2],Y))*c.extendSize.z;h.min=C-N,h.max=C+N},W=(Y,c,h)=>(w(Y,c,b),w(Y,h,H),!(b.min>H.max||H.min>b.max));class q{constructor(Y,c,h){this._isLocked=!1,this.boundingBox=new N.b(Y,c,h),this.boundingSphere=new Q.e(Y,c,h)}reConstruct(Y,c,h){this.boundingBox.reConstruct(Y,c,h),this.boundingSphere.reConstruct(Y,c,h)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(Y){this._isLocked=Y}update(Y){this._isLocked||(this.boundingBox._update(Y),this.boundingSphere._update(Y))}centerOn(Y,c){const h=q._TmpVector3[0].N(Y).Lk(c),C=q._TmpVector3[1].N(Y).addInPlace(c);return this.boundingBox.reConstruct(h,C,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(h,C,this.boundingBox.getWorldMatrix()),this}encapsulate(Y){const c=E.bh.Minimize(this.minimum,Y),h=E.bh.Maximize(this.maximum,Y);return this.reConstruct(c,h,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(Y){const c=E.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(c);const h=E.TmpVectors.bh[0];return E.bh.TransformCoordinatesToRef(Y.boundingBox.minimumWorld,c,h),this.encapsulate(h),E.bh.TransformCoordinatesToRef(Y.boundingBox.maximumWorld,c,h),this.encapsulate(h),this}scale(Y){return this.boundingBox.scale(Y),this.boundingSphere.scale(Y),this}isInFrustum(Y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===c||3===c)&&this.boundingSphere.isCenterInFrustum(Y))return!0;if(!this.boundingSphere.isInFrustum(Y))return!1;return!(1!==c&&3!==c)||this.boundingBox.isInFrustum(Y)}get diagonalLength(){const Y=this.boundingBox;return Y.maximumWorld.subtractToRef(Y.minimumWorld,q._TmpVector3[0]).length()}isCompletelyInFrustum(Y){return this.boundingBox.isCompletelyInFrustum(Y)}_checkCollision(Y){return Y._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(Y){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(Y)&&!!this.boundingBox.intersectsPoint(Y))}intersects(Y,c){if(!Q.e.Intersects(this.boundingSphere,Y.boundingSphere))return!1;if(!N.b.Intersects(this.boundingBox,Y.boundingBox))return!1;if(!c)return!0;const h=this.boundingBox,C=Y.boundingBox;return!!W(h.directions[0],h,C)&&(!!W(h.directions[1],h,C)&&(!!W(h.directions[2],h,C)&&(!!W(C.directions[0],h,C)&&(!!W(C.directions[1],h,C)&&(!!W(C.directions[2],h,C)&&(!!W(E.bh.Cross(h.directions[0],C.directions[0]),h,C)&&(!!W(E.bh.Cross(h.directions[0],C.directions[1]),h,C)&&(!!W(E.bh.Cross(h.directions[0],C.directions[2]),h,C)&&(!!W(E.bh.Cross(h.directions[1],C.directions[0]),h,C)&&(!!W(E.bh.Cross(h.directions[1],C.directions[1]),h,C)&&(!!W(E.bh.Cross(h.directions[1],C.directions[2]),h,C)&&(!!W(E.bh.Cross(h.directions[2],C.directions[0]),h,C)&&(!!W(E.bh.Cross(h.directions[2],C.directions[1]),h,C)&&!!W(E.bh.Cross(h.directions[2],C.directions[2]),h,C))))))))))))))}}q._TmpVector3=(0,C.b)(2,E.bh.Zero)},13226:(Y,c,h)=>{h.d(c,{e:()=>N});var C=h(12877),E=h(12869);class N{constructor(Y,c,h){this.center=E.bh.Zero(),this.centerWorld=E.bh.Zero(),this.minimum=E.bh.Zero(),this.maximum=E.bh.Zero(),this.reConstruct(Y,c,h)}reConstruct(Y,c,h){this.minimum.N(Y),this.maximum.N(c);const C=E.bh.Distance(Y,c);c.addToRef(Y,this.center).scaleInPlace(.5),this.radius=.5*C,this._update(h||E.Matrix.IdentityReadOnly)}scale(Y){const c=this.radius*Y,h=N._TmpVector3,C=h[0].nc(c),E=this.center.subtractToRef(C,h[1]),Q=this.center.addToRef(C,h[2]);return this.reConstruct(E,Q,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(Y){if(Y.isIdentity())this.centerWorld.N(this.center),this.radiusWorld=this.radius;else{E.bh.TransformCoordinatesToRef(this.center,Y,this.centerWorld);const c=N._TmpVector3[0];E.bh.TransformNormalFromFloatsToRef(1,1,1,Y,c),this.radiusWorld=Math.max(Math.abs(c.x),Math.abs(c.y),Math.abs(c.z))*this.radius}}isInFrustum(Y){const c=this.centerWorld,h=this.radiusWorld;for(let C=0;C<6;C++)if(Y[C].dotCoordinate(c)<=-h)return!1;return!0}isCenterInFrustum(Y){const c=this.centerWorld;for(let h=0;h<6;h++)if(Y[h].dotCoordinate(c)<0)return!1;return!0}intersectsPoint(Y){const c=E.bh.DistanceSquared(this.centerWorld,Y);return!(this.radiusWorld*this.radiusWorld<c)}static Intersects(Y,c){const h=E.bh.DistanceSquared(Y.centerWorld,c.centerWorld),C=Y.radiusWorld+c.radiusWorld;return!(C*C<h)}static CreateFromCenterAndRadius(Y,c,h){this._TmpVector3[0].N(Y),this._TmpVector3[1].Vc(0,0,c),this._TmpVector3[2].N(Y),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].Lk(this._TmpVector3[1]);const C=new N(this._TmpVector3[0],this._TmpVector3[2]);return C._worldMatrix=h||E.Matrix.Identity(),C}}N._TmpVector3=(0,C.b)(3,E.bh.Zero)},13245:(Y,c,h)=>{function C(Y){-1===Y.indexOf("vClipPlane")&&Y.push("vClipPlane"),-1===Y.indexOf("vClipPlane2")&&Y.push("vClipPlane2"),-1===Y.indexOf("vClipPlane3")&&Y.push("vClipPlane3"),-1===Y.indexOf("vClipPlane4")&&Y.push("vClipPlane4"),-1===Y.indexOf("vClipPlane5")&&Y.push("vClipPlane5"),-1===Y.indexOf("vClipPlane6")&&Y.push("vClipPlane6")}function E(Y,c,h){const C=!!(Y.clipPlane??c.clipPlane),E=!!(Y.clipPlane2??c.clipPlane2),N=!!(Y.clipPlane3??c.clipPlane3),Q=!!(Y.clipPlane4??c.clipPlane4),b=!!(Y.clipPlane5??c.clipPlane5),H=!!(Y.clipPlane6??c.clipPlane6);C&&h.push("#define CLIPPLANE"),E&&h.push("#define CLIPPLANE2"),N&&h.push("#define CLIPPLANE3"),Q&&h.push("#define CLIPPLANE4"),b&&h.push("#define CLIPPLANE5"),H&&h.push("#define CLIPPLANE6")}function N(Y,c,h){let C=!1;const E=!!(Y.clipPlane??c.clipPlane),N=!!(Y.clipPlane2??c.clipPlane2),Q=!!(Y.clipPlane3??c.clipPlane3),b=!!(Y.clipPlane4??c.clipPlane4),H=!!(Y.clipPlane5??c.clipPlane5),w=!!(Y.clipPlane6??c.clipPlane6);return h.CLIPPLANE!==E&&(h.CLIPPLANE=E,C=!0),h.CLIPPLANE2!==N&&(h.CLIPPLANE2=N,C=!0),h.CLIPPLANE3!==Q&&(h.CLIPPLANE3=Q,C=!0),h.CLIPPLANE4!==b&&(h.CLIPPLANE4=b,C=!0),h.CLIPPLANE5!==H&&(h.CLIPPLANE5=H,C=!0),h.CLIPPLANE6!==w&&(h.CLIPPLANE6=w,C=!0),C}function Q(Y,c,h){let C=c.clipPlane??h.clipPlane;b(Y,"vClipPlane",C),C=c.clipPlane2??h.clipPlane2,b(Y,"vClipPlane2",C),C=c.clipPlane3??h.clipPlane3,b(Y,"vClipPlane3",C),C=c.clipPlane4??h.clipPlane4,b(Y,"vClipPlane4",C),C=c.clipPlane5??h.clipPlane5,b(Y,"vClipPlane5",C),C=c.clipPlane6??h.clipPlane6,b(Y,"vClipPlane6",C)}function b(Y,c,h){h&&Y.setFloat4(c,h.normal.x,h.normal.y,h.normal.z,h.d)}h.d(c,{b:()=>C,c:()=>Q,e:()=>N,g:()=>E})},13182:(Y,c,h)=>{h.d(c,{c:()=>C});class C{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(Y,c){this._defines[Y]||(Y<this._currentRank&&(this._currentRank=Y),Y>this._maxRank&&(this._maxRank=Y),this._defines[Y]=new Array),this._defines[Y].push(c)}addCPUSkinningFallback(Y,c){this._mesh=c,Y<this._currentRank&&(this._currentRank=Y),Y>this._maxRank&&(this._maxRank=Y)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(Y,c){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,Y=Y.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),c._bonesComputationForcedToCPU=!0;const h=this._mesh.ZY();for(let Y=0;Y<h.meshes.length;Y++){const C=h.meshes[Y];if(C.material){if(C.computeBonesUsingShaders&&0!==C.numBoneInfluencers)if(C.material.getEffect()===c)C.computeBonesUsingShaders=!1;else if(C.rc)for(const Y of C.rc){if(Y.effect===c){C.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&C.computeBonesUsingShaders&&C.numBoneInfluencers>0&&(C.computeBonesUsingShaders=!1)}}else{const c=this._defines[this._currentRank];if(c)for(let h=0;h<c.length;h++)Y=Y.replace("#define "+c[h],"");this._currentRank++}return Y}}},13193:(Y,c,h)=>{h.d(c,{d:()=>y});var C=h(12853),E=h(12859),N=h(12687),Q=h(12690),b=h(12722),H=h(13199),w=h(13126),W=h(12700),q=h(12926),k=h(12999),M=h(12906);class p{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(Y){this._func=Y}get funcRef(){return this._funcRef}set funcRef(Y){this._funcRef=Y}get funcMask(){return this._funcMask}set funcMask(Y){this._funcMask=Y}get opStencilFail(){return this._opStencilFail}set opStencilFail(Y){this._opStencilFail=Y}get opDepthFail(){return this._opDepthFail}set opDepthFail(Y){this._opDepthFail=Y}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(Y){this._opStencilDepthPass=Y}get mask(){return this._mask}set mask(Y){this._mask=Y}get enabled(){return this._enabled}set enabled(Y){this._enabled=Y}getClassName(){return"MaterialStencilState"}copyTo(Y){M.d.Clone((()=>Y),this)}serialize(){return M.d.Serialize(this)}parse(Y,c,h){M.d.Parse((()=>this),Y,c,h)}}(0,C.b)([(0,E.N)()],p.prototype,"func",null),(0,C.b)([(0,E.N)()],p.prototype,"funcRef",null),(0,C.b)([(0,E.N)()],p.prototype,"funcMask",null),(0,C.b)([(0,E.N)()],p.prototype,"opStencilFail",null),(0,C.b)([(0,E.N)()],p.prototype,"opDepthFail",null),(0,C.b)([(0,E.N)()],p.prototype,"opStencilDepthPass",null),(0,C.b)([(0,E.N)()],p.prototype,"mask",null),(0,C.b)([(0,E.N)()],p.prototype,"enabled",null);var P=h(13240);class y{get _supportGlowLayer(){return!1}set _glowModeEnabled(Y){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(Y){if(this._alpha===Y)return;const c=this._alpha;this._alpha=Y,1!==c&&1!==Y||this.xq(y.MiscDirtyFlag+y.PrePassDirtyFlag)}get alpha(){return this._alpha}set Ac(Y){this._backFaceCulling!==Y&&(this._backFaceCulling=Y,this.xq(y.TextureDirtyFlag))}get Ac(){return this._backFaceCulling}set cullBackFaces(Y){this._cullBackFaces!==Y&&(this._cullBackFaces=Y,this.xq(y.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(Y){this._blockDirtyMechanism!==Y&&(this._blockDirtyMechanism=Y,Y||this.xM())}atomicMaterialsUpdate(Y){this.blockDirtyMechanism=!0;try{Y(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(Y){this._onDisposeObserver&&this.Mc.remove(this._onDisposeObserver),this._onDisposeObserver=this.Mc.add(Y)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new Q.c),this._onBindObservable}set onBind(Y){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(Y)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new Q.c),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new Q.c),this._onEffectCreatedObservable}set alphaMode(Y){this._alphaMode!==Y&&(this._alphaMode=Y,this.xq(y.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(Y){this._needDepthPrePass!==Y&&(this._needDepthPrePass=Y,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(Y){this._fogEnabled!==Y&&(this._fogEnabled=Y,this.xq(y.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case y.WireFrameFillMode:case y.LineListDrawMode:case y.LineLoopDrawMode:case y.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(Y){this.fillMode=Y?y.WireFrameFillMode:y.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case y.PointFillMode:case y.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(Y){this.fillMode=Y?y.PointFillMode:y.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(Y){this._fillMode!==Y&&(this._fillMode=Y,this.xq(y.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(Y){const c=this.ZY().getEngine().getCaps().fragmentDepthSupported;Y&&!c&&W.e.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=Y&&c,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(Y){this._drawWrapper=Y}constructor(Y,c,h){let C=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.Mc=new Q.c,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.Pc=new p,this._useUBO=!1,this._fillMode=y.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=Y;const E=c||b.d.LastCreatedScene;E&&(this._scene=E,this._dirtyCallbacks={},this._forceGLSL=C,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=Y||N.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new k.e(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new w.d(this._scene.getEngine(),void 0,void 0,Y),this._useUBO=this.ZY().getEngine().supportsUniformBuffers,this._createUniformBuffer(),h||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),y.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var Y;const c=this.ZY().getEngine();null===(Y=this._uniformBuffer)||void 0===Y||Y.dispose(),c.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new w.d(c,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new w.d(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(Y){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.xM(),this.checkReadyOnlyOnce=!0}unfreeze(){this.xM(),this.checkReadyOnlyOnce=!1}isReady(Y,c){return!0}isReadyForSubMesh(Y,c,h){const C=c.materialDefines;return!!C&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=C,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}ZY(){return this._scene}_getEffectiveOrientation(Y){return null!==this.sideOrientation?this.sideOrientation:Y.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(Y){this._transparencyMode!==Y&&(this._transparencyMode=Y,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===y.MATERIAL_ALPHABLEND||this._transparencyMode===y.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===y.MATERIAL_ALPHATEST||this._transparencyMode===y.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===y.MATERIAL_OPAQUE||this._transparencyMode===y.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(Y){return this._hasTransparencyMode?this._transparencyModeIsBlend:Y.visibility<1||!this._disableAlphaBlending&&(Y.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(Y){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(Y)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}xM(){let Y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const c=this.ZY().meshes;for(const h of c)if(h.rc)for(const c of h.rc)if(c.vY()===this)for(const h of c._drawWrappers)h&&this._materialContext===h.materialContext&&(h._wasPreviouslyReady=!1,h._wasPreviouslyUsingInstances=null,h._forceRebindOnNextCall=Y);Y&&this.xq(y.AllDirtyFlag)}_preBind(Y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const h=this._scene.getEngine(),C=(null==c?this.sideOrientation:c)===y.ClockWiseSideOrientation;return h.enableEffect(Y||this._getDrawWrapper()),h.setState(this.Ac,this.zOffset,!1,C,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.Pc,this.zOffsetUnits),C}bind(Y,c){}buildUniformLayout(){const Y=this._uniformBuffer;this._eventInfo.ubo=Y,this._callbackPluginEventGeneric(8,this._eventInfo),Y.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(Y,c,h){const C=h._drawWrapper;this._eventInfo.subMesh=h,this._callbackPluginEventBindForSubMesh(this._eventInfo),C._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(Y){}bindView(Y){this._useUBO?this._needToBindSceneUbo=!0:Y.setMatrix("view",this.ZY().getViewMatrix())}bindViewProjection(Y){this._useUBO?this._needToBindSceneUbo=!0:(Y.setMatrix("viewProjection",this.ZY().getTransformMatrix()),Y.setMatrix("projection",this.ZY().getProjectionMatrix()))}bindEyePosition(Y,c){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(Y,c)}_afterBind(Y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&c&&(this._needToBindSceneUbo=!1,(0,P.t)(c,this.ZY().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=Y?Y.visibility:1,this._onBindObservable&&Y&&this._onBindObservable.notifyObservers(Y),this.disableDepthWrite){const Y=this._scene.getEngine();this._cachedDepthWriteState=Y.getDepthWrite(),Y.setDepthWrite(!1)}if(this.disableColorWrite){const Y=this._scene.getEngine();this._cachedColorWriteState=Y.getColorWrite(),Y.setColorWrite(!1)}if(0!==this.depthFunction){const Y=this._scene.getEngine();this._cachedDepthFunctionState=Y.getDepthFunction()||0,Y.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(Y){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=Y,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(Y){return null}_clonePlugins(Y,c){const h={};if(this._serializePlugins(h),y._ParsePlugins(h,Y,this._scene,c),this.pluginManager)for(const C of this.pluginManager._plugins){const c=Y.pluginManager.getPlugin(C.name);c&&C.copyTo(c)}}getBindedMeshes(){if(this.meshMap){const Y=[];for(const c in this.meshMap){const h=this.meshMap[c];h&&Y.push(h)}return Y}return this._scene.meshes.filter((Y=>Y.material===this))}forceCompilation(Y,c,h,C){const E={clipPlane:!1,useInstances:!1,...h},N=this.ZY(),Q=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const b=()=>{if(!this._scene||!this._scene.getEngine())return;const h=N.clipPlane;if(E.clipPlane&&(N.clipPlane=new q.c(0,0,0,1)),this._storeEffectOnSubMeshes){let h=!0,N=null;if(Y.rc){const c=new H.c(0,0,0,0,0,Y,void 0,!1,!1);c.materialDefines&&(c.materialDefines._renderId=-1),this.isReadyForSubMesh(Y,c,E.useInstances)||(c.effect&&c.effect.getCompilationError()&&c.effect.allFallbacksProcessed()?N=c.effect.getCompilationError():(h=!1,setTimeout(b,16)))}h&&(this.allowShaderHotSwapping=Q,N&&C&&C(N),c&&c(this))}else this.isReady()?(this.allowShaderHotSwapping=Q,c&&c(this)):setTimeout(b,16);E.clipPlane&&(N.clipPlane=h)};b()}async forceCompilationAsync(Y,c){return await new Promise(((h,C)=>{this.forceCompilation(Y,(()=>{h()}),c,(Y=>{C(Y)}))}))}xq(Y){this.ZY().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(y._DirtyCallbackArray.length=0,Y&y.ImageProcessingDirtyFlag&&y._DirtyCallbackArray.push(y._ImageProcessingDirtyCallBack),Y&y.TextureDirtyFlag&&y._DirtyCallbackArray.push(y._TextureDirtyCallBack),Y&y.LightDirtyFlag&&y._DirtyCallbackArray.push(y._LightsDirtyCallBack),Y&y.FresnelDirtyFlag&&y._DirtyCallbackArray.push(y._FresnelDirtyCallBack),Y&y.AttributesDirtyFlag&&y._DirtyCallbackArray.push(y._AttributeDirtyCallBack),Y&y.MiscDirtyFlag&&y._DirtyCallbackArray.push(y._MiscDirtyCallBack),Y&y.PrePassDirtyFlag&&y._DirtyCallbackArray.push(y._PrePassDirtyCallBack),y._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(y._RunDirtyCallBacks),this.ZY().resetCachedMaterial())}resetDrawCache(){const Y=this.ZY().meshes;for(const c of Y)if(c.rc)for(const Y of c.rc)Y.vY()===this&&Y.resetDrawCache()}_markAllSubMeshesAsDirty(Y){const c=this.ZY();if(c.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const h=c.meshes;for(const C of h)if(C.rc)for(const h of C.rc){if((h.vY()||(c._hasDefaultMaterial?c.defaultMaterial:null))===this)for(const c of h._drawWrappers)c&&c.defines&&c.defines.markAllAsDirty&&this._materialContext===c.materialContext&&Y(c.defines)}}_markScenePrePassDirty(){if(this.ZY().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const Y=this.ZY().enablePrePassRenderer();Y&&Y.xq()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(y._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(y._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(y._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(y._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(y._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(y._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(y._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(y._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(y._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(y._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const Y=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.Mc.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(Y)}))}}setPrePassRenderer(Y){return!1}dispose(Y,c,h){const C=this.ZY();if(C.stopAnimation(this),C.freeProcessedMaterials(),C.removeMaterial(this),this._eventInfo.forceDisposeTextures=c,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const Y=this._parentContainer.materials.indexOf(this);Y>-1&&this._parentContainer.materials.splice(Y,1),this._parentContainer=null}if(!0!==h)if(this.meshMap)for(const E in this.meshMap){const Y=this.meshMap[E];this._disposeMeshResources(Y)}else{const Y=C.meshes;for(const c of Y)this._disposeMeshResources(c)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.Mc.notifyObservers(this),this.Mc.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(Y){if(!Y)return;const c=Y.Ic,h=Y._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(Y.rc&&h)for(const E of Y.rc){const Y=E._drawWrappers;for(let N=0;N<Y.length;N++){var C;const Q=null===(C=Y[N])||void 0===C?void 0:C.effect;if(!Q)continue;h[N]===this&&(null===c||void 0===c||c._releaseVertexArrayObject(Q),E._removeDrawWrapper(N,!0,!0))}}}else null===c||void 0===c||c._releaseVertexArrayObject(this._drawWrapper.effect);Y.material!==this||Y.sourceMesh||(Y.material=null)}serialize(){const Y=M.d.Serialize(this);return Y.Pc=this.Pc.serialize(),Y.uniqueId=this.uniqueId,this._serializePlugins(Y),Y}_serializePlugins(Y){if(Y.plugins={},this.pluginManager)for(const c of this.pluginManager._plugins)c.doNotSerialize||(Y.plugins[c.getClassName()]=c.serialize())}static Parse(Y,c,h){if(Y.customType){if("BABYLON.PBRMaterial"===Y.customType&&Y.overloadedAlbedo&&(Y.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return W.e.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else Y.customType="BABYLON.StandardMaterial";const C=N.Tools.Instantiate(Y.customType).Parse(Y,c,h);return C._loadedUniqueId=Y.uniqueId,C}static _ParsePlugins(Y,c,h,C){if(Y.plugins)for(const b in Y.plugins){var E,Q;const H=Y.plugins[b];let w=null===(E=c.pluginManager)||void 0===E?void 0:E.getPlugin(H.name);if(!w){const Y=N.Tools.Instantiate("BABYLON."+b);Y&&(w=new Y(c))}null===(Q=w)||void 0===Q||Q.parse(H,h,C)}}}y.TriangleFillMode=0,y.WireFrameFillMode=1,y.PointFillMode=2,y.PointListDrawMode=3,y.LineListDrawMode=4,y.LineLoopDrawMode=5,y.LineStripDrawMode=6,y.TriangleStripDrawMode=7,y.TriangleFanDrawMode=8,y.ClockWiseSideOrientation=0,y.CounterClockWiseSideOrientation=1,y.ImageProcessingDirtyFlag=64,y.TextureDirtyFlag=1,y.LightDirtyFlag=2,y.FresnelDirtyFlag=4,y.AttributesDirtyFlag=8,y.MiscDirtyFlag=16,y.PrePassDirtyFlag=32,y.AllDirtyFlag=127,y.MATERIAL_OPAQUE=0,y.MATERIAL_ALPHATEST=1,y.MATERIAL_ALPHABLEND=2,y.MATERIAL_ALPHATESTANDBLEND=3,y.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,y.MATERIAL_NORMALBLENDMETHOD_RNM=1,y.OnEventObservable=new Q.c,y._AllDirtyCallBack=Y=>Y.markAllAsDirty(),y._ImageProcessingDirtyCallBack=Y=>Y.markAsImageProcessingDirty(),y._TextureDirtyCallBack=Y=>Y.markAsTexturesDirty(),y._FresnelDirtyCallBack=Y=>Y.markAsFresnelDirty(),y._MiscDirtyCallBack=Y=>Y.markAsMiscDirty(),y._PrePassDirtyCallBack=Y=>Y.markAsPrePassDirty(),y._LightsDirtyCallBack=Y=>Y.markAsLightDirty(),y._AttributeDirtyCallBack=Y=>Y.markAsAttributesDirty(),y._FresnelAndMiscDirtyCallBack=Y=>{y._FresnelDirtyCallBack(Y),y._MiscDirtyCallBack(Y)},y._TextureAndMiscDirtyCallBack=Y=>{y._TextureDirtyCallBack(Y),y._MiscDirtyCallBack(Y)},y._DirtyCallbackArray=[],y._RunDirtyCallBacks=Y=>{for(const c of y._DirtyCallbackArray)c(Y)},(0,C.b)([(0,E.N)()],y.prototype,"id",void 0),(0,C.b)([(0,E.N)()],y.prototype,"uniqueId",void 0),(0,C.b)([(0,E.N)()],y.prototype,"name",void 0),(0,C.b)([(0,E.N)()],y.prototype,"metadata",void 0),(0,C.b)([(0,E.N)()],y.prototype,"checkReadyOnEveryCall",void 0),(0,C.b)([(0,E.N)()],y.prototype,"checkReadyOnlyOnce",void 0),(0,C.b)([(0,E.N)()],y.prototype,"state",void 0),(0,C.b)([(0,E.N)("alpha")],y.prototype,"_alpha",void 0),(0,C.b)([(0,E.N)("Ac")],y.prototype,"_backFaceCulling",void 0),(0,C.b)([(0,E.N)("cullBackFaces")],y.prototype,"_cullBackFaces",void 0),(0,C.b)([(0,E.N)()],y.prototype,"sideOrientation",void 0),(0,C.b)([(0,E.N)("alphaMode")],y.prototype,"_alphaMode",void 0),(0,C.b)([(0,E.N)()],y.prototype,"_needDepthPrePass",void 0),(0,C.b)([(0,E.N)()],y.prototype,"disableDepthWrite",void 0),(0,C.b)([(0,E.N)()],y.prototype,"disableColorWrite",void 0),(0,C.b)([(0,E.N)()],y.prototype,"forceDepthWrite",void 0),(0,C.b)([(0,E.N)()],y.prototype,"depthFunction",void 0),(0,C.b)([(0,E.N)()],y.prototype,"separateCullingPass",void 0),(0,C.b)([(0,E.N)("fogEnabled")],y.prototype,"_fogEnabled",void 0),(0,C.b)([(0,E.N)()],y.prototype,"pointSize",void 0),(0,C.b)([(0,E.N)()],y.prototype,"zOffset",void 0),(0,C.b)([(0,E.N)()],y.prototype,"zOffsetUnits",void 0),(0,C.b)([(0,E.N)()],y.prototype,"pointsCloud",null),(0,C.b)([(0,E.N)()],y.prototype,"fillMode",null),(0,C.b)([(0,E.N)()],y.prototype,"useLogarithmicDepth",null),(0,C.b)([(0,E.N)()],y.prototype,"transparencyMode",null)},13240:(Y,c,h)=>{h.d(c,{$:()=>K,A:()=>G,B:()=>T,F:()=>Z,G:()=>a,J:()=>M,N:()=>k,Q:()=>A,R:()=>x,U:()=>I,Y:()=>d,cb:()=>V,e:()=>e,f:()=>q,fb:()=>U,hb:()=>l,j:()=>X,lb:()=>v,n:()=>W,nb:()=>p,q:()=>P,t:()=>y,w:()=>D});var C=h(12700),E=h(12920),N=h(12722),Q=h(13179),b=h(13245);const H=E.ph.Black(),w={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function W(Y,c,h){if(!Y||Y.LOGARITHMICDEPTH||Y.indexOf&&Y.indexOf("LOGARITHMICDEPTH")>=0){const Y=h.activeCamera;1===Y.mode&&C.e.Error("Logarithmic depth is not compatible with orthographic cameras!",20),c.setFloat("logarithmicDepthConstant",2/(Math.log(Y.maxZ+1)/Math.LN2))}}function q(Y,c,h){let C=arguments.length>3&&void 0!==arguments[3]&&arguments[3];h&&Y.fogEnabled&&(!c||c.applyFog)&&0!==Y.fogMode&&(h.setFloat4("vFogInfos",Y.fogMode,Y.fogStart,Y.fogEnd,Y.fogDensity),C?(Y.fogColor.toLinearSpaceToRef(H,Y.getEngine().useExactSrgbConversions),h.setColor3("vFogColor",H)):h.setColor3("vFogColor",Y.fogColor))}function k(Y,c,h,C,E,N,Q,b,H,W){const q=Y.numMaxInfluencers||Y.numInfluencers;return q<=0?0:(c.push("#define MORPHTARGETS"),Y.hasPositions&&c.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),Y.hasNormals&&c.push("#define MORPHTARGETTEXTURE_HASNORMALS"),Y.hasTangents&&c.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),Y.hasUVs&&c.push("#define MORPHTARGETTEXTURE_HASUVS"),Y.hasUV2s&&c.push("#define MORPHTARGETTEXTURE_HASUV2S"),Y.hasColors&&c.push("#define MORPHTARGETTEXTURE_HASCOLORS"),Y.supportsPositions&&E&&c.push("#define MORPHTARGETS_POSITION"),Y.supportsNormals&&N&&c.push("#define MORPHTARGETS_NORMAL"),Y.supportsTangents&&Q&&c.push("#define MORPHTARGETS_TANGENT"),Y.supportsUVs&&b&&c.push("#define MORPHTARGETS_UV"),Y.supportsUV2s&&H&&c.push("#define MORPHTARGETS_UV2"),Y.supportsColors&&W&&c.push("#define MORPHTARGETS_COLOR"),c.push("#define NUM_MORPH_INFLUENCERS "+q),Y.isUsingTextureForTargets&&c.push("#define MORPHTARGETS_TEXTURE"),w.NUM_MORPH_INFLUENCERS=q,w.NORMAL=N,w.TANGENT=Q,w.UV=b,w.UV2=H,w.COLOR=W,M(h,C,w,E),q)}function M(Y,c,h){let E=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const Q=h.NUM_MORPH_INFLUENCERS;if(Q>0&&N.d.LastCreatedEngine){const b=N.d.LastCreatedEngine.getCaps().maxVertexAttribs,H=c.morphTargetManager;if(null!==H&&void 0!==H&&H.isUsingTextureForTargets)return;const w=H&&H.supportsPositions&&E,W=H&&H.supportsNormals&&h.NORMAL,q=H&&H.supportsTangents&&h.TANGENT,k=H&&H.supportsUVs&&h.UV1,M=H&&H.supportsUV2s&&h.UV2,p=H&&H.supportsColors&&h.VERTEXCOLOR;for(let h=0;h<Q;h++)w&&Y.push("position"+h),W&&Y.push("normal"+h),q&&Y.push("tangent"+h),k&&Y.push("uv_"+h),M&&Y.push("uv2_"+h),p&&Y.push("color"+h),Y.length>b&&C.e.Error("Cannot add more vertex attributes for mesh "+c.name)}}function p(Y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Y.push("world0"),Y.push("world1"),Y.push("world2"),Y.push("world3"),c&&(Y.push("previousWorld0"),Y.push("previousWorld1"),Y.push("previousWorld2"),Y.push("previousWorld3"))}function P(Y,c){const h=Y.morphTargetManager;Y&&h&&c.setFloatArray("morphTargetInfluences",h.influences)}function y(Y,c){c.bindToEffect(Y,"Scene")}function d(Y,c,h){c._needUVs=!0,c[h]=!0,Y.optimizeUVAllocation&&Y.getTextureMatrix().isIdentityAs3x2()?(c[h+"DIRECTUV"]=Y.coordinatesIndex+1,c["MAINUV"+(Y.coordinatesIndex+1)]=!0):c[h+"DIRECTUV"]=0}function D(Y,c,h){const C=Y.getTextureMatrix();c.Gc(h+"Matrix",C)}function T(Y,c,h){h.BAKED_VERTEX_ANIMATION_TEXTURE&&h.INSTANCES&&Y.push("bakedVertexAnimationSettingsInstanced")}function e(Y,c,h){var C;if(c&&Y&&(Y.computeBonesUsingShaders&&c._bonesComputationForcedToCPU&&(Y.computeBonesUsingShaders=!1),Y.useBones&&Y.computeBonesUsingShaders&&Y.skeleton)){const E=Y.skeleton;if(E.isUsingTextureForMatrices&&c.getUniformIndex("boneTextureWidth")>-1){const h=E.getTransformMatrixTexture(Y);c.setTexture("boneSampler",h),c.setFloat("boneTextureWidth",4*(E.bones.length+1))}else{const N=E.getTransformMatrices(Y);N&&(c.setMatrices("mBones",N),h&&Y.ZY().prePassRenderer&&Y.ZY().prePassRenderer.getIndex(2)&&(h.previousBones[Y.uniqueId]||(h.previousBones[Y.uniqueId]=N.slice()),c.setMatrices("mPreviousBones",h.previousBones[Y.uniqueId]),C=N,h.previousBones[Y.uniqueId].set(C)))}}}function r(Y,c,h,C,E){let N=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Y._bindLight(c,h,C,E,N)}function X(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const N=Math.min(c.lightSources.length,E);for(let Q=0;Q<N;Q++){r(c.lightSources[Q],Q,Y,h,"boolean"===typeof C?C:C.SPECULARTERM,c.receiveShadows)}}function Z(Y,c,h,C){h.NUM_BONE_INFLUENCERS>0&&(C.addCPUSkinningFallback(0,c),Y.push("matricesIndices"),Y.push("matricesWeights"),h.NUM_BONE_INFLUENCERS>4&&(Y.push("matricesIndicesExtra"),Y.push("matricesWeightsExtra")))}function a(Y,c){(c.INSTANCES||c.THIN_INSTANCES)&&p(Y,!!c.PREPASS_VELOCITY),c.INSTANCESCOLOR&&Y.push("instanceColor")}function G(Y,c){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,E=0;for(let N=0;N<h&&Y["LIGHT"+N];N++)N>0&&(E=C+N,c.addFallback(E,"LIGHT"+N)),Y.SHADOWS||(Y["SHADOW"+N]&&c.addFallback(C,"SHADOW"+N),Y["SHADOWPCF"+N]&&c.addFallback(C,"SHADOWPCF"+N),Y["SHADOWPCSS"+N]&&c.addFallback(C,"SHADOWPCSS"+N),Y["SHADOWPOISSON"+N]&&c.addFallback(C,"SHADOWPOISSON"+N),Y["SHADOWESM"+N]&&c.addFallback(C,"SHADOWESM"+N),Y["SHADOWCLOSEESM"+N]&&c.addFallback(C,"SHADOWCLOSEESM"+N));return E++}function K(Y,c,h,C,E,N,Q){let b=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Q._areMiscDirty&&(Q.LOGARITHMICDEPTH=h,Q.POINTSIZE=C,Q.FOG=E&&function(Y,c){return c.fogEnabled&&Y.applyFog&&0!==c.fogMode}(Y,c),Q.NONUNIFORMSCALING=Y.nonUniformScaling,Q.ALPHATEST=N,Q.DECAL_AFTER_DETAIL=b)}function I(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,N=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!h._areLightsDirty)return h._needNormals;let Q=0;const b={needNormals:h._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(Y.lightsEnabled&&!N)for(const w of c.lightSources)if(s(Y,c,w,Q,h,C,b),Q++,Q===E)break;h.SPECULARTERM=b.specularEnabled,h.SHADOWS=b.shadowEnabled;for(let w=Q;w<E;w++)void 0!==h["LIGHT"+w]&&(h["LIGHT"+w]=!1,h["HEMILIGHT"+w]=!1,h["POINTLIGHT"+w]=!1,h["DIRLIGHT"+w]=!1,h["SPOTLIGHT"+w]=!1,h["AREALIGHT"+w]=!1,h["SHADOW"+w]=!1,h["SHADOWCSM"+w]=!1,h["SHADOWCSMDEBUG"+w]=!1,h["SHADOWCSMNUM_CASCADES"+w]=!1,h["SHADOWCSMUSESHADOWMAXZ"+w]=!1,h["SHADOWCSMNOBLEND"+w]=!1,h["SHADOWCSM_RIGHTHANDED"+w]=!1,h["SHADOWPCF"+w]=!1,h["SHADOWPCSS"+w]=!1,h["SHADOWPOISSON"+w]=!1,h["SHADOWESM"+w]=!1,h["SHADOWCLOSEESM"+w]=!1,h["SHADOWCUBE"+w]=!1,h["SHADOWLOWQUALITY"+w]=!1,h["SHADOWMEDIUMQUALITY"+w]=!1);const H=Y.getEngine().getCaps();return void 0===h.SHADOWFLOAT&&(b.needRebuild=!0),h.SHADOWFLOAT=b.shadowEnabled&&(H.textureFloatRender&&H.textureFloatLinearFiltering||H.textureHalfFloatRender&&H.textureHalfFloatLinearFiltering),h.LIGHTMAPEXCLUDED=b.lightmapMode,b.needRebuild&&h.rebuild(),b.needNormals}function s(Y,c,h,C,E,N,b){switch(b.needNormals=!0,void 0===E["LIGHT"+C]&&(b.needRebuild=!0),E["LIGHT"+C]=!0,E["SPOTLIGHT"+C]=!1,E["HEMILIGHT"+C]=!1,E["POINTLIGHT"+C]=!1,E["DIRLIGHT"+C]=!1,E["AREALIGHT"+C]=!1,h.prepareLightSpecificDefines(E,C),E["LIGHT_FALLOFF_PHYSICAL"+C]=!1,E["LIGHT_FALLOFF_GLTF"+C]=!1,E["LIGHT_FALLOFF_STANDARD"+C]=!1,h.falloffType){case Q.c.FALLOFF_GLTF:E["LIGHT_FALLOFF_GLTF"+C]=!0;break;case Q.c.FALLOFF_PHYSICAL:E["LIGHT_FALLOFF_PHYSICAL"+C]=!0;break;case Q.c.FALLOFF_STANDARD:E["LIGHT_FALLOFF_STANDARD"+C]=!0}if(N&&!h.Yk.equalsFloats(0,0,0)&&(b.specularEnabled=!0),E["SHADOW"+C]=!1,E["SHADOWCSM"+C]=!1,E["SHADOWCSMDEBUG"+C]=!1,E["SHADOWCSMNUM_CASCADES"+C]=!1,E["SHADOWCSMUSESHADOWMAXZ"+C]=!1,E["SHADOWCSMNOBLEND"+C]=!1,E["SHADOWCSM_RIGHTHANDED"+C]=!1,E["SHADOWPCF"+C]=!1,E["SHADOWPCSS"+C]=!1,E["SHADOWPOISSON"+C]=!1,E["SHADOWESM"+C]=!1,E["SHADOWCLOSEESM"+C]=!1,E["SHADOWCUBE"+C]=!1,E["SHADOWLOWQUALITY"+C]=!1,E["SHADOWMEDIUMQUALITY"+C]=!1,c&&c.receiveShadows&&Y.shadowsEnabled&&h.shadowEnabled){const c=h.getShadowGenerator(Y.activeCamera)??h.getShadowGenerator();if(c){const Y=c.getShadowMap();Y&&Y.renderList&&Y.renderList.length>0&&(b.shadowEnabled=!0,c.prepareDefines(E,C))}}h.lightmapMode!=Q.c.LIGHTMAP_DEFAULT?(b.lightmapMode=!0,E["LIGHTMAPEXCLUDED"+C]=!0,E["LIGHTMAPNOSPECULAR"+C]=h.lightmapMode==Q.c.LIGHTMAP_SHADOWSONLY):(E["LIGHTMAPEXCLUDED"+C]=!1,E["LIGHTMAPNOSPECULAR"+C]=!1)}function x(Y,c,h,C,E){let N=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,Q=arguments.length>6&&void 0!==arguments[6]&&arguments[6],H=function(Y,c){let h=!1;if(Y.activeCamera){const C=c.CAMERA_ORTHOGRAPHIC?1:0,E=c.CAMERA_PERSPECTIVE?1:0,N=1===Y.activeCamera.mode?1:0,Q=0===Y.activeCamera.mode?1:0;(C^N||E^Q)&&(c.CAMERA_ORTHOGRAPHIC=1===N,c.CAMERA_PERSPECTIVE=1===Q,h=!0)}return h}(Y,C);!1!==N&&(H=(0,b.e)(h,Y,C)),C.DEPTHPREPASS!==!c.getColorWrite()&&(C.DEPTHPREPASS=!C.DEPTHPREPASS,H=!0),C.INSTANCES!==E&&(C.INSTANCES=E,H=!0),C.THIN_INSTANCES!==Q&&(C.THIN_INSTANCES=Q,H=!0),H&&C.markAsUnprocessed()}function A(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]&&arguments[4],N=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],Q=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!c._areAttributesDirty&&c._needNormals===c._normals&&c._needUVs===c._uvs)return!1;c._normals=c._needNormals,c._uvs=c._needUVs,c.NORMAL=c._needNormals&&Y.isVerticesDataPresent("normal"),c._needNormals&&Y.isVerticesDataPresent("tangent")&&(c.TANGENT=!0);for(let b=1;b<=6;++b)c["UV"+b]=!!c._needUVs&&Y.isVerticesDataPresent(`uv${1===b?"":b}`);if(h){const h=Y.useVertexColors&&Y.isVerticesDataPresent("color");c.VERTEXCOLOR=h,c.VERTEXALPHA=Y.hasVertexAlpha&&h&&N}return Y.isVerticesDataPresent("instanceColor")&&(Y.hasInstances||Y.hasThinInstances)&&(c.INSTANCESCOLOR=!0),C&&function(Y,c){if(Y.useBones&&Y.computeBonesUsingShaders&&Y.skeleton){c.NUM_BONE_INFLUENCERS=Y.numBoneInfluencers;const h=void 0!==c.BONETEXTURE;if(Y.skeleton.isUsingTextureForMatrices&&h)c.BONETEXTURE=!0;else{c.BonesPerMesh=Y.skeleton.bones.length+1,c.BONETEXTURE=!h&&void 0;const C=Y.ZY().prePassRenderer;if(C&&C.enabled){const h=-1===C.excludedSkinnedMesh.indexOf(Y);c.BONES_VELOCITY_ENABLED=h}}}else c.NUM_BONE_INFLUENCERS=0,c.BonesPerMesh=0,void 0!==c.BONETEXTURE&&(c.BONETEXTURE=!1)}(Y,c),E&&function(Y,c){const h=Y.morphTargetManager;h?(c.MORPHTARGETS_UV=h.supportsUVs&&c.UV1,c.MORPHTARGETS_UV2=h.supportsUV2s&&c.UV2,c.MORPHTARGETS_TANGENT=h.supportsTangents&&c.TANGENT,c.MORPHTARGETS_NORMAL=h.supportsNormals&&c.NORMAL,c.MORPHTARGETS_POSITION=h.supportsPositions,c.MORPHTARGETS_COLOR=h.supportsColors,c.MORPHTARGETTEXTURE_HASUVS=h.hasUVs,c.MORPHTARGETTEXTURE_HASUV2S=h.hasUV2s,c.MORPHTARGETTEXTURE_HASTANGENTS=h.hasTangents,c.MORPHTARGETTEXTURE_HASNORMALS=h.hasNormals,c.MORPHTARGETTEXTURE_HASPOSITIONS=h.hasPositions,c.MORPHTARGETTEXTURE_HASCOLORS=h.hasColors,c.NUM_MORPH_INFLUENCERS=h.numMaxInfluencers||h.numInfluencers,c.MORPHTARGETS=c.NUM_MORPH_INFLUENCERS>0,c.MORPHTARGETS_TEXTURE=h.isUsingTextureForTargets):(c.MORPHTARGETS_UV=!1,c.MORPHTARGETS_UV2=!1,c.MORPHTARGETS_TANGENT=!1,c.MORPHTARGETS_NORMAL=!1,c.MORPHTARGETS_POSITION=!1,c.MORPHTARGETS_COLOR=!1,c.MORPHTARGETTEXTURE_HASUVS=!1,c.MORPHTARGETTEXTURE_HASUV2S=!1,c.MORPHTARGETTEXTURE_HASTANGENTS=!1,c.MORPHTARGETTEXTURE_HASNORMALS=!1,c.MORPHTARGETTEXTURE_HASPOSITIONS=!1,c.MORPHTARGETTEXTURE_HAS_COLORS=!1,c.MORPHTARGETS=!1,c.NUM_MORPH_INFLUENCERS=0)}(Y,c),Q&&function(Y,c){const h=Y.bakedVertexAnimationManager;c.BAKED_VERTEX_ANIMATION_TEXTURE=!(!h||!h.isEnabled)}(Y,c),!0}function V(Y,c){if(Y.activeCamera){const h=c.MULTIVIEW;c.MULTIVIEW=null!==Y.activeCamera.outputRenderTarget&&Y.activeCamera.outputRenderTarget.getViewCount()>1,c.MULTIVIEW!=h&&c.markAsUnprocessed()}}function U(Y,c,h){const C=c.ORDER_INDEPENDENT_TRANSPARENCY,E=c.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;c.ORDER_INDEPENDENT_TRANSPARENCY=Y.useOrderIndependentTransparency&&h,c.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!Y.getEngine().getCaps().textureFloatLinearFiltering,C===c.ORDER_INDEPENDENT_TRANSPARENCY&&E===c.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||c.markAsUnprocessed()}function l(Y,c,h){const C=c.PREPASS;if(!c._arePrePassDirty)return;const E=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(Y.prePassRenderer&&Y.prePassRenderer.enabled&&h){c.PREPASS=!0,c.SCENE_MRT_COUNT=Y.prePassRenderer.mrtCount,c.PREPASS_NORMAL_WORLDSPACE=Y.prePassRenderer.generateNormalsInWorldSpace,c.PREPASS_COLOR=!0,c.PREPASS_COLOR_INDEX=0;for(let h=0;h<E.length;h++){const C=Y.prePassRenderer.getIndex(E[h].type);-1!==C?(c[E[h].define]=!0,c[E[h].index]=C):c[E[h].define]=!1}}else{c.PREPASS=!1;for(let Y=0;Y<E.length;Y++)c[E[Y].define]=!1}c.PREPASS!=C&&(c.markAsUnprocessed(),c.markAsImageProcessingDirty())}function n(Y,c,h,C){let E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,N=arguments.length>5&&void 0!==arguments[5]&&arguments[5],Q=arguments.length>6&&void 0!==arguments[6]&&arguments[6];E&&E.push("Light"+Y),N||(c.push("vLightData"+Y,"vLightDiffuse"+Y,"vLightSpecular"+Y,"vLightDirection"+Y,"vLightWidth"+Y,"vLightHeight"+Y,"vLightFalloff"+Y,"vLightGround"+Y,"lightMatrix"+Y,"shadowsInfo"+Y,"depthValues"+Y),h.push("shadowTexture"+Y),h.push("depthTexture"+Y),c.push("viewFrustumZ"+Y,"cascadeBlendFactor"+Y,"lightSizeUVCorrection"+Y,"depthCorrection"+Y,"penumbraDarkness"+Y,"frustumLengths"+Y),C&&(h.push("projectionLightTexture"+Y),c.push("textureProjectionMatrix"+Y)),Q&&h.push("iesLightTexture"+Y))}function v(Y,c,h){let C,E,N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(Y.uniformsNames){const Q=Y;C=Q.uniformsNames,E=Q.uniformBuffersNames,c=Q.samplers,h=Q.defines,N=Q.maxSimultaneousLights||0}else C=Y,c||(c=[]);for(let Q=0;Q<N&&h["LIGHT"+Q];Q++)n(Q,C,c,h["PROJECTEDLIGHTTEXTURE"+Q],E,!1,h["IESLIGHTTEXTURE"+Q]);h.NUM_MORPH_INFLUENCERS&&(C.push("morphTargetInfluences"),C.push("morphTargetCount")),h.BAKED_VERTEX_ANIMATION_TEXTURE&&(C.push("bakedVertexAnimationSettings"),C.push("bakedVertexAnimationTextureSizeInverted"),C.push("bakedVertexAnimationTime"),c.push("bakedVertexAnimationTexture"))}},13189:(Y,c,h)=>{h.d(c,{d:()=>N});var C=h(12869),E=h(13193);class N extends E.d{constructor(Y,c){let h=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(Y,c,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new C.Matrix,this._storeEffectOnSubMeshes=h}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(Y,c){return!!Y&&(!this._storeEffectOnSubMeshes||(!Y.rc||0===Y.rc.length||this.isReadyForSubMesh(Y,Y.rc[0],c)))}_isReadyForSubMesh(Y){const c=Y.materialDefines;return!(this.checkReadyOnEveryCall||!Y.effect||!c||c._renderId!==this.ZY().getRenderId())}bindOnlyWorldMatrix(Y){this._activeEffect.setMatrix("world",Y)}bindOnlyNormalMatrix(Y){this._activeEffect.setMatrix("normalMatrix",Y)}bind(Y,c){c&&this.bindForSubMesh(Y,c,c.rc[0])}_afterBind(Y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,h=arguments.length>2?arguments[2]:void 0;super._afterBind(Y,c,h),this.ZY()._cachedEffect=c,h?h._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(Y,c,h){let C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return h._drawWrapper._forceRebindOnNextCall||Y.isCachedMaterialInvalid(this,c,C)}dispose(Y,c,h){this._activeEffect=void 0,super.dispose(Y,c,h)}}},13234:(Y,c,h)=>{h.d(c,{b:()=>b,f:()=>H});var C=h(12853),E=h(12869),N=h(12859);class Q{static extractMinAndMaxIndexed(Y,c,h,C,E,N){for(let Q=h;Q<h+C;Q++){const h=3*c[Q],C=Y[h],b=Y[h+1],H=Y[h+2];E.minimizeInPlaceFromFloats(C,b,H),N.maximizeInPlaceFromFloats(C,b,H)}}static extractMinAndMax(Y,c,h,C,E,N){for(let Q=c,b=c*C;Q<c+h;Q++,b+=C){const c=Y[b],h=Y[b+1],C=Y[b+2];E.minimizeInPlaceFromFloats(c,h,C),N.maximizeInPlaceFromFloats(c,h,C)}}}function b(Y,c,h,C){let N=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const b=new E.bh(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),H=new E.bh(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return Q.extractMinAndMaxIndexed(Y,c,h,C,b,H),N&&(b.x-=b.x*N.x+N.y,b.y-=b.y*N.x+N.y,b.z-=b.z*N.x+N.y,H.x+=H.x*N.x+N.y,H.y+=H.y*N.x+N.y,H.z+=H.z*N.x+N.y),{minimum:b,maximum:H}}function H(Y,c,h){let C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,N=arguments.length>4?arguments[4]:void 0;const b=new E.bh(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),H=new E.bh(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return N||(N=3),Q.extractMinAndMax(Y,c,h,N,b,H),C&&(b.x-=b.x*C.x+C.y,b.y-=b.y*C.x+C.y,b.z-=b.z*C.x+C.y,H.x+=H.x*C.x+C.y,H.y+=H.y*C.x+C.y,H.z+=H.z*C.x+C.y),{minimum:b,maximum:H}}(0,C.b)([N.f.filter((function(){for(var Y=arguments.length,c=new Array(Y),h=0;h<Y;h++)c[h]=arguments[h];let[C,E]=c;return!Array.isArray(C)&&!Array.isArray(E)}))],Q,"extractMinAndMaxIndexed",null),(0,C.b)([N.f.filter((function(){for(var Y=arguments.length,c=new Array(Y),h=0;h<Y;h++)c[h]=arguments[h];let[C]=c;return!Array.isArray(C)}))],Q,"extractMinAndMax",null)},13199:(Y,c,h)=>{h.d(c,{c:()=>H});var C=h(12951),E=h(13208),N=h(13212),Q=h(13234),b=h(12999);class H{get materialDefines(){var Y;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(Y=this._getDrawWrapper())||void 0===Y?void 0:Y.defines}set materialDefines(Y){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=Y}_getDrawWrapper(Y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Y=Y??this._engine.currentRenderPassId;let h=this._drawWrappers[Y];return!h&&c&&(this._drawWrappers[Y]=h=new b.e(this._mesh.ZY().getEngine())),h}_removeDrawWrapper(Y){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var h;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(h=this._drawWrappers[Y])||void 0===h||h.dispose(c));this._drawWrappers[Y]=void 0}get effect(){var Y;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(Y=this._getDrawWrapper())||void 0===Y?void 0:Y.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(Y){this._mainDrawWrapperOverride=Y}setEffect(Y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,h=arguments.length>2?arguments[2]:void 0,C=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const E=this._drawWrapper;E.setEffect(Y,c,C),void 0!==h&&(E.materialContext=h),Y||(E.defines=null,E.materialContext=void 0)}resetDrawCache(Y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==Y)return void this._removeDrawWrapper(Y,!0,c);for(const Y of this._drawWrappers)null===Y||void 0===Y||Y.dispose(c)}this._drawWrappers=[]}static AddToMesh(Y,c,h,C,E,N,Q){return new H(Y,c,h,C,E,N,Q,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(Y,c,h,C,E,N,Q){let b=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],H=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=Y,this.verticesStart=c,this.verticesCount=h,this.indexStart=C,this.indexCount=E,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=N,this._renderingMesh=Q||N,H&&N.rc.push(this),this._engine=this._mesh.ZY().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=N.rc.length-1,b&&(this.refreshBoundingInfo(),N.Kc(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(Y){return this._boundingInfo=Y,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const Y=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return Y||this._renderingMesh}vY(){let Y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const c=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!c)return Y&&this._mesh.ZY()._hasDefaultMaterial?this._mesh.ZY().defaultMaterial:null;if(this._isMultiMaterial(c)){const Y=c.getSubMaterial(this.materialIndex);return this._currentMaterial!==Y&&(this._currentMaterial=Y,this.resetDrawCache()),Y}return c}_isMultiMaterial(Y){return void 0!==Y.getSubMaterial}refreshBoundingInfo(){let Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.Ic)return this;if(Y||(Y=this._renderingMesh.getVerticesData(C.f.PositionKind)),!Y)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const c=this._renderingMesh.sc();let h;if(0===this.indexStart&&this.indexCount===c.length){const Y=this._renderingMesh.getBoundingInfo();h={minimum:Y.minimum.clone(),maximum:Y.maximum.clone()}}else h=(0,Q.b)(Y,c,this.indexStart,this.indexCount,this._renderingMesh.Ic.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(h.minimum,h.maximum):this._boundingInfo=new N.d(h.minimum,h.maximum),this}_checkCollision(Y){return this.getBoundingInfo()._checkCollision(Y)}updateBoundingInfo(Y){let c=this.getBoundingInfo();return c||(this.refreshBoundingInfo(),c=this.getBoundingInfo()),c&&c.update(Y),this}isInFrustum(Y){const c=this.getBoundingInfo();return!!c&&c.isInFrustum(Y,this._mesh.hM)}isCompletelyInFrustum(Y){const c=this.getBoundingInfo();return!!c&&c.isCompletelyInFrustum(Y)}render(Y){return this._renderingMesh.render(this,Y,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(Y,c){if(!this._linesIndexBuffer){const h=6*Math.floor(this.indexCount/3),C=this.verticesStart+this.verticesCount>65535?new Uint32Array(h):new Uint16Array(h);let E=0;if(0===Y.length)for(let Y=this.indexStart;Y<this.indexStart+this.indexCount;Y+=3)C[E++]=Y,C[E++]=Y+1,C[E++]=Y+1,C[E++]=Y+2,C[E++]=Y+2,C[E++]=Y;else for(let c=this.indexStart;c<this.indexStart+this.indexCount;c+=3)C[E++]=Y[c],C[E++]=Y[c+1],C[E++]=Y[c+1],C[E++]=Y[c+2],C[E++]=Y[c+2],C[E++]=Y[c];this._linesIndexBuffer=c.createIndexBuffer(C),this._linesIndexCount=C.length}return this._linesIndexBuffer}canIntersects(Y){const c=this.getBoundingInfo();return!!c&&Y.intersectsBox(c.boundingBox)}intersects(Y,c,h,C,E){const N=this.vY();if(!N)return null;let Q=3,b=!1;switch(N.fillMode){case 3:case 5:case 6:case 8:return null;case 7:Q=1,b=!0}return 4===N.fillMode?h.length?this._intersectLines(Y,c,h,this._mesh.intersectionThreshold,C):this._intersectUnIndexedLines(Y,c,h,this._mesh.intersectionThreshold,C):!h.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(Y,c,h,C,E):this._intersectTriangles(Y,c,h,Q,b,C,E)}_intersectLines(Y,c,h,C,N){let Q=null;for(let b=this.indexStart;b<this.indexStart+this.indexCount;b+=2){const H=c[h[b]],w=c[h[b+1]],W=Y.intersectionSegment(H,w,C);if(!(W<0)&&((N||!Q||W<Q.distance)&&(Q=new E.d(null,null,W),Q.faceId=b/2,N)))break}return Q}_intersectUnIndexedLines(Y,c,h,C,N){let Q=null;for(let b=this.verticesStart;b<this.verticesStart+this.verticesCount;b+=2){const h=c[b],H=c[b+1],w=Y.intersectionSegment(h,H,C);if(!(w<0)&&((N||!Q||w<Q.distance)&&(Q=new E.d(null,null,w),Q.faceId=b/2,N)))break}return Q}_intersectTriangles(Y,c,h,C,E,N,Q){let b=null,H=-1;for(let w=this.indexStart;w<this.indexStart+this.indexCount-(3-C);w+=C){H++;const C=h[w],W=h[w+1],q=h[w+2];if(E&&4294967295===q){w+=2;continue}const k=c[C],M=c[W],p=c[q];if(!k||!M||!p)continue;if(Q&&!Q(k,M,p,Y,C,W,q))continue;const P=Y.intersectsTriangle(k,M,p);if(P){if(P.distance<0)continue;if((N||!b||P.distance<b.distance)&&(b=P,b.faceId=H,N))break}}return b}_intersectUnIndexedTriangles(Y,c,h,C,E){let N=null;for(let Q=this.verticesStart;Q<this.verticesStart+this.verticesCount;Q+=3){const h=c[Q],b=c[Q+1],H=c[Q+2];if(E&&!E(h,b,H,Y,-1,-1,-1))continue;const w=Y.intersectsTriangle(h,b,H);if(w){if(w.distance<0)continue;if((C||!N||w.distance<N.distance)&&(N=w,N.faceId=Q/3,C))break}}return N}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(Y,c){const h=new H(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,Y,c,!1);if(!this.IsGlobal){const Y=this.getBoundingInfo();if(!Y)return h;h._boundingInfo=new N.d(Y.minimum,Y.maximum)}return h}dispose(){let Y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.ZY().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const c=this._mesh.rc.indexOf(this);this._mesh.rc.splice(c,1),this.resetDrawCache(void 0,Y)}getClassName(){return"SubMesh"}static CreateFromIndices(Y,c,h,C,E){let N=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],Q=Number.MAX_VALUE,b=-Number.MAX_VALUE;const w=(E||C).sc();for(let H=c;H<c+h;H++){const Y=w[H];Y<Q&&(Q=Y),Y>b&&(b=Y)}return new H(Y,Q,b-Q+1,c,h,C,E,N)}}}}]);