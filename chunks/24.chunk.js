"use strict";(self.zcqpiao938m=self.zcqpiao938m||[]).push([[24],{12169:(C,U,K)=>{K.d(U,{c:()=>m});class m{constructor(C,U,K){this.bu=C,this.bv=U,this.distance=K,this.faceId=0,this.subMeshId=0}}},12183:(C,U,K)=>{K.d(U,{b:()=>A});var m=K(11844),O=K(11827),X=K(11835);class A{constructor(C,U,K){this.vectors=(0,m.e)(8,O.bU.Zero),this.center=O.bU.Zero(),this.centerWorld=O.bU.Zero(),this.extendSize=O.bU.Zero(),this.extendSizeWorld=O.bU.Zero(),this.directions=(0,m.e)(3,O.bU.Zero),this.vectorsWorld=(0,m.e)(8,O.bU.Zero),this.minimumWorld=O.bU.Zero(),this.maximumWorld=O.bU.Zero(),this.minimum=O.bU.Zero(),this.maximum=O.bU.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(C,U,K)}reConstruct(C,U,K){const m=C.x,X=C.y,A=C.z,e=U.x,t=U.y,z=U.z,j=this.vectors;this.minimum.Ee(m,X,A),this.maximum.Ee(e,t,z),j[0].Ee(m,X,A),j[1].Ee(e,t,z),j[2].Ee(e,X,A),j[3].Ee(m,t,A),j[4].Ee(m,X,z),j[5].Ee(e,t,A),j[6].Ee(m,t,z),j[7].Ee(e,X,z),U.addToRef(C,this.center).scaleInPlace(.5),U.subtractToRef(C,this.extendSize).scaleInPlace(.5),this._worldMatrix=K||O.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(C){const U=A._TmpVector3,K=this.maximum.subtractToRef(this.minimum,U[0]),m=K.length();K.normalizeFromLength(m);const O=m*C,X=K.scaleInPlace(.5*O),e=this.center.subtractToRef(X,U[1]),t=this.center.addToRef(X,U[2]);return this.reConstruct(e,t,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(C){const U=this.minimumWorld,K=this.maximumWorld,m=this.directions,X=this.vectorsWorld,A=this.vectors;if(C.isIdentity()){U.m(this.minimum),K.m(this.maximum);for(let C=0;C<8;++C)X[C].m(A[C]);this.extendSizeWorld.m(this.extendSize),this.centerWorld.m(this.center)}else{U.be(Number.MAX_VALUE),K.be(-Number.MAX_VALUE);for(let m=0;m<8;++m){const e=X[m];O.bU.TransformCoordinatesToRef(A[m],C,e),U.minimizeInPlace(e),K.maximizeInPlace(e)}K.subtractToRef(U,this.extendSizeWorld).scaleInPlace(.5),K.addToRef(U,this.centerWorld).scaleInPlace(.5)}O.bU.FromArrayToRef(C.m,0,m[0]),O.bU.FromArrayToRef(C.m,4,m[1]),O.bU.FromArrayToRef(C.m,8,m[2]),this._worldMatrix=C}isInFrustum(C){return A.IsInFrustum(this.vectorsWorld,C)}isCompletelyInFrustum(C){return A.IsCompletelyInFrustum(this.vectorsWorld,C)}intersectsPoint(C){const U=this.minimumWorld,K=this.maximumWorld,m=U.x,O=U.y,A=U.z,e=K.x,t=K.y,z=K.z,j=C.x,p=C.y,E=C.z,u=-X.d;return!(e-j<u||u>j-m)&&(!(t-p<u||u>p-O)&&!(z-E<u||u>E-A))}intersectsSphere(C){return A.IntersectsSphere(this.minimumWorld,this.maximumWorld,C.centerWorld,C.radiusWorld)}intersectsMinMax(C,U){const K=this.minimumWorld,m=this.maximumWorld,O=K.x,X=K.y,A=K.z,e=m.x,t=m.y,z=m.z,j=C.x,p=C.y,E=C.z,u=U.x,b=U.y,v=U.z;return!(e<j||O>u)&&(!(t<p||X>b)&&!(z<E||A>v))}dispose(){var C,U;null===(C=this._drawWrapperFront)||void 0===C||C.dispose(),null===(U=this._drawWrapperBack)||void 0===U||U.dispose()}static Intersects(C,U){return C.intersectsMinMax(U.minimumWorld,U.maximumWorld)}static IntersectsSphere(C,U,K,m){const X=A._TmpVector3[0];O.bU.ClampToRef(K,C,U,X);return O.bU.DistanceSquared(K,X)<=m*m}static IsCompletelyInFrustum(C,U){for(let K=0;K<6;++K){const m=U[K];for(let U=0;U<8;++U)if(m.dotCoordinate(C[U])<0)return!1}return!0}static IsInFrustum(C,U){for(let K=0;K<6;++K){let m=!0;const O=U[K];for(let U=0;U<8;++U)if(O.dotCoordinate(C[U])>=0){m=!1;break}if(m)return!1}return!0}}A._TmpVector3=(0,m.e)(3,O.bU.Zero)},12178:(C,U,K)=>{K.d(U,{d:()=>p});var m=K(11844),O=K(11827),X=K(12183),A=K(12186);const e={min:0,max:0},t={min:0,max:0},z=(C,U,K)=>{const m=O.bU.Dot(U.centerWorld,C),X=Math.abs(O.bU.Dot(U.directions[0],C))*U.extendSize.x+Math.abs(O.bU.Dot(U.directions[1],C))*U.extendSize.y+Math.abs(O.bU.Dot(U.directions[2],C))*U.extendSize.z;K.min=m-X,K.max=m+X},j=(C,U,K)=>(z(C,U,e),z(C,K,t),!(e.min>t.max||t.min>e.max));class p{constructor(C,U,K){this._isLocked=!1,this.boundingBox=new X.b(C,U,K),this.boundingSphere=new A.c(C,U,K)}reConstruct(C,U,K){this.boundingBox.reConstruct(C,U,K),this.boundingSphere.reConstruct(C,U,K)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(C){this._isLocked=C}update(C){this._isLocked||(this.boundingBox._update(C),this.boundingSphere._update(C))}centerOn(C,U){const K=p._TmpVector3[0].m(C).zp(U),m=p._TmpVector3[1].m(C).addInPlace(U);return this.boundingBox.reConstruct(K,m,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(K,m,this.boundingBox.getWorldMatrix()),this}encapsulate(C){const U=O.bU.Minimize(this.minimum,C),K=O.bU.Maximize(this.maximum,C);return this.reConstruct(U,K,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(C){const U=O.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(U);const K=O.TmpVectors.bU[0];return O.bU.TransformCoordinatesToRef(C.boundingBox.minimumWorld,U,K),this.encapsulate(K),O.bU.TransformCoordinatesToRef(C.boundingBox.maximumWorld,U,K),this.encapsulate(K),this}scale(C){return this.boundingBox.scale(C),this.boundingSphere.scale(C),this}isInFrustum(C){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===U||3===U)&&this.boundingSphere.isCenterInFrustum(C))return!0;if(!this.boundingSphere.isInFrustum(C))return!1;return!(1!==U&&3!==U)||this.boundingBox.isInFrustum(C)}get diagonalLength(){const C=this.boundingBox;return C.maximumWorld.subtractToRef(C.minimumWorld,p._TmpVector3[0]).length()}isCompletelyInFrustum(C){return this.boundingBox.isCompletelyInFrustum(C)}_checkCollision(C){return C._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(C){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(C)&&!!this.boundingBox.intersectsPoint(C))}intersects(C,U){if(!A.c.Intersects(this.boundingSphere,C.boundingSphere))return!1;if(!X.b.Intersects(this.boundingBox,C.boundingBox))return!1;if(!U)return!0;const K=this.boundingBox,m=C.boundingBox;return!!j(K.directions[0],K,m)&&(!!j(K.directions[1],K,m)&&(!!j(K.directions[2],K,m)&&(!!j(m.directions[0],K,m)&&(!!j(m.directions[1],K,m)&&(!!j(m.directions[2],K,m)&&(!!j(O.bU.Cross(K.directions[0],m.directions[0]),K,m)&&(!!j(O.bU.Cross(K.directions[0],m.directions[1]),K,m)&&(!!j(O.bU.Cross(K.directions[0],m.directions[2]),K,m)&&(!!j(O.bU.Cross(K.directions[1],m.directions[0]),K,m)&&(!!j(O.bU.Cross(K.directions[1],m.directions[1]),K,m)&&(!!j(O.bU.Cross(K.directions[1],m.directions[2]),K,m)&&(!!j(O.bU.Cross(K.directions[2],m.directions[0]),K,m)&&(!!j(O.bU.Cross(K.directions[2],m.directions[1]),K,m)&&!!j(O.bU.Cross(K.directions[2],m.directions[2]),K,m))))))))))))))}}p._TmpVector3=(0,m.e)(2,O.bU.Zero)},12186:(C,U,K)=>{K.d(U,{c:()=>X});var m=K(11844),O=K(11827);class X{constructor(C,U,K){this.center=O.bU.Zero(),this.centerWorld=O.bU.Zero(),this.minimum=O.bU.Zero(),this.maximum=O.bU.Zero(),this.reConstruct(C,U,K)}reConstruct(C,U,K){this.minimum.m(C),this.maximum.m(U);const m=O.bU.Distance(C,U);U.addToRef(C,this.center).scaleInPlace(.5),this.radius=.5*m,this._update(K||O.Matrix.IdentityReadOnly)}scale(C){const U=this.radius*C,K=X._TmpVector3,m=K[0].be(U),O=this.center.subtractToRef(m,K[1]),A=this.center.addToRef(m,K[2]);return this.reConstruct(O,A,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(C){if(C.isIdentity())this.centerWorld.m(this.center),this.radiusWorld=this.radius;else{O.bU.TransformCoordinatesToRef(this.center,C,this.centerWorld);const U=X._TmpVector3[0];O.bU.TransformNormalFromFloatsToRef(1,1,1,C,U),this.radiusWorld=Math.max(Math.abs(U.x),Math.abs(U.y),Math.abs(U.z))*this.radius}}isInFrustum(C){const U=this.centerWorld,K=this.radiusWorld;for(let m=0;m<6;m++)if(C[m].dotCoordinate(U)<=-K)return!1;return!0}isCenterInFrustum(C){const U=this.centerWorld;for(let K=0;K<6;K++)if(C[K].dotCoordinate(U)<0)return!1;return!0}intersectsPoint(C){const U=O.bU.DistanceSquared(this.centerWorld,C);return!(this.radiusWorld*this.radiusWorld<U)}static Intersects(C,U){const K=O.bU.DistanceSquared(C.centerWorld,U.centerWorld),m=C.radiusWorld+U.radiusWorld;return!(m*m<K)}static CreateFromCenterAndRadius(C,U,K){this._TmpVector3[0].m(C),this._TmpVector3[1].Ee(0,0,U),this._TmpVector3[2].m(C),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].zp(this._TmpVector3[1]);const m=new X(this._TmpVector3[0],this._TmpVector3[2]);return m._worldMatrix=K||O.Matrix.Identity(),m}}X._TmpVector3=(0,m.e)(3,O.bU.Zero)},12200:(C,U,K)=>{function m(C){-1===C.indexOf("vClipPlane")&&C.push("vClipPlane"),-1===C.indexOf("vClipPlane2")&&C.push("vClipPlane2"),-1===C.indexOf("vClipPlane3")&&C.push("vClipPlane3"),-1===C.indexOf("vClipPlane4")&&C.push("vClipPlane4"),-1===C.indexOf("vClipPlane5")&&C.push("vClipPlane5"),-1===C.indexOf("vClipPlane6")&&C.push("vClipPlane6")}function O(C,U,K){const m=!!(C.clipPlane??U.clipPlane),O=!!(C.clipPlane2??U.clipPlane2),X=!!(C.clipPlane3??U.clipPlane3),A=!!(C.clipPlane4??U.clipPlane4),e=!!(C.clipPlane5??U.clipPlane5),t=!!(C.clipPlane6??U.clipPlane6);m&&K.push("#define CLIPPLANE"),O&&K.push("#define CLIPPLANE2"),X&&K.push("#define CLIPPLANE3"),A&&K.push("#define CLIPPLANE4"),e&&K.push("#define CLIPPLANE5"),t&&K.push("#define CLIPPLANE6")}function X(C,U,K){let m=!1;const O=!!(C.clipPlane??U.clipPlane),X=!!(C.clipPlane2??U.clipPlane2),A=!!(C.clipPlane3??U.clipPlane3),e=!!(C.clipPlane4??U.clipPlane4),t=!!(C.clipPlane5??U.clipPlane5),z=!!(C.clipPlane6??U.clipPlane6);return K.CLIPPLANE!==O&&(K.CLIPPLANE=O,m=!0),K.CLIPPLANE2!==X&&(K.CLIPPLANE2=X,m=!0),K.CLIPPLANE3!==A&&(K.CLIPPLANE3=A,m=!0),K.CLIPPLANE4!==e&&(K.CLIPPLANE4=e,m=!0),K.CLIPPLANE5!==t&&(K.CLIPPLANE5=t,m=!0),K.CLIPPLANE6!==z&&(K.CLIPPLANE6=z,m=!0),m}function A(C,U,K){let m=U.clipPlane??K.clipPlane;e(C,"vClipPlane",m),m=U.clipPlane2??K.clipPlane2,e(C,"vClipPlane2",m),m=U.clipPlane3??K.clipPlane3,e(C,"vClipPlane3",m),m=U.clipPlane4??K.clipPlane4,e(C,"vClipPlane4",m),m=U.clipPlane5??K.clipPlane5,e(C,"vClipPlane5",m),m=U.clipPlane6??K.clipPlane6,e(C,"vClipPlane6",m)}function e(C,U,K){K&&C.setFloat4(U,K.normal.x,K.normal.y,K.normal.z,K.d)}K.d(U,{d:()=>m,f:()=>A,j:()=>X,k:()=>O})},12148:(C,U,K)=>{K.d(U,{d:()=>m});class m{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(C,U){this._defines[C]||(C<this._currentRank&&(this._currentRank=C),C>this._maxRank&&(this._maxRank=C),this._defines[C]=new Array),this._defines[C].push(U)}addCPUSkinningFallback(C,U){this._mesh=U,C<this._currentRank&&(this._currentRank=C),C>this._maxRank&&(this._maxRank=C)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(C,U){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,C=C.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),U._bonesComputationForcedToCPU=!0;const K=this._mesh.dC();for(let C=0;C<K.meshes.length;C++){const m=K.meshes[C];if(m.material){if(m.computeBonesUsingShaders&&0!==m.numBoneInfluencers)if(m.material.getEffect()===U)m.computeBonesUsingShaders=!1;else if(m.me)for(const C of m.me){if(C.effect===U){m.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&m.computeBonesUsingShaders&&m.numBoneInfluencers>0&&(m.computeBonesUsingShaders=!1)}}else{const U=this._defines[this._currentRank];if(U)for(let K=0;K<U.length;K++)C=C.replace("#define "+U[K],"");this._currentRank++}return C}}},12158:(C,U,K)=>{K.d(U,{e:()=>Q});var m=K(11810),O=K(11818),X=K(11660),A=K(11663),e=K(11703),t=K(12160),z=K(12099),j=K(11679),p=K(11886),E=K(11947),u=K(11863);class b{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(C){this._func=C}get funcRef(){return this._funcRef}set funcRef(C){this._funcRef=C}get funcMask(){return this._funcMask}set funcMask(C){this._funcMask=C}get opStencilFail(){return this._opStencilFail}set opStencilFail(C){this._opStencilFail=C}get opDepthFail(){return this._opDepthFail}set opDepthFail(C){this._opDepthFail=C}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(C){this._opStencilDepthPass=C}get mask(){return this._mask}set mask(C){this._mask=C}get enabled(){return this._enabled}set enabled(C){this._enabled=C}getClassName(){return"MaterialStencilState"}copyTo(C){u.c.Clone((()=>C),this)}serialize(){return u.c.Serialize(this)}parse(C,U,K){u.c.Parse((()=>this),C,U,K)}}(0,m.d)([(0,O.O)()],b.prototype,"func",null),(0,m.d)([(0,O.O)()],b.prototype,"funcRef",null),(0,m.d)([(0,O.O)()],b.prototype,"funcMask",null),(0,m.d)([(0,O.O)()],b.prototype,"opStencilFail",null),(0,m.d)([(0,O.O)()],b.prototype,"opDepthFail",null),(0,m.d)([(0,O.O)()],b.prototype,"opStencilDepthPass",null),(0,m.d)([(0,O.O)()],b.prototype,"mask",null),(0,m.d)([(0,O.O)()],b.prototype,"enabled",null);var v=K(12198);class Q{get _supportGlowLayer(){return!1}set _glowModeEnabled(C){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(C){if(this._alpha===C)return;const U=this._alpha;this._alpha=C,1!==U&&1!==C||this.Iz(Q.MiscDirtyFlag+Q.PrePassDirtyFlag)}get alpha(){return this._alpha}set pe(C){this._backFaceCulling!==C&&(this._backFaceCulling=C,this.Iz(Q.TextureDirtyFlag))}get pe(){return this._backFaceCulling}set cullBackFaces(C){this._cullBackFaces!==C&&(this._cullBackFaces=C,this.Iz(Q.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(C){this._blockDirtyMechanism!==C&&(this._blockDirtyMechanism=C,C||this.Rp())}atomicMaterialsUpdate(C){this.blockDirtyMechanism=!0;try{C(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(C){this._onDisposeObserver&&this.RA.remove(this._onDisposeObserver),this._onDisposeObserver=this.RA.add(C)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new A.b),this._onBindObservable}set onBind(C){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(C)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new A.b),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new A.b),this._onEffectCreatedObservable}set alphaMode(C){this._alphaMode!==C&&(this._alphaMode=C,this.Iz(Q.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(C){this._needDepthPrePass!==C&&(this._needDepthPrePass=C,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(C){this._fogEnabled!==C&&(this._fogEnabled=C,this.Iz(Q.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case Q.WireFrameFillMode:case Q.LineListDrawMode:case Q.LineLoopDrawMode:case Q.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(C){this.fillMode=C?Q.WireFrameFillMode:Q.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case Q.PointFillMode:case Q.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(C){this.fillMode=C?Q.PointFillMode:Q.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(C){this._fillMode!==C&&(this._fillMode=C,this.Iz(Q.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(C){const U=this.dC().getEngine().getCaps().fragmentDepthSupported;C&&!U&&j.d.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=C&&U,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(C){this._drawWrapper=C}constructor(C,U,K){let m=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.RA=new A.b,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new b,this._useUBO=!1,this._fillMode=Q.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=C;const O=U||e.c.LastCreatedScene;O&&(this._scene=O,this._dirtyCallbacks={},this._forceGLSL=m,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=C||X.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new E.d(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new z.b(this._scene.getEngine(),void 0,void 0,C),this._useUBO=this.dC().getEngine().supportsUniformBuffers,this._createUniformBuffer(),K||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),Q.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var C;const U=this.dC().getEngine();null===(C=this._uniformBuffer)||void 0===C||C.dispose(),U.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new z.b(U,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new z.b(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(C){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.Rp(),this.checkReadyOnlyOnce=!0}unfreeze(){this.Rp(),this.checkReadyOnlyOnce=!1}isReady(C,U){return!0}isReadyForSubMesh(C,U,K){const m=U.materialDefines;return!!m&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=m,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}dC(){return this._scene}_getEffectiveOrientation(C){return null!==this.sideOrientation?this.sideOrientation:C.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(C){this._transparencyMode!==C&&(this._transparencyMode=C,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===Q.MATERIAL_ALPHABLEND||this._transparencyMode===Q.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===Q.MATERIAL_ALPHATEST||this._transparencyMode===Q.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===Q.MATERIAL_OPAQUE||this._transparencyMode===Q.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(C){return this._hasTransparencyMode?this._transparencyModeIsBlend:C.visibility<1||!this._disableAlphaBlending&&(C.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(C){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(C)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}Rp(){let C=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const U=this.dC().meshes;for(const K of U)if(K.me)for(const U of K.me)if(U.kC()===this)for(const K of U._drawWrappers)K&&this._materialContext===K.materialContext&&(K._wasPreviouslyReady=!1,K._wasPreviouslyUsingInstances=null,K._forceRebindOnNextCall=C);C&&this.Iz(Q.AllDirtyFlag)}_preBind(C){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const K=this._scene.getEngine(),m=(null==U?this.sideOrientation:U)===Q.ClockWiseSideOrientation;return K.enableEffect(C||this._getDrawWrapper()),K.setState(this.pe,this.zOffset,!1,m,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),m}bind(C,U){}buildUniformLayout(){const C=this._uniformBuffer;this._eventInfo.ubo=C,this._callbackPluginEventGeneric(8,this._eventInfo),C.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(C,U,K){const m=K._drawWrapper;this._eventInfo.subMesh=K,this._callbackPluginEventBindForSubMesh(this._eventInfo),m._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(C){}bindView(C){this._useUBO?this._needToBindSceneUbo=!0:C.setMatrix("view",this.dC().getViewMatrix())}bindViewProjection(C){this._useUBO?this._needToBindSceneUbo=!0:(C.setMatrix("viewProjection",this.dC().getTransformMatrix()),C.setMatrix("projection",this.dC().getProjectionMatrix()))}bindEyePosition(C,U){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(C,U)}_afterBind(C){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&U&&(this._needToBindSceneUbo=!1,(0,v.r)(U,this.dC().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=C?C.visibility:1,this._onBindObservable&&C&&this._onBindObservable.notifyObservers(C),this.disableDepthWrite){const C=this._scene.getEngine();this._cachedDepthWriteState=C.getDepthWrite(),C.setDepthWrite(!1)}if(this.disableColorWrite){const C=this._scene.getEngine();this._cachedColorWriteState=C.getColorWrite(),C.setColorWrite(!1)}if(0!==this.depthFunction){const C=this._scene.getEngine();this._cachedDepthFunctionState=C.getDepthFunction()||0,C.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(C){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=C,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(C){return null}_clonePlugins(C,U){const K={};if(this._serializePlugins(K),Q._ParsePlugins(K,C,this._scene,U),this.pluginManager)for(const m of this.pluginManager._plugins){const U=C.pluginManager.getPlugin(m.name);U&&m.copyTo(U)}}getBindedMeshes(){if(this.meshMap){const C=[];for(const U in this.meshMap){const K=this.meshMap[U];K&&C.push(K)}return C}return this._scene.meshes.filter((C=>C.material===this))}forceCompilation(C,U,K,m){const O={clipPlane:!1,useInstances:!1,...K},X=this.dC(),A=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const e=()=>{if(!this._scene||!this._scene.getEngine())return;const K=X.clipPlane;if(O.clipPlane&&(X.clipPlane=new p.b(0,0,0,1)),this._storeEffectOnSubMeshes){let K=!0,X=null;if(C.me){const U=new t.d(0,0,0,0,0,C,void 0,!1,!1);U.materialDefines&&(U.materialDefines._renderId=-1),this.isReadyForSubMesh(C,U,O.useInstances)||(U.effect&&U.effect.getCompilationError()&&U.effect.allFallbacksProcessed()?X=U.effect.getCompilationError():(K=!1,setTimeout(e,16)))}K&&(this.allowShaderHotSwapping=A,X&&m&&m(X),U&&U(this))}else this.isReady()?(this.allowShaderHotSwapping=A,U&&U(this)):setTimeout(e,16);O.clipPlane&&(X.clipPlane=K)};e()}async forceCompilationAsync(C,U){return await new Promise(((K,m)=>{this.forceCompilation(C,(()=>{K()}),U,(C=>{m(C)}))}))}Iz(C){this.dC().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(Q._DirtyCallbackArray.length=0,C&Q.ImageProcessingDirtyFlag&&Q._DirtyCallbackArray.push(Q._ImageProcessingDirtyCallBack),C&Q.TextureDirtyFlag&&Q._DirtyCallbackArray.push(Q._TextureDirtyCallBack),C&Q.LightDirtyFlag&&Q._DirtyCallbackArray.push(Q._LightsDirtyCallBack),C&Q.FresnelDirtyFlag&&Q._DirtyCallbackArray.push(Q._FresnelDirtyCallBack),C&Q.AttributesDirtyFlag&&Q._DirtyCallbackArray.push(Q._AttributeDirtyCallBack),C&Q.MiscDirtyFlag&&Q._DirtyCallbackArray.push(Q._MiscDirtyCallBack),C&Q.PrePassDirtyFlag&&Q._DirtyCallbackArray.push(Q._PrePassDirtyCallBack),Q._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(Q._RunDirtyCallBacks),this.dC().resetCachedMaterial())}resetDrawCache(){const C=this.dC().meshes;for(const U of C)if(U.me)for(const C of U.me)C.kC()===this&&C.resetDrawCache()}_markAllSubMeshesAsDirty(C){const U=this.dC();if(U.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const K=U.meshes;for(const m of K)if(m.me)for(const K of m.me){if((K.kC()||(U._hasDefaultMaterial?U.defaultMaterial:null))===this)for(const U of K._drawWrappers)U&&U.defines&&U.defines.markAllAsDirty&&this._materialContext===U.materialContext&&C(U.defines)}}_markScenePrePassDirty(){if(this.dC().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const C=this.dC().enablePrePassRenderer();C&&C.Iz()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(Q._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(Q._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(Q._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(Q._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(Q._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(Q._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(Q._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(Q._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(Q._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(Q._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const C=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.RA.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(C)}))}}setPrePassRenderer(C){return!1}dispose(C,U,K){const m=this.dC();if(m.stopAnimation(this),m.freeProcessedMaterials(),m.removeMaterial(this),this._eventInfo.forceDisposeTextures=U,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const C=this._parentContainer.materials.indexOf(this);C>-1&&this._parentContainer.materials.splice(C,1),this._parentContainer=null}if(!0!==K)if(this.meshMap)for(const O in this.meshMap){const C=this.meshMap[O];this._disposeMeshResources(C)}else{const C=m.meshes;for(const U of C)this._disposeMeshResources(U)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.RA.notifyObservers(this),this.RA.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(C){if(!C)return;const U=C.ze,K=C._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(C.me&&K)for(const O of C.me){const C=O._drawWrappers;for(let X=0;X<C.length;X++){var m;const A=null===(m=C[X])||void 0===m?void 0:m.effect;if(!A)continue;K[X]===this&&(null===U||void 0===U||U._releaseVertexArrayObject(A),O._removeDrawWrapper(X,!0,!0))}}}else null===U||void 0===U||U._releaseVertexArrayObject(this._drawWrapper.effect);C.material!==this||C.sourceMesh||(C.material=null)}serialize(){const C=u.c.Serialize(this);return C.stencil=this.stencil.serialize(),C.uniqueId=this.uniqueId,this._serializePlugins(C),C}_serializePlugins(C){if(C.plugins={},this.pluginManager)for(const U of this.pluginManager._plugins)U.doNotSerialize||(C.plugins[U.getClassName()]=U.serialize())}static Parse(C,U,K){if(C.customType){if("BABYLON.PBRMaterial"===C.customType&&C.overloadedAlbedo&&(C.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return j.d.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else C.customType="BABYLON.StandardMaterial";const m=X.Tools.Instantiate(C.customType).Parse(C,U,K);return m._loadedUniqueId=C.uniqueId,m}static _ParsePlugins(C,U,K,m){if(C.plugins)for(const e in C.plugins){var O,A;const t=C.plugins[e];let z=null===(O=U.pluginManager)||void 0===O?void 0:O.getPlugin(t.name);if(!z){const C=X.Tools.Instantiate("BABYLON."+e);C&&(z=new C(U))}null===(A=z)||void 0===A||A.parse(t,K,m)}}}Q.TriangleFillMode=0,Q.WireFrameFillMode=1,Q.PointFillMode=2,Q.PointListDrawMode=3,Q.LineListDrawMode=4,Q.LineLoopDrawMode=5,Q.LineStripDrawMode=6,Q.TriangleStripDrawMode=7,Q.TriangleFanDrawMode=8,Q.ClockWiseSideOrientation=0,Q.CounterClockWiseSideOrientation=1,Q.ImageProcessingDirtyFlag=64,Q.TextureDirtyFlag=1,Q.LightDirtyFlag=2,Q.FresnelDirtyFlag=4,Q.AttributesDirtyFlag=8,Q.MiscDirtyFlag=16,Q.PrePassDirtyFlag=32,Q.AllDirtyFlag=127,Q.MATERIAL_OPAQUE=0,Q.MATERIAL_ALPHATEST=1,Q.MATERIAL_ALPHABLEND=2,Q.MATERIAL_ALPHATESTANDBLEND=3,Q.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,Q.MATERIAL_NORMALBLENDMETHOD_RNM=1,Q.OnEventObservable=new A.b,Q._AllDirtyCallBack=C=>C.markAllAsDirty(),Q._ImageProcessingDirtyCallBack=C=>C.markAsImageProcessingDirty(),Q._TextureDirtyCallBack=C=>C.markAsTexturesDirty(),Q._FresnelDirtyCallBack=C=>C.markAsFresnelDirty(),Q._MiscDirtyCallBack=C=>C.markAsMiscDirty(),Q._PrePassDirtyCallBack=C=>C.markAsPrePassDirty(),Q._LightsDirtyCallBack=C=>C.markAsLightDirty(),Q._AttributeDirtyCallBack=C=>C.markAsAttributesDirty(),Q._FresnelAndMiscDirtyCallBack=C=>{Q._FresnelDirtyCallBack(C),Q._MiscDirtyCallBack(C)},Q._TextureAndMiscDirtyCallBack=C=>{Q._TextureDirtyCallBack(C),Q._MiscDirtyCallBack(C)},Q._DirtyCallbackArray=[],Q._RunDirtyCallBacks=C=>{for(const U of Q._DirtyCallbackArray)U(C)},(0,m.d)([(0,O.O)()],Q.prototype,"id",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"uniqueId",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"name",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"metadata",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"checkReadyOnEveryCall",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"checkReadyOnlyOnce",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"state",void 0),(0,m.d)([(0,O.O)("alpha")],Q.prototype,"_alpha",void 0),(0,m.d)([(0,O.O)("pe")],Q.prototype,"_backFaceCulling",void 0),(0,m.d)([(0,O.O)("cullBackFaces")],Q.prototype,"_cullBackFaces",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"sideOrientation",void 0),(0,m.d)([(0,O.O)("alphaMode")],Q.prototype,"_alphaMode",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"_needDepthPrePass",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"disableDepthWrite",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"disableColorWrite",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"forceDepthWrite",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"depthFunction",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"separateCullingPass",void 0),(0,m.d)([(0,O.O)("fogEnabled")],Q.prototype,"_fogEnabled",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"pointSize",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"zOffset",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"zOffsetUnits",void 0),(0,m.d)([(0,O.O)()],Q.prototype,"pointsCloud",null),(0,m.d)([(0,O.O)()],Q.prototype,"fillMode",null),(0,m.d)([(0,O.O)()],Q.prototype,"useLogarithmicDepth",null),(0,m.d)([(0,O.O)()],Q.prototype,"transparencyMode",null)},12198:(C,U,K)=>{K.d(U,{A:()=>T,C:()=>u,G:()=>E,H:()=>l,J:()=>D,L:()=>r,M:()=>V,O:()=>a,R:()=>G,S:()=>J,T:()=>o,V:()=>k,X:()=>b,b:()=>Z,f:()=>p,g:()=>H,k:()=>j,n:()=>v,r:()=>Q,v:()=>f,w:()=>y,y:()=>F,z:()=>d});var m=K(11679),O=K(11879),X=K(11703),A=K(12144),e=K(12200);const t=O.fU.Black(),z={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function j(C,U,K){if(!C||C.LOGARITHMICDEPTH||C.indexOf&&C.indexOf("LOGARITHMICDEPTH")>=0){const C=K.activeCamera;1===C.mode&&m.d.Error("Logarithmic depth is not compatible with orthographic cameras!",20),U.setFloat("logarithmicDepthConstant",2/(Math.log(C.maxZ+1)/Math.LN2))}}function p(C,U,K){let m=arguments.length>3&&void 0!==arguments[3]&&arguments[3];K&&C.fogEnabled&&(!U||U.applyFog)&&0!==C.fogMode&&(K.setFloat4("vFogInfos",C.fogMode,C.fogStart,C.fogEnd,C.fogDensity),m?(C.fogColor.toLinearSpaceToRef(t,C.getEngine().useExactSrgbConversions),K.setColor3("vFogColor",t)):K.setColor3("vFogColor",C.fogColor))}function E(C,U,K,m,O,X,A,e,t,j){const p=C.numMaxInfluencers||C.numInfluencers;return p<=0?0:(U.push("#define MORPHTARGETS"),C.hasPositions&&U.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),C.hasNormals&&U.push("#define MORPHTARGETTEXTURE_HASNORMALS"),C.hasTangents&&U.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),C.hasUVs&&U.push("#define MORPHTARGETTEXTURE_HASUVS"),C.hasUV2s&&U.push("#define MORPHTARGETTEXTURE_HASUV2S"),C.hasColors&&U.push("#define MORPHTARGETTEXTURE_HASCOLORS"),C.supportsPositions&&O&&U.push("#define MORPHTARGETS_POSITION"),C.supportsNormals&&X&&U.push("#define MORPHTARGETS_NORMAL"),C.supportsTangents&&A&&U.push("#define MORPHTARGETS_TANGENT"),C.supportsUVs&&e&&U.push("#define MORPHTARGETS_UV"),C.supportsUV2s&&t&&U.push("#define MORPHTARGETS_UV2"),C.supportsColors&&j&&U.push("#define MORPHTARGETS_COLOR"),U.push("#define NUM_MORPH_INFLUENCERS "+p),C.isUsingTextureForTargets&&U.push("#define MORPHTARGETS_TEXTURE"),z.NUM_MORPH_INFLUENCERS=p,z.NORMAL=X,z.TANGENT=A,z.UV=e,z.UV2=t,z.COLOR=j,u(K,m,z,O),p)}function u(C,U,K){let O=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const A=K.NUM_MORPH_INFLUENCERS;if(A>0&&X.c.LastCreatedEngine){const e=X.c.LastCreatedEngine.getCaps().maxVertexAttribs,t=U.morphTargetManager;if(null!==t&&void 0!==t&&t.isUsingTextureForTargets)return;const z=t&&t.supportsPositions&&O,j=t&&t.supportsNormals&&K.NORMAL,p=t&&t.supportsTangents&&K.TANGENT,E=t&&t.supportsUVs&&K.UV1,u=t&&t.supportsUV2s&&K.UV2,b=t&&t.supportsColors&&K.VERTEXCOLOR;for(let K=0;K<A;K++)z&&C.push("position"+K),j&&C.push("normal"+K),p&&C.push("tangent"+K),E&&C.push("uv_"+K),u&&C.push("uv2_"+K),b&&C.push("color"+K),C.length>e&&m.d.Error("Cannot add more vertex attributes for mesh "+U.name)}}function b(C){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C.push("world0"),C.push("world1"),C.push("world2"),C.push("world3"),U&&(C.push("previousWorld0"),C.push("previousWorld1"),C.push("previousWorld2"),C.push("previousWorld3"))}function v(C,U){const K=C.morphTargetManager;C&&K&&U.setFloatArray("morphTargetInfluences",K.influences)}function Q(C,U){U.bindToEffect(C,"Scene")}function V(C,U,K){U._needUVs=!0,U[K]=!0,C.optimizeUVAllocation&&C.getTextureMatrix().isIdentityAs3x2()?(U[K+"DIRECTUV"]=C.coordinatesIndex+1,U["MAINUV"+(C.coordinatesIndex+1)]=!0):U[K+"DIRECTUV"]=0}function f(C,U,K){const m=C.getTextureMatrix();U.ee(K+"Matrix",m)}function F(C,U,K){K.BAKED_VERTEX_ANIMATION_TEXTURE&&K.INSTANCES&&C.push("bakedVertexAnimationSettingsInstanced")}function Z(C,U,K){var m;if(U&&C&&(C.computeBonesUsingShaders&&U._bonesComputationForcedToCPU&&(C.computeBonesUsingShaders=!1),C.useBones&&C.computeBonesUsingShaders&&C.skeleton)){const O=C.skeleton;if(O.isUsingTextureForMatrices&&U.getUniformIndex("boneTextureWidth")>-1){const K=O.getTransformMatrixTexture(C);U.setTexture("boneSampler",K),U.setFloat("boneTextureWidth",4*(O.bones.length+1))}else{const X=O.getTransformMatrices(C);X&&(U.setMatrices("mBones",X),K&&C.dC().prePassRenderer&&C.dC().prePassRenderer.getIndex(2)&&(K.previousBones[C.uniqueId]||(K.previousBones[C.uniqueId]=X.slice()),U.setMatrices("mPreviousBones",K.previousBones[C.uniqueId]),m=X,K.previousBones[C.uniqueId].set(m)))}}}function P(C,U,K,m,O){let X=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];C._bindLight(U,K,m,O,X)}function H(C,U,K,m){let O=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const X=Math.min(U.lightSources.length,O);for(let A=0;A<X;A++){P(U.lightSources[A],A,C,K,"boolean"===typeof m?m:m.SPECULARTERM,U.receiveShadows)}}function d(C,U,K,m){K.NUM_BONE_INFLUENCERS>0&&(m.addCPUSkinningFallback(0,U),C.push("matricesIndices"),C.push("matricesWeights"),K.NUM_BONE_INFLUENCERS>4&&(C.push("matricesIndicesExtra"),C.push("matricesWeightsExtra")))}function T(C,U){(U.INSTANCES||U.THIN_INSTANCES)&&b(C,!!U.PREPASS_VELOCITY),U.INSTANCESCOLOR&&C.push("instanceColor")}function y(C,U){let K=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,O=0;for(let X=0;X<K&&C["LIGHT"+X];X++)X>0&&(O=m+X,U.addFallback(O,"LIGHT"+X)),C.SHADOWS||(C["SHADOW"+X]&&U.addFallback(m,"SHADOW"+X),C["SHADOWPCF"+X]&&U.addFallback(m,"SHADOWPCF"+X),C["SHADOWPCSS"+X]&&U.addFallback(m,"SHADOWPCSS"+X),C["SHADOWPOISSON"+X]&&U.addFallback(m,"SHADOWPOISSON"+X),C["SHADOWESM"+X]&&U.addFallback(m,"SHADOWESM"+X),C["SHADOWCLOSEESM"+X]&&U.addFallback(m,"SHADOWCLOSEESM"+X));return O++}function a(C,U,K,m,O,X,A){let e=arguments.length>7&&void 0!==arguments[7]&&arguments[7];A._areMiscDirty&&(A.LOGARITHMICDEPTH=K,A.POINTSIZE=m,A.FOG=O&&function(C,U){return U.fogEnabled&&C.applyFog&&0!==U.fogMode}(C,U),A.NONUNIFORMSCALING=C.nonUniformScaling,A.ALPHATEST=X,A.DECAL_AFTER_DETAIL=e)}function r(C,U,K,m){let O=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,X=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!K._areLightsDirty)return K._needNormals;let A=0;const e={needNormals:K._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(C.lightsEnabled&&!X)for(const z of U.lightSources)if(i(C,U,z,A,K,m,e),A++,A===O)break;K.SPECULARTERM=e.specularEnabled,K.SHADOWS=e.shadowEnabled;for(let z=A;z<O;z++)void 0!==K["LIGHT"+z]&&(K["LIGHT"+z]=!1,K["HEMILIGHT"+z]=!1,K["POINTLIGHT"+z]=!1,K["DIRLIGHT"+z]=!1,K["SPOTLIGHT"+z]=!1,K["AREALIGHT"+z]=!1,K["SHADOW"+z]=!1,K["SHADOWCSM"+z]=!1,K["SHADOWCSMDEBUG"+z]=!1,K["SHADOWCSMNUM_CASCADES"+z]=!1,K["SHADOWCSMUSESHADOWMAXZ"+z]=!1,K["SHADOWCSMNOBLEND"+z]=!1,K["SHADOWCSM_RIGHTHANDED"+z]=!1,K["SHADOWPCF"+z]=!1,K["SHADOWPCSS"+z]=!1,K["SHADOWPOISSON"+z]=!1,K["SHADOWESM"+z]=!1,K["SHADOWCLOSEESM"+z]=!1,K["SHADOWCUBE"+z]=!1,K["SHADOWLOWQUALITY"+z]=!1,K["SHADOWMEDIUMQUALITY"+z]=!1);const t=C.getEngine().getCaps();return void 0===K.SHADOWFLOAT&&(e.needRebuild=!0),K.SHADOWFLOAT=e.shadowEnabled&&(t.textureFloatRender&&t.textureFloatLinearFiltering||t.textureHalfFloatRender&&t.textureHalfFloatLinearFiltering),K.LIGHTMAPEXCLUDED=e.lightmapMode,e.needRebuild&&K.rebuild(),e.needNormals}function i(C,U,K,m,O,X,e){switch(e.needNormals=!0,void 0===O["LIGHT"+m]&&(e.needRebuild=!0),O["LIGHT"+m]=!0,O["SPOTLIGHT"+m]=!1,O["HEMILIGHT"+m]=!1,O["POINTLIGHT"+m]=!1,O["DIRLIGHT"+m]=!1,O["AREALIGHT"+m]=!1,K.prepareLightSpecificDefines(O,m),O["LIGHT_FALLOFF_PHYSICAL"+m]=!1,O["LIGHT_FALLOFF_GLTF"+m]=!1,O["LIGHT_FALLOFF_STANDARD"+m]=!1,K.falloffType){case A.e.FALLOFF_GLTF:O["LIGHT_FALLOFF_GLTF"+m]=!0;break;case A.e.FALLOFF_PHYSICAL:O["LIGHT_FALLOFF_PHYSICAL"+m]=!0;break;case A.e.FALLOFF_STANDARD:O["LIGHT_FALLOFF_STANDARD"+m]=!0}if(X&&!K.Pj.equalsFloats(0,0,0)&&(e.specularEnabled=!0),O["SHADOW"+m]=!1,O["SHADOWCSM"+m]=!1,O["SHADOWCSMDEBUG"+m]=!1,O["SHADOWCSMNUM_CASCADES"+m]=!1,O["SHADOWCSMUSESHADOWMAXZ"+m]=!1,O["SHADOWCSMNOBLEND"+m]=!1,O["SHADOWCSM_RIGHTHANDED"+m]=!1,O["SHADOWPCF"+m]=!1,O["SHADOWPCSS"+m]=!1,O["SHADOWPOISSON"+m]=!1,O["SHADOWESM"+m]=!1,O["SHADOWCLOSEESM"+m]=!1,O["SHADOWCUBE"+m]=!1,O["SHADOWLOWQUALITY"+m]=!1,O["SHADOWMEDIUMQUALITY"+m]=!1,U&&U.receiveShadows&&C.shadowsEnabled&&K.shadowEnabled){const U=K.getShadowGenerator(C.activeCamera)??K.getShadowGenerator();if(U){const C=U.getShadowMap();C&&C.renderList&&C.renderList.length>0&&(e.shadowEnabled=!0,U.prepareDefines(O,m))}}K.lightmapMode!=A.e.LIGHTMAP_DEFAULT?(e.lightmapMode=!0,O["LIGHTMAPEXCLUDED"+m]=!0,O["LIGHTMAPNOSPECULAR"+m]=K.lightmapMode==A.e.LIGHTMAP_SHADOWSONLY):(O["LIGHTMAPEXCLUDED"+m]=!1,O["LIGHTMAPNOSPECULAR"+m]=!1)}function D(C,U,K,m,O){let X=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,A=arguments.length>6&&void 0!==arguments[6]&&arguments[6],t=function(C,U){let K=!1;if(C.activeCamera){const m=U.CAMERA_ORTHOGRAPHIC?1:0,O=U.CAMERA_PERSPECTIVE?1:0,X=1===C.activeCamera.mode?1:0,A=0===C.activeCamera.mode?1:0;(m^X||O^A)&&(U.CAMERA_ORTHOGRAPHIC=1===X,U.CAMERA_PERSPECTIVE=1===A,K=!0)}return K}(C,m);!1!==X&&(t=(0,e.j)(K,C,m)),m.DEPTHPREPASS!==!U.getColorWrite()&&(m.DEPTHPREPASS=!m.DEPTHPREPASS,t=!0),m.INSTANCES!==O&&(m.INSTANCES=O,t=!0),m.THIN_INSTANCES!==A&&(m.THIN_INSTANCES=A,t=!0),t&&m.markAsUnprocessed()}function l(C,U,K,m){let O=arguments.length>4&&void 0!==arguments[4]&&arguments[4],X=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],A=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!U._areAttributesDirty&&U._needNormals===U._normals&&U._needUVs===U._uvs)return!1;U._normals=U._needNormals,U._uvs=U._needUVs,U.NORMAL=U._needNormals&&C.isVerticesDataPresent("normal"),U._needNormals&&C.isVerticesDataPresent("tangent")&&(U.TANGENT=!0);for(let e=1;e<=6;++e)U["UV"+e]=!!U._needUVs&&C.isVerticesDataPresent(`uv${1===e?"":e}`);if(K){const K=C.useVertexColors&&C.isVerticesDataPresent("color");U.VERTEXCOLOR=K,U.VERTEXALPHA=C.hasVertexAlpha&&K&&X}return C.isVerticesDataPresent("instanceColor")&&(C.hasInstances||C.hasThinInstances)&&(U.INSTANCESCOLOR=!0),m&&function(C,U){if(C.useBones&&C.computeBonesUsingShaders&&C.skeleton){U.NUM_BONE_INFLUENCERS=C.numBoneInfluencers;const K=void 0!==U.BONETEXTURE;if(C.skeleton.isUsingTextureForMatrices&&K)U.BONETEXTURE=!0;else{U.BonesPerMesh=C.skeleton.bones.length+1,U.BONETEXTURE=!K&&void 0;const m=C.dC().prePassRenderer;if(m&&m.enabled){const K=-1===m.excludedSkinnedMesh.indexOf(C);U.BONES_VELOCITY_ENABLED=K}}}else U.NUM_BONE_INFLUENCERS=0,U.BonesPerMesh=0,void 0!==U.BONETEXTURE&&(U.BONETEXTURE=!1)}(C,U),O&&function(C,U){const K=C.morphTargetManager;K?(U.MORPHTARGETS_UV=K.supportsUVs&&U.UV1,U.MORPHTARGETS_UV2=K.supportsUV2s&&U.UV2,U.MORPHTARGETS_TANGENT=K.supportsTangents&&U.TANGENT,U.MORPHTARGETS_NORMAL=K.supportsNormals&&U.NORMAL,U.MORPHTARGETS_POSITION=K.supportsPositions,U.MORPHTARGETS_COLOR=K.supportsColors,U.MORPHTARGETTEXTURE_HASUVS=K.hasUVs,U.MORPHTARGETTEXTURE_HASUV2S=K.hasUV2s,U.MORPHTARGETTEXTURE_HASTANGENTS=K.hasTangents,U.MORPHTARGETTEXTURE_HASNORMALS=K.hasNormals,U.MORPHTARGETTEXTURE_HASPOSITIONS=K.hasPositions,U.MORPHTARGETTEXTURE_HASCOLORS=K.hasColors,U.NUM_MORPH_INFLUENCERS=K.numMaxInfluencers||K.numInfluencers,U.MORPHTARGETS=U.NUM_MORPH_INFLUENCERS>0,U.MORPHTARGETS_TEXTURE=K.isUsingTextureForTargets):(U.MORPHTARGETS_UV=!1,U.MORPHTARGETS_UV2=!1,U.MORPHTARGETS_TANGENT=!1,U.MORPHTARGETS_NORMAL=!1,U.MORPHTARGETS_POSITION=!1,U.MORPHTARGETS_COLOR=!1,U.MORPHTARGETTEXTURE_HASUVS=!1,U.MORPHTARGETTEXTURE_HASUV2S=!1,U.MORPHTARGETTEXTURE_HASTANGENTS=!1,U.MORPHTARGETTEXTURE_HASNORMALS=!1,U.MORPHTARGETTEXTURE_HASPOSITIONS=!1,U.MORPHTARGETTEXTURE_HAS_COLORS=!1,U.MORPHTARGETS=!1,U.NUM_MORPH_INFLUENCERS=0)}(C,U),A&&function(C,U){const K=C.bakedVertexAnimationManager;U.BAKED_VERTEX_ANIMATION_TEXTURE=!(!K||!K.isEnabled)}(C,U),!0}function G(C,U){if(C.activeCamera){const K=U.MULTIVIEW;U.MULTIVIEW=null!==C.activeCamera.outputRenderTarget&&C.activeCamera.outputRenderTarget.getViewCount()>1,U.MULTIVIEW!=K&&U.markAsUnprocessed()}}function J(C,U,K){const m=U.ORDER_INDEPENDENT_TRANSPARENCY,O=U.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;U.ORDER_INDEPENDENT_TRANSPARENCY=C.useOrderIndependentTransparency&&K,U.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!C.getEngine().getCaps().textureFloatLinearFiltering,m===U.ORDER_INDEPENDENT_TRANSPARENCY&&O===U.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||U.markAsUnprocessed()}function o(C,U,K){const m=U.PREPASS;if(!U._arePrePassDirty)return;const O=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(C.prePassRenderer&&C.prePassRenderer.enabled&&K){U.PREPASS=!0,U.SCENE_MRT_COUNT=C.prePassRenderer.mrtCount,U.PREPASS_NORMAL_WORLDSPACE=C.prePassRenderer.generateNormalsInWorldSpace,U.PREPASS_COLOR=!0,U.PREPASS_COLOR_INDEX=0;for(let K=0;K<O.length;K++){const m=C.prePassRenderer.getIndex(O[K].type);-1!==m?(U[O[K].define]=!0,U[O[K].index]=m):U[O[K].define]=!1}}else{U.PREPASS=!1;for(let C=0;C<O.length;C++)U[O[C].define]=!1}U.PREPASS!=m&&(U.markAsUnprocessed(),U.markAsImageProcessingDirty())}function B(C,U,K,m){let O=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,X=arguments.length>5&&void 0!==arguments[5]&&arguments[5],A=arguments.length>6&&void 0!==arguments[6]&&arguments[6];O&&O.push("Light"+C),X||(U.push("vLightData"+C,"vLightDiffuse"+C,"vLightSpecular"+C,"vLightDirection"+C,"vLightWidth"+C,"vLightHeight"+C,"vLightFalloff"+C,"vLightGround"+C,"lightMatrix"+C,"shadowsInfo"+C,"depthValues"+C),K.push("shadowTexture"+C),K.push("depthTexture"+C),U.push("viewFrustumZ"+C,"cascadeBlendFactor"+C,"lightSizeUVCorrection"+C,"depthCorrection"+C,"penumbraDarkness"+C,"frustumLengths"+C),m&&(K.push("projectionLightTexture"+C),U.push("textureProjectionMatrix"+C)),A&&K.push("iesLightTexture"+C))}function k(C,U,K){let m,O,X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(C.uniformsNames){const A=C;m=A.uniformsNames,O=A.uniformBuffersNames,U=A.samplers,K=A.defines,X=A.maxSimultaneousLights||0}else m=C,U||(U=[]);for(let A=0;A<X&&K["LIGHT"+A];A++)B(A,m,U,K["PROJECTEDLIGHTTEXTURE"+A],O,!1,K["IESLIGHTTEXTURE"+A]);K.NUM_MORPH_INFLUENCERS&&(m.push("morphTargetInfluences"),m.push("morphTargetCount")),K.BAKED_VERTEX_ANIMATION_TEXTURE&&(m.push("bakedVertexAnimationSettings"),m.push("bakedVertexAnimationTextureSizeInverted"),m.push("bakedVertexAnimationTime"),U.push("bakedVertexAnimationTexture"))}},12150:(C,U,K)=>{K.d(U,{b:()=>X});var m=K(11827),O=K(12158);class X extends O.e{constructor(C,U){let K=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(C,U,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new m.Matrix,this._storeEffectOnSubMeshes=K}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(C,U){return!!C&&(!this._storeEffectOnSubMeshes||(!C.me||0===C.me.length||this.isReadyForSubMesh(C,C.me[0],U)))}_isReadyForSubMesh(C){const U=C.materialDefines;return!(this.checkReadyOnEveryCall||!C.effect||!U||U._renderId!==this.dC().getRenderId())}bindOnlyWorldMatrix(C){this._activeEffect.setMatrix("world",C)}bindOnlyNormalMatrix(C){this._activeEffect.setMatrix("normalMatrix",C)}bind(C,U){U&&this.bindForSubMesh(C,U,U.me[0])}_afterBind(C){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,K=arguments.length>2?arguments[2]:void 0;super._afterBind(C,U,K),this.dC()._cachedEffect=U,K?K._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(C,U,K){let m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return K._drawWrapper._forceRebindOnNextCall||C.isCachedMaterialInvalid(this,U,m)}dispose(C,U,K){this._activeEffect=void 0,super.dispose(C,U,K)}}},12189:(C,U,K)=>{K.d(U,{b:()=>e,e:()=>t});var m=K(11810),O=K(11827),X=K(11818);class A{static extractMinAndMaxIndexed(C,U,K,m,O,X){for(let A=K;A<K+m;A++){const K=3*U[A],m=C[K],e=C[K+1],t=C[K+2];O.minimizeInPlaceFromFloats(m,e,t),X.maximizeInPlaceFromFloats(m,e,t)}}static extractMinAndMax(C,U,K,m,O,X){for(let A=U,e=U*m;A<U+K;A++,e+=m){const U=C[e],K=C[e+1],m=C[e+2];O.minimizeInPlaceFromFloats(U,K,m),X.maximizeInPlaceFromFloats(U,K,m)}}}function e(C,U,K,m){let X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const e=new O.bU(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t=new O.bU(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return A.extractMinAndMaxIndexed(C,U,K,m,e,t),X&&(e.x-=e.x*X.x+X.y,e.y-=e.y*X.x+X.y,e.z-=e.z*X.x+X.y,t.x+=t.x*X.x+X.y,t.y+=t.y*X.x+X.y,t.z+=t.z*X.x+X.y),{minimum:e,maximum:t}}function t(C,U,K){let m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,X=arguments.length>4?arguments[4]:void 0;const e=new O.bU(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t=new O.bU(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return X||(X=3),A.extractMinAndMax(C,U,K,X,e,t),m&&(e.x-=e.x*m.x+m.y,e.y-=e.y*m.x+m.y,e.z-=e.z*m.x+m.y,t.x+=t.x*m.x+m.y,t.y+=t.y*m.x+m.y,t.z+=t.z*m.x+m.y),{minimum:e,maximum:t}}(0,m.d)([X.g.filter((function(){for(var C=arguments.length,U=new Array(C),K=0;K<C;K++)U[K]=arguments[K];let[m,O]=U;return!Array.isArray(m)&&!Array.isArray(O)}))],A,"extractMinAndMaxIndexed",null),(0,m.d)([X.g.filter((function(){for(var C=arguments.length,U=new Array(C),K=0;K<C;K++)U[K]=arguments[K];let[m]=U;return!Array.isArray(m)}))],A,"extractMinAndMax",null)},12160:(C,U,K)=>{K.d(U,{d:()=>t});var m=K(11905),O=K(12169),X=K(12178),A=K(12189),e=K(11947);class t{get materialDefines(){var C;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(C=this._getDrawWrapper())||void 0===C?void 0:C.defines}set materialDefines(C){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=C}_getDrawWrapper(C){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C=C??this._engine.currentRenderPassId;let K=this._drawWrappers[C];return!K&&U&&(this._drawWrappers[C]=K=new e.d(this._mesh.dC().getEngine())),K}_removeDrawWrapper(C){let U=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var K;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(K=this._drawWrappers[C])||void 0===K||K.dispose(U));this._drawWrappers[C]=void 0}get effect(){var C;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(C=this._getDrawWrapper())||void 0===C?void 0:C.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(C){this._mainDrawWrapperOverride=C}setEffect(C){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,K=arguments.length>2?arguments[2]:void 0,m=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const O=this._drawWrapper;O.setEffect(C,U,m),void 0!==K&&(O.materialContext=K),C||(O.defines=null,O.materialContext=void 0)}resetDrawCache(C){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==C)return void this._removeDrawWrapper(C,!0,U);for(const C of this._drawWrappers)null===C||void 0===C||C.dispose(U)}this._drawWrappers=[]}static AddToMesh(C,U,K,m,O,X,A){return new t(C,U,K,m,O,X,A,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(C,U,K,m,O,X,A){let e=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],t=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=C,this.verticesStart=U,this.verticesCount=K,this.indexStart=m,this.indexCount=O,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=X,this._renderingMesh=A||X,t&&X.me.push(this),this._engine=this._mesh.dC().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=X.me.length-1,e&&(this.refreshBoundingInfo(),X.te(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(C){return this._boundingInfo=C,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const C=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return C||this._renderingMesh}kC(){let C=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const U=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!U)return C&&this._mesh.dC()._hasDefaultMaterial?this._mesh.dC().defaultMaterial:null;if(this._isMultiMaterial(U)){const C=U.getSubMaterial(this.materialIndex);return this._currentMaterial!==C&&(this._currentMaterial=C,this.resetDrawCache()),C}return U}_isMultiMaterial(C){return void 0!==C.getSubMaterial}refreshBoundingInfo(){let C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.ze)return this;if(C||(C=this._renderingMesh.getVerticesData(m.d.PositionKind)),!C)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const U=this._renderingMesh.je();let K;if(0===this.indexStart&&this.indexCount===U.length){const C=this._renderingMesh.getBoundingInfo();K={minimum:C.minimum.clone(),maximum:C.maximum.clone()}}else K=(0,A.b)(C,U,this.indexStart,this.indexCount,this._renderingMesh.ze.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(K.minimum,K.maximum):this._boundingInfo=new X.d(K.minimum,K.maximum),this}_checkCollision(C){return this.getBoundingInfo()._checkCollision(C)}updateBoundingInfo(C){let U=this.getBoundingInfo();return U||(this.refreshBoundingInfo(),U=this.getBoundingInfo()),U&&U.update(C),this}isInFrustum(C){const U=this.getBoundingInfo();return!!U&&U.isInFrustum(C,this._mesh.Hp)}isCompletelyInFrustum(C){const U=this.getBoundingInfo();return!!U&&U.isCompletelyInFrustum(C)}render(C){return this._renderingMesh.render(this,C,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(C,U){if(!this._linesIndexBuffer){const K=6*Math.floor(this.indexCount/3),m=this.verticesStart+this.verticesCount>65535?new Uint32Array(K):new Uint16Array(K);let O=0;if(0===C.length)for(let C=this.indexStart;C<this.indexStart+this.indexCount;C+=3)m[O++]=C,m[O++]=C+1,m[O++]=C+1,m[O++]=C+2,m[O++]=C+2,m[O++]=C;else for(let U=this.indexStart;U<this.indexStart+this.indexCount;U+=3)m[O++]=C[U],m[O++]=C[U+1],m[O++]=C[U+1],m[O++]=C[U+2],m[O++]=C[U+2],m[O++]=C[U];this._linesIndexBuffer=U.createIndexBuffer(m),this._linesIndexCount=m.length}return this._linesIndexBuffer}canIntersects(C){const U=this.getBoundingInfo();return!!U&&C.intersectsBox(U.boundingBox)}intersects(C,U,K,m,O){const X=this.kC();if(!X)return null;let A=3,e=!1;switch(X.fillMode){case 3:case 5:case 6:case 8:return null;case 7:A=1,e=!0}return 4===X.fillMode?K.length?this._intersectLines(C,U,K,this._mesh.intersectionThreshold,m):this._intersectUnIndexedLines(C,U,K,this._mesh.intersectionThreshold,m):!K.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(C,U,K,m,O):this._intersectTriangles(C,U,K,A,e,m,O)}_intersectLines(C,U,K,m,X){let A=null;for(let e=this.indexStart;e<this.indexStart+this.indexCount;e+=2){const t=U[K[e]],z=U[K[e+1]],j=C.intersectionSegment(t,z,m);if(!(j<0)&&((X||!A||j<A.distance)&&(A=new O.c(null,null,j),A.faceId=e/2,X)))break}return A}_intersectUnIndexedLines(C,U,K,m,X){let A=null;for(let e=this.verticesStart;e<this.verticesStart+this.verticesCount;e+=2){const K=U[e],t=U[e+1],z=C.intersectionSegment(K,t,m);if(!(z<0)&&((X||!A||z<A.distance)&&(A=new O.c(null,null,z),A.faceId=e/2,X)))break}return A}_intersectTriangles(C,U,K,m,O,X,A){let e=null,t=-1;for(let z=this.indexStart;z<this.indexStart+this.indexCount-(3-m);z+=m){t++;const m=K[z],j=K[z+1],p=K[z+2];if(O&&4294967295===p){z+=2;continue}const E=U[m],u=U[j],b=U[p];if(!E||!u||!b)continue;if(A&&!A(E,u,b,C,m,j,p))continue;const v=C.intersectsTriangle(E,u,b);if(v){if(v.distance<0)continue;if((X||!e||v.distance<e.distance)&&(e=v,e.faceId=t,X))break}}return e}_intersectUnIndexedTriangles(C,U,K,m,O){let X=null;for(let A=this.verticesStart;A<this.verticesStart+this.verticesCount;A+=3){const K=U[A],e=U[A+1],t=U[A+2];if(O&&!O(K,e,t,C,-1,-1,-1))continue;const z=C.intersectsTriangle(K,e,t);if(z){if(z.distance<0)continue;if((m||!X||z.distance<X.distance)&&(X=z,X.faceId=A/3,m))break}}return X}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(C,U){const K=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,C,U,!1);if(!this.IsGlobal){const C=this.getBoundingInfo();if(!C)return K;K._boundingInfo=new X.d(C.minimum,C.maximum)}return K}dispose(){let C=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.dC().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const U=this._mesh.me.indexOf(this);this._mesh.me.splice(U,1),this.resetDrawCache(void 0,C)}getClassName(){return"SubMesh"}static CreateFromIndices(C,U,K,m,O){let X=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],A=Number.MAX_VALUE,e=-Number.MAX_VALUE;const z=(O||m).je();for(let t=U;t<U+K;t++){const C=z[t];C<A&&(A=C),C>e&&(e=C)}return new t(C,A,e-A+1,U,K,m,O,X)}}}}]);