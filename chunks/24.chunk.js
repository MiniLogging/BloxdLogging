"use strict";(self.r00gjvkwa6=self.r00gjvkwa6||[]).push([[24],{11638:(H,O,S)=>{S.d(O,{c:()=>t});class t{constructor(H,O,S){this.bu=H,this.bv=O,this.distance=S,this.faceId=0,this.subMeshId=0}}},11650:(H,O,S)=>{S.d(O,{d:()=>G});var t=S(11310),q=S(11301),p=S(11307);class G{constructor(H,O,S){this.vectors=(0,t.d)(8,q.eO.Zero),this.center=q.eO.Zero(),this.centerWorld=q.eO.Zero(),this.extendSize=q.eO.Zero(),this.extendSizeWorld=q.eO.Zero(),this.directions=(0,t.d)(3,q.eO.Zero),this.vectorsWorld=(0,t.d)(8,q.eO.Zero),this.minimumWorld=q.eO.Zero(),this.maximumWorld=q.eO.Zero(),this.minimum=q.eO.Zero(),this.maximum=q.eO.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(H,O,S)}reConstruct(H,O,S){const t=H.x,p=H.y,G=H.z,U=O.x,V=O.y,w=O.z,o=this.vectors;this.minimum.jU(t,p,G),this.maximum.jU(U,V,w),o[0].jU(t,p,G),o[1].jU(U,V,w),o[2].jU(U,p,G),o[3].jU(t,V,G),o[4].jU(t,p,w),o[5].jU(U,V,G),o[6].jU(t,V,w),o[7].jU(U,p,w),O.addToRef(H,this.center).scaleInPlace(.5),O.subtractToRef(H,this.extendSize).scaleInPlace(.5),this._worldMatrix=S||q.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(H){const O=G._TmpVector3,S=this.maximum.subtractToRef(this.minimum,O[0]),t=S.length();S.normalizeFromLength(t);const q=t*H,p=S.scaleInPlace(.5*q),U=this.center.subtractToRef(p,O[1]),V=this.center.addToRef(p,O[2]);return this.reConstruct(U,V,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(H){const O=this.minimumWorld,S=this.maximumWorld,t=this.directions,p=this.vectorsWorld,G=this.vectors;if(H.isIdentity()){O.t(this.minimum),S.t(this.maximum);for(let H=0;H<8;++H)p[H].t(G[H]);this.extendSizeWorld.t(this.extendSize),this.centerWorld.t(this.center)}else{O.XU(Number.MAX_VALUE),S.XU(-Number.MAX_VALUE);for(let t=0;t<8;++t){const U=p[t];q.eO.TransformCoordinatesToRef(G[t],H,U),O.minimizeInPlace(U),S.maximizeInPlace(U)}S.subtractToRef(O,this.extendSizeWorld).scaleInPlace(.5),S.addToRef(O,this.centerWorld).scaleInPlace(.5)}q.eO.FromArrayToRef(H.m,0,t[0]),q.eO.FromArrayToRef(H.m,4,t[1]),q.eO.FromArrayToRef(H.m,8,t[2]),this._worldMatrix=H}isInFrustum(H){return G.IsInFrustum(this.vectorsWorld,H)}isCompletelyInFrustum(H){return G.IsCompletelyInFrustum(this.vectorsWorld,H)}intersectsPoint(H){const O=this.minimumWorld,S=this.maximumWorld,t=O.x,q=O.y,G=O.z,U=S.x,V=S.y,w=S.z,o=H.x,h=H.y,a=H.z,j=-p.e;return!(U-o<j||j>o-t)&&(!(V-h<j||j>h-q)&&!(w-a<j||j>a-G))}intersectsSphere(H){return G.IntersectsSphere(this.minimumWorld,this.maximumWorld,H.centerWorld,H.radiusWorld)}intersectsMinMax(H,O){const S=this.minimumWorld,t=this.maximumWorld,q=S.x,p=S.y,G=S.z,U=t.x,V=t.y,w=t.z,o=H.x,h=H.y,a=H.z,j=O.x,e=O.y,X=O.z;return!(U<o||q>j)&&(!(V<h||p>e)&&!(w<a||G>X))}dispose(){var H,O;null===(H=this._drawWrapperFront)||void 0===H||H.dispose(),null===(O=this._drawWrapperBack)||void 0===O||O.dispose()}static Intersects(H,O){return H.intersectsMinMax(O.minimumWorld,O.maximumWorld)}static IntersectsSphere(H,O,S,t){const p=G._TmpVector3[0];q.eO.ClampToRef(S,H,O,p);return q.eO.DistanceSquared(S,p)<=t*t}static IsCompletelyInFrustum(H,O){for(let S=0;S<6;++S){const t=O[S];for(let O=0;O<8;++O)if(t.dotCoordinate(H[O])<0)return!1}return!0}static IsInFrustum(H,O){for(let S=0;S<6;++S){let t=!0;const q=O[S];for(let O=0;O<8;++O)if(q.dotCoordinate(H[O])>=0){t=!1;break}if(t)return!1}return!0}}G._TmpVector3=(0,t.d)(3,q.eO.Zero)},11644:(H,O,S)=>{S.d(O,{c:()=>h});var t=S(11310),q=S(11301),p=S(11650),G=S(11658);const U={min:0,max:0},V={min:0,max:0},w=(H,O,S)=>{const t=q.eO.Dot(O.centerWorld,H),p=Math.abs(q.eO.Dot(O.directions[0],H))*O.extendSize.x+Math.abs(q.eO.Dot(O.directions[1],H))*O.extendSize.y+Math.abs(q.eO.Dot(O.directions[2],H))*O.extendSize.z;S.min=t-p,S.max=t+p},o=(H,O,S)=>(w(H,O,U),w(H,S,V),!(U.min>V.max||V.min>U.max));class h{constructor(H,O,S){this._isLocked=!1,this.boundingBox=new p.d(H,O,S),this.boundingSphere=new G.d(H,O,S)}reConstruct(H,O,S){this.boundingBox.reConstruct(H,O,S),this.boundingSphere.reConstruct(H,O,S)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(H){this._isLocked=H}update(H){this._isLocked||(this.boundingBox._update(H),this.boundingSphere._update(H))}centerOn(H,O){const S=h._TmpVector3[0].t(H).Mo(O),t=h._TmpVector3[1].t(H).addInPlace(O);return this.boundingBox.reConstruct(S,t,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(S,t,this.boundingBox.getWorldMatrix()),this}encapsulate(H){const O=q.eO.Minimize(this.minimum,H),S=q.eO.Maximize(this.maximum,H);return this.reConstruct(O,S,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(H){const O=q.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(O);const S=q.TmpVectors.eO[0];return q.eO.TransformCoordinatesToRef(H.boundingBox.minimumWorld,O,S),this.encapsulate(S),q.eO.TransformCoordinatesToRef(H.boundingBox.maximumWorld,O,S),this.encapsulate(S),this}scale(H){return this.boundingBox.scale(H),this.boundingSphere.scale(H),this}isInFrustum(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===O||3===O)&&this.boundingSphere.isCenterInFrustum(H))return!0;if(!this.boundingSphere.isInFrustum(H))return!1;return!(1!==O&&3!==O)||this.boundingBox.isInFrustum(H)}get diagonalLength(){const H=this.boundingBox;return H.maximumWorld.subtractToRef(H.minimumWorld,h._TmpVector3[0]).length()}isCompletelyInFrustum(H){return this.boundingBox.isCompletelyInFrustum(H)}_checkCollision(H){return H._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(H){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(H)&&!!this.boundingBox.intersectsPoint(H))}intersects(H,O){if(!G.d.Intersects(this.boundingSphere,H.boundingSphere))return!1;if(!p.d.Intersects(this.boundingBox,H.boundingBox))return!1;if(!O)return!0;const S=this.boundingBox,t=H.boundingBox;return!!o(S.directions[0],S,t)&&(!!o(S.directions[1],S,t)&&(!!o(S.directions[2],S,t)&&(!!o(t.directions[0],S,t)&&(!!o(t.directions[1],S,t)&&(!!o(t.directions[2],S,t)&&(!!o(q.eO.Cross(S.directions[0],t.directions[0]),S,t)&&(!!o(q.eO.Cross(S.directions[0],t.directions[1]),S,t)&&(!!o(q.eO.Cross(S.directions[0],t.directions[2]),S,t)&&(!!o(q.eO.Cross(S.directions[1],t.directions[0]),S,t)&&(!!o(q.eO.Cross(S.directions[1],t.directions[1]),S,t)&&(!!o(q.eO.Cross(S.directions[1],t.directions[2]),S,t)&&(!!o(q.eO.Cross(S.directions[2],t.directions[0]),S,t)&&(!!o(q.eO.Cross(S.directions[2],t.directions[1]),S,t)&&!!o(q.eO.Cross(S.directions[2],t.directions[2]),S,t))))))))))))))}}h._TmpVector3=(0,t.d)(2,q.eO.Zero)},11658:(H,O,S)=>{S.d(O,{d:()=>p});var t=S(11310),q=S(11301);class p{constructor(H,O,S){this.center=q.eO.Zero(),this.centerWorld=q.eO.Zero(),this.minimum=q.eO.Zero(),this.maximum=q.eO.Zero(),this.reConstruct(H,O,S)}reConstruct(H,O,S){this.minimum.t(H),this.maximum.t(O);const t=q.eO.Distance(H,O);O.addToRef(H,this.center).scaleInPlace(.5),this.radius=.5*t,this._update(S||q.Matrix.IdentityReadOnly)}scale(H){const O=this.radius*H,S=p._TmpVector3,t=S[0].XU(O),q=this.center.subtractToRef(t,S[1]),G=this.center.addToRef(t,S[2]);return this.reConstruct(q,G,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(H){if(H.isIdentity())this.centerWorld.t(this.center),this.radiusWorld=this.radius;else{q.eO.TransformCoordinatesToRef(this.center,H,this.centerWorld);const O=p._TmpVector3[0];q.eO.TransformNormalFromFloatsToRef(1,1,1,H,O),this.radiusWorld=Math.max(Math.abs(O.x),Math.abs(O.y),Math.abs(O.z))*this.radius}}isInFrustum(H){const O=this.centerWorld,S=this.radiusWorld;for(let t=0;t<6;t++)if(H[t].dotCoordinate(O)<=-S)return!1;return!0}isCenterInFrustum(H){const O=this.centerWorld;for(let S=0;S<6;S++)if(H[S].dotCoordinate(O)<0)return!1;return!0}intersectsPoint(H){const O=q.eO.DistanceSquared(this.centerWorld,H);return!(this.radiusWorld*this.radiusWorld<O)}static Intersects(H,O){const S=q.eO.DistanceSquared(H.centerWorld,O.centerWorld),t=H.radiusWorld+O.radiusWorld;return!(t*t<S)}static CreateFromCenterAndRadius(H,O,S){this._TmpVector3[0].t(H),this._TmpVector3[1].jU(0,0,O),this._TmpVector3[2].t(H),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].Mo(this._TmpVector3[1]);const t=new p(this._TmpVector3[0],this._TmpVector3[2]);return t._worldMatrix=S||q.Matrix.Identity(),t}}p._TmpVector3=(0,t.d)(3,q.eO.Zero)},11671:(H,O,S)=>{function t(H){-1===H.indexOf("vClipPlane")&&H.push("vClipPlane"),-1===H.indexOf("vClipPlane2")&&H.push("vClipPlane2"),-1===H.indexOf("vClipPlane3")&&H.push("vClipPlane3"),-1===H.indexOf("vClipPlane4")&&H.push("vClipPlane4"),-1===H.indexOf("vClipPlane5")&&H.push("vClipPlane5"),-1===H.indexOf("vClipPlane6")&&H.push("vClipPlane6")}function q(H,O,S){const t=!!(H.clipPlane??O.clipPlane),q=!!(H.clipPlane2??O.clipPlane2),p=!!(H.clipPlane3??O.clipPlane3),G=!!(H.clipPlane4??O.clipPlane4),U=!!(H.clipPlane5??O.clipPlane5),V=!!(H.clipPlane6??O.clipPlane6);t&&S.push("#define CLIPPLANE"),q&&S.push("#define CLIPPLANE2"),p&&S.push("#define CLIPPLANE3"),G&&S.push("#define CLIPPLANE4"),U&&S.push("#define CLIPPLANE5"),V&&S.push("#define CLIPPLANE6")}function p(H,O,S){let t=!1;const q=!!(H.clipPlane??O.clipPlane),p=!!(H.clipPlane2??O.clipPlane2),G=!!(H.clipPlane3??O.clipPlane3),U=!!(H.clipPlane4??O.clipPlane4),V=!!(H.clipPlane5??O.clipPlane5),w=!!(H.clipPlane6??O.clipPlane6);return S.CLIPPLANE!==q&&(S.CLIPPLANE=q,t=!0),S.CLIPPLANE2!==p&&(S.CLIPPLANE2=p,t=!0),S.CLIPPLANE3!==G&&(S.CLIPPLANE3=G,t=!0),S.CLIPPLANE4!==U&&(S.CLIPPLANE4=U,t=!0),S.CLIPPLANE5!==V&&(S.CLIPPLANE5=V,t=!0),S.CLIPPLANE6!==w&&(S.CLIPPLANE6=w,t=!0),t}function G(H,O,S){let t=O.clipPlane??S.clipPlane;U(H,"vClipPlane",t),t=O.clipPlane2??S.clipPlane2,U(H,"vClipPlane2",t),t=O.clipPlane3??S.clipPlane3,U(H,"vClipPlane3",t),t=O.clipPlane4??S.clipPlane4,U(H,"vClipPlane4",t),t=O.clipPlane5??S.clipPlane5,U(H,"vClipPlane5",t),t=O.clipPlane6??S.clipPlane6,U(H,"vClipPlane6",t)}function U(H,O,S){S&&H.setFloat4(O,S.normal.x,S.normal.y,S.normal.z,S.d)}S.d(O,{d:()=>t,g:()=>G,k:()=>p,n:()=>q})},11609:(H,O,S)=>{S.d(O,{c:()=>t});class t{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(H,O){this._defines[H]||(H<this._currentRank&&(this._currentRank=H),H>this._maxRank&&(this._maxRank=H),this._defines[H]=new Array),this._defines[H].push(O)}addCPUSkinningFallback(H,O){this._mesh=O,H<this._currentRank&&(this._currentRank=H),H>this._maxRank&&(this._maxRank=H)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(H,O){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,H=H.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),O._bonesComputationForcedToCPU=!0;const S=this._mesh.YH();for(let H=0;H<S.meshes.length;H++){const t=S.meshes[H];if(t.material){if(t.computeBonesUsingShaders&&0!==t.numBoneInfluencers)if(t.material.getEffect()===O)t.computeBonesUsingShaders=!1;else if(t.qU)for(const H of t.qU){if(H.effect===O){t.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&t.computeBonesUsingShaders&&t.numBoneInfluencers>0&&(t.computeBonesUsingShaders=!1)}}else{const O=this._defines[this._currentRank];if(O)for(let S=0;S<O.length;S++)H=H.replace("#define "+O[S],"");this._currentRank++}return H}}},11624:(H,O,S)=>{S.d(O,{e:()=>E});var t=S(11287),q=S(11289),p=S(11131),G=S(11140),U=S(11180),V=S(11633),w=S(11566),o=S(11151),h=S(11360),a=S(11422),j=S(11338);class e{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(H){this._func=H}get funcRef(){return this._funcRef}set funcRef(H){this._funcRef=H}get funcMask(){return this._funcMask}set funcMask(H){this._funcMask=H}get opStencilFail(){return this._opStencilFail}set opStencilFail(H){this._opStencilFail=H}get opDepthFail(){return this._opDepthFail}set opDepthFail(H){this._opDepthFail=H}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(H){this._opStencilDepthPass=H}get mask(){return this._mask}set mask(H){this._mask=H}get enabled(){return this._enabled}set enabled(H){this._enabled=H}getClassName(){return"MaterialStencilState"}copyTo(H){j.e.Clone((()=>H),this)}serialize(){return j.e.Serialize(this)}parse(H,O,S){j.e.Parse((()=>this),H,O,S)}}(0,t.d)([(0,q.J)()],e.prototype,"func",null),(0,t.d)([(0,q.J)()],e.prototype,"funcRef",null),(0,t.d)([(0,q.J)()],e.prototype,"funcMask",null),(0,t.d)([(0,q.J)()],e.prototype,"opStencilFail",null),(0,t.d)([(0,q.J)()],e.prototype,"opDepthFail",null),(0,t.d)([(0,q.J)()],e.prototype,"opStencilDepthPass",null),(0,t.d)([(0,q.J)()],e.prototype,"mask",null),(0,t.d)([(0,q.J)()],e.prototype,"enabled",null);var X=S(11669);class E{get _supportGlowLayer(){return!1}set _glowModeEnabled(H){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(H){if(this._alpha===H)return;const O=this._alpha;this._alpha=H,1!==O&&1!==H||this.kw(E.MiscDirtyFlag+E.PrePassDirtyFlag)}get alpha(){return this._alpha}set aU(H){this._backFaceCulling!==H&&(this._backFaceCulling=H,this.kw(E.TextureDirtyFlag))}get aU(){return this._backFaceCulling}set cullBackFaces(H){this._cullBackFaces!==H&&(this._cullBackFaces=H,this.kw(E.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(H){this._blockDirtyMechanism!==H&&(this._blockDirtyMechanism=H,H||this.Sa())}atomicMaterialsUpdate(H){this.blockDirtyMechanism=!0;try{H(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(H){this._onDisposeObserver&&this.up.remove(this._onDisposeObserver),this._onDisposeObserver=this.up.add(H)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new G.b),this._onBindObservable}set onBind(H){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(H)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new G.b),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new G.b),this._onEffectCreatedObservable}set alphaMode(H){this._alphaMode!==H&&(this._alphaMode=H,this.kw(E.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(H){this._needDepthPrePass!==H&&(this._needDepthPrePass=H,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(H){this._fogEnabled!==H&&(this._fogEnabled=H,this.kw(E.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case E.WireFrameFillMode:case E.LineListDrawMode:case E.LineLoopDrawMode:case E.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(H){this.fillMode=H?E.WireFrameFillMode:E.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case E.PointFillMode:case E.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(H){this.fillMode=H?E.PointFillMode:E.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(H){this._fillMode!==H&&(this._fillMode=H,this.kw(E.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(H){const O=this.YH().getEngine().getCaps().fragmentDepthSupported;H&&!O&&o.b.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=H&&O,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(H){this._drawWrapper=H}constructor(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.up=new G.b,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new e,this._useUBO=!1,this._fillMode=E.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=H;const q=O||U.c.LastCreatedScene;q&&(this._scene=q,this._dirtyCallbacks={},this._forceGLSL=t,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=H||p.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new a.e(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new w.b(this._scene.getEngine(),void 0,void 0,H),this._useUBO=this.YH().getEngine().supportsUniformBuffers,this._createUniformBuffer(),S||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),E.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var H;const O=this.YH().getEngine();null===(H=this._uniformBuffer)||void 0===H||H.dispose(),O.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new w.b(O,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new w.b(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(H){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.Sa(),this.checkReadyOnlyOnce=!0}unfreeze(){this.Sa(),this.checkReadyOnlyOnce=!1}isReady(H,O){return!0}isReadyForSubMesh(H,O,S){const t=O.materialDefines;return!!t&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=t,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}YH(){return this._scene}_getEffectiveOrientation(H){return null!==this.sideOrientation?this.sideOrientation:H.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(H){this._transparencyMode!==H&&(this._transparencyMode=H,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===E.MATERIAL_ALPHABLEND||this._transparencyMode===E.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===E.MATERIAL_ALPHATEST||this._transparencyMode===E.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===E.MATERIAL_OPAQUE||this._transparencyMode===E.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(H){return this._hasTransparencyMode?this._transparencyModeIsBlend:H.visibility<1||!this._disableAlphaBlending&&(H.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(H){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(H)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}Sa(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=this.YH().meshes;for(const S of O)if(S.qU)for(const O of S.qU)if(O.AH()===this)for(const S of O._drawWrappers)S&&this._materialContext===S.materialContext&&(S._wasPreviouslyReady=!1,S._wasPreviouslyUsingInstances=null,S._forceRebindOnNextCall=H);H&&this.kw(E.AllDirtyFlag)}_preBind(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const S=this._scene.getEngine(),t=(null==O?this.sideOrientation:O)===E.ClockWiseSideOrientation;return S.enableEffect(H||this._getDrawWrapper()),S.setState(this.aU,this.zOffset,!1,t,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),t}bind(H,O){}buildUniformLayout(){const H=this._uniformBuffer;this._eventInfo.ubo=H,this._callbackPluginEventGeneric(8,this._eventInfo),H.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(H,O,S){const t=S._drawWrapper;this._eventInfo.subMesh=S,this._callbackPluginEventBindForSubMesh(this._eventInfo),t._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(H){}bindView(H){this._useUBO?this._needToBindSceneUbo=!0:H.setMatrix("view",this.YH().getViewMatrix())}bindViewProjection(H){this._useUBO?this._needToBindSceneUbo=!0:(H.setMatrix("viewProjection",this.YH().getTransformMatrix()),H.setMatrix("projection",this.YH().getProjectionMatrix()))}bindEyePosition(H,O){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(H,O)}_afterBind(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&O&&(this._needToBindSceneUbo=!1,(0,X.m)(O,this.YH().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=H?H.visibility:1,this._onBindObservable&&H&&this._onBindObservable.notifyObservers(H),this.disableDepthWrite){const H=this._scene.getEngine();this._cachedDepthWriteState=H.getDepthWrite(),H.setDepthWrite(!1)}if(this.disableColorWrite){const H=this._scene.getEngine();this._cachedColorWriteState=H.getColorWrite(),H.setColorWrite(!1)}if(0!==this.depthFunction){const H=this._scene.getEngine();this._cachedDepthFunctionState=H.getDepthFunction()||0,H.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(H){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=H,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(H){return null}_clonePlugins(H,O){const S={};if(this._serializePlugins(S),E._ParsePlugins(S,H,this._scene,O),this.pluginManager)for(const t of this.pluginManager._plugins){const O=H.pluginManager.getPlugin(t.name);O&&t.copyTo(O)}}getBindedMeshes(){if(this.meshMap){const H=[];for(const O in this.meshMap){const S=this.meshMap[O];S&&H.push(S)}return H}return this._scene.meshes.filter((H=>H.material===this))}forceCompilation(H,O,S,t){const q={clipPlane:!1,useInstances:!1,...S},p=this.YH(),G=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const U=()=>{if(!this._scene||!this._scene.getEngine())return;const S=p.clipPlane;if(q.clipPlane&&(p.clipPlane=new h.b(0,0,0,1)),this._storeEffectOnSubMeshes){let S=!0,p=null;if(H.qU){const O=new V.d(0,0,0,0,0,H,void 0,!1,!1);O.materialDefines&&(O.materialDefines._renderId=-1),this.isReadyForSubMesh(H,O,q.useInstances)||(O.effect&&O.effect.getCompilationError()&&O.effect.allFallbacksProcessed()?p=O.effect.getCompilationError():(S=!1,setTimeout(U,16)))}S&&(this.allowShaderHotSwapping=G,p&&t&&t(p),O&&O(this))}else this.isReady()?(this.allowShaderHotSwapping=G,O&&O(this)):setTimeout(U,16);q.clipPlane&&(p.clipPlane=S)};U()}async forceCompilationAsync(H,O){return await new Promise(((S,t)=>{this.forceCompilation(H,(()=>{S()}),O,(H=>{t(H)}))}))}kw(H){this.YH().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(E._DirtyCallbackArray.length=0,H&E.ImageProcessingDirtyFlag&&E._DirtyCallbackArray.push(E._ImageProcessingDirtyCallBack),H&E.TextureDirtyFlag&&E._DirtyCallbackArray.push(E._TextureDirtyCallBack),H&E.LightDirtyFlag&&E._DirtyCallbackArray.push(E._LightsDirtyCallBack),H&E.FresnelDirtyFlag&&E._DirtyCallbackArray.push(E._FresnelDirtyCallBack),H&E.AttributesDirtyFlag&&E._DirtyCallbackArray.push(E._AttributeDirtyCallBack),H&E.MiscDirtyFlag&&E._DirtyCallbackArray.push(E._MiscDirtyCallBack),H&E.PrePassDirtyFlag&&E._DirtyCallbackArray.push(E._PrePassDirtyCallBack),E._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(E._RunDirtyCallBacks),this.YH().resetCachedMaterial())}resetDrawCache(){const H=this.YH().meshes;for(const O of H)if(O.qU)for(const H of O.qU)H.AH()===this&&H.resetDrawCache()}_markAllSubMeshesAsDirty(H){const O=this.YH();if(O.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const S=O.meshes;for(const t of S)if(t.qU)for(const S of t.qU){if((S.AH()||(O._hasDefaultMaterial?O.defaultMaterial:null))===this)for(const O of S._drawWrappers)O&&O.defines&&O.defines.markAllAsDirty&&this._materialContext===O.materialContext&&H(O.defines)}}_markScenePrePassDirty(){if(this.YH().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const H=this.YH().enablePrePassRenderer();H&&H.kw()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(E._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(E._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(E._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(E._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(E._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(E._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(E._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(E._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(E._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(E._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const H=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.up.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(H)}))}}setPrePassRenderer(H){return!1}dispose(H,O,S){const t=this.YH();if(t.stopAnimation(this),t.freeProcessedMaterials(),t.removeMaterial(this),this._eventInfo.forceDisposeTextures=O,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const H=this._parentContainer.materials.indexOf(this);H>-1&&this._parentContainer.materials.splice(H,1),this._parentContainer=null}if(!0!==S)if(this.meshMap)for(const q in this.meshMap){const H=this.meshMap[q];this._disposeMeshResources(H)}else{const H=t.meshes;for(const O of H)this._disposeMeshResources(O)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.up.notifyObservers(this),this.up.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(H){if(!H)return;const O=H.oU,S=H._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(H.qU&&S)for(const q of H.qU){const H=q._drawWrappers;for(let p=0;p<H.length;p++){var t;const G=null===(t=H[p])||void 0===t?void 0:t.effect;if(!G)continue;S[p]===this&&(null===O||void 0===O||O._releaseVertexArrayObject(G),q._removeDrawWrapper(p,!0,!0))}}}else null===O||void 0===O||O._releaseVertexArrayObject(this._drawWrapper.effect);H.material!==this||H.sourceMesh||(H.material=null)}serialize(){const H=j.e.Serialize(this);return H.stencil=this.stencil.serialize(),H.uniqueId=this.uniqueId,this._serializePlugins(H),H}_serializePlugins(H){if(H.plugins={},this.pluginManager)for(const O of this.pluginManager._plugins)O.doNotSerialize||(H.plugins[O.getClassName()]=O.serialize())}static Parse(H,O,S){if(H.customType){if("BABYLON.PBRMaterial"===H.customType&&H.overloadedAlbedo&&(H.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return o.b.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else H.customType="BABYLON.StandardMaterial";const t=p.Tools.Instantiate(H.customType).Parse(H,O,S);return t._loadedUniqueId=H.uniqueId,t}static _ParsePlugins(H,O,S,t){if(H.plugins)for(const U in H.plugins){var q,G;const V=H.plugins[U];let w=null===(q=O.pluginManager)||void 0===q?void 0:q.getPlugin(V.name);if(!w){const H=p.Tools.Instantiate("BABYLON."+U);H&&(w=new H(O))}null===(G=w)||void 0===G||G.parse(V,S,t)}}}E.TriangleFillMode=0,E.WireFrameFillMode=1,E.PointFillMode=2,E.PointListDrawMode=3,E.LineListDrawMode=4,E.LineLoopDrawMode=5,E.LineStripDrawMode=6,E.TriangleStripDrawMode=7,E.TriangleFanDrawMode=8,E.ClockWiseSideOrientation=0,E.CounterClockWiseSideOrientation=1,E.ImageProcessingDirtyFlag=64,E.TextureDirtyFlag=1,E.LightDirtyFlag=2,E.FresnelDirtyFlag=4,E.AttributesDirtyFlag=8,E.MiscDirtyFlag=16,E.PrePassDirtyFlag=32,E.AllDirtyFlag=127,E.MATERIAL_OPAQUE=0,E.MATERIAL_ALPHATEST=1,E.MATERIAL_ALPHABLEND=2,E.MATERIAL_ALPHATESTANDBLEND=3,E.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,E.MATERIAL_NORMALBLENDMETHOD_RNM=1,E.OnEventObservable=new G.b,E._AllDirtyCallBack=H=>H.markAllAsDirty(),E._ImageProcessingDirtyCallBack=H=>H.markAsImageProcessingDirty(),E._TextureDirtyCallBack=H=>H.markAsTexturesDirty(),E._FresnelDirtyCallBack=H=>H.markAsFresnelDirty(),E._MiscDirtyCallBack=H=>H.markAsMiscDirty(),E._PrePassDirtyCallBack=H=>H.markAsPrePassDirty(),E._LightsDirtyCallBack=H=>H.markAsLightDirty(),E._AttributeDirtyCallBack=H=>H.markAsAttributesDirty(),E._FresnelAndMiscDirtyCallBack=H=>{E._FresnelDirtyCallBack(H),E._MiscDirtyCallBack(H)},E._TextureAndMiscDirtyCallBack=H=>{E._TextureDirtyCallBack(H),E._MiscDirtyCallBack(H)},E._DirtyCallbackArray=[],E._RunDirtyCallBacks=H=>{for(const O of E._DirtyCallbackArray)O(H)},(0,t.d)([(0,q.J)()],E.prototype,"id",void 0),(0,t.d)([(0,q.J)()],E.prototype,"uniqueId",void 0),(0,t.d)([(0,q.J)()],E.prototype,"name",void 0),(0,t.d)([(0,q.J)()],E.prototype,"metadata",void 0),(0,t.d)([(0,q.J)()],E.prototype,"checkReadyOnEveryCall",void 0),(0,t.d)([(0,q.J)()],E.prototype,"checkReadyOnlyOnce",void 0),(0,t.d)([(0,q.J)()],E.prototype,"state",void 0),(0,t.d)([(0,q.J)("alpha")],E.prototype,"_alpha",void 0),(0,t.d)([(0,q.J)("aU")],E.prototype,"_backFaceCulling",void 0),(0,t.d)([(0,q.J)("cullBackFaces")],E.prototype,"_cullBackFaces",void 0),(0,t.d)([(0,q.J)()],E.prototype,"sideOrientation",void 0),(0,t.d)([(0,q.J)("alphaMode")],E.prototype,"_alphaMode",void 0),(0,t.d)([(0,q.J)()],E.prototype,"_needDepthPrePass",void 0),(0,t.d)([(0,q.J)()],E.prototype,"disableDepthWrite",void 0),(0,t.d)([(0,q.J)()],E.prototype,"disableColorWrite",void 0),(0,t.d)([(0,q.J)()],E.prototype,"forceDepthWrite",void 0),(0,t.d)([(0,q.J)()],E.prototype,"depthFunction",void 0),(0,t.d)([(0,q.J)()],E.prototype,"separateCullingPass",void 0),(0,t.d)([(0,q.J)("fogEnabled")],E.prototype,"_fogEnabled",void 0),(0,t.d)([(0,q.J)()],E.prototype,"pointSize",void 0),(0,t.d)([(0,q.J)()],E.prototype,"zOffset",void 0),(0,t.d)([(0,q.J)()],E.prototype,"zOffsetUnits",void 0),(0,t.d)([(0,q.J)()],E.prototype,"pointsCloud",null),(0,t.d)([(0,q.J)()],E.prototype,"fillMode",null),(0,t.d)([(0,q.J)()],E.prototype,"useLogarithmicDepth",null),(0,t.d)([(0,q.J)()],E.prototype,"transparencyMode",null)},11669:(H,O,S)=>{S.d(O,{C:()=>j,F:()=>a,H:()=>W,K:()=>r,O:()=>z,P:()=>y,Q:()=>v,S:()=>g,W:()=>N,X:()=>x,Y:()=>A,Z:()=>e,c:()=>b,f:()=>h,g:()=>F,h:()=>o,l:()=>X,m:()=>E,o:()=>T,r:()=>d,u:()=>K,w:()=>Y,y:()=>l});var t=S(11151),q=S(11355),p=S(11180),G=S(11606),U=S(11671);const V=q.TO.Black(),w={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function o(H,O,S){if(!H||H.LOGARITHMICDEPTH||H.indexOf&&H.indexOf("LOGARITHMICDEPTH")>=0){const H=S.activeCamera;1===H.mode&&t.b.Error("Logarithmic depth is not compatible with orthographic cameras!",20),O.setFloat("logarithmicDepthConstant",2/(Math.log(H.maxZ+1)/Math.LN2))}}function h(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]&&arguments[3];S&&H.fogEnabled&&(!O||O.applyFog)&&0!==H.fogMode&&(S.setFloat4("vFogInfos",H.fogMode,H.fogStart,H.fogEnd,H.fogDensity),t?(H.fogColor.toLinearSpaceToRef(V,H.getEngine().useExactSrgbConversions),S.setColor3("vFogColor",V)):S.setColor3("vFogColor",H.fogColor))}function a(H,O,S,t,q,p,G,U,V,o){const h=H.numMaxInfluencers||H.numInfluencers;return h<=0?0:(O.push("#define MORPHTARGETS"),H.hasPositions&&O.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),H.hasNormals&&O.push("#define MORPHTARGETTEXTURE_HASNORMALS"),H.hasTangents&&O.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),H.hasUVs&&O.push("#define MORPHTARGETTEXTURE_HASUVS"),H.hasUV2s&&O.push("#define MORPHTARGETTEXTURE_HASUV2S"),H.hasColors&&O.push("#define MORPHTARGETTEXTURE_HASCOLORS"),H.supportsPositions&&q&&O.push("#define MORPHTARGETS_POSITION"),H.supportsNormals&&p&&O.push("#define MORPHTARGETS_NORMAL"),H.supportsTangents&&G&&O.push("#define MORPHTARGETS_TANGENT"),H.supportsUVs&&U&&O.push("#define MORPHTARGETS_UV"),H.supportsUV2s&&V&&O.push("#define MORPHTARGETS_UV2"),H.supportsColors&&o&&O.push("#define MORPHTARGETS_COLOR"),O.push("#define NUM_MORPH_INFLUENCERS "+h),H.isUsingTextureForTargets&&O.push("#define MORPHTARGETS_TEXTURE"),w.NUM_MORPH_INFLUENCERS=h,w.NORMAL=p,w.TANGENT=G,w.UV=U,w.UV2=V,w.COLOR=o,j(S,t,w,q),h)}function j(H,O,S){let q=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const G=S.NUM_MORPH_INFLUENCERS;if(G>0&&p.c.LastCreatedEngine){const U=p.c.LastCreatedEngine.getCaps().maxVertexAttribs,V=O.morphTargetManager;if(null!==V&&void 0!==V&&V.isUsingTextureForTargets)return;const w=V&&V.supportsPositions&&q,o=V&&V.supportsNormals&&S.NORMAL,h=V&&V.supportsTangents&&S.TANGENT,a=V&&V.supportsUVs&&S.UV1,j=V&&V.supportsUV2s&&S.UV2,e=V&&V.supportsColors&&S.VERTEXCOLOR;for(let S=0;S<G;S++)w&&H.push("position"+S),o&&H.push("normal"+S),h&&H.push("tangent"+S),a&&H.push("uv_"+S),j&&H.push("uv2_"+S),e&&H.push("color"+S),H.length>U&&t.b.Error("Cannot add more vertex attributes for mesh "+O.name)}}function e(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];H.push("world0"),H.push("world1"),H.push("world2"),H.push("world3"),O&&(H.push("previousWorld0"),H.push("previousWorld1"),H.push("previousWorld2"),H.push("previousWorld3"))}function X(H,O){const S=H.morphTargetManager;H&&S&&O.setFloatArray("morphTargetInfluences",S.influences)}function E(H,O){O.bindToEffect(H,"Scene")}function y(H,O,S){O._needUVs=!0,O[S]=!0,H.optimizeUVAllocation&&H.getTextureMatrix().isIdentityAs3x2()?(O[S+"DIRECTUV"]=H.coordinatesIndex+1,O["MAINUV"+(H.coordinatesIndex+1)]=!0):O[S+"DIRECTUV"]=0}function T(H,O,S){const t=H.getTextureMatrix();O.VU(S+"Matrix",t)}function K(H,O,S){S.BAKED_VERTEX_ANIMATION_TEXTURE&&S.INSTANCES&&H.push("bakedVertexAnimationSettingsInstanced")}function b(H,O,S){var t;if(O&&H&&(H.computeBonesUsingShaders&&O._bonesComputationForcedToCPU&&(H.computeBonesUsingShaders=!1),H.useBones&&H.computeBonesUsingShaders&&H.skeleton)){const q=H.skeleton;if(q.isUsingTextureForMatrices&&O.getUniformIndex("boneTextureWidth")>-1){const S=q.getTransformMatrixTexture(H);O.setTexture("boneSampler",S),O.setFloat("boneTextureWidth",4*(q.bones.length+1))}else{const p=q.getTransformMatrices(H);p&&(O.setMatrices("mBones",p),S&&H.YH().prePassRenderer&&H.YH().prePassRenderer.getIndex(2)&&(S.previousBones[H.uniqueId]||(S.previousBones[H.uniqueId]=p.slice()),O.setMatrices("mPreviousBones",S.previousBones[H.uniqueId]),t=p,S.previousBones[H.uniqueId].set(t)))}}}function D(H,O,S,t,q){let p=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];H._bindLight(O,S,t,q,p)}function F(H,O,S,t){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const p=Math.min(O.lightSources.length,q);for(let G=0;G<p;G++){D(O.lightSources[G],G,H,S,"boolean"===typeof t?t:t.SPECULARTERM,O.receiveShadows)}}function Y(H,O,S,t){S.NUM_BONE_INFLUENCERS>0&&(t.addCPUSkinningFallback(0,O),H.push("matricesIndices"),H.push("matricesWeights"),S.NUM_BONE_INFLUENCERS>4&&(H.push("matricesIndicesExtra"),H.push("matricesWeightsExtra")))}function l(H,O){(O.INSTANCES||O.THIN_INSTANCES)&&e(H,!!O.PREPASS_VELOCITY),O.INSTANCESCOLOR&&H.push("instanceColor")}function d(H,O){let S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,q=0;for(let p=0;p<S&&H["LIGHT"+p];p++)p>0&&(q=t+p,O.addFallback(q,"LIGHT"+p)),H.SHADOWS||(H["SHADOW"+p]&&O.addFallback(t,"SHADOW"+p),H["SHADOWPCF"+p]&&O.addFallback(t,"SHADOWPCF"+p),H["SHADOWPCSS"+p]&&O.addFallback(t,"SHADOWPCSS"+p),H["SHADOWPOISSON"+p]&&O.addFallback(t,"SHADOWPOISSON"+p),H["SHADOWESM"+p]&&O.addFallback(t,"SHADOWESM"+p),H["SHADOWCLOSEESM"+p]&&O.addFallback(t,"SHADOWCLOSEESM"+p));return q++}function v(H,O,S,t,q,p,G){let U=arguments.length>7&&void 0!==arguments[7]&&arguments[7];G._areMiscDirty&&(G.LOGARITHMICDEPTH=S,G.POINTSIZE=t,G.FOG=q&&function(H,O){return O.fogEnabled&&H.applyFog&&0!==O.fogMode}(H,O),G.NONUNIFORMSCALING=H.nonUniformScaling,G.ALPHATEST=p,G.DECAL_AFTER_DETAIL=U)}function z(H,O,S,t){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,p=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!S._areLightsDirty)return S._needNormals;let G=0;const U={needNormals:S._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(H.lightsEnabled&&!p)for(const w of O.lightSources)if(m(H,O,w,G,S,t,U),G++,G===q)break;S.SPECULARTERM=U.specularEnabled,S.SHADOWS=U.shadowEnabled;for(let w=G;w<q;w++)void 0!==S["LIGHT"+w]&&(S["LIGHT"+w]=!1,S["HEMILIGHT"+w]=!1,S["POINTLIGHT"+w]=!1,S["DIRLIGHT"+w]=!1,S["SPOTLIGHT"+w]=!1,S["AREALIGHT"+w]=!1,S["SHADOW"+w]=!1,S["SHADOWCSM"+w]=!1,S["SHADOWCSMDEBUG"+w]=!1,S["SHADOWCSMNUM_CASCADES"+w]=!1,S["SHADOWCSMUSESHADOWMAXZ"+w]=!1,S["SHADOWCSMNOBLEND"+w]=!1,S["SHADOWCSM_RIGHTHANDED"+w]=!1,S["SHADOWPCF"+w]=!1,S["SHADOWPCSS"+w]=!1,S["SHADOWPOISSON"+w]=!1,S["SHADOWESM"+w]=!1,S["SHADOWCLOSEESM"+w]=!1,S["SHADOWCUBE"+w]=!1,S["SHADOWLOWQUALITY"+w]=!1,S["SHADOWMEDIUMQUALITY"+w]=!1);const V=H.getEngine().getCaps();return void 0===S.SHADOWFLOAT&&(U.needRebuild=!0),S.SHADOWFLOAT=U.shadowEnabled&&(V.textureFloatRender&&V.textureFloatLinearFiltering||V.textureHalfFloatRender&&V.textureHalfFloatLinearFiltering),S.LIGHTMAPEXCLUDED=U.lightmapMode,U.needRebuild&&S.rebuild(),U.needNormals}function m(H,O,S,t,q,p,U){switch(U.needNormals=!0,void 0===q["LIGHT"+t]&&(U.needRebuild=!0),q["LIGHT"+t]=!0,q["SPOTLIGHT"+t]=!1,q["HEMILIGHT"+t]=!1,q["POINTLIGHT"+t]=!1,q["DIRLIGHT"+t]=!1,q["AREALIGHT"+t]=!1,S.prepareLightSpecificDefines(q,t),q["LIGHT_FALLOFF_PHYSICAL"+t]=!1,q["LIGHT_FALLOFF_GLTF"+t]=!1,q["LIGHT_FALLOFF_STANDARD"+t]=!1,S.falloffType){case G.e.FALLOFF_GLTF:q["LIGHT_FALLOFF_GLTF"+t]=!0;break;case G.e.FALLOFF_PHYSICAL:q["LIGHT_FALLOFF_PHYSICAL"+t]=!0;break;case G.e.FALLOFF_STANDARD:q["LIGHT_FALLOFF_STANDARD"+t]=!0}if(p&&!S.po.equalsFloats(0,0,0)&&(U.specularEnabled=!0),q["SHADOW"+t]=!1,q["SHADOWCSM"+t]=!1,q["SHADOWCSMDEBUG"+t]=!1,q["SHADOWCSMNUM_CASCADES"+t]=!1,q["SHADOWCSMUSESHADOWMAXZ"+t]=!1,q["SHADOWCSMNOBLEND"+t]=!1,q["SHADOWCSM_RIGHTHANDED"+t]=!1,q["SHADOWPCF"+t]=!1,q["SHADOWPCSS"+t]=!1,q["SHADOWPOISSON"+t]=!1,q["SHADOWESM"+t]=!1,q["SHADOWCLOSEESM"+t]=!1,q["SHADOWCUBE"+t]=!1,q["SHADOWLOWQUALITY"+t]=!1,q["SHADOWMEDIUMQUALITY"+t]=!1,O&&O.receiveShadows&&H.shadowsEnabled&&S.shadowEnabled){const O=S.getShadowGenerator(H.activeCamera)??S.getShadowGenerator();if(O){const H=O.getShadowMap();H&&H.renderList&&H.renderList.length>0&&(U.shadowEnabled=!0,O.prepareDefines(q,t))}}S.lightmapMode!=G.e.LIGHTMAP_DEFAULT?(U.lightmapMode=!0,q["LIGHTMAPEXCLUDED"+t]=!0,q["LIGHTMAPNOSPECULAR"+t]=S.lightmapMode==G.e.LIGHTMAP_SHADOWSONLY):(q["LIGHTMAPEXCLUDED"+t]=!1,q["LIGHTMAPNOSPECULAR"+t]=!1)}function r(H,O,S,t,q){let p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,G=arguments.length>6&&void 0!==arguments[6]&&arguments[6],V=function(H,O){let S=!1;if(H.activeCamera){const t=O.CAMERA_ORTHOGRAPHIC?1:0,q=O.CAMERA_PERSPECTIVE?1:0,p=1===H.activeCamera.mode?1:0,G=0===H.activeCamera.mode?1:0;(t^p||q^G)&&(O.CAMERA_ORTHOGRAPHIC=1===p,O.CAMERA_PERSPECTIVE=1===G,S=!0)}return S}(H,t);!1!==p&&(V=(0,U.k)(S,H,t)),t.DEPTHPREPASS!==!O.getColorWrite()&&(t.DEPTHPREPASS=!t.DEPTHPREPASS,V=!0),t.INSTANCES!==q&&(t.INSTANCES=q,V=!0),t.THIN_INSTANCES!==G&&(t.THIN_INSTANCES=G,V=!0),V&&t.markAsUnprocessed()}function W(H,O,S,t){let q=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],G=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!O._areAttributesDirty&&O._needNormals===O._normals&&O._needUVs===O._uvs)return!1;O._normals=O._needNormals,O._uvs=O._needUVs,O.NORMAL=O._needNormals&&H.isVerticesDataPresent("normal"),O._needNormals&&H.isVerticesDataPresent("tangent")&&(O.TANGENT=!0);for(let U=1;U<=6;++U)O["UV"+U]=!!O._needUVs&&H.isVerticesDataPresent(`uv${1===U?"":U}`);if(S){const S=H.useVertexColors&&H.isVerticesDataPresent("color");O.VERTEXCOLOR=S,O.VERTEXALPHA=H.hasVertexAlpha&&S&&p}return H.isVerticesDataPresent("instanceColor")&&(H.hasInstances||H.hasThinInstances)&&(O.INSTANCESCOLOR=!0),t&&function(H,O){if(H.useBones&&H.computeBonesUsingShaders&&H.skeleton){O.NUM_BONE_INFLUENCERS=H.numBoneInfluencers;const S=void 0!==O.BONETEXTURE;if(H.skeleton.isUsingTextureForMatrices&&S)O.BONETEXTURE=!0;else{O.BonesPerMesh=H.skeleton.bones.length+1,O.BONETEXTURE=!S&&void 0;const t=H.YH().prePassRenderer;if(t&&t.enabled){const S=-1===t.excludedSkinnedMesh.indexOf(H);O.BONES_VELOCITY_ENABLED=S}}}else O.NUM_BONE_INFLUENCERS=0,O.BonesPerMesh=0,void 0!==O.BONETEXTURE&&(O.BONETEXTURE=!1)}(H,O),q&&function(H,O){const S=H.morphTargetManager;S?(O.MORPHTARGETS_UV=S.supportsUVs&&O.UV1,O.MORPHTARGETS_UV2=S.supportsUV2s&&O.UV2,O.MORPHTARGETS_TANGENT=S.supportsTangents&&O.TANGENT,O.MORPHTARGETS_NORMAL=S.supportsNormals&&O.NORMAL,O.MORPHTARGETS_POSITION=S.supportsPositions,O.MORPHTARGETS_COLOR=S.supportsColors,O.MORPHTARGETTEXTURE_HASUVS=S.hasUVs,O.MORPHTARGETTEXTURE_HASUV2S=S.hasUV2s,O.MORPHTARGETTEXTURE_HASTANGENTS=S.hasTangents,O.MORPHTARGETTEXTURE_HASNORMALS=S.hasNormals,O.MORPHTARGETTEXTURE_HASPOSITIONS=S.hasPositions,O.MORPHTARGETTEXTURE_HASCOLORS=S.hasColors,O.NUM_MORPH_INFLUENCERS=S.numMaxInfluencers||S.numInfluencers,O.MORPHTARGETS=O.NUM_MORPH_INFLUENCERS>0,O.MORPHTARGETS_TEXTURE=S.isUsingTextureForTargets):(O.MORPHTARGETS_UV=!1,O.MORPHTARGETS_UV2=!1,O.MORPHTARGETS_TANGENT=!1,O.MORPHTARGETS_NORMAL=!1,O.MORPHTARGETS_POSITION=!1,O.MORPHTARGETS_COLOR=!1,O.MORPHTARGETTEXTURE_HASUVS=!1,O.MORPHTARGETTEXTURE_HASUV2S=!1,O.MORPHTARGETTEXTURE_HASTANGENTS=!1,O.MORPHTARGETTEXTURE_HASNORMALS=!1,O.MORPHTARGETTEXTURE_HASPOSITIONS=!1,O.MORPHTARGETTEXTURE_HAS_COLORS=!1,O.MORPHTARGETS=!1,O.NUM_MORPH_INFLUENCERS=0)}(H,O),G&&function(H,O){const S=H.bakedVertexAnimationManager;O.BAKED_VERTEX_ANIMATION_TEXTURE=!(!S||!S.isEnabled)}(H,O),!0}function g(H,O){if(H.activeCamera){const S=O.MULTIVIEW;O.MULTIVIEW=null!==H.activeCamera.outputRenderTarget&&H.activeCamera.outputRenderTarget.getViewCount()>1,O.MULTIVIEW!=S&&O.markAsUnprocessed()}}function N(H,O,S){const t=O.ORDER_INDEPENDENT_TRANSPARENCY,q=O.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;O.ORDER_INDEPENDENT_TRANSPARENCY=H.useOrderIndependentTransparency&&S,O.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!H.getEngine().getCaps().textureFloatLinearFiltering,t===O.ORDER_INDEPENDENT_TRANSPARENCY&&q===O.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||O.markAsUnprocessed()}function x(H,O,S){const t=O.PREPASS;if(!O._arePrePassDirty)return;const q=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(H.prePassRenderer&&H.prePassRenderer.enabled&&S){O.PREPASS=!0,O.SCENE_MRT_COUNT=H.prePassRenderer.mrtCount,O.PREPASS_NORMAL_WORLDSPACE=H.prePassRenderer.generateNormalsInWorldSpace,O.PREPASS_COLOR=!0,O.PREPASS_COLOR_INDEX=0;for(let S=0;S<q.length;S++){const t=H.prePassRenderer.getIndex(q[S].type);-1!==t?(O[q[S].define]=!0,O[q[S].index]=t):O[q[S].define]=!1}}else{O.PREPASS=!1;for(let H=0;H<q.length;H++)O[q[H].define]=!1}O.PREPASS!=t&&(O.markAsUnprocessed(),O.markAsImageProcessingDirty())}function k(H,O,S,t){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=arguments.length>5&&void 0!==arguments[5]&&arguments[5],G=arguments.length>6&&void 0!==arguments[6]&&arguments[6];q&&q.push("Light"+H),p||(O.push("vLightData"+H,"vLightDiffuse"+H,"vLightSpecular"+H,"vLightDirection"+H,"vLightWidth"+H,"vLightHeight"+H,"vLightFalloff"+H,"vLightGround"+H,"lightMatrix"+H,"shadowsInfo"+H,"depthValues"+H),S.push("shadowTexture"+H),S.push("depthTexture"+H),O.push("viewFrustumZ"+H,"cascadeBlendFactor"+H,"lightSizeUVCorrection"+H,"depthCorrection"+H,"penumbraDarkness"+H,"frustumLengths"+H),t&&(S.push("projectionLightTexture"+H),O.push("textureProjectionMatrix"+H)),G&&S.push("iesLightTexture"+H))}function A(H,O,S){let t,q,p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(H.uniformsNames){const G=H;t=G.uniformsNames,q=G.uniformBuffersNames,O=G.samplers,S=G.defines,p=G.maxSimultaneousLights||0}else t=H,O||(O=[]);for(let G=0;G<p&&S["LIGHT"+G];G++)k(G,t,O,S["PROJECTEDLIGHTTEXTURE"+G],q,!1,S["IESLIGHTTEXTURE"+G]);S.NUM_MORPH_INFLUENCERS&&(t.push("morphTargetInfluences"),t.push("morphTargetCount")),S.BAKED_VERTEX_ANIMATION_TEXTURE&&(t.push("bakedVertexAnimationSettings"),t.push("bakedVertexAnimationTextureSizeInverted"),t.push("bakedVertexAnimationTime"),O.push("bakedVertexAnimationTexture"))}},11615:(H,O,S)=>{S.d(O,{c:()=>p});var t=S(11301),q=S(11624);class p extends q.e{constructor(H,O){let S=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(H,O,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new t.Matrix,this._storeEffectOnSubMeshes=S}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(H,O){return!!H&&(!this._storeEffectOnSubMeshes||(!H.qU||0===H.qU.length||this.isReadyForSubMesh(H,H.qU[0],O)))}_isReadyForSubMesh(H){const O=H.materialDefines;return!(this.checkReadyOnEveryCall||!H.effect||!O||O._renderId!==this.YH().getRenderId())}bindOnlyWorldMatrix(H){this._activeEffect.setMatrix("world",H)}bindOnlyNormalMatrix(H){this._activeEffect.setMatrix("normalMatrix",H)}bind(H,O){O&&this.bindForSubMesh(H,O,O.qU[0])}_afterBind(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,S=arguments.length>2?arguments[2]:void 0;super._afterBind(H,O,S),this.YH()._cachedEffect=O,S?S._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return S._drawWrapper._forceRebindOnNextCall||H.isCachedMaterialInvalid(this,O,t)}dispose(H,O,S){this._activeEffect=void 0,super.dispose(H,O,S)}}},11667:(H,O,S)=>{S.d(O,{c:()=>U,g:()=>V});var t=S(11287),q=S(11301),p=S(11289);class G{static extractMinAndMaxIndexed(H,O,S,t,q,p){for(let G=S;G<S+t;G++){const S=3*O[G],t=H[S],U=H[S+1],V=H[S+2];q.minimizeInPlaceFromFloats(t,U,V),p.maximizeInPlaceFromFloats(t,U,V)}}static extractMinAndMax(H,O,S,t,q,p){for(let G=O,U=O*t;G<O+S;G++,U+=t){const O=H[U],S=H[U+1],t=H[U+2];q.minimizeInPlaceFromFloats(O,S,t),p.maximizeInPlaceFromFloats(O,S,t)}}}function U(H,O,S,t){let p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const U=new q.eO(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),V=new q.eO(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return G.extractMinAndMaxIndexed(H,O,S,t,U,V),p&&(U.x-=U.x*p.x+p.y,U.y-=U.y*p.x+p.y,U.z-=U.z*p.x+p.y,V.x+=V.x*p.x+p.y,V.y+=V.y*p.x+p.y,V.z+=V.z*p.x+p.y),{minimum:U,maximum:V}}function V(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4?arguments[4]:void 0;const U=new q.eO(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),V=new q.eO(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return p||(p=3),G.extractMinAndMax(H,O,S,p,U,V),t&&(U.x-=U.x*t.x+t.y,U.y-=U.y*t.x+t.y,U.z-=U.z*t.x+t.y,V.x+=V.x*t.x+t.y,V.y+=V.y*t.x+t.y,V.z+=V.z*t.x+t.y),{minimum:U,maximum:V}}(0,t.d)([p.h.filter((function(){for(var H=arguments.length,O=new Array(H),S=0;S<H;S++)O[S]=arguments[S];let[t,q]=O;return!Array.isArray(t)&&!Array.isArray(q)}))],G,"extractMinAndMaxIndexed",null),(0,t.d)([p.h.filter((function(){for(var H=arguments.length,O=new Array(H),S=0;S<H;S++)O[S]=arguments[S];let[t]=O;return!Array.isArray(t)}))],G,"extractMinAndMax",null)},11633:(H,O,S)=>{S.d(O,{d:()=>V});var t=S(11378),q=S(11638),p=S(11644),G=S(11667),U=S(11422);class V{get materialDefines(){var H;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(H=this._getDrawWrapper())||void 0===H?void 0:H.defines}set materialDefines(H){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=H}_getDrawWrapper(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];H=H??this._engine.currentRenderPassId;let S=this._drawWrappers[H];return!S&&O&&(this._drawWrappers[H]=S=new U.e(this._mesh.YH().getEngine())),S}_removeDrawWrapper(H){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var S;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(S=this._drawWrappers[H])||void 0===S||S.dispose(O));this._drawWrappers[H]=void 0}get effect(){var H;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(H=this._getDrawWrapper())||void 0===H?void 0:H.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(H){this._mainDrawWrapperOverride=H}setEffect(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,S=arguments.length>2?arguments[2]:void 0,t=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const q=this._drawWrapper;q.setEffect(H,O,t),void 0!==S&&(q.materialContext=S),H||(q.defines=null,q.materialContext=void 0)}resetDrawCache(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==H)return void this._removeDrawWrapper(H,!0,O);for(const H of this._drawWrappers)null===H||void 0===H||H.dispose(O)}this._drawWrappers=[]}static AddToMesh(H,O,S,t,q,p,G){return new V(H,O,S,t,q,p,G,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(H,O,S,t,q,p,G){let U=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],V=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=H,this.verticesStart=O,this.verticesCount=S,this.indexStart=t,this.indexCount=q,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=p,this._renderingMesh=G||p,V&&p.qU.push(this),this._engine=this._mesh.YH().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=p.qU.length-1,U&&(this.refreshBoundingInfo(),p.wU(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(H){return this._boundingInfo=H,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const H=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return H||this._renderingMesh}AH(){let H=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const O=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!O)return H&&this._mesh.YH()._hasDefaultMaterial?this._mesh.YH().defaultMaterial:null;if(this._isMultiMaterial(O)){const H=O.getSubMaterial(this.materialIndex);return this._currentMaterial!==H&&(this._currentMaterial=H,this.resetDrawCache()),H}return O}_isMultiMaterial(H){return void 0!==H.getSubMaterial}refreshBoundingInfo(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.oU)return this;if(H||(H=this._renderingMesh.getVerticesData(t.h.PositionKind)),!H)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const O=this._renderingMesh.hU();let S;if(0===this.indexStart&&this.indexCount===O.length){const H=this._renderingMesh.getBoundingInfo();S={minimum:H.minimum.clone(),maximum:H.maximum.clone()}}else S=(0,G.c)(H,O,this.indexStart,this.indexCount,this._renderingMesh.oU.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(S.minimum,S.maximum):this._boundingInfo=new p.c(S.minimum,S.maximum),this}_checkCollision(H){return this.getBoundingInfo()._checkCollision(H)}updateBoundingInfo(H){let O=this.getBoundingInfo();return O||(this.refreshBoundingInfo(),O=this.getBoundingInfo()),O&&O.update(H),this}isInFrustum(H){const O=this.getBoundingInfo();return!!O&&O.isInFrustum(H,this._mesh.eh)}isCompletelyInFrustum(H){const O=this.getBoundingInfo();return!!O&&O.isCompletelyInFrustum(H)}render(H){return this._renderingMesh.render(this,H,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(H,O){if(!this._linesIndexBuffer){const S=6*Math.floor(this.indexCount/3),t=this.verticesStart+this.verticesCount>65535?new Uint32Array(S):new Uint16Array(S);let q=0;if(0===H.length)for(let H=this.indexStart;H<this.indexStart+this.indexCount;H+=3)t[q++]=H,t[q++]=H+1,t[q++]=H+1,t[q++]=H+2,t[q++]=H+2,t[q++]=H;else for(let O=this.indexStart;O<this.indexStart+this.indexCount;O+=3)t[q++]=H[O],t[q++]=H[O+1],t[q++]=H[O+1],t[q++]=H[O+2],t[q++]=H[O+2],t[q++]=H[O];this._linesIndexBuffer=O.createIndexBuffer(t),this._linesIndexCount=t.length}return this._linesIndexBuffer}canIntersects(H){const O=this.getBoundingInfo();return!!O&&H.intersectsBox(O.boundingBox)}intersects(H,O,S,t,q){const p=this.AH();if(!p)return null;let G=3,U=!1;switch(p.fillMode){case 3:case 5:case 6:case 8:return null;case 7:G=1,U=!0}return 4===p.fillMode?S.length?this._intersectLines(H,O,S,this._mesh.intersectionThreshold,t):this._intersectUnIndexedLines(H,O,S,this._mesh.intersectionThreshold,t):!S.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(H,O,S,t,q):this._intersectTriangles(H,O,S,G,U,t,q)}_intersectLines(H,O,S,t,p){let G=null;for(let U=this.indexStart;U<this.indexStart+this.indexCount;U+=2){const V=O[S[U]],w=O[S[U+1]],o=H.intersectionSegment(V,w,t);if(!(o<0)&&((p||!G||o<G.distance)&&(G=new q.c(null,null,o),G.faceId=U/2,p)))break}return G}_intersectUnIndexedLines(H,O,S,t,p){let G=null;for(let U=this.verticesStart;U<this.verticesStart+this.verticesCount;U+=2){const S=O[U],V=O[U+1],w=H.intersectionSegment(S,V,t);if(!(w<0)&&((p||!G||w<G.distance)&&(G=new q.c(null,null,w),G.faceId=U/2,p)))break}return G}_intersectTriangles(H,O,S,t,q,p,G){let U=null,V=-1;for(let w=this.indexStart;w<this.indexStart+this.indexCount-(3-t);w+=t){V++;const t=S[w],o=S[w+1],h=S[w+2];if(q&&4294967295===h){w+=2;continue}const a=O[t],j=O[o],e=O[h];if(!a||!j||!e)continue;if(G&&!G(a,j,e,H,t,o,h))continue;const X=H.intersectsTriangle(a,j,e);if(X){if(X.distance<0)continue;if((p||!U||X.distance<U.distance)&&(U=X,U.faceId=V,p))break}}return U}_intersectUnIndexedTriangles(H,O,S,t,q){let p=null;for(let G=this.verticesStart;G<this.verticesStart+this.verticesCount;G+=3){const S=O[G],U=O[G+1],V=O[G+2];if(q&&!q(S,U,V,H,-1,-1,-1))continue;const w=H.intersectsTriangle(S,U,V);if(w){if(w.distance<0)continue;if((t||!p||w.distance<p.distance)&&(p=w,p.faceId=G/3,t))break}}return p}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(H,O){const S=new V(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,H,O,!1);if(!this.IsGlobal){const H=this.getBoundingInfo();if(!H)return S;S._boundingInfo=new p.c(H.minimum,H.maximum)}return S}dispose(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.YH().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const O=this._mesh.qU.indexOf(this);this._mesh.qU.splice(O,1),this.resetDrawCache(void 0,H)}getClassName(){return"SubMesh"}static CreateFromIndices(H,O,S,t,q){let p=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],G=Number.MAX_VALUE,U=-Number.MAX_VALUE;const w=(q||t).hU();for(let V=O;V<O+S;V++){const H=w[V];H<G&&(G=H),H>U&&(U=H)}return new V(H,G,U-G+1,O,S,t,q,p)}}}}]);