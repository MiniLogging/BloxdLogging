"use strict";(self.k9ivgwsw3f=self.k9ivgwsw3f||[]).push([[24],{13153:(Y,b,C)=>{C.d(b,{b:()=>R});class R{constructor(Y,b,C){this.bu=Y,this.bv=b,this.distance=C,this.faceId=0,this.subMeshId=0}}},13159:(Y,b,C)=>{C.d(b,{b:()=>E});var R=C(12846),q=C(12831),A=C(12837);class E{constructor(Y,b,C){this.vectors=(0,R.e)(8,q.AC.Zero),this.center=q.AC.Zero(),this.centerWorld=q.AC.Zero(),this.extendSize=q.AC.Zero(),this.extendSizeWorld=q.AC.Zero(),this.directions=(0,R.e)(3,q.AC.Zero),this.vectorsWorld=(0,R.e)(8,q.AC.Zero),this.minimumWorld=q.AC.Zero(),this.maximumWorld=q.AC.Zero(),this.minimum=q.AC.Zero(),this.maximum=q.AC.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(Y,b,C)}reConstruct(Y,b,C){const R=Y.x,A=Y.y,E=Y.z,B=b.x,g=b.y,r=b.z,O=this.vectors;this.minimum.Ub(R,A,E),this.maximum.Ub(B,g,r),O[0].Ub(R,A,E),O[1].Ub(B,g,r),O[2].Ub(B,A,E),O[3].Ub(R,g,E),O[4].Ub(R,A,r),O[5].Ub(B,g,E),O[6].Ub(R,g,r),O[7].Ub(B,A,r),b.addToRef(Y,this.center).scaleInPlace(.5),b.subtractToRef(Y,this.extendSize).scaleInPlace(.5),this._worldMatrix=C||q.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(Y){const b=E._TmpVector3,C=this.maximum.subtractToRef(this.minimum,b[0]),R=C.length();C.normalizeFromLength(R);const q=R*Y,A=C.scaleInPlace(.5*q),B=this.center.subtractToRef(A,b[1]),g=this.center.addToRef(A,b[2]);return this.reConstruct(B,g,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(Y){const b=this.minimumWorld,C=this.maximumWorld,R=this.directions,A=this.vectorsWorld,E=this.vectors;if(Y.isIdentity()){b.q(this.minimum),C.q(this.maximum);for(let Y=0;Y<8;++Y)A[Y].q(E[Y]);this.extendSizeWorld.q(this.extendSize),this.centerWorld.q(this.center)}else{b.Gb(Number.MAX_VALUE),C.Gb(-Number.MAX_VALUE);for(let R=0;R<8;++R){const B=A[R];q.AC.TransformCoordinatesToRef(E[R],Y,B),b.minimizeInPlace(B),C.maximizeInPlace(B)}C.subtractToRef(b,this.extendSizeWorld).scaleInPlace(.5),C.addToRef(b,this.centerWorld).scaleInPlace(.5)}q.AC.FromArrayToRef(Y.m,0,R[0]),q.AC.FromArrayToRef(Y.m,4,R[1]),q.AC.FromArrayToRef(Y.m,8,R[2]),this._worldMatrix=Y}isInFrustum(Y){return E.IsInFrustum(this.vectorsWorld,Y)}isCompletelyInFrustum(Y){return E.IsCompletelyInFrustum(this.vectorsWorld,Y)}intersectsPoint(Y){const b=this.minimumWorld,C=this.maximumWorld,R=b.x,q=b.y,E=b.z,B=C.x,g=C.y,r=C.z,O=Y.x,F=Y.y,y=Y.z,S=-A.e;return!(B-O<S||S>O-R)&&(!(g-F<S||S>F-q)&&!(r-y<S||S>y-E))}intersectsSphere(Y){return E.IntersectsSphere(this.minimumWorld,this.maximumWorld,Y.centerWorld,Y.radiusWorld)}intersectsMinMax(Y,b){const C=this.minimumWorld,R=this.maximumWorld,q=C.x,A=C.y,E=C.z,B=R.x,g=R.y,r=R.z,O=Y.x,F=Y.y,y=Y.z,S=b.x,n=b.y,t=b.z;return!(B<O||q>S)&&(!(g<F||A>n)&&!(r<y||E>t))}dispose(){var Y,b;null===(Y=this._drawWrapperFront)||void 0===Y||Y.dispose(),null===(b=this._drawWrapperBack)||void 0===b||b.dispose()}static Intersects(Y,b){return Y.intersectsMinMax(b.minimumWorld,b.maximumWorld)}static IntersectsSphere(Y,b,C,R){const A=E._TmpVector3[0];q.AC.ClampToRef(C,Y,b,A);return q.AC.DistanceSquared(C,A)<=R*R}static IsCompletelyInFrustum(Y,b){for(let C=0;C<6;++C){const R=b[C];for(let b=0;b<8;++b)if(R.dotCoordinate(Y[b])<0)return!1}return!0}static IsInFrustum(Y,b){for(let C=0;C<6;++C){let R=!0;const q=b[C];for(let b=0;b<8;++b)if(q.dotCoordinate(Y[b])>=0){R=!1;break}if(R)return!1}return!0}}E._TmpVector3=(0,R.e)(3,q.AC.Zero)},13156:(Y,b,C)=>{C.d(b,{b:()=>F});var R=C(12846),q=C(12831),A=C(13159),E=C(13165);const B={min:0,max:0},g={min:0,max:0},r=(Y,b,C)=>{const R=q.AC.Dot(b.centerWorld,Y),A=Math.abs(q.AC.Dot(b.directions[0],Y))*b.extendSize.x+Math.abs(q.AC.Dot(b.directions[1],Y))*b.extendSize.y+Math.abs(q.AC.Dot(b.directions[2],Y))*b.extendSize.z;C.min=R-A,C.max=R+A},O=(Y,b,C)=>(r(Y,b,B),r(Y,C,g),!(B.min>g.max||g.min>B.max));class F{constructor(Y,b,C){this._isLocked=!1,this.boundingBox=new A.b(Y,b,C),this.boundingSphere=new E.c(Y,b,C)}reConstruct(Y,b,C){this.boundingBox.reConstruct(Y,b,C),this.boundingSphere.reConstruct(Y,b,C)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(Y){this._isLocked=Y}update(Y){this._isLocked||(this.boundingBox._update(Y),this.boundingSphere._update(Y))}centerOn(Y,b){const C=F._TmpVector3[0].q(Y).dF(b),R=F._TmpVector3[1].q(Y).addInPlace(b);return this.boundingBox.reConstruct(C,R,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(C,R,this.boundingBox.getWorldMatrix()),this}encapsulate(Y){const b=q.AC.Minimize(this.minimum,Y),C=q.AC.Maximize(this.maximum,Y);return this.reConstruct(b,C,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(Y){const b=q.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(b);const C=q.TmpVectors.AC[0];return q.AC.TransformCoordinatesToRef(Y.boundingBox.minimumWorld,b,C),this.encapsulate(C),q.AC.TransformCoordinatesToRef(Y.boundingBox.maximumWorld,b,C),this.encapsulate(C),this}scale(Y){return this.boundingBox.scale(Y),this.boundingSphere.scale(Y),this}isInFrustum(Y){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===b||3===b)&&this.boundingSphere.isCenterInFrustum(Y))return!0;if(!this.boundingSphere.isInFrustum(Y))return!1;return!(1!==b&&3!==b)||this.boundingBox.isInFrustum(Y)}get diagonalLength(){const Y=this.boundingBox;return Y.maximumWorld.subtractToRef(Y.minimumWorld,F._TmpVector3[0]).length()}isCompletelyInFrustum(Y){return this.boundingBox.isCompletelyInFrustum(Y)}_checkCollision(Y){return Y._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(Y){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(Y)&&!!this.boundingBox.intersectsPoint(Y))}intersects(Y,b){if(!E.c.Intersects(this.boundingSphere,Y.boundingSphere))return!1;if(!A.b.Intersects(this.boundingBox,Y.boundingBox))return!1;if(!b)return!0;const C=this.boundingBox,R=Y.boundingBox;return!!O(C.directions[0],C,R)&&(!!O(C.directions[1],C,R)&&(!!O(C.directions[2],C,R)&&(!!O(R.directions[0],C,R)&&(!!O(R.directions[1],C,R)&&(!!O(R.directions[2],C,R)&&(!!O(q.AC.Cross(C.directions[0],R.directions[0]),C,R)&&(!!O(q.AC.Cross(C.directions[0],R.directions[1]),C,R)&&(!!O(q.AC.Cross(C.directions[0],R.directions[2]),C,R)&&(!!O(q.AC.Cross(C.directions[1],R.directions[0]),C,R)&&(!!O(q.AC.Cross(C.directions[1],R.directions[1]),C,R)&&(!!O(q.AC.Cross(C.directions[1],R.directions[2]),C,R)&&(!!O(q.AC.Cross(C.directions[2],R.directions[0]),C,R)&&(!!O(q.AC.Cross(C.directions[2],R.directions[1]),C,R)&&!!O(q.AC.Cross(C.directions[2],R.directions[2]),C,R))))))))))))))}}F._TmpVector3=(0,R.e)(2,q.AC.Zero)},13165:(Y,b,C)=>{C.d(b,{c:()=>A});var R=C(12846),q=C(12831);class A{constructor(Y,b,C){this.center=q.AC.Zero(),this.centerWorld=q.AC.Zero(),this.minimum=q.AC.Zero(),this.maximum=q.AC.Zero(),this.reConstruct(Y,b,C)}reConstruct(Y,b,C){this.minimum.q(Y),this.maximum.q(b);const R=q.AC.Distance(Y,b);b.addToRef(Y,this.center).scaleInPlace(.5),this.radius=.5*R,this._update(C||q.Matrix.IdentityReadOnly)}scale(Y){const b=this.radius*Y,C=A._TmpVector3,R=C[0].Gb(b),q=this.center.subtractToRef(R,C[1]),E=this.center.addToRef(R,C[2]);return this.reConstruct(q,E,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(Y){if(Y.isIdentity())this.centerWorld.q(this.center),this.radiusWorld=this.radius;else{q.AC.TransformCoordinatesToRef(this.center,Y,this.centerWorld);const b=A._TmpVector3[0];q.AC.TransformNormalFromFloatsToRef(1,1,1,Y,b),this.radiusWorld=Math.max(Math.abs(b.x),Math.abs(b.y),Math.abs(b.z))*this.radius}}isInFrustum(Y){const b=this.centerWorld,C=this.radiusWorld;for(let R=0;R<6;R++)if(Y[R].dotCoordinate(b)<=-C)return!1;return!0}isCenterInFrustum(Y){const b=this.centerWorld;for(let C=0;C<6;C++)if(Y[C].dotCoordinate(b)<0)return!1;return!0}intersectsPoint(Y){const b=q.AC.DistanceSquared(this.centerWorld,Y);return!(this.radiusWorld*this.radiusWorld<b)}static Intersects(Y,b){const C=q.AC.DistanceSquared(Y.centerWorld,b.centerWorld),R=Y.radiusWorld+b.radiusWorld;return!(R*R<C)}static CreateFromCenterAndRadius(Y,b,C){this._TmpVector3[0].q(Y),this._TmpVector3[1].Ub(0,0,b),this._TmpVector3[2].q(Y),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].dF(this._TmpVector3[1]);const R=new A(this._TmpVector3[0],this._TmpVector3[2]);return R._worldMatrix=C||q.Matrix.Identity(),R}}A._TmpVector3=(0,R.e)(3,q.AC.Zero)},13187:(Y,b,C)=>{function R(Y){-1===Y.indexOf("vClipPlane")&&Y.push("vClipPlane"),-1===Y.indexOf("vClipPlane2")&&Y.push("vClipPlane2"),-1===Y.indexOf("vClipPlane3")&&Y.push("vClipPlane3"),-1===Y.indexOf("vClipPlane4")&&Y.push("vClipPlane4"),-1===Y.indexOf("vClipPlane5")&&Y.push("vClipPlane5"),-1===Y.indexOf("vClipPlane6")&&Y.push("vClipPlane6")}function q(Y,b,C){const R=!!(Y.clipPlane??b.clipPlane),q=!!(Y.clipPlane2??b.clipPlane2),A=!!(Y.clipPlane3??b.clipPlane3),E=!!(Y.clipPlane4??b.clipPlane4),B=!!(Y.clipPlane5??b.clipPlane5),g=!!(Y.clipPlane6??b.clipPlane6);R&&C.push("#define CLIPPLANE"),q&&C.push("#define CLIPPLANE2"),A&&C.push("#define CLIPPLANE3"),E&&C.push("#define CLIPPLANE4"),B&&C.push("#define CLIPPLANE5"),g&&C.push("#define CLIPPLANE6")}function A(Y,b,C){let R=!1;const q=!!(Y.clipPlane??b.clipPlane),A=!!(Y.clipPlane2??b.clipPlane2),E=!!(Y.clipPlane3??b.clipPlane3),B=!!(Y.clipPlane4??b.clipPlane4),g=!!(Y.clipPlane5??b.clipPlane5),r=!!(Y.clipPlane6??b.clipPlane6);return C.CLIPPLANE!==q&&(C.CLIPPLANE=q,R=!0),C.CLIPPLANE2!==A&&(C.CLIPPLANE2=A,R=!0),C.CLIPPLANE3!==E&&(C.CLIPPLANE3=E,R=!0),C.CLIPPLANE4!==B&&(C.CLIPPLANE4=B,R=!0),C.CLIPPLANE5!==g&&(C.CLIPPLANE5=g,R=!0),C.CLIPPLANE6!==r&&(C.CLIPPLANE6=r,R=!0),R}function E(Y,b,C){let R=b.clipPlane??C.clipPlane;B(Y,"vClipPlane",R),R=b.clipPlane2??C.clipPlane2,B(Y,"vClipPlane2",R),R=b.clipPlane3??C.clipPlane3,B(Y,"vClipPlane3",R),R=b.clipPlane4??C.clipPlane4,B(Y,"vClipPlane4",R),R=b.clipPlane5??C.clipPlane5,B(Y,"vClipPlane5",R),R=b.clipPlane6??C.clipPlane6,B(Y,"vClipPlane6",R)}function B(Y,b,C){C&&Y.setFloat4(b,C.normal.x,C.normal.y,C.normal.z,C.d)}C.d(b,{c:()=>R,g:()=>E,h:()=>A,i:()=>q})},13128:(Y,b,C)=>{C.d(b,{b:()=>R});class R{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(Y,b){this._defines[Y]||(Y<this._currentRank&&(this._currentRank=Y),Y>this._maxRank&&(this._maxRank=Y),this._defines[Y]=new Array),this._defines[Y].push(b)}addCPUSkinningFallback(Y,b){this._mesh=b,Y<this._currentRank&&(this._currentRank=Y),Y>this._maxRank&&(this._maxRank=Y)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(Y,b){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,Y=Y.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),b._bonesComputationForcedToCPU=!0;const C=this._mesh.uY();for(let Y=0;Y<C.meshes.length;Y++){const R=C.meshes[Y];if(R.material){if(R.computeBonesUsingShaders&&0!==R.numBoneInfluencers)if(R.material.getEffect()===b)R.computeBonesUsingShaders=!1;else if(R.ub)for(const Y of R.ub){if(Y.effect===b){R.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&R.computeBonesUsingShaders&&R.numBoneInfluencers>0&&(R.computeBonesUsingShaders=!1)}}else{const b=this._defines[this._currentRank];if(b)for(let C=0;C<b.length;C++)Y=Y.replace("#define "+b[C],"");this._currentRank++}return Y}}},13143:(Y,b,C)=>{C.d(b,{e:()=>I});var R=C(12818),q=C(12821),A=C(12645),E=C(12652),B=C(12702),g=C(13151),r=C(13091),O=C(12669),F=C(12889),y=C(12943),S=C(12870);class n{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(Y){this._func=Y}get funcRef(){return this._funcRef}set funcRef(Y){this._funcRef=Y}get funcMask(){return this._funcMask}set funcMask(Y){this._funcMask=Y}get opStencilFail(){return this._opStencilFail}set opStencilFail(Y){this._opStencilFail=Y}get opDepthFail(){return this._opDepthFail}set opDepthFail(Y){this._opDepthFail=Y}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(Y){this._opStencilDepthPass=Y}get mask(){return this._mask}set mask(Y){this._mask=Y}get enabled(){return this._enabled}set enabled(Y){this._enabled=Y}getClassName(){return"MaterialStencilState"}copyTo(Y){S.e.Clone((()=>Y),this)}serialize(){return S.e.Serialize(this)}parse(Y,b,C){S.e.Parse((()=>this),Y,b,C)}}(0,R.c)([(0,q.K)()],n.prototype,"func",null),(0,R.c)([(0,q.K)()],n.prototype,"funcRef",null),(0,R.c)([(0,q.K)()],n.prototype,"funcMask",null),(0,R.c)([(0,q.K)()],n.prototype,"opStencilFail",null),(0,R.c)([(0,q.K)()],n.prototype,"opDepthFail",null),(0,R.c)([(0,q.K)()],n.prototype,"opStencilDepthPass",null),(0,R.c)([(0,q.K)()],n.prototype,"mask",null),(0,R.c)([(0,q.K)()],n.prototype,"enabled",null);var t=C(13181);class I{get _supportGlowLayer(){return!1}set _glowModeEnabled(Y){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(Y){if(this._alpha===Y)return;const b=this._alpha;this._alpha=Y,1!==b&&1!==Y||this.JO(I.MiscDirtyFlag+I.PrePassDirtyFlag)}get alpha(){return this._alpha}set Jb(Y){this._backFaceCulling!==Y&&(this._backFaceCulling=Y,this.JO(I.TextureDirtyFlag))}get Jb(){return this._backFaceCulling}set cullBackFaces(Y){this._cullBackFaces!==Y&&(this._cullBackFaces=Y,this.JO(I.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(Y){this._blockDirtyMechanism!==Y&&(this._blockDirtyMechanism=Y,Y||this.hy())}atomicMaterialsUpdate(Y){this.blockDirtyMechanism=!0;try{Y(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(Y){this._onDisposeObserver&&this.Sb.remove(this._onDisposeObserver),this._onDisposeObserver=this.Sb.add(Y)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new E.d),this._onBindObservable}set onBind(Y){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(Y)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new E.d),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new E.d),this._onEffectCreatedObservable}set alphaMode(Y){this._alphaMode!==Y&&(this._alphaMode=Y,this.JO(I.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(Y){this._needDepthPrePass!==Y&&(this._needDepthPrePass=Y,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(Y){this._fogEnabled!==Y&&(this._fogEnabled=Y,this.JO(I.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case I.WireFrameFillMode:case I.LineListDrawMode:case I.LineLoopDrawMode:case I.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(Y){this.fillMode=Y?I.WireFrameFillMode:I.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case I.PointFillMode:case I.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(Y){this.fillMode=Y?I.PointFillMode:I.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(Y){this._fillMode!==Y&&(this._fillMode=Y,this.JO(I.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(Y){const b=this.uY().getEngine().getCaps().fragmentDepthSupported;Y&&!b&&O.e.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=Y&&b,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(Y){this._drawWrapper=Y}constructor(Y,b,C){let R=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.Sb=new E.d,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.nb=new n,this._useUBO=!1,this._fillMode=I.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=Y;const q=b||B.d.LastCreatedScene;q&&(this._scene=q,this._dirtyCallbacks={},this._forceGLSL=R,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=Y||A.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new y.c(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new r.e(this._scene.getEngine(),void 0,void 0,Y),this._useUBO=this.uY().getEngine().supportsUniformBuffers,this._createUniformBuffer(),C||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),I.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var Y;const b=this.uY().getEngine();null===(Y=this._uniformBuffer)||void 0===Y||Y.dispose(),b.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new r.e(b,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new r.e(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(Y){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.hy(),this.checkReadyOnlyOnce=!0}unfreeze(){this.hy(),this.checkReadyOnlyOnce=!1}isReady(Y,b){return!0}isReadyForSubMesh(Y,b,C){const R=b.materialDefines;return!!R&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=R,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}uY(){return this._scene}_getEffectiveOrientation(Y){return null!==this.sideOrientation?this.sideOrientation:Y.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(Y){this._transparencyMode!==Y&&(this._transparencyMode=Y,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===I.MATERIAL_ALPHABLEND||this._transparencyMode===I.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===I.MATERIAL_ALPHATEST||this._transparencyMode===I.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===I.MATERIAL_OPAQUE||this._transparencyMode===I.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(Y){return this._hasTransparencyMode?this._transparencyModeIsBlend:Y.visibility<1||!this._disableAlphaBlending&&(Y.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(Y){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(Y)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}hy(){let Y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const b=this.uY().meshes;for(const C of b)if(C.ub)for(const b of C.ub)if(b.GY()===this)for(const C of b._drawWrappers)C&&this._materialContext===C.materialContext&&(C._wasPreviouslyReady=!1,C._wasPreviouslyUsingInstances=null,C._forceRebindOnNextCall=Y);Y&&this.JO(I.AllDirtyFlag)}_preBind(Y){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const C=this._scene.getEngine(),R=(null==b?this.sideOrientation:b)===I.ClockWiseSideOrientation;return C.enableEffect(Y||this._getDrawWrapper()),C.setState(this.Jb,this.zOffset,!1,R,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.nb,this.zOffsetUnits),R}bind(Y,b){}buildUniformLayout(){const Y=this._uniformBuffer;this._eventInfo.ubo=Y,this._callbackPluginEventGeneric(8,this._eventInfo),Y.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(Y,b,C){const R=C._drawWrapper;this._eventInfo.subMesh=C,this._callbackPluginEventBindForSubMesh(this._eventInfo),R._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(Y){}bindView(Y){this._useUBO?this._needToBindSceneUbo=!0:Y.setMatrix("view",this.uY().getViewMatrix())}bindViewProjection(Y){this._useUBO?this._needToBindSceneUbo=!0:(Y.setMatrix("viewProjection",this.uY().getTransformMatrix()),Y.setMatrix("projection",this.uY().getProjectionMatrix()))}bindEyePosition(Y,b){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(Y,b)}_afterBind(Y){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&b&&(this._needToBindSceneUbo=!1,(0,t.r)(b,this.uY().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=Y?Y.visibility:1,this._onBindObservable&&Y&&this._onBindObservable.notifyObservers(Y),this.disableDepthWrite){const Y=this._scene.getEngine();this._cachedDepthWriteState=Y.getDepthWrite(),Y.setDepthWrite(!1)}if(this.disableColorWrite){const Y=this._scene.getEngine();this._cachedColorWriteState=Y.getColorWrite(),Y.setColorWrite(!1)}if(0!==this.depthFunction){const Y=this._scene.getEngine();this._cachedDepthFunctionState=Y.getDepthFunction()||0,Y.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(Y){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=Y,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(Y){return null}_clonePlugins(Y,b){const C={};if(this._serializePlugins(C),I._ParsePlugins(C,Y,this._scene,b),this.pluginManager)for(const R of this.pluginManager._plugins){const b=Y.pluginManager.getPlugin(R.name);b&&R.copyTo(b)}}getBindedMeshes(){if(this.meshMap){const Y=[];for(const b in this.meshMap){const C=this.meshMap[b];C&&Y.push(C)}return Y}return this._scene.meshes.filter((Y=>Y.material===this))}forceCompilation(Y,b,C,R){const q={clipPlane:!1,useInstances:!1,...C},A=this.uY(),E=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const B=()=>{if(!this._scene||!this._scene.getEngine())return;const C=A.clipPlane;if(q.clipPlane&&(A.clipPlane=new F.d(0,0,0,1)),this._storeEffectOnSubMeshes){let C=!0,A=null;if(Y.ub){const b=new g.c(0,0,0,0,0,Y,void 0,!1,!1);b.materialDefines&&(b.materialDefines._renderId=-1),this.isReadyForSubMesh(Y,b,q.useInstances)||(b.effect&&b.effect.getCompilationError()&&b.effect.allFallbacksProcessed()?A=b.effect.getCompilationError():(C=!1,setTimeout(B,16)))}C&&(this.allowShaderHotSwapping=E,A&&R&&R(A),b&&b(this))}else this.isReady()?(this.allowShaderHotSwapping=E,b&&b(this)):setTimeout(B,16);q.clipPlane&&(A.clipPlane=C)};B()}async forceCompilationAsync(Y,b){return await new Promise(((C,R)=>{this.forceCompilation(Y,(()=>{C()}),b,(Y=>{R(Y)}))}))}JO(Y){this.uY().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(I._DirtyCallbackArray.length=0,Y&I.ImageProcessingDirtyFlag&&I._DirtyCallbackArray.push(I._ImageProcessingDirtyCallBack),Y&I.TextureDirtyFlag&&I._DirtyCallbackArray.push(I._TextureDirtyCallBack),Y&I.LightDirtyFlag&&I._DirtyCallbackArray.push(I._LightsDirtyCallBack),Y&I.FresnelDirtyFlag&&I._DirtyCallbackArray.push(I._FresnelDirtyCallBack),Y&I.AttributesDirtyFlag&&I._DirtyCallbackArray.push(I._AttributeDirtyCallBack),Y&I.MiscDirtyFlag&&I._DirtyCallbackArray.push(I._MiscDirtyCallBack),Y&I.PrePassDirtyFlag&&I._DirtyCallbackArray.push(I._PrePassDirtyCallBack),I._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(I._RunDirtyCallBacks),this.uY().resetCachedMaterial())}resetDrawCache(){const Y=this.uY().meshes;for(const b of Y)if(b.ub)for(const Y of b.ub)Y.GY()===this&&Y.resetDrawCache()}_markAllSubMeshesAsDirty(Y){const b=this.uY();if(b.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const C=b.meshes;for(const R of C)if(R.ub)for(const C of R.ub){if((C.GY()||(b._hasDefaultMaterial?b.defaultMaterial:null))===this)for(const b of C._drawWrappers)b&&b.defines&&b.defines.markAllAsDirty&&this._materialContext===b.materialContext&&Y(b.defines)}}_markScenePrePassDirty(){if(this.uY().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const Y=this.uY().enablePrePassRenderer();Y&&Y.JO()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(I._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(I._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(I._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(I._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(I._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(I._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(I._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(I._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(I._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(I._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const Y=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.Sb.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(Y)}))}}setPrePassRenderer(Y){return!1}dispose(Y,b,C){const R=this.uY();if(R.stopAnimation(this),R.freeProcessedMaterials(),R.removeMaterial(this),this._eventInfo.forceDisposeTextures=b,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const Y=this._parentContainer.materials.indexOf(this);Y>-1&&this._parentContainer.materials.splice(Y,1),this._parentContainer=null}if(!0!==C)if(this.meshMap)for(const q in this.meshMap){const Y=this.meshMap[q];this._disposeMeshResources(Y)}else{const Y=R.meshes;for(const b of Y)this._disposeMeshResources(b)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.Sb.notifyObservers(this),this.Sb.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(Y){if(!Y)return;const b=Y.Pb,C=Y._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(Y.ub&&C)for(const q of Y.ub){const Y=q._drawWrappers;for(let A=0;A<Y.length;A++){var R;const E=null===(R=Y[A])||void 0===R?void 0:R.effect;if(!E)continue;C[A]===this&&(null===b||void 0===b||b._releaseVertexArrayObject(E),q._removeDrawWrapper(A,!0,!0))}}}else null===b||void 0===b||b._releaseVertexArrayObject(this._drawWrapper.effect);Y.material!==this||Y.sourceMesh||(Y.material=null)}serialize(){const Y=S.e.Serialize(this);return Y.nb=this.nb.serialize(),Y.uniqueId=this.uniqueId,this._serializePlugins(Y),Y}_serializePlugins(Y){if(Y.plugins={},this.pluginManager)for(const b of this.pluginManager._plugins)b.doNotSerialize||(Y.plugins[b.getClassName()]=b.serialize())}static Parse(Y,b,C){if(Y.customType){if("BABYLON.PBRMaterial"===Y.customType&&Y.overloadedAlbedo&&(Y.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return O.e.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else Y.customType="BABYLON.StandardMaterial";const R=A.Tools.Instantiate(Y.customType).Parse(Y,b,C);return R._loadedUniqueId=Y.uniqueId,R}static _ParsePlugins(Y,b,C,R){if(Y.plugins)for(const B in Y.plugins){var q,E;const g=Y.plugins[B];let r=null===(q=b.pluginManager)||void 0===q?void 0:q.getPlugin(g.name);if(!r){const Y=A.Tools.Instantiate("BABYLON."+B);Y&&(r=new Y(b))}null===(E=r)||void 0===E||E.parse(g,C,R)}}}I.TriangleFillMode=0,I.WireFrameFillMode=1,I.PointFillMode=2,I.PointListDrawMode=3,I.LineListDrawMode=4,I.LineLoopDrawMode=5,I.LineStripDrawMode=6,I.TriangleStripDrawMode=7,I.TriangleFanDrawMode=8,I.ClockWiseSideOrientation=0,I.CounterClockWiseSideOrientation=1,I.ImageProcessingDirtyFlag=64,I.TextureDirtyFlag=1,I.LightDirtyFlag=2,I.FresnelDirtyFlag=4,I.AttributesDirtyFlag=8,I.MiscDirtyFlag=16,I.PrePassDirtyFlag=32,I.AllDirtyFlag=127,I.MATERIAL_OPAQUE=0,I.MATERIAL_ALPHATEST=1,I.MATERIAL_ALPHABLEND=2,I.MATERIAL_ALPHATESTANDBLEND=3,I.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,I.MATERIAL_NORMALBLENDMETHOD_RNM=1,I.OnEventObservable=new E.d,I._AllDirtyCallBack=Y=>Y.markAllAsDirty(),I._ImageProcessingDirtyCallBack=Y=>Y.markAsImageProcessingDirty(),I._TextureDirtyCallBack=Y=>Y.markAsTexturesDirty(),I._FresnelDirtyCallBack=Y=>Y.markAsFresnelDirty(),I._MiscDirtyCallBack=Y=>Y.markAsMiscDirty(),I._PrePassDirtyCallBack=Y=>Y.markAsPrePassDirty(),I._LightsDirtyCallBack=Y=>Y.markAsLightDirty(),I._AttributeDirtyCallBack=Y=>Y.markAsAttributesDirty(),I._FresnelAndMiscDirtyCallBack=Y=>{I._FresnelDirtyCallBack(Y),I._MiscDirtyCallBack(Y)},I._TextureAndMiscDirtyCallBack=Y=>{I._TextureDirtyCallBack(Y),I._MiscDirtyCallBack(Y)},I._DirtyCallbackArray=[],I._RunDirtyCallBacks=Y=>{for(const b of I._DirtyCallbackArray)b(Y)},(0,R.c)([(0,q.K)()],I.prototype,"id",void 0),(0,R.c)([(0,q.K)()],I.prototype,"uniqueId",void 0),(0,R.c)([(0,q.K)()],I.prototype,"name",void 0),(0,R.c)([(0,q.K)()],I.prototype,"metadata",void 0),(0,R.c)([(0,q.K)()],I.prototype,"checkReadyOnEveryCall",void 0),(0,R.c)([(0,q.K)()],I.prototype,"checkReadyOnlyOnce",void 0),(0,R.c)([(0,q.K)()],I.prototype,"state",void 0),(0,R.c)([(0,q.K)("alpha")],I.prototype,"_alpha",void 0),(0,R.c)([(0,q.K)("Jb")],I.prototype,"_backFaceCulling",void 0),(0,R.c)([(0,q.K)("cullBackFaces")],I.prototype,"_cullBackFaces",void 0),(0,R.c)([(0,q.K)()],I.prototype,"sideOrientation",void 0),(0,R.c)([(0,q.K)("alphaMode")],I.prototype,"_alphaMode",void 0),(0,R.c)([(0,q.K)()],I.prototype,"_needDepthPrePass",void 0),(0,R.c)([(0,q.K)()],I.prototype,"disableDepthWrite",void 0),(0,R.c)([(0,q.K)()],I.prototype,"disableColorWrite",void 0),(0,R.c)([(0,q.K)()],I.prototype,"forceDepthWrite",void 0),(0,R.c)([(0,q.K)()],I.prototype,"depthFunction",void 0),(0,R.c)([(0,q.K)()],I.prototype,"separateCullingPass",void 0),(0,R.c)([(0,q.K)("fogEnabled")],I.prototype,"_fogEnabled",void 0),(0,R.c)([(0,q.K)()],I.prototype,"pointSize",void 0),(0,R.c)([(0,q.K)()],I.prototype,"zOffset",void 0),(0,R.c)([(0,q.K)()],I.prototype,"zOffsetUnits",void 0),(0,R.c)([(0,q.K)()],I.prototype,"pointsCloud",null),(0,R.c)([(0,q.K)()],I.prototype,"fillMode",null),(0,R.c)([(0,q.K)()],I.prototype,"useLogarithmicDepth",null),(0,R.c)([(0,q.K)()],I.prototype,"transparencyMode",null)},13181:(Y,b,C)=>{C.d(b,{A:()=>u,B:()=>c,E:()=>S,G:()=>y,I:()=>v,K:()=>P,L:()=>j,N:()=>w,O:()=>X,P:()=>z,R:()=>J,U:()=>U,V:()=>G,Z:()=>n,e:()=>p,h:()=>F,j:()=>L,n:()=>O,o:()=>t,r:()=>I,v:()=>Q,x:()=>l,y:()=>N});var R=C(12669),q=C(12880),A=C(12702),E=C(13123),B=C(13187);const g=q.rC.Black(),r={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function O(Y,b,C){if(!Y||Y.LOGARITHMICDEPTH||Y.indexOf&&Y.indexOf("LOGARITHMICDEPTH")>=0){const Y=C.activeCamera;1===Y.mode&&R.e.Error("Logarithmic depth is not compatible with orthographic cameras!",20),b.setFloat("logarithmicDepthConstant",2/(Math.log(Y.maxZ+1)/Math.LN2))}}function F(Y,b,C){let R=arguments.length>3&&void 0!==arguments[3]&&arguments[3];C&&Y.fogEnabled&&(!b||b.applyFog)&&0!==Y.fogMode&&(C.setFloat4("vFogInfos",Y.fogMode,Y.fogStart,Y.fogEnd,Y.fogDensity),R?(Y.fogColor.toLinearSpaceToRef(g,Y.getEngine().useExactSrgbConversions),C.setColor3("vFogColor",g)):C.setColor3("vFogColor",Y.fogColor))}function y(Y,b,C,R,q,A,E,B,g,O){const F=Y.numMaxInfluencers||Y.numInfluencers;return F<=0?0:(b.push("#define MORPHTARGETS"),Y.hasPositions&&b.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),Y.hasNormals&&b.push("#define MORPHTARGETTEXTURE_HASNORMALS"),Y.hasTangents&&b.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),Y.hasUVs&&b.push("#define MORPHTARGETTEXTURE_HASUVS"),Y.hasUV2s&&b.push("#define MORPHTARGETTEXTURE_HASUV2S"),Y.hasColors&&b.push("#define MORPHTARGETTEXTURE_HASCOLORS"),Y.supportsPositions&&q&&b.push("#define MORPHTARGETS_POSITION"),Y.supportsNormals&&A&&b.push("#define MORPHTARGETS_NORMAL"),Y.supportsTangents&&E&&b.push("#define MORPHTARGETS_TANGENT"),Y.supportsUVs&&B&&b.push("#define MORPHTARGETS_UV"),Y.supportsUV2s&&g&&b.push("#define MORPHTARGETS_UV2"),Y.supportsColors&&O&&b.push("#define MORPHTARGETS_COLOR"),b.push("#define NUM_MORPH_INFLUENCERS "+F),Y.isUsingTextureForTargets&&b.push("#define MORPHTARGETS_TEXTURE"),r.NUM_MORPH_INFLUENCERS=F,r.NORMAL=A,r.TANGENT=E,r.UV=B,r.UV2=g,r.COLOR=O,S(C,R,r,q),F)}function S(Y,b,C){let q=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const E=C.NUM_MORPH_INFLUENCERS;if(E>0&&A.d.LastCreatedEngine){const B=A.d.LastCreatedEngine.getCaps().maxVertexAttribs,g=b.morphTargetManager;if(null!==g&&void 0!==g&&g.isUsingTextureForTargets)return;const r=g&&g.supportsPositions&&q,O=g&&g.supportsNormals&&C.NORMAL,F=g&&g.supportsTangents&&C.TANGENT,y=g&&g.supportsUVs&&C.UV1,S=g&&g.supportsUV2s&&C.UV2,n=g&&g.supportsColors&&C.VERTEXCOLOR;for(let C=0;C<E;C++)r&&Y.push("position"+C),O&&Y.push("normal"+C),F&&Y.push("tangent"+C),y&&Y.push("uv_"+C),S&&Y.push("uv2_"+C),n&&Y.push("color"+C),Y.length>B&&R.e.Error("Cannot add more vertex attributes for mesh "+b.name)}}function n(Y){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Y.push("world0"),Y.push("world1"),Y.push("world2"),Y.push("world3"),b&&(Y.push("previousWorld0"),Y.push("previousWorld1"),Y.push("previousWorld2"),Y.push("previousWorld3"))}function t(Y,b){const C=Y.morphTargetManager;Y&&C&&b.setFloatArray("morphTargetInfluences",C.influences)}function I(Y,b){b.bindToEffect(Y,"Scene")}function w(Y,b,C){b._needUVs=!0,b[C]=!0,Y.optimizeUVAllocation&&Y.getTextureMatrix().isIdentityAs3x2()?(b[C+"DIRECTUV"]=Y.coordinatesIndex+1,b["MAINUV"+(Y.coordinatesIndex+1)]=!0):b[C+"DIRECTUV"]=0}function Q(Y,b,C){const R=Y.getTextureMatrix();b.jb(C+"Matrix",R)}function N(Y,b,C){C.BAKED_VERTEX_ANIMATION_TEXTURE&&C.INSTANCES&&Y.push("bakedVertexAnimationSettingsInstanced")}function p(Y,b,C){var R;if(b&&Y&&(Y.computeBonesUsingShaders&&b._bonesComputationForcedToCPU&&(Y.computeBonesUsingShaders=!1),Y.useBones&&Y.computeBonesUsingShaders&&Y.skeleton)){const q=Y.skeleton;if(q.isUsingTextureForMatrices&&b.getUniformIndex("boneTextureWidth")>-1){const C=q.getTransformMatrixTexture(Y);b.setTexture("boneSampler",C),b.setFloat("boneTextureWidth",4*(q.bones.length+1))}else{const A=q.getTransformMatrices(Y);A&&(b.setMatrices("mBones",A),C&&Y.uY().prePassRenderer&&Y.uY().prePassRenderer.getIndex(2)&&(C.previousBones[Y.uniqueId]||(C.previousBones[Y.uniqueId]=A.slice()),b.setMatrices("mPreviousBones",C.previousBones[Y.uniqueId]),R=A,C.previousBones[Y.uniqueId].set(R)))}}}function mY(Y,b,C,R,q){let A=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];Y._bindLight(b,C,R,q,A)}function L(Y,b,C,R){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const A=Math.min(b.lightSources.length,q);for(let E=0;E<A;E++){mY(b.lightSources[E],E,Y,C,"boolean"===typeof R?R:R.SPECULARTERM,b.receiveShadows)}}function u(Y,b,C,R){C.NUM_BONE_INFLUENCERS>0&&(R.addCPUSkinningFallback(0,b),Y.push("matricesIndices"),Y.push("matricesWeights"),C.NUM_BONE_INFLUENCERS>4&&(Y.push("matricesIndicesExtra"),Y.push("matricesWeightsExtra")))}function c(Y,b){(b.INSTANCES||b.THIN_INSTANCES)&&n(Y,!!b.PREPASS_VELOCITY),b.INSTANCESCOLOR&&Y.push("instanceColor")}function l(Y,b){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,q=0;for(let A=0;A<C&&Y["LIGHT"+A];A++)A>0&&(q=R+A,b.addFallback(q,"LIGHT"+A)),Y.SHADOWS||(Y["SHADOW"+A]&&b.addFallback(R,"SHADOW"+A),Y["SHADOWPCF"+A]&&b.addFallback(R,"SHADOWPCF"+A),Y["SHADOWPCSS"+A]&&b.addFallback(R,"SHADOWPCSS"+A),Y["SHADOWPOISSON"+A]&&b.addFallback(R,"SHADOWPOISSON"+A),Y["SHADOWESM"+A]&&b.addFallback(R,"SHADOWESM"+A),Y["SHADOWCLOSEESM"+A]&&b.addFallback(R,"SHADOWCLOSEESM"+A));return q++}function X(Y,b,C,R,q,A,E){let B=arguments.length>7&&void 0!==arguments[7]&&arguments[7];E._areMiscDirty&&(E.LOGARITHMICDEPTH=C,E.POINTSIZE=R,E.FOG=q&&function(Y,b){return b.fogEnabled&&Y.applyFog&&0!==b.fogMode}(Y,b),E.NONUNIFORMSCALING=Y.nonUniformScaling,E.ALPHATEST=A,E.DECAL_AFTER_DETAIL=B)}function j(Y,b,C,R){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,A=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!C._areLightsDirty)return C._needNormals;let E=0;const B={needNormals:C._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(Y.lightsEnabled&&!A)for(const r of b.lightSources)if(T(Y,b,r,E,C,R,B),E++,E===q)break;C.SPECULARTERM=B.specularEnabled,C.SHADOWS=B.shadowEnabled;for(let r=E;r<q;r++)void 0!==C["LIGHT"+r]&&(C["LIGHT"+r]=!1,C["HEMILIGHT"+r]=!1,C["POINTLIGHT"+r]=!1,C["DIRLIGHT"+r]=!1,C["SPOTLIGHT"+r]=!1,C["AREALIGHT"+r]=!1,C["SHADOW"+r]=!1,C["SHADOWCSM"+r]=!1,C["SHADOWCSMDEBUG"+r]=!1,C["SHADOWCSMNUM_CASCADES"+r]=!1,C["SHADOWCSMUSESHADOWMAXZ"+r]=!1,C["SHADOWCSMNOBLEND"+r]=!1,C["SHADOWCSM_RIGHTHANDED"+r]=!1,C["SHADOWPCF"+r]=!1,C["SHADOWPCSS"+r]=!1,C["SHADOWPOISSON"+r]=!1,C["SHADOWESM"+r]=!1,C["SHADOWCLOSEESM"+r]=!1,C["SHADOWCUBE"+r]=!1,C["SHADOWLOWQUALITY"+r]=!1,C["SHADOWMEDIUMQUALITY"+r]=!1);const g=Y.getEngine().getCaps();return void 0===C.SHADOWFLOAT&&(B.needRebuild=!0),C.SHADOWFLOAT=B.shadowEnabled&&(g.textureFloatRender&&g.textureFloatLinearFiltering||g.textureHalfFloatRender&&g.textureHalfFloatLinearFiltering),C.LIGHTMAPEXCLUDED=B.lightmapMode,B.needRebuild&&C.rebuild(),B.needNormals}function T(Y,b,C,R,q,A,B){switch(B.needNormals=!0,void 0===q["LIGHT"+R]&&(B.needRebuild=!0),q["LIGHT"+R]=!0,q["SPOTLIGHT"+R]=!1,q["HEMILIGHT"+R]=!1,q["POINTLIGHT"+R]=!1,q["DIRLIGHT"+R]=!1,q["AREALIGHT"+R]=!1,C.prepareLightSpecificDefines(q,R),q["LIGHT_FALLOFF_PHYSICAL"+R]=!1,q["LIGHT_FALLOFF_GLTF"+R]=!1,q["LIGHT_FALLOFF_STANDARD"+R]=!1,C.falloffType){case E.c.FALLOFF_GLTF:q["LIGHT_FALLOFF_GLTF"+R]=!0;break;case E.c.FALLOFF_PHYSICAL:q["LIGHT_FALLOFF_PHYSICAL"+R]=!0;break;case E.c.FALLOFF_STANDARD:q["LIGHT_FALLOFF_STANDARD"+R]=!0}if(A&&!C.RF.equalsFloats(0,0,0)&&(B.specularEnabled=!0),q["SHADOW"+R]=!1,q["SHADOWCSM"+R]=!1,q["SHADOWCSMDEBUG"+R]=!1,q["SHADOWCSMNUM_CASCADES"+R]=!1,q["SHADOWCSMUSESHADOWMAXZ"+R]=!1,q["SHADOWCSMNOBLEND"+R]=!1,q["SHADOWCSM_RIGHTHANDED"+R]=!1,q["SHADOWPCF"+R]=!1,q["SHADOWPCSS"+R]=!1,q["SHADOWPOISSON"+R]=!1,q["SHADOWESM"+R]=!1,q["SHADOWCLOSEESM"+R]=!1,q["SHADOWCUBE"+R]=!1,q["SHADOWLOWQUALITY"+R]=!1,q["SHADOWMEDIUMQUALITY"+R]=!1,b&&b.receiveShadows&&Y.shadowsEnabled&&C.shadowEnabled){const b=C.getShadowGenerator(Y.activeCamera)??C.getShadowGenerator();if(b){const Y=b.getShadowMap();Y&&Y.renderList&&Y.renderList.length>0&&(B.shadowEnabled=!0,b.prepareDefines(q,R))}}C.lightmapMode!=E.c.LIGHTMAP_DEFAULT?(B.lightmapMode=!0,q["LIGHTMAPEXCLUDED"+R]=!0,q["LIGHTMAPNOSPECULAR"+R]=C.lightmapMode==E.c.LIGHTMAP_SHADOWSONLY):(q["LIGHTMAPEXCLUDED"+R]=!1,q["LIGHTMAPNOSPECULAR"+R]=!1)}function P(Y,b,C,R,q){let A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,E=arguments.length>6&&void 0!==arguments[6]&&arguments[6],g=function(Y,b){let C=!1;if(Y.activeCamera){const R=b.CAMERA_ORTHOGRAPHIC?1:0,q=b.CAMERA_PERSPECTIVE?1:0,A=1===Y.activeCamera.mode?1:0,E=0===Y.activeCamera.mode?1:0;(R^A||q^E)&&(b.CAMERA_ORTHOGRAPHIC=1===A,b.CAMERA_PERSPECTIVE=1===E,C=!0)}return C}(Y,R);!1!==A&&(g=(0,B.h)(C,Y,R)),R.DEPTHPREPASS!==!b.getColorWrite()&&(R.DEPTHPREPASS=!R.DEPTHPREPASS,g=!0),R.INSTANCES!==q&&(R.INSTANCES=q,g=!0),R.THIN_INSTANCES!==E&&(R.THIN_INSTANCES=E,g=!0),g&&R.markAsUnprocessed()}function v(Y,b,C,R){let q=arguments.length>4&&void 0!==arguments[4]&&arguments[4],A=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],E=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!b._areAttributesDirty&&b._needNormals===b._normals&&b._needUVs===b._uvs)return!1;b._normals=b._needNormals,b._uvs=b._needUVs,b.NORMAL=b._needNormals&&Y.isVerticesDataPresent("normal"),b._needNormals&&Y.isVerticesDataPresent("tangent")&&(b.TANGENT=!0);for(let B=1;B<=6;++B)b["UV"+B]=!!b._needUVs&&Y.isVerticesDataPresent(`uv${1===B?"":B}`);if(C){const C=Y.useVertexColors&&Y.isVerticesDataPresent("color");b.VERTEXCOLOR=C,b.VERTEXALPHA=Y.hasVertexAlpha&&C&&A}return Y.isVerticesDataPresent("instanceColor")&&(Y.hasInstances||Y.hasThinInstances)&&(b.INSTANCESCOLOR=!0),R&&function(Y,b){if(Y.useBones&&Y.computeBonesUsingShaders&&Y.skeleton){b.NUM_BONE_INFLUENCERS=Y.numBoneInfluencers;const C=void 0!==b.BONETEXTURE;if(Y.skeleton.isUsingTextureForMatrices&&C)b.BONETEXTURE=!0;else{b.BonesPerMesh=Y.skeleton.bones.length+1,b.BONETEXTURE=!C&&void 0;const R=Y.uY().prePassRenderer;if(R&&R.enabled){const C=-1===R.excludedSkinnedMesh.indexOf(Y);b.BONES_VELOCITY_ENABLED=C}}}else b.NUM_BONE_INFLUENCERS=0,b.BonesPerMesh=0,void 0!==b.BONETEXTURE&&(b.BONETEXTURE=!1)}(Y,b),q&&function(Y,b){const C=Y.morphTargetManager;C?(b.MORPHTARGETS_UV=C.supportsUVs&&b.UV1,b.MORPHTARGETS_UV2=C.supportsUV2s&&b.UV2,b.MORPHTARGETS_TANGENT=C.supportsTangents&&b.TANGENT,b.MORPHTARGETS_NORMAL=C.supportsNormals&&b.NORMAL,b.MORPHTARGETS_POSITION=C.supportsPositions,b.MORPHTARGETS_COLOR=C.supportsColors,b.MORPHTARGETTEXTURE_HASUVS=C.hasUVs,b.MORPHTARGETTEXTURE_HASUV2S=C.hasUV2s,b.MORPHTARGETTEXTURE_HASTANGENTS=C.hasTangents,b.MORPHTARGETTEXTURE_HASNORMALS=C.hasNormals,b.MORPHTARGETTEXTURE_HASPOSITIONS=C.hasPositions,b.MORPHTARGETTEXTURE_HASCOLORS=C.hasColors,b.NUM_MORPH_INFLUENCERS=C.numMaxInfluencers||C.numInfluencers,b.MORPHTARGETS=b.NUM_MORPH_INFLUENCERS>0,b.MORPHTARGETS_TEXTURE=C.isUsingTextureForTargets):(b.MORPHTARGETS_UV=!1,b.MORPHTARGETS_UV2=!1,b.MORPHTARGETS_TANGENT=!1,b.MORPHTARGETS_NORMAL=!1,b.MORPHTARGETS_POSITION=!1,b.MORPHTARGETS_COLOR=!1,b.MORPHTARGETTEXTURE_HASUVS=!1,b.MORPHTARGETTEXTURE_HASUV2S=!1,b.MORPHTARGETTEXTURE_HASTANGENTS=!1,b.MORPHTARGETTEXTURE_HASNORMALS=!1,b.MORPHTARGETTEXTURE_HASPOSITIONS=!1,b.MORPHTARGETTEXTURE_HAS_COLORS=!1,b.MORPHTARGETS=!1,b.NUM_MORPH_INFLUENCERS=0)}(Y,b),E&&function(Y,b){const C=Y.bakedVertexAnimationManager;b.BAKED_VERTEX_ANIMATION_TEXTURE=!(!C||!C.isEnabled)}(Y,b),!0}function z(Y,b){if(Y.activeCamera){const C=b.MULTIVIEW;b.MULTIVIEW=null!==Y.activeCamera.outputRenderTarget&&Y.activeCamera.outputRenderTarget.getViewCount()>1,b.MULTIVIEW!=C&&b.markAsUnprocessed()}}function J(Y,b,C){const R=b.ORDER_INDEPENDENT_TRANSPARENCY,q=b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;b.ORDER_INDEPENDENT_TRANSPARENCY=Y.useOrderIndependentTransparency&&C,b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!Y.getEngine().getCaps().textureFloatLinearFiltering,R===b.ORDER_INDEPENDENT_TRANSPARENCY&&q===b.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||b.markAsUnprocessed()}function U(Y,b,C){const R=b.PREPASS;if(!b._arePrePassDirty)return;const q=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(Y.prePassRenderer&&Y.prePassRenderer.enabled&&C){b.PREPASS=!0,b.SCENE_MRT_COUNT=Y.prePassRenderer.mrtCount,b.PREPASS_NORMAL_WORLDSPACE=Y.prePassRenderer.generateNormalsInWorldSpace,b.PREPASS_COLOR=!0,b.PREPASS_COLOR_INDEX=0;for(let C=0;C<q.length;C++){const R=Y.prePassRenderer.getIndex(q[C].type);-1!==R?(b[q[C].define]=!0,b[q[C].index]=R):b[q[C].define]=!1}}else{b.PREPASS=!1;for(let Y=0;Y<q.length;Y++)b[q[Y].define]=!1}b.PREPASS!=R&&(b.markAsUnprocessed(),b.markAsImageProcessingDirty())}function o(Y,b,C,R){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,A=arguments.length>5&&void 0!==arguments[5]&&arguments[5],E=arguments.length>6&&void 0!==arguments[6]&&arguments[6];q&&q.push("Light"+Y),A||(b.push("vLightData"+Y,"vLightDiffuse"+Y,"vLightSpecular"+Y,"vLightDirection"+Y,"vLightWidth"+Y,"vLightHeight"+Y,"vLightFalloff"+Y,"vLightGround"+Y,"lightMatrix"+Y,"shadowsInfo"+Y,"depthValues"+Y),C.push("shadowTexture"+Y),C.push("depthTexture"+Y),b.push("viewFrustumZ"+Y,"cascadeBlendFactor"+Y,"lightSizeUVCorrection"+Y,"depthCorrection"+Y,"penumbraDarkness"+Y,"frustumLengths"+Y),R&&(C.push("projectionLightTexture"+Y),b.push("textureProjectionMatrix"+Y)),E&&C.push("iesLightTexture"+Y))}function G(Y,b,C){let R,q,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(Y.uniformsNames){const E=Y;R=E.uniformsNames,q=E.uniformBuffersNames,b=E.samplers,C=E.defines,A=E.maxSimultaneousLights||0}else R=Y,b||(b=[]);for(let E=0;E<A&&C["LIGHT"+E];E++)o(E,R,b,C["PROJECTEDLIGHTTEXTURE"+E],q,!1,C["IESLIGHTTEXTURE"+E]);C.NUM_MORPH_INFLUENCERS&&(R.push("morphTargetInfluences"),R.push("morphTargetCount")),C.BAKED_VERTEX_ANIMATION_TEXTURE&&(R.push("bakedVertexAnimationSettings"),R.push("bakedVertexAnimationTextureSizeInverted"),R.push("bakedVertexAnimationTime"),b.push("bakedVertexAnimationTexture"))}},13137:(Y,b,C)=>{C.d(b,{c:()=>A});var R=C(12831),q=C(13143);class A extends q.e{constructor(Y,b){let C=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(Y,b,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new R.Matrix,this._storeEffectOnSubMeshes=C}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(Y,b){return!!Y&&(!this._storeEffectOnSubMeshes||(!Y.ub||0===Y.ub.length||this.isReadyForSubMesh(Y,Y.ub[0],b)))}_isReadyForSubMesh(Y){const b=Y.materialDefines;return!(this.checkReadyOnEveryCall||!Y.effect||!b||b._renderId!==this.uY().getRenderId())}bindOnlyWorldMatrix(Y){this._activeEffect.setMatrix("world",Y)}bindOnlyNormalMatrix(Y){this._activeEffect.setMatrix("normalMatrix",Y)}bind(Y,b){b&&this.bindForSubMesh(Y,b,b.ub[0])}_afterBind(Y){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,C=arguments.length>2?arguments[2]:void 0;super._afterBind(Y,b,C),this.uY()._cachedEffect=b,C?C._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(Y,b,C){let R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return C._drawWrapper._forceRebindOnNextCall||Y.isCachedMaterialInvalid(this,b,R)}dispose(Y,b,C){this._activeEffect=void 0,super.dispose(Y,b,C)}}},13174:(Y,b,C)=>{C.d(b,{e:()=>B,g:()=>g});var R=C(12818),q=C(12831),A=C(12821);class E{static extractMinAndMaxIndexed(Y,b,C,R,q,A){for(let E=C;E<C+R;E++){const C=3*b[E],R=Y[C],B=Y[C+1],g=Y[C+2];q.minimizeInPlaceFromFloats(R,B,g),A.maximizeInPlaceFromFloats(R,B,g)}}static extractMinAndMax(Y,b,C,R,q,A){for(let E=b,B=b*R;E<b+C;E++,B+=R){const b=Y[B],C=Y[B+1],R=Y[B+2];q.minimizeInPlaceFromFloats(b,C,R),A.maximizeInPlaceFromFloats(b,C,R)}}}function B(Y,b,C,R){let A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const B=new q.AC(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),g=new q.AC(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return E.extractMinAndMaxIndexed(Y,b,C,R,B,g),A&&(B.x-=B.x*A.x+A.y,B.y-=B.y*A.x+A.y,B.z-=B.z*A.x+A.y,g.x+=g.x*A.x+A.y,g.y+=g.y*A.x+A.y,g.z+=g.z*A.x+A.y),{minimum:B,maximum:g}}function g(Y,b,C){let R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,A=arguments.length>4?arguments[4]:void 0;const B=new q.AC(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),g=new q.AC(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return A||(A=3),E.extractMinAndMax(Y,b,C,A,B,g),R&&(B.x-=B.x*R.x+R.y,B.y-=B.y*R.x+R.y,B.z-=B.z*R.x+R.y,g.x+=g.x*R.x+R.y,g.y+=g.y*R.x+R.y,g.z+=g.z*R.x+R.y),{minimum:B,maximum:g}}(0,R.c)([A.h.filter((function(){for(var Y=arguments.length,b=new Array(Y),C=0;C<Y;C++)b[C]=arguments[C];let[R,q]=b;return!Array.isArray(R)&&!Array.isArray(q)}))],E,"extractMinAndMaxIndexed",null),(0,R.c)([A.h.filter((function(){for(var Y=arguments.length,b=new Array(Y),C=0;C<Y;C++)b[C]=arguments[C];let[R]=b;return!Array.isArray(R)}))],E,"extractMinAndMax",null)},13151:(Y,b,C)=>{C.d(b,{c:()=>g});var R=C(12903),q=C(13153),A=C(13156),E=C(13174),B=C(12943);class g{get materialDefines(){var Y;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(Y=this._getDrawWrapper())||void 0===Y?void 0:Y.defines}set materialDefines(Y){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=Y}_getDrawWrapper(Y){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Y=Y??this._engine.currentRenderPassId;let C=this._drawWrappers[Y];return!C&&b&&(this._drawWrappers[Y]=C=new B.c(this._mesh.uY().getEngine())),C}_removeDrawWrapper(Y){let b=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var C;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(C=this._drawWrappers[Y])||void 0===C||C.dispose(b));this._drawWrappers[Y]=void 0}get effect(){var Y;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(Y=this._getDrawWrapper())||void 0===Y?void 0:Y.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(Y){this._mainDrawWrapperOverride=Y}setEffect(Y){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,C=arguments.length>2?arguments[2]:void 0,R=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const q=this._drawWrapper;q.setEffect(Y,b,R),void 0!==C&&(q.materialContext=C),Y||(q.defines=null,q.materialContext=void 0)}resetDrawCache(Y){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==Y)return void this._removeDrawWrapper(Y,!0,b);for(const Y of this._drawWrappers)null===Y||void 0===Y||Y.dispose(b)}this._drawWrappers=[]}static AddToMesh(Y,b,C,R,q,A,E){return new g(Y,b,C,R,q,A,E,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(Y,b,C,R,q,A,E){let B=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],g=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=Y,this.verticesStart=b,this.verticesCount=C,this.indexStart=R,this.indexCount=q,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=A,this._renderingMesh=E||A,g&&A.ub.push(this),this._engine=this._mesh.uY().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=A.ub.length-1,B&&(this.refreshBoundingInfo(),A.Tb(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(Y){return this._boundingInfo=Y,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const Y=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return Y||this._renderingMesh}GY(){let Y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const b=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!b)return Y&&this._mesh.uY()._hasDefaultMaterial?this._mesh.uY().defaultMaterial:null;if(this._isMultiMaterial(b)){const Y=b.getSubMaterial(this.materialIndex);return this._currentMaterial!==Y&&(this._currentMaterial=Y,this.resetDrawCache()),Y}return b}_isMultiMaterial(Y){return void 0!==Y.getSubMaterial}refreshBoundingInfo(){let Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.Pb)return this;if(Y||(Y=this._renderingMesh.getVerticesData(R.e.PositionKind)),!Y)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const b=this._renderingMesh.zb();let C;if(0===this.indexStart&&this.indexCount===b.length){const Y=this._renderingMesh.getBoundingInfo();C={minimum:Y.minimum.clone(),maximum:Y.maximum.clone()}}else C=(0,E.e)(Y,b,this.indexStart,this.indexCount,this._renderingMesh.Pb.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(C.minimum,C.maximum):this._boundingInfo=new A.b(C.minimum,C.maximum),this}_checkCollision(Y){return this.getBoundingInfo()._checkCollision(Y)}updateBoundingInfo(Y){let b=this.getBoundingInfo();return b||(this.refreshBoundingInfo(),b=this.getBoundingInfo()),b&&b.update(Y),this}isInFrustum(Y){const b=this.getBoundingInfo();return!!b&&b.isInFrustum(Y,this._mesh.qy)}isCompletelyInFrustum(Y){const b=this.getBoundingInfo();return!!b&&b.isCompletelyInFrustum(Y)}render(Y){return this._renderingMesh.render(this,Y,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(Y,b){if(!this._linesIndexBuffer){const C=6*Math.floor(this.indexCount/3),R=this.verticesStart+this.verticesCount>65535?new Uint32Array(C):new Uint16Array(C);let q=0;if(0===Y.length)for(let Y=this.indexStart;Y<this.indexStart+this.indexCount;Y+=3)R[q++]=Y,R[q++]=Y+1,R[q++]=Y+1,R[q++]=Y+2,R[q++]=Y+2,R[q++]=Y;else for(let b=this.indexStart;b<this.indexStart+this.indexCount;b+=3)R[q++]=Y[b],R[q++]=Y[b+1],R[q++]=Y[b+1],R[q++]=Y[b+2],R[q++]=Y[b+2],R[q++]=Y[b];this._linesIndexBuffer=b.createIndexBuffer(R),this._linesIndexCount=R.length}return this._linesIndexBuffer}canIntersects(Y){const b=this.getBoundingInfo();return!!b&&Y.intersectsBox(b.boundingBox)}intersects(Y,b,C,R,q){const A=this.GY();if(!A)return null;let E=3,B=!1;switch(A.fillMode){case 3:case 5:case 6:case 8:return null;case 7:E=1,B=!0}return 4===A.fillMode?C.length?this._intersectLines(Y,b,C,this._mesh.intersectionThreshold,R):this._intersectUnIndexedLines(Y,b,C,this._mesh.intersectionThreshold,R):!C.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(Y,b,C,R,q):this._intersectTriangles(Y,b,C,E,B,R,q)}_intersectLines(Y,b,C,R,A){let E=null;for(let B=this.indexStart;B<this.indexStart+this.indexCount;B+=2){const g=b[C[B]],r=b[C[B+1]],O=Y.intersectionSegment(g,r,R);if(!(O<0)&&((A||!E||O<E.distance)&&(E=new q.b(null,null,O),E.faceId=B/2,A)))break}return E}_intersectUnIndexedLines(Y,b,C,R,A){let E=null;for(let B=this.verticesStart;B<this.verticesStart+this.verticesCount;B+=2){const C=b[B],g=b[B+1],r=Y.intersectionSegment(C,g,R);if(!(r<0)&&((A||!E||r<E.distance)&&(E=new q.b(null,null,r),E.faceId=B/2,A)))break}return E}_intersectTriangles(Y,b,C,R,q,A,E){let B=null,g=-1;for(let r=this.indexStart;r<this.indexStart+this.indexCount-(3-R);r+=R){g++;const R=C[r],O=C[r+1],F=C[r+2];if(q&&4294967295===F){r+=2;continue}const y=b[R],S=b[O],n=b[F];if(!y||!S||!n)continue;if(E&&!E(y,S,n,Y,R,O,F))continue;const t=Y.intersectsTriangle(y,S,n);if(t){if(t.distance<0)continue;if((A||!B||t.distance<B.distance)&&(B=t,B.faceId=g,A))break}}return B}_intersectUnIndexedTriangles(Y,b,C,R,q){let A=null;for(let E=this.verticesStart;E<this.verticesStart+this.verticesCount;E+=3){const C=b[E],B=b[E+1],g=b[E+2];if(q&&!q(C,B,g,Y,-1,-1,-1))continue;const r=Y.intersectsTriangle(C,B,g);if(r){if(r.distance<0)continue;if((R||!A||r.distance<A.distance)&&(A=r,A.faceId=E/3,R))break}}return A}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(Y,b){const C=new g(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,Y,b,!1);if(!this.IsGlobal){const Y=this.getBoundingInfo();if(!Y)return C;C._boundingInfo=new A.b(Y.minimum,Y.maximum)}return C}dispose(){let Y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.uY().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const b=this._mesh.ub.indexOf(this);this._mesh.ub.splice(b,1),this.resetDrawCache(void 0,Y)}getClassName(){return"SubMesh"}static CreateFromIndices(Y,b,C,R,q){let A=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],E=Number.MAX_VALUE,B=-Number.MAX_VALUE;const r=(q||R).zb();for(let g=b;g<b+C;g++){const Y=r[g];Y<E&&(E=Y),Y>B&&(B=Y)}return new g(Y,E,B-E+1,b,C,R,q,A)}}}}]);