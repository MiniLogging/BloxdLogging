"use strict";(self["80dd64vgxnn"]=self["80dd64vgxnn"]||[]).push([[24],{13062:(mm,o,u)=>{u.d(o,{c:()=>f});class f{constructor(mm,o,u){this.bu=mm,this.bv=o,this.distance=u,this.faceId=0,this.subMeshId=0}}},13072:(mm,o,u)=>{u.d(o,{b:()=>r});var f=u(12748),B=u(12740),O=u(12746);class r{constructor(mm,o,u){this.vectors=(0,f.b)(8,B.lo.Zero),this.center=B.lo.Zero(),this.centerWorld=B.lo.Zero(),this.extendSize=B.lo.Zero(),this.extendSizeWorld=B.lo.Zero(),this.directions=(0,f.b)(3,B.lo.Zero),this.vectorsWorld=(0,f.b)(8,B.lo.Zero),this.minimumWorld=B.lo.Zero(),this.maximumWorld=B.lo.Zero(),this.minimum=B.lo.Zero(),this.maximum=B.lo.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(mm,o,u)}reConstruct(mm,o,u){const f=mm.x,O=mm.y,r=mm.z,w=o.x,p=o.y,K=o.z,z=this.vectors;this.minimum.Op(f,O,r),this.maximum.Op(w,p,K),z[0].Op(f,O,r),z[1].Op(w,p,K),z[2].Op(w,O,r),z[3].Op(f,p,r),z[4].Op(f,O,K),z[5].Op(w,p,r),z[6].Op(f,p,K),z[7].Op(w,O,K),o.addToRef(mm,this.center).scaleInPlace(.5),o.subtractToRef(mm,this.extendSize).scaleInPlace(.5),this._worldMatrix=u||B.Matrix.IdentityReadOnly,this._update(this._worldMatrix)}scale(mm){const o=r._TmpVector3,u=this.maximum.subtractToRef(this.minimum,o[0]),f=u.length();u.normalizeFromLength(f);const B=f*mm,O=u.scaleInPlace(.5*B),w=this.center.subtractToRef(O,o[1]),p=this.center.addToRef(O,o[2]);return this.reConstruct(w,p,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(mm){const o=this.minimumWorld,u=this.maximumWorld,f=this.directions,O=this.vectorsWorld,r=this.vectors;if(mm.isIdentity()){o.p(this.minimum),u.p(this.maximum);for(let mm=0;mm<8;++mm)O[mm].p(r[mm]);this.extendSizeWorld.p(this.extendSize),this.centerWorld.p(this.center)}else{o.wp(Number.MAX_VALUE),u.wp(-Number.MAX_VALUE);for(let f=0;f<8;++f){const w=O[f];B.lo.TransformCoordinatesToRef(r[f],mm,w),o.minimizeInPlace(w),u.maximizeInPlace(w)}u.subtractToRef(o,this.extendSizeWorld).scaleInPlace(.5),u.addToRef(o,this.centerWorld).scaleInPlace(.5)}B.lo.FromArrayToRef(mm.m,0,f[0]),B.lo.FromArrayToRef(mm.m,4,f[1]),B.lo.FromArrayToRef(mm.m,8,f[2]),this._worldMatrix=mm}isInFrustum(mm){return r.IsInFrustum(this.vectorsWorld,mm)}isCompletelyInFrustum(mm){return r.IsCompletelyInFrustum(this.vectorsWorld,mm)}intersectsPoint(mm){const o=this.minimumWorld,u=this.maximumWorld,f=o.x,B=o.y,r=o.z,w=u.x,p=u.y,K=u.z,z=mm.x,Y=mm.y,q=mm.z,x=-O.e;return!(w-z<x||x>z-f)&&(!(p-Y<x||x>Y-B)&&!(K-q<x||x>q-r))}intersectsSphere(mm){return r.IntersectsSphere(this.minimumWorld,this.maximumWorld,mm.centerWorld,mm.radiusWorld)}intersectsMinMax(mm,o){const u=this.minimumWorld,f=this.maximumWorld,B=u.x,O=u.y,r=u.z,w=f.x,p=f.y,K=f.z,z=mm.x,Y=mm.y,q=mm.z,x=o.x,H=o.y,E=o.z;return!(w<z||B>x)&&(!(p<Y||O>H)&&!(K<q||r>E))}dispose(){var mm,o;null===(mm=this._drawWrapperFront)||void 0===mm||mm.dispose(),null===(o=this._drawWrapperBack)||void 0===o||o.dispose()}static Intersects(mm,o){return mm.intersectsMinMax(o.minimumWorld,o.maximumWorld)}static IntersectsSphere(mm,o,u,f){const O=r._TmpVector3[0];B.lo.ClampToRef(u,mm,o,O);return B.lo.DistanceSquared(u,O)<=f*f}static IsCompletelyInFrustum(mm,o){for(let u=0;u<6;++u){const f=o[u];for(let o=0;o<8;++o)if(f.dotCoordinate(mm[o])<0)return!1}return!0}static IsInFrustum(mm,o){for(let u=0;u<6;++u){let f=!0;const B=o[u];for(let o=0;o<8;++o)if(B.dotCoordinate(mm[o])>=0){f=!1;break}if(f)return!1}return!0}}r._TmpVector3=(0,f.b)(3,B.lo.Zero)},13065:(mm,o,u)=>{u.d(o,{e:()=>Y});var f=u(12748),B=u(12740),O=u(13072),r=u(13076);const w={min:0,max:0},p={min:0,max:0},K=(mm,o,u)=>{const f=B.lo.Dot(o.centerWorld,mm),O=Math.abs(B.lo.Dot(o.directions[0],mm))*o.extendSize.x+Math.abs(B.lo.Dot(o.directions[1],mm))*o.extendSize.y+Math.abs(B.lo.Dot(o.directions[2],mm))*o.extendSize.z;u.min=f-O,u.max=f+O},z=(mm,o,u)=>(K(mm,o,w),K(mm,u,p),!(w.min>p.max||p.min>w.max));class Y{constructor(mm,o,u){this._isLocked=!1,this.boundingBox=new O.b(mm,o,u),this.boundingSphere=new r.d(mm,o,u)}reConstruct(mm,o,u){this.boundingBox.reConstruct(mm,o,u),this.boundingSphere.reConstruct(mm,o,u)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(mm){this._isLocked=mm}update(mm){this._isLocked||(this.boundingBox._update(mm),this.boundingSphere._update(mm))}centerOn(mm,o){const u=Y._TmpVector3[0].p(mm).LY(o),f=Y._TmpVector3[1].p(mm).addInPlace(o);return this.boundingBox.reConstruct(u,f,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(u,f,this.boundingBox.getWorldMatrix()),this}encapsulate(mm){const o=B.lo.Minimize(this.minimum,mm),u=B.lo.Maximize(this.maximum,mm);return this.reConstruct(o,u,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(mm){const o=B.TmpVectors.Matrix[0];this.boundingBox.getWorldMatrix().invertToRef(o);const u=B.TmpVectors.lo[0];return B.lo.TransformCoordinatesToRef(mm.boundingBox.minimumWorld,o,u),this.encapsulate(u),B.lo.TransformCoordinatesToRef(mm.boundingBox.maximumWorld,o,u),this.encapsulate(u),this}scale(mm){return this.boundingBox.scale(mm),this.boundingSphere.scale(mm),this}isInFrustum(mm){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===o||3===o)&&this.boundingSphere.isCenterInFrustum(mm))return!0;if(!this.boundingSphere.isInFrustum(mm))return!1;return!(1!==o&&3!==o)||this.boundingBox.isInFrustum(mm)}get diagonalLength(){const mm=this.boundingBox;return mm.maximumWorld.subtractToRef(mm.minimumWorld,Y._TmpVector3[0]).length()}isCompletelyInFrustum(mm){return this.boundingBox.isCompletelyInFrustum(mm)}_checkCollision(mm){return mm._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(mm){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(mm)&&!!this.boundingBox.intersectsPoint(mm))}intersects(mm,o){if(!r.d.Intersects(this.boundingSphere,mm.boundingSphere))return!1;if(!O.b.Intersects(this.boundingBox,mm.boundingBox))return!1;if(!o)return!0;const u=this.boundingBox,f=mm.boundingBox;return!!z(u.directions[0],u,f)&&(!!z(u.directions[1],u,f)&&(!!z(u.directions[2],u,f)&&(!!z(f.directions[0],u,f)&&(!!z(f.directions[1],u,f)&&(!!z(f.directions[2],u,f)&&(!!z(B.lo.Cross(u.directions[0],f.directions[0]),u,f)&&(!!z(B.lo.Cross(u.directions[0],f.directions[1]),u,f)&&(!!z(B.lo.Cross(u.directions[0],f.directions[2]),u,f)&&(!!z(B.lo.Cross(u.directions[1],f.directions[0]),u,f)&&(!!z(B.lo.Cross(u.directions[1],f.directions[1]),u,f)&&(!!z(B.lo.Cross(u.directions[1],f.directions[2]),u,f)&&(!!z(B.lo.Cross(u.directions[2],f.directions[0]),u,f)&&(!!z(B.lo.Cross(u.directions[2],f.directions[1]),u,f)&&!!z(B.lo.Cross(u.directions[2],f.directions[2]),u,f))))))))))))))}}Y._TmpVector3=(0,f.b)(2,B.lo.Zero)},13076:(mm,o,u)=>{u.d(o,{d:()=>O});var f=u(12748),B=u(12740);class O{constructor(mm,o,u){this.center=B.lo.Zero(),this.centerWorld=B.lo.Zero(),this.minimum=B.lo.Zero(),this.maximum=B.lo.Zero(),this.reConstruct(mm,o,u)}reConstruct(mm,o,u){this.minimum.p(mm),this.maximum.p(o);const f=B.lo.Distance(mm,o);o.addToRef(mm,this.center).scaleInPlace(.5),this.radius=.5*f,this._update(u||B.Matrix.IdentityReadOnly)}scale(mm){const o=this.radius*mm,u=O._TmpVector3,f=u[0].wp(o),B=this.center.subtractToRef(f,u[1]),r=this.center.addToRef(f,u[2]);return this.reConstruct(B,r,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(mm){if(mm.isIdentity())this.centerWorld.p(this.center),this.radiusWorld=this.radius;else{B.lo.TransformCoordinatesToRef(this.center,mm,this.centerWorld);const o=O._TmpVector3[0];B.lo.TransformNormalFromFloatsToRef(1,1,1,mm,o),this.radiusWorld=Math.max(Math.abs(o.x),Math.abs(o.y),Math.abs(o.z))*this.radius}}isInFrustum(mm){const o=this.centerWorld,u=this.radiusWorld;for(let f=0;f<6;f++)if(mm[f].dotCoordinate(o)<=-u)return!1;return!0}isCenterInFrustum(mm){const o=this.centerWorld;for(let u=0;u<6;u++)if(mm[u].dotCoordinate(o)<0)return!1;return!0}intersectsPoint(mm){const o=B.lo.DistanceSquared(this.centerWorld,mm);return!(this.radiusWorld*this.radiusWorld<o)}static Intersects(mm,o){const u=B.lo.DistanceSquared(mm.centerWorld,o.centerWorld),f=mm.radiusWorld+o.radiusWorld;return!(f*f<u)}static CreateFromCenterAndRadius(mm,o,u){this._TmpVector3[0].p(mm),this._TmpVector3[1].Op(0,0,o),this._TmpVector3[2].p(mm),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].LY(this._TmpVector3[1]);const f=new O(this._TmpVector3[0],this._TmpVector3[2]);return f._worldMatrix=u||B.Matrix.Identity(),f}}O._TmpVector3=(0,f.b)(3,B.lo.Zero)},13093:(mm,o,u)=>{function f(mm){-1===mm.indexOf("vClipPlane")&&mm.push("vClipPlane"),-1===mm.indexOf("vClipPlane2")&&mm.push("vClipPlane2"),-1===mm.indexOf("vClipPlane3")&&mm.push("vClipPlane3"),-1===mm.indexOf("vClipPlane4")&&mm.push("vClipPlane4"),-1===mm.indexOf("vClipPlane5")&&mm.push("vClipPlane5"),-1===mm.indexOf("vClipPlane6")&&mm.push("vClipPlane6")}function B(mm,o,u){const f=!!(mm.clipPlane??o.clipPlane),B=!!(mm.clipPlane2??o.clipPlane2),O=!!(mm.clipPlane3??o.clipPlane3),r=!!(mm.clipPlane4??o.clipPlane4),w=!!(mm.clipPlane5??o.clipPlane5),p=!!(mm.clipPlane6??o.clipPlane6);f&&u.push("#define CLIPPLANE"),B&&u.push("#define CLIPPLANE2"),O&&u.push("#define CLIPPLANE3"),r&&u.push("#define CLIPPLANE4"),w&&u.push("#define CLIPPLANE5"),p&&u.push("#define CLIPPLANE6")}function O(mm,o,u){let f=!1;const B=!!(mm.clipPlane??o.clipPlane),O=!!(mm.clipPlane2??o.clipPlane2),r=!!(mm.clipPlane3??o.clipPlane3),w=!!(mm.clipPlane4??o.clipPlane4),p=!!(mm.clipPlane5??o.clipPlane5),K=!!(mm.clipPlane6??o.clipPlane6);return u.CLIPPLANE!==B&&(u.CLIPPLANE=B,f=!0),u.CLIPPLANE2!==O&&(u.CLIPPLANE2=O,f=!0),u.CLIPPLANE3!==r&&(u.CLIPPLANE3=r,f=!0),u.CLIPPLANE4!==w&&(u.CLIPPLANE4=w,f=!0),u.CLIPPLANE5!==p&&(u.CLIPPLANE5=p,f=!0),u.CLIPPLANE6!==K&&(u.CLIPPLANE6=K,f=!0),f}function r(mm,o,u){let f=o.clipPlane??u.clipPlane;w(mm,"vClipPlane",f),f=o.clipPlane2??u.clipPlane2,w(mm,"vClipPlane2",f),f=o.clipPlane3??u.clipPlane3,w(mm,"vClipPlane3",f),f=o.clipPlane4??u.clipPlane4,w(mm,"vClipPlane4",f),f=o.clipPlane5??u.clipPlane5,w(mm,"vClipPlane5",f),f=o.clipPlane6??u.clipPlane6,w(mm,"vClipPlane6",f)}function w(mm,o,u){u&&mm.setFloat4(o,u.normal.x,u.normal.y,u.normal.z,u.d)}u.d(o,{e:()=>f,h:()=>r,i:()=>O,l:()=>B})},13037:(mm,o,u)=>{u.d(o,{e:()=>f});class f{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(mm,o){this._defines[mm]||(mm<this._currentRank&&(this._currentRank=mm),mm>this._maxRank&&(this._maxRank=mm),this._defines[mm]=new Array),this._defines[mm].push(o)}addCPUSkinningFallback(mm,o){this._mesh=o,mm<this._currentRank&&(this._currentRank=mm),mm>this._maxRank&&(this._maxRank=mm)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(mm,o){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,mm=mm.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),o._bonesComputationForcedToCPU=!0;const u=this._mesh.Pm();for(let mm=0;mm<u.meshes.length;mm++){const f=u.meshes[mm];if(f.material){if(f.computeBonesUsingShaders&&0!==f.numBoneInfluencers)if(f.material.getEffect()===o)f.computeBonesUsingShaders=!1;else if(f.kf)for(const mm of f.kf){if(mm.effect===o){f.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&f.computeBonesUsingShaders&&f.numBoneInfluencers>0&&(f.computeBonesUsingShaders=!1)}}else{const o=this._defines[this._currentRank];if(o)for(let u=0;u<o.length;u++)mm=mm.replace("#define "+o[u],"");this._currentRank++}return mm}}},13050:(mm,o,u)=>{u.d(o,{c:()=>M});var f=u(12729),B=u(12732),O=u(12549),r=u(12556),w=u(12596),p=u(13057),K=u(12989),z=u(12565),Y=u(12783),q=u(12855),x=u(12766);class H{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(mm){this._func=mm}get funcRef(){return this._funcRef}set funcRef(mm){this._funcRef=mm}get funcMask(){return this._funcMask}set funcMask(mm){this._funcMask=mm}get opStencilFail(){return this._opStencilFail}set opStencilFail(mm){this._opStencilFail=mm}get opDepthFail(){return this._opDepthFail}set opDepthFail(mm){this._opDepthFail=mm}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(mm){this._opStencilDepthPass=mm}get mask(){return this._mask}set mask(mm){this._mask=mm}get enabled(){return this._enabled}set enabled(mm){this._enabled=mm}getClassName(){return"MaterialStencilState"}copyTo(mm){x.c.Clone((()=>mm),this)}serialize(){return x.c.Serialize(this)}parse(mm,o,u){x.c.Parse((()=>this),mm,o,u)}}(0,f.d)([(0,B.J)()],H.prototype,"func",null),(0,f.d)([(0,B.J)()],H.prototype,"funcRef",null),(0,f.d)([(0,B.J)()],H.prototype,"funcMask",null),(0,f.d)([(0,B.J)()],H.prototype,"opStencilFail",null),(0,f.d)([(0,B.J)()],H.prototype,"opDepthFail",null),(0,f.d)([(0,B.J)()],H.prototype,"opStencilDepthPass",null),(0,f.d)([(0,B.J)()],H.prototype,"mask",null),(0,f.d)([(0,B.J)()],H.prototype,"enabled",null);var E=u(13088);class M{get _supportGlowLayer(){return!1}set _glowModeEnabled(mm){}get shaderLanguage(){return this._shaderLanguage}get canRenderToMRT(){return!1}set alpha(mm){if(this._alpha===mm)return;const o=this._alpha;this._alpha=mm,1!==o&&1!==mm||this.cz(M.MiscDirtyFlag+M.PrePassDirtyFlag)}get alpha(){return this._alpha}set Bp(mm){this._backFaceCulling!==mm&&(this._backFaceCulling=mm,this.cz(M.TextureDirtyFlag))}get Bp(){return this._backFaceCulling}set cullBackFaces(mm){this._cullBackFaces!==mm&&(this._cullBackFaces=mm,this.cz(M.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(mm){this._blockDirtyMechanism!==mm&&(this._blockDirtyMechanism=mm,mm||this.cq())}atomicMaterialsUpdate(mm){this.blockDirtyMechanism=!0;try{mm(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(mm){this._onDisposeObserver&&this.Jf.remove(this._onDisposeObserver),this._onDisposeObserver=this.Jf.add(mm)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new r.d),this._onBindObservable}set onBind(mm){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(mm)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new r.d),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new r.d),this._onEffectCreatedObservable}set alphaMode(mm){this._alphaMode!==mm&&(this._alphaMode=mm,this.cz(M.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(mm){this._needDepthPrePass!==mm&&(this._needDepthPrePass=mm,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(mm){this._fogEnabled!==mm&&(this._fogEnabled=mm,this.cz(M.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case M.WireFrameFillMode:case M.LineListDrawMode:case M.LineLoopDrawMode:case M.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(mm){this.fillMode=mm?M.WireFrameFillMode:M.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case M.PointFillMode:case M.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(mm){this.fillMode=mm?M.PointFillMode:M.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(mm){this._fillMode!==mm&&(this._fillMode=mm,this.cz(M.MiscDirtyFlag))}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(mm){const o=this.Pm().getEngine().getCaps().fragmentDepthSupported;mm&&!o&&z.e.Warn("Logarithmic depth has been requested for a material on a device that doesn't support it."),this._useLogarithmicDepth=mm&&o,this._markAllSubMeshesAsMiscDirty()}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(mm){this._drawWrapper=mm}constructor(mm,o,u){let f=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this._shaderLanguage=0,this._forceGLSL=!1,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.sideOrientation=null,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.Jf=new r.d,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.Nf=new H,this._useUBO=!1,this._fillMode=M.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._transparencyMode=null,this.name=mm;const B=o||w.d.LastCreatedScene;B&&(this._scene=B,this._dirtyCallbacks={},this._forceGLSL=f,this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[127]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=mm||O.Tools.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new q.c(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._uniformBuffer=new K.c(this._scene.getEngine(),void 0,void 0,mm),this._useUBO=this.Pm().getEngine().supportsUniformBuffers,this._createUniformBuffer(),u||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),M.OnEventObservable.notifyObservers(this,1))}_createUniformBuffer(){var mm;const o=this.Pm().getEngine();null===(mm=this._uniformBuffer)||void 0===mm||mm.dispose(),o.isWebGPU&&!this._forceGLSL?(this._uniformBuffer=new K.c(o,void 0,void 0,this.name,!0),this._shaderLanguage=1):this._uniformBuffer=new K.c(this._scene.getEngine(),void 0,void 0,this.name),this._uniformBufferLayoutBuilt=!1}toString(mm){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.cq(),this.checkReadyOnlyOnce=!0}unfreeze(){this.cq(),this.checkReadyOnlyOnce=!1}isReady(mm,o){return!0}isReadyForSubMesh(mm,o,u){const f=o.materialDefines;return!!f&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=f,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}Pm(){return this._scene}_getEffectiveOrientation(mm){return null!==this.sideOrientation?this.sideOrientation:mm.sideOrientation}get transparencyMode(){return this._transparencyMode}set transparencyMode(mm){this._transparencyMode!==mm&&(this._transparencyMode=mm,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _hasTransparencyMode(){return null!=this._transparencyMode}get _transparencyModeIsBlend(){return this._transparencyMode===M.MATERIAL_ALPHABLEND||this._transparencyMode===M.MATERIAL_ALPHATESTANDBLEND}get _transparencyModeIsTest(){return this._transparencyMode===M.MATERIAL_ALPHATEST||this._transparencyMode===M.MATERIAL_ALPHATESTANDBLEND}get _disableAlphaBlending(){return this._transparencyMode===M.MATERIAL_OPAQUE||this._transparencyMode===M.MATERIAL_ALPHATEST}needAlphaBlending(){return this._hasTransparencyMode?this._transparencyModeIsBlend:!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(mm){return this._hasTransparencyMode?this._transparencyModeIsBlend:mm.visibility<1||!this._disableAlphaBlending&&(mm.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._hasTransparencyMode&&this._transparencyModeIsTest}needAlphaTestingForMesh(mm){return this._hasTransparencyMode?this._transparencyModeIsTest:!this.needAlphaBlendingForMesh(mm)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}cq(){let mm=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=this.Pm().meshes;for(const u of o)if(u.kf)for(const o of u.kf)if(o.Gm()===this)for(const u of o._drawWrappers)u&&this._materialContext===u.materialContext&&(u._wasPreviouslyReady=!1,u._wasPreviouslyUsingInstances=null,u._forceRebindOnNextCall=mm);mm&&this.cz(M.AllDirtyFlag)}_preBind(mm){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const u=this._scene.getEngine(),f=(null==o?this.sideOrientation:o)===M.ClockWiseSideOrientation;return u.enableEffect(mm||this._getDrawWrapper()),u.setState(this.Bp,this.zOffset,!1,f,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.Nf,this.zOffsetUnits),f}bind(mm,o){}buildUniformLayout(){const mm=this._uniformBuffer;this._eventInfo.ubo=mm,this._callbackPluginEventGeneric(8,this._eventInfo),mm.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(mm,o,u){const f=u._drawWrapper;this._eventInfo.subMesh=u,this._callbackPluginEventBindForSubMesh(this._eventInfo),f._forceRebindOnNextCall=!1}bindOnlyWorldMatrix(mm){}bindView(mm){this._useUBO?this._needToBindSceneUbo=!0:mm.setMatrix("view",this.Pm().getViewMatrix())}bindViewProjection(mm){this._useUBO?this._needToBindSceneUbo=!0:(mm.setMatrix("viewProjection",this.Pm().getTransformMatrix()),mm.setMatrix("projection",this.Pm().getProjectionMatrix()))}bindEyePosition(mm,o){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(mm,o)}_afterBind(mm){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&o&&(this._needToBindSceneUbo=!1,(0,E.q)(o,this.Pm().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=mm?mm.visibility:1,this._onBindObservable&&mm&&this._onBindObservable.notifyObservers(mm),this.disableDepthWrite){const mm=this._scene.getEngine();this._cachedDepthWriteState=mm.getDepthWrite(),mm.setDepthWrite(!1)}if(this.disableColorWrite){const mm=this._scene.getEngine();this._cachedColorWriteState=mm.getColorWrite(),mm.setColorWrite(!1)}if(0!==this.depthFunction){const mm=this._scene.getEngine();this._cachedDepthFunctionState=mm.getDepthFunction()||0,mm.setDepthFunction(this.depthFunction)}}unbind(){if(this._scene.getSceneUniformBuffer().unbindEffect(),this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(256,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(512,this._eventInfo),this._eventInfo.activeTextures}hasTexture(mm){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=mm,this._callbackPluginEventGeneric(1024,this._eventInfo),this._eventInfo.hasTexture}clone(mm){return null}_clonePlugins(mm,o){const u={};if(this._serializePlugins(u),M._ParsePlugins(u,mm,this._scene,o),this.pluginManager)for(const f of this.pluginManager._plugins){const o=mm.pluginManager.getPlugin(f.name);o&&f.copyTo(o)}}getBindedMeshes(){if(this.meshMap){const mm=[];for(const o in this.meshMap){const u=this.meshMap[o];u&&mm.push(u)}return mm}return this._scene.meshes.filter((mm=>mm.material===this))}forceCompilation(mm,o,u,f){const B={clipPlane:!1,useInstances:!1,...u},O=this.Pm(),r=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const w=()=>{if(!this._scene||!this._scene.getEngine())return;const u=O.clipPlane;if(B.clipPlane&&(O.clipPlane=new Y.c(0,0,0,1)),this._storeEffectOnSubMeshes){let u=!0,O=null;if(mm.kf){const o=new p.c(0,0,0,0,0,mm,void 0,!1,!1);o.materialDefines&&(o.materialDefines._renderId=-1),this.isReadyForSubMesh(mm,o,B.useInstances)||(o.effect&&o.effect.getCompilationError()&&o.effect.allFallbacksProcessed()?O=o.effect.getCompilationError():(u=!1,setTimeout(w,16)))}u&&(this.allowShaderHotSwapping=r,O&&f&&f(O),o&&o(this))}else this.isReady()?(this.allowShaderHotSwapping=r,o&&o(this)):setTimeout(w,16);B.clipPlane&&(O.clipPlane=u)};w()}async forceCompilationAsync(mm,o){return await new Promise(((u,f)=>{this.forceCompilation(mm,(()=>{u()}),o,(mm=>{f(mm)}))}))}cz(mm){this.Pm().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(M._DirtyCallbackArray.length=0,mm&M.ImageProcessingDirtyFlag&&M._DirtyCallbackArray.push(M._ImageProcessingDirtyCallBack),mm&M.TextureDirtyFlag&&M._DirtyCallbackArray.push(M._TextureDirtyCallBack),mm&M.LightDirtyFlag&&M._DirtyCallbackArray.push(M._LightsDirtyCallBack),mm&M.FresnelDirtyFlag&&M._DirtyCallbackArray.push(M._FresnelDirtyCallBack),mm&M.AttributesDirtyFlag&&M._DirtyCallbackArray.push(M._AttributeDirtyCallBack),mm&M.MiscDirtyFlag&&M._DirtyCallbackArray.push(M._MiscDirtyCallBack),mm&M.PrePassDirtyFlag&&M._DirtyCallbackArray.push(M._PrePassDirtyCallBack),M._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(M._RunDirtyCallBacks),this.Pm().resetCachedMaterial())}resetDrawCache(){const mm=this.Pm().meshes;for(const o of mm)if(o.kf)for(const mm of o.kf)mm.Gm()===this&&mm.resetDrawCache()}_markAllSubMeshesAsDirty(mm){const o=this.Pm();if(o.blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const u=o.meshes;for(const f of u)if(f.kf)for(const u of f.kf){if((u.Gm()||(o._hasDefaultMaterial?o.defaultMaterial:null))===this)for(const o of u._drawWrappers)o&&o.defines&&o.defines.markAllAsDirty&&this._materialContext===o.materialContext&&mm(o.defines)}}_markScenePrePassDirty(){if(this.Pm().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const mm=this.Pm().enablePrePassRenderer();mm&&mm.cz()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(M._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(M._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(M._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(M._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(M._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(M._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(M._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(M._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(M._PrePassDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(M._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(0!==this._scene.performancePriority){this.checkReadyOnlyOnce=!0;const mm=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.Jf.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(mm)}))}}setPrePassRenderer(mm){return!1}dispose(mm,o,u){const f=this.Pm();if(f.stopAnimation(this),f.freeProcessedMaterials(),f.removeMaterial(this),this._eventInfo.forceDisposeTextures=o,this._callbackPluginEventGeneric(2,this._eventInfo),this._parentContainer){const mm=this._parentContainer.materials.indexOf(this);mm>-1&&this._parentContainer.materials.splice(mm,1),this._parentContainer=null}if(!0!==u)if(this.meshMap)for(const B in this.meshMap){const mm=this.meshMap[B];this._disposeMeshResources(mm)}else{const mm=f.meshes;for(const o of mm)this._disposeMeshResources(o)}this._uniformBuffer.dispose(),this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.Jf.notifyObservers(this),this.Jf.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}_disposeMeshResources(mm){if(!mm)return;const o=mm.br,u=mm._internalAbstractMeshDataInfo._materialForRenderPass;if(this._storeEffectOnSubMeshes){if(mm.kf&&u)for(const B of mm.kf){const mm=B._drawWrappers;for(let O=0;O<mm.length;O++){var f;const r=null===(f=mm[O])||void 0===f?void 0:f.effect;if(!r)continue;u[O]===this&&(null===o||void 0===o||o._releaseVertexArrayObject(r),B._removeDrawWrapper(O,!0,!0))}}}else null===o||void 0===o||o._releaseVertexArrayObject(this._drawWrapper.effect);mm.material!==this||mm.sourceMesh||(mm.material=null)}serialize(){const mm=x.c.Serialize(this);return mm.Nf=this.Nf.serialize(),mm.uniqueId=this.uniqueId,this._serializePlugins(mm),mm}_serializePlugins(mm){if(mm.plugins={},this.pluginManager)for(const o of this.pluginManager._plugins)o.doNotSerialize||(mm.plugins[o.getClassName()]=o.serialize())}static Parse(mm,o,u){if(mm.customType){if("BABYLON.PBRMaterial"===mm.customType&&mm.overloadedAlbedo&&(mm.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return z.e.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else mm.customType="BABYLON.StandardMaterial";const f=O.Tools.Instantiate(mm.customType).Parse(mm,o,u);return f._loadedUniqueId=mm.uniqueId,f}static _ParsePlugins(mm,o,u,f){if(mm.plugins)for(const w in mm.plugins){var B,r;const p=mm.plugins[w];let K=null===(B=o.pluginManager)||void 0===B?void 0:B.getPlugin(p.name);if(!K){const mm=O.Tools.Instantiate("BABYLON."+w);mm&&(K=new mm(o))}null===(r=K)||void 0===r||r.parse(p,u,f)}}}M.TriangleFillMode=0,M.WireFrameFillMode=1,M.PointFillMode=2,M.PointListDrawMode=3,M.LineListDrawMode=4,M.LineLoopDrawMode=5,M.LineStripDrawMode=6,M.TriangleStripDrawMode=7,M.TriangleFanDrawMode=8,M.ClockWiseSideOrientation=0,M.CounterClockWiseSideOrientation=1,M.ImageProcessingDirtyFlag=64,M.TextureDirtyFlag=1,M.LightDirtyFlag=2,M.FresnelDirtyFlag=4,M.AttributesDirtyFlag=8,M.MiscDirtyFlag=16,M.PrePassDirtyFlag=32,M.AllDirtyFlag=127,M.MATERIAL_OPAQUE=0,M.MATERIAL_ALPHATEST=1,M.MATERIAL_ALPHABLEND=2,M.MATERIAL_ALPHATESTANDBLEND=3,M.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,M.MATERIAL_NORMALBLENDMETHOD_RNM=1,M.OnEventObservable=new r.d,M._AllDirtyCallBack=mm=>mm.markAllAsDirty(),M._ImageProcessingDirtyCallBack=mm=>mm.markAsImageProcessingDirty(),M._TextureDirtyCallBack=mm=>mm.markAsTexturesDirty(),M._FresnelDirtyCallBack=mm=>mm.markAsFresnelDirty(),M._MiscDirtyCallBack=mm=>mm.markAsMiscDirty(),M._PrePassDirtyCallBack=mm=>mm.markAsPrePassDirty(),M._LightsDirtyCallBack=mm=>mm.markAsLightDirty(),M._AttributeDirtyCallBack=mm=>mm.markAsAttributesDirty(),M._FresnelAndMiscDirtyCallBack=mm=>{M._FresnelDirtyCallBack(mm),M._MiscDirtyCallBack(mm)},M._TextureAndMiscDirtyCallBack=mm=>{M._TextureDirtyCallBack(mm),M._MiscDirtyCallBack(mm)},M._DirtyCallbackArray=[],M._RunDirtyCallBacks=mm=>{for(const o of M._DirtyCallbackArray)o(mm)},(0,f.d)([(0,B.J)()],M.prototype,"id",void 0),(0,f.d)([(0,B.J)()],M.prototype,"uniqueId",void 0),(0,f.d)([(0,B.J)()],M.prototype,"name",void 0),(0,f.d)([(0,B.J)()],M.prototype,"metadata",void 0),(0,f.d)([(0,B.J)()],M.prototype,"checkReadyOnEveryCall",void 0),(0,f.d)([(0,B.J)()],M.prototype,"checkReadyOnlyOnce",void 0),(0,f.d)([(0,B.J)()],M.prototype,"state",void 0),(0,f.d)([(0,B.J)("alpha")],M.prototype,"_alpha",void 0),(0,f.d)([(0,B.J)("Bp")],M.prototype,"_backFaceCulling",void 0),(0,f.d)([(0,B.J)("cullBackFaces")],M.prototype,"_cullBackFaces",void 0),(0,f.d)([(0,B.J)()],M.prototype,"sideOrientation",void 0),(0,f.d)([(0,B.J)("alphaMode")],M.prototype,"_alphaMode",void 0),(0,f.d)([(0,B.J)()],M.prototype,"_needDepthPrePass",void 0),(0,f.d)([(0,B.J)()],M.prototype,"disableDepthWrite",void 0),(0,f.d)([(0,B.J)()],M.prototype,"disableColorWrite",void 0),(0,f.d)([(0,B.J)()],M.prototype,"forceDepthWrite",void 0),(0,f.d)([(0,B.J)()],M.prototype,"depthFunction",void 0),(0,f.d)([(0,B.J)()],M.prototype,"separateCullingPass",void 0),(0,f.d)([(0,B.J)("fogEnabled")],M.prototype,"_fogEnabled",void 0),(0,f.d)([(0,B.J)()],M.prototype,"pointSize",void 0),(0,f.d)([(0,B.J)()],M.prototype,"zOffset",void 0),(0,f.d)([(0,B.J)()],M.prototype,"zOffsetUnits",void 0),(0,f.d)([(0,B.J)()],M.prototype,"pointsCloud",null),(0,f.d)([(0,B.J)()],M.prototype,"fillMode",null),(0,f.d)([(0,B.J)()],M.prototype,"useLogarithmicDepth",null),(0,f.d)([(0,B.J)()],M.prototype,"transparencyMode",null)},13088:(mm,o,u)=>{u.d(o,{A:()=>P,C:()=>x,F:()=>q,I:()=>A,J:()=>c,N:()=>W,Q:()=>l,U:()=>g,W:()=>y,_:()=>I,ab:()=>s,e:()=>b,eb:()=>a,f:()=>Y,g:()=>N,hb:()=>H,k:()=>z,o:()=>E,q:()=>M,r:()=>t,u:()=>R,v:()=>Q,x:()=>S});var f=u(12565),B=u(12780),O=u(12596),r=u(13033),w=u(13093);const p=B.No.Black(),K={NUM_MORPH_INFLUENCERS:0,NORMAL:!1,TANGENT:!1,UV:!1,UV2:!1,COLOR:!1};function z(mm,o,u){if(!mm||mm.LOGARITHMICDEPTH||mm.indexOf&&mm.indexOf("LOGARITHMICDEPTH")>=0){const mm=u.activeCamera;1===mm.mode&&f.e.Error("Logarithmic depth is not compatible with orthographic cameras!",20),o.setFloat("logarithmicDepthConstant",2/(Math.log(mm.maxZ+1)/Math.LN2))}}function Y(mm,o,u){let f=arguments.length>3&&void 0!==arguments[3]&&arguments[3];u&&mm.fogEnabled&&(!o||o.applyFog)&&0!==mm.fogMode&&(u.setFloat4("vFogInfos",mm.fogMode,mm.fogStart,mm.fogEnd,mm.fogDensity),f?(mm.fogColor.toLinearSpaceToRef(p,mm.getEngine().useExactSrgbConversions),u.setColor3("vFogColor",p)):u.setColor3("vFogColor",mm.fogColor))}function q(mm,o,u,f,B,O,r,w,p,z){const Y=mm.numMaxInfluencers||mm.numInfluencers;return Y<=0?0:(o.push("#define MORPHTARGETS"),mm.hasPositions&&o.push("#define MORPHTARGETTEXTURE_HASPOSITIONS"),mm.hasNormals&&o.push("#define MORPHTARGETTEXTURE_HASNORMALS"),mm.hasTangents&&o.push("#define MORPHTARGETTEXTURE_HASTANGENTS"),mm.hasUVs&&o.push("#define MORPHTARGETTEXTURE_HASUVS"),mm.hasUV2s&&o.push("#define MORPHTARGETTEXTURE_HASUV2S"),mm.hasColors&&o.push("#define MORPHTARGETTEXTURE_HASCOLORS"),mm.supportsPositions&&B&&o.push("#define MORPHTARGETS_POSITION"),mm.supportsNormals&&O&&o.push("#define MORPHTARGETS_NORMAL"),mm.supportsTangents&&r&&o.push("#define MORPHTARGETS_TANGENT"),mm.supportsUVs&&w&&o.push("#define MORPHTARGETS_UV"),mm.supportsUV2s&&p&&o.push("#define MORPHTARGETS_UV2"),mm.supportsColors&&z&&o.push("#define MORPHTARGETS_COLOR"),o.push("#define NUM_MORPH_INFLUENCERS "+Y),mm.isUsingTextureForTargets&&o.push("#define MORPHTARGETS_TEXTURE"),K.NUM_MORPH_INFLUENCERS=Y,K.NORMAL=O,K.TANGENT=r,K.UV=w,K.UV2=p,K.COLOR=z,x(u,f,K,B),Y)}function x(mm,o,u){let B=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=u.NUM_MORPH_INFLUENCERS;if(r>0&&O.d.LastCreatedEngine){const w=O.d.LastCreatedEngine.getCaps().maxVertexAttribs,p=o.morphTargetManager;if(null!==p&&void 0!==p&&p.isUsingTextureForTargets)return;const K=p&&p.supportsPositions&&B,z=p&&p.supportsNormals&&u.NORMAL,Y=p&&p.supportsTangents&&u.TANGENT,q=p&&p.supportsUVs&&u.UV1,x=p&&p.supportsUV2s&&u.UV2,H=p&&p.supportsColors&&u.VERTEXCOLOR;for(let u=0;u<r;u++)K&&mm.push("position"+u),z&&mm.push("normal"+u),Y&&mm.push("tangent"+u),q&&mm.push("uv_"+u),x&&mm.push("uv2_"+u),H&&mm.push("color"+u),mm.length>w&&f.e.Error("Cannot add more vertex attributes for mesh "+o.name)}}function H(mm){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];mm.push("world0"),mm.push("world1"),mm.push("world2"),mm.push("world3"),o&&(mm.push("previousWorld0"),mm.push("previousWorld1"),mm.push("previousWorld2"),mm.push("previousWorld3"))}function E(mm,o){const u=mm.morphTargetManager;mm&&u&&o.setFloatArray("morphTargetInfluences",u.influences)}function M(mm,o){o.bindToEffect(mm,"Scene")}function l(mm,o,u){o._needUVs=!0,o[u]=!0,mm.optimizeUVAllocation&&mm.getTextureMatrix().isIdentityAs3x2()?(o[u+"DIRECTUV"]=mm.coordinatesIndex+1,o["MAINUV"+(mm.coordinatesIndex+1)]=!0):o[u+"DIRECTUV"]=0}function t(mm,o,u){const f=mm.getTextureMatrix();o.Tf(u+"Matrix",f)}function Q(mm,o,u){u.BAKED_VERTEX_ANIMATION_TEXTURE&&u.INSTANCES&&mm.push("bakedVertexAnimationSettingsInstanced")}function b(mm,o,u){var f;if(o&&mm&&(mm.computeBonesUsingShaders&&o._bonesComputationForcedToCPU&&(mm.computeBonesUsingShaders=!1),mm.useBones&&mm.computeBonesUsingShaders&&mm.skeleton)){const B=mm.skeleton;if(B.isUsingTextureForMatrices&&o.getUniformIndex("boneTextureWidth")>-1){const u=B.getTransformMatrixTexture(mm);o.setTexture("boneSampler",u),o.setFloat("boneTextureWidth",4*(B.bones.length+1))}else{const O=B.getTransformMatrices(mm);O&&(o.setMatrices("mBones",O),u&&mm.Pm().prePassRenderer&&mm.Pm().prePassRenderer.getIndex(2)&&(u.previousBones[mm.uniqueId]||(u.previousBones[mm.uniqueId]=O.slice()),o.setMatrices("mPreviousBones",u.previousBones[mm.uniqueId]),f=O,u.previousBones[mm.uniqueId].set(f)))}}}function J(mm,o,u,f,B){let O=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];mm._bindLight(o,u,f,B,O)}function N(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const O=Math.min(o.lightSources.length,B);for(let r=0;r<O;r++){J(o.lightSources[r],r,mm,u,"boolean"===typeof f?f:f.SPECULARTERM,o.receiveShadows)}}function S(mm,o,u,f){u.NUM_BONE_INFLUENCERS>0&&(f.addCPUSkinningFallback(0,o),mm.push("matricesIndices"),mm.push("matricesWeights"),u.NUM_BONE_INFLUENCERS>4&&(mm.push("matricesIndicesExtra"),mm.push("matricesWeightsExtra")))}function P(mm,o){(o.INSTANCES||o.THIN_INSTANCES)&&H(mm,!!o.PREPASS_VELOCITY),o.INSTANCESCOLOR&&mm.push("instanceColor")}function R(mm,o){let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,B=0;for(let O=0;O<u&&mm["LIGHT"+O];O++)O>0&&(B=f+O,o.addFallback(B,"LIGHT"+O)),mm.SHADOWS||(mm["SHADOW"+O]&&o.addFallback(f,"SHADOW"+O),mm["SHADOWPCF"+O]&&o.addFallback(f,"SHADOWPCF"+O),mm["SHADOWPCSS"+O]&&o.addFallback(f,"SHADOWPCSS"+O),mm["SHADOWPOISSON"+O]&&o.addFallback(f,"SHADOWPOISSON"+O),mm["SHADOWESM"+O]&&o.addFallback(f,"SHADOWESM"+O),mm["SHADOWCLOSEESM"+O]&&o.addFallback(f,"SHADOWCLOSEESM"+O));return B++}function g(mm,o,u,f,B,O,r){let w=arguments.length>7&&void 0!==arguments[7]&&arguments[7];r._areMiscDirty&&(r.LOGARITHMICDEPTH=u,r.POINTSIZE=f,r.FOG=B&&function(mm,o){return o.fogEnabled&&mm.applyFog&&0!==o.fogMode}(mm,o),r.NONUNIFORMSCALING=mm.nonUniformScaling,r.ALPHATEST=O,r.DECAL_AFTER_DETAIL=w)}function W(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,O=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!u._areLightsDirty)return u._needNormals;let r=0;const w={needNormals:u._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(mm.lightsEnabled&&!O)for(const K of o.lightSources)if(F(mm,o,K,r,u,f,w),r++,r===B)break;u.SPECULARTERM=w.specularEnabled,u.SHADOWS=w.shadowEnabled;for(let K=r;K<B;K++)void 0!==u["LIGHT"+K]&&(u["LIGHT"+K]=!1,u["HEMILIGHT"+K]=!1,u["POINTLIGHT"+K]=!1,u["DIRLIGHT"+K]=!1,u["SPOTLIGHT"+K]=!1,u["AREALIGHT"+K]=!1,u["SHADOW"+K]=!1,u["SHADOWCSM"+K]=!1,u["SHADOWCSMDEBUG"+K]=!1,u["SHADOWCSMNUM_CASCADES"+K]=!1,u["SHADOWCSMUSESHADOWMAXZ"+K]=!1,u["SHADOWCSMNOBLEND"+K]=!1,u["SHADOWCSM_RIGHTHANDED"+K]=!1,u["SHADOWPCF"+K]=!1,u["SHADOWPCSS"+K]=!1,u["SHADOWPOISSON"+K]=!1,u["SHADOWESM"+K]=!1,u["SHADOWCLOSEESM"+K]=!1,u["SHADOWCUBE"+K]=!1,u["SHADOWLOWQUALITY"+K]=!1,u["SHADOWMEDIUMQUALITY"+K]=!1);const p=mm.getEngine().getCaps();return void 0===u.SHADOWFLOAT&&(w.needRebuild=!0),u.SHADOWFLOAT=w.shadowEnabled&&(p.textureFloatRender&&p.textureFloatLinearFiltering||p.textureHalfFloatRender&&p.textureHalfFloatLinearFiltering),u.LIGHTMAPEXCLUDED=w.lightmapMode,w.needRebuild&&u.rebuild(),w.needNormals}function F(mm,o,u,f,B,O,w){switch(w.needNormals=!0,void 0===B["LIGHT"+f]&&(w.needRebuild=!0),B["LIGHT"+f]=!0,B["SPOTLIGHT"+f]=!1,B["HEMILIGHT"+f]=!1,B["POINTLIGHT"+f]=!1,B["DIRLIGHT"+f]=!1,B["AREALIGHT"+f]=!1,u.prepareLightSpecificDefines(B,f),B["LIGHT_FALLOFF_PHYSICAL"+f]=!1,B["LIGHT_FALLOFF_GLTF"+f]=!1,B["LIGHT_FALLOFF_STANDARD"+f]=!1,u.falloffType){case r.c.FALLOFF_GLTF:B["LIGHT_FALLOFF_GLTF"+f]=!0;break;case r.c.FALLOFF_PHYSICAL:B["LIGHT_FALLOFF_PHYSICAL"+f]=!0;break;case r.c.FALLOFF_STANDARD:B["LIGHT_FALLOFF_STANDARD"+f]=!0}if(O&&!u.fY.equalsFloats(0,0,0)&&(w.specularEnabled=!0),B["SHADOW"+f]=!1,B["SHADOWCSM"+f]=!1,B["SHADOWCSMDEBUG"+f]=!1,B["SHADOWCSMNUM_CASCADES"+f]=!1,B["SHADOWCSMUSESHADOWMAXZ"+f]=!1,B["SHADOWCSMNOBLEND"+f]=!1,B["SHADOWCSM_RIGHTHANDED"+f]=!1,B["SHADOWPCF"+f]=!1,B["SHADOWPCSS"+f]=!1,B["SHADOWPOISSON"+f]=!1,B["SHADOWESM"+f]=!1,B["SHADOWCLOSEESM"+f]=!1,B["SHADOWCUBE"+f]=!1,B["SHADOWLOWQUALITY"+f]=!1,B["SHADOWMEDIUMQUALITY"+f]=!1,o&&o.receiveShadows&&mm.shadowsEnabled&&u.shadowEnabled){const o=u.getShadowGenerator(mm.activeCamera)??u.getShadowGenerator();if(o){const mm=o.getShadowMap();mm&&mm.renderList&&mm.renderList.length>0&&(w.shadowEnabled=!0,o.prepareDefines(B,f))}}u.lightmapMode!=r.c.LIGHTMAP_DEFAULT?(w.lightmapMode=!0,B["LIGHTMAPEXCLUDED"+f]=!0,B["LIGHTMAPNOSPECULAR"+f]=u.lightmapMode==r.c.LIGHTMAP_SHADOWSONLY):(B["LIGHTMAPEXCLUDED"+f]=!1,B["LIGHTMAPNOSPECULAR"+f]=!1)}function c(mm,o,u,f,B){let O=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],p=function(mm,o){let u=!1;if(mm.activeCamera){const f=o.CAMERA_ORTHOGRAPHIC?1:0,B=o.CAMERA_PERSPECTIVE?1:0,O=1===mm.activeCamera.mode?1:0,r=0===mm.activeCamera.mode?1:0;(f^O||B^r)&&(o.CAMERA_ORTHOGRAPHIC=1===O,o.CAMERA_PERSPECTIVE=1===r,u=!0)}return u}(mm,f);!1!==O&&(p=(0,w.i)(u,mm,f)),f.DEPTHPREPASS!==!o.getColorWrite()&&(f.DEPTHPREPASS=!f.DEPTHPREPASS,p=!0),f.INSTANCES!==B&&(f.INSTANCES=B,p=!0),f.THIN_INSTANCES!==r&&(f.THIN_INSTANCES=r,p=!0),p&&f.markAsUnprocessed()}function A(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]&&arguments[4],O=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!o._areAttributesDirty&&o._needNormals===o._normals&&o._needUVs===o._uvs)return!1;o._normals=o._needNormals,o._uvs=o._needUVs,o.NORMAL=o._needNormals&&mm.isVerticesDataPresent("normal"),o._needNormals&&mm.isVerticesDataPresent("tangent")&&(o.TANGENT=!0);for(let w=1;w<=6;++w)o["UV"+w]=!!o._needUVs&&mm.isVerticesDataPresent(`uv${1===w?"":w}`);if(u){const u=mm.useVertexColors&&mm.isVerticesDataPresent("color");o.VERTEXCOLOR=u,o.VERTEXALPHA=mm.hasVertexAlpha&&u&&O}return mm.isVerticesDataPresent("instanceColor")&&(mm.hasInstances||mm.hasThinInstances)&&(o.INSTANCESCOLOR=!0),f&&function(mm,o){if(mm.useBones&&mm.computeBonesUsingShaders&&mm.skeleton){o.NUM_BONE_INFLUENCERS=mm.numBoneInfluencers;const u=void 0!==o.BONETEXTURE;if(mm.skeleton.isUsingTextureForMatrices&&u)o.BONETEXTURE=!0;else{o.BonesPerMesh=mm.skeleton.bones.length+1,o.BONETEXTURE=!u&&void 0;const f=mm.Pm().prePassRenderer;if(f&&f.enabled){const u=-1===f.excludedSkinnedMesh.indexOf(mm);o.BONES_VELOCITY_ENABLED=u}}}else o.NUM_BONE_INFLUENCERS=0,o.BonesPerMesh=0,void 0!==o.BONETEXTURE&&(o.BONETEXTURE=!1)}(mm,o),B&&function(mm,o){const u=mm.morphTargetManager;u?(o.MORPHTARGETS_UV=u.supportsUVs&&o.UV1,o.MORPHTARGETS_UV2=u.supportsUV2s&&o.UV2,o.MORPHTARGETS_TANGENT=u.supportsTangents&&o.TANGENT,o.MORPHTARGETS_NORMAL=u.supportsNormals&&o.NORMAL,o.MORPHTARGETS_POSITION=u.supportsPositions,o.MORPHTARGETS_COLOR=u.supportsColors,o.MORPHTARGETTEXTURE_HASUVS=u.hasUVs,o.MORPHTARGETTEXTURE_HASUV2S=u.hasUV2s,o.MORPHTARGETTEXTURE_HASTANGENTS=u.hasTangents,o.MORPHTARGETTEXTURE_HASNORMALS=u.hasNormals,o.MORPHTARGETTEXTURE_HASPOSITIONS=u.hasPositions,o.MORPHTARGETTEXTURE_HASCOLORS=u.hasColors,o.NUM_MORPH_INFLUENCERS=u.numMaxInfluencers||u.numInfluencers,o.MORPHTARGETS=o.NUM_MORPH_INFLUENCERS>0,o.MORPHTARGETS_TEXTURE=u.isUsingTextureForTargets):(o.MORPHTARGETS_UV=!1,o.MORPHTARGETS_UV2=!1,o.MORPHTARGETS_TANGENT=!1,o.MORPHTARGETS_NORMAL=!1,o.MORPHTARGETS_POSITION=!1,o.MORPHTARGETS_COLOR=!1,o.MORPHTARGETTEXTURE_HASUVS=!1,o.MORPHTARGETTEXTURE_HASUV2S=!1,o.MORPHTARGETTEXTURE_HASTANGENTS=!1,o.MORPHTARGETTEXTURE_HASNORMALS=!1,o.MORPHTARGETTEXTURE_HASPOSITIONS=!1,o.MORPHTARGETTEXTURE_HAS_COLORS=!1,o.MORPHTARGETS=!1,o.NUM_MORPH_INFLUENCERS=0)}(mm,o),r&&function(mm,o){const u=mm.bakedVertexAnimationManager;o.BAKED_VERTEX_ANIMATION_TEXTURE=!(!u||!u.isEnabled)}(mm,o),!0}function y(mm,o){if(mm.activeCamera){const u=o.MULTIVIEW;o.MULTIVIEW=null!==mm.activeCamera.outputRenderTarget&&mm.activeCamera.outputRenderTarget.getViewCount()>1,o.MULTIVIEW!=u&&o.markAsUnprocessed()}}function I(mm,o,u){const f=o.ORDER_INDEPENDENT_TRANSPARENCY,B=o.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;o.ORDER_INDEPENDENT_TRANSPARENCY=mm.useOrderIndependentTransparency&&u,o.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!mm.getEngine().getCaps().textureFloatLinearFiltering,f===o.ORDER_INDEPENDENT_TRANSPARENCY&&B===o.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||o.markAsUnprocessed()}function s(mm,o,u){const f=o.PREPASS;if(!o._arePrePassDirty)return;const B=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:9,define:"PREPASS_LOCAL_POSITION",index:"PREPASS_LOCAL_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:11,define:"PREPASS_VELOCITY_LINEAR",index:"PREPASS_VELOCITY_LINEAR_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:10,define:"PREPASS_SCREENSPACE_DEPTH",index:"PREPASS_SCREENSPACE_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"},{type:8,define:"PREPASS_WORLD_NORMAL",index:"PREPASS_WORLD_NORMAL_INDEX"}];if(mm.prePassRenderer&&mm.prePassRenderer.enabled&&u){o.PREPASS=!0,o.SCENE_MRT_COUNT=mm.prePassRenderer.mrtCount,o.PREPASS_NORMAL_WORLDSPACE=mm.prePassRenderer.generateNormalsInWorldSpace,o.PREPASS_COLOR=!0,o.PREPASS_COLOR_INDEX=0;for(let u=0;u<B.length;u++){const f=mm.prePassRenderer.getIndex(B[u].type);-1!==f?(o[B[u].define]=!0,o[B[u].index]=f):o[B[u].define]=!1}}else{o.PREPASS=!1;for(let mm=0;mm<B.length;mm++)o[B[mm].define]=!1}o.PREPASS!=f&&(o.markAsUnprocessed(),o.markAsImageProcessingDirty())}function j(mm,o,u,f){let B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,O=arguments.length>5&&void 0!==arguments[5]&&arguments[5],r=arguments.length>6&&void 0!==arguments[6]&&arguments[6];B&&B.push("Light"+mm),O||(o.push("vLightData"+mm,"vLightDiffuse"+mm,"vLightSpecular"+mm,"vLightDirection"+mm,"vLightWidth"+mm,"vLightHeight"+mm,"vLightFalloff"+mm,"vLightGround"+mm,"lightMatrix"+mm,"shadowsInfo"+mm,"depthValues"+mm),u.push("shadowTexture"+mm),u.push("depthTexture"+mm),o.push("viewFrustumZ"+mm,"cascadeBlendFactor"+mm,"lightSizeUVCorrection"+mm,"depthCorrection"+mm,"penumbraDarkness"+mm,"frustumLengths"+mm),f&&(u.push("projectionLightTexture"+mm),o.push("textureProjectionMatrix"+mm)),r&&u.push("iesLightTexture"+mm))}function a(mm,o,u){let f,B,O=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4;if(mm.uniformsNames){const r=mm;f=r.uniformsNames,B=r.uniformBuffersNames,o=r.samplers,u=r.defines,O=r.maxSimultaneousLights||0}else f=mm,o||(o=[]);for(let r=0;r<O&&u["LIGHT"+r];r++)j(r,f,o,u["PROJECTEDLIGHTTEXTURE"+r],B,!1,u["IESLIGHTTEXTURE"+r]);u.NUM_MORPH_INFLUENCERS&&(f.push("morphTargetInfluences"),f.push("morphTargetCount")),u.BAKED_VERTEX_ANIMATION_TEXTURE&&(f.push("bakedVertexAnimationSettings"),f.push("bakedVertexAnimationTextureSizeInverted"),f.push("bakedVertexAnimationTime"),o.push("bakedVertexAnimationTexture"))}},13041:(mm,o,u)=>{u.d(o,{d:()=>O});var f=u(12740),B=u(13050);class O extends B.c{constructor(mm,o){let u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(mm,o,void 0,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this._normalMatrix=new f.Matrix,this._storeEffectOnSubMeshes=u}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(mm,o){return!!mm&&(!this._storeEffectOnSubMeshes||(!mm.kf||0===mm.kf.length||this.isReadyForSubMesh(mm,mm.kf[0],o)))}_isReadyForSubMesh(mm){const o=mm.materialDefines;return!(this.checkReadyOnEveryCall||!mm.effect||!o||o._renderId!==this.Pm().getRenderId())}bindOnlyWorldMatrix(mm){this._activeEffect.setMatrix("world",mm)}bindOnlyNormalMatrix(mm){this._activeEffect.setMatrix("normalMatrix",mm)}bind(mm,o){o&&this.bindForSubMesh(mm,o,o.kf[0])}_afterBind(mm){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2?arguments[2]:void 0;super._afterBind(mm,o,u),this.Pm()._cachedEffect=o,u?u._drawWrapper._forceRebindOnNextCall=!1:this._drawWrapper._forceRebindOnNextCall=!1}_mustRebind(mm,o,u){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return u._drawWrapper._forceRebindOnNextCall||mm.isCachedMaterialInvalid(this,o,f)}dispose(mm,o,u){this._activeEffect=void 0,super.dispose(mm,o,u)}}},13085:(mm,o,u)=>{u.d(o,{b:()=>w,d:()=>p});var f=u(12729),B=u(12740),O=u(12732);class r{static extractMinAndMaxIndexed(mm,o,u,f,B,O){for(let r=u;r<u+f;r++){const u=3*o[r],f=mm[u],w=mm[u+1],p=mm[u+2];B.minimizeInPlaceFromFloats(f,w,p),O.maximizeInPlaceFromFloats(f,w,p)}}static extractMinAndMax(mm,o,u,f,B,O){for(let r=o,w=o*f;r<o+u;r++,w+=f){const o=mm[w],u=mm[w+1],f=mm[w+2];B.minimizeInPlaceFromFloats(o,u,f),O.maximizeInPlaceFromFloats(o,u,f)}}}function w(mm,o,u,f){let O=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const w=new B.lo(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),p=new B.lo(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return r.extractMinAndMaxIndexed(mm,o,u,f,w,p),O&&(w.x-=w.x*O.x+O.y,w.y-=w.y*O.x+O.y,w.z-=w.z*O.x+O.y,p.x+=p.x*O.x+O.y,p.y+=p.y*O.x+O.y,p.z+=p.z*O.x+O.y),{minimum:w,maximum:p}}function p(mm,o,u){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,O=arguments.length>4?arguments[4]:void 0;const w=new B.lo(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),p=new B.lo(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return O||(O=3),r.extractMinAndMax(mm,o,u,O,w,p),f&&(w.x-=w.x*f.x+f.y,w.y-=w.y*f.x+f.y,w.z-=w.z*f.x+f.y,p.x+=p.x*f.x+f.y,p.y+=p.y*f.x+f.y,p.z+=p.z*f.x+f.y),{minimum:w,maximum:p}}(0,f.d)([O.e.filter((function(){for(var mm=arguments.length,o=new Array(mm),u=0;u<mm;u++)o[u]=arguments[u];let[f,B]=o;return!Array.isArray(f)&&!Array.isArray(B)}))],r,"extractMinAndMaxIndexed",null),(0,f.d)([O.e.filter((function(){for(var mm=arguments.length,o=new Array(mm),u=0;u<mm;u++)o[u]=arguments[u];let[f]=o;return!Array.isArray(f)}))],r,"extractMinAndMax",null)},13057:(mm,o,u)=>{u.d(o,{c:()=>p});var f=u(12809),B=u(13062),O=u(13065),r=u(13085),w=u(12855);class p{get materialDefines(){var mm;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(mm=this._getDrawWrapper())||void 0===mm?void 0:mm.defines}set materialDefines(mm){(this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)).defines=mm}_getDrawWrapper(mm){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];mm=mm??this._engine.currentRenderPassId;let u=this._drawWrappers[mm];return!u&&o&&(this._drawWrappers[mm]=u=new w.c(this._mesh.Pm().getEngine())),u}_removeDrawWrapper(mm){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var u;arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||(null===(u=this._drawWrappers[mm])||void 0===u||u.dispose(o));this._drawWrappers[mm]=void 0}get effect(){var mm;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:(null===(mm=this._getDrawWrapper())||void 0===mm?void 0:mm.effect)??null}get _drawWrapper(){return this._mainDrawWrapperOverride??this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(mm){this._mainDrawWrapperOverride=mm}setEffect(mm){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=arguments.length>2?arguments[2]:void 0,f=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const B=this._drawWrapper;B.setEffect(mm,o,f),void 0!==u&&(B.materialContext=u),mm||(B.defines=null,B.materialContext=void 0)}resetDrawCache(mm){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._drawWrappers){if(void 0!==mm)return void this._removeDrawWrapper(mm,!0,o);for(const mm of this._drawWrappers)null===mm||void 0===mm||mm.dispose(o)}this._drawWrappers=[]}static AddToMesh(mm,o,u,f,B,O,r){return new p(mm,o,u,f,B,O,r,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(mm,o,u,f,B,O,r){let w=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],p=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=mm,this.verticesStart=o,this.verticesCount=u,this.indexStart=f,this.indexCount=B,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=O,this._renderingMesh=r||O,p&&O.kf.push(this),this._engine=this._mesh.Pm().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=O.kf.length-1,w&&(this.refreshBoundingInfo(),O.Df(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal||this._mesh.hasThinInstances?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(mm){return this._boundingInfo=mm,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const mm=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return mm||this._renderingMesh}Gm(){let mm=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const o=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId)??this._renderingMesh.material;if(!o)return mm&&this._mesh.Pm()._hasDefaultMaterial?this._mesh.Pm().defaultMaterial:null;if(this._isMultiMaterial(o)){const mm=o.getSubMaterial(this.materialIndex);return this._currentMaterial!==mm&&(this._currentMaterial=mm,this.resetDrawCache()),mm}return o}_isMultiMaterial(mm){return void 0!==mm.getSubMaterial}refreshBoundingInfo(){let mm=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.br)return this;if(mm||(mm=this._renderingMesh.getVerticesData(f.f.PositionKind)),!mm)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const o=this._renderingMesh.hr();let u;if(0===this.indexStart&&this.indexCount===o.length){const mm=this._renderingMesh.getBoundingInfo();u={minimum:mm.minimum.clone(),maximum:mm.maximum.clone()}}else u=(0,r.b)(mm,o,this.indexStart,this.indexCount,this._renderingMesh.br.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(u.minimum,u.maximum):this._boundingInfo=new O.e(u.minimum,u.maximum),this}_checkCollision(mm){return this.getBoundingInfo()._checkCollision(mm)}updateBoundingInfo(mm){let o=this.getBoundingInfo();return o||(this.refreshBoundingInfo(),o=this.getBoundingInfo()),o&&o.update(mm),this}isInFrustum(mm){const o=this.getBoundingInfo();return!!o&&o.isInFrustum(mm,this._mesh.uq)}isCompletelyInFrustum(mm){const o=this.getBoundingInfo();return!!o&&o.isCompletelyInFrustum(mm)}render(mm){return this._renderingMesh.render(this,mm,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(mm,o){if(!this._linesIndexBuffer){const u=6*Math.floor(this.indexCount/3),f=this.verticesStart+this.verticesCount>65535?new Uint32Array(u):new Uint16Array(u);let B=0;if(0===mm.length)for(let mm=this.indexStart;mm<this.indexStart+this.indexCount;mm+=3)f[B++]=mm,f[B++]=mm+1,f[B++]=mm+1,f[B++]=mm+2,f[B++]=mm+2,f[B++]=mm;else for(let o=this.indexStart;o<this.indexStart+this.indexCount;o+=3)f[B++]=mm[o],f[B++]=mm[o+1],f[B++]=mm[o+1],f[B++]=mm[o+2],f[B++]=mm[o+2],f[B++]=mm[o];this._linesIndexBuffer=o.createIndexBuffer(f),this._linesIndexCount=f.length}return this._linesIndexBuffer}canIntersects(mm){const o=this.getBoundingInfo();return!!o&&mm.intersectsBox(o.boundingBox)}intersects(mm,o,u,f,B){const O=this.Gm();if(!O)return null;let r=3,w=!1;switch(O.fillMode){case 3:case 5:case 6:case 8:return null;case 7:r=1,w=!0}return 4===O.fillMode?u.length?this._intersectLines(mm,o,u,this._mesh.intersectionThreshold,f):this._intersectUnIndexedLines(mm,o,u,this._mesh.intersectionThreshold,f):!u.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(mm,o,u,f,B):this._intersectTriangles(mm,o,u,r,w,f,B)}_intersectLines(mm,o,u,f,O){let r=null;for(let w=this.indexStart;w<this.indexStart+this.indexCount;w+=2){const p=o[u[w]],K=o[u[w+1]],z=mm.intersectionSegment(p,K,f);if(!(z<0)&&((O||!r||z<r.distance)&&(r=new B.c(null,null,z),r.faceId=w/2,O)))break}return r}_intersectUnIndexedLines(mm,o,u,f,O){let r=null;for(let w=this.verticesStart;w<this.verticesStart+this.verticesCount;w+=2){const u=o[w],p=o[w+1],K=mm.intersectionSegment(u,p,f);if(!(K<0)&&((O||!r||K<r.distance)&&(r=new B.c(null,null,K),r.faceId=w/2,O)))break}return r}_intersectTriangles(mm,o,u,f,B,O,r){let w=null,p=-1;for(let K=this.indexStart;K<this.indexStart+this.indexCount-(3-f);K+=f){p++;const f=u[K],z=u[K+1],Y=u[K+2];if(B&&4294967295===Y){K+=2;continue}const q=o[f],x=o[z],H=o[Y];if(!q||!x||!H)continue;if(r&&!r(q,x,H,mm,f,z,Y))continue;const E=mm.intersectsTriangle(q,x,H);if(E){if(E.distance<0)continue;if((O||!w||E.distance<w.distance)&&(w=E,w.faceId=p,O))break}}return w}_intersectUnIndexedTriangles(mm,o,u,f,B){let O=null;for(let r=this.verticesStart;r<this.verticesStart+this.verticesCount;r+=3){const u=o[r],w=o[r+1],p=o[r+2];if(B&&!B(u,w,p,mm,-1,-1,-1))continue;const K=mm.intersectsTriangle(u,w,p);if(K){if(K.distance<0)continue;if((f||!O||K.distance<O.distance)&&(O=K,O.faceId=r/3,f))break}}return O}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(mm,o){const u=new p(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,mm,o,!1);if(!this.IsGlobal){const mm=this.getBoundingInfo();if(!mm)return u;u._boundingInfo=new O.e(mm.minimum,mm.maximum)}return u}dispose(){let mm=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._linesIndexBuffer&&(this._mesh.Pm().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const o=this._mesh.kf.indexOf(this);this._mesh.kf.splice(o,1),this.resetDrawCache(void 0,mm)}getClassName(){return"SubMesh"}static CreateFromIndices(mm,o,u,f,B){let O=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=Number.MAX_VALUE,w=-Number.MAX_VALUE;const K=(B||f).hr();for(let p=o;p<o+u;p++){const mm=K[p];mm<r&&(r=mm),mm>w&&(w=mm)}return new p(mm,r,w-r+1,o,u,f,B,O)}}}}]);