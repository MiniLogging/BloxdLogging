"use strict";(self.lfntwv94xlc=self.lfntwv94xlc||[]).push([[9],{11221:(m,S,h)=>{h.d(S,{d:()=>s,f:()=>y,k:()=>o,i:()=>a,l:()=>x});class l{constructor(){this.children=[]}isValid(m){return!0}process(m,S,h){let l="";if(this.line){let h=this.line;const V=S.processor;if(V){var M,O,u,b,q,Y;V.lineProcessor&&(h=V.lineProcessor(h,S.isFragment,S.processingContext));const l=(null===(M=S.processor)||void 0===M?void 0:M.attributeKeywordName)??"attribute",I=S.isFragment&&null!==(O=S.processor)&&void 0!==O&&O.varyingFragmentKeywordName?null===(u=S.processor)||void 0===u?void 0:u.varyingFragmentKeywordName:!S.isFragment&&null!==(b=S.processor)&&void 0!==b&&b.varyingVertexKeywordName?null===(q=S.processor)||void 0===q?void 0:q.varyingVertexKeywordName:"varying";if(!S.isFragment&&V.attributeProcessor&&this.line.startsWith(l))h=V.attributeProcessor(this.line,m,S.processingContext);else if(V.varyingProcessor&&(null!==(Y=V.varyingCheck)&&void 0!==Y&&Y.call(V,this.line,S.isFragment)||!V.varyingCheck&&this.line.startsWith(I)))h=V.varyingProcessor(this.line,S.isFragment,m,S.processingContext);else if(V.uniformProcessor&&V.uniformRegexp&&V.uniformRegexp.test(this.line))S.lookForClosingBracketForUniformBuffer||(h=V.uniformProcessor(this.line,S.isFragment,m,S.processingContext));else if(V.uniformBufferProcessor&&V.uniformBufferRegexp&&V.uniformBufferRegexp.test(this.line))S.lookForClosingBracketForUniformBuffer||(h=V.uniformBufferProcessor(this.line,S.isFragment,S.processingContext),S.lookForClosingBracketForUniformBuffer=!0);else if(V.textureProcessor&&V.textureRegexp&&V.textureRegexp.test(this.line))h=V.textureProcessor(this.line,S.isFragment,m,S.processingContext);else if((V.uniformProcessor||V.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!S.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?V.uniformProcessor&&(h=V.uniformProcessor(this.line,S.isFragment,m,S.processingContext)):V.uniformBufferProcessor&&(h=V.uniformBufferProcessor(this.line,S.isFragment,S.processingContext),S.lookForClosingBracketForUniformBuffer=!0)}S.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(S.lookForClosingBracketForUniformBuffer=!1,V.endOfUniformBufferProcessor&&(h=V.endOfUniformBufferProcessor(this.line,S.isFragment,S.processingContext)))}l+=h+"\n"}for(const V of this.children)l+=V.process(m,S,h);return this.additionalDefineKey&&(m[this.additionalDefineKey]=this.additionalDefineValue||"true",h[this.additionalDefineKey]=m[this.additionalDefineKey]),l}}class M{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(m){this._lines.length=0;for(const S of m){if(!S||"\r"===S)continue;if("#"===S[0]){this._lines.push(S);continue}const m=S.trim();if(!m)continue;if(m.startsWith("//")){this._lines.push(S);continue}const h=m.indexOf(";");if(-1===h)this._lines.push(m);else if(h===m.length-1)m.length>1&&this._lines.push(m);else{const m=S.split(";");for(let S=0;S<m.length;S++){let h=m[S];h&&(h=h.trim(),h&&this._lines.push(h+(S!==m.length-1?";":"")))}}}}}class O extends l{process(m,S,h){for(let l=0;l<this.children.length;l++){const M=this.children[l];if(M.isValid(m))return M.process(m,S,h)}return""}}class u extends l{isValid(m){return this.testExpression.isTrue(m)}}class b{isTrue(m){return!0}static postfixToInfix(m){const S=[];for(const h of m)if(void 0===b._OperatorPriority[h])S.push(h);else{const m=S[S.length-1],l=S[S.length-2];S.length-=2,S.push(`(${l}${h}${m})`)}return S[S.length-1]}static infixToPostfix(m){const S=b._InfixToPostfixCache.get(m);if(S)return S.accessTime=Date.now(),S.result;if(!m.includes("&&")&&!m.includes("||")&&!m.includes(")")&&!m.includes("("))return[m];const h=[];let l=-1;const M=()=>{V=V.trim(),""!==V&&(h.push(V),V="")},O=m=>{l<b._Stack.length-1&&(b._Stack[++l]=m)},u=()=>b._Stack[l],q=()=>-1===l?"!!INVALID EXPRESSION!!":b._Stack[l--];let Y=0,V="";for(;Y<m.length;){const S=m.charAt(Y),I=Y<m.length-1?m.substring(Y,2+Y):"";if("("===S)V="",O(S);else if(")"===S){for(M();-1!==l&&"("!==u();)h.push(q());q()}else if(b._OperatorPriority[I]>1){for(M();-1!==l&&b._OperatorPriority[u()]>=b._OperatorPriority[I];)h.push(q());O(I),Y++}else V+=S;Y++}for(M();-1!==l;)"("===u()?q():h.push(q());return b._InfixToPostfixCache.size>=b.InfixToPostfixCacheLimitSize&&b.ClearCache(),b._InfixToPostfixCache.set(m,{result:h,accessTime:Date.now()}),h}static ClearCache(){const m=Array.from(b._InfixToPostfixCache.entries()).sort(((m,S)=>m[1].accessTime-S[1].accessTime));for(let S=0;S<b.InfixToPostfixCacheCleanupSize;S++)b._InfixToPostfixCache.delete(m[S][0])}}b.InfixToPostfixCacheLimitSize=5e4,b.InfixToPostfixCacheCleanupSize=25e3,b._InfixToPostfixCache=new Map,b._OperatorPriority={")":0,"(":1,"||":2,"&&":3},b._Stack=["","","","","","","","","","","","","","","","","","","",""];class q extends b{constructor(m){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=m,this.not=S}isTrue(m){let S=void 0!==m[this.define];return this.not&&(S=!S),S}}class Y extends b{isTrue(m){return this.leftOperand.isTrue(m)||this.rightOperand.isTrue(m)}}class V extends b{isTrue(m){return this.leftOperand.isTrue(m)&&this.rightOperand.isTrue(m)}}class I extends b{constructor(m,S,h){super(),this.define=m,this.operand=S,this.testValue=h}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(m){let S=!1;const h=parseInt(void 0!=m[this.define]?m[this.define]:this.define),l=parseInt(void 0!=m[this.testValue]?m[this.testValue]:this.testValue);if(isNaN(h)||isNaN(l))return!1;switch(this.operand){case">":S=h>l;break;case"<":S=h<l;break;case"<=":S=h<=l;break;case">=":S=h>=l;break;case"==":S=h===l;break;case"!=":S=h!==l}return S}}var Z=h(11189),C=h(11224);const B=/defined\s*?\((.+?)\)/g,D=/defined\s*?\[(.+?)\]/g,E=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,n=/__decl__/,L=/light\{X\}.(\w*)/g,U=/\{X\}/g,H=[],R=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function y(m){m.processor&&m.processor.initializeShaders&&m.processor.initializeShaders(m.processingContext)}function o(m,S,h,l){var M;null!==(M=S.processor)&&void 0!==M&&M.preProcessShaderCode&&(m=S.processor.preProcessShaderCode(m,S.isFragment)),a(m,S,(m=>{S.processCodeAfterIncludes&&(m=S.processCodeAfterIncludes(S.isFragment?"fragment":"vertex",m,S.defines));const M=function(m,S,h){let l=function(m,S){var h;if(null!==(h=S.processor)&&void 0!==h&&h.noPrecision)return m;const l=S.shouldUseHighPrecisionShader;-1===m.indexOf("precision highp float")?m=l?"precision highp float;\n"+m:"precision mediump float;\n"+m:l||(m=m.replace("precision highp float","precision mediump float"));return m}(m,S);if(!S.processor)return l;if(0===S.processor.shaderLanguage&&-1!==l.indexOf("#version 3")&&(l=l.replace("#version 300 es",""),!S.processor.parseGLES3))return l;const M=S.defines,O=e(S,h);S.processor.preProcessor&&(l=S.processor.preProcessor(l,M,O,S.isFragment,S.processingContext));const u={};l=G(l,O,S,u),S.processor.postProcessor&&(l=S.processor.postProcessor(l,M,S.isFragment,S.processingContext,h?{drawBuffersExtensionDisabled:!h.getCaps().drawBuffersExtension}:{},O,u));null!==h&&void 0!==h&&h._features.needShaderCodeInlining&&(l=h.inlineShaderCode(l));return l}(m,S,l);h(M,m)}))}function s(m,S,h){return h.processor&&h.processor.finalizeShaders?h.processor.finalizeShaders(m,S,h.processingContext):{vertexCode:m,fragmentCode:S}}function v(m){const S=/defined\((.+)\)/.exec(m);if(S&&S.length)return new q(S[1].trim(),"!"===m[0]);const h=["==","!=",">=","<=","<",">"];let l="",M=0;for(l of h)if(M=m.indexOf(l),M>-1)break;if(-1===M)return new q(m);const O=m.substring(0,M).trim(),u=m.substring(M+l.length).trim();return new I(O,l,u)}function T(m,S){const h=new u,l=m.substring(0,S);let M=m.substring(S);return M=M.substring(0,(M.indexOf("//")+1||M.length+1)-1).trim(),h.testExpression="#ifdef"===l?new q(M):"#ifndef"===l?new q(M,!0):function(m){m=m.replace(B,"defined[$1]");const S=b.infixToPostfix(m),h=[];for(const M of S)if("||"!==M&&"&&"!==M)h.push(M);else if(h.length>=2){let m=h[h.length-1],S=h[h.length-2];h.length-=2;const l="&&"==M?new V:new Y;"string"===typeof m&&(m=m.replace(D,"defined($1)")),"string"===typeof S&&(S=S.replace(D,"defined($1)")),l.leftOperand="string"===typeof S?v(S):S,l.rightOperand="string"===typeof m?v(m):m,h.push(l)}let l=h[h.length-1];return"string"===typeof l&&(l=l.replace(D,"defined($1)")),"string"===typeof l?v(l):l}(M),h}function X(m,S,h,M){let O=m.currentLine;for(;g(m,h,M);){O=m.currentLine;const u=O.substring(0,5).toLowerCase();if("#else"===u){const h=new l;return S.children.push(h),void g(m,h,M)}if("#elif"===u){const m=T(O,5);S.children.push(m),h=m}}}function g(m,S,h){for(;m.canRead;){m.lineIndex++;const M=m.currentLine;if(M.indexOf("#")>=0){const l=R.exec(M);if(l&&l.length){switch(l[0]){case"#ifdef":{const l=new O;S.children.push(l);const u=T(M,6);l.children.push(u),X(m,l,u,h);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const l=new O;S.children.push(l);const u=T(M,7);l.children.push(u),X(m,l,u,h);break}case"#if":{const l=new O,u=T(M,3);S.children.push(l),l.children.push(u),X(m,l,u,h);break}}continue}}const u=new l;if(u.line=M,S.children.push(u),"#"===M[0]&&"d"===M[1]){const m=M.replace(";","").split(" ");u.additionalDefineKey=m[1],3===m.length&&(u.additionalDefineValue=m[2])}}return!1}function G(m,S,h,O){const u=new l,b=new M;return b.lineIndex=-1,b.lines=m.split("\n"),g(b,u,O),u.process(S,h,O)}function e(m,S){var h;const l=m.defines,M={};for(const O of l){const m=O.replace("#define","").replace(";","").trim().split(" ");M[m[0]]=m.length>1?m[1]:""}return 0===(null===(h=m.processor)||void 0===h?void 0:h.shaderLanguage)&&(M.GL_ES="true"),M.__VERSION__=m.version,M[m.platformName]="true",(0,C.g)(M,null===S||void 0===S?void 0:S.isNDCHalfZRange,null===S||void 0===S?void 0:S.useReverseDepthBuffer,null===S||void 0===S?void 0:S.useExactSrgbConversions),M}function a(m,S,h){let l;for(H.length=0;null!==(l=E.exec(m));)H.push(l);let M=String(m),O=[m],u=!1;for(const b of H){let m=b[1];if(-1!==m.indexOf("__decl__")&&(m=m.replace(n,""),S.supportsUniformBuffers&&(m=m.replace("Vertex","Ubo").replace("Fragment","Ubo")),m+="Declaration"),!S.includesShadersStore[m]){const l=S.shadersRepository+"ShadersInclude/"+m+".fx";return void x.loadFile(l,(l=>{S.includesShadersStore[m]=l,a(O.join(""),S,h)}))}{let h=S.includesShadersStore[m];if(b[2]){const m=b[3].split(",");for(let S=0;S<m.length;S+=2){const l=new RegExp(m[S],"g"),M=m[S+1];h=h.replace(l,M)}}if(b[4]){const m=b[5];if(-1!==m.indexOf("..")){const l=m.split(".."),M=parseInt(l[0]);let O=parseInt(l[1]),u=h.slice(0);h="",isNaN(O)&&(O=S.indexParameters[l[1]]);for(let m=M;m<O;m++)S.supportsUniformBuffers||(u=u.replace(L,((m,S)=>S+"{X}"))),h+=u.replace(U,m.toString())+"\n"}else S.supportsUniformBuffers||(h=h.replace(L,((m,S)=>S+"{X}"))),h=h.replace(U,m)}const l=[];for(const m of O){const S=m.split(b[0]);for(let m=0;m<S.length-1;m++)l.push(S[m]),l.push(h);l.push(S[S.length-1])}O=l,u=u||h.indexOf("#include<")>=0||h.indexOf("#include <")>=0}}H.length=0,M=O.join(""),u?a(M.toString(),S,h):h(M)}const x={loadFile:(m,S,h,l,M,O)=>{throw(0,Z.c)("FileTools")}}},11224:(m,S,h)=>{h.d(S,{d:()=>M,e:()=>O,g:()=>b,k:()=>u,l:()=>q});var l=h(11189);h(11169);const M={};function O(m,S){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(S?S+"\n":"")+m}function u(m,S,h,O,u,b,q){const Y=q||M.loadFile;if(Y){return Y(m,S,h,O,u,b)}throw(0,l.c)("FileTools")}function b(m,S,h,l){if(m)return S?m.IS_NDC_HALF_ZRANGE="":delete m.IS_NDC_HALF_ZRANGE,h?m.USE_REVERSE_DEPTHBUFFER="":delete m.USE_REVERSE_DEPTHBUFFER,void(l?m.USE_EXACT_SRGB_CONVERSIONS="":delete m.USE_EXACT_SRGB_CONVERSIONS);{let m="";return S&&(m+="#define IS_NDC_HALF_ZRANGE"),h&&(m&&(m+="\n"),m+="#define USE_REVERSE_DEPTHBUFFER"),l&&(m&&(m+="\n"),m+="#define USE_EXACT_SRGB_CONVERSIONS"),m}}function q(m,S){let h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3?arguments[3]:void 0;switch(m){case 3:{const m=(ArrayBuffer,new Int8Array(S));return l&&m.set(new Int8Array(l)),m}case 0:{const m=(ArrayBuffer,new Uint8Array(S));return l&&m.set(new Uint8Array(l)),m}case 4:{const m=S instanceof ArrayBuffer?new Int16Array(S):new Int16Array(h?S/2:S);return l&&m.set(new Int16Array(l)),m}case 5:case 8:case 9:case 10:case 2:{const m=S instanceof ArrayBuffer?new Uint16Array(S):new Uint16Array(h?S/2:S);return l&&m.set(new Uint16Array(l)),m}case 6:{const m=S instanceof ArrayBuffer?new Int32Array(S):new Int32Array(h?S/4:S);return l&&m.set(new Int32Array(l)),m}case 7:case 11:case 12:case 13:case 14:case 15:{const m=S instanceof ArrayBuffer?new Uint32Array(S):new Uint32Array(h?S/4:S);return l&&m.set(new Uint32Array(l)),m}case 1:{const m=S instanceof ArrayBuffer?new Float32Array(S):new Float32Array(h?S/4:S);return l&&m.set(new Float32Array(l)),m}}const M=(ArrayBuffer,new Uint8Array(S));return l&&M.set(new Uint8Array(l)),M}},11242:(m,S,h)=>{h.d(S,{b:()=>l});class l{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.ShadersRepository:l.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.ShadersStore:l.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.IncludesShadersStore:l.IncludesShadersStoreWGSL}}l.ShadersRepository="src/Shaders/",l.ShadersStore={},l.IncludesShadersStore={},l.ShadersRepositoryWGSL="src/ShadersWGSL/",l.ShadersStoreWGSL={},l.IncludesShadersStoreWGSL={}},11255:(m,S,h)=>{h.d(S,{e:()=>Z,g:()=>U,i:()=>B,l:()=>C,m:()=>D,o:()=>L,q:()=>I,t:()=>Y,x:()=>V,z:()=>q,A:()=>b});class l{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.ES._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(m){m&&this.program&&m(this.program)}setEngine(m){this.ES=m}_fillEffectInformation(m,S,h,l,M,O,u,b){const q=this.ES;if(q.supportsUniformBuffers)for(const V in S)m.bindUniformBlock(V,S[V]);let Y;for(this.ES.getUniforms(this,h).forEach(((m,S)=>{l[h[S]]=m})),this._uniforms=l,Y=0;Y<M.length;Y++){null==m.getUniform(M[Y])&&(M.splice(Y,1),Y--)}M.forEach(((m,S)=>{O[m]=S}));for(const V of q.getAttributes(this,u))b.push(V)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(m,S){const h=this._valueCache[m],l=S.updateFlag;return(void 0===h||h!==l)&&(this._valueCache[m]=l,!0)}_cacheFloat2(m,S,h){let l=this._valueCache[m];if(!l||2!==l.length)return l=[S,h],this._valueCache[m]=l,!0;let M=!1;return l[0]!==S&&(l[0]=S,M=!0),l[1]!==h&&(l[1]=h,M=!0),M}_cacheFloat3(m,S,h,l){let M=this._valueCache[m];if(!M||3!==M.length)return M=[S,h,l],this._valueCache[m]=M,!0;let O=!1;return M[0]!==S&&(M[0]=S,O=!0),M[1]!==h&&(M[1]=h,O=!0),M[2]!==l&&(M[2]=l,O=!0),O}_cacheFloat4(m,S,h,l,M){let O=this._valueCache[m];if(!O||4!==O.length)return O=[S,h,l,M],this._valueCache[m]=O,!0;let u=!1;return O[0]!==S&&(O[0]=S,u=!0),O[1]!==h&&(O[1]=h,u=!0),O[2]!==l&&(O[2]=l,u=!0),O[3]!==M&&(O[3]=M,u=!0),u}setInt(m,S){const h=this._valueCache[m];void 0!==h&&h===S||this.ES.setInt(this._uniforms[m],S)&&(this._valueCache[m]=S)}setInt2(m,S,h){this._cacheFloat2(m,S,h)&&(this.ES.setInt2(this._uniforms[m],S,h)||(this._valueCache[m]=null))}setInt3(m,S,h,l){this._cacheFloat3(m,S,h,l)&&(this.ES.setInt3(this._uniforms[m],S,h,l)||(this._valueCache[m]=null))}setInt4(m,S,h,l,M){this._cacheFloat4(m,S,h,l,M)&&(this.ES.setInt4(this._uniforms[m],S,h,l,M)||(this._valueCache[m]=null))}setIntArray(m,S){this._valueCache[m]=null,this.ES.setIntArray(this._uniforms[m],S)}setIntArray2(m,S){this._valueCache[m]=null,this.ES.setIntArray2(this._uniforms[m],S)}setIntArray3(m,S){this._valueCache[m]=null,this.ES.setIntArray3(this._uniforms[m],S)}setIntArray4(m,S){this._valueCache[m]=null,this.ES.setIntArray4(this._uniforms[m],S)}setUInt(m,S){const h=this._valueCache[m];void 0!==h&&h===S||this.ES.setUInt(this._uniforms[m],S)&&(this._valueCache[m]=S)}setUInt2(m,S,h){this._cacheFloat2(m,S,h)&&(this.ES.setUInt2(this._uniforms[m],S,h)||(this._valueCache[m]=null))}setUInt3(m,S,h,l){this._cacheFloat3(m,S,h,l)&&(this.ES.setUInt3(this._uniforms[m],S,h,l)||(this._valueCache[m]=null))}setUInt4(m,S,h,l,M){this._cacheFloat4(m,S,h,l,M)&&(this.ES.setUInt4(this._uniforms[m],S,h,l,M)||(this._valueCache[m]=null))}setUIntArray(m,S){this._valueCache[m]=null,this.ES.setUIntArray(this._uniforms[m],S)}setUIntArray2(m,S){this._valueCache[m]=null,this.ES.setUIntArray2(this._uniforms[m],S)}setUIntArray3(m,S){this._valueCache[m]=null,this.ES.setUIntArray3(this._uniforms[m],S)}setUIntArray4(m,S){this._valueCache[m]=null,this.ES.setUIntArray4(this._uniforms[m],S)}setArray(m,S){this._valueCache[m]=null,this.ES.setArray(this._uniforms[m],S)}setArray2(m,S){this._valueCache[m]=null,this.ES.setArray2(this._uniforms[m],S)}setArray3(m,S){this._valueCache[m]=null,this.ES.setArray3(this._uniforms[m],S)}setArray4(m,S){this._valueCache[m]=null,this.ES.setArray4(this._uniforms[m],S)}setMatrices(m,S){S&&(this._valueCache[m]=null,this.ES.setMatrices(this._uniforms[m],S))}setMatrix(m,S){this._cacheMatrix(m,S)&&(this.ES.setMatrices(this._uniforms[m],S.DM())||(this._valueCache[m]=null))}setMatrix3x3(m,S){this._valueCache[m]=null,this.ES.setMatrix3x3(this._uniforms[m],S)}setMatrix2x2(m,S){this._valueCache[m]=null,this.ES.setMatrix2x2(this._uniforms[m],S)}setFloat(m,S){const h=this._valueCache[m];void 0!==h&&h===S||this.ES.setFloat(this._uniforms[m],S)&&(this._valueCache[m]=S)}setVector2(m,S){this._cacheFloat2(m,S.x,S.y)&&(this.ES.setFloat2(this._uniforms[m],S.x,S.y)||(this._valueCache[m]=null))}setFloat2(m,S,h){this._cacheFloat2(m,S,h)&&(this.ES.setFloat2(this._uniforms[m],S,h)||(this._valueCache[m]=null))}setVector3(m,S){this._cacheFloat3(m,S.x,S.y,S.z)&&(this.ES.setFloat3(this._uniforms[m],S.x,S.y,S.z)||(this._valueCache[m]=null))}setFloat3(m,S,h,l){this._cacheFloat3(m,S,h,l)&&(this.ES.setFloat3(this._uniforms[m],S,h,l)||(this._valueCache[m]=null))}setVector4(m,S){this._cacheFloat4(m,S.x,S.y,S.z,S.w)&&(this.ES.setFloat4(this._uniforms[m],S.x,S.y,S.z,S.w)||(this._valueCache[m]=null))}setQuaternion(m,S){this._cacheFloat4(m,S.x,S.y,S.z,S.w)&&(this.ES.setFloat4(this._uniforms[m],S.x,S.y,S.z,S.w)||(this._valueCache[m]=null))}setFloat4(m,S,h,l,M){this._cacheFloat4(m,S,h,l,M)&&(this.ES.setFloat4(this._uniforms[m],S,h,l,M)||(this._valueCache[m]=null))}setColor3(m,S){this._cacheFloat3(m,S.r,S.g,S.b)&&(this.ES.setFloat3(this._uniforms[m],S.r,S.g,S.b)||(this._valueCache[m]=null))}setColor4(m,S,h){this._cacheFloat4(m,S.r,S.g,S.b,h)&&(this.ES.setFloat4(this._uniforms[m],S.r,S.g,S.b,h)||(this._valueCache[m]=null))}setDirectColor4(m,S){this._cacheFloat4(m,S.r,S.g,S.b,S.a)&&(this.ES.setFloat4(this._uniforms[m],S.r,S.g,S.b,S.a)||(this._valueCache[m]=null))}_getVertexShaderCode(){return this.vertexShader?this.ES._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.ES._getShaderSource(this.fragmentShader):null}}var M=h(11224);const O=new WeakMap,u={_webGLVersion:2,cachedPipelines:{}};function b(m){let S=O.get(m);if(!S){if(!m)return u;S={_webGLVersion:m.TEXTURE_BINDING_3D?2:1,_context:m,parallelShaderCompile:m.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},O.set(m,S)}return S}function q(m){O.delete(m)}function Y(m,S,h,l,M,O){const u=b(l);O||(O=u._createShaderProgramInjection??Z);return O(m,n(S,"vertex",l,u._contextWasLost),n(h,"fragment",l,u._contextWasLost),l,M,u.validateShaderPrograms)}function V(m,S,h,l,M){let O=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6?arguments[6]:void 0;const q=b(M);u||(u=q._createShaderProgramInjection??Z);const Y=q._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return u(m,E(S,"vertex",l,Y,M,q._contextWasLost),E(h,"fragment",l,Y,M,q._contextWasLost),M,O,q.validateShaderPrograms)}function I(m,S){const h=new l,M=b(m);return M.parallelShaderCompile&&!M.disableParallelShaderCompile&&(h.isParallelCompiled=!0),h.context=M._context,h}function Z(m,S,h,l){let M=arguments.length>5?arguments[5]:void 0;const O=l.createProgram();if(m.program=O,!O)throw new Error("Unable to create program");return l.attachShader(O,S),l.attachShader(O,h),l.linkProgram(O),m.context=l,m.vertexShader=S,m.fragmentShader=h,m.isParallelCompiled||B(m,l,M),O}function C(m,S,h){const l=m;if(l._isDisposed)return!1;const M=b(S);return!!(M&&M.parallelShaderCompile&&M.parallelShaderCompile.COMPLETION_STATUS_KHR&&l.program&&S.getProgramParameter(l.program,M.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(B(l,S,h),!0)}function B(m,S,h){const l=m.context,M=m.vertexShader,O=m.fragmentShader,u=m.program;if(!l.getProgramParameter(u,l.LINK_STATUS)){if(!S.getShaderParameter(M,S.COMPILE_STATUS)){const h=S.getShaderInfoLog(M);if(h)throw m.vertexCompilationError=h,new Error("VERTEX SHADER "+h)}if(!S.getShaderParameter(O,S.COMPILE_STATUS)){const h=S.getShaderInfoLog(O);if(h)throw m.fragmentCompilationError=h,new Error("FRAGMENT SHADER "+h)}const h=l.getProgramInfoLog(u);if(h)throw m.programLinkError=h,new Error(h)}if(h){l.validateProgram(u);if(!l.getProgramParameter(u,l.VALIDATE_STATUS)){const S=l.getProgramInfoLog(u);if(S)throw m.programValidationError=S,new Error(S)}}l.deleteShader(M),l.deleteShader(O),m.vertexShader=void 0,m.fragmentShader=void 0,m.onCompiled&&(m.onCompiled(),m.onCompiled=void 0)}function D(m,S,h,l,M,O,u,q,I){let Z=arguments.length>10?arguments[10]:void 0,C=arguments.length>11?arguments[11]:void 0,B=arguments.length>12?arguments[12]:void 0;const D=b(m.context);C||(C=D.createRawShaderProgramInjection??Y),B||(B=D.createShaderProgramInjection??V);const E=m;E.program=l?C(E,S,h,E.context,I):B(E,S,h,q,E.context,I),E.program.__SPECTOR_rebuildProgram=u,Z()}function E(m,S,h,l,O,u){return n((0,M.e)(m,h,l),S,O,u)}function n(m,S,h,l){const M=h.createShader("vertex"===S?h.VERTEX_SHADER:h.FRAGMENT_SHADER);if(!M){let m=h.NO_ERROR,M=h.NO_ERROR;for(;(M=h.getError())!==h.NO_ERROR;)m=M;throw new Error(`Something went wrong while creating a gl ${S} shader object. gl error=${m}, gl isContextLost=${h.isContextLost()}, _contextWasLost=${l}`)}return h.shaderSource(M,m),h.compileShader(M),M}function L(m,S){S.useProgram(m)}function U(m,S){const h=m;if(!h.isParallelCompiled)return void S(m);const l=h.onCompiled;h.onCompiled=()=>{null===l||void 0===l||l(),S(m)}}},11247:(m,S,h)=>{h.d(S,{b:()=>I,c:()=>C,d:()=>Y,e:()=>V});var l=h(11169),M=h(11255),O=h(11242),u=h(11173),b=h(11221),q=h(11224);function Y(m,S){return(0,M.A)(S).cachedPipelines[m]}function V(m){const S=m._name,h=m.context;if(S&&h){const m=(0,M.A)(h),l=m.cachedPipelines[S];null===l||void 0===l||l.dispose(),delete m.cachedPipelines[S]}}function I(m,S,h,M,O,u,q){let Y,V;const I=(0,l.m)()?null===u||void 0===u?void 0:u.getHostDocument():null;Y="string"===typeof S?S:S.vertexSource?"source:"+S.vertexSource:S.vertexElement?(null===I||void 0===I?void 0:I.getElementById(S.vertexElement))||S.vertexElement:S.vertex||S,V="string"===typeof S?S:S.fragmentSource?"source:"+S.fragmentSource:S.fragmentElement?(null===I||void 0===I?void 0:I.getElementById(S.fragmentElement))||S.fragmentElement:S.fragment||S;const C=[void 0,void 0],B=()=>{if(C[0]&&C[1]){m.isFragment=!0;const[l,Y]=C;(0,b.k)(Y,m,((u,Y)=>{q&&(q._fragmentSourceCodeBeforeMigration=Y),h&&(u=h("fragment",u));const V=(0,b.d)(l,u,m);m=null;const I=function(m,S,h,l){if(h){return{vertexSourceCode:(1===l?"//":"")+"#define SHADER_NAME vertex:"+(h.vertexElement||h.vertex||h.spectorName||h)+"\n"+m,fragmentSourceCode:(1===l?"//":"")+"#define SHADER_NAME fragment:"+(h.fragmentElement||h.fragment||h.spectorName||h)+"\n"+S}}return{vertexSourceCode:m,fragmentSourceCode:S}}(V.vertexCode,V.fragmentCode,S,O);null===M||void 0===M||M(I.vertexSourceCode,I.fragmentSourceCode)}),u)}};Z(Y,"Vertex","",(S=>{(0,b.f)(m),(0,b.k)(S,m,((m,l)=>{q&&(q._rawVertexSourceCode=S,q._vertexSourceCodeBeforeMigration=l),h&&(m=h("vertex",m)),C[0]=m,B()}),u)}),O),Z(V,"Fragment","Pixel",(m=>{q&&(q._rawFragmentSourceCode=m),C[1]=m,B()}),O)}function Z(m,S,h,M,u,b){if("undefined"!==typeof HTMLElement&&m instanceof HTMLElement){return void M((0,l.e)(m))}if("source:"===m.substring(0,7))return void M(m.substring(7));if("base64:"===m.substring(0,7)){return void M(window.atob(m.substring(7)))}const Y=O.b.GetShadersStore(u);if(Y[m+S+"Shader"])return void M(Y[m+S+"Shader"]);if(h&&Y[m+h+"Shader"])return void M(Y[m+h+"Shader"]);let V;if(V="."===m[0]||"/"===m[0]||m.indexOf("http")>-1?m:O.b.GetShadersRepository(u)+m,!(b=b||q.k))throw new Error("loadFileInjection is not defined");b(V+"."+S.toLowerCase()+".fx",M)}const C=(m,S,h,l)=>{try{const O=m.context?(0,M.A)(m.context):null;O&&(O.disableParallelShaderCompile=m.disableParallelCompilation);const u=m.existingPipelineContext||S(m.shaderProcessingContext);return u._name=m.name,m.name&&O&&(O.cachedPipelines[m.name]=u),h(u,m.vertex,m.fragment,!!m.createAsRaw,"","",m.rebuildRebind,m.defines,m.transformFeedbackVaryings,"",(()=>{l(u,(()=>{var S;null===(S=m.onRenderingStateCompiled)||void 0===S||S.call(m,u)}))})),u}catch(O){throw u.e.Error("Error compiling effect"),O}}},11238:(m,S,h)=>{h.r(S),h.d(S,{Effect:()=>q});var l=h(11161),M=h(11173),O=h(11242),u=h(11247),b=h(11226);class q{static get ShadersRepository(){return O.b.ShadersRepository}static set ShadersRepository(m){O.b.ShadersRepository=m}get u(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new l.e),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(m,S,h){let M=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,O=arguments.length>4?arguments[4]:void 0,b=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,Y=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,I=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,Z=arguments.length>9?arguments[9]:void 0,C=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",B=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,D=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new l.e,this.onErrorObservable=new l.e,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=m,this._key=C;const E=this._key.replace(/\r/g,"").replace(/\n/g,"|");let n;if(S.attributes){const m=S;if(this._engine=h,this._attributesNames=m.attributes,this._uniformsNames=m.uniformsNames.concat(m.samplers),this._samplerList=m.samplers.slice(),this.defines=m.defines,this.onError=m.onError,this.onCompiled=m.onCompiled,this._fallbacks=m.fallbacks,this._indexParameters=m.indexParameters,this._transformFeedbackVaryings=m.transformFeedbackVaryings||null,this._multiTarget=!!m.multiTarget,this._shaderLanguage=m.shaderLanguage??0,this._disableParallelShaderCompilation=!!m.disableParallelShaderCompilation,m.uniformBuffersNames){this._uniformBuffersNamesList=m.uniformBuffersNames.slice();for(let S=0;S<m.uniformBuffersNames.length;S++)this._uniformBuffersNames[m.uniformBuffersNames[S]]=S}this._processFinalCode=m.processFinalCode??null,this._processCodeAfterIncludes=m.processCodeAfterIncludes??void 0,D=m.extraInitializationsAsync,n=m.existingPipelineContext}else this._engine=O,this.defines=null==b?"":b,this._uniformsNames=h.concat(M),this._samplerList=M?M.slice():[],this._attributesNames=S,this._uniformBuffersNamesList=[],this._shaderLanguage=B,this.onError=I,this.onCompiled=V,this._indexParameters=Z,this._fallbacks=Y;"WEBGL2"===this._engine.shaderPlatformName&&(n=(0,u.d)(E,this._engine._gl)??n),this._attributeLocationByName={},this.uniqueId=q._UniqueIdSeed++,n?(this._pipelineContext=n,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,D),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.u||this.dispose(!0)}))}async _processShaderCodeAsync(){let m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3?arguments[3]:void 0;l&&await l(),this._processingContext=h||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const M={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:m??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:O.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:O.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,u.b)(M,this.name,this._processFinalCode,((m,h)=>{this._vertexSourceCode=m,this._fragmentSourceCode=h,this._prepareEffect(S)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.u||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(m){return this._attributes[m]}getAttributeLocationByName(m){return this._attributeLocationByName[m]}getAttributesCount(){return this._attributes.length}getUniformIndex(m){return this._uniformsNames.indexOf(m)}getUniform(m){return this._uniforms[m]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((m=>{this.executeWhenCompiled(m)}))}executeWhenCompiled(m){this.isReady()?m(this):(this.onCompileObservable.add((S=>{m(S)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(m){(0,b.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(S=>{this._processCompilationErrors(S,m)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var m;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(m=this._pipelineContext)||void 0===m?void 0:m._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var m;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(m=this._pipelineContext)||void 0===m?void 0:m._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(m,S,h,l){this._isReady=!1,this._vertexSourceCodeOverride=m,this._fragmentSourceCodeOverride=S,this.onError=(m,S)=>{l&&l(S)},this.onCompiled=()=>{var m,S;const l=this.getEngine().scenes;if(l)for(let h=0;h<l.length;h++)l[h].markAllMaterialsAsDirty(127);null===(m=(S=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===m||m.call(S,h)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(m){if(this._pipelineContext=m,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let S=0;S<this._attributesNames.length;S++){const m=this._attributesNames[S];this._attributeLocationByName[m]=this._attributes[S]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),q.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const S=this._pipelineContext;this._isReady=!1;try{const h=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),l=h?null:this.defines,M=h?this._vertexSourceCodeOverride:this._vertexSourceCode,O=h?this._fragmentSourceCodeOverride:this._fragmentSourceCode,b=this._engine;this._pipelineContext=(0,u.c)({existingPipelineContext:m?S:null,vertex:M,fragment:O,context:"WEBGL2"===b.shaderPlatformName||"WEBGL1"===b.shaderPlatformName?b._gl:void 0,rebuildRebind:(m,S,h,l)=>this._rebuildProgram(m,S,h,l),defines:l,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:h,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:h=>{S&&!m&&this._engine._deletePipelineContext(S),h&&this._onRenderingStateCompiled(h)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(S)}catch(h){this._processCompilationErrors(h,S)}}_getShaderCodeAndErrorLine(m,S,h){const l=h?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let M=null;if(S&&m){const O=S.match(l);if(O&&2===O.length){const S=parseInt(O[1]),l=m.split("\n",-1);l.length>=S&&(M=`Offending line [${S}] in ${h?"fragment":"vertex"} code: ${l[S-1]}`)}}return[m,M]}_processCompilationErrors(m){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=m.message;const h=this._attributesNames,l=this._fallbacks;if(M.e.Error("Unable to compile effect:"),M.e.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),M.e.Error(`Attributes: ${h.join(" ")}`),M.e.Error("Defines:\n"+this.defines),q.LogShaderCodeOnCompilationError){var O,u;let m=null,S=null,h=null;var b;if(null!==(O=this._pipelineContext)&&void 0!==O&&O._getVertexShaderCode()&&([h,m]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),h&&(M.e.Error("Vertex code:"),M.e.Error(h))),null!==(u=this._pipelineContext)&&void 0!==u&&u._getFragmentShaderCode())[h,S]=this._getShaderCodeAndErrorLine(null===(b=this._pipelineContext)||void 0===b?void 0:b._getFragmentShaderCode(),this._compilationError,!0),h&&(M.e.Error("Fragment code:"),M.e.Error(h));m&&M.e.Error(m),S&&M.e.Error(S)}M.e.Error("Error: "+this._compilationError);const Y=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};S&&(this._pipelineContext=S,this._isReady=!0,Y()),l?(this._pipelineContext=null,l.hasMoreFallbacks?(this._allFallbacksProcessed=!1,M.e.Error("Trying next fallback."),this.defines=l.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,Y(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,S||Y())}get isSupported(){return""===this._compilationError}_bindTexture(m,S){this._engine._bindTexture(this._samplers[m],S,m)}setTexture(m,S){this._engine.setTexture(this._samplers[m],this._uniforms[m],S,m)}setTextureArray(m,S){const h=m+"Ex";if(-1===this._samplerList.indexOf(h+"0")){const l=this._samplerList.indexOf(m);for(let m=1;m<S.length;m++){const S=h+(m-1).toString();this._samplerList.splice(l+m,0,S)}let M=0;for(const m of this._samplerList)this._samplers[m]=M,M+=1}this._engine.setTextureArray(this._samplers[m],this._uniforms[m],S,m)}bindUniformBuffer(m,S){const h=this._uniformBuffersNames[S];void 0===h||q._BaseCache[h]===m&&this._engine._features.useUBOBindingCache||(q._BaseCache[h]=m,this._engine.bindUniformBufferBase(m,h,S))}bindUniformBlock(m,S){this._engine.bindUniformBlock(this._pipelineContext,m,S)}setInt(m,S){return this._pipelineContext.setInt(m,S),this}setInt2(m,S,h){return this._pipelineContext.setInt2(m,S,h),this}setInt3(m,S,h,l){return this._pipelineContext.setInt3(m,S,h,l),this}setInt4(m,S,h,l,M){return this._pipelineContext.setInt4(m,S,h,l,M),this}setIntArray(m,S){return this._pipelineContext.setIntArray(m,S),this}setIntArray2(m,S){return this._pipelineContext.setIntArray2(m,S),this}setIntArray3(m,S){return this._pipelineContext.setIntArray3(m,S),this}setIntArray4(m,S){return this._pipelineContext.setIntArray4(m,S),this}setUInt(m,S){return this._pipelineContext.setUInt(m,S),this}setUInt2(m,S,h){return this._pipelineContext.setUInt2(m,S,h),this}setUInt3(m,S,h,l){return this._pipelineContext.setUInt3(m,S,h,l),this}setUInt4(m,S,h,l,M){return this._pipelineContext.setUInt4(m,S,h,l,M),this}setUIntArray(m,S){return this._pipelineContext.setUIntArray(m,S),this}setUIntArray2(m,S){return this._pipelineContext.setUIntArray2(m,S),this}setUIntArray3(m,S){return this._pipelineContext.setUIntArray3(m,S),this}setUIntArray4(m,S){return this._pipelineContext.setUIntArray4(m,S),this}setFloatArray(m,S){return this._pipelineContext.setArray(m,S),this}setFloatArray2(m,S){return this._pipelineContext.setArray2(m,S),this}setFloatArray3(m,S){return this._pipelineContext.setArray3(m,S),this}setFloatArray4(m,S){return this._pipelineContext.setArray4(m,S),this}setArray(m,S){return this._pipelineContext.setArray(m,S),this}setArray2(m,S){return this._pipelineContext.setArray2(m,S),this}setArray3(m,S){return this._pipelineContext.setArray3(m,S),this}setArray4(m,S){return this._pipelineContext.setArray4(m,S),this}setMatrices(m,S){return this._pipelineContext.setMatrices(m,S),this}setMatrix(m,S){return this._pipelineContext.setMatrix(m,S),this}setMatrix3x3(m,S){return this._pipelineContext.setMatrix3x3(m,S),this}setMatrix2x2(m,S){return this._pipelineContext.setMatrix2x2(m,S),this}setFloat(m,S){return this._pipelineContext.setFloat(m,S),this}setBool(m,S){return this._pipelineContext.setInt(m,S?1:0),this}setVector2(m,S){return this._pipelineContext.setVector2(m,S),this}setFloat2(m,S,h){return this._pipelineContext.setFloat2(m,S,h),this}setVector3(m,S){return this._pipelineContext.setVector3(m,S),this}setFloat3(m,S,h,l){return this._pipelineContext.setFloat3(m,S,h,l),this}setVector4(m,S){return this._pipelineContext.setVector4(m,S),this}setQuaternion(m,S){return this._pipelineContext.setQuaternion(m,S),this}setFloat4(m,S,h,l,M){return this._pipelineContext.setFloat4(m,S,h,l,M),this}setColor3(m,S){return this._pipelineContext.setColor3(m,S),this}setColor4(m,S,h){return this._pipelineContext.setColor4(m,S,h),this}setDirectColor4(m,S){return this._pipelineContext.setDirectColor4(m,S),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(q.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,u.e)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(m,S,h){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;S&&(O.b.GetShadersStore(l)[`${m}PixelShader`]=S),h&&(O.b.GetShadersStore(l)[`${m}VertexShader`]=h)}static ResetCache(){q._BaseCache={}}}q.LogShaderCodeOnCompilationError=!0,q.PersistentMode=!1,q.AutomaticallyClearCodeCache=!1,q._UniqueIdSeed=0,q._BaseCache={},q.ShadersStore=O.b.ShadersStore,q.IncludesShadersStore=O.b.IncludesShadersStore},11189:(m,S,h)=>{h.d(S,{c:()=>M});const l={};function M(m){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!l[m])return l[m]=!0,`${m} needs to be imported before as it contains a side-effect required by your code.`}},11169:(m,S,h)=>{function l(){return"undefined"!==typeof window}function M(){return"undefined"!==typeof navigator}function O(){return"undefined"!==typeof document}function u(m){let S="",h=m.firstChild;for(;h;)3===h.nodeType&&(S+=h.textContent),h=h.nextSibling;return S}h.d(S,{e:()=>u,f:()=>O,i:()=>M,m:()=>l})},11173:(m,S,h)=>{h.d(S,{e:()=>l});class l{static _CheckLimit(m,S){let h=l._LogLimitOutputs[m];return h?h.current++:(h={limit:S,current:1},l._LogLimitOutputs[m]=h),h.current<=h.limit}static _GenerateLimitMessage(m){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const h=l._LogLimitOutputs[m];if(!h||!l.MessageLimitReached)return;const M=this._Levels[S];h.current===h.limit&&l[M.name](l.MessageLimitReached.replace(/%LIMIT%/g,""+h.limit).replace(/%TYPE%/g,M.name??""))}static _AddLogEntry(m){l._LogCache=m+l._LogCache,l.OnNewCacheEntry&&l.OnNewCacheEntry(m)}static _FormatMessage(m){const S=m=>m<10?"0"+m:""+m,h=new Date;return"["+S(h.getHours())+":"+S(h.getMinutes())+":"+S(h.getSeconds())+"]: "+m}static _LogDisabled(m,S){}static _LogEnabled(){let m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,S=arguments.length>1?arguments[1]:void 0,h=arguments.length>2?arguments[2]:void 0;const M=Array.isArray(S)?S[0]:S;if(void 0!==h&&!l._CheckLimit(M,h))return;const O=l._FormatMessage(M),u=this._Levels[m],b=Array.isArray(S)?S.slice(1):[];u.logFunc&&u.logFunc("BJS - "+O,...b);const q=`<div style='color:${u.color}'>${O}</div><br>`;l._AddLogEntry(q),l._GenerateLimitMessage(M,m)}static get LogCache(){return l._LogCache}static ClearLogCache(){l._LogCache="",l._LogLimitOutputs={},l.errorsCount=0}static set LogLevels(m){l.Log=l._LogDisabled,l.Warn=l._LogDisabled,l.Error=l._LogDisabled;const S=[l.MessageLogLevel,l.WarningLogLevel,l.ErrorLogLevel];for(const h of S)if((m&h)===h){const m=this._Levels[h];l[m.name]=l._LogEnabled.bind(l,h)}}}l.NoneLogLevel=0,l.MessageLogLevel=1,l.WarningLogLevel=2,l.ErrorLogLevel=4,l.AllLogLevel=7,l.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",l._LogCache="",l._LogLimitOutputs={},l._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],l.errorsCount=0,l.Log=l._LogEnabled.bind(l,l.MessageLogLevel),l.Warn=l._LogEnabled.bind(l,l.WarningLogLevel),l.Error=l._LogEnabled.bind(l,l.ErrorLogLevel)},11161:(m,S,h)=>{h.d(S,{e:()=>u});const l="undefined"!==typeof WeakRef;class M{constructor(m){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],h=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;this.initialize(m,S,h,l)}initialize(m){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],h=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;return this.mask=m,this.skipNextObservers=S,this.target=h,this.currentTarget=l,this}}class O{constructor(m,S){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=m,this.mask=S,this.scope=h,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(m)}}class u{static FromPromise(m,S){const h=new u;return m.then((m=>{h.notifyObservers(m)})).catch((m=>{if(!S)throw m;S.notifyObservers(m)})),h}get observers(){return this._observers}constructor(m){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=S,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new M(0),m&&(this._onObserverAdded=m)}add(m){let S=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!m)return null;const M=new O(m,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);M.unregisterOnNextCall=h,S?this._observers.unshift(M):this._observers.push(M),this._onObserverAdded&&this._onObserverAdded(M),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(M,this._lastNotifiedValue);const u=l?new WeakRef(this):{deref:()=>this};return M._remove=function(){let m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const S=u.deref();S&&(m?S.remove(M):S._remove(M))},M}addOnce(m){return this.add(m,void 0,void 0,void 0,!0)}remove(m){if(!m)return!1;m._remove=null;return-1!==this._observers.indexOf(m)&&(this._deferUnregister(m),!0)}removeCallback(m,S){for(let h=0;h<this._observers.length;h++){const l=this._observers[h];if(!l._willBeUnregistered&&(l.callback===m&&(!S||S===l.scope)))return this._deferUnregister(l),!0}return!1}_deferUnregister(m){m._willBeUnregistered||(this._numObserversMarkedAsDeleted++,m.unregisterOnNextCall=!1,m._willBeUnregistered=!0,setTimeout((()=>{this._remove(m)}),0))}_remove(m){let S=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!m)return!1;const h=this._observers.indexOf(m);return-1!==h&&(S&&this._numObserversMarkedAsDeleted--,this._observers.splice(h,1),!0)}makeObserverTopPriority(m){this._remove(m,!1),this._observers.unshift(m)}makeObserverBottomPriority(m){this._remove(m,!1),this._observers.push(m)}notifyObservers(m){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,h=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,M=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=m),!this._observers.length)return!0;const O=this._eventState;O.mask=S,O.target=h,O.currentTarget=l,O.skipNextObservers=!1,O.lastReturnValue=m,O.userInfo=M;for(const u of this._observers)if(!u._willBeUnregistered&&(u.mask&S&&(u.unregisterOnNextCall&&this._deferUnregister(u),u.scope?O.lastReturnValue=u.callback.apply(u.scope,[m,O]):O.lastReturnValue=u.callback(m,O)),O.skipNextObservers))return!1;return!0}notifyObserver(m,S){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=S),m._willBeUnregistered)return;const l=this._eventState;l.mask=h,l.skipNextObservers=!1,m.unregisterOnNextCall&&this._deferUnregister(m),m.callback(S,l)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const m=this._observers.pop();m&&(m._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const m=new u;return m._observers=this._observers.slice(0),m}hasSpecificMask(){let m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const S of this._observers)if(S.mask&m||S.mask===m)return!0;return!1}}},11226:(m,S,h)=>{h.d(S,{c:()=>M,e:()=>u});let l=[];class M{static SetImmediate(m){0===l.length&&setTimeout((()=>{const m=l;l=[];for(const S of m)S()}),1),l.push(m)}}function O(m,S,h){try{if(m())return S(),!0}catch(l){return null===h||void 0===h||h(l),!0}return!1}const u=function(m,S,h){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,M=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,u=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&O(m,S,h))return null;const b=setInterval((()=>{O(m,S,h)?clearInterval(b):(M-=l,M<0&&(clearInterval(b),null===h||void 0===h||h(new Error("Operation timed out after maximum retries. "+(u||"")),!0)))}),l);return()=>clearInterval(b)}}}]);