"use strict";(self.vfdo5lmva5i=self.vfdo5lmva5i||[]).push([[9],{11595:(w,o,H)=>{H.d(o,{d:()=>T,h:()=>l,l:()=>O,i:()=>b,o:()=>p});class h{constructor(){this.children=[]}isValid(w){return!0}process(w,o,H){let h="";if(this.line){let H=this.line;const A=o.processor;if(A){var E,e,D,t,X,L;A.lineProcessor&&(H=A.lineProcessor(H,o.isFragment,o.processingContext));const h=(null===(E=o.processor)||void 0===E?void 0:E.attributeKeywordName)??"attribute",y=o.isFragment&&null!==(e=o.processor)&&void 0!==e&&e.varyingFragmentKeywordName?null===(D=o.processor)||void 0===D?void 0:D.varyingFragmentKeywordName:!o.isFragment&&null!==(t=o.processor)&&void 0!==t&&t.varyingVertexKeywordName?null===(X=o.processor)||void 0===X?void 0:X.varyingVertexKeywordName:"varying";if(!o.isFragment&&A.attributeProcessor&&this.line.startsWith(h))H=A.attributeProcessor(this.line,w,o.processingContext);else if(A.varyingProcessor&&(null!==(L=A.varyingCheck)&&void 0!==L&&L.call(A,this.line,o.isFragment)||!A.varyingCheck&&this.line.startsWith(y)))H=A.varyingProcessor(this.line,o.isFragment,w,o.processingContext);else if(A.uniformProcessor&&A.uniformRegexp&&A.uniformRegexp.test(this.line))o.lookForClosingBracketForUniformBuffer||(H=A.uniformProcessor(this.line,o.isFragment,w,o.processingContext));else if(A.uniformBufferProcessor&&A.uniformBufferRegexp&&A.uniformBufferRegexp.test(this.line))o.lookForClosingBracketForUniformBuffer||(H=A.uniformBufferProcessor(this.line,o.isFragment,o.processingContext),o.lookForClosingBracketForUniformBuffer=!0);else if(A.textureProcessor&&A.textureRegexp&&A.textureRegexp.test(this.line))H=A.textureProcessor(this.line,o.isFragment,w,o.processingContext);else if((A.uniformProcessor||A.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!o.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?A.uniformProcessor&&(H=A.uniformProcessor(this.line,o.isFragment,w,o.processingContext)):A.uniformBufferProcessor&&(H=A.uniformBufferProcessor(this.line,o.isFragment,o.processingContext),o.lookForClosingBracketForUniformBuffer=!0)}o.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(o.lookForClosingBracketForUniformBuffer=!1,A.endOfUniformBufferProcessor&&(H=A.endOfUniformBufferProcessor(this.line,o.isFragment,o.processingContext)))}h+=H+"\n"}for(const A of this.children)h+=A.process(w,o,H);return this.additionalDefineKey&&(w[this.additionalDefineKey]=this.additionalDefineValue||"true",H[this.additionalDefineKey]=w[this.additionalDefineKey]),h}}class E{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(w){this._lines.length=0;for(const o of w){if(!o||"\r"===o)continue;if("#"===o[0]){this._lines.push(o);continue}const w=o.trim();if(!w)continue;if(w.startsWith("//")){this._lines.push(o);continue}const H=w.indexOf(";");if(-1===H)this._lines.push(w);else if(H===w.length-1)w.length>1&&this._lines.push(w);else{const w=o.split(";");for(let o=0;o<w.length;o++){let H=w[o];H&&(H=H.trim(),H&&this._lines.push(H+(o!==w.length-1?";":"")))}}}}}class e extends h{process(w,o,H){for(let h=0;h<this.children.length;h++){const E=this.children[h];if(E.isValid(w))return E.process(w,o,H)}return""}}class D extends h{isValid(w){return this.testExpression.isTrue(w)}}class t{isTrue(w){return!0}static postfixToInfix(w){const o=[];for(const H of w)if(void 0===t._OperatorPriority[H])o.push(H);else{const w=o[o.length-1],h=o[o.length-2];o.length-=2,o.push(`(${h}${H}${w})`)}return o[o.length-1]}static infixToPostfix(w){const o=t._InfixToPostfixCache.get(w);if(o)return o.accessTime=Date.now(),o.result;if(!w.includes("&&")&&!w.includes("||")&&!w.includes(")")&&!w.includes("("))return[w];const H=[];let h=-1;const E=()=>{A=A.trim(),""!==A&&(H.push(A),A="")},e=w=>{h<t._Stack.length-1&&(t._Stack[++h]=w)},D=()=>t._Stack[h],X=()=>-1===h?"!!INVALID EXPRESSION!!":t._Stack[h--];let L=0,A="";for(;L<w.length;){const o=w.charAt(L),y=L<w.length-1?w.substring(L,2+L):"";if("("===o)A="",e(o);else if(")"===o){for(E();-1!==h&&"("!==D();)H.push(X());X()}else if(t._OperatorPriority[y]>1){for(E();-1!==h&&t._OperatorPriority[D()]>=t._OperatorPriority[y];)H.push(X());e(y),L++}else A+=o;L++}for(E();-1!==h;)"("===D()?X():H.push(X());return t._InfixToPostfixCache.size>=t.InfixToPostfixCacheLimitSize&&t.ClearCache(),t._InfixToPostfixCache.set(w,{result:H,accessTime:Date.now()}),H}static ClearCache(){const w=Array.from(t._InfixToPostfixCache.entries()).sort(((w,o)=>w[1].accessTime-o[1].accessTime));for(let o=0;o<t.InfixToPostfixCacheCleanupSize;o++)t._InfixToPostfixCache.delete(w[o][0])}}t.InfixToPostfixCacheLimitSize=5e4,t.InfixToPostfixCacheCleanupSize=25e3,t._InfixToPostfixCache=new Map,t._OperatorPriority={")":0,"(":1,"||":2,"&&":3},t._Stack=["","","","","","","","","","","","","","","","","","","",""];class X extends t{constructor(w){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=w,this.not=o}isTrue(w){let o=void 0!==w[this.define];return this.not&&(o=!o),o}}class L extends t{isTrue(w){return this.leftOperand.isTrue(w)||this.rightOperand.isTrue(w)}}class A extends t{isTrue(w){return this.leftOperand.isTrue(w)&&this.rightOperand.isTrue(w)}}class y extends t{constructor(w,o,H){super(),this.define=w,this.operand=o,this.testValue=H}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(w){let o=!1;const H=parseInt(void 0!=w[this.define]?w[this.define]:this.define),h=parseInt(void 0!=w[this.testValue]?w[this.testValue]:this.testValue);if(isNaN(H)||isNaN(h))return!1;switch(this.operand){case">":o=H>h;break;case"<":o=H<h;break;case"<=":o=H<=h;break;case">=":o=H>=h;break;case"==":o=H===h;break;case"!=":o=H!==h}return o}}var z=H(11564),C=H(11603);const Q=/defined\s*?\((.+?)\)/g,M=/defined\s*?\[(.+?)\]/g,i=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,s=/__decl__/,V=/light\{X\}.(\w*)/g,r=/\{X\}/g,k=[],P=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function l(w){w.processor&&w.processor.initializeShaders&&w.processor.initializeShaders(w.processingContext)}function O(w,o,H,h){var E;null!==(E=o.processor)&&void 0!==E&&E.preProcessShaderCode&&(w=o.processor.preProcessShaderCode(w,o.isFragment)),b(w,o,(w=>{o.processCodeAfterIncludes&&(w=o.processCodeAfterIncludes(o.isFragment?"fragment":"vertex",w,o.defines));const E=function(w,o,H){let h=function(w,o){var H;if(null!==(H=o.processor)&&void 0!==H&&H.noPrecision)return w;const h=o.shouldUseHighPrecisionShader;-1===w.indexOf("precision highp float")?w=h?"precision highp float;\n"+w:"precision mediump float;\n"+w:h||(w=w.replace("precision highp float","precision mediump float"));return w}(w,o);if(!o.processor)return h;if(0===o.processor.shaderLanguage&&-1!==h.indexOf("#version 3")&&(h=h.replace("#version 300 es",""),!o.processor.parseGLES3))return h;const E=o.defines,e=g(o,H);o.processor.preProcessor&&(h=o.processor.preProcessor(h,E,e,o.isFragment,o.processingContext));const D={};h=J(h,e,o,D),o.processor.postProcessor&&(h=o.processor.postProcessor(h,E,o.isFragment,o.processingContext,H?{drawBuffersExtensionDisabled:!H.getCaps().drawBuffersExtension}:{},e,D));null!==H&&void 0!==H&&H._features.needShaderCodeInlining&&(h=H.inlineShaderCode(h));return h}(w,o,h);H(E,w)}))}function T(w,o,H){return H.processor&&H.processor.finalizeShaders?H.processor.finalizeShaders(w,o,H.processingContext):{vertexCode:w,fragmentCode:o}}function S(w){const o=/defined\((.+)\)/.exec(w);if(o&&o.length)return new X(o[1].trim(),"!"===w[0]);const H=["==","!=",">=","<=","<",">"];let h="",E=0;for(h of H)if(E=w.indexOf(h),E>-1)break;if(-1===E)return new X(w);const e=w.substring(0,E).trim(),D=w.substring(E+h.length).trim();return new y(e,h,D)}function c(w,o){const H=new D,h=w.substring(0,o);let E=w.substring(o);return E=E.substring(0,(E.indexOf("//")+1||E.length+1)-1).trim(),H.testExpression="#ifdef"===h?new X(E):"#ifndef"===h?new X(E,!0):function(w){w=w.replace(Q,"defined[$1]");const o=t.infixToPostfix(w),H=[];for(const E of o)if("||"!==E&&"&&"!==E)H.push(E);else if(H.length>=2){let w=H[H.length-1],o=H[H.length-2];H.length-=2;const h="&&"==E?new A:new L;"string"===typeof w&&(w=w.replace(M,"defined($1)")),"string"===typeof o&&(o=o.replace(M,"defined($1)")),h.leftOperand="string"===typeof o?S(o):o,h.rightOperand="string"===typeof w?S(w):w,H.push(h)}let h=H[H.length-1];return"string"===typeof h&&(h=h.replace(M,"defined($1)")),"string"===typeof h?S(h):h}(E),H}function W(w,o,H,E){let e=w.currentLine;for(;B(w,H,E);){e=w.currentLine;const D=e.substring(0,5).toLowerCase();if("#else"===D){const H=new h;return o.children.push(H),void B(w,H,E)}if("#elif"===D){const w=c(e,5);o.children.push(w),H=w}}}function B(w,o,H){for(;w.canRead;){w.lineIndex++;const E=w.currentLine;if(E.indexOf("#")>=0){const h=P.exec(E);if(h&&h.length){switch(h[0]){case"#ifdef":{const h=new e;o.children.push(h);const D=c(E,6);h.children.push(D),W(w,h,D,H);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const h=new e;o.children.push(h);const D=c(E,7);h.children.push(D),W(w,h,D,H);break}case"#if":{const h=new e,D=c(E,3);o.children.push(h),h.children.push(D),W(w,h,D,H);break}}continue}}const D=new h;if(D.line=E,o.children.push(D),"#"===E[0]&&"d"===E[1]){const w=E.replace(";","").split(" ");D.additionalDefineKey=w[1],3===w.length&&(D.additionalDefineValue=w[2])}}return!1}function J(w,o,H,e){const D=new h,t=new E;return t.lineIndex=-1,t.lines=w.split("\n"),B(t,D,e),D.process(o,H,e)}function g(w,o){var H;const h=w.defines,E={};for(const e of h){const w=e.replace("#define","").replace(";","").trim().split(" ");E[w[0]]=w.length>1?w[1]:""}return 0===(null===(H=w.processor)||void 0===H?void 0:H.shaderLanguage)&&(E.GL_ES="true"),E.__VERSION__=w.version,E[w.platformName]="true",(0,C.f)(E,null===o||void 0===o?void 0:o.isNDCHalfZRange,null===o||void 0===o?void 0:o.useReverseDepthBuffer,null===o||void 0===o?void 0:o.useExactSrgbConversions),E}function b(w,o,H){let h;for(k.length=0;null!==(h=i.exec(w));)k.push(h);let E=String(w),e=[w],D=!1;for(const t of k){let w=t[1];if(-1!==w.indexOf("__decl__")&&(w=w.replace(s,""),o.supportsUniformBuffers&&(w=w.replace("Vertex","Ubo").replace("Fragment","Ubo")),w+="Declaration"),!o.includesShadersStore[w]){const h=o.shadersRepository+"ShadersInclude/"+w+".fx";return void p.loadFile(h,(h=>{o.includesShadersStore[w]=h,b(e.join(""),o,H)}))}{let H=o.includesShadersStore[w];if(t[2]){const w=t[3].split(",");for(let o=0;o<w.length;o+=2){const h=new RegExp(w[o],"g"),E=w[o+1];H=H.replace(h,E)}}if(t[4]){const w=t[5];if(-1!==w.indexOf("..")){const h=w.split(".."),E=parseInt(h[0]);let e=parseInt(h[1]),D=H.slice(0);H="",isNaN(e)&&(e=o.indexParameters[h[1]]);for(let w=E;w<e;w++)o.supportsUniformBuffers||(D=D.replace(V,((w,o)=>o+"{X}"))),H+=D.replace(r,w.toString())+"\n"}else o.supportsUniformBuffers||(H=H.replace(V,((w,o)=>o+"{X}"))),H=H.replace(r,w)}const h=[];for(const w of e){const o=w.split(t[0]);for(let w=0;w<o.length-1;w++)h.push(o[w]),h.push(H);h.push(o[o.length-1])}e=h,D=D||H.indexOf("#include<")>=0||H.indexOf("#include <")>=0}}k.length=0,E=e.join(""),D?b(E.toString(),o,H):H(E)}const p={loadFile:(w,o,H,h,E,e)=>{throw(0,z.b)("FileTools")}}},11603:(w,o,H)=>{H.d(o,{c:()=>E,d:()=>e,f:()=>t,i:()=>D,j:()=>X});var h=H(11564);H(11545);const E={};function e(w,o){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(o?o+"\n":"")+w}function D(w,o,H,e,D,t,X){const L=X||E.loadFile;if(L){return L(w,o,H,e,D,t)}throw(0,h.b)("FileTools")}function t(w,o,H,h){if(w)return o?w.IS_NDC_HALF_ZRANGE="":delete w.IS_NDC_HALF_ZRANGE,H?w.USE_REVERSE_DEPTHBUFFER="":delete w.USE_REVERSE_DEPTHBUFFER,void(h?w.USE_EXACT_SRGB_CONVERSIONS="":delete w.USE_EXACT_SRGB_CONVERSIONS);{let w="";return o&&(w+="#define IS_NDC_HALF_ZRANGE"),H&&(w&&(w+="\n"),w+="#define USE_REVERSE_DEPTHBUFFER"),h&&(w&&(w+="\n"),w+="#define USE_EXACT_SRGB_CONVERSIONS"),w}}function X(w,o){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=arguments.length>3?arguments[3]:void 0;switch(w){case 3:{const w=(ArrayBuffer,new Int8Array(o));return h&&w.set(new Int8Array(h)),w}case 0:{const w=(ArrayBuffer,new Uint8Array(o));return h&&w.set(new Uint8Array(h)),w}case 4:{const w=o instanceof ArrayBuffer?new Int16Array(o):new Int16Array(H?o/2:o);return h&&w.set(new Int16Array(h)),w}case 5:case 8:case 9:case 10:case 2:{const w=o instanceof ArrayBuffer?new Uint16Array(o):new Uint16Array(H?o/2:o);return h&&w.set(new Uint16Array(h)),w}case 6:{const w=o instanceof ArrayBuffer?new Int32Array(o):new Int32Array(H?o/4:o);return h&&w.set(new Int32Array(h)),w}case 7:case 11:case 12:case 13:case 14:case 15:{const w=o instanceof ArrayBuffer?new Uint32Array(o):new Uint32Array(H?o/4:o);return h&&w.set(new Uint32Array(h)),w}case 1:{const w=o instanceof ArrayBuffer?new Float32Array(o):new Float32Array(H?o/4:o);return h&&w.set(new Float32Array(h)),w}}const E=(ArrayBuffer,new Uint8Array(o));return h&&E.set(new Uint8Array(h)),E}},11625:(w,o,H)=>{H.d(o,{d:()=>h});class h{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?h.ShadersRepository:h.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?h.ShadersStore:h.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?h.IncludesShadersStore:h.IncludesShadersStoreWGSL}}h.ShadersRepository="src/Shaders/",h.ShadersStore={},h.IncludesShadersStore={},h.ShadersRepositoryWGSL="src/ShadersWGSL/",h.ShadersStoreWGSL={},h.IncludesShadersStoreWGSL={}},11631:(w,o,H)=>{H.d(o,{d:()=>z,h:()=>r,j:()=>Q,n:()=>C,q:()=>M,t:()=>V,w:()=>y,y:()=>L,C:()=>A,D:()=>X,E:()=>t});class h{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Mo._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(w){w&&this.program&&w(this.program)}setEngine(w){this.Mo=w}_fillEffectInformation(w,o,H,h,E,e,D,t){const X=this.Mo;if(X.supportsUniformBuffers)for(const A in o)w.bindUniformBlock(A,o[A]);let L;for(this.Mo.getUniforms(this,H).forEach(((w,o)=>{h[H[o]]=w})),this._uniforms=h,L=0;L<E.length;L++){null==w.getUniform(E[L])&&(E.splice(L,1),L--)}E.forEach(((w,o)=>{e[w]=o}));for(const A of X.getAttributes(this,D))t.push(A)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(w,o){const H=this._valueCache[w],h=o.updateFlag;return(void 0===H||H!==h)&&(this._valueCache[w]=h,!0)}_cacheFloat2(w,o,H){let h=this._valueCache[w];if(!h||2!==h.length)return h=[o,H],this._valueCache[w]=h,!0;let E=!1;return h[0]!==o&&(h[0]=o,E=!0),h[1]!==H&&(h[1]=H,E=!0),E}_cacheFloat3(w,o,H,h){let E=this._valueCache[w];if(!E||3!==E.length)return E=[o,H,h],this._valueCache[w]=E,!0;let e=!1;return E[0]!==o&&(E[0]=o,e=!0),E[1]!==H&&(E[1]=H,e=!0),E[2]!==h&&(E[2]=h,e=!0),e}_cacheFloat4(w,o,H,h,E){let e=this._valueCache[w];if(!e||4!==e.length)return e=[o,H,h,E],this._valueCache[w]=e,!0;let D=!1;return e[0]!==o&&(e[0]=o,D=!0),e[1]!==H&&(e[1]=H,D=!0),e[2]!==h&&(e[2]=h,D=!0),e[3]!==E&&(e[3]=E,D=!0),D}setInt(w,o){const H=this._valueCache[w];void 0!==H&&H===o||this.Mo.setInt(this._uniforms[w],o)&&(this._valueCache[w]=o)}setInt2(w,o,H){this._cacheFloat2(w,o,H)&&(this.Mo.setInt2(this._uniforms[w],o,H)||(this._valueCache[w]=null))}setInt3(w,o,H,h){this._cacheFloat3(w,o,H,h)&&(this.Mo.setInt3(this._uniforms[w],o,H,h)||(this._valueCache[w]=null))}setInt4(w,o,H,h,E){this._cacheFloat4(w,o,H,h,E)&&(this.Mo.setInt4(this._uniforms[w],o,H,h,E)||(this._valueCache[w]=null))}setIntArray(w,o){this._valueCache[w]=null,this.Mo.setIntArray(this._uniforms[w],o)}setIntArray2(w,o){this._valueCache[w]=null,this.Mo.setIntArray2(this._uniforms[w],o)}setIntArray3(w,o){this._valueCache[w]=null,this.Mo.setIntArray3(this._uniforms[w],o)}setIntArray4(w,o){this._valueCache[w]=null,this.Mo.setIntArray4(this._uniforms[w],o)}setUInt(w,o){const H=this._valueCache[w];void 0!==H&&H===o||this.Mo.setUInt(this._uniforms[w],o)&&(this._valueCache[w]=o)}setUInt2(w,o,H){this._cacheFloat2(w,o,H)&&(this.Mo.setUInt2(this._uniforms[w],o,H)||(this._valueCache[w]=null))}setUInt3(w,o,H,h){this._cacheFloat3(w,o,H,h)&&(this.Mo.setUInt3(this._uniforms[w],o,H,h)||(this._valueCache[w]=null))}setUInt4(w,o,H,h,E){this._cacheFloat4(w,o,H,h,E)&&(this.Mo.setUInt4(this._uniforms[w],o,H,h,E)||(this._valueCache[w]=null))}setUIntArray(w,o){this._valueCache[w]=null,this.Mo.setUIntArray(this._uniforms[w],o)}setUIntArray2(w,o){this._valueCache[w]=null,this.Mo.setUIntArray2(this._uniforms[w],o)}setUIntArray3(w,o){this._valueCache[w]=null,this.Mo.setUIntArray3(this._uniforms[w],o)}setUIntArray4(w,o){this._valueCache[w]=null,this.Mo.setUIntArray4(this._uniforms[w],o)}setArray(w,o){this._valueCache[w]=null,this.Mo.setArray(this._uniforms[w],o)}setArray2(w,o){this._valueCache[w]=null,this.Mo.setArray2(this._uniforms[w],o)}setArray3(w,o){this._valueCache[w]=null,this.Mo.setArray3(this._uniforms[w],o)}setArray4(w,o){this._valueCache[w]=null,this.Mo.setArray4(this._uniforms[w],o)}setMatrices(w,o){o&&(this._valueCache[w]=null,this.Mo.setMatrices(this._uniforms[w],o))}setMatrix(w,o){this._cacheMatrix(w,o)&&(this.Mo.setMatrices(this._uniforms[w],o.Ae())||(this._valueCache[w]=null))}setMatrix3x3(w,o){this._valueCache[w]=null,this.Mo.setMatrix3x3(this._uniforms[w],o)}setMatrix2x2(w,o){this._valueCache[w]=null,this.Mo.setMatrix2x2(this._uniforms[w],o)}setFloat(w,o){const H=this._valueCache[w];void 0!==H&&H===o||this.Mo.setFloat(this._uniforms[w],o)&&(this._valueCache[w]=o)}setVector2(w,o){this._cacheFloat2(w,o.x,o.y)&&(this.Mo.setFloat2(this._uniforms[w],o.x,o.y)||(this._valueCache[w]=null))}setFloat2(w,o,H){this._cacheFloat2(w,o,H)&&(this.Mo.setFloat2(this._uniforms[w],o,H)||(this._valueCache[w]=null))}setVector3(w,o){this._cacheFloat3(w,o.x,o.y,o.z)&&(this.Mo.setFloat3(this._uniforms[w],o.x,o.y,o.z)||(this._valueCache[w]=null))}setFloat3(w,o,H,h){this._cacheFloat3(w,o,H,h)&&(this.Mo.setFloat3(this._uniforms[w],o,H,h)||(this._valueCache[w]=null))}setVector4(w,o){this._cacheFloat4(w,o.x,o.y,o.z,o.w)&&(this.Mo.setFloat4(this._uniforms[w],o.x,o.y,o.z,o.w)||(this._valueCache[w]=null))}setQuaternion(w,o){this._cacheFloat4(w,o.x,o.y,o.z,o.w)&&(this.Mo.setFloat4(this._uniforms[w],o.x,o.y,o.z,o.w)||(this._valueCache[w]=null))}setFloat4(w,o,H,h,E){this._cacheFloat4(w,o,H,h,E)&&(this.Mo.setFloat4(this._uniforms[w],o,H,h,E)||(this._valueCache[w]=null))}setColor3(w,o){this._cacheFloat3(w,o.r,o.g,o.b)&&(this.Mo.setFloat3(this._uniforms[w],o.r,o.g,o.b)||(this._valueCache[w]=null))}setColor4(w,o,H){this._cacheFloat4(w,o.r,o.g,o.b,H)&&(this.Mo.setFloat4(this._uniforms[w],o.r,o.g,o.b,H)||(this._valueCache[w]=null))}setDirectColor4(w,o){this._cacheFloat4(w,o.r,o.g,o.b,o.a)&&(this.Mo.setFloat4(this._uniforms[w],o.r,o.g,o.b,o.a)||(this._valueCache[w]=null))}_getVertexShaderCode(){return this.vertexShader?this.Mo._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Mo._getShaderSource(this.fragmentShader):null}}var E=H(11603);const e=new WeakMap,D={_webGLVersion:2,cachedPipelines:{}};function t(w){let o=e.get(w);if(!o){if(!w)return D;o={_webGLVersion:w.TEXTURE_BINDING_3D?2:1,_context:w,parallelShaderCompile:w.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},e.set(w,o)}return o}function X(w){e.delete(w)}function L(w,o,H,h,E,e){const D=t(h);e||(e=D._createShaderProgramInjection??z);return e(w,s(o,"vertex",h,D._contextWasLost),s(H,"fragment",h,D._contextWasLost),h,E,D.validateShaderPrograms)}function A(w,o,H,h,E){let e=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,D=arguments.length>6?arguments[6]:void 0;const X=t(E);D||(D=X._createShaderProgramInjection??z);const L=X._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return D(w,i(o,"vertex",h,L,E,X._contextWasLost),i(H,"fragment",h,L,E,X._contextWasLost),E,e,X.validateShaderPrograms)}function y(w,o){const H=new h,E=t(w);return E.parallelShaderCompile&&!E.disableParallelShaderCompile&&(H.isParallelCompiled=!0),H.context=E._context,H}function z(w,o,H,h){let E=arguments.length>5?arguments[5]:void 0;const e=h.createProgram();if(w.program=e,!e)throw new Error("Unable to create program");return h.attachShader(e,o),h.attachShader(e,H),h.linkProgram(e),w.context=h,w.vertexShader=o,w.fragmentShader=H,w.isParallelCompiled||Q(w,h,E),e}function C(w,o,H){const h=w;if(h._isDisposed)return!1;const E=t(o);return!!(E&&E.parallelShaderCompile&&E.parallelShaderCompile.COMPLETION_STATUS_KHR&&h.program&&o.getProgramParameter(h.program,E.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(Q(h,o,H),!0)}function Q(w,o,H){const h=w.context,E=w.vertexShader,e=w.fragmentShader,D=w.program;if(!h.getProgramParameter(D,h.LINK_STATUS)){if(!o.getShaderParameter(E,o.COMPILE_STATUS)){const H=o.getShaderInfoLog(E);if(H)throw w.vertexCompilationError=H,new Error("VERTEX SHADER "+H)}if(!o.getShaderParameter(e,o.COMPILE_STATUS)){const H=o.getShaderInfoLog(e);if(H)throw w.fragmentCompilationError=H,new Error("FRAGMENT SHADER "+H)}const H=h.getProgramInfoLog(D);if(H)throw w.programLinkError=H,new Error(H)}if(H){h.validateProgram(D);if(!h.getProgramParameter(D,h.VALIDATE_STATUS)){const o=h.getProgramInfoLog(D);if(o)throw w.programValidationError=o,new Error(o)}}h.deleteShader(E),h.deleteShader(e),w.vertexShader=void 0,w.fragmentShader=void 0,w.onCompiled&&(w.onCompiled(),w.onCompiled=void 0)}function M(w,o,H,h,E,e,D,X,y){let z=arguments.length>10?arguments[10]:void 0,C=arguments.length>11?arguments[11]:void 0,Q=arguments.length>12?arguments[12]:void 0;const M=t(w.context);C||(C=M.createRawShaderProgramInjection??L),Q||(Q=M.createShaderProgramInjection??A);const i=w;i.program=h?C(i,o,H,i.context,y):Q(i,o,H,X,i.context,y),i.program.__SPECTOR_rebuildProgram=D,z()}function i(w,o,H,h,e,D){return s((0,E.d)(w,H,h),o,e,D)}function s(w,o,H,h){const E=H.createShader("vertex"===o?H.VERTEX_SHADER:H.FRAGMENT_SHADER);if(!E){let w=H.NO_ERROR,E=H.NO_ERROR;for(;(E=H.getError())!==H.NO_ERROR;)w=E;throw new Error(`Something went wrong while creating a gl ${o} shader object. gl error=${w}, gl isContextLost=${H.isContextLost()}, _contextWasLost=${h}`)}return H.shaderSource(E,w),H.compileShader(E),E}function V(w,o){o.useProgram(w)}function r(w,o){const H=w;if(!H.isParallelCompiled)return void o(w);const h=H.onCompiled;H.onCompiled=()=>{null===h||void 0===h||h(),o(w)}}},11627:(w,o,H)=>{H.d(o,{c:()=>y,f:()=>C,h:()=>L,i:()=>A});var h=H(11545),E=H(11631),e=H(11625),D=H(11551),t=H(11595),X=H(11603);function L(w,o){return(0,E.E)(o).cachedPipelines[w]}function A(w){const o=w._name,H=w.context;if(o&&H){const w=(0,E.E)(H),h=w.cachedPipelines[o];null===h||void 0===h||h.dispose(),delete w.cachedPipelines[o]}}function y(w,o,H,E,e,D,X){let L,A;const y=(0,h.i)()?null===D||void 0===D?void 0:D.getHostDocument():null;L="string"===typeof o?o:o.vertexSource?"source:"+o.vertexSource:o.vertexElement?(null===y||void 0===y?void 0:y.getElementById(o.vertexElement))||o.vertexElement:o.vertex||o,A="string"===typeof o?o:o.fragmentSource?"source:"+o.fragmentSource:o.fragmentElement?(null===y||void 0===y?void 0:y.getElementById(o.fragmentElement))||o.fragmentElement:o.fragment||o;const C=[void 0,void 0],Q=()=>{if(C[0]&&C[1]){w.isFragment=!0;const[h,L]=C;(0,t.l)(L,w,((D,L)=>{X&&(X._fragmentSourceCodeBeforeMigration=L),H&&(D=H("fragment",D));const A=(0,t.d)(h,D,w);w=null;const y=function(w,o,H,h){if(H){return{vertexSourceCode:(1===h?"//":"")+"#define SHADER_NAME vertex:"+(H.vertexElement||H.vertex||H.spectorName||H)+"\n"+w,fragmentSourceCode:(1===h?"//":"")+"#define SHADER_NAME fragment:"+(H.fragmentElement||H.fragment||H.spectorName||H)+"\n"+o}}return{vertexSourceCode:w,fragmentSourceCode:o}}(A.vertexCode,A.fragmentCode,o,e);null===E||void 0===E||E(y.vertexSourceCode,y.fragmentSourceCode)}),D)}};z(L,"Vertex","",(o=>{(0,t.h)(w),(0,t.l)(o,w,((w,h)=>{X&&(X._rawVertexSourceCode=o,X._vertexSourceCodeBeforeMigration=h),H&&(w=H("vertex",w)),C[0]=w,Q()}),D)}),e),z(A,"Fragment","Pixel",(w=>{X&&(X._rawFragmentSourceCode=w),C[1]=w,Q()}),e)}function z(w,o,H,E,D,t){if("undefined"!==typeof HTMLElement&&w instanceof HTMLElement){return void E((0,h.c)(w))}if("source:"===w.substring(0,7))return void E(w.substring(7));if("base64:"===w.substring(0,7)){return void E(window.atob(w.substring(7)))}const L=e.d.GetShadersStore(D);if(L[w+o+"Shader"])return void E(L[w+o+"Shader"]);if(H&&L[w+H+"Shader"])return void E(L[w+H+"Shader"]);let A;if(A="."===w[0]||"/"===w[0]||w.indexOf("http")>-1?w:e.d.GetShadersRepository(D)+w,!(t=t||X.i))throw new Error("loadFileInjection is not defined");t(A+"."+o.toLowerCase()+".fx",E)}const C=(w,o,H,h)=>{try{const e=w.context?(0,E.E)(w.context):null;e&&(e.disableParallelShaderCompile=w.disableParallelCompilation);const D=w.existingPipelineContext||o(w.shaderProcessingContext);return D._name=w.name,w.name&&e&&(e.cachedPipelines[w.name]=D),H(D,w.vertex,w.fragment,!!w.createAsRaw,"","",w.rebuildRebind,w.defines,w.transformFeedbackVaryings,"",(()=>{h(D,(()=>{var o;null===(o=w.onRenderingStateCompiled)||void 0===o||o.call(w,D)}))})),D}catch(e){throw D.d.Error("Error compiling effect"),e}}},11623:(w,o,H)=>{H.r(o),H.d(o,{Effect:()=>X});var h=H(11540),E=H(11551),e=H(11625),D=H(11627),t=H(11606);class X{static get ShadersRepository(){return e.d.ShadersRepository}static set ShadersRepository(w){e.d.ShadersRepository=w}get A(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new h.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(w,o,H){let E=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,e=arguments.length>4?arguments[4]:void 0,t=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,L=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,A=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,y=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,z=arguments.length>9?arguments[9]:void 0,C=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",Q=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,M=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new h.b,this.onErrorObservable=new h.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=w,this._key=C;const i=this._key.replace(/\r/g,"").replace(/\n/g,"|");let s;if(o.attributes){const w=o;if(this._engine=H,this._attributesNames=w.attributes,this._uniformsNames=w.uniformsNames.concat(w.samplers),this._samplerList=w.samplers.slice(),this.defines=w.defines,this.onError=w.onError,this.onCompiled=w.onCompiled,this._fallbacks=w.fallbacks,this._indexParameters=w.indexParameters,this._transformFeedbackVaryings=w.transformFeedbackVaryings||null,this._multiTarget=!!w.multiTarget,this._shaderLanguage=w.shaderLanguage??0,this._disableParallelShaderCompilation=!!w.disableParallelShaderCompilation,w.uniformBuffersNames){this._uniformBuffersNamesList=w.uniformBuffersNames.slice();for(let o=0;o<w.uniformBuffersNames.length;o++)this._uniformBuffersNames[w.uniformBuffersNames[o]]=o}this._processFinalCode=w.processFinalCode??null,this._processCodeAfterIncludes=w.processCodeAfterIncludes??void 0,M=w.extraInitializationsAsync,s=w.existingPipelineContext}else this._engine=e,this.defines=null==t?"":t,this._uniformsNames=H.concat(E),this._samplerList=E?E.slice():[],this._attributesNames=o,this._uniformBuffersNamesList=[],this._shaderLanguage=Q,this.onError=y,this.onCompiled=A,this._indexParameters=z,this._fallbacks=L;"WEBGL2"===this._engine.shaderPlatformName&&(s=(0,D.h)(i,this._engine._gl)??s),this._attributeLocationByName={},this.uniqueId=X._UniqueIdSeed++,s?(this._pipelineContext=s,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,M),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.A||this.dispose(!0)}))}async _processShaderCodeAsync(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,h=arguments.length>3?arguments[3]:void 0;h&&await h(),this._processingContext=H||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const E={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:w??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:e.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:e.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,D.c)(E,this.name,this._processFinalCode,((w,H)=>{this._vertexSourceCode=w,this._fragmentSourceCode=H,this._prepareEffect(o)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.A||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(w){return this._attributes[w]}getAttributeLocationByName(w){return this._attributeLocationByName[w]}getAttributesCount(){return this._attributes.length}getUniformIndex(w){return this._uniformsNames.indexOf(w)}getUniform(w){return this._uniforms[w]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((w=>{this.executeWhenCompiled(w)}))}executeWhenCompiled(w){this.isReady()?w(this):(this.onCompileObservable.add((o=>{w(o)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(w){(0,t.h)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(o=>{this._processCompilationErrors(o,w)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var w;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(w=this._pipelineContext)||void 0===w?void 0:w._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var w;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(w=this._pipelineContext)||void 0===w?void 0:w._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(w,o,H,h){this._isReady=!1,this._vertexSourceCodeOverride=w,this._fragmentSourceCodeOverride=o,this.onError=(w,o)=>{h&&h(o)},this.onCompiled=()=>{var w,o;const h=this.getEngine().scenes;if(h)for(let H=0;H<h.length;H++)h[H].markAllMaterialsAsDirty(127);null===(w=(o=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===w||w.call(o,H)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(w){if(this._pipelineContext=w,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let o=0;o<this._attributesNames.length;o++){const w=this._attributesNames[o];this._attributeLocationByName[w]=this._attributes[o]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),X.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=this._pipelineContext;this._isReady=!1;try{const H=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),h=H?null:this.defines,E=H?this._vertexSourceCodeOverride:this._vertexSourceCode,e=H?this._fragmentSourceCodeOverride:this._fragmentSourceCode,t=this._engine;this._pipelineContext=(0,D.f)({existingPipelineContext:w?o:null,vertex:E,fragment:e,context:"WEBGL2"===t.shaderPlatformName||"WEBGL1"===t.shaderPlatformName?t._gl:void 0,rebuildRebind:(w,o,H,h)=>this._rebuildProgram(w,o,H,h),defines:h,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:H,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:H=>{o&&!w&&this._engine._deletePipelineContext(o),H&&this._onRenderingStateCompiled(H)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(o)}catch(H){this._processCompilationErrors(H,o)}}_getShaderCodeAndErrorLine(w,o,H){const h=H?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let E=null;if(o&&w){const e=o.match(h);if(e&&2===e.length){const o=parseInt(e[1]),h=w.split("\n",-1);h.length>=o&&(E=`Offending line [${o}] in ${H?"fragment":"vertex"} code: ${h[o-1]}`)}}return[w,E]}_processCompilationErrors(w){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=w.message;const H=this._attributesNames,h=this._fallbacks;if(E.d.Error("Unable to compile effect:"),E.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),E.d.Error(`Attributes: ${H.join(" ")}`),E.d.Error("Defines:\n"+this.defines),X.LogShaderCodeOnCompilationError){var e,D;let w=null,o=null,H=null;var t;if(null!==(e=this._pipelineContext)&&void 0!==e&&e._getVertexShaderCode()&&([H,w]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),H&&(E.d.Error("Vertex code:"),E.d.Error(H))),null!==(D=this._pipelineContext)&&void 0!==D&&D._getFragmentShaderCode())[H,o]=this._getShaderCodeAndErrorLine(null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode(),this._compilationError,!0),H&&(E.d.Error("Fragment code:"),E.d.Error(H));w&&E.d.Error(w),o&&E.d.Error(o)}E.d.Error("Error: "+this._compilationError);const L=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};o&&(this._pipelineContext=o,this._isReady=!0,L()),h?(this._pipelineContext=null,h.hasMoreFallbacks?(this._allFallbacksProcessed=!1,E.d.Error("Trying next fallback."),this.defines=h.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,L(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,o||L())}get isSupported(){return""===this._compilationError}_bindTexture(w,o){this._engine._bindTexture(this._samplers[w],o,w)}setTexture(w,o){this._engine.setTexture(this._samplers[w],this._uniforms[w],o,w)}setTextureArray(w,o){const H=w+"Ex";if(-1===this._samplerList.indexOf(H+"0")){const h=this._samplerList.indexOf(w);for(let w=1;w<o.length;w++){const o=H+(w-1).toString();this._samplerList.splice(h+w,0,o)}let E=0;for(const w of this._samplerList)this._samplers[w]=E,E+=1}this._engine.setTextureArray(this._samplers[w],this._uniforms[w],o,w)}bindUniformBuffer(w,o){const H=this._uniformBuffersNames[o];void 0===H||X._BaseCache[H]===w&&this._engine._features.useUBOBindingCache||(X._BaseCache[H]=w,this._engine.bindUniformBufferBase(w,H,o))}bindUniformBlock(w,o){this._engine.bindUniformBlock(this._pipelineContext,w,o)}setInt(w,o){return this._pipelineContext.setInt(w,o),this}setInt2(w,o,H){return this._pipelineContext.setInt2(w,o,H),this}setInt3(w,o,H,h){return this._pipelineContext.setInt3(w,o,H,h),this}setInt4(w,o,H,h,E){return this._pipelineContext.setInt4(w,o,H,h,E),this}setIntArray(w,o){return this._pipelineContext.setIntArray(w,o),this}setIntArray2(w,o){return this._pipelineContext.setIntArray2(w,o),this}setIntArray3(w,o){return this._pipelineContext.setIntArray3(w,o),this}setIntArray4(w,o){return this._pipelineContext.setIntArray4(w,o),this}setUInt(w,o){return this._pipelineContext.setUInt(w,o),this}setUInt2(w,o,H){return this._pipelineContext.setUInt2(w,o,H),this}setUInt3(w,o,H,h){return this._pipelineContext.setUInt3(w,o,H,h),this}setUInt4(w,o,H,h,E){return this._pipelineContext.setUInt4(w,o,H,h,E),this}setUIntArray(w,o){return this._pipelineContext.setUIntArray(w,o),this}setUIntArray2(w,o){return this._pipelineContext.setUIntArray2(w,o),this}setUIntArray3(w,o){return this._pipelineContext.setUIntArray3(w,o),this}setUIntArray4(w,o){return this._pipelineContext.setUIntArray4(w,o),this}setFloatArray(w,o){return this._pipelineContext.setArray(w,o),this}setFloatArray2(w,o){return this._pipelineContext.setArray2(w,o),this}setFloatArray3(w,o){return this._pipelineContext.setArray3(w,o),this}setFloatArray4(w,o){return this._pipelineContext.setArray4(w,o),this}setArray(w,o){return this._pipelineContext.setArray(w,o),this}setArray2(w,o){return this._pipelineContext.setArray2(w,o),this}setArray3(w,o){return this._pipelineContext.setArray3(w,o),this}setArray4(w,o){return this._pipelineContext.setArray4(w,o),this}setMatrices(w,o){return this._pipelineContext.setMatrices(w,o),this}setMatrix(w,o){return this._pipelineContext.setMatrix(w,o),this}setMatrix3x3(w,o){return this._pipelineContext.setMatrix3x3(w,o),this}setMatrix2x2(w,o){return this._pipelineContext.setMatrix2x2(w,o),this}setFloat(w,o){return this._pipelineContext.setFloat(w,o),this}setBool(w,o){return this._pipelineContext.setInt(w,o?1:0),this}setVector2(w,o){return this._pipelineContext.setVector2(w,o),this}setFloat2(w,o,H){return this._pipelineContext.setFloat2(w,o,H),this}setVector3(w,o){return this._pipelineContext.setVector3(w,o),this}setFloat3(w,o,H,h){return this._pipelineContext.setFloat3(w,o,H,h),this}setVector4(w,o){return this._pipelineContext.setVector4(w,o),this}setQuaternion(w,o){return this._pipelineContext.setQuaternion(w,o),this}setFloat4(w,o,H,h,E){return this._pipelineContext.setFloat4(w,o,H,h,E),this}setColor3(w,o){return this._pipelineContext.setColor3(w,o),this}setColor4(w,o,H){return this._pipelineContext.setColor4(w,o,H),this}setDirectColor4(w,o){return this._pipelineContext.setDirectColor4(w,o),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(X.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,D.i)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(w,o,H){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;o&&(e.d.GetShadersStore(h)[`${w}PixelShader`]=o),H&&(e.d.GetShadersStore(h)[`${w}VertexShader`]=H)}static ResetCache(){X._BaseCache={}}}X.LogShaderCodeOnCompilationError=!0,X.PersistentMode=!1,X.AutomaticallyClearCodeCache=!1,X._UniqueIdSeed=0,X._BaseCache={},X.ShadersStore=e.d.ShadersStore,X.IncludesShadersStore=e.d.IncludesShadersStore},11564:(w,o,H)=>{H.d(o,{b:()=>E});const h={};function E(w){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!h[w])return h[w]=!0,`${w} needs to be imported before as it contains a side-effect required by your code.`}},11545:(w,o,H)=>{function h(){return"undefined"!==typeof window}function E(){return"undefined"!==typeof navigator}function e(){return"undefined"!==typeof document}function D(w){let o="",H=w.firstChild;for(;H;)3===H.nodeType&&(o+=H.textContent),H=H.nextSibling;return o}H.d(o,{c:()=>D,d:()=>e,g:()=>E,i:()=>h})},11551:(w,o,H)=>{H.d(o,{d:()=>h});class h{static _CheckLimit(w,o){let H=h._LogLimitOutputs[w];return H?H.current++:(H={limit:o,current:1},h._LogLimitOutputs[w]=H),H.current<=H.limit}static _GenerateLimitMessage(w){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const H=h._LogLimitOutputs[w];if(!H||!h.MessageLimitReached)return;const E=this._Levels[o];H.current===H.limit&&h[E.name](h.MessageLimitReached.replace(/%LIMIT%/g,""+H.limit).replace(/%TYPE%/g,E.name??""))}static _AddLogEntry(w){h._LogCache=w+h._LogCache,h.OnNewCacheEntry&&h.OnNewCacheEntry(w)}static _FormatMessage(w){const o=w=>w<10?"0"+w:""+w,H=new Date;return"["+o(H.getHours())+":"+o(H.getMinutes())+":"+o(H.getSeconds())+"]: "+w}static _LogDisabled(w,o){}static _LogEnabled(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1?arguments[1]:void 0,H=arguments.length>2?arguments[2]:void 0;const E=Array.isArray(o)?o[0]:o;if(void 0!==H&&!h._CheckLimit(E,H))return;const e=h._FormatMessage(E),D=this._Levels[w],t=Array.isArray(o)?o.slice(1):[];D.logFunc&&D.logFunc("BJS - "+e,...t);const X=`<div style='color:${D.color}'>${e}</div><br>`;h._AddLogEntry(X),h._GenerateLimitMessage(E,w)}static get LogCache(){return h._LogCache}static ClearLogCache(){h._LogCache="",h._LogLimitOutputs={},h.errorsCount=0}static set LogLevels(w){h.Log=h._LogDisabled,h.Warn=h._LogDisabled,h.Error=h._LogDisabled;const o=[h.MessageLogLevel,h.WarningLogLevel,h.ErrorLogLevel];for(const H of o)if((w&H)===H){const w=this._Levels[H];h[w.name]=h._LogEnabled.bind(h,H)}}}h.NoneLogLevel=0,h.MessageLogLevel=1,h.WarningLogLevel=2,h.ErrorLogLevel=4,h.AllLogLevel=7,h.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",h._LogCache="",h._LogLimitOutputs={},h._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],h.errorsCount=0,h.Log=h._LogEnabled.bind(h,h.MessageLogLevel),h.Warn=h._LogEnabled.bind(h,h.WarningLogLevel),h.Error=h._LogEnabled.bind(h,h.ErrorLogLevel)},11540:(w,o,H)=>{H.d(o,{b:()=>D});const h="undefined"!==typeof WeakRef;class E{constructor(w){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0;this.initialize(w,o,H,h)}initialize(w){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0;return this.mask=w,this.skipNextObservers=o,this.target=H,this.currentTarget=h,this}}class e{constructor(w,o){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=w,this.mask=o,this.scope=H,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(w)}}class D{static FromPromise(w,o){const H=new D;return w.then((w=>{H.notifyObservers(w)})).catch((w=>{if(!o)throw w;o.notifyObservers(w)})),H}get observers(){return this._observers}constructor(w){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=o,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new E(0),w&&(this._onObserverAdded=w)}add(w){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!w)return null;const E=new e(w,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);E.unregisterOnNextCall=H,o?this._observers.unshift(E):this._observers.push(E),this._onObserverAdded&&this._onObserverAdded(E),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(E,this._lastNotifiedValue);const D=h?new WeakRef(this):{deref:()=>this};return E._remove=function(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const o=D.deref();o&&(w?o.remove(E):o._remove(E))},E}addOnce(w){return this.add(w,void 0,void 0,void 0,!0)}remove(w){if(!w)return!1;w._remove=null;return-1!==this._observers.indexOf(w)&&(this._deferUnregister(w),!0)}removeCallback(w,o){for(let H=0;H<this._observers.length;H++){const h=this._observers[H];if(!h._willBeUnregistered&&(h.callback===w&&(!o||o===h.scope)))return this._deferUnregister(h),!0}return!1}_deferUnregister(w){w._willBeUnregistered||(this._numObserversMarkedAsDeleted++,w.unregisterOnNextCall=!1,w._willBeUnregistered=!0,setTimeout((()=>{this._remove(w)}),0))}_remove(w){let o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!w)return!1;const H=this._observers.indexOf(w);return-1!==H&&(o&&this._numObserversMarkedAsDeleted--,this._observers.splice(H,1),!0)}makeObserverTopPriority(w){this._remove(w,!1),this._observers.unshift(w)}makeObserverBottomPriority(w){this._remove(w,!1),this._observers.push(w)}notifyObservers(w){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,H=arguments.length>2?arguments[2]:void 0,h=arguments.length>3?arguments[3]:void 0,E=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=w),!this._observers.length)return!0;const e=this._eventState;e.mask=o,e.target=H,e.currentTarget=h,e.skipNextObservers=!1,e.lastReturnValue=w,e.userInfo=E;for(const D of this._observers)if(!D._willBeUnregistered&&(D.mask&o&&(D.unregisterOnNextCall&&this._deferUnregister(D),D.scope?e.lastReturnValue=D.callback.apply(D.scope,[w,e]):e.lastReturnValue=D.callback(w,e)),e.skipNextObservers))return!1;return!0}notifyObserver(w,o){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=o),w._willBeUnregistered)return;const h=this._eventState;h.mask=H,h.skipNextObservers=!1,w.unregisterOnNextCall&&this._deferUnregister(w),w.callback(o,h)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const w=this._observers.pop();w&&(w._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const w=new D;return w._observers=this._observers.slice(0),w}hasSpecificMask(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const o of this._observers)if(o.mask&w||o.mask===w)return!0;return!1}}},11606:(w,o,H)=>{H.d(o,{d:()=>E,h:()=>D});let h=[];class E{static SetImmediate(w){0===h.length&&setTimeout((()=>{const w=h;h=[];for(const o of w)o()}),1),h.push(w)}}function e(w,o,H){try{if(w())return o(),!0}catch(h){return null===H||void 0===H||H(h),!0}return!1}const D=function(w,o,H){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,D=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&e(w,o,H))return null;const t=setInterval((()=>{e(w,o,H)?clearInterval(t):(E-=h,E<0&&(clearInterval(t),null===H||void 0===H||H(new Error("Operation timed out after maximum retries. "+(D||"")),!0)))}),h);return()=>clearInterval(t)}}}]);