"use strict";(self["1kjc9ee3uyt"]=self["1kjc9ee3uyt"]||[]).push([[9],{11564:(w,E,G)=>{G.d(E,{b:()=>T,d:()=>q,g:()=>W,f:()=>N,i:()=>v});class P{constructor(){this.children=[]}isValid(w){return!0}process(w,E,G){let P="";if(this.line){let G=this.line;const i=E.processor;if(i){var h,B,y,x,U,l;i.lineProcessor&&(G=i.lineProcessor(G,E.isFragment,E.processingContext));const P=(null===(h=E.processor)||void 0===h?void 0:h.attributeKeywordName)??"attribute",O=E.isFragment&&null!==(B=E.processor)&&void 0!==B&&B.varyingFragmentKeywordName?null===(y=E.processor)||void 0===y?void 0:y.varyingFragmentKeywordName:!E.isFragment&&null!==(x=E.processor)&&void 0!==x&&x.varyingVertexKeywordName?null===(U=E.processor)||void 0===U?void 0:U.varyingVertexKeywordName:"varying";if(!E.isFragment&&i.attributeProcessor&&this.line.startsWith(P))G=i.attributeProcessor(this.line,w,E.processingContext);else if(i.varyingProcessor&&(null!==(l=i.varyingCheck)&&void 0!==l&&l.call(i,this.line,E.isFragment)||!i.varyingCheck&&this.line.startsWith(O)))G=i.varyingProcessor(this.line,E.isFragment,w,E.processingContext);else if(i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(G=i.uniformProcessor(this.line,E.isFragment,w,E.processingContext));else if(i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(G=i.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0);else if(i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line))G=i.textureProcessor(this.line,E.isFragment,w,E.processingContext);else if((i.uniformProcessor||i.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!E.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?i.uniformProcessor&&(G=i.uniformProcessor(this.line,E.isFragment,w,E.processingContext)):i.uniformBufferProcessor&&(G=i.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0)}E.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(E.lookForClosingBracketForUniformBuffer=!1,i.endOfUniformBufferProcessor&&(G=i.endOfUniformBufferProcessor(this.line,E.isFragment,E.processingContext)))}P+=G+"\n"}for(const i of this.children)P+=i.process(w,E,G);return this.additionalDefineKey&&(w[this.additionalDefineKey]=this.additionalDefineValue||"true",G[this.additionalDefineKey]=w[this.additionalDefineKey]),P}}class h{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(w){this._lines.length=0;for(const E of w){if(!E||"\r"===E)continue;if("#"===E[0]){this._lines.push(E);continue}const w=E.trim();if(!w)continue;if(w.startsWith("//")){this._lines.push(E);continue}const G=w.indexOf(";");if(-1===G)this._lines.push(w);else if(G===w.length-1)w.length>1&&this._lines.push(w);else{const w=E.split(";");for(let E=0;E<w.length;E++){let G=w[E];G&&(G=G.trim(),G&&this._lines.push(G+(E!==w.length-1?";":"")))}}}}}class B extends P{process(w,E,G){for(let P=0;P<this.children.length;P++){const h=this.children[P];if(h.isValid(w))return h.process(w,E,G)}return""}}class y extends P{isValid(w){return this.testExpression.isTrue(w)}}class x{isTrue(w){return!0}static postfixToInfix(w){const E=[];for(const G of w)if(void 0===x._OperatorPriority[G])E.push(G);else{const w=E[E.length-1],P=E[E.length-2];E.length-=2,E.push(`(${P}${G}${w})`)}return E[E.length-1]}static infixToPostfix(w){const E=x._InfixToPostfixCache.get(w);if(E)return E.accessTime=Date.now(),E.result;if(!w.includes("&&")&&!w.includes("||")&&!w.includes(")")&&!w.includes("("))return[w];const G=[];let P=-1;const h=()=>{i=i.trim(),""!==i&&(G.push(i),i="")},B=w=>{P<x._Stack.length-1&&(x._Stack[++P]=w)},y=()=>x._Stack[P],U=()=>-1===P?"!!INVALID EXPRESSION!!":x._Stack[P--];let l=0,i="";for(;l<w.length;){const E=w.charAt(l),O=l<w.length-1?w.substring(l,2+l):"";if("("===E)i="",B(E);else if(")"===E){for(h();-1!==P&&"("!==y();)G.push(U());U()}else if(x._OperatorPriority[O]>1){for(h();-1!==P&&x._OperatorPriority[y()]>=x._OperatorPriority[O];)G.push(U());B(O),l++}else i+=E;l++}for(h();-1!==P;)"("===y()?U():G.push(U());return x._InfixToPostfixCache.size>=x.InfixToPostfixCacheLimitSize&&x.ClearCache(),x._InfixToPostfixCache.set(w,{result:G,accessTime:Date.now()}),G}static ClearCache(){const w=Array.from(x._InfixToPostfixCache.entries()).sort(((w,E)=>w[1].accessTime-E[1].accessTime));for(let E=0;E<x.InfixToPostfixCacheCleanupSize;E++)x._InfixToPostfixCache.delete(w[E][0])}}x.InfixToPostfixCacheLimitSize=5e4,x.InfixToPostfixCacheCleanupSize=25e3,x._InfixToPostfixCache=new Map,x._OperatorPriority={")":0,"(":1,"||":2,"&&":3},x._Stack=["","","","","","","","","","","","","","","","","","","",""];class U extends x{constructor(w){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=w,this.not=E}isTrue(w){let E=void 0!==w[this.define];return this.not&&(E=!E),E}}class l extends x{isTrue(w){return this.leftOperand.isTrue(w)||this.rightOperand.isTrue(w)}}class i extends x{isTrue(w){return this.leftOperand.isTrue(w)&&this.rightOperand.isTrue(w)}}class O extends x{constructor(w,E,G){super(),this.define=w,this.operand=E,this.testValue=G}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(w){let E=!1;const G=parseInt(void 0!=w[this.define]?w[this.define]:this.define),P=parseInt(void 0!=w[this.testValue]?w[this.testValue]:this.testValue);if(isNaN(G)||isNaN(P))return!1;switch(this.operand){case">":E=G>P;break;case"<":E=G<P;break;case"<=":E=G<=P;break;case">=":E=G>=P;break;case"==":E=G===P;break;case"!=":E=G!==P}return E}}var u=G(11536),V=G(11568);const a=/defined\s*?\((.+?)\)/g,Q=/defined\s*?\[(.+?)\]/g,c=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,Z=/__decl__/,J=/light\{X\}.(\w*)/g,d=/\{X\}/g,K=[],t=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function q(w){w.processor&&w.processor.initializeShaders&&w.processor.initializeShaders(w.processingContext)}function W(w,E,G,P){var h;null!==(h=E.processor)&&void 0!==h&&h.preProcessShaderCode&&(w=E.processor.preProcessShaderCode(w,E.isFragment)),N(w,E,(w=>{E.processCodeAfterIncludes&&(w=E.processCodeAfterIncludes(E.isFragment?"fragment":"vertex",w,E.defines));const h=function(w,E,G){let P=function(w,E){var G;if(null!==(G=E.processor)&&void 0!==G&&G.noPrecision)return w;const P=E.shouldUseHighPrecisionShader;-1===w.indexOf("precision highp float")?w=P?"precision highp float;\n"+w:"precision mediump float;\n"+w:P||(w=w.replace("precision highp float","precision mediump float"));return w}(w,E);if(!E.processor)return P;if(0===E.processor.shaderLanguage&&-1!==P.indexOf("#version 3")&&(P=P.replace("#version 300 es",""),!E.processor.parseGLES3))return P;const h=E.defines,B=k(E,G);E.processor.preProcessor&&(P=E.processor.preProcessor(P,h,B,E.isFragment,E.processingContext));const y={};P=f(P,B,E,y),E.processor.postProcessor&&(P=E.processor.postProcessor(P,h,E.isFragment,E.processingContext,G?{drawBuffersExtensionDisabled:!G.getCaps().drawBuffersExtension}:{},B,y));null!==G&&void 0!==G&&G._features.needShaderCodeInlining&&(P=G.inlineShaderCode(P));return P}(w,E,P);G(h,w)}))}function T(w,E,G){return G.processor&&G.processor.finalizeShaders?G.processor.finalizeShaders(w,E,G.processingContext):{vertexCode:w,fragmentCode:E}}function I(w){const E=/defined\((.+)\)/.exec(w);if(E&&E.length)return new U(E[1].trim(),"!"===w[0]);const G=["==","!=",">=","<=","<",">"];let P="",h=0;for(P of G)if(h=w.indexOf(P),h>-1)break;if(-1===h)return new U(w);const B=w.substring(0,h).trim(),y=w.substring(h+P.length).trim();return new O(B,P,y)}function j(w,E){const G=new y,P=w.substring(0,E);let h=w.substring(E);return h=h.substring(0,(h.indexOf("//")+1||h.length+1)-1).trim(),G.testExpression="#ifdef"===P?new U(h):"#ifndef"===P?new U(h,!0):function(w){w=w.replace(a,"defined[$1]");const E=x.infixToPostfix(w),G=[];for(const h of E)if("||"!==h&&"&&"!==h)G.push(h);else if(G.length>=2){let w=G[G.length-1],E=G[G.length-2];G.length-=2;const P="&&"==h?new i:new l;"string"===typeof w&&(w=w.replace(Q,"defined($1)")),"string"===typeof E&&(E=E.replace(Q,"defined($1)")),P.leftOperand="string"===typeof E?I(E):E,P.rightOperand="string"===typeof w?I(w):w,G.push(P)}let P=G[G.length-1];return"string"===typeof P&&(P=P.replace(Q,"defined($1)")),"string"===typeof P?I(P):P}(h),G}function g(w,E,G,h){let B=w.currentLine;for(;o(w,G,h);){B=w.currentLine;const y=B.substring(0,5).toLowerCase();if("#else"===y){const G=new P;return E.children.push(G),void o(w,G,h)}if("#elif"===y){const w=j(B,5);E.children.push(w),G=w}}}function o(w,E,G){for(;w.canRead;){w.lineIndex++;const h=w.currentLine;if(h.indexOf("#")>=0){const P=t.exec(h);if(P&&P.length){switch(P[0]){case"#ifdef":{const P=new B;E.children.push(P);const y=j(h,6);P.children.push(y),g(w,P,y,G);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const P=new B;E.children.push(P);const y=j(h,7);P.children.push(y),g(w,P,y,G);break}case"#if":{const P=new B,y=j(h,3);E.children.push(P),P.children.push(y),g(w,P,y,G);break}}continue}}const y=new P;if(y.line=h,E.children.push(y),"#"===h[0]&&"d"===h[1]){const w=h.replace(";","").split(" ");y.additionalDefineKey=w[1],3===w.length&&(y.additionalDefineValue=w[2])}}return!1}function f(w,E,G,B){const y=new P,x=new h;return x.lineIndex=-1,x.lines=w.split("\n"),o(x,y,B),y.process(E,G,B)}function k(w,E){var G;const P=w.defines,h={};for(const B of P){const w=B.replace("#define","").replace(";","").trim().split(" ");h[w[0]]=w.length>1?w[1]:""}return 0===(null===(G=w.processor)||void 0===G?void 0:G.shaderLanguage)&&(h.GL_ES="true"),h.__VERSION__=w.version,h[w.platformName]="true",(0,V.h)(h,null===E||void 0===E?void 0:E.isNDCHalfZRange,null===E||void 0===E?void 0:E.useReverseDepthBuffer,null===E||void 0===E?void 0:E.useExactSrgbConversions),h}function N(w,E,G){let P;for(K.length=0;null!==(P=c.exec(w));)K.push(P);let h=String(w),B=[w],y=!1;for(const x of K){let w=x[1];if(-1!==w.indexOf("__decl__")&&(w=w.replace(Z,""),E.supportsUniformBuffers&&(w=w.replace("Vertex","Ubo").replace("Fragment","Ubo")),w+="Declaration"),!E.includesShadersStore[w]){const P=E.shadersRepository+"ShadersInclude/"+w+".fx";return void v.loadFile(P,(P=>{E.includesShadersStore[w]=P,N(B.join(""),E,G)}))}{let G=E.includesShadersStore[w];if(x[2]){const w=x[3].split(",");for(let E=0;E<w.length;E+=2){const P=new RegExp(w[E],"g"),h=w[E+1];G=G.replace(P,h)}}if(x[4]){const w=x[5];if(-1!==w.indexOf("..")){const P=w.split(".."),h=parseInt(P[0]);let B=parseInt(P[1]),y=G.slice(0);G="",isNaN(B)&&(B=E.indexParameters[P[1]]);for(let w=h;w<B;w++)E.supportsUniformBuffers||(y=y.replace(J,((w,E)=>E+"{X}"))),G+=y.replace(d,w.toString())+"\n"}else E.supportsUniformBuffers||(G=G.replace(J,((w,E)=>E+"{X}"))),G=G.replace(d,w)}const P=[];for(const w of B){const E=w.split(x[0]);for(let w=0;w<E.length-1;w++)P.push(E[w]),P.push(G);P.push(E[E.length-1])}B=P,y=y||G.indexOf("#include<")>=0||G.indexOf("#include <")>=0}}K.length=0,h=B.join(""),y?N(h.toString(),E,G):G(h)}const v={loadFile:(w,E,G,P,h,B)=>{throw(0,u.d)("FileTools")}}},11568:(w,E,G)=>{G.d(E,{d:()=>h,e:()=>B,h:()=>x,i:()=>y,j:()=>U});var P=G(11536);G(11513);const h={};function B(w,E){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(E?E+"\n":"")+w}function y(w,E,G,B,y,x,U){const l=U||h.loadFile;if(l){return l(w,E,G,B,y,x)}throw(0,P.d)("FileTools")}function x(w,E,G,P){if(w)return E?w.IS_NDC_HALF_ZRANGE="":delete w.IS_NDC_HALF_ZRANGE,G?w.USE_REVERSE_DEPTHBUFFER="":delete w.USE_REVERSE_DEPTHBUFFER,void(P?w.USE_EXACT_SRGB_CONVERSIONS="":delete w.USE_EXACT_SRGB_CONVERSIONS);{let w="";return E&&(w+="#define IS_NDC_HALF_ZRANGE"),G&&(w&&(w+="\n"),w+="#define USE_REVERSE_DEPTHBUFFER"),P&&(w&&(w+="\n"),w+="#define USE_EXACT_SRGB_CONVERSIONS"),w}}function U(w,E){let G=arguments.length>2&&void 0!==arguments[2]&&arguments[2],P=arguments.length>3?arguments[3]:void 0;switch(w){case 3:{const w=(ArrayBuffer,new Int8Array(E));return P&&w.set(new Int8Array(P)),w}case 0:{const w=(ArrayBuffer,new Uint8Array(E));return P&&w.set(new Uint8Array(P)),w}case 4:{const w=E instanceof ArrayBuffer?new Int16Array(E):new Int16Array(G?E/2:E);return P&&w.set(new Int16Array(P)),w}case 5:case 8:case 9:case 10:case 2:{const w=E instanceof ArrayBuffer?new Uint16Array(E):new Uint16Array(G?E/2:E);return P&&w.set(new Uint16Array(P)),w}case 6:{const w=E instanceof ArrayBuffer?new Int32Array(E):new Int32Array(G?E/4:E);return P&&w.set(new Int32Array(P)),w}case 7:case 11:case 12:case 13:case 14:case 15:{const w=E instanceof ArrayBuffer?new Uint32Array(E):new Uint32Array(G?E/4:E);return P&&w.set(new Uint32Array(P)),w}case 1:{const w=E instanceof ArrayBuffer?new Float32Array(E):new Float32Array(G?E/4:E);return P&&w.set(new Float32Array(P)),w}}const h=(ArrayBuffer,new Uint8Array(E));return P&&h.set(new Uint8Array(P)),h}},11595:(w,E,G)=>{G.d(E,{b:()=>P});class P{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.ShadersRepository:P.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.ShadersStore:P.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.IncludesShadersStore:P.IncludesShadersStoreWGSL}}P.ShadersRepository="src/Shaders/",P.ShadersStore={},P.IncludesShadersStore={},P.ShadersRepositoryWGSL="src/ShadersWGSL/",P.ShadersStoreWGSL={},P.IncludesShadersStoreWGSL={}},11610:(w,E,G)=>{G.d(E,{d:()=>u,f:()=>d,i:()=>a,k:()=>V,m:()=>Q,n:()=>J,q:()=>O,r:()=>l,t:()=>i,v:()=>U,w:()=>x});class P{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.aE._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(w){w&&this.program&&w(this.program)}setEngine(w){this.aE=w}_fillEffectInformation(w,E,G,P,h,B,y,x){const U=this.aE;if(U.supportsUniformBuffers)for(const i in E)w.bindUniformBlock(i,E[i]);let l;for(this.aE.getUniforms(this,G).forEach(((w,E)=>{P[G[E]]=w})),this._uniforms=P,l=0;l<h.length;l++){null==w.getUniform(h[l])&&(h.splice(l,1),l--)}h.forEach(((w,E)=>{B[w]=E}));for(const i of U.getAttributes(this,y))x.push(i)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(w,E){const G=this._valueCache[w],P=E.updateFlag;return(void 0===G||G!==P)&&(this._valueCache[w]=P,!0)}_cacheFloat2(w,E,G){let P=this._valueCache[w];if(!P||2!==P.length)return P=[E,G],this._valueCache[w]=P,!0;let h=!1;return P[0]!==E&&(P[0]=E,h=!0),P[1]!==G&&(P[1]=G,h=!0),h}_cacheFloat3(w,E,G,P){let h=this._valueCache[w];if(!h||3!==h.length)return h=[E,G,P],this._valueCache[w]=h,!0;let B=!1;return h[0]!==E&&(h[0]=E,B=!0),h[1]!==G&&(h[1]=G,B=!0),h[2]!==P&&(h[2]=P,B=!0),B}_cacheFloat4(w,E,G,P,h){let B=this._valueCache[w];if(!B||4!==B.length)return B=[E,G,P,h],this._valueCache[w]=B,!0;let y=!1;return B[0]!==E&&(B[0]=E,y=!0),B[1]!==G&&(B[1]=G,y=!0),B[2]!==P&&(B[2]=P,y=!0),B[3]!==h&&(B[3]=h,y=!0),y}setInt(w,E){const G=this._valueCache[w];void 0!==G&&G===E||this.aE.setInt(this._uniforms[w],E)&&(this._valueCache[w]=E)}setInt2(w,E,G){this._cacheFloat2(w,E,G)&&(this.aE.setInt2(this._uniforms[w],E,G)||(this._valueCache[w]=null))}setInt3(w,E,G,P){this._cacheFloat3(w,E,G,P)&&(this.aE.setInt3(this._uniforms[w],E,G,P)||(this._valueCache[w]=null))}setInt4(w,E,G,P,h){this._cacheFloat4(w,E,G,P,h)&&(this.aE.setInt4(this._uniforms[w],E,G,P,h)||(this._valueCache[w]=null))}setIntArray(w,E){this._valueCache[w]=null,this.aE.setIntArray(this._uniforms[w],E)}setIntArray2(w,E){this._valueCache[w]=null,this.aE.setIntArray2(this._uniforms[w],E)}setIntArray3(w,E){this._valueCache[w]=null,this.aE.setIntArray3(this._uniforms[w],E)}setIntArray4(w,E){this._valueCache[w]=null,this.aE.setIntArray4(this._uniforms[w],E)}setUInt(w,E){const G=this._valueCache[w];void 0!==G&&G===E||this.aE.setUInt(this._uniforms[w],E)&&(this._valueCache[w]=E)}setUInt2(w,E,G){this._cacheFloat2(w,E,G)&&(this.aE.setUInt2(this._uniforms[w],E,G)||(this._valueCache[w]=null))}setUInt3(w,E,G,P){this._cacheFloat3(w,E,G,P)&&(this.aE.setUInt3(this._uniforms[w],E,G,P)||(this._valueCache[w]=null))}setUInt4(w,E,G,P,h){this._cacheFloat4(w,E,G,P,h)&&(this.aE.setUInt4(this._uniforms[w],E,G,P,h)||(this._valueCache[w]=null))}setUIntArray(w,E){this._valueCache[w]=null,this.aE.setUIntArray(this._uniforms[w],E)}setUIntArray2(w,E){this._valueCache[w]=null,this.aE.setUIntArray2(this._uniforms[w],E)}setUIntArray3(w,E){this._valueCache[w]=null,this.aE.setUIntArray3(this._uniforms[w],E)}setUIntArray4(w,E){this._valueCache[w]=null,this.aE.setUIntArray4(this._uniforms[w],E)}setArray(w,E){this._valueCache[w]=null,this.aE.setArray(this._uniforms[w],E)}setArray2(w,E){this._valueCache[w]=null,this.aE.setArray2(this._uniforms[w],E)}setArray3(w,E){this._valueCache[w]=null,this.aE.setArray3(this._uniforms[w],E)}setArray4(w,E){this._valueCache[w]=null,this.aE.setArray4(this._uniforms[w],E)}setMatrices(w,E){E&&(this._valueCache[w]=null,this.aE.setMatrices(this._uniforms[w],E))}setMatrix(w,E){this._cacheMatrix(w,E)&&(this.aE.setMatrices(this._uniforms[w],E.Lh())||(this._valueCache[w]=null))}setMatrix3x3(w,E){this._valueCache[w]=null,this.aE.setMatrix3x3(this._uniforms[w],E)}setMatrix2x2(w,E){this._valueCache[w]=null,this.aE.setMatrix2x2(this._uniforms[w],E)}setFloat(w,E){const G=this._valueCache[w];void 0!==G&&G===E||this.aE.setFloat(this._uniforms[w],E)&&(this._valueCache[w]=E)}setVector2(w,E){this._cacheFloat2(w,E.x,E.y)&&(this.aE.setFloat2(this._uniforms[w],E.x,E.y)||(this._valueCache[w]=null))}setFloat2(w,E,G){this._cacheFloat2(w,E,G)&&(this.aE.setFloat2(this._uniforms[w],E,G)||(this._valueCache[w]=null))}setVector3(w,E){this._cacheFloat3(w,E.x,E.y,E.z)&&(this.aE.setFloat3(this._uniforms[w],E.x,E.y,E.z)||(this._valueCache[w]=null))}setFloat3(w,E,G,P){this._cacheFloat3(w,E,G,P)&&(this.aE.setFloat3(this._uniforms[w],E,G,P)||(this._valueCache[w]=null))}setVector4(w,E){this._cacheFloat4(w,E.x,E.y,E.z,E.w)&&(this.aE.setFloat4(this._uniforms[w],E.x,E.y,E.z,E.w)||(this._valueCache[w]=null))}setQuaternion(w,E){this._cacheFloat4(w,E.x,E.y,E.z,E.w)&&(this.aE.setFloat4(this._uniforms[w],E.x,E.y,E.z,E.w)||(this._valueCache[w]=null))}setFloat4(w,E,G,P,h){this._cacheFloat4(w,E,G,P,h)&&(this.aE.setFloat4(this._uniforms[w],E,G,P,h)||(this._valueCache[w]=null))}setColor3(w,E){this._cacheFloat3(w,E.r,E.g,E.b)&&(this.aE.setFloat3(this._uniforms[w],E.r,E.g,E.b)||(this._valueCache[w]=null))}setColor4(w,E,G){this._cacheFloat4(w,E.r,E.g,E.b,G)&&(this.aE.setFloat4(this._uniforms[w],E.r,E.g,E.b,G)||(this._valueCache[w]=null))}setDirectColor4(w,E){this._cacheFloat4(w,E.r,E.g,E.b,E.a)&&(this.aE.setFloat4(this._uniforms[w],E.r,E.g,E.b,E.a)||(this._valueCache[w]=null))}_getVertexShaderCode(){return this.vertexShader?this.aE._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.aE._getShaderSource(this.fragmentShader):null}}var h=G(11568);const B=new WeakMap,y={_webGLVersion:2,cachedPipelines:{}};function x(w){let E=B.get(w);if(!E){if(!w)return y;E={_webGLVersion:w.TEXTURE_BINDING_3D?2:1,_context:w,parallelShaderCompile:w.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},B.set(w,E)}return E}function U(w){B.delete(w)}function l(w,E,G,P,h,B){const y=x(P);B||(B=y._createShaderProgramInjection??u);return B(w,Z(E,"vertex",P,y._contextWasLost),Z(G,"fragment",P,y._contextWasLost),P,h,y.validateShaderPrograms)}function i(w,E,G,P,h){let B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,y=arguments.length>6?arguments[6]:void 0;const U=x(h);y||(y=U._createShaderProgramInjection??u);const l=U._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return y(w,c(E,"vertex",P,l,h,U._contextWasLost),c(G,"fragment",P,l,h,U._contextWasLost),h,B,U.validateShaderPrograms)}function O(w,E){const G=new P,h=x(w);return h.parallelShaderCompile&&!h.disableParallelShaderCompile&&(G.isParallelCompiled=!0),G.context=h._context,G}function u(w,E,G,P){let h=arguments.length>5?arguments[5]:void 0;const B=P.createProgram();if(w.program=B,!B)throw new Error("Unable to create program");return P.attachShader(B,E),P.attachShader(B,G),P.linkProgram(B),w.context=P,w.vertexShader=E,w.fragmentShader=G,w.isParallelCompiled||a(w,P,h),B}function V(w,E,G){const P=w;if(P._isDisposed)return!1;const h=x(E);return!!(h&&h.parallelShaderCompile&&h.parallelShaderCompile.COMPLETION_STATUS_KHR&&P.program&&E.getProgramParameter(P.program,h.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(a(P,E,G),!0)}function a(w,E,G){const P=w.context,h=w.vertexShader,B=w.fragmentShader,y=w.program;if(!P.getProgramParameter(y,P.LINK_STATUS)){if(!E.getShaderParameter(h,E.COMPILE_STATUS)){const G=E.getShaderInfoLog(h);if(G)throw w.vertexCompilationError=G,new Error("VERTEX SHADER "+G)}if(!E.getShaderParameter(B,E.COMPILE_STATUS)){const G=E.getShaderInfoLog(B);if(G)throw w.fragmentCompilationError=G,new Error("FRAGMENT SHADER "+G)}const G=P.getProgramInfoLog(y);if(G)throw w.programLinkError=G,new Error(G)}if(G){P.validateProgram(y);if(!P.getProgramParameter(y,P.VALIDATE_STATUS)){const E=P.getProgramInfoLog(y);if(E)throw w.programValidationError=E,new Error(E)}}P.deleteShader(h),P.deleteShader(B),w.vertexShader=void 0,w.fragmentShader=void 0,w.onCompiled&&(w.onCompiled(),w.onCompiled=void 0)}function Q(w,E,G,P,h,B,y,U,O){let u=arguments.length>10?arguments[10]:void 0,V=arguments.length>11?arguments[11]:void 0,a=arguments.length>12?arguments[12]:void 0;const Q=x(w.context);V||(V=Q.createRawShaderProgramInjection??l),a||(a=Q.createShaderProgramInjection??i);const c=w;c.program=P?V(c,E,G,c.context,O):a(c,E,G,U,c.context,O),c.program.__SPECTOR_rebuildProgram=y,u()}function c(w,E,G,P,B,y){return Z((0,h.e)(w,G,P),E,B,y)}function Z(w,E,G,P){const h=G.createShader("vertex"===E?G.VERTEX_SHADER:G.FRAGMENT_SHADER);if(!h){let w=G.NO_ERROR,h=G.NO_ERROR;for(;(h=G.getError())!==G.NO_ERROR;)w=h;throw new Error(`Something went wrong while creating a gl ${E} shader object. gl error=${w}, gl isContextLost=${G.isContextLost()}, _contextWasLost=${P}`)}return G.shaderSource(h,w),G.compileShader(h),h}function J(w,E){E.useProgram(w)}function d(w,E){const G=w;if(!G.isParallelCompiled)return void E(w);const P=G.onCompiled;G.onCompiled=()=>{null===P||void 0===P||P(),E(w)}}},11604:(w,E,G)=>{G.d(E,{c:()=>O,e:()=>V,f:()=>l,j:()=>i});var P=G(11513),h=G(11610),B=G(11595),y=G(11518),x=G(11564),U=G(11568);function l(w,E){return(0,h.w)(E).cachedPipelines[w]}function i(w){const E=w._name,G=w.context;if(E&&G){const w=(0,h.w)(G),P=w.cachedPipelines[E];null===P||void 0===P||P.dispose(),delete w.cachedPipelines[E]}}function O(w,E,G,h,B,y,U){let l,i;const O=(0,P.h)()?null===y||void 0===y?void 0:y.getHostDocument():null;l="string"===typeof E?E:E.vertexSource?"source:"+E.vertexSource:E.vertexElement?(null===O||void 0===O?void 0:O.getElementById(E.vertexElement))||E.vertexElement:E.vertex||E,i="string"===typeof E?E:E.fragmentSource?"source:"+E.fragmentSource:E.fragmentElement?(null===O||void 0===O?void 0:O.getElementById(E.fragmentElement))||E.fragmentElement:E.fragment||E;const V=[void 0,void 0],a=()=>{if(V[0]&&V[1]){w.isFragment=!0;const[P,l]=V;(0,x.g)(l,w,((y,l)=>{U&&(U._fragmentSourceCodeBeforeMigration=l),G&&(y=G("fragment",y));const i=(0,x.b)(P,y,w);w=null;const O=function(w,E,G,P){if(G){return{vertexSourceCode:(1===P?"//":"")+"#define SHADER_NAME vertex:"+(G.vertexElement||G.vertex||G.spectorName||G)+"\n"+w,fragmentSourceCode:(1===P?"//":"")+"#define SHADER_NAME fragment:"+(G.fragmentElement||G.fragment||G.spectorName||G)+"\n"+E}}return{vertexSourceCode:w,fragmentSourceCode:E}}(i.vertexCode,i.fragmentCode,E,B);null===h||void 0===h||h(O.vertexSourceCode,O.fragmentSourceCode)}),y)}};u(l,"Vertex","",(E=>{(0,x.d)(w),(0,x.g)(E,w,((w,P)=>{U&&(U._rawVertexSourceCode=E,U._vertexSourceCodeBeforeMigration=P),G&&(w=G("vertex",w)),V[0]=w,a()}),y)}),B),u(i,"Fragment","Pixel",(w=>{U&&(U._rawFragmentSourceCode=w),V[1]=w,a()}),B)}function u(w,E,G,h,y,x){if("undefined"!==typeof HTMLElement&&w instanceof HTMLElement){return void h((0,P.d)(w))}if("source:"===w.substring(0,7))return void h(w.substring(7));if("base64:"===w.substring(0,7)){return void h(window.atob(w.substring(7)))}const l=B.b.GetShadersStore(y);if(l[w+E+"Shader"])return void h(l[w+E+"Shader"]);if(G&&l[w+G+"Shader"])return void h(l[w+G+"Shader"]);let i;if(i="."===w[0]||"/"===w[0]||w.indexOf("http")>-1?w:B.b.GetShadersRepository(y)+w,!(x=x||U.i))throw new Error("loadFileInjection is not defined");x(i+"."+E.toLowerCase()+".fx",h)}const V=(w,E,G,P)=>{try{const B=w.context?(0,h.w)(w.context):null;B&&(B.disableParallelShaderCompile=w.disableParallelCompilation);const y=w.existingPipelineContext||E(w.shaderProcessingContext);return y._name=w.name,w.name&&B&&(B.cachedPipelines[w.name]=y),G(y,w.vertex,w.fragment,!!w.createAsRaw,"","",w.rebuildRebind,w.defines,w.transformFeedbackVaryings,"",(()=>{P(y,(()=>{var E;null===(E=w.onRenderingStateCompiled)||void 0===E||E.call(w,y)}))})),y}catch(B){throw y.e.Error("Error compiling effect"),B}}},11587:(w,E,G)=>{G.r(E),G.d(E,{Effect:()=>U});var P=G(11504),h=G(11518),B=G(11595),y=G(11604),x=G(11576);class U{static get ShadersRepository(){return B.b.ShadersRepository}static set ShadersRepository(w){B.b.ShadersRepository=w}get O(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new P.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(w,E,G){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,B=arguments.length>4?arguments[4]:void 0,x=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,O=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,u=arguments.length>9?arguments[9]:void 0,V=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",a=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,Q=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new P.d,this.onErrorObservable=new P.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=w,this._key=V;const c=this._key.replace(/\r/g,"").replace(/\n/g,"|");let Z;if(E.attributes){const w=E;if(this._engine=G,this._attributesNames=w.attributes,this._uniformsNames=w.uniformsNames.concat(w.samplers),this._samplerList=w.samplers.slice(),this.defines=w.defines,this.onError=w.onError,this.onCompiled=w.onCompiled,this._fallbacks=w.fallbacks,this._indexParameters=w.indexParameters,this._transformFeedbackVaryings=w.transformFeedbackVaryings||null,this._multiTarget=!!w.multiTarget,this._shaderLanguage=w.shaderLanguage??0,this._disableParallelShaderCompilation=!!w.disableParallelShaderCompilation,w.uniformBuffersNames){this._uniformBuffersNamesList=w.uniformBuffersNames.slice();for(let E=0;E<w.uniformBuffersNames.length;E++)this._uniformBuffersNames[w.uniformBuffersNames[E]]=E}this._processFinalCode=w.processFinalCode??null,this._processCodeAfterIncludes=w.processCodeAfterIncludes??void 0,Q=w.extraInitializationsAsync,Z=w.existingPipelineContext}else this._engine=B,this.defines=null==x?"":x,this._uniformsNames=G.concat(h),this._samplerList=h?h.slice():[],this._attributesNames=E,this._uniformBuffersNamesList=[],this._shaderLanguage=a,this.onError=O,this.onCompiled=i,this._indexParameters=u,this._fallbacks=l;"WEBGL2"===this._engine.shaderPlatformName&&(Z=(0,y.f)(c,this._engine._gl)??Z),this._attributeLocationByName={},this.uniqueId=U._UniqueIdSeed++,Z?(this._pipelineContext=Z,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,Q),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.O||this.dispose(!0)}))}async _processShaderCodeAsync(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],G=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,P=arguments.length>3?arguments[3]:void 0;P&&await P(),this._processingContext=G||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const h={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:w??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:B.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:B.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,y.c)(h,this.name,this._processFinalCode,((w,G)=>{this._vertexSourceCode=w,this._fragmentSourceCode=G,this._prepareEffect(E)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.O||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(w){return this._attributes[w]}getAttributeLocationByName(w){return this._attributeLocationByName[w]}getAttributesCount(){return this._attributes.length}getUniformIndex(w){return this._uniformsNames.indexOf(w)}getUniform(w){return this._uniforms[w]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((w=>{this.executeWhenCompiled(w)}))}executeWhenCompiled(w){this.isReady()?w(this):(this.onCompileObservable.add((E=>{w(E)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(w){(0,x.g)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(E=>{this._processCompilationErrors(E,w)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var w;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(w=this._pipelineContext)||void 0===w?void 0:w._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var w;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(w=this._pipelineContext)||void 0===w?void 0:w._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(w,E,G,P){this._isReady=!1,this._vertexSourceCodeOverride=w,this._fragmentSourceCodeOverride=E,this.onError=(w,E)=>{P&&P(E)},this.onCompiled=()=>{var w,E;const P=this.getEngine().scenes;if(P)for(let G=0;G<P.length;G++)P[G].markAllMaterialsAsDirty(127);null===(w=(E=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===w||w.call(E,G)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(w){if(this._pipelineContext=w,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let E=0;E<this._attributesNames.length;E++){const w=this._attributesNames[E];this._attributeLocationByName[w]=this._attributes[E]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),U.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=this._pipelineContext;this._isReady=!1;try{const G=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),P=G?null:this.defines,h=G?this._vertexSourceCodeOverride:this._vertexSourceCode,B=G?this._fragmentSourceCodeOverride:this._fragmentSourceCode,x=this._engine;this._pipelineContext=(0,y.e)({existingPipelineContext:w?E:null,vertex:h,fragment:B,context:"WEBGL2"===x.shaderPlatformName||"WEBGL1"===x.shaderPlatformName?x._gl:void 0,rebuildRebind:(w,E,G,P)=>this._rebuildProgram(w,E,G,P),defines:P,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:G,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:G=>{E&&!w&&this._engine._deletePipelineContext(E),G&&this._onRenderingStateCompiled(G)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(E)}catch(G){this._processCompilationErrors(G,E)}}_getShaderCodeAndErrorLine(w,E,G){const P=G?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let h=null;if(E&&w){const B=E.match(P);if(B&&2===B.length){const E=parseInt(B[1]),P=w.split("\n",-1);P.length>=E&&(h=`Offending line [${E}] in ${G?"fragment":"vertex"} code: ${P[E-1]}`)}}return[w,h]}_processCompilationErrors(w){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=w.message;const G=this._attributesNames,P=this._fallbacks;if(h.e.Error("Unable to compile effect:"),h.e.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),h.e.Error(`Attributes: ${G.join(" ")}`),h.e.Error("Defines:\n"+this.defines),U.LogShaderCodeOnCompilationError){var B,y;let w=null,E=null,G=null;var x;if(null!==(B=this._pipelineContext)&&void 0!==B&&B._getVertexShaderCode()&&([G,w]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),G&&(h.e.Error("Vertex code:"),h.e.Error(G))),null!==(y=this._pipelineContext)&&void 0!==y&&y._getFragmentShaderCode())[G,E]=this._getShaderCodeAndErrorLine(null===(x=this._pipelineContext)||void 0===x?void 0:x._getFragmentShaderCode(),this._compilationError,!0),G&&(h.e.Error("Fragment code:"),h.e.Error(G));w&&h.e.Error(w),E&&h.e.Error(E)}h.e.Error("Error: "+this._compilationError);const l=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};E&&(this._pipelineContext=E,this._isReady=!0,l()),P?(this._pipelineContext=null,P.hasMoreFallbacks?(this._allFallbacksProcessed=!1,h.e.Error("Trying next fallback."),this.defines=P.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,l(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,E||l())}get isSupported(){return""===this._compilationError}_bindTexture(w,E){this._engine._bindTexture(this._samplers[w],E,w)}setTexture(w,E){this._engine.setTexture(this._samplers[w],this._uniforms[w],E,w)}setTextureArray(w,E){const G=w+"Ex";if(-1===this._samplerList.indexOf(G+"0")){const P=this._samplerList.indexOf(w);for(let w=1;w<E.length;w++){const E=G+(w-1).toString();this._samplerList.splice(P+w,0,E)}let h=0;for(const w of this._samplerList)this._samplers[w]=h,h+=1}this._engine.setTextureArray(this._samplers[w],this._uniforms[w],E,w)}bindUniformBuffer(w,E){const G=this._uniformBuffersNames[E];void 0===G||U._BaseCache[G]===w&&this._engine._features.useUBOBindingCache||(U._BaseCache[G]=w,this._engine.bindUniformBufferBase(w,G,E))}bindUniformBlock(w,E){this._engine.bindUniformBlock(this._pipelineContext,w,E)}setInt(w,E){return this._pipelineContext.setInt(w,E),this}setInt2(w,E,G){return this._pipelineContext.setInt2(w,E,G),this}setInt3(w,E,G,P){return this._pipelineContext.setInt3(w,E,G,P),this}setInt4(w,E,G,P,h){return this._pipelineContext.setInt4(w,E,G,P,h),this}setIntArray(w,E){return this._pipelineContext.setIntArray(w,E),this}setIntArray2(w,E){return this._pipelineContext.setIntArray2(w,E),this}setIntArray3(w,E){return this._pipelineContext.setIntArray3(w,E),this}setIntArray4(w,E){return this._pipelineContext.setIntArray4(w,E),this}setUInt(w,E){return this._pipelineContext.setUInt(w,E),this}setUInt2(w,E,G){return this._pipelineContext.setUInt2(w,E,G),this}setUInt3(w,E,G,P){return this._pipelineContext.setUInt3(w,E,G,P),this}setUInt4(w,E,G,P,h){return this._pipelineContext.setUInt4(w,E,G,P,h),this}setUIntArray(w,E){return this._pipelineContext.setUIntArray(w,E),this}setUIntArray2(w,E){return this._pipelineContext.setUIntArray2(w,E),this}setUIntArray3(w,E){return this._pipelineContext.setUIntArray3(w,E),this}setUIntArray4(w,E){return this._pipelineContext.setUIntArray4(w,E),this}setFloatArray(w,E){return this._pipelineContext.setArray(w,E),this}setFloatArray2(w,E){return this._pipelineContext.setArray2(w,E),this}setFloatArray3(w,E){return this._pipelineContext.setArray3(w,E),this}setFloatArray4(w,E){return this._pipelineContext.setArray4(w,E),this}setArray(w,E){return this._pipelineContext.setArray(w,E),this}setArray2(w,E){return this._pipelineContext.setArray2(w,E),this}setArray3(w,E){return this._pipelineContext.setArray3(w,E),this}setArray4(w,E){return this._pipelineContext.setArray4(w,E),this}setMatrices(w,E){return this._pipelineContext.setMatrices(w,E),this}setMatrix(w,E){return this._pipelineContext.setMatrix(w,E),this}setMatrix3x3(w,E){return this._pipelineContext.setMatrix3x3(w,E),this}setMatrix2x2(w,E){return this._pipelineContext.setMatrix2x2(w,E),this}setFloat(w,E){return this._pipelineContext.setFloat(w,E),this}setBool(w,E){return this._pipelineContext.setInt(w,E?1:0),this}setVector2(w,E){return this._pipelineContext.setVector2(w,E),this}setFloat2(w,E,G){return this._pipelineContext.setFloat2(w,E,G),this}setVector3(w,E){return this._pipelineContext.setVector3(w,E),this}setFloat3(w,E,G,P){return this._pipelineContext.setFloat3(w,E,G,P),this}setVector4(w,E){return this._pipelineContext.setVector4(w,E),this}setQuaternion(w,E){return this._pipelineContext.setQuaternion(w,E),this}setFloat4(w,E,G,P,h){return this._pipelineContext.setFloat4(w,E,G,P,h),this}setColor3(w,E){return this._pipelineContext.setColor3(w,E),this}setColor4(w,E,G){return this._pipelineContext.setColor4(w,E,G),this}setDirectColor4(w,E){return this._pipelineContext.setDirectColor4(w,E),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(U.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,y.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(w,E,G){let P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;E&&(B.b.GetShadersStore(P)[`${w}PixelShader`]=E),G&&(B.b.GetShadersStore(P)[`${w}VertexShader`]=G)}static ResetCache(){U._BaseCache={}}}U.LogShaderCodeOnCompilationError=!0,U.PersistentMode=!1,U.AutomaticallyClearCodeCache=!1,U._UniqueIdSeed=0,U._BaseCache={},U.ShadersStore=B.b.ShadersStore,U.IncludesShadersStore=B.b.IncludesShadersStore},11536:(w,E,G)=>{G.d(E,{d:()=>h});const P={};function h(w){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!P[w])return P[w]=!0,`${w} needs to be imported before as it contains a side-effect required by your code.`}},11513:(w,E,G)=>{function P(){return"undefined"!==typeof window}function h(){return"undefined"!==typeof navigator}function B(){return"undefined"!==typeof document}function y(w){let E="",G=w.firstChild;for(;G;)3===G.nodeType&&(E+=G.textContent),G=G.nextSibling;return E}G.d(E,{d:()=>y,e:()=>B,g:()=>h,h:()=>P})},11518:(w,E,G)=>{G.d(E,{e:()=>P});class P{static _CheckLimit(w,E){let G=P._LogLimitOutputs[w];return G?G.current++:(G={limit:E,current:1},P._LogLimitOutputs[w]=G),G.current<=G.limit}static _GenerateLimitMessage(w){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const G=P._LogLimitOutputs[w];if(!G||!P.MessageLimitReached)return;const h=this._Levels[E];G.current===G.limit&&P[h.name](P.MessageLimitReached.replace(/%LIMIT%/g,""+G.limit).replace(/%TYPE%/g,h.name??""))}static _AddLogEntry(w){P._LogCache=w+P._LogCache,P.OnNewCacheEntry&&P.OnNewCacheEntry(w)}static _FormatMessage(w){const E=w=>w<10?"0"+w:""+w,G=new Date;return"["+E(G.getHours())+":"+E(G.getMinutes())+":"+E(G.getSeconds())+"]: "+w}static _LogDisabled(w,E){}static _LogEnabled(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,E=arguments.length>1?arguments[1]:void 0,G=arguments.length>2?arguments[2]:void 0;const h=Array.isArray(E)?E[0]:E;if(void 0!==G&&!P._CheckLimit(h,G))return;const B=P._FormatMessage(h),y=this._Levels[w],x=Array.isArray(E)?E.slice(1):[];y.logFunc&&y.logFunc("BJS - "+B,...x);const U=`<div style='color:${y.color}'>${B}</div><br>`;P._AddLogEntry(U),P._GenerateLimitMessage(h,w)}static get LogCache(){return P._LogCache}static ClearLogCache(){P._LogCache="",P._LogLimitOutputs={},P.errorsCount=0}static set LogLevels(w){P.Log=P._LogDisabled,P.Warn=P._LogDisabled,P.Error=P._LogDisabled;const E=[P.MessageLogLevel,P.WarningLogLevel,P.ErrorLogLevel];for(const G of E)if((w&G)===G){const w=this._Levels[G];P[w.name]=P._LogEnabled.bind(P,G)}}}P.NoneLogLevel=0,P.MessageLogLevel=1,P.WarningLogLevel=2,P.ErrorLogLevel=4,P.AllLogLevel=7,P.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",P._LogCache="",P._LogLimitOutputs={},P._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],P.errorsCount=0,P.Log=P._LogEnabled.bind(P,P.MessageLogLevel),P.Warn=P._LogEnabled.bind(P,P.WarningLogLevel),P.Error=P._LogEnabled.bind(P,P.ErrorLogLevel)},11504:(w,E,G)=>{G.d(E,{d:()=>y});const P="undefined"!==typeof WeakRef;class h{constructor(w){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],G=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0;this.initialize(w,E,G,P)}initialize(w){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],G=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0;return this.mask=w,this.skipNextObservers=E,this.target=G,this.currentTarget=P,this}}class B{constructor(w,E){let G=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=w,this.mask=E,this.scope=G,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(w)}}class y{static FromPromise(w,E){const G=new y;return w.then((w=>{G.notifyObservers(w)})).catch((w=>{if(!E)throw w;E.notifyObservers(w)})),G}get observers(){return this._observers}constructor(w){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=E,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new h(0),w&&(this._onObserverAdded=w)}add(w){let E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],G=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!w)return null;const h=new B(w,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);h.unregisterOnNextCall=G,E?this._observers.unshift(h):this._observers.push(h),this._onObserverAdded&&this._onObserverAdded(h),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(h,this._lastNotifiedValue);const y=P?new WeakRef(this):{deref:()=>this};return h._remove=function(){let w=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=y.deref();E&&(w?E.remove(h):E._remove(h))},h}addOnce(w){return this.add(w,void 0,void 0,void 0,!0)}remove(w){if(!w)return!1;w._remove=null;return-1!==this._observers.indexOf(w)&&(this._deferUnregister(w),!0)}removeCallback(w,E){for(let G=0;G<this._observers.length;G++){const P=this._observers[G];if(!P._willBeUnregistered&&(P.callback===w&&(!E||E===P.scope)))return this._deferUnregister(P),!0}return!1}_deferUnregister(w){w._willBeUnregistered||(this._numObserversMarkedAsDeleted++,w.unregisterOnNextCall=!1,w._willBeUnregistered=!0,setTimeout((()=>{this._remove(w)}),0))}_remove(w){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!w)return!1;const G=this._observers.indexOf(w);return-1!==G&&(E&&this._numObserversMarkedAsDeleted--,this._observers.splice(G,1),!0)}makeObserverTopPriority(w){this._remove(w,!1),this._observers.unshift(w)}makeObserverBottomPriority(w){this._remove(w,!1),this._observers.push(w)}notifyObservers(w){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,G=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=w),!this._observers.length)return!0;const B=this._eventState;B.mask=E,B.target=G,B.currentTarget=P,B.skipNextObservers=!1,B.lastReturnValue=w,B.userInfo=h;for(const y of this._observers)if(!y._willBeUnregistered&&(y.mask&E&&(y.unregisterOnNextCall&&this._deferUnregister(y),y.scope?B.lastReturnValue=y.callback.apply(y.scope,[w,B]):B.lastReturnValue=y.callback(w,B)),B.skipNextObservers))return!1;return!0}notifyObserver(w,E){let G=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=E),w._willBeUnregistered)return;const P=this._eventState;P.mask=G,P.skipNextObservers=!1,w.unregisterOnNextCall&&this._deferUnregister(w),w.callback(E,P)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const w=this._observers.pop();w&&(w._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const w=new y;return w._observers=this._observers.slice(0),w}hasSpecificMask(){let w=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const E of this._observers)if(E.mask&w||E.mask===w)return!0;return!1}}},11576:(w,E,G)=>{G.d(E,{e:()=>h,g:()=>y});let P=[];class h{static SetImmediate(w){0===P.length&&setTimeout((()=>{const w=P;P=[];for(const E of w)E()}),1),P.push(w)}}function B(w,E,G){try{if(w())return E(),!0}catch(P){return null===G||void 0===G||G(P),!0}return!1}const y=function(w,E,G){let P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,y=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&B(w,E,G))return null;const x=setInterval((()=>{B(w,E,G)?clearInterval(x):(h-=P,h<0&&(clearInterval(x),null===G||void 0===G||G(new Error("Operation timed out after maximum retries. "+(y||"")),!0)))}),P);return()=>clearInterval(x)}}}]);