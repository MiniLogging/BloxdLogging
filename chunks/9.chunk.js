"use strict";(self.irtrrknfyfo=self.irtrrknfyfo||[]).push([[9],{11266:(B,E,v)=>{v.d(E,{e:()=>i,h:()=>X,n:()=>r,l:()=>l,q:()=>d});class z{constructor(){this.children=[]}isValid(B){return!0}process(B,E,v){let z="";if(this.line){let v=this.line;const h=E.processor;if(h){var o,q,c,S,x,D;h.lineProcessor&&(v=h.lineProcessor(v,E.isFragment,E.processingContext));const z=(null===(o=E.processor)||void 0===o?void 0:o.attributeKeywordName)??"attribute",y=E.isFragment&&null!==(q=E.processor)&&void 0!==q&&q.varyingFragmentKeywordName?null===(c=E.processor)||void 0===c?void 0:c.varyingFragmentKeywordName:!E.isFragment&&null!==(S=E.processor)&&void 0!==S&&S.varyingVertexKeywordName?null===(x=E.processor)||void 0===x?void 0:x.varyingVertexKeywordName:"varying";if(!E.isFragment&&h.attributeProcessor&&this.line.startsWith(z))v=h.attributeProcessor(this.line,B,E.processingContext);else if(h.varyingProcessor&&(null!==(D=h.varyingCheck)&&void 0!==D&&D.call(h,this.line,E.isFragment)||!h.varyingCheck&&this.line.startsWith(y)))v=h.varyingProcessor(this.line,E.isFragment,B,E.processingContext);else if(h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(v=h.uniformProcessor(this.line,E.isFragment,B,E.processingContext));else if(h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(v=h.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0);else if(h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line))v=h.textureProcessor(this.line,E.isFragment,B,E.processingContext);else if((h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!E.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?h.uniformProcessor&&(v=h.uniformProcessor(this.line,E.isFragment,B,E.processingContext)):h.uniformBufferProcessor&&(v=h.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0)}E.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(E.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(v=h.endOfUniformBufferProcessor(this.line,E.isFragment,E.processingContext)))}z+=v+"\n"}for(const h of this.children)z+=h.process(B,E,v);return this.additionalDefineKey&&(B[this.additionalDefineKey]=this.additionalDefineValue||"true",v[this.additionalDefineKey]=B[this.additionalDefineKey]),z}}class o{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(B){this._lines.length=0;for(const E of B){if(!E||"\r"===E)continue;if("#"===E[0]){this._lines.push(E);continue}const B=E.trim();if(!B)continue;if(B.startsWith("//")){this._lines.push(E);continue}const v=B.indexOf(";");if(-1===v)this._lines.push(B);else if(v===B.length-1)B.length>1&&this._lines.push(B);else{const B=E.split(";");for(let E=0;E<B.length;E++){let v=B[E];v&&(v=v.trim(),v&&this._lines.push(v+(E!==B.length-1?";":"")))}}}}}class q extends z{process(B,E,v){for(let z=0;z<this.children.length;z++){const o=this.children[z];if(o.isValid(B))return o.process(B,E,v)}return""}}class c extends z{isValid(B){return this.testExpression.isTrue(B)}}class S{isTrue(B){return!0}static postfixToInfix(B){const E=[];for(const v of B)if(void 0===S._OperatorPriority[v])E.push(v);else{const B=E[E.length-1],z=E[E.length-2];E.length-=2,E.push(`(${z}${v}${B})`)}return E[E.length-1]}static infixToPostfix(B){const E=S._InfixToPostfixCache.get(B);if(E)return E.accessTime=Date.now(),E.result;if(!B.includes("&&")&&!B.includes("||")&&!B.includes(")")&&!B.includes("("))return[B];const v=[];let z=-1;const o=()=>{h=h.trim(),""!==h&&(v.push(h),h="")},q=B=>{z<S._Stack.length-1&&(S._Stack[++z]=B)},c=()=>S._Stack[z],x=()=>-1===z?"!!INVALID EXPRESSION!!":S._Stack[z--];let D=0,h="";for(;D<B.length;){const E=B.charAt(D),y=D<B.length-1?B.substring(D,2+D):"";if("("===E)h="",q(E);else if(")"===E){for(o();-1!==z&&"("!==c();)v.push(x());x()}else if(S._OperatorPriority[y]>1){for(o();-1!==z&&S._OperatorPriority[c()]>=S._OperatorPriority[y];)v.push(x());q(y),D++}else h+=E;D++}for(o();-1!==z;)"("===c()?x():v.push(x());return S._InfixToPostfixCache.size>=S.InfixToPostfixCacheLimitSize&&S.ClearCache(),S._InfixToPostfixCache.set(B,{result:v,accessTime:Date.now()}),v}static ClearCache(){const B=Array.from(S._InfixToPostfixCache.entries()).sort(((B,E)=>B[1].accessTime-E[1].accessTime));for(let E=0;E<S.InfixToPostfixCacheCleanupSize;E++)S._InfixToPostfixCache.delete(B[E][0])}}S.InfixToPostfixCacheLimitSize=5e4,S.InfixToPostfixCacheCleanupSize=25e3,S._InfixToPostfixCache=new Map,S._OperatorPriority={")":0,"(":1,"||":2,"&&":3},S._Stack=["","","","","","","","","","","","","","","","","","","",""];class x extends S{constructor(B){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=B,this.not=E}isTrue(B){let E=void 0!==B[this.define];return this.not&&(E=!E),E}}class D extends S{isTrue(B){return this.leftOperand.isTrue(B)||this.rightOperand.isTrue(B)}}class h extends S{isTrue(B){return this.leftOperand.isTrue(B)&&this.rightOperand.isTrue(B)}}class y extends S{constructor(B,E,v){super(),this.define=B,this.operand=E,this.testValue=v}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(B){let E=!1;const v=parseInt(void 0!=B[this.define]?B[this.define]:this.define),z=parseInt(void 0!=B[this.testValue]?B[this.testValue]:this.testValue);if(isNaN(v)||isNaN(z))return!1;switch(this.operand){case">":E=v>z;break;case"<":E=v<z;break;case"<=":E=v<=z;break;case">=":E=v>=z;break;case"==":E=v===z;break;case"!=":E=v!==z}return E}}var Q=v(11235),P=v(11271);const G=/defined\s*?\((.+?)\)/g,Y=/defined\s*?\[(.+?)\]/g,a=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,m=/__decl__/,g=/light\{X\}.(\w*)/g,V=/\{X\}/g,T=[],N=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function X(B){B.processor&&B.processor.initializeShaders&&B.processor.initializeShaders(B.processingContext)}function r(B,E,v,z){var o;null!==(o=E.processor)&&void 0!==o&&o.preProcessShaderCode&&(B=E.processor.preProcessShaderCode(B,E.isFragment)),l(B,E,(B=>{E.processCodeAfterIncludes&&(B=E.processCodeAfterIncludes(E.isFragment?"fragment":"vertex",B,E.defines));const o=function(B,E,v){let z=function(B,E){var v;if(null!==(v=E.processor)&&void 0!==v&&v.noPrecision)return B;const z=E.shouldUseHighPrecisionShader;-1===B.indexOf("precision highp float")?B=z?"precision highp float;\n"+B:"precision mediump float;\n"+B:z||(B=B.replace("precision highp float","precision mediump float"));return B}(B,E);if(!E.processor)return z;if(0===E.processor.shaderLanguage&&-1!==z.indexOf("#version 3")&&(z=z.replace("#version 300 es",""),!E.processor.parseGLES3))return z;const o=E.defines,q=A(E,v);E.processor.preProcessor&&(z=E.processor.preProcessor(z,o,q,E.isFragment,E.processingContext));const c={};z=f(z,q,E,c),E.processor.postProcessor&&(z=E.processor.postProcessor(z,o,E.isFragment,E.processingContext,v?{drawBuffersExtensionDisabled:!v.getCaps().drawBuffersExtension}:{},q,c));null!==v&&void 0!==v&&v._features.needShaderCodeInlining&&(z=v.inlineShaderCode(z));return z}(B,E,z);v(o,B)}))}function i(B,E,v){return v.processor&&v.processor.finalizeShaders?v.processor.finalizeShaders(B,E,v.processingContext):{vertexCode:B,fragmentCode:E}}function u(B){const E=/defined\((.+)\)/.exec(B);if(E&&E.length)return new x(E[1].trim(),"!"===B[0]);const v=["==","!=",">=","<=","<",">"];let z="",o=0;for(z of v)if(o=B.indexOf(z),o>-1)break;if(-1===o)return new x(B);const q=B.substring(0,o).trim(),c=B.substring(o+z.length).trim();return new y(q,z,c)}function I(B,E){const v=new c,z=B.substring(0,E);let o=B.substring(E);return o=o.substring(0,(o.indexOf("//")+1||o.length+1)-1).trim(),v.testExpression="#ifdef"===z?new x(o):"#ifndef"===z?new x(o,!0):function(B){B=B.replace(G,"defined[$1]");const E=S.infixToPostfix(B),v=[];for(const o of E)if("||"!==o&&"&&"!==o)v.push(o);else if(v.length>=2){let B=v[v.length-1],E=v[v.length-2];v.length-=2;const z="&&"==o?new h:new D;"string"===typeof B&&(B=B.replace(Y,"defined($1)")),"string"===typeof E&&(E=E.replace(Y,"defined($1)")),z.leftOperand="string"===typeof E?u(E):E,z.rightOperand="string"===typeof B?u(B):B,v.push(z)}let z=v[v.length-1];return"string"===typeof z&&(z=z.replace(Y,"defined($1)")),"string"===typeof z?u(z):z}(o),v}function K(B,E,v,o){let q=B.currentLine;for(;C(B,v,o);){q=B.currentLine;const c=q.substring(0,5).toLowerCase();if("#else"===c){const v=new z;return E.children.push(v),void C(B,v,o)}if("#elif"===c){const B=I(q,5);E.children.push(B),v=B}}}function C(B,E,v){for(;B.canRead;){B.lineIndex++;const o=B.currentLine;if(o.indexOf("#")>=0){const z=N.exec(o);if(z&&z.length){switch(z[0]){case"#ifdef":{const z=new q;E.children.push(z);const c=I(o,6);z.children.push(c),K(B,z,c,v);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const z=new q;E.children.push(z);const c=I(o,7);z.children.push(c),K(B,z,c,v);break}case"#if":{const z=new q,c=I(o,3);E.children.push(z),z.children.push(c),K(B,z,c,v);break}}continue}}const c=new z;if(c.line=o,E.children.push(c),"#"===o[0]&&"d"===o[1]){const B=o.replace(";","").split(" ");c.additionalDefineKey=B[1],3===B.length&&(c.additionalDefineValue=B[2])}}return!1}function f(B,E,v,q){const c=new z,S=new o;return S.lineIndex=-1,S.lines=B.split("\n"),C(S,c,q),c.process(E,v,q)}function A(B,E){var v;const z=B.defines,o={};for(const q of z){const B=q.replace("#define","").replace(";","").trim().split(" ");o[B[0]]=B.length>1?B[1]:""}return 0===(null===(v=B.processor)||void 0===v?void 0:v.shaderLanguage)&&(o.GL_ES="true"),o.__VERSION__=B.version,o[B.platformName]="true",(0,P.h)(o,null===E||void 0===E?void 0:E.isNDCHalfZRange,null===E||void 0===E?void 0:E.useReverseDepthBuffer,null===E||void 0===E?void 0:E.useExactSrgbConversions),o}function l(B,E,v){let z;for(T.length=0;null!==(z=a.exec(B));)T.push(z);let o=String(B),q=[B],c=!1;for(const S of T){let B=S[1];if(-1!==B.indexOf("__decl__")&&(B=B.replace(m,""),E.supportsUniformBuffers&&(B=B.replace("Vertex","Ubo").replace("Fragment","Ubo")),B+="Declaration"),!E.includesShadersStore[B]){const z=E.shadersRepository+"ShadersInclude/"+B+".fx";return void d.loadFile(z,(z=>{E.includesShadersStore[B]=z,l(q.join(""),E,v)}))}{let v=E.includesShadersStore[B];if(S[2]){const B=S[3].split(",");for(let E=0;E<B.length;E+=2){const z=new RegExp(B[E],"g"),o=B[E+1];v=v.replace(z,o)}}if(S[4]){const B=S[5];if(-1!==B.indexOf("..")){const z=B.split(".."),o=parseInt(z[0]);let q=parseInt(z[1]),c=v.slice(0);v="",isNaN(q)&&(q=E.indexParameters[z[1]]);for(let B=o;B<q;B++)E.supportsUniformBuffers||(c=c.replace(g,((B,E)=>E+"{X}"))),v+=c.replace(V,B.toString())+"\n"}else E.supportsUniformBuffers||(v=v.replace(g,((B,E)=>E+"{X}"))),v=v.replace(V,B)}const z=[];for(const B of q){const E=B.split(S[0]);for(let B=0;B<E.length-1;B++)z.push(E[B]),z.push(v);z.push(E[E.length-1])}q=z,c=c||v.indexOf("#include<")>=0||v.indexOf("#include <")>=0}}T.length=0,o=q.join(""),c?l(o.toString(),E,v):v(o)}const d={loadFile:(B,E,v,z,o,q)=>{throw(0,Q.e)("FileTools")}}},11271:(B,E,v)=>{v.d(E,{c:()=>o,g:()=>q,h:()=>S,l:()=>c,m:()=>x});var z=v(11235);v(11211);const o={};function q(B,E){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(E?E+"\n":"")+B}function c(B,E,v,q,c,S,x){const D=x||o.loadFile;if(D){return D(B,E,v,q,c,S)}throw(0,z.e)("FileTools")}function S(B,E,v,z){if(B)return E?B.IS_NDC_HALF_ZRANGE="":delete B.IS_NDC_HALF_ZRANGE,v?B.USE_REVERSE_DEPTHBUFFER="":delete B.USE_REVERSE_DEPTHBUFFER,void(z?B.USE_EXACT_SRGB_CONVERSIONS="":delete B.USE_EXACT_SRGB_CONVERSIONS);{let B="";return E&&(B+="#define IS_NDC_HALF_ZRANGE"),v&&(B&&(B+="\n"),B+="#define USE_REVERSE_DEPTHBUFFER"),z&&(B&&(B+="\n"),B+="#define USE_EXACT_SRGB_CONVERSIONS"),B}}function x(B,E){let v=arguments.length>2&&void 0!==arguments[2]&&arguments[2],z=arguments.length>3?arguments[3]:void 0;switch(B){case 3:{const B=(ArrayBuffer,new Int8Array(E));return z&&B.set(new Int8Array(z)),B}case 0:{const B=(ArrayBuffer,new Uint8Array(E));return z&&B.set(new Uint8Array(z)),B}case 4:{const B=E instanceof ArrayBuffer?new Int16Array(E):new Int16Array(v?E/2:E);return z&&B.set(new Int16Array(z)),B}case 5:case 8:case 9:case 10:case 2:{const B=E instanceof ArrayBuffer?new Uint16Array(E):new Uint16Array(v?E/2:E);return z&&B.set(new Uint16Array(z)),B}case 6:{const B=E instanceof ArrayBuffer?new Int32Array(E):new Int32Array(v?E/4:E);return z&&B.set(new Int32Array(z)),B}case 7:case 11:case 12:case 13:case 14:case 15:{const B=E instanceof ArrayBuffer?new Uint32Array(E):new Uint32Array(v?E/4:E);return z&&B.set(new Uint32Array(z)),B}case 1:{const B=E instanceof ArrayBuffer?new Float32Array(E):new Float32Array(v?E/4:E);return z&&B.set(new Float32Array(z)),B}}const o=(ArrayBuffer,new Uint8Array(E));return z&&o.set(new Uint8Array(z)),o}},11291:(B,E,v)=>{v.d(E,{c:()=>z});class z{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.ShadersRepository:z.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.ShadersStore:z.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.IncludesShadersStore:z.IncludesShadersStoreWGSL}}z.ShadersRepository="src/Shaders/",z.ShadersStore={},z.IncludesShadersStore={},z.ShadersRepositoryWGSL="src/ShadersWGSL/",z.ShadersStoreWGSL={},z.IncludesShadersStoreWGSL={}},11309:(B,E,v)=>{v.d(E,{c:()=>Q,g:()=>V,j:()=>G,k:()=>P,o:()=>Y,r:()=>g,u:()=>y,x:()=>D,z:()=>h,B:()=>x,E:()=>S});class z{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.PE._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(B){B&&this.program&&B(this.program)}setEngine(B){this.PE=B}_fillEffectInformation(B,E,v,z,o,q,c,S){const x=this.PE;if(x.supportsUniformBuffers)for(const h in E)B.bindUniformBlock(h,E[h]);let D;for(this.PE.getUniforms(this,v).forEach(((B,E)=>{z[v[E]]=B})),this._uniforms=z,D=0;D<o.length;D++){null==B.getUniform(o[D])&&(o.splice(D,1),D--)}o.forEach(((B,E)=>{q[B]=E}));for(const h of x.getAttributes(this,c))S.push(h)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(B,E){const v=this._valueCache[B],z=E.updateFlag;return(void 0===v||v!==z)&&(this._valueCache[B]=z,!0)}_cacheFloat2(B,E,v){let z=this._valueCache[B];if(!z||2!==z.length)return z=[E,v],this._valueCache[B]=z,!0;let o=!1;return z[0]!==E&&(z[0]=E,o=!0),z[1]!==v&&(z[1]=v,o=!0),o}_cacheFloat3(B,E,v,z){let o=this._valueCache[B];if(!o||3!==o.length)return o=[E,v,z],this._valueCache[B]=o,!0;let q=!1;return o[0]!==E&&(o[0]=E,q=!0),o[1]!==v&&(o[1]=v,q=!0),o[2]!==z&&(o[2]=z,q=!0),q}_cacheFloat4(B,E,v,z,o){let q=this._valueCache[B];if(!q||4!==q.length)return q=[E,v,z,o],this._valueCache[B]=q,!0;let c=!1;return q[0]!==E&&(q[0]=E,c=!0),q[1]!==v&&(q[1]=v,c=!0),q[2]!==z&&(q[2]=z,c=!0),q[3]!==o&&(q[3]=o,c=!0),c}setInt(B,E){const v=this._valueCache[B];void 0!==v&&v===E||this.PE.setInt(this._uniforms[B],E)&&(this._valueCache[B]=E)}setInt2(B,E,v){this._cacheFloat2(B,E,v)&&(this.PE.setInt2(this._uniforms[B],E,v)||(this._valueCache[B]=null))}setInt3(B,E,v,z){this._cacheFloat3(B,E,v,z)&&(this.PE.setInt3(this._uniforms[B],E,v,z)||(this._valueCache[B]=null))}setInt4(B,E,v,z,o){this._cacheFloat4(B,E,v,z,o)&&(this.PE.setInt4(this._uniforms[B],E,v,z,o)||(this._valueCache[B]=null))}setIntArray(B,E){this._valueCache[B]=null,this.PE.setIntArray(this._uniforms[B],E)}setIntArray2(B,E){this._valueCache[B]=null,this.PE.setIntArray2(this._uniforms[B],E)}setIntArray3(B,E){this._valueCache[B]=null,this.PE.setIntArray3(this._uniforms[B],E)}setIntArray4(B,E){this._valueCache[B]=null,this.PE.setIntArray4(this._uniforms[B],E)}setUInt(B,E){const v=this._valueCache[B];void 0!==v&&v===E||this.PE.setUInt(this._uniforms[B],E)&&(this._valueCache[B]=E)}setUInt2(B,E,v){this._cacheFloat2(B,E,v)&&(this.PE.setUInt2(this._uniforms[B],E,v)||(this._valueCache[B]=null))}setUInt3(B,E,v,z){this._cacheFloat3(B,E,v,z)&&(this.PE.setUInt3(this._uniforms[B],E,v,z)||(this._valueCache[B]=null))}setUInt4(B,E,v,z,o){this._cacheFloat4(B,E,v,z,o)&&(this.PE.setUInt4(this._uniforms[B],E,v,z,o)||(this._valueCache[B]=null))}setUIntArray(B,E){this._valueCache[B]=null,this.PE.setUIntArray(this._uniforms[B],E)}setUIntArray2(B,E){this._valueCache[B]=null,this.PE.setUIntArray2(this._uniforms[B],E)}setUIntArray3(B,E){this._valueCache[B]=null,this.PE.setUIntArray3(this._uniforms[B],E)}setUIntArray4(B,E){this._valueCache[B]=null,this.PE.setUIntArray4(this._uniforms[B],E)}setArray(B,E){this._valueCache[B]=null,this.PE.setArray(this._uniforms[B],E)}setArray2(B,E){this._valueCache[B]=null,this.PE.setArray2(this._uniforms[B],E)}setArray3(B,E){this._valueCache[B]=null,this.PE.setArray3(this._uniforms[B],E)}setArray4(B,E){this._valueCache[B]=null,this.PE.setArray4(this._uniforms[B],E)}setMatrices(B,E){E&&(this._valueCache[B]=null,this.PE.setMatrices(this._uniforms[B],E))}setMatrix(B,E){this._cacheMatrix(B,E)&&(this.PE.setMatrices(this._uniforms[B],E.cc())||(this._valueCache[B]=null))}setMatrix3x3(B,E){this._valueCache[B]=null,this.PE.setMatrix3x3(this._uniforms[B],E)}setMatrix2x2(B,E){this._valueCache[B]=null,this.PE.setMatrix2x2(this._uniforms[B],E)}setFloat(B,E){const v=this._valueCache[B];void 0!==v&&v===E||this.PE.setFloat(this._uniforms[B],E)&&(this._valueCache[B]=E)}setVector2(B,E){this._cacheFloat2(B,E.x,E.y)&&(this.PE.setFloat2(this._uniforms[B],E.x,E.y)||(this._valueCache[B]=null))}setFloat2(B,E,v){this._cacheFloat2(B,E,v)&&(this.PE.setFloat2(this._uniforms[B],E,v)||(this._valueCache[B]=null))}setVector3(B,E){this._cacheFloat3(B,E.x,E.y,E.z)&&(this.PE.setFloat3(this._uniforms[B],E.x,E.y,E.z)||(this._valueCache[B]=null))}setFloat3(B,E,v,z){this._cacheFloat3(B,E,v,z)&&(this.PE.setFloat3(this._uniforms[B],E,v,z)||(this._valueCache[B]=null))}setVector4(B,E){this._cacheFloat4(B,E.x,E.y,E.z,E.w)&&(this.PE.setFloat4(this._uniforms[B],E.x,E.y,E.z,E.w)||(this._valueCache[B]=null))}setQuaternion(B,E){this._cacheFloat4(B,E.x,E.y,E.z,E.w)&&(this.PE.setFloat4(this._uniforms[B],E.x,E.y,E.z,E.w)||(this._valueCache[B]=null))}setFloat4(B,E,v,z,o){this._cacheFloat4(B,E,v,z,o)&&(this.PE.setFloat4(this._uniforms[B],E,v,z,o)||(this._valueCache[B]=null))}setColor3(B,E){this._cacheFloat3(B,E.r,E.g,E.b)&&(this.PE.setFloat3(this._uniforms[B],E.r,E.g,E.b)||(this._valueCache[B]=null))}setColor4(B,E,v){this._cacheFloat4(B,E.r,E.g,E.b,v)&&(this.PE.setFloat4(this._uniforms[B],E.r,E.g,E.b,v)||(this._valueCache[B]=null))}setDirectColor4(B,E){this._cacheFloat4(B,E.r,E.g,E.b,E.a)&&(this.PE.setFloat4(this._uniforms[B],E.r,E.g,E.b,E.a)||(this._valueCache[B]=null))}_getVertexShaderCode(){return this.vertexShader?this.PE._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.PE._getShaderSource(this.fragmentShader):null}}var o=v(11271);const q=new WeakMap,c={_webGLVersion:2,cachedPipelines:{}};function S(B){let E=q.get(B);if(!E){if(!B)return c;E={_webGLVersion:B.TEXTURE_BINDING_3D?2:1,_context:B,parallelShaderCompile:B.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},q.set(B,E)}return E}function x(B){q.delete(B)}function D(B,E,v,z,o,q){const c=S(z);q||(q=c._createShaderProgramInjection??Q);return q(B,m(E,"vertex",z,c._contextWasLost),m(v,"fragment",z,c._contextWasLost),z,o,c.validateShaderPrograms)}function h(B,E,v,z,o){let q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6?arguments[6]:void 0;const x=S(o);c||(c=x._createShaderProgramInjection??Q);const D=x._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return c(B,a(E,"vertex",z,D,o,x._contextWasLost),a(v,"fragment",z,D,o,x._contextWasLost),o,q,x.validateShaderPrograms)}function y(B,E){const v=new z,o=S(B);return o.parallelShaderCompile&&!o.disableParallelShaderCompile&&(v.isParallelCompiled=!0),v.context=o._context,v}function Q(B,E,v,z){let o=arguments.length>5?arguments[5]:void 0;const q=z.createProgram();if(B.program=q,!q)throw new Error("Unable to create program");return z.attachShader(q,E),z.attachShader(q,v),z.linkProgram(q),B.context=z,B.vertexShader=E,B.fragmentShader=v,B.isParallelCompiled||G(B,z,o),q}function P(B,E,v){const z=B;if(z._isDisposed)return!1;const o=S(E);return!!(o&&o.parallelShaderCompile&&o.parallelShaderCompile.COMPLETION_STATUS_KHR&&z.program&&E.getProgramParameter(z.program,o.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(G(z,E,v),!0)}function G(B,E,v){const z=B.context,o=B.vertexShader,q=B.fragmentShader,c=B.program;if(!z.getProgramParameter(c,z.LINK_STATUS)){if(!E.getShaderParameter(o,E.COMPILE_STATUS)){const v=E.getShaderInfoLog(o);if(v)throw B.vertexCompilationError=v,new Error("VERTEX SHADER "+v)}if(!E.getShaderParameter(q,E.COMPILE_STATUS)){const v=E.getShaderInfoLog(q);if(v)throw B.fragmentCompilationError=v,new Error("FRAGMENT SHADER "+v)}const v=z.getProgramInfoLog(c);if(v)throw B.programLinkError=v,new Error(v)}if(v){z.validateProgram(c);if(!z.getProgramParameter(c,z.VALIDATE_STATUS)){const E=z.getProgramInfoLog(c);if(E)throw B.programValidationError=E,new Error(E)}}z.deleteShader(o),z.deleteShader(q),B.vertexShader=void 0,B.fragmentShader=void 0,B.onCompiled&&(B.onCompiled(),B.onCompiled=void 0)}function Y(B,E,v,z,o,q,c,x,y){let Q=arguments.length>10?arguments[10]:void 0,P=arguments.length>11?arguments[11]:void 0,G=arguments.length>12?arguments[12]:void 0;const Y=S(B.context);P||(P=Y.createRawShaderProgramInjection??D),G||(G=Y.createShaderProgramInjection??h);const a=B;a.program=z?P(a,E,v,a.context,y):G(a,E,v,x,a.context,y),a.program.__SPECTOR_rebuildProgram=c,Q()}function a(B,E,v,z,q,c){return m((0,o.g)(B,v,z),E,q,c)}function m(B,E,v,z){const o=v.createShader("vertex"===E?v.VERTEX_SHADER:v.FRAGMENT_SHADER);if(!o){let B=v.NO_ERROR,o=v.NO_ERROR;for(;(o=v.getError())!==v.NO_ERROR;)B=o;throw new Error(`Something went wrong while creating a gl ${E} shader object. gl error=${B}, gl isContextLost=${v.isContextLost()}, _contextWasLost=${z}`)}return v.shaderSource(o,B),v.compileShader(o),o}function g(B,E){E.useProgram(B)}function V(B,E){const v=B;if(!v.isParallelCompiled)return void E(B);const z=v.onCompiled;v.onCompiled=()=>{null===z||void 0===z||z(),E(B)}}},11300:(B,E,v)=>{v.d(E,{b:()=>y,e:()=>P,f:()=>D,j:()=>h});var z=v(11211),o=v(11309),q=v(11291),c=v(11213),S=v(11266),x=v(11271);function D(B,E){return(0,o.E)(E).cachedPipelines[B]}function h(B){const E=B._name,v=B.context;if(E&&v){const B=(0,o.E)(v),z=B.cachedPipelines[E];null===z||void 0===z||z.dispose(),delete B.cachedPipelines[E]}}function y(B,E,v,o,q,c,x){let D,h;const y=(0,z.f)()?null===c||void 0===c?void 0:c.getHostDocument():null;D="string"===typeof E?E:E.vertexSource?"source:"+E.vertexSource:E.vertexElement?(null===y||void 0===y?void 0:y.getElementById(E.vertexElement))||E.vertexElement:E.vertex||E,h="string"===typeof E?E:E.fragmentSource?"source:"+E.fragmentSource:E.fragmentElement?(null===y||void 0===y?void 0:y.getElementById(E.fragmentElement))||E.fragmentElement:E.fragment||E;const P=[void 0,void 0],G=()=>{if(P[0]&&P[1]){B.isFragment=!0;const[z,D]=P;(0,S.n)(D,B,((c,D)=>{x&&(x._fragmentSourceCodeBeforeMigration=D),v&&(c=v("fragment",c));const h=(0,S.e)(z,c,B);B=null;const y=function(B,E,v,z){if(v){return{vertexSourceCode:(1===z?"//":"")+"#define SHADER_NAME vertex:"+(v.vertexElement||v.vertex||v.spectorName||v)+"\n"+B,fragmentSourceCode:(1===z?"//":"")+"#define SHADER_NAME fragment:"+(v.fragmentElement||v.fragment||v.spectorName||v)+"\n"+E}}return{vertexSourceCode:B,fragmentSourceCode:E}}(h.vertexCode,h.fragmentCode,E,q);null===o||void 0===o||o(y.vertexSourceCode,y.fragmentSourceCode)}),c)}};Q(D,"Vertex","",(E=>{(0,S.h)(B),(0,S.n)(E,B,((B,z)=>{x&&(x._rawVertexSourceCode=E,x._vertexSourceCodeBeforeMigration=z),v&&(B=v("vertex",B)),P[0]=B,G()}),c)}),q),Q(h,"Fragment","Pixel",(B=>{x&&(x._rawFragmentSourceCode=B),P[1]=B,G()}),q)}function Q(B,E,v,o,c,S){if("undefined"!==typeof HTMLElement&&B instanceof HTMLElement){return void o((0,z.b)(B))}if("source:"===B.substring(0,7))return void o(B.substring(7));if("base64:"===B.substring(0,7)){return void o(window.atob(B.substring(7)))}const D=q.c.GetShadersStore(c);if(D[B+E+"Shader"])return void o(D[B+E+"Shader"]);if(v&&D[B+v+"Shader"])return void o(D[B+v+"Shader"]);let h;if(h="."===B[0]||"/"===B[0]||B.indexOf("http")>-1?B:q.c.GetShadersRepository(c)+B,!(S=S||x.l))throw new Error("loadFileInjection is not defined");S(h+"."+E.toLowerCase()+".fx",o)}const P=(B,E,v,z)=>{try{const q=B.context?(0,o.E)(B.context):null;q&&(q.disableParallelShaderCompile=B.disableParallelCompilation);const c=B.existingPipelineContext||E(B.shaderProcessingContext);return c._name=B.name,B.name&&q&&(q.cachedPipelines[B.name]=c),v(c,B.vertex,B.fragment,!!B.createAsRaw,"","",B.rebuildRebind,B.defines,B.transformFeedbackVaryings,"",(()=>{z(c,(()=>{var E;null===(E=B.onRenderingStateCompiled)||void 0===E||E.call(B,c)}))})),c}catch(q){throw c.c.Error("Error compiling effect"),q}}},11286:(B,E,v)=>{v.r(E),v.d(E,{Effect:()=>x});var z=v(11202),o=v(11213),q=v(11291),c=v(11300),S=v(11278);class x{static get ShadersRepository(){return q.c.ShadersRepository}static set ShadersRepository(B){q.c.ShadersRepository=B}get P(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new z.e),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(B,E,v){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,q=arguments.length>4?arguments[4]:void 0,S=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,D=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,y=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,Q=arguments.length>9?arguments[9]:void 0,P=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",G=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,Y=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new z.e,this.onErrorObservable=new z.e,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=B,this._key=P;const a=this._key.replace(/\r/g,"").replace(/\n/g,"|");let m;if(E.attributes){const B=E;if(this._engine=v,this._attributesNames=B.attributes,this._uniformsNames=B.uniformsNames.concat(B.samplers),this._samplerList=B.samplers.slice(),this.defines=B.defines,this.onError=B.onError,this.onCompiled=B.onCompiled,this._fallbacks=B.fallbacks,this._indexParameters=B.indexParameters,this._transformFeedbackVaryings=B.transformFeedbackVaryings||null,this._multiTarget=!!B.multiTarget,this._shaderLanguage=B.shaderLanguage??0,this._disableParallelShaderCompilation=!!B.disableParallelShaderCompilation,B.uniformBuffersNames){this._uniformBuffersNamesList=B.uniformBuffersNames.slice();for(let E=0;E<B.uniformBuffersNames.length;E++)this._uniformBuffersNames[B.uniformBuffersNames[E]]=E}this._processFinalCode=B.processFinalCode??null,this._processCodeAfterIncludes=B.processCodeAfterIncludes??void 0,Y=B.extraInitializationsAsync,m=B.existingPipelineContext}else this._engine=q,this.defines=null==S?"":S,this._uniformsNames=v.concat(o),this._samplerList=o?o.slice():[],this._attributesNames=E,this._uniformBuffersNamesList=[],this._shaderLanguage=G,this.onError=y,this.onCompiled=h,this._indexParameters=Q,this._fallbacks=D;"WEBGL2"===this._engine.shaderPlatformName&&(m=(0,c.f)(a,this._engine._gl)??m),this._attributeLocationByName={},this.uniqueId=x._UniqueIdSeed++,m?(this._pipelineContext=m,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,Y),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.P||this.dispose(!0)}))}async _processShaderCodeAsync(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,z=arguments.length>3?arguments[3]:void 0;z&&await z(),this._processingContext=v||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const o={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:B??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:q.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:q.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,c.b)(o,this.name,this._processFinalCode,((B,v)=>{this._vertexSourceCode=B,this._fragmentSourceCode=v,this._prepareEffect(E)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.P||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(B){return this._attributes[B]}getAttributeLocationByName(B){return this._attributeLocationByName[B]}getAttributesCount(){return this._attributes.length}getUniformIndex(B){return this._uniformsNames.indexOf(B)}getUniform(B){return this._uniforms[B]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((B=>{this.executeWhenCompiled(B)}))}executeWhenCompiled(B){this.isReady()?B(this):(this.onCompileObservable.add((E=>{B(E)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(B){(0,S.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(E=>{this._processCompilationErrors(E,B)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var B;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(B=this._pipelineContext)||void 0===B?void 0:B._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var B;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(B=this._pipelineContext)||void 0===B?void 0:B._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(B,E,v,z){this._isReady=!1,this._vertexSourceCodeOverride=B,this._fragmentSourceCodeOverride=E,this.onError=(B,E)=>{z&&z(E)},this.onCompiled=()=>{var B,E;const z=this.getEngine().scenes;if(z)for(let v=0;v<z.length;v++)z[v].markAllMaterialsAsDirty(127);null===(B=(E=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===B||B.call(E,v)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(B){if(this._pipelineContext=B,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let E=0;E<this._attributesNames.length;E++){const B=this._attributesNames[E];this._attributeLocationByName[B]=this._attributes[E]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),x.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let B=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=this._pipelineContext;this._isReady=!1;try{const v=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),z=v?null:this.defines,o=v?this._vertexSourceCodeOverride:this._vertexSourceCode,q=v?this._fragmentSourceCodeOverride:this._fragmentSourceCode,S=this._engine;this._pipelineContext=(0,c.e)({existingPipelineContext:B?E:null,vertex:o,fragment:q,context:"WEBGL2"===S.shaderPlatformName||"WEBGL1"===S.shaderPlatformName?S._gl:void 0,rebuildRebind:(B,E,v,z)=>this._rebuildProgram(B,E,v,z),defines:z,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:v,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:v=>{E&&!B&&this._engine._deletePipelineContext(E),v&&this._onRenderingStateCompiled(v)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(E)}catch(v){this._processCompilationErrors(v,E)}}_getShaderCodeAndErrorLine(B,E,v){const z=v?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let o=null;if(E&&B){const q=E.match(z);if(q&&2===q.length){const E=parseInt(q[1]),z=B.split("\n",-1);z.length>=E&&(o=`Offending line [${E}] in ${v?"fragment":"vertex"} code: ${z[E-1]}`)}}return[B,o]}_processCompilationErrors(B){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=B.message;const v=this._attributesNames,z=this._fallbacks;if(o.c.Error("Unable to compile effect:"),o.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),o.c.Error(`Attributes: ${v.join(" ")}`),o.c.Error("Defines:\n"+this.defines),x.LogShaderCodeOnCompilationError){var q,c;let B=null,E=null,v=null;var S;if(null!==(q=this._pipelineContext)&&void 0!==q&&q._getVertexShaderCode()&&([v,B]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),v&&(o.c.Error("Vertex code:"),o.c.Error(v))),null!==(c=this._pipelineContext)&&void 0!==c&&c._getFragmentShaderCode())[v,E]=this._getShaderCodeAndErrorLine(null===(S=this._pipelineContext)||void 0===S?void 0:S._getFragmentShaderCode(),this._compilationError,!0),v&&(o.c.Error("Fragment code:"),o.c.Error(v));B&&o.c.Error(B),E&&o.c.Error(E)}o.c.Error("Error: "+this._compilationError);const D=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};E&&(this._pipelineContext=E,this._isReady=!0,D()),z?(this._pipelineContext=null,z.hasMoreFallbacks?(this._allFallbacksProcessed=!1,o.c.Error("Trying next fallback."),this.defines=z.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,D(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,E||D())}get isSupported(){return""===this._compilationError}_bindTexture(B,E){this._engine._bindTexture(this._samplers[B],E,B)}setTexture(B,E){this._engine.setTexture(this._samplers[B],this._uniforms[B],E,B)}setTextureArray(B,E){const v=B+"Ex";if(-1===this._samplerList.indexOf(v+"0")){const z=this._samplerList.indexOf(B);for(let B=1;B<E.length;B++){const E=v+(B-1).toString();this._samplerList.splice(z+B,0,E)}let o=0;for(const B of this._samplerList)this._samplers[B]=o,o+=1}this._engine.setTextureArray(this._samplers[B],this._uniforms[B],E,B)}bindUniformBuffer(B,E){const v=this._uniformBuffersNames[E];void 0===v||x._BaseCache[v]===B&&this._engine._features.useUBOBindingCache||(x._BaseCache[v]=B,this._engine.bindUniformBufferBase(B,v,E))}bindUniformBlock(B,E){this._engine.bindUniformBlock(this._pipelineContext,B,E)}setInt(B,E){return this._pipelineContext.setInt(B,E),this}setInt2(B,E,v){return this._pipelineContext.setInt2(B,E,v),this}setInt3(B,E,v,z){return this._pipelineContext.setInt3(B,E,v,z),this}setInt4(B,E,v,z,o){return this._pipelineContext.setInt4(B,E,v,z,o),this}setIntArray(B,E){return this._pipelineContext.setIntArray(B,E),this}setIntArray2(B,E){return this._pipelineContext.setIntArray2(B,E),this}setIntArray3(B,E){return this._pipelineContext.setIntArray3(B,E),this}setIntArray4(B,E){return this._pipelineContext.setIntArray4(B,E),this}setUInt(B,E){return this._pipelineContext.setUInt(B,E),this}setUInt2(B,E,v){return this._pipelineContext.setUInt2(B,E,v),this}setUInt3(B,E,v,z){return this._pipelineContext.setUInt3(B,E,v,z),this}setUInt4(B,E,v,z,o){return this._pipelineContext.setUInt4(B,E,v,z,o),this}setUIntArray(B,E){return this._pipelineContext.setUIntArray(B,E),this}setUIntArray2(B,E){return this._pipelineContext.setUIntArray2(B,E),this}setUIntArray3(B,E){return this._pipelineContext.setUIntArray3(B,E),this}setUIntArray4(B,E){return this._pipelineContext.setUIntArray4(B,E),this}setFloatArray(B,E){return this._pipelineContext.setArray(B,E),this}setFloatArray2(B,E){return this._pipelineContext.setArray2(B,E),this}setFloatArray3(B,E){return this._pipelineContext.setArray3(B,E),this}setFloatArray4(B,E){return this._pipelineContext.setArray4(B,E),this}setArray(B,E){return this._pipelineContext.setArray(B,E),this}setArray2(B,E){return this._pipelineContext.setArray2(B,E),this}setArray3(B,E){return this._pipelineContext.setArray3(B,E),this}setArray4(B,E){return this._pipelineContext.setArray4(B,E),this}setMatrices(B,E){return this._pipelineContext.setMatrices(B,E),this}setMatrix(B,E){return this._pipelineContext.setMatrix(B,E),this}setMatrix3x3(B,E){return this._pipelineContext.setMatrix3x3(B,E),this}setMatrix2x2(B,E){return this._pipelineContext.setMatrix2x2(B,E),this}setFloat(B,E){return this._pipelineContext.setFloat(B,E),this}setBool(B,E){return this._pipelineContext.setInt(B,E?1:0),this}setVector2(B,E){return this._pipelineContext.setVector2(B,E),this}setFloat2(B,E,v){return this._pipelineContext.setFloat2(B,E,v),this}setVector3(B,E){return this._pipelineContext.setVector3(B,E),this}setFloat3(B,E,v,z){return this._pipelineContext.setFloat3(B,E,v,z),this}setVector4(B,E){return this._pipelineContext.setVector4(B,E),this}setQuaternion(B,E){return this._pipelineContext.setQuaternion(B,E),this}setFloat4(B,E,v,z,o){return this._pipelineContext.setFloat4(B,E,v,z,o),this}setColor3(B,E){return this._pipelineContext.setColor3(B,E),this}setColor4(B,E,v){return this._pipelineContext.setColor4(B,E,v),this}setDirectColor4(B,E){return this._pipelineContext.setDirectColor4(B,E),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(x.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,c.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(B,E,v){let z=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;E&&(q.c.GetShadersStore(z)[`${B}PixelShader`]=E),v&&(q.c.GetShadersStore(z)[`${B}VertexShader`]=v)}static ResetCache(){x._BaseCache={}}}x.LogShaderCodeOnCompilationError=!0,x.PersistentMode=!1,x.AutomaticallyClearCodeCache=!1,x._UniqueIdSeed=0,x._BaseCache={},x.ShadersStore=q.c.ShadersStore,x.IncludesShadersStore=q.c.IncludesShadersStore},11235:(B,E,v)=>{v.d(E,{e:()=>o});const z={};function o(B){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!z[B])return z[B]=!0,`${B} needs to be imported before as it contains a side-effect required by your code.`}},11211:(B,E,v)=>{function z(){return"undefined"!==typeof window}function o(){return"undefined"!==typeof navigator}function q(){return"undefined"!==typeof document}function c(B){let E="",v=B.firstChild;for(;v;)3===v.nodeType&&(E+=v.textContent),v=v.nextSibling;return E}v.d(E,{b:()=>c,c:()=>q,d:()=>o,f:()=>z})},11213:(B,E,v)=>{v.d(E,{c:()=>z});class z{static _CheckLimit(B,E){let v=z._LogLimitOutputs[B];return v?v.current++:(v={limit:E,current:1},z._LogLimitOutputs[B]=v),v.current<=v.limit}static _GenerateLimitMessage(B){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const v=z._LogLimitOutputs[B];if(!v||!z.MessageLimitReached)return;const o=this._Levels[E];v.current===v.limit&&z[o.name](z.MessageLimitReached.replace(/%LIMIT%/g,""+v.limit).replace(/%TYPE%/g,o.name??""))}static _AddLogEntry(B){z._LogCache=B+z._LogCache,z.OnNewCacheEntry&&z.OnNewCacheEntry(B)}static _FormatMessage(B){const E=B=>B<10?"0"+B:""+B,v=new Date;return"["+E(v.getHours())+":"+E(v.getMinutes())+":"+E(v.getSeconds())+"]: "+B}static _LogDisabled(B,E){}static _LogEnabled(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,E=arguments.length>1?arguments[1]:void 0,v=arguments.length>2?arguments[2]:void 0;const o=Array.isArray(E)?E[0]:E;if(void 0!==v&&!z._CheckLimit(o,v))return;const q=z._FormatMessage(o),c=this._Levels[B],S=Array.isArray(E)?E.slice(1):[];c.logFunc&&c.logFunc("BJS - "+q,...S);const x=`<div style='color:${c.color}'>${q}</div><br>`;z._AddLogEntry(x),z._GenerateLimitMessage(o,B)}static get LogCache(){return z._LogCache}static ClearLogCache(){z._LogCache="",z._LogLimitOutputs={},z.errorsCount=0}static set LogLevels(B){z.Log=z._LogDisabled,z.Warn=z._LogDisabled,z.Error=z._LogDisabled;const E=[z.MessageLogLevel,z.WarningLogLevel,z.ErrorLogLevel];for(const v of E)if((B&v)===v){const B=this._Levels[v];z[B.name]=z._LogEnabled.bind(z,v)}}}z.NoneLogLevel=0,z.MessageLogLevel=1,z.WarningLogLevel=2,z.ErrorLogLevel=4,z.AllLogLevel=7,z.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",z._LogCache="",z._LogLimitOutputs={},z._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],z.errorsCount=0,z.Log=z._LogEnabled.bind(z,z.MessageLogLevel),z.Warn=z._LogEnabled.bind(z,z.WarningLogLevel),z.Error=z._LogEnabled.bind(z,z.ErrorLogLevel)},11202:(B,E,v)=>{v.d(E,{e:()=>c});const z="undefined"!==typeof WeakRef;class o{constructor(B){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0;this.initialize(B,E,v,z)}initialize(B){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0;return this.mask=B,this.skipNextObservers=E,this.target=v,this.currentTarget=z,this}}class q{constructor(B,E){let v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=B,this.mask=E,this.scope=v,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let B=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(B)}}class c{static FromPromise(B,E){const v=new c;return B.then((B=>{v.notifyObservers(B)})).catch((B=>{if(!E)throw B;E.notifyObservers(B)})),v}get observers(){return this._observers}constructor(B){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=E,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new o(0),B&&(this._onObserverAdded=B)}add(B){let E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],v=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!B)return null;const o=new q(B,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);o.unregisterOnNextCall=v,E?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(o,this._lastNotifiedValue);const c=z?new WeakRef(this):{deref:()=>this};return o._remove=function(){let B=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=c.deref();E&&(B?E.remove(o):E._remove(o))},o}addOnce(B){return this.add(B,void 0,void 0,void 0,!0)}remove(B){if(!B)return!1;B._remove=null;return-1!==this._observers.indexOf(B)&&(this._deferUnregister(B),!0)}removeCallback(B,E){for(let v=0;v<this._observers.length;v++){const z=this._observers[v];if(!z._willBeUnregistered&&(z.callback===B&&(!E||E===z.scope)))return this._deferUnregister(z),!0}return!1}_deferUnregister(B){B._willBeUnregistered||(this._numObserversMarkedAsDeleted++,B.unregisterOnNextCall=!1,B._willBeUnregistered=!0,setTimeout((()=>{this._remove(B)}),0))}_remove(B){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!B)return!1;const v=this._observers.indexOf(B);return-1!==v&&(E&&this._numObserversMarkedAsDeleted--,this._observers.splice(v,1),!0)}makeObserverTopPriority(B){this._remove(B,!1),this._observers.unshift(B)}makeObserverBottomPriority(B){this._remove(B,!1),this._observers.push(B)}notifyObservers(B){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,v=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=B),!this._observers.length)return!0;const q=this._eventState;q.mask=E,q.target=v,q.currentTarget=z,q.skipNextObservers=!1,q.lastReturnValue=B,q.userInfo=o;for(const c of this._observers)if(!c._willBeUnregistered&&(c.mask&E&&(c.unregisterOnNextCall&&this._deferUnregister(c),c.scope?q.lastReturnValue=c.callback.apply(c.scope,[B,q]):q.lastReturnValue=c.callback(B,q)),q.skipNextObservers))return!1;return!0}notifyObserver(B,E){let v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=E),B._willBeUnregistered)return;const z=this._eventState;z.mask=v,z.skipNextObservers=!1,B.unregisterOnNextCall&&this._deferUnregister(B),B.callback(E,z)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const B=this._observers.pop();B&&(B._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const B=new c;return B._observers=this._observers.slice(0),B}hasSpecificMask(){let B=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const E of this._observers)if(E.mask&B||E.mask===B)return!0;return!1}}},11278:(B,E,v)=>{v.d(E,{c:()=>o,f:()=>c});let z=[];class o{static SetImmediate(B){0===z.length&&setTimeout((()=>{const B=z;z=[];for(const E of B)E()}),1),z.push(B)}}function q(B,E,v){try{if(B())return E(),!0}catch(z){return null===v||void 0===v||v(z),!0}return!1}const c=function(B,E,v){let z=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,c=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&q(B,E,v))return null;const S=setInterval((()=>{q(B,E,v)?clearInterval(S):(o-=z,o<0&&(clearInterval(S),null===v||void 0===v||v(new Error("Operation timed out after maximum retries. "+(c||"")),!0)))}),z);return()=>clearInterval(S)}}}]);