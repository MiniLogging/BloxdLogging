"use strict";(self.hmihoa2fs98=self.hmihoa2fs98||[]).push([[9],{11556:(b,d,P)=>{P.d(d,{c:()=>X,g:()=>f,l:()=>g,i:()=>p,n:()=>S});class G{constructor(){this.children=[]}isValid(b){return!0}process(b,d,P){let G="";if(this.line){let P=this.line;const x=d.processor;if(x){var W,i,q,C,J,L;x.lineProcessor&&(P=x.lineProcessor(P,d.isFragment,d.processingContext));const G=(null===(W=d.processor)||void 0===W?void 0:W.attributeKeywordName)??"attribute",Y=d.isFragment&&null!==(i=d.processor)&&void 0!==i&&i.varyingFragmentKeywordName?null===(q=d.processor)||void 0===q?void 0:q.varyingFragmentKeywordName:!d.isFragment&&null!==(C=d.processor)&&void 0!==C&&C.varyingVertexKeywordName?null===(J=d.processor)||void 0===J?void 0:J.varyingVertexKeywordName:"varying";if(!d.isFragment&&x.attributeProcessor&&this.line.startsWith(G))P=x.attributeProcessor(this.line,b,d.processingContext);else if(x.varyingProcessor&&(null!==(L=x.varyingCheck)&&void 0!==L&&L.call(x,this.line,d.isFragment)||!x.varyingCheck&&this.line.startsWith(Y)))P=x.varyingProcessor(this.line,d.isFragment,b,d.processingContext);else if(x.uniformProcessor&&x.uniformRegexp&&x.uniformRegexp.test(this.line))d.lookForClosingBracketForUniformBuffer||(P=x.uniformProcessor(this.line,d.isFragment,b,d.processingContext));else if(x.uniformBufferProcessor&&x.uniformBufferRegexp&&x.uniformBufferRegexp.test(this.line))d.lookForClosingBracketForUniformBuffer||(P=x.uniformBufferProcessor(this.line,d.isFragment,d.processingContext),d.lookForClosingBracketForUniformBuffer=!0);else if(x.textureProcessor&&x.textureRegexp&&x.textureRegexp.test(this.line))P=x.textureProcessor(this.line,d.isFragment,b,d.processingContext);else if((x.uniformProcessor||x.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!d.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?x.uniformProcessor&&(P=x.uniformProcessor(this.line,d.isFragment,b,d.processingContext)):x.uniformBufferProcessor&&(P=x.uniformBufferProcessor(this.line,d.isFragment,d.processingContext),d.lookForClosingBracketForUniformBuffer=!0)}d.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(d.lookForClosingBracketForUniformBuffer=!1,x.endOfUniformBufferProcessor&&(P=x.endOfUniformBufferProcessor(this.line,d.isFragment,d.processingContext)))}G+=P+"\n"}for(const x of this.children)G+=x.process(b,d,P);return this.additionalDefineKey&&(b[this.additionalDefineKey]=this.additionalDefineValue||"true",P[this.additionalDefineKey]=b[this.additionalDefineKey]),G}}class W{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(b){this._lines.length=0;for(const d of b){if(!d||"\r"===d)continue;if("#"===d[0]){this._lines.push(d);continue}const b=d.trim();if(!b)continue;if(b.startsWith("//")){this._lines.push(d);continue}const P=b.indexOf(";");if(-1===P)this._lines.push(b);else if(P===b.length-1)b.length>1&&this._lines.push(b);else{const b=d.split(";");for(let d=0;d<b.length;d++){let P=b[d];P&&(P=P.trim(),P&&this._lines.push(P+(d!==b.length-1?";":"")))}}}}}class i extends G{process(b,d,P){for(let G=0;G<this.children.length;G++){const W=this.children[G];if(W.isValid(b))return W.process(b,d,P)}return""}}class q extends G{isValid(b){return this.testExpression.isTrue(b)}}class C{isTrue(b){return!0}static postfixToInfix(b){const d=[];for(const P of b)if(void 0===C._OperatorPriority[P])d.push(P);else{const b=d[d.length-1],G=d[d.length-2];d.length-=2,d.push(`(${G}${P}${b})`)}return d[d.length-1]}static infixToPostfix(b){const d=C._InfixToPostfixCache.get(b);if(d)return d.accessTime=Date.now(),d.result;if(!b.includes("&&")&&!b.includes("||")&&!b.includes(")")&&!b.includes("("))return[b];const P=[];let G=-1;const W=()=>{x=x.trim(),""!==x&&(P.push(x),x="")},i=b=>{G<C._Stack.length-1&&(C._Stack[++G]=b)},q=()=>C._Stack[G],J=()=>-1===G?"!!INVALID EXPRESSION!!":C._Stack[G--];let L=0,x="";for(;L<b.length;){const d=b.charAt(L),Y=L<b.length-1?b.substring(L,2+L):"";if("("===d)x="",i(d);else if(")"===d){for(W();-1!==G&&"("!==q();)P.push(J());J()}else if(C._OperatorPriority[Y]>1){for(W();-1!==G&&C._OperatorPriority[q()]>=C._OperatorPriority[Y];)P.push(J());i(Y),L++}else x+=d;L++}for(W();-1!==G;)"("===q()?J():P.push(J());return C._InfixToPostfixCache.size>=C.InfixToPostfixCacheLimitSize&&C.ClearCache(),C._InfixToPostfixCache.set(b,{result:P,accessTime:Date.now()}),P}static ClearCache(){const b=Array.from(C._InfixToPostfixCache.entries()).sort(((b,d)=>b[1].accessTime-d[1].accessTime));for(let d=0;d<C.InfixToPostfixCacheCleanupSize;d++)C._InfixToPostfixCache.delete(b[d][0])}}C.InfixToPostfixCacheLimitSize=5e4,C.InfixToPostfixCacheCleanupSize=25e3,C._InfixToPostfixCache=new Map,C._OperatorPriority={")":0,"(":1,"||":2,"&&":3},C._Stack=["","","","","","","","","","","","","","","","","","","",""];class J extends C{constructor(b){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=b,this.not=d}isTrue(b){let d=void 0!==b[this.define];return this.not&&(d=!d),d}}class L extends C{isTrue(b){return this.leftOperand.isTrue(b)||this.rightOperand.isTrue(b)}}class x extends C{isTrue(b){return this.leftOperand.isTrue(b)&&this.rightOperand.isTrue(b)}}class Y extends C{constructor(b,d,P){super(),this.define=b,this.operand=d,this.testValue=P}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(b){let d=!1;const P=parseInt(void 0!=b[this.define]?b[this.define]:this.define),G=parseInt(void 0!=b[this.testValue]?b[this.testValue]:this.testValue);if(isNaN(P)||isNaN(G))return!1;switch(this.operand){case">":d=P>G;break;case"<":d=P<G;break;case"<=":d=P<=G;break;case">=":d=P>=G;break;case"==":d=P===G;break;case"!=":d=P!==G}return d}}var s=P(11525),E=P(11561);const w=/defined\s*?\((.+?)\)/g,t=/defined\s*?\[(.+?)\]/g,r=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,B=/__decl__/,n=/light\{X\}.(\w*)/g,Z=/\{X\}/g,o=[],A=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function f(b){b.processor&&b.processor.initializeShaders&&b.processor.initializeShaders(b.processingContext)}function g(b,d,P,G){var W;null!==(W=d.processor)&&void 0!==W&&W.preProcessShaderCode&&(b=d.processor.preProcessShaderCode(b,d.isFragment)),p(b,d,(b=>{d.processCodeAfterIncludes&&(b=d.processCodeAfterIncludes(d.isFragment?"fragment":"vertex",b,d.defines));const W=function(b,d,P){let G=function(b,d){var P;if(null!==(P=d.processor)&&void 0!==P&&P.noPrecision)return b;const G=d.shouldUseHighPrecisionShader;-1===b.indexOf("precision highp float")?b=G?"precision highp float;\n"+b:"precision mediump float;\n"+b:G||(b=b.replace("precision highp float","precision mediump float"));return b}(b,d);if(!d.processor)return G;if(0===d.processor.shaderLanguage&&-1!==G.indexOf("#version 3")&&(G=G.replace("#version 300 es",""),!d.processor.parseGLES3))return G;const W=d.defines,i=H(d,P);d.processor.preProcessor&&(G=d.processor.preProcessor(G,W,i,d.isFragment,d.processingContext));const q={};G=U(G,i,d,q),d.processor.postProcessor&&(G=d.processor.postProcessor(G,W,d.isFragment,d.processingContext,P?{drawBuffersExtensionDisabled:!P.getCaps().drawBuffersExtension}:{},i,q));null!==P&&void 0!==P&&P._features.needShaderCodeInlining&&(G=P.inlineShaderCode(G));return G}(b,d,G);P(W,b)}))}function X(b,d,P){return P.processor&&P.processor.finalizeShaders?P.processor.finalizeShaders(b,d,P.processingContext):{vertexCode:b,fragmentCode:d}}function u(b){const d=/defined\((.+)\)/.exec(b);if(d&&d.length)return new J(d[1].trim(),"!"===b[0]);const P=["==","!=",">=","<=","<",">"];let G="",W=0;for(G of P)if(W=b.indexOf(G),W>-1)break;if(-1===W)return new J(b);const i=b.substring(0,W).trim(),q=b.substring(W+G.length).trim();return new Y(i,G,q)}function M(b,d){const P=new q,G=b.substring(0,d);let W=b.substring(d);return W=W.substring(0,(W.indexOf("//")+1||W.length+1)-1).trim(),P.testExpression="#ifdef"===G?new J(W):"#ifndef"===G?new J(W,!0):function(b){b=b.replace(w,"defined[$1]");const d=C.infixToPostfix(b),P=[];for(const W of d)if("||"!==W&&"&&"!==W)P.push(W);else if(P.length>=2){let b=P[P.length-1],d=P[P.length-2];P.length-=2;const G="&&"==W?new x:new L;"string"===typeof b&&(b=b.replace(t,"defined($1)")),"string"===typeof d&&(d=d.replace(t,"defined($1)")),G.leftOperand="string"===typeof d?u(d):d,G.rightOperand="string"===typeof b?u(b):b,P.push(G)}let G=P[P.length-1];return"string"===typeof G&&(G=G.replace(t,"defined($1)")),"string"===typeof G?u(G):G}(W),P}function e(b,d,P,W){let i=b.currentLine;for(;R(b,P,W);){i=b.currentLine;const q=i.substring(0,5).toLowerCase();if("#else"===q){const P=new G;return d.children.push(P),void R(b,P,W)}if("#elif"===q){const b=M(i,5);d.children.push(b),P=b}}}function R(b,d,P){for(;b.canRead;){b.lineIndex++;const W=b.currentLine;if(W.indexOf("#")>=0){const G=A.exec(W);if(G&&G.length){switch(G[0]){case"#ifdef":{const G=new i;d.children.push(G);const q=M(W,6);G.children.push(q),e(b,G,q,P);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const G=new i;d.children.push(G);const q=M(W,7);G.children.push(q),e(b,G,q,P);break}case"#if":{const G=new i,q=M(W,3);d.children.push(G),G.children.push(q),e(b,G,q,P);break}}continue}}const q=new G;if(q.line=W,d.children.push(q),"#"===W[0]&&"d"===W[1]){const b=W.replace(";","").split(" ");q.additionalDefineKey=b[1],3===b.length&&(q.additionalDefineValue=b[2])}}return!1}function U(b,d,P,i){const q=new G,C=new W;return C.lineIndex=-1,C.lines=b.split("\n"),R(C,q,i),q.process(d,P,i)}function H(b,d){var P;const G=b.defines,W={};for(const i of G){const b=i.replace("#define","").replace(";","").trim().split(" ");W[b[0]]=b.length>1?b[1]:""}return 0===(null===(P=b.processor)||void 0===P?void 0:P.shaderLanguage)&&(W.GL_ES="true"),W.__VERSION__=b.version,W[b.platformName]="true",(0,E.l)(W,null===d||void 0===d?void 0:d.isNDCHalfZRange,null===d||void 0===d?void 0:d.useReverseDepthBuffer,null===d||void 0===d?void 0:d.useExactSrgbConversions),W}function p(b,d,P){let G;for(o.length=0;null!==(G=r.exec(b));)o.push(G);let W=String(b),i=[b],q=!1;for(const C of o){let b=C[1];if(-1!==b.indexOf("__decl__")&&(b=b.replace(B,""),d.supportsUniformBuffers&&(b=b.replace("Vertex","Ubo").replace("Fragment","Ubo")),b+="Declaration"),!d.includesShadersStore[b]){const G=d.shadersRepository+"ShadersInclude/"+b+".fx";return void S.loadFile(G,(G=>{d.includesShadersStore[b]=G,p(i.join(""),d,P)}))}{let P=d.includesShadersStore[b];if(C[2]){const b=C[3].split(",");for(let d=0;d<b.length;d+=2){const G=new RegExp(b[d],"g"),W=b[d+1];P=P.replace(G,W)}}if(C[4]){const b=C[5];if(-1!==b.indexOf("..")){const G=b.split(".."),W=parseInt(G[0]);let i=parseInt(G[1]),q=P.slice(0);P="",isNaN(i)&&(i=d.indexParameters[G[1]]);for(let b=W;b<i;b++)d.supportsUniformBuffers||(q=q.replace(n,((b,d)=>d+"{X}"))),P+=q.replace(Z,b.toString())+"\n"}else d.supportsUniformBuffers||(P=P.replace(n,((b,d)=>d+"{X}"))),P=P.replace(Z,b)}const G=[];for(const b of i){const d=b.split(C[0]);for(let b=0;b<d.length-1;b++)G.push(d[b]),G.push(P);G.push(d[d.length-1])}i=G,q=q||P.indexOf("#include<")>=0||P.indexOf("#include <")>=0}}o.length=0,W=i.join(""),q?p(W.toString(),d,P):P(W)}const S={loadFile:(b,d,P,G,W,i)=>{throw(0,s.d)("FileTools")}}},11561:(b,d,P)=>{P.d(d,{e:()=>W,i:()=>i,l:()=>C,o:()=>q,s:()=>J});var G=P(11525);P(11495);const W={};function i(b,d){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(d?d+"\n":"")+b}function q(b,d,P,i,q,C,J){const L=J||W.loadFile;if(L){return L(b,d,P,i,q,C)}throw(0,G.d)("FileTools")}function C(b,d,P,G){if(b)return d?b.IS_NDC_HALF_ZRANGE="":delete b.IS_NDC_HALF_ZRANGE,P?b.USE_REVERSE_DEPTHBUFFER="":delete b.USE_REVERSE_DEPTHBUFFER,void(G?b.USE_EXACT_SRGB_CONVERSIONS="":delete b.USE_EXACT_SRGB_CONVERSIONS);{let b="";return d&&(b+="#define IS_NDC_HALF_ZRANGE"),P&&(b&&(b+="\n"),b+="#define USE_REVERSE_DEPTHBUFFER"),G&&(b&&(b+="\n"),b+="#define USE_EXACT_SRGB_CONVERSIONS"),b}}function J(b,d){let P=arguments.length>2&&void 0!==arguments[2]&&arguments[2],G=arguments.length>3?arguments[3]:void 0;switch(b){case 3:{const b=(ArrayBuffer,new Int8Array(d));return G&&b.set(new Int8Array(G)),b}case 0:{const b=(ArrayBuffer,new Uint8Array(d));return G&&b.set(new Uint8Array(G)),b}case 4:{const b=d instanceof ArrayBuffer?new Int16Array(d):new Int16Array(P?d/2:d);return G&&b.set(new Int16Array(G)),b}case 5:case 8:case 9:case 10:case 2:{const b=d instanceof ArrayBuffer?new Uint16Array(d):new Uint16Array(P?d/2:d);return G&&b.set(new Uint16Array(G)),b}case 6:{const b=d instanceof ArrayBuffer?new Int32Array(d):new Int32Array(P?d/4:d);return G&&b.set(new Int32Array(G)),b}case 7:case 11:case 12:case 13:case 14:case 15:{const b=d instanceof ArrayBuffer?new Uint32Array(d):new Uint32Array(P?d/4:d);return G&&b.set(new Uint32Array(G)),b}case 1:{const b=d instanceof ArrayBuffer?new Float32Array(d):new Float32Array(P?d/4:d);return G&&b.set(new Float32Array(G)),b}}const W=(ArrayBuffer,new Uint8Array(d));return G&&W.set(new Uint8Array(G)),W}},11591:(b,d,P)=>{P.d(d,{c:()=>G});class G{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.ShadersRepository:G.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.ShadersStore:G.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.IncludesShadersStore:G.IncludesShadersStoreWGSL}}G.ShadersRepository="src/Shaders/",G.ShadersStore={},G.IncludesShadersStore={},G.ShadersRepositoryWGSL="src/ShadersWGSL/",G.ShadersStoreWGSL={},G.IncludesShadersStoreWGSL={}},11605:(b,d,P)=>{P.d(d,{c:()=>s,g:()=>Z,j:()=>w,k:()=>E,m:()=>t,q:()=>n,s:()=>Y,u:()=>L,v:()=>x,w:()=>J,x:()=>C});class G{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Md._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(b){b&&this.program&&b(this.program)}setEngine(b){this.Md=b}_fillEffectInformation(b,d,P,G,W,i,q,C){const J=this.Md;if(J.supportsUniformBuffers)for(const x in d)b.bindUniformBlock(x,d[x]);let L;for(this.Md.getUniforms(this,P).forEach(((b,d)=>{G[P[d]]=b})),this._uniforms=G,L=0;L<W.length;L++){null==b.getUniform(W[L])&&(W.splice(L,1),L--)}W.forEach(((b,d)=>{i[b]=d}));for(const x of J.getAttributes(this,q))C.push(x)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(b,d){const P=this._valueCache[b],G=d.updateFlag;return(void 0===P||P!==G)&&(this._valueCache[b]=G,!0)}_cacheFloat2(b,d,P){let G=this._valueCache[b];if(!G||2!==G.length)return G=[d,P],this._valueCache[b]=G,!0;let W=!1;return G[0]!==d&&(G[0]=d,W=!0),G[1]!==P&&(G[1]=P,W=!0),W}_cacheFloat3(b,d,P,G){let W=this._valueCache[b];if(!W||3!==W.length)return W=[d,P,G],this._valueCache[b]=W,!0;let i=!1;return W[0]!==d&&(W[0]=d,i=!0),W[1]!==P&&(W[1]=P,i=!0),W[2]!==G&&(W[2]=G,i=!0),i}_cacheFloat4(b,d,P,G,W){let i=this._valueCache[b];if(!i||4!==i.length)return i=[d,P,G,W],this._valueCache[b]=i,!0;let q=!1;return i[0]!==d&&(i[0]=d,q=!0),i[1]!==P&&(i[1]=P,q=!0),i[2]!==G&&(i[2]=G,q=!0),i[3]!==W&&(i[3]=W,q=!0),q}setInt(b,d){const P=this._valueCache[b];void 0!==P&&P===d||this.Md.setInt(this._uniforms[b],d)&&(this._valueCache[b]=d)}setInt2(b,d,P){this._cacheFloat2(b,d,P)&&(this.Md.setInt2(this._uniforms[b],d,P)||(this._valueCache[b]=null))}setInt3(b,d,P,G){this._cacheFloat3(b,d,P,G)&&(this.Md.setInt3(this._uniforms[b],d,P,G)||(this._valueCache[b]=null))}setInt4(b,d,P,G,W){this._cacheFloat4(b,d,P,G,W)&&(this.Md.setInt4(this._uniforms[b],d,P,G,W)||(this._valueCache[b]=null))}setIntArray(b,d){this._valueCache[b]=null,this.Md.setIntArray(this._uniforms[b],d)}setIntArray2(b,d){this._valueCache[b]=null,this.Md.setIntArray2(this._uniforms[b],d)}setIntArray3(b,d){this._valueCache[b]=null,this.Md.setIntArray3(this._uniforms[b],d)}setIntArray4(b,d){this._valueCache[b]=null,this.Md.setIntArray4(this._uniforms[b],d)}setUInt(b,d){const P=this._valueCache[b];void 0!==P&&P===d||this.Md.setUInt(this._uniforms[b],d)&&(this._valueCache[b]=d)}setUInt2(b,d,P){this._cacheFloat2(b,d,P)&&(this.Md.setUInt2(this._uniforms[b],d,P)||(this._valueCache[b]=null))}setUInt3(b,d,P,G){this._cacheFloat3(b,d,P,G)&&(this.Md.setUInt3(this._uniforms[b],d,P,G)||(this._valueCache[b]=null))}setUInt4(b,d,P,G,W){this._cacheFloat4(b,d,P,G,W)&&(this.Md.setUInt4(this._uniforms[b],d,P,G,W)||(this._valueCache[b]=null))}setUIntArray(b,d){this._valueCache[b]=null,this.Md.setUIntArray(this._uniforms[b],d)}setUIntArray2(b,d){this._valueCache[b]=null,this.Md.setUIntArray2(this._uniforms[b],d)}setUIntArray3(b,d){this._valueCache[b]=null,this.Md.setUIntArray3(this._uniforms[b],d)}setUIntArray4(b,d){this._valueCache[b]=null,this.Md.setUIntArray4(this._uniforms[b],d)}setArray(b,d){this._valueCache[b]=null,this.Md.setArray(this._uniforms[b],d)}setArray2(b,d){this._valueCache[b]=null,this.Md.setArray2(this._uniforms[b],d)}setArray3(b,d){this._valueCache[b]=null,this.Md.setArray3(this._uniforms[b],d)}setArray4(b,d){this._valueCache[b]=null,this.Md.setArray4(this._uniforms[b],d)}setMatrices(b,d){d&&(this._valueCache[b]=null,this.Md.setMatrices(this._uniforms[b],d))}setMatrix(b,d){this._cacheMatrix(b,d)&&(this.Md.setMatrices(this._uniforms[b],d.jd())||(this._valueCache[b]=null))}setMatrix3x3(b,d){this._valueCache[b]=null,this.Md.setMatrix3x3(this._uniforms[b],d)}setMatrix2x2(b,d){this._valueCache[b]=null,this.Md.setMatrix2x2(this._uniforms[b],d)}setFloat(b,d){const P=this._valueCache[b];void 0!==P&&P===d||this.Md.setFloat(this._uniforms[b],d)&&(this._valueCache[b]=d)}setVector2(b,d){this._cacheFloat2(b,d.x,d.y)&&(this.Md.setFloat2(this._uniforms[b],d.x,d.y)||(this._valueCache[b]=null))}setFloat2(b,d,P){this._cacheFloat2(b,d,P)&&(this.Md.setFloat2(this._uniforms[b],d,P)||(this._valueCache[b]=null))}setVector3(b,d){this._cacheFloat3(b,d.x,d.y,d.z)&&(this.Md.setFloat3(this._uniforms[b],d.x,d.y,d.z)||(this._valueCache[b]=null))}setFloat3(b,d,P,G){this._cacheFloat3(b,d,P,G)&&(this.Md.setFloat3(this._uniforms[b],d,P,G)||(this._valueCache[b]=null))}setVector4(b,d){this._cacheFloat4(b,d.x,d.y,d.z,d.w)&&(this.Md.setFloat4(this._uniforms[b],d.x,d.y,d.z,d.w)||(this._valueCache[b]=null))}setQuaternion(b,d){this._cacheFloat4(b,d.x,d.y,d.z,d.w)&&(this.Md.setFloat4(this._uniforms[b],d.x,d.y,d.z,d.w)||(this._valueCache[b]=null))}setFloat4(b,d,P,G,W){this._cacheFloat4(b,d,P,G,W)&&(this.Md.setFloat4(this._uniforms[b],d,P,G,W)||(this._valueCache[b]=null))}setColor3(b,d){this._cacheFloat3(b,d.r,d.g,d.b)&&(this.Md.setFloat3(this._uniforms[b],d.r,d.g,d.b)||(this._valueCache[b]=null))}setColor4(b,d,P){this._cacheFloat4(b,d.r,d.g,d.b,P)&&(this.Md.setFloat4(this._uniforms[b],d.r,d.g,d.b,P)||(this._valueCache[b]=null))}setDirectColor4(b,d){this._cacheFloat4(b,d.r,d.g,d.b,d.a)&&(this.Md.setFloat4(this._uniforms[b],d.r,d.g,d.b,d.a)||(this._valueCache[b]=null))}_getVertexShaderCode(){return this.vertexShader?this.Md._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Md._getShaderSource(this.fragmentShader):null}}var W=P(11561);const i=new WeakMap,q={_webGLVersion:2,cachedPipelines:{}};function C(b){let d=i.get(b);if(!d){if(!b)return q;d={_webGLVersion:b.TEXTURE_BINDING_3D?2:1,_context:b,parallelShaderCompile:b.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},i.set(b,d)}return d}function J(b){i.delete(b)}function L(b,d,P,G,W,i){const q=C(G);i||(i=q._createShaderProgramInjection??s);return i(b,B(d,"vertex",G,q._contextWasLost),B(P,"fragment",G,q._contextWasLost),G,W,q.validateShaderPrograms)}function x(b,d,P,G,W){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,q=arguments.length>6?arguments[6]:void 0;const J=C(W);q||(q=J._createShaderProgramInjection??s);const L=J._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return q(b,r(d,"vertex",G,L,W,J._contextWasLost),r(P,"fragment",G,L,W,J._contextWasLost),W,i,J.validateShaderPrograms)}function Y(b,d){const P=new G,W=C(b);return W.parallelShaderCompile&&!W.disableParallelShaderCompile&&(P.isParallelCompiled=!0),P.context=W._context,P}function s(b,d,P,G){let W=arguments.length>5?arguments[5]:void 0;const i=G.createProgram();if(b.program=i,!i)throw new Error("Unable to create program");return G.attachShader(i,d),G.attachShader(i,P),G.linkProgram(i),b.context=G,b.vertexShader=d,b.fragmentShader=P,b.isParallelCompiled||w(b,G,W),i}function E(b,d,P){const G=b;if(G._isDisposed)return!1;const W=C(d);return!!(W&&W.parallelShaderCompile&&W.parallelShaderCompile.COMPLETION_STATUS_KHR&&G.program&&d.getProgramParameter(G.program,W.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(w(G,d,P),!0)}function w(b,d,P){const G=b.context,W=b.vertexShader,i=b.fragmentShader,q=b.program;if(!G.getProgramParameter(q,G.LINK_STATUS)){if(!d.getShaderParameter(W,d.COMPILE_STATUS)){const P=d.getShaderInfoLog(W);if(P)throw b.vertexCompilationError=P,new Error("VERTEX SHADER "+P)}if(!d.getShaderParameter(i,d.COMPILE_STATUS)){const P=d.getShaderInfoLog(i);if(P)throw b.fragmentCompilationError=P,new Error("FRAGMENT SHADER "+P)}const P=G.getProgramInfoLog(q);if(P)throw b.programLinkError=P,new Error(P)}if(P){G.validateProgram(q);if(!G.getProgramParameter(q,G.VALIDATE_STATUS)){const d=G.getProgramInfoLog(q);if(d)throw b.programValidationError=d,new Error(d)}}G.deleteShader(W),G.deleteShader(i),b.vertexShader=void 0,b.fragmentShader=void 0,b.onCompiled&&(b.onCompiled(),b.onCompiled=void 0)}function t(b,d,P,G,W,i,q,J,Y){let s=arguments.length>10?arguments[10]:void 0,E=arguments.length>11?arguments[11]:void 0,w=arguments.length>12?arguments[12]:void 0;const t=C(b.context);E||(E=t.createRawShaderProgramInjection??L),w||(w=t.createShaderProgramInjection??x);const r=b;r.program=G?E(r,d,P,r.context,Y):w(r,d,P,J,r.context,Y),r.program.__SPECTOR_rebuildProgram=q,s()}function r(b,d,P,G,i,q){return B((0,W.i)(b,P,G),d,i,q)}function B(b,d,P,G){const W=P.createShader("vertex"===d?P.VERTEX_SHADER:P.FRAGMENT_SHADER);if(!W){let b=P.NO_ERROR,W=P.NO_ERROR;for(;(W=P.getError())!==P.NO_ERROR;)b=W;throw new Error(`Something went wrong while creating a gl ${d} shader object. gl error=${b}, gl isContextLost=${P.isContextLost()}, _contextWasLost=${G}`)}return P.shaderSource(W,b),P.compileShader(W),W}function n(b,d){d.useProgram(b)}function Z(b,d){const P=b;if(!P.isParallelCompiled)return void d(b);const G=P.onCompiled;P.onCompiled=()=>{null===G||void 0===G||G(),d(b)}}},11596:(b,d,P)=>{P.d(d,{d:()=>Y,f:()=>E,h:()=>L,j:()=>x});var G=P(11495),W=P(11605),i=P(11591),q=P(11504),C=P(11556),J=P(11561);function L(b,d){return(0,W.x)(d).cachedPipelines[b]}function x(b){const d=b._name,P=b.context;if(d&&P){const b=(0,W.x)(P),G=b.cachedPipelines[d];null===G||void 0===G||G.dispose(),delete b.cachedPipelines[d]}}function Y(b,d,P,W,i,q,J){let L,x;const Y=(0,G.j)()?null===q||void 0===q?void 0:q.getHostDocument():null;L="string"===typeof d?d:d.vertexSource?"source:"+d.vertexSource:d.vertexElement?(null===Y||void 0===Y?void 0:Y.getElementById(d.vertexElement))||d.vertexElement:d.vertex||d,x="string"===typeof d?d:d.fragmentSource?"source:"+d.fragmentSource:d.fragmentElement?(null===Y||void 0===Y?void 0:Y.getElementById(d.fragmentElement))||d.fragmentElement:d.fragment||d;const E=[void 0,void 0],w=()=>{if(E[0]&&E[1]){b.isFragment=!0;const[G,L]=E;(0,C.l)(L,b,((q,L)=>{J&&(J._fragmentSourceCodeBeforeMigration=L),P&&(q=P("fragment",q));const x=(0,C.c)(G,q,b);b=null;const Y=function(b,d,P,G){if(P){return{vertexSourceCode:(1===G?"//":"")+"#define SHADER_NAME vertex:"+(P.vertexElement||P.vertex||P.spectorName||P)+"\n"+b,fragmentSourceCode:(1===G?"//":"")+"#define SHADER_NAME fragment:"+(P.fragmentElement||P.fragment||P.spectorName||P)+"\n"+d}}return{vertexSourceCode:b,fragmentSourceCode:d}}(x.vertexCode,x.fragmentCode,d,i);null===W||void 0===W||W(Y.vertexSourceCode,Y.fragmentSourceCode)}),q)}};s(L,"Vertex","",(d=>{(0,C.g)(b),(0,C.l)(d,b,((b,G)=>{J&&(J._rawVertexSourceCode=d,J._vertexSourceCodeBeforeMigration=G),P&&(b=P("vertex",b)),E[0]=b,w()}),q)}),i),s(x,"Fragment","Pixel",(b=>{J&&(J._rawFragmentSourceCode=b),E[1]=b,w()}),i)}function s(b,d,P,W,q,C){if("undefined"!==typeof HTMLElement&&b instanceof HTMLElement){return void W((0,G.d)(b))}if("source:"===b.substring(0,7))return void W(b.substring(7));if("base64:"===b.substring(0,7)){return void W(window.atob(b.substring(7)))}const L=i.c.GetShadersStore(q);if(L[b+d+"Shader"])return void W(L[b+d+"Shader"]);if(P&&L[b+P+"Shader"])return void W(L[b+P+"Shader"]);let x;if(x="."===b[0]||"/"===b[0]||b.indexOf("http")>-1?b:i.c.GetShadersRepository(q)+b,!(C=C||J.o))throw new Error("loadFileInjection is not defined");C(x+"."+d.toLowerCase()+".fx",W)}const E=(b,d,P,G)=>{try{const i=b.context?(0,W.x)(b.context):null;i&&(i.disableParallelShaderCompile=b.disableParallelCompilation);const q=b.existingPipelineContext||d(b.shaderProcessingContext);return q._name=b.name,b.name&&i&&(i.cachedPipelines[b.name]=q),P(q,b.vertex,b.fragment,!!b.createAsRaw,"","",b.rebuildRebind,b.defines,b.transformFeedbackVaryings,"",(()=>{G(q,(()=>{var d;null===(d=b.onRenderingStateCompiled)||void 0===d||d.call(b,q)}))})),q}catch(i){throw q.e.Error("Error compiling effect"),i}}},11582:(b,d,P)=>{P.r(d),P.d(d,{Effect:()=>J});var G=P(11487),W=P(11504),i=P(11591),q=P(11596),C=P(11569);class J{static get ShadersRepository(){return i.c.ShadersRepository}static set ShadersRepository(b){i.c.ShadersRepository=b}get L(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new G.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(b,d,P){let W=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4?arguments[4]:void 0,C=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,L=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,x=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Y=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9?arguments[9]:void 0,E=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",w=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,t=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new G.d,this.onErrorObservable=new G.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=b,this._key=E;const r=this._key.replace(/\r/g,"").replace(/\n/g,"|");let B;if(d.attributes){const b=d;if(this._engine=P,this._attributesNames=b.attributes,this._uniformsNames=b.uniformsNames.concat(b.samplers),this._samplerList=b.samplers.slice(),this.defines=b.defines,this.onError=b.onError,this.onCompiled=b.onCompiled,this._fallbacks=b.fallbacks,this._indexParameters=b.indexParameters,this._transformFeedbackVaryings=b.transformFeedbackVaryings||null,this._multiTarget=!!b.multiTarget,this._shaderLanguage=b.shaderLanguage??0,this._disableParallelShaderCompilation=!!b.disableParallelShaderCompilation,b.uniformBuffersNames){this._uniformBuffersNamesList=b.uniformBuffersNames.slice();for(let d=0;d<b.uniformBuffersNames.length;d++)this._uniformBuffersNames[b.uniformBuffersNames[d]]=d}this._processFinalCode=b.processFinalCode??null,this._processCodeAfterIncludes=b.processCodeAfterIncludes??void 0,t=b.extraInitializationsAsync,B=b.existingPipelineContext}else this._engine=i,this.defines=null==C?"":C,this._uniformsNames=P.concat(W),this._samplerList=W?W.slice():[],this._attributesNames=d,this._uniformBuffersNamesList=[],this._shaderLanguage=w,this.onError=Y,this.onCompiled=x,this._indexParameters=s,this._fallbacks=L;"WEBGL2"===this._engine.shaderPlatformName&&(B=(0,q.h)(r,this._engine._gl)??B),this._attributeLocationByName={},this.uniqueId=J._UniqueIdSeed++,B?(this._pipelineContext=B,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,t),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.L||this.dispose(!0)}))}async _processShaderCodeAsync(){let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,G=arguments.length>3?arguments[3]:void 0;G&&await G(),this._processingContext=P||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const W={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:b??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:i.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:i.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,q.d)(W,this.name,this._processFinalCode,((b,P)=>{this._vertexSourceCode=b,this._fragmentSourceCode=P,this._prepareEffect(d)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.L||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(b){return this._attributes[b]}getAttributeLocationByName(b){return this._attributeLocationByName[b]}getAttributesCount(){return this._attributes.length}getUniformIndex(b){return this._uniformsNames.indexOf(b)}getUniform(b){return this._uniforms[b]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((b=>{this.executeWhenCompiled(b)}))}executeWhenCompiled(b){this.isReady()?b(this):(this.onCompileObservable.add((d=>{b(d)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(b){(0,C.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(d=>{this._processCompilationErrors(d,b)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var b;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(b=this._pipelineContext)||void 0===b?void 0:b._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var b;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(b=this._pipelineContext)||void 0===b?void 0:b._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(b,d,P,G){this._isReady=!1,this._vertexSourceCodeOverride=b,this._fragmentSourceCodeOverride=d,this.onError=(b,d)=>{G&&G(d)},this.onCompiled=()=>{var b,d;const G=this.getEngine().scenes;if(G)for(let P=0;P<G.length;P++)G[P].markAllMaterialsAsDirty(127);null===(b=(d=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===b||b.call(d,P)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(b){if(this._pipelineContext=b,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let d=0;d<this._attributesNames.length;d++){const b=this._attributesNames[d];this._attributeLocationByName[b]=this._attributes[d]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),J.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const d=this._pipelineContext;this._isReady=!1;try{const P=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),G=P?null:this.defines,W=P?this._vertexSourceCodeOverride:this._vertexSourceCode,i=P?this._fragmentSourceCodeOverride:this._fragmentSourceCode,C=this._engine;this._pipelineContext=(0,q.f)({existingPipelineContext:b?d:null,vertex:W,fragment:i,context:"WEBGL2"===C.shaderPlatformName||"WEBGL1"===C.shaderPlatformName?C._gl:void 0,rebuildRebind:(b,d,P,G)=>this._rebuildProgram(b,d,P,G),defines:G,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:P,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:P=>{d&&!b&&this._engine._deletePipelineContext(d),P&&this._onRenderingStateCompiled(P)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(d)}catch(P){this._processCompilationErrors(P,d)}}_getShaderCodeAndErrorLine(b,d,P){const G=P?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let W=null;if(d&&b){const i=d.match(G);if(i&&2===i.length){const d=parseInt(i[1]),G=b.split("\n",-1);G.length>=d&&(W=`Offending line [${d}] in ${P?"fragment":"vertex"} code: ${G[d-1]}`)}}return[b,W]}_processCompilationErrors(b){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=b.message;const P=this._attributesNames,G=this._fallbacks;if(W.e.Error("Unable to compile effect:"),W.e.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),W.e.Error(`Attributes: ${P.join(" ")}`),W.e.Error("Defines:\n"+this.defines),J.LogShaderCodeOnCompilationError){var i,q;let b=null,d=null,P=null;var C;if(null!==(i=this._pipelineContext)&&void 0!==i&&i._getVertexShaderCode()&&([P,b]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),P&&(W.e.Error("Vertex code:"),W.e.Error(P))),null!==(q=this._pipelineContext)&&void 0!==q&&q._getFragmentShaderCode())[P,d]=this._getShaderCodeAndErrorLine(null===(C=this._pipelineContext)||void 0===C?void 0:C._getFragmentShaderCode(),this._compilationError,!0),P&&(W.e.Error("Fragment code:"),W.e.Error(P));b&&W.e.Error(b),d&&W.e.Error(d)}W.e.Error("Error: "+this._compilationError);const L=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};d&&(this._pipelineContext=d,this._isReady=!0,L()),G?(this._pipelineContext=null,G.hasMoreFallbacks?(this._allFallbacksProcessed=!1,W.e.Error("Trying next fallback."),this.defines=G.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,L(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,d||L())}get isSupported(){return""===this._compilationError}_bindTexture(b,d){this._engine._bindTexture(this._samplers[b],d,b)}setTexture(b,d){this._engine.setTexture(this._samplers[b],this._uniforms[b],d,b)}setTextureArray(b,d){const P=b+"Ex";if(-1===this._samplerList.indexOf(P+"0")){const G=this._samplerList.indexOf(b);for(let b=1;b<d.length;b++){const d=P+(b-1).toString();this._samplerList.splice(G+b,0,d)}let W=0;for(const b of this._samplerList)this._samplers[b]=W,W+=1}this._engine.setTextureArray(this._samplers[b],this._uniforms[b],d,b)}bindUniformBuffer(b,d){const P=this._uniformBuffersNames[d];void 0===P||J._BaseCache[P]===b&&this._engine._features.useUBOBindingCache||(J._BaseCache[P]=b,this._engine.bindUniformBufferBase(b,P,d))}bindUniformBlock(b,d){this._engine.bindUniformBlock(this._pipelineContext,b,d)}setInt(b,d){return this._pipelineContext.setInt(b,d),this}setInt2(b,d,P){return this._pipelineContext.setInt2(b,d,P),this}setInt3(b,d,P,G){return this._pipelineContext.setInt3(b,d,P,G),this}setInt4(b,d,P,G,W){return this._pipelineContext.setInt4(b,d,P,G,W),this}setIntArray(b,d){return this._pipelineContext.setIntArray(b,d),this}setIntArray2(b,d){return this._pipelineContext.setIntArray2(b,d),this}setIntArray3(b,d){return this._pipelineContext.setIntArray3(b,d),this}setIntArray4(b,d){return this._pipelineContext.setIntArray4(b,d),this}setUInt(b,d){return this._pipelineContext.setUInt(b,d),this}setUInt2(b,d,P){return this._pipelineContext.setUInt2(b,d,P),this}setUInt3(b,d,P,G){return this._pipelineContext.setUInt3(b,d,P,G),this}setUInt4(b,d,P,G,W){return this._pipelineContext.setUInt4(b,d,P,G,W),this}setUIntArray(b,d){return this._pipelineContext.setUIntArray(b,d),this}setUIntArray2(b,d){return this._pipelineContext.setUIntArray2(b,d),this}setUIntArray3(b,d){return this._pipelineContext.setUIntArray3(b,d),this}setUIntArray4(b,d){return this._pipelineContext.setUIntArray4(b,d),this}setFloatArray(b,d){return this._pipelineContext.setArray(b,d),this}setFloatArray2(b,d){return this._pipelineContext.setArray2(b,d),this}setFloatArray3(b,d){return this._pipelineContext.setArray3(b,d),this}setFloatArray4(b,d){return this._pipelineContext.setArray4(b,d),this}setArray(b,d){return this._pipelineContext.setArray(b,d),this}setArray2(b,d){return this._pipelineContext.setArray2(b,d),this}setArray3(b,d){return this._pipelineContext.setArray3(b,d),this}setArray4(b,d){return this._pipelineContext.setArray4(b,d),this}setMatrices(b,d){return this._pipelineContext.setMatrices(b,d),this}setMatrix(b,d){return this._pipelineContext.setMatrix(b,d),this}setMatrix3x3(b,d){return this._pipelineContext.setMatrix3x3(b,d),this}setMatrix2x2(b,d){return this._pipelineContext.setMatrix2x2(b,d),this}setFloat(b,d){return this._pipelineContext.setFloat(b,d),this}setBool(b,d){return this._pipelineContext.setInt(b,d?1:0),this}setVector2(b,d){return this._pipelineContext.setVector2(b,d),this}setFloat2(b,d,P){return this._pipelineContext.setFloat2(b,d,P),this}setVector3(b,d){return this._pipelineContext.setVector3(b,d),this}setFloat3(b,d,P,G){return this._pipelineContext.setFloat3(b,d,P,G),this}setVector4(b,d){return this._pipelineContext.setVector4(b,d),this}setQuaternion(b,d){return this._pipelineContext.setQuaternion(b,d),this}setFloat4(b,d,P,G,W){return this._pipelineContext.setFloat4(b,d,P,G,W),this}setColor3(b,d){return this._pipelineContext.setColor3(b,d),this}setColor4(b,d,P){return this._pipelineContext.setColor4(b,d,P),this}setDirectColor4(b,d){return this._pipelineContext.setDirectColor4(b,d),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(J.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,q.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(b,d,P){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;d&&(i.c.GetShadersStore(G)[`${b}PixelShader`]=d),P&&(i.c.GetShadersStore(G)[`${b}VertexShader`]=P)}static ResetCache(){J._BaseCache={}}}J.LogShaderCodeOnCompilationError=!0,J.PersistentMode=!1,J.AutomaticallyClearCodeCache=!1,J._UniqueIdSeed=0,J._BaseCache={},J.ShadersStore=i.c.ShadersStore,J.IncludesShadersStore=i.c.IncludesShadersStore},11525:(b,d,P)=>{P.d(d,{d:()=>W});const G={};function W(b){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!G[b])return G[b]=!0,`${b} needs to be imported before as it contains a side-effect required by your code.`}},11495:(b,d,P)=>{function G(){return"undefined"!==typeof window}function W(){return"undefined"!==typeof navigator}function i(){return"undefined"!==typeof document}function q(b){let d="",P=b.firstChild;for(;P;)3===P.nodeType&&(d+=P.textContent),P=P.nextSibling;return d}P.d(d,{d:()=>q,h:()=>i,i:()=>W,j:()=>G})},11504:(b,d,P)=>{P.d(d,{e:()=>G});class G{static _CheckLimit(b,d){let P=G._LogLimitOutputs[b];return P?P.current++:(P={limit:d,current:1},G._LogLimitOutputs[b]=P),P.current<=P.limit}static _GenerateLimitMessage(b){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const P=G._LogLimitOutputs[b];if(!P||!G.MessageLimitReached)return;const W=this._Levels[d];P.current===P.limit&&G[W.name](G.MessageLimitReached.replace(/%LIMIT%/g,""+P.limit).replace(/%TYPE%/g,W.name??""))}static _AddLogEntry(b){G._LogCache=b+G._LogCache,G.OnNewCacheEntry&&G.OnNewCacheEntry(b)}static _FormatMessage(b){const d=b=>b<10?"0"+b:""+b,P=new Date;return"["+d(P.getHours())+":"+d(P.getMinutes())+":"+d(P.getSeconds())+"]: "+b}static _LogDisabled(b,d){}static _LogEnabled(){let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,d=arguments.length>1?arguments[1]:void 0,P=arguments.length>2?arguments[2]:void 0;const W=Array.isArray(d)?d[0]:d;if(void 0!==P&&!G._CheckLimit(W,P))return;const i=G._FormatMessage(W),q=this._Levels[b],C=Array.isArray(d)?d.slice(1):[];q.logFunc&&q.logFunc("BJS - "+i,...C);const J=`<div style='color:${q.color}'>${i}</div><br>`;G._AddLogEntry(J),G._GenerateLimitMessage(W,b)}static get LogCache(){return G._LogCache}static ClearLogCache(){G._LogCache="",G._LogLimitOutputs={},G.errorsCount=0}static set LogLevels(b){G.Log=G._LogDisabled,G.Warn=G._LogDisabled,G.Error=G._LogDisabled;const d=[G.MessageLogLevel,G.WarningLogLevel,G.ErrorLogLevel];for(const P of d)if((b&P)===P){const b=this._Levels[P];G[b.name]=G._LogEnabled.bind(G,P)}}}G.NoneLogLevel=0,G.MessageLogLevel=1,G.WarningLogLevel=2,G.ErrorLogLevel=4,G.AllLogLevel=7,G.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",G._LogCache="",G._LogLimitOutputs={},G._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],G.errorsCount=0,G.Log=G._LogEnabled.bind(G,G.MessageLogLevel),G.Warn=G._LogEnabled.bind(G,G.WarningLogLevel),G.Error=G._LogEnabled.bind(G,G.ErrorLogLevel)},11487:(b,d,P)=>{P.d(d,{d:()=>q});const G="undefined"!==typeof WeakRef;class W{constructor(b){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],P=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0;this.initialize(b,d,P,G)}initialize(b){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],P=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0;return this.mask=b,this.skipNextObservers=d,this.target=P,this.currentTarget=G,this}}class i{constructor(b,d){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=b,this.mask=d,this.scope=P,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(b)}}class q{static FromPromise(b,d){const P=new q;return b.then((b=>{P.notifyObservers(b)})).catch((b=>{if(!d)throw b;d.notifyObservers(b)})),P}get observers(){return this._observers}constructor(b){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=d,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new W(0),b&&(this._onObserverAdded=b)}add(b){let d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],P=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!b)return null;const W=new i(b,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);W.unregisterOnNextCall=P,d?this._observers.unshift(W):this._observers.push(W),this._onObserverAdded&&this._onObserverAdded(W),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(W,this._lastNotifiedValue);const q=G?new WeakRef(this):{deref:()=>this};return W._remove=function(){let b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const d=q.deref();d&&(b?d.remove(W):d._remove(W))},W}addOnce(b){return this.add(b,void 0,void 0,void 0,!0)}remove(b){if(!b)return!1;b._remove=null;return-1!==this._observers.indexOf(b)&&(this._deferUnregister(b),!0)}removeCallback(b,d){for(let P=0;P<this._observers.length;P++){const G=this._observers[P];if(!G._willBeUnregistered&&(G.callback===b&&(!d||d===G.scope)))return this._deferUnregister(G),!0}return!1}_deferUnregister(b){b._willBeUnregistered||(this._numObserversMarkedAsDeleted++,b.unregisterOnNextCall=!1,b._willBeUnregistered=!0,setTimeout((()=>{this._remove(b)}),0))}_remove(b){let d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!b)return!1;const P=this._observers.indexOf(b);return-1!==P&&(d&&this._numObserversMarkedAsDeleted--,this._observers.splice(P,1),!0)}makeObserverTopPriority(b){this._remove(b,!1),this._observers.unshift(b)}makeObserverBottomPriority(b){this._remove(b,!1),this._observers.push(b)}notifyObservers(b){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,P=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=b),!this._observers.length)return!0;const i=this._eventState;i.mask=d,i.target=P,i.currentTarget=G,i.skipNextObservers=!1,i.lastReturnValue=b,i.userInfo=W;for(const q of this._observers)if(!q._willBeUnregistered&&(q.mask&d&&(q.unregisterOnNextCall&&this._deferUnregister(q),q.scope?i.lastReturnValue=q.callback.apply(q.scope,[b,i]):i.lastReturnValue=q.callback(b,i)),i.skipNextObservers))return!1;return!0}notifyObserver(b,d){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=d),b._willBeUnregistered)return;const G=this._eventState;G.mask=P,G.skipNextObservers=!1,b.unregisterOnNextCall&&this._deferUnregister(b),b.callback(d,G)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const b=this._observers.pop();b&&(b._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const b=new q;return b._observers=this._observers.slice(0),b}hasSpecificMask(){let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const d of this._observers)if(d.mask&b||d.mask===b)return!0;return!1}}},11569:(b,d,P)=>{P.d(d,{c:()=>W,e:()=>q});let G=[];class W{static SetImmediate(b){0===G.length&&setTimeout((()=>{const b=G;G=[];for(const d of b)d()}),1),G.push(b)}}function i(b,d,P){try{if(b())return d(),!0}catch(G){return null===P||void 0===P||P(G),!0}return!1}const q=function(b,d,P){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,q=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&i(b,d,P))return null;const C=setInterval((()=>{i(b,d,P)?clearInterval(C):(W-=G,W<0&&(clearInterval(C),null===P||void 0===P||P(new Error("Operation timed out after maximum retries. "+(q||"")),!0)))}),G);return()=>clearInterval(C)}}}]);