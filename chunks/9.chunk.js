"use strict";(self.h6ljd275xwr=self.h6ljd275xwr||[]).push([[9],{11173:(n,y,H)=>{H.d(y,{c:()=>c,g:()=>M,j:()=>f,h:()=>e,k:()=>w});class o{constructor(){this.children=[]}isValid(n){return!0}process(n,y,H){let o="";if(this.line){let H=this.line;const q=y.processor;if(q){var G,h,k,i,B,V;q.lineProcessor&&(H=q.lineProcessor(H,y.isFragment,y.processingContext));const o=(null===(G=y.processor)||void 0===G?void 0:G.attributeKeywordName)??"attribute",b=y.isFragment&&null!==(h=y.processor)&&void 0!==h&&h.varyingFragmentKeywordName?null===(k=y.processor)||void 0===k?void 0:k.varyingFragmentKeywordName:!y.isFragment&&null!==(i=y.processor)&&void 0!==i&&i.varyingVertexKeywordName?null===(B=y.processor)||void 0===B?void 0:B.varyingVertexKeywordName:"varying";if(!y.isFragment&&q.attributeProcessor&&this.line.startsWith(o))H=q.attributeProcessor(this.line,n,y.processingContext);else if(q.varyingProcessor&&(null!==(V=q.varyingCheck)&&void 0!==V&&V.call(q,this.line,y.isFragment)||!q.varyingCheck&&this.line.startsWith(b)))H=q.varyingProcessor(this.line,y.isFragment,n,y.processingContext);else if(q.uniformProcessor&&q.uniformRegexp&&q.uniformRegexp.test(this.line))y.lookForClosingBracketForUniformBuffer||(H=q.uniformProcessor(this.line,y.isFragment,n,y.processingContext));else if(q.uniformBufferProcessor&&q.uniformBufferRegexp&&q.uniformBufferRegexp.test(this.line))y.lookForClosingBracketForUniformBuffer||(H=q.uniformBufferProcessor(this.line,y.isFragment,y.processingContext),y.lookForClosingBracketForUniformBuffer=!0);else if(q.textureProcessor&&q.textureRegexp&&q.textureRegexp.test(this.line))H=q.textureProcessor(this.line,y.isFragment,n,y.processingContext);else if((q.uniformProcessor||q.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!y.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?q.uniformProcessor&&(H=q.uniformProcessor(this.line,y.isFragment,n,y.processingContext)):q.uniformBufferProcessor&&(H=q.uniformBufferProcessor(this.line,y.isFragment,y.processingContext),y.lookForClosingBracketForUniformBuffer=!0)}y.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(y.lookForClosingBracketForUniformBuffer=!1,q.endOfUniformBufferProcessor&&(H=q.endOfUniformBufferProcessor(this.line,y.isFragment,y.processingContext)))}o+=H+"\n"}for(const q of this.children)o+=q.process(n,y,H);return this.additionalDefineKey&&(n[this.additionalDefineKey]=this.additionalDefineValue||"true",H[this.additionalDefineKey]=n[this.additionalDefineKey]),o}}class G{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(n){this._lines.length=0;for(const y of n){if(!y||"\r"===y)continue;if("#"===y[0]){this._lines.push(y);continue}const n=y.trim();if(!n)continue;if(n.startsWith("//")){this._lines.push(y);continue}const H=n.indexOf(";");if(-1===H)this._lines.push(n);else if(H===n.length-1)n.length>1&&this._lines.push(n);else{const n=y.split(";");for(let y=0;y<n.length;y++){let H=n[y];H&&(H=H.trim(),H&&this._lines.push(H+(y!==n.length-1?";":"")))}}}}}class h extends o{process(n,y,H){for(let o=0;o<this.children.length;o++){const G=this.children[o];if(G.isValid(n))return G.process(n,y,H)}return""}}class k extends o{isValid(n){return this.testExpression.isTrue(n)}}class i{isTrue(n){return!0}static postfixToInfix(n){const y=[];for(const H of n)if(void 0===i._OperatorPriority[H])y.push(H);else{const n=y[y.length-1],o=y[y.length-2];y.length-=2,y.push(`(${o}${H}${n})`)}return y[y.length-1]}static infixToPostfix(n){const y=i._InfixToPostfixCache.get(n);if(y)return y.accessTime=Date.now(),y.result;if(!n.includes("&&")&&!n.includes("||")&&!n.includes(")")&&!n.includes("("))return[n];const H=[];let o=-1;const G=()=>{q=q.trim(),""!==q&&(H.push(q),q="")},h=n=>{o<i._Stack.length-1&&(i._Stack[++o]=n)},k=()=>i._Stack[o],B=()=>-1===o?"!!INVALID EXPRESSION!!":i._Stack[o--];let V=0,q="";for(;V<n.length;){const y=n.charAt(V),b=V<n.length-1?n.substring(V,2+V):"";if("("===y)q="",h(y);else if(")"===y){for(G();-1!==o&&"("!==k();)H.push(B());B()}else if(i._OperatorPriority[b]>1){for(G();-1!==o&&i._OperatorPriority[k()]>=i._OperatorPriority[b];)H.push(B());h(b),V++}else q+=y;V++}for(G();-1!==o;)"("===k()?B():H.push(B());return i._InfixToPostfixCache.size>=i.InfixToPostfixCacheLimitSize&&i.ClearCache(),i._InfixToPostfixCache.set(n,{result:H,accessTime:Date.now()}),H}static ClearCache(){const n=Array.from(i._InfixToPostfixCache.entries()).sort(((n,y)=>n[1].accessTime-y[1].accessTime));for(let y=0;y<i.InfixToPostfixCacheCleanupSize;y++)i._InfixToPostfixCache.delete(n[y][0])}}i.InfixToPostfixCacheLimitSize=5e4,i.InfixToPostfixCacheCleanupSize=25e3,i._InfixToPostfixCache=new Map,i._OperatorPriority={")":0,"(":1,"||":2,"&&":3},i._Stack=["","","","","","","","","","","","","","","","","","","",""];class B extends i{constructor(n){let y=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=n,this.not=y}isTrue(n){let y=void 0!==n[this.define];return this.not&&(y=!y),y}}class V extends i{isTrue(n){return this.leftOperand.isTrue(n)||this.rightOperand.isTrue(n)}}class q extends i{isTrue(n){return this.leftOperand.isTrue(n)&&this.rightOperand.isTrue(n)}}class b extends i{constructor(n,y,H){super(),this.define=n,this.operand=y,this.testValue=H}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(n){let y=!1;const H=parseInt(void 0!=n[this.define]?n[this.define]:this.define),o=parseInt(void 0!=n[this.testValue]?n[this.testValue]:this.testValue);if(isNaN(H)||isNaN(o))return!1;switch(this.operand){case">":y=H>o;break;case"<":y=H<o;break;case"<=":y=H<=o;break;case">=":y=H>=o;break;case"==":y=H===o;break;case"!=":y=H!==o}return y}}var A=H(11134),U=H(11176);const T=/defined\s*?\((.+?)\)/g,W=/defined\s*?\[(.+?)\]/g,z=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,Q=/__decl__/,l=/light\{X\}.(\w*)/g,v=/\{X\}/g,F=[],g=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function M(n){n.processor&&n.processor.initializeShaders&&n.processor.initializeShaders(n.processingContext)}function f(n,y,H,o){var G;null!==(G=y.processor)&&void 0!==G&&G.preProcessShaderCode&&(n=y.processor.preProcessShaderCode(n,y.isFragment)),e(n,y,(n=>{y.processCodeAfterIncludes&&(n=y.processCodeAfterIncludes(y.isFragment?"fragment":"vertex",n,y.defines));const G=function(n,y,H){let o=function(n,y){var H;if(null!==(H=y.processor)&&void 0!==H&&H.noPrecision)return n;const o=y.shouldUseHighPrecisionShader;-1===n.indexOf("precision highp float")?n=o?"precision highp float;\n"+n:"precision mediump float;\n"+n:o||(n=n.replace("precision highp float","precision mediump float"));return n}(n,y);if(!y.processor)return o;if(0===y.processor.shaderLanguage&&-1!==o.indexOf("#version 3")&&(o=o.replace("#version 300 es",""),!y.processor.parseGLES3))return o;const G=y.defines,h=O(y,H);y.processor.preProcessor&&(o=y.processor.preProcessor(o,G,h,y.isFragment,y.processingContext));const k={};o=a(o,h,y,k),y.processor.postProcessor&&(o=y.processor.postProcessor(o,G,y.isFragment,y.processingContext,H?{drawBuffersExtensionDisabled:!H.getCaps().drawBuffersExtension}:{},h,k));null!==H&&void 0!==H&&H._features.needShaderCodeInlining&&(o=H.inlineShaderCode(o));return o}(n,y,o);H(G,n)}))}function c(n,y,H){return H.processor&&H.processor.finalizeShaders?H.processor.finalizeShaders(n,y,H.processingContext):{vertexCode:n,fragmentCode:y}}function p(n){const y=/defined\((.+)\)/.exec(n);if(y&&y.length)return new B(y[1].trim(),"!"===n[0]);const H=["==","!=",">=","<=","<",">"];let o="",G=0;for(o of H)if(G=n.indexOf(o),G>-1)break;if(-1===G)return new B(n);const h=n.substring(0,G).trim(),k=n.substring(G+o.length).trim();return new b(h,o,k)}function E(n,y){const H=new k,o=n.substring(0,y);let G=n.substring(y);return G=G.substring(0,(G.indexOf("//")+1||G.length+1)-1).trim(),H.testExpression="#ifdef"===o?new B(G):"#ifndef"===o?new B(G,!0):function(n){n=n.replace(T,"defined[$1]");const y=i.infixToPostfix(n),H=[];for(const G of y)if("||"!==G&&"&&"!==G)H.push(G);else if(H.length>=2){let n=H[H.length-1],y=H[H.length-2];H.length-=2;const o="&&"==G?new q:new V;"string"===typeof n&&(n=n.replace(W,"defined($1)")),"string"===typeof y&&(y=y.replace(W,"defined($1)")),o.leftOperand="string"===typeof y?p(y):y,o.rightOperand="string"===typeof n?p(n):n,H.push(o)}let o=H[H.length-1];return"string"===typeof o&&(o=o.replace(W,"defined($1)")),"string"===typeof o?p(o):o}(G),H}function X(n,y,H,G){let h=n.currentLine;for(;d(n,H,G);){h=n.currentLine;const k=h.substring(0,5).toLowerCase();if("#else"===k){const H=new o;return y.children.push(H),void d(n,H,G)}if("#elif"===k){const n=E(h,5);y.children.push(n),H=n}}}function d(n,y,H){for(;n.canRead;){n.lineIndex++;const G=n.currentLine;if(G.indexOf("#")>=0){const o=g.exec(G);if(o&&o.length){switch(o[0]){case"#ifdef":{const o=new h;y.children.push(o);const k=E(G,6);o.children.push(k),X(n,o,k,H);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const o=new h;y.children.push(o);const k=E(G,7);o.children.push(k),X(n,o,k,H);break}case"#if":{const o=new h,k=E(G,3);y.children.push(o),o.children.push(k),X(n,o,k,H);break}}continue}}const k=new o;if(k.line=G,y.children.push(k),"#"===G[0]&&"d"===G[1]){const n=G.replace(";","").split(" ");k.additionalDefineKey=n[1],3===n.length&&(k.additionalDefineValue=n[2])}}return!1}function a(n,y,H,h){const k=new o,i=new G;return i.lineIndex=-1,i.lines=n.split("\n"),d(i,k,h),k.process(y,H,h)}function O(n,y){var H;const o=n.defines,G={};for(const h of o){const n=h.replace("#define","").replace(";","").trim().split(" ");G[n[0]]=n.length>1?n[1]:""}return 0===(null===(H=n.processor)||void 0===H?void 0:H.shaderLanguage)&&(G.GL_ES="true"),G.__VERSION__=n.version,G[n.platformName]="true",(0,U.i)(G,null===y||void 0===y?void 0:y.isNDCHalfZRange,null===y||void 0===y?void 0:y.useReverseDepthBuffer,null===y||void 0===y?void 0:y.useExactSrgbConversions),G}function e(n,y,H){let o;for(F.length=0;null!==(o=z.exec(n));)F.push(o);let G=String(n),h=[n],k=!1;for(const i of F){let n=i[1];if(-1!==n.indexOf("__decl__")&&(n=n.replace(Q,""),y.supportsUniformBuffers&&(n=n.replace("Vertex","Ubo").replace("Fragment","Ubo")),n+="Declaration"),!y.includesShadersStore[n]){const o=y.shadersRepository+"ShadersInclude/"+n+".fx";return void w.loadFile(o,(o=>{y.includesShadersStore[n]=o,e(h.join(""),y,H)}))}{let H=y.includesShadersStore[n];if(i[2]){const n=i[3].split(",");for(let y=0;y<n.length;y+=2){const o=new RegExp(n[y],"g"),G=n[y+1];H=H.replace(o,G)}}if(i[4]){const n=i[5];if(-1!==n.indexOf("..")){const o=n.split(".."),G=parseInt(o[0]);let h=parseInt(o[1]),k=H.slice(0);H="",isNaN(h)&&(h=y.indexParameters[o[1]]);for(let n=G;n<h;n++)y.supportsUniformBuffers||(k=k.replace(l,((n,y)=>y+"{X}"))),H+=k.replace(v,n.toString())+"\n"}else y.supportsUniformBuffers||(H=H.replace(l,((n,y)=>y+"{X}"))),H=H.replace(v,n)}const o=[];for(const n of h){const y=n.split(i[0]);for(let n=0;n<y.length-1;n++)o.push(y[n]),o.push(H);o.push(y[y.length-1])}h=o,k=k||H.indexOf("#include<")>=0||H.indexOf("#include <")>=0}}F.length=0,G=h.join(""),k?e(G.toString(),y,H):H(G)}const w={loadFile:(n,y,H,o,G,h)=>{throw(0,A.c)("FileTools")}}},11176:(n,y,H)=>{H.d(y,{e:()=>G,h:()=>h,i:()=>i,l:()=>k,p:()=>B});var o=H(11134);H(11107);const G={};function h(n,y){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(y?y+"\n":"")+n}function k(n,y,H,h,k,i,B){const V=B||G.loadFile;if(V){return V(n,y,H,h,k,i)}throw(0,o.c)("FileTools")}function i(n,y,H,o){if(n)return y?n.IS_NDC_HALF_ZRANGE="":delete n.IS_NDC_HALF_ZRANGE,H?n.USE_REVERSE_DEPTHBUFFER="":delete n.USE_REVERSE_DEPTHBUFFER,void(o?n.USE_EXACT_SRGB_CONVERSIONS="":delete n.USE_EXACT_SRGB_CONVERSIONS);{let n="";return y&&(n+="#define IS_NDC_HALF_ZRANGE"),H&&(n&&(n+="\n"),n+="#define USE_REVERSE_DEPTHBUFFER"),o&&(n&&(n+="\n"),n+="#define USE_EXACT_SRGB_CONVERSIONS"),n}}function B(n,y){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;switch(n){case 3:{const n=(ArrayBuffer,new Int8Array(y));return o&&n.set(new Int8Array(o)),n}case 0:{const n=(ArrayBuffer,new Uint8Array(y));return o&&n.set(new Uint8Array(o)),n}case 4:{const n=y instanceof ArrayBuffer?new Int16Array(y):new Int16Array(H?y/2:y);return o&&n.set(new Int16Array(o)),n}case 5:case 8:case 9:case 10:case 2:{const n=y instanceof ArrayBuffer?new Uint16Array(y):new Uint16Array(H?y/2:y);return o&&n.set(new Uint16Array(o)),n}case 6:{const n=y instanceof ArrayBuffer?new Int32Array(y):new Int32Array(H?y/4:y);return o&&n.set(new Int32Array(o)),n}case 7:case 11:case 12:case 13:case 14:case 15:{const n=y instanceof ArrayBuffer?new Uint32Array(y):new Uint32Array(H?y/4:y);return o&&n.set(new Uint32Array(o)),n}case 1:{const n=y instanceof ArrayBuffer?new Float32Array(y):new Float32Array(H?y/4:y);return o&&n.set(new Float32Array(o)),n}}const G=(ArrayBuffer,new Uint8Array(y));return o&&G.set(new Uint8Array(o)),G}},11202:(n,y,H)=>{H.d(y,{e:()=>o});class o{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?o.ShadersRepository:o.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?o.ShadersStore:o.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?o.IncludesShadersStore:o.IncludesShadersStoreWGSL}}o.ShadersRepository="src/Shaders/",o.ShadersStore={},o.IncludesShadersStore={},o.ShadersRepositoryWGSL="src/ShadersWGSL/",o.ShadersStoreWGSL={},o.IncludesShadersStoreWGSL={}},11219:(n,y,H)=>{H.d(y,{b:()=>A,d:()=>v,f:()=>T,j:()=>U,l:()=>W,n:()=>l,p:()=>b,t:()=>V,v:()=>q,w:()=>B,z:()=>i});class o{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Wy._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(n){n&&this.program&&n(this.program)}setEngine(n){this.Wy=n}_fillEffectInformation(n,y,H,o,G,h,k,i){const B=this.Wy;if(B.supportsUniformBuffers)for(const q in y)n.bindUniformBlock(q,y[q]);let V;for(this.Wy.getUniforms(this,H).forEach(((n,y)=>{o[H[y]]=n})),this._uniforms=o,V=0;V<G.length;V++){null==n.getUniform(G[V])&&(G.splice(V,1),V--)}G.forEach(((n,y)=>{h[n]=y}));for(const q of B.getAttributes(this,k))i.push(q)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(n,y){const H=this._valueCache[n],o=y.updateFlag;return(void 0===H||H!==o)&&(this._valueCache[n]=o,!0)}_cacheFloat2(n,y,H){let o=this._valueCache[n];if(!o||2!==o.length)return o=[y,H],this._valueCache[n]=o,!0;let G=!1;return o[0]!==y&&(o[0]=y,G=!0),o[1]!==H&&(o[1]=H,G=!0),G}_cacheFloat3(n,y,H,o){let G=this._valueCache[n];if(!G||3!==G.length)return G=[y,H,o],this._valueCache[n]=G,!0;let h=!1;return G[0]!==y&&(G[0]=y,h=!0),G[1]!==H&&(G[1]=H,h=!0),G[2]!==o&&(G[2]=o,h=!0),h}_cacheFloat4(n,y,H,o,G){let h=this._valueCache[n];if(!h||4!==h.length)return h=[y,H,o,G],this._valueCache[n]=h,!0;let k=!1;return h[0]!==y&&(h[0]=y,k=!0),h[1]!==H&&(h[1]=H,k=!0),h[2]!==o&&(h[2]=o,k=!0),h[3]!==G&&(h[3]=G,k=!0),k}setInt(n,y){const H=this._valueCache[n];void 0!==H&&H===y||this.Wy.setInt(this._uniforms[n],y)&&(this._valueCache[n]=y)}setInt2(n,y,H){this._cacheFloat2(n,y,H)&&(this.Wy.setInt2(this._uniforms[n],y,H)||(this._valueCache[n]=null))}setInt3(n,y,H,o){this._cacheFloat3(n,y,H,o)&&(this.Wy.setInt3(this._uniforms[n],y,H,o)||(this._valueCache[n]=null))}setInt4(n,y,H,o,G){this._cacheFloat4(n,y,H,o,G)&&(this.Wy.setInt4(this._uniforms[n],y,H,o,G)||(this._valueCache[n]=null))}setIntArray(n,y){this._valueCache[n]=null,this.Wy.setIntArray(this._uniforms[n],y)}setIntArray2(n,y){this._valueCache[n]=null,this.Wy.setIntArray2(this._uniforms[n],y)}setIntArray3(n,y){this._valueCache[n]=null,this.Wy.setIntArray3(this._uniforms[n],y)}setIntArray4(n,y){this._valueCache[n]=null,this.Wy.setIntArray4(this._uniforms[n],y)}setUInt(n,y){const H=this._valueCache[n];void 0!==H&&H===y||this.Wy.setUInt(this._uniforms[n],y)&&(this._valueCache[n]=y)}setUInt2(n,y,H){this._cacheFloat2(n,y,H)&&(this.Wy.setUInt2(this._uniforms[n],y,H)||(this._valueCache[n]=null))}setUInt3(n,y,H,o){this._cacheFloat3(n,y,H,o)&&(this.Wy.setUInt3(this._uniforms[n],y,H,o)||(this._valueCache[n]=null))}setUInt4(n,y,H,o,G){this._cacheFloat4(n,y,H,o,G)&&(this.Wy.setUInt4(this._uniforms[n],y,H,o,G)||(this._valueCache[n]=null))}setUIntArray(n,y){this._valueCache[n]=null,this.Wy.setUIntArray(this._uniforms[n],y)}setUIntArray2(n,y){this._valueCache[n]=null,this.Wy.setUIntArray2(this._uniforms[n],y)}setUIntArray3(n,y){this._valueCache[n]=null,this.Wy.setUIntArray3(this._uniforms[n],y)}setUIntArray4(n,y){this._valueCache[n]=null,this.Wy.setUIntArray4(this._uniforms[n],y)}setArray(n,y){this._valueCache[n]=null,this.Wy.setArray(this._uniforms[n],y)}setArray2(n,y){this._valueCache[n]=null,this.Wy.setArray2(this._uniforms[n],y)}setArray3(n,y){this._valueCache[n]=null,this.Wy.setArray3(this._uniforms[n],y)}setArray4(n,y){this._valueCache[n]=null,this.Wy.setArray4(this._uniforms[n],y)}setMatrices(n,y){y&&(this._valueCache[n]=null,this.Wy.setMatrices(this._uniforms[n],y))}setMatrix(n,y){this._cacheMatrix(n,y)&&(this.Wy.setMatrices(this._uniforms[n],y.Ui())||(this._valueCache[n]=null))}setMatrix3x3(n,y){this._valueCache[n]=null,this.Wy.setMatrix3x3(this._uniforms[n],y)}setMatrix2x2(n,y){this._valueCache[n]=null,this.Wy.setMatrix2x2(this._uniforms[n],y)}setFloat(n,y){const H=this._valueCache[n];void 0!==H&&H===y||this.Wy.setFloat(this._uniforms[n],y)&&(this._valueCache[n]=y)}setVector2(n,y){this._cacheFloat2(n,y.x,y.y)&&(this.Wy.setFloat2(this._uniforms[n],y.x,y.y)||(this._valueCache[n]=null))}setFloat2(n,y,H){this._cacheFloat2(n,y,H)&&(this.Wy.setFloat2(this._uniforms[n],y,H)||(this._valueCache[n]=null))}setVector3(n,y){this._cacheFloat3(n,y.x,y.y,y.z)&&(this.Wy.setFloat3(this._uniforms[n],y.x,y.y,y.z)||(this._valueCache[n]=null))}setFloat3(n,y,H,o){this._cacheFloat3(n,y,H,o)&&(this.Wy.setFloat3(this._uniforms[n],y,H,o)||(this._valueCache[n]=null))}setVector4(n,y){this._cacheFloat4(n,y.x,y.y,y.z,y.w)&&(this.Wy.setFloat4(this._uniforms[n],y.x,y.y,y.z,y.w)||(this._valueCache[n]=null))}setQuaternion(n,y){this._cacheFloat4(n,y.x,y.y,y.z,y.w)&&(this.Wy.setFloat4(this._uniforms[n],y.x,y.y,y.z,y.w)||(this._valueCache[n]=null))}setFloat4(n,y,H,o,G){this._cacheFloat4(n,y,H,o,G)&&(this.Wy.setFloat4(this._uniforms[n],y,H,o,G)||(this._valueCache[n]=null))}setColor3(n,y){this._cacheFloat3(n,y.r,y.g,y.b)&&(this.Wy.setFloat3(this._uniforms[n],y.r,y.g,y.b)||(this._valueCache[n]=null))}setColor4(n,y,H){this._cacheFloat4(n,y.r,y.g,y.b,H)&&(this.Wy.setFloat4(this._uniforms[n],y.r,y.g,y.b,H)||(this._valueCache[n]=null))}setDirectColor4(n,y){this._cacheFloat4(n,y.r,y.g,y.b,y.a)&&(this.Wy.setFloat4(this._uniforms[n],y.r,y.g,y.b,y.a)||(this._valueCache[n]=null))}_getVertexShaderCode(){return this.vertexShader?this.Wy._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Wy._getShaderSource(this.fragmentShader):null}}var G=H(11176);const h=new WeakMap,k={_webGLVersion:2,cachedPipelines:{}};function i(n){let y=h.get(n);if(!y){if(!n)return k;y={_webGLVersion:n.TEXTURE_BINDING_3D?2:1,_context:n,parallelShaderCompile:n.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},h.set(n,y)}return y}function B(n){h.delete(n)}function V(n,y,H,o,G,h){const k=i(o);h||(h=k._createShaderProgramInjection??A);return h(n,Q(y,"vertex",o,k._contextWasLost),Q(H,"fragment",o,k._contextWasLost),o,G,k.validateShaderPrograms)}function q(n,y,H,o,G){let h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,k=arguments.length>6?arguments[6]:void 0;const B=i(G);k||(k=B._createShaderProgramInjection??A);const V=B._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return k(n,z(y,"vertex",o,V,G,B._contextWasLost),z(H,"fragment",o,V,G,B._contextWasLost),G,h,B.validateShaderPrograms)}function b(n,y){const H=new o,G=i(n);return G.parallelShaderCompile&&!G.disableParallelShaderCompile&&(H.isParallelCompiled=!0),H.context=G._context,H}function A(n,y,H,o){let G=arguments.length>5?arguments[5]:void 0;const h=o.createProgram();if(n.program=h,!h)throw new Error("Unable to create program");return o.attachShader(h,y),o.attachShader(h,H),o.linkProgram(h),n.context=o,n.vertexShader=y,n.fragmentShader=H,n.isParallelCompiled||T(n,o,G),h}function U(n,y,H){const o=n;if(o._isDisposed)return!1;const G=i(y);return!!(G&&G.parallelShaderCompile&&G.parallelShaderCompile.COMPLETION_STATUS_KHR&&o.program&&y.getProgramParameter(o.program,G.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(T(o,y,H),!0)}function T(n,y,H){const o=n.context,G=n.vertexShader,h=n.fragmentShader,k=n.program;if(!o.getProgramParameter(k,o.LINK_STATUS)){if(!y.getShaderParameter(G,y.COMPILE_STATUS)){const H=y.getShaderInfoLog(G);if(H)throw n.vertexCompilationError=H,new Error("VERTEX SHADER "+H)}if(!y.getShaderParameter(h,y.COMPILE_STATUS)){const H=y.getShaderInfoLog(h);if(H)throw n.fragmentCompilationError=H,new Error("FRAGMENT SHADER "+H)}const H=o.getProgramInfoLog(k);if(H)throw n.programLinkError=H,new Error(H)}if(H){o.validateProgram(k);if(!o.getProgramParameter(k,o.VALIDATE_STATUS)){const y=o.getProgramInfoLog(k);if(y)throw n.programValidationError=y,new Error(y)}}o.deleteShader(G),o.deleteShader(h),n.vertexShader=void 0,n.fragmentShader=void 0,n.onCompiled&&(n.onCompiled(),n.onCompiled=void 0)}function W(n,y,H,o,G,h,k,B,b){let A=arguments.length>10?arguments[10]:void 0,U=arguments.length>11?arguments[11]:void 0,T=arguments.length>12?arguments[12]:void 0;const W=i(n.context);U||(U=W.createRawShaderProgramInjection??V),T||(T=W.createShaderProgramInjection??q);const z=n;z.program=o?U(z,y,H,z.context,b):T(z,y,H,B,z.context,b),z.program.__SPECTOR_rebuildProgram=k,A()}function z(n,y,H,o,h,k){return Q((0,G.h)(n,H,o),y,h,k)}function Q(n,y,H,o){const G=H.createShader("vertex"===y?H.VERTEX_SHADER:H.FRAGMENT_SHADER);if(!G){let n=H.NO_ERROR,G=H.NO_ERROR;for(;(G=H.getError())!==H.NO_ERROR;)n=G;throw new Error(`Something went wrong while creating a gl ${y} shader object. gl error=${n}, gl isContextLost=${H.isContextLost()}, _contextWasLost=${o}`)}return H.shaderSource(G,n),H.compileShader(G),G}function l(n,y){y.useProgram(n)}function v(n,y){const H=n;if(!H.isParallelCompiled)return void y(n);const o=H.onCompiled;H.onCompiled=()=>{null===o||void 0===o||o(),y(n)}}},11210:(n,y,H)=>{H.d(y,{d:()=>b,g:()=>U,j:()=>V,k:()=>q});var o=H(11107),G=H(11219),h=H(11202),k=H(11114),i=H(11173),B=H(11176);function V(n,y){return(0,G.z)(y).cachedPipelines[n]}function q(n){const y=n._name,H=n.context;if(y&&H){const n=(0,G.z)(H),o=n.cachedPipelines[y];null===o||void 0===o||o.dispose(),delete n.cachedPipelines[y]}}function b(n,y,H,G,h,k,B){let V,q;const b=(0,o.p)()?null===k||void 0===k?void 0:k.getHostDocument():null;V="string"===typeof y?y:y.vertexSource?"source:"+y.vertexSource:y.vertexElement?(null===b||void 0===b?void 0:b.getElementById(y.vertexElement))||y.vertexElement:y.vertex||y,q="string"===typeof y?y:y.fragmentSource?"source:"+y.fragmentSource:y.fragmentElement?(null===b||void 0===b?void 0:b.getElementById(y.fragmentElement))||y.fragmentElement:y.fragment||y;const U=[void 0,void 0],T=()=>{if(U[0]&&U[1]){n.isFragment=!0;const[o,V]=U;(0,i.j)(V,n,((k,V)=>{B&&(B._fragmentSourceCodeBeforeMigration=V),H&&(k=H("fragment",k));const q=(0,i.c)(o,k,n);n=null;const b=function(n,y,H,o){if(H){return{vertexSourceCode:(1===o?"//":"")+"#define SHADER_NAME vertex:"+(H.vertexElement||H.vertex||H.spectorName||H)+"\n"+n,fragmentSourceCode:(1===o?"//":"")+"#define SHADER_NAME fragment:"+(H.fragmentElement||H.fragment||H.spectorName||H)+"\n"+y}}return{vertexSourceCode:n,fragmentSourceCode:y}}(q.vertexCode,q.fragmentCode,y,h);null===G||void 0===G||G(b.vertexSourceCode,b.fragmentSourceCode)}),k)}};A(V,"Vertex","",(y=>{(0,i.g)(n),(0,i.j)(y,n,((n,o)=>{B&&(B._rawVertexSourceCode=y,B._vertexSourceCodeBeforeMigration=o),H&&(n=H("vertex",n)),U[0]=n,T()}),k)}),h),A(q,"Fragment","Pixel",(n=>{B&&(B._rawFragmentSourceCode=n),U[1]=n,T()}),h)}function A(n,y,H,G,k,i){if("undefined"!==typeof HTMLElement&&n instanceof HTMLElement){return void G((0,o.e)(n))}if("source:"===n.substring(0,7))return void G(n.substring(7));if("base64:"===n.substring(0,7)){return void G(window.atob(n.substring(7)))}const V=h.e.GetShadersStore(k);if(V[n+y+"Shader"])return void G(V[n+y+"Shader"]);if(H&&V[n+H+"Shader"])return void G(V[n+H+"Shader"]);let q;if(q="."===n[0]||"/"===n[0]||n.indexOf("http")>-1?n:h.e.GetShadersRepository(k)+n,!(i=i||B.l))throw new Error("loadFileInjection is not defined");i(q+"."+y.toLowerCase()+".fx",G)}const U=(n,y,H,o)=>{try{const h=n.context?(0,G.z)(n.context):null;h&&(h.disableParallelShaderCompile=n.disableParallelCompilation);const k=n.existingPipelineContext||y(n.shaderProcessingContext);return k._name=n.name,n.name&&h&&(h.cachedPipelines[n.name]=k),H(k,n.vertex,n.fragment,!!n.createAsRaw,"","",n.rebuildRebind,n.defines,n.transformFeedbackVaryings,"",(()=>{o(k,(()=>{var y;null===(y=n.onRenderingStateCompiled)||void 0===y||y.call(n,k)}))})),k}catch(h){throw k.d.Error("Error compiling effect"),h}}},11195:(n,y,H)=>{H.r(y),H.d(y,{Effect:()=>B});var o=H(11099),G=H(11114),h=H(11202),k=H(11210),i=H(11185);class B{static get ShadersRepository(){return h.e.ShadersRepository}static set ShadersRepository(n){h.e.ShadersRepository=n}get A(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new o.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(n,y,H){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,h=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,V=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,q=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,b=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,A=arguments.length>9?arguments[9]:void 0,U=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",T=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,W=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new o.c,this.onErrorObservable=new o.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=n,this._key=U;const z=this._key.replace(/\r/g,"").replace(/\n/g,"|");let Q;if(y.attributes){const n=y;if(this._engine=H,this._attributesNames=n.attributes,this._uniformsNames=n.uniformsNames.concat(n.samplers),this._samplerList=n.samplers.slice(),this.defines=n.defines,this.onError=n.onError,this.onCompiled=n.onCompiled,this._fallbacks=n.fallbacks,this._indexParameters=n.indexParameters,this._transformFeedbackVaryings=n.transformFeedbackVaryings||null,this._multiTarget=!!n.multiTarget,this._shaderLanguage=n.shaderLanguage??0,this._disableParallelShaderCompilation=!!n.disableParallelShaderCompilation,n.uniformBuffersNames){this._uniformBuffersNamesList=n.uniformBuffersNames.slice();for(let y=0;y<n.uniformBuffersNames.length;y++)this._uniformBuffersNames[n.uniformBuffersNames[y]]=y}this._processFinalCode=n.processFinalCode??null,this._processCodeAfterIncludes=n.processCodeAfterIncludes??void 0,W=n.extraInitializationsAsync,Q=n.existingPipelineContext}else this._engine=h,this.defines=null==i?"":i,this._uniformsNames=H.concat(G),this._samplerList=G?G.slice():[],this._attributesNames=y,this._uniformBuffersNamesList=[],this._shaderLanguage=T,this.onError=b,this.onCompiled=q,this._indexParameters=A,this._fallbacks=V;"WEBGL2"===this._engine.shaderPlatformName&&(Q=(0,k.j)(z,this._engine._gl)??Q),this._attributeLocationByName={},this.uniqueId=B._UniqueIdSeed++,Q?(this._pipelineContext=Q,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,W),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.A||this.dispose(!0)}))}async _processShaderCodeAsync(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,y=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;o&&await o(),this._processingContext=H||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const G={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:n??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:h.e.GetShadersRepository(this._shaderLanguage),includesShadersStore:h.e.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,k.d)(G,this.name,this._processFinalCode,((n,H)=>{this._vertexSourceCode=n,this._fragmentSourceCode=H,this._prepareEffect(y)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.A||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(n){return this._attributes[n]}getAttributeLocationByName(n){return this._attributeLocationByName[n]}getAttributesCount(){return this._attributes.length}getUniformIndex(n){return this._uniformsNames.indexOf(n)}getUniform(n){return this._uniforms[n]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((n=>{this.executeWhenCompiled(n)}))}executeWhenCompiled(n){this.isReady()?n(this):(this.onCompileObservable.add((y=>{n(y)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(n){(0,i.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(y=>{this._processCompilationErrors(y,n)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var n;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(n=this._pipelineContext)||void 0===n?void 0:n._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var n;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(n=this._pipelineContext)||void 0===n?void 0:n._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(n,y,H,o){this._isReady=!1,this._vertexSourceCodeOverride=n,this._fragmentSourceCodeOverride=y,this.onError=(n,y)=>{o&&o(y)},this.onCompiled=()=>{var n,y;const o=this.getEngine().scenes;if(o)for(let H=0;H<o.length;H++)o[H].markAllMaterialsAsDirty(127);null===(n=(y=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===n||n.call(y,H)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(n){if(this._pipelineContext=n,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let y=0;y<this._attributesNames.length;y++){const n=this._attributesNames[y];this._attributeLocationByName[n]=this._attributes[y]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),B.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const y=this._pipelineContext;this._isReady=!1;try{const H=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),o=H?null:this.defines,G=H?this._vertexSourceCodeOverride:this._vertexSourceCode,h=H?this._fragmentSourceCodeOverride:this._fragmentSourceCode,i=this._engine;this._pipelineContext=(0,k.g)({existingPipelineContext:n?y:null,vertex:G,fragment:h,context:"WEBGL2"===i.shaderPlatformName||"WEBGL1"===i.shaderPlatformName?i._gl:void 0,rebuildRebind:(n,y,H,o)=>this._rebuildProgram(n,y,H,o),defines:o,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:H,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:H=>{y&&!n&&this._engine._deletePipelineContext(y),H&&this._onRenderingStateCompiled(H)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(y)}catch(H){this._processCompilationErrors(H,y)}}_getShaderCodeAndErrorLine(n,y,H){const o=H?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let G=null;if(y&&n){const h=y.match(o);if(h&&2===h.length){const y=parseInt(h[1]),o=n.split("\n",-1);o.length>=y&&(G=`Offending line [${y}] in ${H?"fragment":"vertex"} code: ${o[y-1]}`)}}return[n,G]}_processCompilationErrors(n){let y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=n.message;const H=this._attributesNames,o=this._fallbacks;if(G.d.Error("Unable to compile effect:"),G.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),G.d.Error(`Attributes: ${H.join(" ")}`),G.d.Error("Defines:\n"+this.defines),B.LogShaderCodeOnCompilationError){var h,k;let n=null,y=null,H=null;var i;if(null!==(h=this._pipelineContext)&&void 0!==h&&h._getVertexShaderCode()&&([H,n]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),H&&(G.d.Error("Vertex code:"),G.d.Error(H))),null!==(k=this._pipelineContext)&&void 0!==k&&k._getFragmentShaderCode())[H,y]=this._getShaderCodeAndErrorLine(null===(i=this._pipelineContext)||void 0===i?void 0:i._getFragmentShaderCode(),this._compilationError,!0),H&&(G.d.Error("Fragment code:"),G.d.Error(H));n&&G.d.Error(n),y&&G.d.Error(y)}G.d.Error("Error: "+this._compilationError);const V=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};y&&(this._pipelineContext=y,this._isReady=!0,V()),o?(this._pipelineContext=null,o.hasMoreFallbacks?(this._allFallbacksProcessed=!1,G.d.Error("Trying next fallback."),this.defines=o.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,V(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,y||V())}get isSupported(){return""===this._compilationError}_bindTexture(n,y){this._engine._bindTexture(this._samplers[n],y,n)}setTexture(n,y){this._engine.setTexture(this._samplers[n],this._uniforms[n],y,n)}setTextureArray(n,y){const H=n+"Ex";if(-1===this._samplerList.indexOf(H+"0")){const o=this._samplerList.indexOf(n);for(let n=1;n<y.length;n++){const y=H+(n-1).toString();this._samplerList.splice(o+n,0,y)}let G=0;for(const n of this._samplerList)this._samplers[n]=G,G+=1}this._engine.setTextureArray(this._samplers[n],this._uniforms[n],y,n)}bindUniformBuffer(n,y){const H=this._uniformBuffersNames[y];void 0===H||B._BaseCache[H]===n&&this._engine._features.useUBOBindingCache||(B._BaseCache[H]=n,this._engine.bindUniformBufferBase(n,H,y))}bindUniformBlock(n,y){this._engine.bindUniformBlock(this._pipelineContext,n,y)}setInt(n,y){return this._pipelineContext.setInt(n,y),this}setInt2(n,y,H){return this._pipelineContext.setInt2(n,y,H),this}setInt3(n,y,H,o){return this._pipelineContext.setInt3(n,y,H,o),this}setInt4(n,y,H,o,G){return this._pipelineContext.setInt4(n,y,H,o,G),this}setIntArray(n,y){return this._pipelineContext.setIntArray(n,y),this}setIntArray2(n,y){return this._pipelineContext.setIntArray2(n,y),this}setIntArray3(n,y){return this._pipelineContext.setIntArray3(n,y),this}setIntArray4(n,y){return this._pipelineContext.setIntArray4(n,y),this}setUInt(n,y){return this._pipelineContext.setUInt(n,y),this}setUInt2(n,y,H){return this._pipelineContext.setUInt2(n,y,H),this}setUInt3(n,y,H,o){return this._pipelineContext.setUInt3(n,y,H,o),this}setUInt4(n,y,H,o,G){return this._pipelineContext.setUInt4(n,y,H,o,G),this}setUIntArray(n,y){return this._pipelineContext.setUIntArray(n,y),this}setUIntArray2(n,y){return this._pipelineContext.setUIntArray2(n,y),this}setUIntArray3(n,y){return this._pipelineContext.setUIntArray3(n,y),this}setUIntArray4(n,y){return this._pipelineContext.setUIntArray4(n,y),this}setFloatArray(n,y){return this._pipelineContext.setArray(n,y),this}setFloatArray2(n,y){return this._pipelineContext.setArray2(n,y),this}setFloatArray3(n,y){return this._pipelineContext.setArray3(n,y),this}setFloatArray4(n,y){return this._pipelineContext.setArray4(n,y),this}setArray(n,y){return this._pipelineContext.setArray(n,y),this}setArray2(n,y){return this._pipelineContext.setArray2(n,y),this}setArray3(n,y){return this._pipelineContext.setArray3(n,y),this}setArray4(n,y){return this._pipelineContext.setArray4(n,y),this}setMatrices(n,y){return this._pipelineContext.setMatrices(n,y),this}setMatrix(n,y){return this._pipelineContext.setMatrix(n,y),this}setMatrix3x3(n,y){return this._pipelineContext.setMatrix3x3(n,y),this}setMatrix2x2(n,y){return this._pipelineContext.setMatrix2x2(n,y),this}setFloat(n,y){return this._pipelineContext.setFloat(n,y),this}setBool(n,y){return this._pipelineContext.setInt(n,y?1:0),this}setVector2(n,y){return this._pipelineContext.setVector2(n,y),this}setFloat2(n,y,H){return this._pipelineContext.setFloat2(n,y,H),this}setVector3(n,y){return this._pipelineContext.setVector3(n,y),this}setFloat3(n,y,H,o){return this._pipelineContext.setFloat3(n,y,H,o),this}setVector4(n,y){return this._pipelineContext.setVector4(n,y),this}setQuaternion(n,y){return this._pipelineContext.setQuaternion(n,y),this}setFloat4(n,y,H,o,G){return this._pipelineContext.setFloat4(n,y,H,o,G),this}setColor3(n,y){return this._pipelineContext.setColor3(n,y),this}setColor4(n,y,H){return this._pipelineContext.setColor4(n,y,H),this}setDirectColor4(n,y){return this._pipelineContext.setDirectColor4(n,y),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(B.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,k.k)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(n,y,H){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;y&&(h.e.GetShadersStore(o)[`${n}PixelShader`]=y),H&&(h.e.GetShadersStore(o)[`${n}VertexShader`]=H)}static ResetCache(){B._BaseCache={}}}B.LogShaderCodeOnCompilationError=!0,B.PersistentMode=!1,B.AutomaticallyClearCodeCache=!1,B._UniqueIdSeed=0,B._BaseCache={},B.ShadersStore=h.e.ShadersStore,B.IncludesShadersStore=h.e.IncludesShadersStore},11134:(n,y,H)=>{H.d(y,{c:()=>G});const o={};function G(n){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!o[n])return o[n]=!0,`${n} needs to be imported before as it contains a side-effect required by your code.`}},11107:(n,y,H)=>{function o(){return"undefined"!==typeof window}function G(){return"undefined"!==typeof navigator}function h(){return"undefined"!==typeof document}function k(n){let y="",H=n.firstChild;for(;H;)3===H.nodeType&&(y+=H.textContent),H=H.nextSibling;return y}H.d(y,{e:()=>k,i:()=>h,m:()=>G,p:()=>o})},11114:(n,y,H)=>{H.d(y,{d:()=>o});class o{static _CheckLimit(n,y){let H=o._LogLimitOutputs[n];return H?H.current++:(H={limit:y,current:1},o._LogLimitOutputs[n]=H),H.current<=H.limit}static _GenerateLimitMessage(n){let y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const H=o._LogLimitOutputs[n];if(!H||!o.MessageLimitReached)return;const G=this._Levels[y];H.current===H.limit&&o[G.name](o.MessageLimitReached.replace(/%LIMIT%/g,""+H.limit).replace(/%TYPE%/g,G.name??""))}static _AddLogEntry(n){o._LogCache=n+o._LogCache,o.OnNewCacheEntry&&o.OnNewCacheEntry(n)}static _FormatMessage(n){const y=n=>n<10?"0"+n:""+n,H=new Date;return"["+y(H.getHours())+":"+y(H.getMinutes())+":"+y(H.getSeconds())+"]: "+n}static _LogDisabled(n,y){}static _LogEnabled(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,y=arguments.length>1?arguments[1]:void 0,H=arguments.length>2?arguments[2]:void 0;const G=Array.isArray(y)?y[0]:y;if(void 0!==H&&!o._CheckLimit(G,H))return;const h=o._FormatMessage(G),k=this._Levels[n],i=Array.isArray(y)?y.slice(1):[];k.logFunc&&k.logFunc("BJS - "+h,...i);const B=`<div style='color:${k.color}'>${h}</div><br>`;o._AddLogEntry(B),o._GenerateLimitMessage(G,n)}static get LogCache(){return o._LogCache}static ClearLogCache(){o._LogCache="",o._LogLimitOutputs={},o.errorsCount=0}static set LogLevels(n){o.Log=o._LogDisabled,o.Warn=o._LogDisabled,o.Error=o._LogDisabled;const y=[o.MessageLogLevel,o.WarningLogLevel,o.ErrorLogLevel];for(const H of y)if((n&H)===H){const n=this._Levels[H];o[n.name]=o._LogEnabled.bind(o,H)}}}o.NoneLogLevel=0,o.MessageLogLevel=1,o.WarningLogLevel=2,o.ErrorLogLevel=4,o.AllLogLevel=7,o.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",o._LogCache="",o._LogLimitOutputs={},o._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],o.errorsCount=0,o.Log=o._LogEnabled.bind(o,o.MessageLogLevel),o.Warn=o._LogEnabled.bind(o,o.WarningLogLevel),o.Error=o._LogEnabled.bind(o,o.ErrorLogLevel)},11099:(n,y,H)=>{H.d(y,{c:()=>k});const o="undefined"!==typeof WeakRef;class G{constructor(n){let y=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;this.initialize(n,y,H,o)}initialize(n){let y=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return this.mask=n,this.skipNextObservers=y,this.target=H,this.currentTarget=o,this}}class h{constructor(n,y){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=n,this.mask=y,this.scope=H,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(n)}}class k{static FromPromise(n,y){const H=new k;return n.then((n=>{H.notifyObservers(n)})).catch((n=>{if(!y)throw n;y.notifyObservers(n)})),H}get observers(){return this._observers}constructor(n){let y=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=y,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new G(0),n&&(this._onObserverAdded=n)}add(n){let y=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!n)return null;const G=new h(n,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);G.unregisterOnNextCall=H,y?this._observers.unshift(G):this._observers.push(G),this._onObserverAdded&&this._onObserverAdded(G),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(G,this._lastNotifiedValue);const k=o?new WeakRef(this):{deref:()=>this};return G._remove=function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const y=k.deref();y&&(n?y.remove(G):y._remove(G))},G}addOnce(n){return this.add(n,void 0,void 0,void 0,!0)}remove(n){if(!n)return!1;n._remove=null;return-1!==this._observers.indexOf(n)&&(this._deferUnregister(n),!0)}removeCallback(n,y){for(let H=0;H<this._observers.length;H++){const o=this._observers[H];if(!o._willBeUnregistered&&(o.callback===n&&(!y||y===o.scope)))return this._deferUnregister(o),!0}return!1}_deferUnregister(n){n._willBeUnregistered||(this._numObserversMarkedAsDeleted++,n.unregisterOnNextCall=!1,n._willBeUnregistered=!0,setTimeout((()=>{this._remove(n)}),0))}_remove(n){let y=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!n)return!1;const H=this._observers.indexOf(n);return-1!==H&&(y&&this._numObserversMarkedAsDeleted--,this._observers.splice(H,1),!0)}makeObserverTopPriority(n){this._remove(n,!1),this._observers.unshift(n)}makeObserverBottomPriority(n){this._remove(n,!1),this._observers.push(n)}notifyObservers(n){let y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,H=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,G=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=n),!this._observers.length)return!0;const h=this._eventState;h.mask=y,h.target=H,h.currentTarget=o,h.skipNextObservers=!1,h.lastReturnValue=n,h.userInfo=G;for(const k of this._observers)if(!k._willBeUnregistered&&(k.mask&y&&(k.unregisterOnNextCall&&this._deferUnregister(k),k.scope?h.lastReturnValue=k.callback.apply(k.scope,[n,h]):h.lastReturnValue=k.callback(n,h)),h.skipNextObservers))return!1;return!0}notifyObserver(n,y){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=y),n._willBeUnregistered)return;const o=this._eventState;o.mask=H,o.skipNextObservers=!1,n.unregisterOnNextCall&&this._deferUnregister(n),n.callback(y,o)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const n=this._observers.pop();n&&(n._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const n=new k;return n._observers=this._observers.slice(0),n}hasSpecificMask(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const y of this._observers)if(y.mask&n||y.mask===n)return!0;return!1}}},11185:(n,y,H)=>{H.d(y,{c:()=>G,e:()=>k});let o=[];class G{static SetImmediate(n){0===o.length&&setTimeout((()=>{const n=o;o=[];for(const y of n)y()}),1),o.push(n)}}function h(n,y,H){try{if(n())return y(),!0}catch(o){return null===H||void 0===H||H(o),!0}return!1}const k=function(n,y,H){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,G=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,k=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&h(n,y,H))return null;const i=setInterval((()=>{h(n,y,H)?clearInterval(i):(G-=o,G<0&&(clearInterval(i),null===H||void 0===H||H(new Error("Operation timed out after maximum retries. "+(k||"")),!0)))}),o);return()=>clearInterval(i)}}}]);