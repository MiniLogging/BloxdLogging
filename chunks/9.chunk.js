"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[9],{11078:(o,H,n)=>{n.d(H,{b:()=>P,e:()=>j,k:()=>m,g:()=>B,o:()=>q});class E{constructor(){this.children=[]}isValid(o){return!0}process(o,H,n){let E="";if(this.line){let n=this.line;const G=H.processor;if(G){var k,g,O,Y,y,S;G.lineProcessor&&(n=G.lineProcessor(n,H.isFragment,H.processingContext));const E=(null===(k=H.processor)||void 0===k?void 0:k.attributeKeywordName)??"attribute",c=H.isFragment&&null!==(g=H.processor)&&void 0!==g&&g.varyingFragmentKeywordName?null===(O=H.processor)||void 0===O?void 0:O.varyingFragmentKeywordName:!H.isFragment&&null!==(Y=H.processor)&&void 0!==Y&&Y.varyingVertexKeywordName?null===(y=H.processor)||void 0===y?void 0:y.varyingVertexKeywordName:"varying";if(!H.isFragment&&G.attributeProcessor&&this.line.startsWith(E))n=G.attributeProcessor(this.line,o,H.processingContext);else if(G.varyingProcessor&&(null!==(S=G.varyingCheck)&&void 0!==S&&S.call(G,this.line,H.isFragment)||!G.varyingCheck&&this.line.startsWith(c)))n=G.varyingProcessor(this.line,H.isFragment,o,H.processingContext);else if(G.uniformProcessor&&G.uniformRegexp&&G.uniformRegexp.test(this.line))H.lookForClosingBracketForUniformBuffer||(n=G.uniformProcessor(this.line,H.isFragment,o,H.processingContext));else if(G.uniformBufferProcessor&&G.uniformBufferRegexp&&G.uniformBufferRegexp.test(this.line))H.lookForClosingBracketForUniformBuffer||(n=G.uniformBufferProcessor(this.line,H.isFragment,H.processingContext),H.lookForClosingBracketForUniformBuffer=!0);else if(G.textureProcessor&&G.textureRegexp&&G.textureRegexp.test(this.line))n=G.textureProcessor(this.line,H.isFragment,o,H.processingContext);else if((G.uniformProcessor||G.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!H.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?G.uniformProcessor&&(n=G.uniformProcessor(this.line,H.isFragment,o,H.processingContext)):G.uniformBufferProcessor&&(n=G.uniformBufferProcessor(this.line,H.isFragment,H.processingContext),H.lookForClosingBracketForUniformBuffer=!0)}H.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(H.lookForClosingBracketForUniformBuffer=!1,G.endOfUniformBufferProcessor&&(n=G.endOfUniformBufferProcessor(this.line,H.isFragment,H.processingContext)))}E+=n+"\n"}for(const G of this.children)E+=G.process(o,H,n);return this.additionalDefineKey&&(o[this.additionalDefineKey]=this.additionalDefineValue||"true",n[this.additionalDefineKey]=o[this.additionalDefineKey]),E}}class k{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(o){this._lines.length=0;for(const H of o){if(!H||"\r"===H)continue;if("#"===H[0]){this._lines.push(H);continue}const o=H.trim();if(!o)continue;if(o.startsWith("//")){this._lines.push(H);continue}const n=o.indexOf(";");if(-1===n)this._lines.push(o);else if(n===o.length-1)o.length>1&&this._lines.push(o);else{const o=H.split(";");for(let H=0;H<o.length;H++){let n=o[H];n&&(n=n.trim(),n&&this._lines.push(n+(H!==o.length-1?";":"")))}}}}}class g extends E{process(o,H,n){for(let E=0;E<this.children.length;E++){const k=this.children[E];if(k.isValid(o))return k.process(o,H,n)}return""}}class O extends E{isValid(o){return this.testExpression.isTrue(o)}}class Y{isTrue(o){return!0}static postfixToInfix(o){const H=[];for(const n of o)if(void 0===Y._OperatorPriority[n])H.push(n);else{const o=H[H.length-1],E=H[H.length-2];H.length-=2,H.push(`(${E}${n}${o})`)}return H[H.length-1]}static infixToPostfix(o){const H=Y._InfixToPostfixCache.get(o);if(H)return H.accessTime=Date.now(),H.result;if(!o.includes("&&")&&!o.includes("||")&&!o.includes(")")&&!o.includes("("))return[o];const n=[];let E=-1;const k=()=>{G=G.trim(),""!==G&&(n.push(G),G="")},g=o=>{E<Y._Stack.length-1&&(Y._Stack[++E]=o)},O=()=>Y._Stack[E],y=()=>-1===E?"!!INVALID EXPRESSION!!":Y._Stack[E--];let S=0,G="";for(;S<o.length;){const H=o.charAt(S),c=S<o.length-1?o.substring(S,2+S):"";if("("===H)G="",g(H);else if(")"===H){for(k();-1!==E&&"("!==O();)n.push(y());y()}else if(Y._OperatorPriority[c]>1){for(k();-1!==E&&Y._OperatorPriority[O()]>=Y._OperatorPriority[c];)n.push(y());g(c),S++}else G+=H;S++}for(k();-1!==E;)"("===O()?y():n.push(y());return Y._InfixToPostfixCache.size>=Y.InfixToPostfixCacheLimitSize&&Y.ClearCache(),Y._InfixToPostfixCache.set(o,{result:n,accessTime:Date.now()}),n}static ClearCache(){const o=Array.from(Y._InfixToPostfixCache.entries()).sort(((o,H)=>o[1].accessTime-H[1].accessTime));for(let H=0;H<Y.InfixToPostfixCacheCleanupSize;H++)Y._InfixToPostfixCache.delete(o[H][0])}}Y.InfixToPostfixCacheLimitSize=5e4,Y.InfixToPostfixCacheCleanupSize=25e3,Y._InfixToPostfixCache=new Map,Y._OperatorPriority={")":0,"(":1,"||":2,"&&":3},Y._Stack=["","","","","","","","","","","","","","","","","","","",""];class y extends Y{constructor(o){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=o,this.not=H}isTrue(o){let H=void 0!==o[this.define];return this.not&&(H=!H),H}}class S extends Y{isTrue(o){return this.leftOperand.isTrue(o)||this.rightOperand.isTrue(o)}}class G extends Y{isTrue(o){return this.leftOperand.isTrue(o)&&this.rightOperand.isTrue(o)}}class c extends Y{constructor(o,H,n){super(),this.define=o,this.operand=H,this.testValue=n}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(o){let H=!1;const n=parseInt(void 0!=o[this.define]?o[this.define]:this.define),E=parseInt(void 0!=o[this.testValue]?o[this.testValue]:this.testValue);if(isNaN(n)||isNaN(E))return!1;switch(this.operand){case">":H=n>E;break;case"<":H=n<E;break;case"<=":H=n<=E;break;case">=":H=n>=E;break;case"==":H=n===E;break;case"!=":H=n!==E}return H}}var A=n(11051),l=n(11083);const x=/defined\s*?\((.+?)\)/g,z=/defined\s*?\[(.+?)\]/g,V=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,J=/__decl__/,N=/light\{X\}.(\w*)/g,h=/\{X\}/g,Q=[],p=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function j(o){o.processor&&o.processor.initializeShaders&&o.processor.initializeShaders(o.processingContext)}function m(o,H,n,E){var k;null!==(k=H.processor)&&void 0!==k&&k.preProcessShaderCode&&(o=H.processor.preProcessShaderCode(o,H.isFragment)),B(o,H,(o=>{H.processCodeAfterIncludes&&(o=H.processCodeAfterIncludes(H.isFragment?"fragment":"vertex",o,H.defines));const k=function(o,H,n){let E=function(o,H){var n;if(null!==(n=H.processor)&&void 0!==n&&n.noPrecision)return o;const E=H.shouldUseHighPrecisionShader;-1===o.indexOf("precision highp float")?o=E?"precision highp float;\n"+o:"precision mediump float;\n"+o:E||(o=o.replace("precision highp float","precision mediump float"));return o}(o,H);if(!H.processor)return E;if(0===H.processor.shaderLanguage&&-1!==E.indexOf("#version 3")&&(E=E.replace("#version 300 es",""),!H.processor.parseGLES3))return E;const k=H.defines,g=f(H,n);H.processor.preProcessor&&(E=H.processor.preProcessor(E,k,g,H.isFragment,H.processingContext));const O={};E=K(E,g,H,O),H.processor.postProcessor&&(E=H.processor.postProcessor(E,k,H.isFragment,H.processingContext,n?{drawBuffersExtensionDisabled:!n.getCaps().drawBuffersExtension}:{},g,O));null!==n&&void 0!==n&&n._features.needShaderCodeInlining&&(E=n.inlineShaderCode(E));return E}(o,H,E);n(k,o)}))}function P(o,H,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(o,H,n.processingContext):{vertexCode:o,fragmentCode:H}}function b(o){const H=/defined\((.+)\)/.exec(o);if(H&&H.length)return new y(H[1].trim(),"!"===o[0]);const n=["==","!=",">=","<=","<",">"];let E="",k=0;for(E of n)if(k=o.indexOf(E),k>-1)break;if(-1===k)return new y(o);const g=o.substring(0,k).trim(),O=o.substring(k+E.length).trim();return new c(g,E,O)}function e(o,H){const n=new O,E=o.substring(0,H);let k=o.substring(H);return k=k.substring(0,(k.indexOf("//")+1||k.length+1)-1).trim(),n.testExpression="#ifdef"===E?new y(k):"#ifndef"===E?new y(k,!0):function(o){o=o.replace(x,"defined[$1]");const H=Y.infixToPostfix(o),n=[];for(const k of H)if("||"!==k&&"&&"!==k)n.push(k);else if(n.length>=2){let o=n[n.length-1],H=n[n.length-2];n.length-=2;const E="&&"==k?new G:new S;"string"===typeof o&&(o=o.replace(z,"defined($1)")),"string"===typeof H&&(H=H.replace(z,"defined($1)")),E.leftOperand="string"===typeof H?b(H):H,E.rightOperand="string"===typeof o?b(o):o,n.push(E)}let E=n[n.length-1];return"string"===typeof E&&(E=E.replace(z,"defined($1)")),"string"===typeof E?b(E):E}(k),n}function Z(o,H,n,k){let g=o.currentLine;for(;M(o,n,k);){g=o.currentLine;const O=g.substring(0,5).toLowerCase();if("#else"===O){const n=new E;return H.children.push(n),void M(o,n,k)}if("#elif"===O){const o=e(g,5);H.children.push(o),n=o}}}function M(o,H,n){for(;o.canRead;){o.lineIndex++;const k=o.currentLine;if(k.indexOf("#")>=0){const E=p.exec(k);if(E&&E.length){switch(E[0]){case"#ifdef":{const E=new g;H.children.push(E);const O=e(k,6);E.children.push(O),Z(o,E,O,n);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const E=new g;H.children.push(E);const O=e(k,7);E.children.push(O),Z(o,E,O,n);break}case"#if":{const E=new g,O=e(k,3);H.children.push(E),E.children.push(O),Z(o,E,O,n);break}}continue}}const O=new E;if(O.line=k,H.children.push(O),"#"===k[0]&&"d"===k[1]){const o=k.replace(";","").split(" ");O.additionalDefineKey=o[1],3===o.length&&(O.additionalDefineValue=o[2])}}return!1}function K(o,H,n,g){const O=new E,Y=new k;return Y.lineIndex=-1,Y.lines=o.split("\n"),M(Y,O,g),O.process(H,n,g)}function f(o,H){var n;const E=o.defines,k={};for(const g of E){const o=g.replace("#define","").replace(";","").trim().split(" ");k[o[0]]=o.length>1?o[1]:""}return 0===(null===(n=o.processor)||void 0===n?void 0:n.shaderLanguage)&&(k.GL_ES="true"),k.__VERSION__=o.version,k[o.platformName]="true",(0,l.h)(k,null===H||void 0===H?void 0:H.isNDCHalfZRange,null===H||void 0===H?void 0:H.useReverseDepthBuffer,null===H||void 0===H?void 0:H.useExactSrgbConversions),k}function B(o,H,n){let E;for(Q.length=0;null!==(E=V.exec(o));)Q.push(E);let k=String(o),g=[o],O=!1;for(const Y of Q){let o=Y[1];if(-1!==o.indexOf("__decl__")&&(o=o.replace(J,""),H.supportsUniformBuffers&&(o=o.replace("Vertex","Ubo").replace("Fragment","Ubo")),o+="Declaration"),!H.includesShadersStore[o]){const E=H.shadersRepository+"ShadersInclude/"+o+".fx";return void q.loadFile(E,(E=>{H.includesShadersStore[o]=E,B(g.join(""),H,n)}))}{let n=H.includesShadersStore[o];if(Y[2]){const o=Y[3].split(",");for(let H=0;H<o.length;H+=2){const E=new RegExp(o[H],"g"),k=o[H+1];n=n.replace(E,k)}}if(Y[4]){const o=Y[5];if(-1!==o.indexOf("..")){const E=o.split(".."),k=parseInt(E[0]);let g=parseInt(E[1]),O=n.slice(0);n="",isNaN(g)&&(g=H.indexParameters[E[1]]);for(let o=k;o<g;o++)H.supportsUniformBuffers||(O=O.replace(N,((o,H)=>H+"{X}"))),n+=O.replace(h,o.toString())+"\n"}else H.supportsUniformBuffers||(n=n.replace(N,((o,H)=>H+"{X}"))),n=n.replace(h,o)}const E=[];for(const o of g){const H=o.split(Y[0]);for(let o=0;o<H.length-1;o++)E.push(H[o]),E.push(n);E.push(H[H.length-1])}g=E,O=O||n.indexOf("#include<")>=0||n.indexOf("#include <")>=0}}Q.length=0,k=g.join(""),O?B(k.toString(),H,n):n(k)}const q={loadFile:(o,H,n,E,k,g)=>{throw(0,A.c)("FileTools")}}},11083:(o,H,n)=>{n.d(H,{b:()=>k,d:()=>g,h:()=>Y,k:()=>O,l:()=>y});var E=n(11051);n(11035);const k={};function g(o,H){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(H?H+"\n":"")+o}function O(o,H,n,g,O,Y,y){const S=y||k.loadFile;if(S){return S(o,H,n,g,O,Y)}throw(0,E.c)("FileTools")}function Y(o,H,n,E){if(o)return H?o.IS_NDC_HALF_ZRANGE="":delete o.IS_NDC_HALF_ZRANGE,n?o.USE_REVERSE_DEPTHBUFFER="":delete o.USE_REVERSE_DEPTHBUFFER,void(E?o.USE_EXACT_SRGB_CONVERSIONS="":delete o.USE_EXACT_SRGB_CONVERSIONS);{let o="";return H&&(o+="#define IS_NDC_HALF_ZRANGE"),n&&(o&&(o+="\n"),o+="#define USE_REVERSE_DEPTHBUFFER"),E&&(o&&(o+="\n"),o+="#define USE_EXACT_SRGB_CONVERSIONS"),o}}function y(o,H){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],E=arguments.length>3?arguments[3]:void 0;switch(o){case 3:{const o=(ArrayBuffer,new Int8Array(H));return E&&o.set(new Int8Array(E)),o}case 0:{const o=(ArrayBuffer,new Uint8Array(H));return E&&o.set(new Uint8Array(E)),o}case 4:{const o=H instanceof ArrayBuffer?new Int16Array(H):new Int16Array(n?H/2:H);return E&&o.set(new Int16Array(E)),o}case 5:case 8:case 9:case 10:case 2:{const o=H instanceof ArrayBuffer?new Uint16Array(H):new Uint16Array(n?H/2:H);return E&&o.set(new Uint16Array(E)),o}case 6:{const o=H instanceof ArrayBuffer?new Int32Array(H):new Int32Array(n?H/4:H);return E&&o.set(new Int32Array(E)),o}case 7:case 11:case 12:case 13:case 14:case 15:{const o=H instanceof ArrayBuffer?new Uint32Array(H):new Uint32Array(n?H/4:H);return E&&o.set(new Uint32Array(E)),o}case 1:{const o=H instanceof ArrayBuffer?new Float32Array(H):new Float32Array(n?H/4:H);return E&&o.set(new Float32Array(E)),o}}const k=(ArrayBuffer,new Uint8Array(H));return E&&k.set(new Uint8Array(E)),k}},11101:(o,H,n)=>{n.d(H,{d:()=>E});class E{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?E.ShadersRepository:E.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?E.ShadersStore:E.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?E.IncludesShadersStore:E.IncludesShadersStoreWGSL}}E.ShadersRepository="src/Shaders/",E.ShadersStore={},E.IncludesShadersStore={},E.ShadersRepositoryWGSL="src/ShadersWGSL/",E.ShadersStoreWGSL={},E.IncludesShadersStoreWGSL={}},11107:(o,H,n)=>{n.d(H,{b:()=>A,f:()=>h,i:()=>x,m:()=>l,p:()=>z,s:()=>N,u:()=>c,x:()=>S,A:()=>G,C:()=>y,G:()=>Y});class E{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.lH._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(o){o&&this.program&&o(this.program)}setEngine(o){this.lH=o}_fillEffectInformation(o,H,n,E,k,g,O,Y){const y=this.lH;if(y.supportsUniformBuffers)for(const G in H)o.bindUniformBlock(G,H[G]);let S;for(this.lH.getUniforms(this,n).forEach(((o,H)=>{E[n[H]]=o})),this._uniforms=E,S=0;S<k.length;S++){null==o.getUniform(k[S])&&(k.splice(S,1),S--)}k.forEach(((o,H)=>{g[o]=H}));for(const G of y.getAttributes(this,O))Y.push(G)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(o,H){const n=this._valueCache[o],E=H.updateFlag;return(void 0===n||n!==E)&&(this._valueCache[o]=E,!0)}_cacheFloat2(o,H,n){let E=this._valueCache[o];if(!E||2!==E.length)return E=[H,n],this._valueCache[o]=E,!0;let k=!1;return E[0]!==H&&(E[0]=H,k=!0),E[1]!==n&&(E[1]=n,k=!0),k}_cacheFloat3(o,H,n,E){let k=this._valueCache[o];if(!k||3!==k.length)return k=[H,n,E],this._valueCache[o]=k,!0;let g=!1;return k[0]!==H&&(k[0]=H,g=!0),k[1]!==n&&(k[1]=n,g=!0),k[2]!==E&&(k[2]=E,g=!0),g}_cacheFloat4(o,H,n,E,k){let g=this._valueCache[o];if(!g||4!==g.length)return g=[H,n,E,k],this._valueCache[o]=g,!0;let O=!1;return g[0]!==H&&(g[0]=H,O=!0),g[1]!==n&&(g[1]=n,O=!0),g[2]!==E&&(g[2]=E,O=!0),g[3]!==k&&(g[3]=k,O=!0),O}setInt(o,H){const n=this._valueCache[o];void 0!==n&&n===H||this.lH.setInt(this._uniforms[o],H)&&(this._valueCache[o]=H)}setInt2(o,H,n){this._cacheFloat2(o,H,n)&&(this.lH.setInt2(this._uniforms[o],H,n)||(this._valueCache[o]=null))}setInt3(o,H,n,E){this._cacheFloat3(o,H,n,E)&&(this.lH.setInt3(this._uniforms[o],H,n,E)||(this._valueCache[o]=null))}setInt4(o,H,n,E,k){this._cacheFloat4(o,H,n,E,k)&&(this.lH.setInt4(this._uniforms[o],H,n,E,k)||(this._valueCache[o]=null))}setIntArray(o,H){this._valueCache[o]=null,this.lH.setIntArray(this._uniforms[o],H)}setIntArray2(o,H){this._valueCache[o]=null,this.lH.setIntArray2(this._uniforms[o],H)}setIntArray3(o,H){this._valueCache[o]=null,this.lH.setIntArray3(this._uniforms[o],H)}setIntArray4(o,H){this._valueCache[o]=null,this.lH.setIntArray4(this._uniforms[o],H)}setUInt(o,H){const n=this._valueCache[o];void 0!==n&&n===H||this.lH.setUInt(this._uniforms[o],H)&&(this._valueCache[o]=H)}setUInt2(o,H,n){this._cacheFloat2(o,H,n)&&(this.lH.setUInt2(this._uniforms[o],H,n)||(this._valueCache[o]=null))}setUInt3(o,H,n,E){this._cacheFloat3(o,H,n,E)&&(this.lH.setUInt3(this._uniforms[o],H,n,E)||(this._valueCache[o]=null))}setUInt4(o,H,n,E,k){this._cacheFloat4(o,H,n,E,k)&&(this.lH.setUInt4(this._uniforms[o],H,n,E,k)||(this._valueCache[o]=null))}setUIntArray(o,H){this._valueCache[o]=null,this.lH.setUIntArray(this._uniforms[o],H)}setUIntArray2(o,H){this._valueCache[o]=null,this.lH.setUIntArray2(this._uniforms[o],H)}setUIntArray3(o,H){this._valueCache[o]=null,this.lH.setUIntArray3(this._uniforms[o],H)}setUIntArray4(o,H){this._valueCache[o]=null,this.lH.setUIntArray4(this._uniforms[o],H)}setArray(o,H){this._valueCache[o]=null,this.lH.setArray(this._uniforms[o],H)}setArray2(o,H){this._valueCache[o]=null,this.lH.setArray2(this._uniforms[o],H)}setArray3(o,H){this._valueCache[o]=null,this.lH.setArray3(this._uniforms[o],H)}setArray4(o,H){this._valueCache[o]=null,this.lH.setArray4(this._uniforms[o],H)}setMatrices(o,H){H&&(this._valueCache[o]=null,this.lH.setMatrices(this._uniforms[o],H))}setMatrix(o,H){this._cacheMatrix(o,H)&&(this.lH.setMatrices(this._uniforms[o],H.bg())||(this._valueCache[o]=null))}setMatrix3x3(o,H){this._valueCache[o]=null,this.lH.setMatrix3x3(this._uniforms[o],H)}setMatrix2x2(o,H){this._valueCache[o]=null,this.lH.setMatrix2x2(this._uniforms[o],H)}setFloat(o,H){const n=this._valueCache[o];void 0!==n&&n===H||this.lH.setFloat(this._uniforms[o],H)&&(this._valueCache[o]=H)}setVector2(o,H){this._cacheFloat2(o,H.x,H.y)&&(this.lH.setFloat2(this._uniforms[o],H.x,H.y)||(this._valueCache[o]=null))}setFloat2(o,H,n){this._cacheFloat2(o,H,n)&&(this.lH.setFloat2(this._uniforms[o],H,n)||(this._valueCache[o]=null))}setVector3(o,H){this._cacheFloat3(o,H.x,H.y,H.z)&&(this.lH.setFloat3(this._uniforms[o],H.x,H.y,H.z)||(this._valueCache[o]=null))}setFloat3(o,H,n,E){this._cacheFloat3(o,H,n,E)&&(this.lH.setFloat3(this._uniforms[o],H,n,E)||(this._valueCache[o]=null))}setVector4(o,H){this._cacheFloat4(o,H.x,H.y,H.z,H.w)&&(this.lH.setFloat4(this._uniforms[o],H.x,H.y,H.z,H.w)||(this._valueCache[o]=null))}setQuaternion(o,H){this._cacheFloat4(o,H.x,H.y,H.z,H.w)&&(this.lH.setFloat4(this._uniforms[o],H.x,H.y,H.z,H.w)||(this._valueCache[o]=null))}setFloat4(o,H,n,E,k){this._cacheFloat4(o,H,n,E,k)&&(this.lH.setFloat4(this._uniforms[o],H,n,E,k)||(this._valueCache[o]=null))}setColor3(o,H){this._cacheFloat3(o,H.r,H.g,H.b)&&(this.lH.setFloat3(this._uniforms[o],H.r,H.g,H.b)||(this._valueCache[o]=null))}setColor4(o,H,n){this._cacheFloat4(o,H.r,H.g,H.b,n)&&(this.lH.setFloat4(this._uniforms[o],H.r,H.g,H.b,n)||(this._valueCache[o]=null))}setDirectColor4(o,H){this._cacheFloat4(o,H.r,H.g,H.b,H.a)&&(this.lH.setFloat4(this._uniforms[o],H.r,H.g,H.b,H.a)||(this._valueCache[o]=null))}_getVertexShaderCode(){return this.vertexShader?this.lH._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.lH._getShaderSource(this.fragmentShader):null}}var k=n(11083);const g=new WeakMap,O={_webGLVersion:2,cachedPipelines:{}};function Y(o){let H=g.get(o);if(!H){if(!o)return O;H={_webGLVersion:o.TEXTURE_BINDING_3D?2:1,_context:o,parallelShaderCompile:o.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},g.set(o,H)}return H}function y(o){g.delete(o)}function S(o,H,n,E,k,g){const O=Y(E);g||(g=O._createShaderProgramInjection??A);return g(o,J(H,"vertex",E,O._contextWasLost),J(n,"fragment",E,O._contextWasLost),E,k,O.validateShaderPrograms)}function G(o,H,n,E,k){let g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,O=arguments.length>6?arguments[6]:void 0;const y=Y(k);O||(O=y._createShaderProgramInjection??A);const S=y._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return O(o,V(H,"vertex",E,S,k,y._contextWasLost),V(n,"fragment",E,S,k,y._contextWasLost),k,g,y.validateShaderPrograms)}function c(o,H){const n=new E,k=Y(o);return k.parallelShaderCompile&&!k.disableParallelShaderCompile&&(n.isParallelCompiled=!0),n.context=k._context,n}function A(o,H,n,E){let k=arguments.length>5?arguments[5]:void 0;const g=E.createProgram();if(o.program=g,!g)throw new Error("Unable to create program");return E.attachShader(g,H),E.attachShader(g,n),E.linkProgram(g),o.context=E,o.vertexShader=H,o.fragmentShader=n,o.isParallelCompiled||x(o,E,k),g}function l(o,H,n){const E=o;if(E._isDisposed)return!1;const k=Y(H);return!!(k&&k.parallelShaderCompile&&k.parallelShaderCompile.COMPLETION_STATUS_KHR&&E.program&&H.getProgramParameter(E.program,k.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(x(E,H,n),!0)}function x(o,H,n){const E=o.context,k=o.vertexShader,g=o.fragmentShader,O=o.program;if(!E.getProgramParameter(O,E.LINK_STATUS)){if(!H.getShaderParameter(k,H.COMPILE_STATUS)){const n=H.getShaderInfoLog(k);if(n)throw o.vertexCompilationError=n,new Error("VERTEX SHADER "+n)}if(!H.getShaderParameter(g,H.COMPILE_STATUS)){const n=H.getShaderInfoLog(g);if(n)throw o.fragmentCompilationError=n,new Error("FRAGMENT SHADER "+n)}const n=E.getProgramInfoLog(O);if(n)throw o.programLinkError=n,new Error(n)}if(n){E.validateProgram(O);if(!E.getProgramParameter(O,E.VALIDATE_STATUS)){const H=E.getProgramInfoLog(O);if(H)throw o.programValidationError=H,new Error(H)}}E.deleteShader(k),E.deleteShader(g),o.vertexShader=void 0,o.fragmentShader=void 0,o.onCompiled&&(o.onCompiled(),o.onCompiled=void 0)}function z(o,H,n,E,k,g,O,y,c){let A=arguments.length>10?arguments[10]:void 0,l=arguments.length>11?arguments[11]:void 0,x=arguments.length>12?arguments[12]:void 0;const z=Y(o.context);l||(l=z.createRawShaderProgramInjection??S),x||(x=z.createShaderProgramInjection??G);const V=o;V.program=E?l(V,H,n,V.context,c):x(V,H,n,y,V.context,c),V.program.__SPECTOR_rebuildProgram=O,A()}function V(o,H,n,E,g,O){return J((0,k.d)(o,n,E),H,g,O)}function J(o,H,n,E){const k=n.createShader("vertex"===H?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(!k){let o=n.NO_ERROR,k=n.NO_ERROR;for(;(k=n.getError())!==n.NO_ERROR;)o=k;throw new Error(`Something went wrong while creating a gl ${H} shader object. gl error=${o}, gl isContextLost=${n.isContextLost()}, _contextWasLost=${E}`)}return n.shaderSource(k,o),n.compileShader(k),k}function N(o,H){H.useProgram(o)}function h(o,H){const n=o;if(!n.isParallelCompiled)return void H(o);const E=n.onCompiled;n.onCompiled=()=>{null===E||void 0===E||E(),H(o)}}},11103:(o,H,n)=>{n.d(H,{e:()=>c,i:()=>l,l:()=>S,m:()=>G});var E=n(11035),k=n(11107),g=n(11101),O=n(11038),Y=n(11078),y=n(11083);function S(o,H){return(0,k.G)(H).cachedPipelines[o]}function G(o){const H=o._name,n=o.context;if(H&&n){const o=(0,k.G)(n),E=o.cachedPipelines[H];null===E||void 0===E||E.dispose(),delete o.cachedPipelines[H]}}function c(o,H,n,k,g,O,y){let S,G;const c=(0,E.f)()?null===O||void 0===O?void 0:O.getHostDocument():null;S="string"===typeof H?H:H.vertexSource?"source:"+H.vertexSource:H.vertexElement?(null===c||void 0===c?void 0:c.getElementById(H.vertexElement))||H.vertexElement:H.vertex||H,G="string"===typeof H?H:H.fragmentSource?"source:"+H.fragmentSource:H.fragmentElement?(null===c||void 0===c?void 0:c.getElementById(H.fragmentElement))||H.fragmentElement:H.fragment||H;const l=[void 0,void 0],x=()=>{if(l[0]&&l[1]){o.isFragment=!0;const[E,S]=l;(0,Y.k)(S,o,((O,S)=>{y&&(y._fragmentSourceCodeBeforeMigration=S),n&&(O=n("fragment",O));const G=(0,Y.b)(E,O,o);o=null;const c=function(o,H,n,E){if(n){return{vertexSourceCode:(1===E?"//":"")+"#define SHADER_NAME vertex:"+(n.vertexElement||n.vertex||n.spectorName||n)+"\n"+o,fragmentSourceCode:(1===E?"//":"")+"#define SHADER_NAME fragment:"+(n.fragmentElement||n.fragment||n.spectorName||n)+"\n"+H}}return{vertexSourceCode:o,fragmentSourceCode:H}}(G.vertexCode,G.fragmentCode,H,g);null===k||void 0===k||k(c.vertexSourceCode,c.fragmentSourceCode)}),O)}};A(S,"Vertex","",(H=>{(0,Y.e)(o),(0,Y.k)(H,o,((o,E)=>{y&&(y._rawVertexSourceCode=H,y._vertexSourceCodeBeforeMigration=E),n&&(o=n("vertex",o)),l[0]=o,x()}),O)}),g),A(G,"Fragment","Pixel",(o=>{y&&(y._rawFragmentSourceCode=o),l[1]=o,x()}),g)}function A(o,H,n,k,O,Y){if("undefined"!==typeof HTMLElement&&o instanceof HTMLElement){return void k((0,E.b)(o))}if("source:"===o.substring(0,7))return void k(o.substring(7));if("base64:"===o.substring(0,7)){return void k(window.atob(o.substring(7)))}const S=g.d.GetShadersStore(O);if(S[o+H+"Shader"])return void k(S[o+H+"Shader"]);if(n&&S[o+n+"Shader"])return void k(S[o+n+"Shader"]);let G;if(G="."===o[0]||"/"===o[0]||o.indexOf("http")>-1?o:g.d.GetShadersRepository(O)+o,!(Y=Y||y.k))throw new Error("loadFileInjection is not defined");Y(G+"."+H.toLowerCase()+".fx",k)}const l=(o,H,n,E)=>{try{const g=o.context?(0,k.G)(o.context):null;g&&(g.disableParallelShaderCompile=o.disableParallelCompilation);const O=o.existingPipelineContext||H(o.shaderProcessingContext);return O._name=o.name,o.name&&g&&(g.cachedPipelines[o.name]=O),n(O,o.vertex,o.fragment,!!o.createAsRaw,"","",o.rebuildRebind,o.defines,o.transformFeedbackVaryings,"",(()=>{E(O,(()=>{var H;null===(H=o.onRenderingStateCompiled)||void 0===H||H.call(o,O)}))})),O}catch(g){throw O.d.Error("Error compiling effect"),g}}},11096:(o,H,n)=>{n.r(H),n.d(H,{Effect:()=>y});var E=n(11026),k=n(11038),g=n(11101),O=n(11103),Y=n(11088);class y{static get ShadersRepository(){return g.d.ShadersRepository}static set ShadersRepository(o){g.d.ShadersRepository=o}get l(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new E.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(o,H,n){let k=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4?arguments[4]:void 0,Y=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,S=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,G=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,A=arguments.length>9?arguments[9]:void 0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",x=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,z=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new E.d,this.onErrorObservable=new E.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=o,this._key=l;const V=this._key.replace(/\r/g,"").replace(/\n/g,"|");let J;if(H.attributes){const o=H;if(this._engine=n,this._attributesNames=o.attributes,this._uniformsNames=o.uniformsNames.concat(o.samplers),this._samplerList=o.samplers.slice(),this.defines=o.defines,this.onError=o.onError,this.onCompiled=o.onCompiled,this._fallbacks=o.fallbacks,this._indexParameters=o.indexParameters,this._transformFeedbackVaryings=o.transformFeedbackVaryings||null,this._multiTarget=!!o.multiTarget,this._shaderLanguage=o.shaderLanguage??0,this._disableParallelShaderCompilation=!!o.disableParallelShaderCompilation,o.uniformBuffersNames){this._uniformBuffersNamesList=o.uniformBuffersNames.slice();for(let H=0;H<o.uniformBuffersNames.length;H++)this._uniformBuffersNames[o.uniformBuffersNames[H]]=H}this._processFinalCode=o.processFinalCode??null,this._processCodeAfterIncludes=o.processCodeAfterIncludes??void 0,z=o.extraInitializationsAsync,J=o.existingPipelineContext}else this._engine=g,this.defines=null==Y?"":Y,this._uniformsNames=n.concat(k),this._samplerList=k?k.slice():[],this._attributesNames=H,this._uniformBuffersNamesList=[],this._shaderLanguage=x,this.onError=c,this.onCompiled=G,this._indexParameters=A,this._fallbacks=S;"WEBGL2"===this._engine.shaderPlatformName&&(J=(0,O.l)(V,this._engine._gl)??J),this._attributeLocationByName={},this.uniqueId=y._UniqueIdSeed++,J?(this._pipelineContext=J,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,z),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.l||this.dispose(!0)}))}async _processShaderCodeAsync(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,E=arguments.length>3?arguments[3]:void 0;E&&await E(),this._processingContext=n||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const k={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:o??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:g.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:g.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,O.e)(k,this.name,this._processFinalCode,((o,n)=>{this._vertexSourceCode=o,this._fragmentSourceCode=n,this._prepareEffect(H)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.l||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(o){return this._attributes[o]}getAttributeLocationByName(o){return this._attributeLocationByName[o]}getAttributesCount(){return this._attributes.length}getUniformIndex(o){return this._uniformsNames.indexOf(o)}getUniform(o){return this._uniforms[o]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((o=>{this.executeWhenCompiled(o)}))}executeWhenCompiled(o){this.isReady()?o(this):(this.onCompileObservable.add((H=>{o(H)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(o){(0,Y.d)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(H=>{this._processCompilationErrors(H,o)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var o;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(o=this._pipelineContext)||void 0===o?void 0:o._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var o;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(o,H,n,E){this._isReady=!1,this._vertexSourceCodeOverride=o,this._fragmentSourceCodeOverride=H,this.onError=(o,H)=>{E&&E(H)},this.onCompiled=()=>{var o,H;const E=this.getEngine().scenes;if(E)for(let n=0;n<E.length;n++)E[n].markAllMaterialsAsDirty(127);null===(o=(H=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===o||o.call(H,n)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(o){if(this._pipelineContext=o,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let H=0;H<this._attributesNames.length;H++){const o=this._attributesNames[H];this._attributeLocationByName[o]=this._attributes[H]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),y.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const H=this._pipelineContext;this._isReady=!1;try{const n=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),E=n?null:this.defines,k=n?this._vertexSourceCodeOverride:this._vertexSourceCode,g=n?this._fragmentSourceCodeOverride:this._fragmentSourceCode,Y=this._engine;this._pipelineContext=(0,O.i)({existingPipelineContext:o?H:null,vertex:k,fragment:g,context:"WEBGL2"===Y.shaderPlatformName||"WEBGL1"===Y.shaderPlatformName?Y._gl:void 0,rebuildRebind:(o,H,n,E)=>this._rebuildProgram(o,H,n,E),defines:E,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:n,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:n=>{H&&!o&&this._engine._deletePipelineContext(H),n&&this._onRenderingStateCompiled(n)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(H)}catch(n){this._processCompilationErrors(n,H)}}_getShaderCodeAndErrorLine(o,H,n){const E=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let k=null;if(H&&o){const g=H.match(E);if(g&&2===g.length){const H=parseInt(g[1]),E=o.split("\n",-1);E.length>=H&&(k=`Offending line [${H}] in ${n?"fragment":"vertex"} code: ${E[H-1]}`)}}return[o,k]}_processCompilationErrors(o){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=o.message;const n=this._attributesNames,E=this._fallbacks;if(k.d.Error("Unable to compile effect:"),k.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),k.d.Error(`Attributes: ${n.join(" ")}`),k.d.Error("Defines:\n"+this.defines),y.LogShaderCodeOnCompilationError){var g,O;let o=null,H=null,n=null;var Y;if(null!==(g=this._pipelineContext)&&void 0!==g&&g._getVertexShaderCode()&&([n,o]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),n&&(k.d.Error("Vertex code:"),k.d.Error(n))),null!==(O=this._pipelineContext)&&void 0!==O&&O._getFragmentShaderCode())[n,H]=this._getShaderCodeAndErrorLine(null===(Y=this._pipelineContext)||void 0===Y?void 0:Y._getFragmentShaderCode(),this._compilationError,!0),n&&(k.d.Error("Fragment code:"),k.d.Error(n));o&&k.d.Error(o),H&&k.d.Error(H)}k.d.Error("Error: "+this._compilationError);const S=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};H&&(this._pipelineContext=H,this._isReady=!0,S()),E?(this._pipelineContext=null,E.hasMoreFallbacks?(this._allFallbacksProcessed=!1,k.d.Error("Trying next fallback."),this.defines=E.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,S(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,H||S())}get isSupported(){return""===this._compilationError}_bindTexture(o,H){this._engine._bindTexture(this._samplers[o],H,o)}setTexture(o,H){this._engine.setTexture(this._samplers[o],this._uniforms[o],H,o)}setTextureArray(o,H){const n=o+"Ex";if(-1===this._samplerList.indexOf(n+"0")){const E=this._samplerList.indexOf(o);for(let o=1;o<H.length;o++){const H=n+(o-1).toString();this._samplerList.splice(E+o,0,H)}let k=0;for(const o of this._samplerList)this._samplers[o]=k,k+=1}this._engine.setTextureArray(this._samplers[o],this._uniforms[o],H,o)}bindUniformBuffer(o,H){const n=this._uniformBuffersNames[H];void 0===n||y._BaseCache[n]===o&&this._engine._features.useUBOBindingCache||(y._BaseCache[n]=o,this._engine.bindUniformBufferBase(o,n,H))}bindUniformBlock(o,H){this._engine.bindUniformBlock(this._pipelineContext,o,H)}setInt(o,H){return this._pipelineContext.setInt(o,H),this}setInt2(o,H,n){return this._pipelineContext.setInt2(o,H,n),this}setInt3(o,H,n,E){return this._pipelineContext.setInt3(o,H,n,E),this}setInt4(o,H,n,E,k){return this._pipelineContext.setInt4(o,H,n,E,k),this}setIntArray(o,H){return this._pipelineContext.setIntArray(o,H),this}setIntArray2(o,H){return this._pipelineContext.setIntArray2(o,H),this}setIntArray3(o,H){return this._pipelineContext.setIntArray3(o,H),this}setIntArray4(o,H){return this._pipelineContext.setIntArray4(o,H),this}setUInt(o,H){return this._pipelineContext.setUInt(o,H),this}setUInt2(o,H,n){return this._pipelineContext.setUInt2(o,H,n),this}setUInt3(o,H,n,E){return this._pipelineContext.setUInt3(o,H,n,E),this}setUInt4(o,H,n,E,k){return this._pipelineContext.setUInt4(o,H,n,E,k),this}setUIntArray(o,H){return this._pipelineContext.setUIntArray(o,H),this}setUIntArray2(o,H){return this._pipelineContext.setUIntArray2(o,H),this}setUIntArray3(o,H){return this._pipelineContext.setUIntArray3(o,H),this}setUIntArray4(o,H){return this._pipelineContext.setUIntArray4(o,H),this}setFloatArray(o,H){return this._pipelineContext.setArray(o,H),this}setFloatArray2(o,H){return this._pipelineContext.setArray2(o,H),this}setFloatArray3(o,H){return this._pipelineContext.setArray3(o,H),this}setFloatArray4(o,H){return this._pipelineContext.setArray4(o,H),this}setArray(o,H){return this._pipelineContext.setArray(o,H),this}setArray2(o,H){return this._pipelineContext.setArray2(o,H),this}setArray3(o,H){return this._pipelineContext.setArray3(o,H),this}setArray4(o,H){return this._pipelineContext.setArray4(o,H),this}setMatrices(o,H){return this._pipelineContext.setMatrices(o,H),this}setMatrix(o,H){return this._pipelineContext.setMatrix(o,H),this}setMatrix3x3(o,H){return this._pipelineContext.setMatrix3x3(o,H),this}setMatrix2x2(o,H){return this._pipelineContext.setMatrix2x2(o,H),this}setFloat(o,H){return this._pipelineContext.setFloat(o,H),this}setBool(o,H){return this._pipelineContext.setInt(o,H?1:0),this}setVector2(o,H){return this._pipelineContext.setVector2(o,H),this}setFloat2(o,H,n){return this._pipelineContext.setFloat2(o,H,n),this}setVector3(o,H){return this._pipelineContext.setVector3(o,H),this}setFloat3(o,H,n,E){return this._pipelineContext.setFloat3(o,H,n,E),this}setVector4(o,H){return this._pipelineContext.setVector4(o,H),this}setQuaternion(o,H){return this._pipelineContext.setQuaternion(o,H),this}setFloat4(o,H,n,E,k){return this._pipelineContext.setFloat4(o,H,n,E,k),this}setColor3(o,H){return this._pipelineContext.setColor3(o,H),this}setColor4(o,H,n){return this._pipelineContext.setColor4(o,H,n),this}setDirectColor4(o,H){return this._pipelineContext.setDirectColor4(o,H),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(y.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,O.m)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(o,H,n){let E=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;H&&(g.d.GetShadersStore(E)[`${o}PixelShader`]=H),n&&(g.d.GetShadersStore(E)[`${o}VertexShader`]=n)}static ResetCache(){y._BaseCache={}}}y.LogShaderCodeOnCompilationError=!0,y.PersistentMode=!1,y.AutomaticallyClearCodeCache=!1,y._UniqueIdSeed=0,y._BaseCache={},y.ShadersStore=g.d.ShadersStore,y.IncludesShadersStore=g.d.IncludesShadersStore},11051:(o,H,n)=>{n.d(H,{c:()=>k});const E={};function k(o){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!E[o])return E[o]=!0,`${o} needs to be imported before as it contains a side-effect required by your code.`}},11035:(o,H,n)=>{function E(){return"undefined"!==typeof window}function k(){return"undefined"!==typeof navigator}function g(){return"undefined"!==typeof document}function O(o){let H="",n=o.firstChild;for(;n;)3===n.nodeType&&(H+=n.textContent),n=n.nextSibling;return H}n.d(H,{b:()=>O,d:()=>g,e:()=>k,f:()=>E})},11038:(o,H,n)=>{n.d(H,{d:()=>E});class E{static _CheckLimit(o,H){let n=E._LogLimitOutputs[o];return n?n.current++:(n={limit:H,current:1},E._LogLimitOutputs[o]=n),n.current<=n.limit}static _GenerateLimitMessage(o){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=E._LogLimitOutputs[o];if(!n||!E.MessageLimitReached)return;const k=this._Levels[H];n.current===n.limit&&E[k.name](E.MessageLimitReached.replace(/%LIMIT%/g,""+n.limit).replace(/%TYPE%/g,k.name??""))}static _AddLogEntry(o){E._LogCache=o+E._LogCache,E.OnNewCacheEntry&&E.OnNewCacheEntry(o)}static _FormatMessage(o){const H=o=>o<10?"0"+o:""+o,n=new Date;return"["+H(n.getHours())+":"+H(n.getMinutes())+":"+H(n.getSeconds())+"]: "+o}static _LogDisabled(o,H){}static _LogEnabled(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,H=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const k=Array.isArray(H)?H[0]:H;if(void 0!==n&&!E._CheckLimit(k,n))return;const g=E._FormatMessage(k),O=this._Levels[o],Y=Array.isArray(H)?H.slice(1):[];O.logFunc&&O.logFunc("BJS - "+g,...Y);const y=`<div style='color:${O.color}'>${g}</div><br>`;E._AddLogEntry(y),E._GenerateLimitMessage(k,o)}static get LogCache(){return E._LogCache}static ClearLogCache(){E._LogCache="",E._LogLimitOutputs={},E.errorsCount=0}static set LogLevels(o){E.Log=E._LogDisabled,E.Warn=E._LogDisabled,E.Error=E._LogDisabled;const H=[E.MessageLogLevel,E.WarningLogLevel,E.ErrorLogLevel];for(const n of H)if((o&n)===n){const o=this._Levels[n];E[o.name]=E._LogEnabled.bind(E,n)}}}E.NoneLogLevel=0,E.MessageLogLevel=1,E.WarningLogLevel=2,E.ErrorLogLevel=4,E.AllLogLevel=7,E.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",E._LogCache="",E._LogLimitOutputs={},E._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],E.errorsCount=0,E.Log=E._LogEnabled.bind(E,E.MessageLogLevel),E.Warn=E._LogEnabled.bind(E,E.WarningLogLevel),E.Error=E._LogEnabled.bind(E,E.ErrorLogLevel)},11026:(o,H,n)=>{n.d(H,{d:()=>O});const E="undefined"!==typeof WeakRef;class k{constructor(o){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,E=arguments.length>3?arguments[3]:void 0;this.initialize(o,H,n,E)}initialize(o){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,E=arguments.length>3?arguments[3]:void 0;return this.mask=o,this.skipNextObservers=H,this.target=n,this.currentTarget=E,this}}class g{constructor(o,H){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=o,this.mask=H,this.scope=n,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(o)}}class O{static FromPromise(o,H){const n=new O;return o.then((o=>{n.notifyObservers(o)})).catch((o=>{if(!H)throw o;H.notifyObservers(o)})),n}get observers(){return this._observers}constructor(o){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=H,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new k(0),o&&(this._onObserverAdded=o)}add(o){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!o)return null;const k=new g(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);k.unregisterOnNextCall=n,H?this._observers.unshift(k):this._observers.push(k),this._onObserverAdded&&this._onObserverAdded(k),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(k,this._lastNotifiedValue);const O=E?new WeakRef(this):{deref:()=>this};return k._remove=function(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const H=O.deref();H&&(o?H.remove(k):H._remove(k))},k}addOnce(o){return this.add(o,void 0,void 0,void 0,!0)}remove(o){if(!o)return!1;o._remove=null;return-1!==this._observers.indexOf(o)&&(this._deferUnregister(o),!0)}removeCallback(o,H){for(let n=0;n<this._observers.length;n++){const E=this._observers[n];if(!E._willBeUnregistered&&(E.callback===o&&(!H||H===E.scope)))return this._deferUnregister(E),!0}return!1}_deferUnregister(o){o._willBeUnregistered||(this._numObserversMarkedAsDeleted++,o.unregisterOnNextCall=!1,o._willBeUnregistered=!0,setTimeout((()=>{this._remove(o)}),0))}_remove(o){let H=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!o)return!1;const n=this._observers.indexOf(o);return-1!==n&&(H&&this._numObserversMarkedAsDeleted--,this._observers.splice(n,1),!0)}makeObserverTopPriority(o){this._remove(o,!1),this._observers.unshift(o)}makeObserverBottomPriority(o){this._remove(o,!1),this._observers.push(o)}notifyObservers(o){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,E=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=o),!this._observers.length)return!0;const g=this._eventState;g.mask=H,g.target=n,g.currentTarget=E,g.skipNextObservers=!1,g.lastReturnValue=o,g.userInfo=k;for(const O of this._observers)if(!O._willBeUnregistered&&(O.mask&H&&(O.unregisterOnNextCall&&this._deferUnregister(O),O.scope?g.lastReturnValue=O.callback.apply(O.scope,[o,g]):g.lastReturnValue=O.callback(o,g)),g.skipNextObservers))return!1;return!0}notifyObserver(o,H){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=H),o._willBeUnregistered)return;const E=this._eventState;E.mask=n,E.skipNextObservers=!1,o.unregisterOnNextCall&&this._deferUnregister(o),o.callback(H,E)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const o=this._observers.pop();o&&(o._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const o=new O;return o._observers=this._observers.slice(0),o}hasSpecificMask(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const H of this._observers)if(H.mask&o||H.mask===o)return!0;return!1}}},11088:(o,H,n)=>{n.d(H,{c:()=>k,d:()=>O});let E=[];class k{static SetImmediate(o){0===E.length&&setTimeout((()=>{const o=E;E=[];for(const H of o)H()}),1),E.push(o)}}function g(o,H,n){try{if(o())return H(),!0}catch(E){return null===n||void 0===n||n(E),!0}return!1}const O=function(o,H,n){let E=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,O=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&g(o,H,n))return null;const Y=setInterval((()=>{g(o,H,n)?clearInterval(Y):(k-=E,k<0&&(clearInterval(Y),null===n||void 0===n||n(new Error("Operation timed out after maximum retries. "+(O||"")),!0)))}),E);return()=>clearInterval(Y)}}}]);