"use strict";(self.hbnkweqmycf=self.hbnkweqmycf||[]).push([[9],{11530:(F,P,f)=>{f.d(P,{b:()=>d,f:()=>y,i:()=>O,g:()=>I,m:()=>E});class c{constructor(){this.children=[]}isValid(F){return!0}process(F,P,f){let c="";if(this.line){let f=this.line;const i=P.processor;if(i){var N,q,H,A,o,j;i.lineProcessor&&(f=i.lineProcessor(f,P.isFragment,P.processingContext));const c=(null===(N=P.processor)||void 0===N?void 0:N.attributeKeywordName)??"attribute",u=P.isFragment&&null!==(q=P.processor)&&void 0!==q&&q.varyingFragmentKeywordName?null===(H=P.processor)||void 0===H?void 0:H.varyingFragmentKeywordName:!P.isFragment&&null!==(A=P.processor)&&void 0!==A&&A.varyingVertexKeywordName?null===(o=P.processor)||void 0===o?void 0:o.varyingVertexKeywordName:"varying";if(!P.isFragment&&i.attributeProcessor&&this.line.startsWith(c))f=i.attributeProcessor(this.line,F,P.processingContext);else if(i.varyingProcessor&&(null!==(j=i.varyingCheck)&&void 0!==j&&j.call(i,this.line,P.isFragment)||!i.varyingCheck&&this.line.startsWith(u)))f=i.varyingProcessor(this.line,P.isFragment,F,P.processingContext);else if(i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line))P.lookForClosingBracketForUniformBuffer||(f=i.uniformProcessor(this.line,P.isFragment,F,P.processingContext));else if(i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line))P.lookForClosingBracketForUniformBuffer||(f=i.uniformBufferProcessor(this.line,P.isFragment,P.processingContext),P.lookForClosingBracketForUniformBuffer=!0);else if(i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line))f=i.textureProcessor(this.line,P.isFragment,F,P.processingContext);else if((i.uniformProcessor||i.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!P.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?i.uniformProcessor&&(f=i.uniformProcessor(this.line,P.isFragment,F,P.processingContext)):i.uniformBufferProcessor&&(f=i.uniformBufferProcessor(this.line,P.isFragment,P.processingContext),P.lookForClosingBracketForUniformBuffer=!0)}P.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(P.lookForClosingBracketForUniformBuffer=!1,i.endOfUniformBufferProcessor&&(f=i.endOfUniformBufferProcessor(this.line,P.isFragment,P.processingContext)))}c+=f+"\n"}for(const i of this.children)c+=i.process(F,P,f);return this.additionalDefineKey&&(F[this.additionalDefineKey]=this.additionalDefineValue||"true",f[this.additionalDefineKey]=F[this.additionalDefineKey]),c}}class N{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(F){this._lines.length=0;for(const P of F){if(!P||"\r"===P)continue;if("#"===P[0]){this._lines.push(P);continue}const F=P.trim();if(!F)continue;if(F.startsWith("//")){this._lines.push(P);continue}const f=F.indexOf(";");if(-1===f)this._lines.push(F);else if(f===F.length-1)F.length>1&&this._lines.push(F);else{const F=P.split(";");for(let P=0;P<F.length;P++){let f=F[P];f&&(f=f.trim(),f&&this._lines.push(f+(P!==F.length-1?";":"")))}}}}}class q extends c{process(F,P,f){for(let c=0;c<this.children.length;c++){const N=this.children[c];if(N.isValid(F))return N.process(F,P,f)}return""}}class H extends c{isValid(F){return this.testExpression.isTrue(F)}}class A{isTrue(F){return!0}static postfixToInfix(F){const P=[];for(const f of F)if(void 0===A._OperatorPriority[f])P.push(f);else{const F=P[P.length-1],c=P[P.length-2];P.length-=2,P.push(`(${c}${f}${F})`)}return P[P.length-1]}static infixToPostfix(F){const P=A._InfixToPostfixCache.get(F);if(P)return P.accessTime=Date.now(),P.result;if(!F.includes("&&")&&!F.includes("||")&&!F.includes(")")&&!F.includes("("))return[F];const f=[];let c=-1;const N=()=>{i=i.trim(),""!==i&&(f.push(i),i="")},q=F=>{c<A._Stack.length-1&&(A._Stack[++c]=F)},H=()=>A._Stack[c],o=()=>-1===c?"!!INVALID EXPRESSION!!":A._Stack[c--];let j=0,i="";for(;j<F.length;){const P=F.charAt(j),u=j<F.length-1?F.substring(j,2+j):"";if("("===P)i="",q(P);else if(")"===P){for(N();-1!==c&&"("!==H();)f.push(o());o()}else if(A._OperatorPriority[u]>1){for(N();-1!==c&&A._OperatorPriority[H()]>=A._OperatorPriority[u];)f.push(o());q(u),j++}else i+=P;j++}for(N();-1!==c;)"("===H()?o():f.push(o());return A._InfixToPostfixCache.size>=A.InfixToPostfixCacheLimitSize&&A.ClearCache(),A._InfixToPostfixCache.set(F,{result:f,accessTime:Date.now()}),f}static ClearCache(){const F=Array.from(A._InfixToPostfixCache.entries()).sort(((F,P)=>F[1].accessTime-P[1].accessTime));for(let P=0;P<A.InfixToPostfixCacheCleanupSize;P++)A._InfixToPostfixCache.delete(F[P][0])}}A.InfixToPostfixCacheLimitSize=5e4,A.InfixToPostfixCacheCleanupSize=25e3,A._InfixToPostfixCache=new Map,A._OperatorPriority={")":0,"(":1,"||":2,"&&":3},A._Stack=["","","","","","","","","","","","","","","","","","","",""];class o extends A{constructor(F){let P=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=F,this.not=P}isTrue(F){let P=void 0!==F[this.define];return this.not&&(P=!P),P}}class j extends A{isTrue(F){return this.leftOperand.isTrue(F)||this.rightOperand.isTrue(F)}}class i extends A{isTrue(F){return this.leftOperand.isTrue(F)&&this.rightOperand.isTrue(F)}}class u extends A{constructor(F,P,f){super(),this.define=F,this.operand=P,this.testValue=f}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(F){let P=!1;const f=parseInt(void 0!=F[this.define]?F[this.define]:this.define),c=parseInt(void 0!=F[this.testValue]?F[this.testValue]:this.testValue);if(isNaN(f)||isNaN(c))return!1;switch(this.operand){case">":P=f>c;break;case"<":P=f<c;break;case"<=":P=f<=c;break;case">=":P=f>=c;break;case"==":P=f===c;break;case"!=":P=f!==c}return P}}var T=f(11488),Y=f(11533);const t=/defined\s*?\((.+?)\)/g,C=/defined\s*?\[(.+?)\]/g,L=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,J=/__decl__/,B=/light\{X\}.(\w*)/g,z=/\{X\}/g,Z=[],R=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function y(F){F.processor&&F.processor.initializeShaders&&F.processor.initializeShaders(F.processingContext)}function O(F,P,f,c){var N;null!==(N=P.processor)&&void 0!==N&&N.preProcessShaderCode&&(F=P.processor.preProcessShaderCode(F,P.isFragment)),I(F,P,(F=>{P.processCodeAfterIncludes&&(F=P.processCodeAfterIncludes(P.isFragment?"fragment":"vertex",F,P.defines));const N=function(F,P,f){let c=function(F,P){var f;if(null!==(f=P.processor)&&void 0!==f&&f.noPrecision)return F;const c=P.shouldUseHighPrecisionShader;-1===F.indexOf("precision highp float")?F=c?"precision highp float;\n"+F:"precision mediump float;\n"+F:c||(F=F.replace("precision highp float","precision mediump float"));return F}(F,P);if(!P.processor)return c;if(0===P.processor.shaderLanguage&&-1!==c.indexOf("#version 3")&&(c=c.replace("#version 300 es",""),!P.processor.parseGLES3))return c;const N=P.defines,q=k(P,f);P.processor.preProcessor&&(c=P.processor.preProcessor(c,N,q,P.isFragment,P.processingContext));const H={};c=x(c,q,P,H),P.processor.postProcessor&&(c=P.processor.postProcessor(c,N,P.isFragment,P.processingContext,f?{drawBuffersExtensionDisabled:!f.getCaps().drawBuffersExtension}:{},q,H));null!==f&&void 0!==f&&f._features.needShaderCodeInlining&&(c=f.inlineShaderCode(c));return c}(F,P,c);f(N,F)}))}function d(F,P,f){return f.processor&&f.processor.finalizeShaders?f.processor.finalizeShaders(F,P,f.processingContext):{vertexCode:F,fragmentCode:P}}function M(F){const P=/defined\((.+)\)/.exec(F);if(P&&P.length)return new o(P[1].trim(),"!"===F[0]);const f=["==","!=",">=","<=","<",">"];let c="",N=0;for(c of f)if(N=F.indexOf(c),N>-1)break;if(-1===N)return new o(F);const q=F.substring(0,N).trim(),H=F.substring(N+c.length).trim();return new u(q,c,H)}function V(F,P){const f=new H,c=F.substring(0,P);let N=F.substring(P);return N=N.substring(0,(N.indexOf("//")+1||N.length+1)-1).trim(),f.testExpression="#ifdef"===c?new o(N):"#ifndef"===c?new o(N,!0):function(F){F=F.replace(t,"defined[$1]");const P=A.infixToPostfix(F),f=[];for(const N of P)if("||"!==N&&"&&"!==N)f.push(N);else if(f.length>=2){let F=f[f.length-1],P=f[f.length-2];f.length-=2;const c="&&"==N?new i:new j;"string"===typeof F&&(F=F.replace(C,"defined($1)")),"string"===typeof P&&(P=P.replace(C,"defined($1)")),c.leftOperand="string"===typeof P?M(P):P,c.rightOperand="string"===typeof F?M(F):F,f.push(c)}let c=f[f.length-1];return"string"===typeof c&&(c=c.replace(C,"defined($1)")),"string"===typeof c?M(c):c}(N),f}function Q(F,P,f,N){let q=F.currentLine;for(;K(F,f,N);){q=F.currentLine;const H=q.substring(0,5).toLowerCase();if("#else"===H){const f=new c;return P.children.push(f),void K(F,f,N)}if("#elif"===H){const F=V(q,5);P.children.push(F),f=F}}}function K(F,P,f){for(;F.canRead;){F.lineIndex++;const N=F.currentLine;if(N.indexOf("#")>=0){const c=R.exec(N);if(c&&c.length){switch(c[0]){case"#ifdef":{const c=new q;P.children.push(c);const H=V(N,6);c.children.push(H),Q(F,c,H,f);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const c=new q;P.children.push(c);const H=V(N,7);c.children.push(H),Q(F,c,H,f);break}case"#if":{const c=new q,H=V(N,3);P.children.push(c),c.children.push(H),Q(F,c,H,f);break}}continue}}const H=new c;if(H.line=N,P.children.push(H),"#"===N[0]&&"d"===N[1]){const F=N.replace(";","").split(" ");H.additionalDefineKey=F[1],3===F.length&&(H.additionalDefineValue=F[2])}}return!1}function x(F,P,f,q){const H=new c,A=new N;return A.lineIndex=-1,A.lines=F.split("\n"),K(A,H,q),H.process(P,f,q)}function k(F,P){var f;const c=F.defines,N={};for(const q of c){const F=q.replace("#define","").replace(";","").trim().split(" ");N[F[0]]=F.length>1?F[1]:""}return 0===(null===(f=F.processor)||void 0===f?void 0:f.shaderLanguage)&&(N.GL_ES="true"),N.__VERSION__=F.version,N[F.platformName]="true",(0,Y.g)(N,null===P||void 0===P?void 0:P.isNDCHalfZRange,null===P||void 0===P?void 0:P.useReverseDepthBuffer,null===P||void 0===P?void 0:P.useExactSrgbConversions),N}function I(F,P,f){let c;for(Z.length=0;null!==(c=L.exec(F));)Z.push(c);let N=String(F),q=[F],H=!1;for(const A of Z){let F=A[1];if(-1!==F.indexOf("__decl__")&&(F=F.replace(J,""),P.supportsUniformBuffers&&(F=F.replace("Vertex","Ubo").replace("Fragment","Ubo")),F+="Declaration"),!P.includesShadersStore[F]){const c=P.shadersRepository+"ShadersInclude/"+F+".fx";return void E.loadFile(c,(c=>{P.includesShadersStore[F]=c,I(q.join(""),P,f)}))}{let f=P.includesShadersStore[F];if(A[2]){const F=A[3].split(",");for(let P=0;P<F.length;P+=2){const c=new RegExp(F[P],"g"),N=F[P+1];f=f.replace(c,N)}}if(A[4]){const F=A[5];if(-1!==F.indexOf("..")){const c=F.split(".."),N=parseInt(c[0]);let q=parseInt(c[1]),H=f.slice(0);f="",isNaN(q)&&(q=P.indexParameters[c[1]]);for(let F=N;F<q;F++)P.supportsUniformBuffers||(H=H.replace(B,((F,P)=>P+"{X}"))),f+=H.replace(z,F.toString())+"\n"}else P.supportsUniformBuffers||(f=f.replace(B,((F,P)=>P+"{X}"))),f=f.replace(z,F)}const c=[];for(const F of q){const P=F.split(A[0]);for(let F=0;F<P.length-1;F++)c.push(P[F]),c.push(f);c.push(P[P.length-1])}q=c,H=H||f.indexOf("#include<")>=0||f.indexOf("#include <")>=0}}Z.length=0,N=q.join(""),H?I(N.toString(),P,f):f(N)}const E={loadFile:(F,P,f,c,N,q)=>{throw(0,T.e)("FileTools")}}},11533:(F,P,f)=>{f.d(P,{b:()=>N,f:()=>q,g:()=>A,j:()=>H,n:()=>o});var c=f(11488);f(11471);const N={};function q(F,P){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(P?P+"\n":"")+F}function H(F,P,f,q,H,A,o){const j=o||N.loadFile;if(j){return j(F,P,f,q,H,A)}throw(0,c.e)("FileTools")}function A(F,P,f,c){if(F)return P?F.IS_NDC_HALF_ZRANGE="":delete F.IS_NDC_HALF_ZRANGE,f?F.USE_REVERSE_DEPTHBUFFER="":delete F.USE_REVERSE_DEPTHBUFFER,void(c?F.USE_EXACT_SRGB_CONVERSIONS="":delete F.USE_EXACT_SRGB_CONVERSIONS);{let F="";return P&&(F+="#define IS_NDC_HALF_ZRANGE"),f&&(F&&(F+="\n"),F+="#define USE_REVERSE_DEPTHBUFFER"),c&&(F&&(F+="\n"),F+="#define USE_EXACT_SRGB_CONVERSIONS"),F}}function o(F,P){let f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0;switch(F){case 3:{const F=(ArrayBuffer,new Int8Array(P));return c&&F.set(new Int8Array(c)),F}case 0:{const F=(ArrayBuffer,new Uint8Array(P));return c&&F.set(new Uint8Array(c)),F}case 4:{const F=P instanceof ArrayBuffer?new Int16Array(P):new Int16Array(f?P/2:P);return c&&F.set(new Int16Array(c)),F}case 5:case 8:case 9:case 10:case 2:{const F=P instanceof ArrayBuffer?new Uint16Array(P):new Uint16Array(f?P/2:P);return c&&F.set(new Uint16Array(c)),F}case 6:{const F=P instanceof ArrayBuffer?new Int32Array(P):new Int32Array(f?P/4:P);return c&&F.set(new Int32Array(c)),F}case 7:case 11:case 12:case 13:case 14:case 15:{const F=P instanceof ArrayBuffer?new Uint32Array(P):new Uint32Array(f?P/4:P);return c&&F.set(new Uint32Array(c)),F}case 1:{const F=P instanceof ArrayBuffer?new Float32Array(P):new Float32Array(f?P/4:P);return c&&F.set(new Float32Array(c)),F}}const N=(ArrayBuffer,new Uint8Array(P));return c&&N.set(new Uint8Array(c)),N}},11548:(F,P,f)=>{f.d(P,{c:()=>c});class c{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?c.ShadersRepository:c.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?c.ShadersStore:c.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?c.IncludesShadersStore:c.IncludesShadersStoreWGSL}}c.ShadersRepository="src/Shaders/",c.ShadersStore={},c.IncludesShadersStore={},c.ShadersRepositoryWGSL="src/ShadersWGSL/",c.ShadersStoreWGSL={},c.IncludesShadersStoreWGSL={}},11554:(F,P,f)=>{f.d(P,{c:()=>T,d:()=>z,g:()=>t,i:()=>Y,j:()=>C,m:()=>B,p:()=>u,s:()=>j,v:()=>i,x:()=>o,z:()=>A});class c{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.YP._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(F){F&&this.program&&F(this.program)}setEngine(F){this.YP=F}_fillEffectInformation(F,P,f,c,N,q,H,A){const o=this.YP;if(o.supportsUniformBuffers)for(const i in P)F.bindUniformBlock(i,P[i]);let j;for(this.YP.getUniforms(this,f).forEach(((F,P)=>{c[f[P]]=F})),this._uniforms=c,j=0;j<N.length;j++){null==F.getUniform(N[j])&&(N.splice(j,1),j--)}N.forEach(((F,P)=>{q[F]=P}));for(const i of o.getAttributes(this,H))A.push(i)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(F,P){const f=this._valueCache[F],c=P.updateFlag;return(void 0===f||f!==c)&&(this._valueCache[F]=c,!0)}_cacheFloat2(F,P,f){let c=this._valueCache[F];if(!c||2!==c.length)return c=[P,f],this._valueCache[F]=c,!0;let N=!1;return c[0]!==P&&(c[0]=P,N=!0),c[1]!==f&&(c[1]=f,N=!0),N}_cacheFloat3(F,P,f,c){let N=this._valueCache[F];if(!N||3!==N.length)return N=[P,f,c],this._valueCache[F]=N,!0;let q=!1;return N[0]!==P&&(N[0]=P,q=!0),N[1]!==f&&(N[1]=f,q=!0),N[2]!==c&&(N[2]=c,q=!0),q}_cacheFloat4(F,P,f,c,N){let q=this._valueCache[F];if(!q||4!==q.length)return q=[P,f,c,N],this._valueCache[F]=q,!0;let H=!1;return q[0]!==P&&(q[0]=P,H=!0),q[1]!==f&&(q[1]=f,H=!0),q[2]!==c&&(q[2]=c,H=!0),q[3]!==N&&(q[3]=N,H=!0),H}setInt(F,P){const f=this._valueCache[F];void 0!==f&&f===P||this.YP.setInt(this._uniforms[F],P)&&(this._valueCache[F]=P)}setInt2(F,P,f){this._cacheFloat2(F,P,f)&&(this.YP.setInt2(this._uniforms[F],P,f)||(this._valueCache[F]=null))}setInt3(F,P,f,c){this._cacheFloat3(F,P,f,c)&&(this.YP.setInt3(this._uniforms[F],P,f,c)||(this._valueCache[F]=null))}setInt4(F,P,f,c,N){this._cacheFloat4(F,P,f,c,N)&&(this.YP.setInt4(this._uniforms[F],P,f,c,N)||(this._valueCache[F]=null))}setIntArray(F,P){this._valueCache[F]=null,this.YP.setIntArray(this._uniforms[F],P)}setIntArray2(F,P){this._valueCache[F]=null,this.YP.setIntArray2(this._uniforms[F],P)}setIntArray3(F,P){this._valueCache[F]=null,this.YP.setIntArray3(this._uniforms[F],P)}setIntArray4(F,P){this._valueCache[F]=null,this.YP.setIntArray4(this._uniforms[F],P)}setUInt(F,P){const f=this._valueCache[F];void 0!==f&&f===P||this.YP.setUInt(this._uniforms[F],P)&&(this._valueCache[F]=P)}setUInt2(F,P,f){this._cacheFloat2(F,P,f)&&(this.YP.setUInt2(this._uniforms[F],P,f)||(this._valueCache[F]=null))}setUInt3(F,P,f,c){this._cacheFloat3(F,P,f,c)&&(this.YP.setUInt3(this._uniforms[F],P,f,c)||(this._valueCache[F]=null))}setUInt4(F,P,f,c,N){this._cacheFloat4(F,P,f,c,N)&&(this.YP.setUInt4(this._uniforms[F],P,f,c,N)||(this._valueCache[F]=null))}setUIntArray(F,P){this._valueCache[F]=null,this.YP.setUIntArray(this._uniforms[F],P)}setUIntArray2(F,P){this._valueCache[F]=null,this.YP.setUIntArray2(this._uniforms[F],P)}setUIntArray3(F,P){this._valueCache[F]=null,this.YP.setUIntArray3(this._uniforms[F],P)}setUIntArray4(F,P){this._valueCache[F]=null,this.YP.setUIntArray4(this._uniforms[F],P)}setArray(F,P){this._valueCache[F]=null,this.YP.setArray(this._uniforms[F],P)}setArray2(F,P){this._valueCache[F]=null,this.YP.setArray2(this._uniforms[F],P)}setArray3(F,P){this._valueCache[F]=null,this.YP.setArray3(this._uniforms[F],P)}setArray4(F,P){this._valueCache[F]=null,this.YP.setArray4(this._uniforms[F],P)}setMatrices(F,P){P&&(this._valueCache[F]=null,this.YP.setMatrices(this._uniforms[F],P))}setMatrix(F,P){this._cacheMatrix(F,P)&&(this.YP.setMatrices(this._uniforms[F],P.pf())||(this._valueCache[F]=null))}setMatrix3x3(F,P){this._valueCache[F]=null,this.YP.setMatrix3x3(this._uniforms[F],P)}setMatrix2x2(F,P){this._valueCache[F]=null,this.YP.setMatrix2x2(this._uniforms[F],P)}setFloat(F,P){const f=this._valueCache[F];void 0!==f&&f===P||this.YP.setFloat(this._uniforms[F],P)&&(this._valueCache[F]=P)}setVector2(F,P){this._cacheFloat2(F,P.x,P.y)&&(this.YP.setFloat2(this._uniforms[F],P.x,P.y)||(this._valueCache[F]=null))}setFloat2(F,P,f){this._cacheFloat2(F,P,f)&&(this.YP.setFloat2(this._uniforms[F],P,f)||(this._valueCache[F]=null))}setVector3(F,P){this._cacheFloat3(F,P.x,P.y,P.z)&&(this.YP.setFloat3(this._uniforms[F],P.x,P.y,P.z)||(this._valueCache[F]=null))}setFloat3(F,P,f,c){this._cacheFloat3(F,P,f,c)&&(this.YP.setFloat3(this._uniforms[F],P,f,c)||(this._valueCache[F]=null))}setVector4(F,P){this._cacheFloat4(F,P.x,P.y,P.z,P.w)&&(this.YP.setFloat4(this._uniforms[F],P.x,P.y,P.z,P.w)||(this._valueCache[F]=null))}setQuaternion(F,P){this._cacheFloat4(F,P.x,P.y,P.z,P.w)&&(this.YP.setFloat4(this._uniforms[F],P.x,P.y,P.z,P.w)||(this._valueCache[F]=null))}setFloat4(F,P,f,c,N){this._cacheFloat4(F,P,f,c,N)&&(this.YP.setFloat4(this._uniforms[F],P,f,c,N)||(this._valueCache[F]=null))}setColor3(F,P){this._cacheFloat3(F,P.r,P.g,P.b)&&(this.YP.setFloat3(this._uniforms[F],P.r,P.g,P.b)||(this._valueCache[F]=null))}setColor4(F,P,f){this._cacheFloat4(F,P.r,P.g,P.b,f)&&(this.YP.setFloat4(this._uniforms[F],P.r,P.g,P.b,f)||(this._valueCache[F]=null))}setDirectColor4(F,P){this._cacheFloat4(F,P.r,P.g,P.b,P.a)&&(this.YP.setFloat4(this._uniforms[F],P.r,P.g,P.b,P.a)||(this._valueCache[F]=null))}_getVertexShaderCode(){return this.vertexShader?this.YP._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.YP._getShaderSource(this.fragmentShader):null}}var N=f(11533);const q=new WeakMap,H={_webGLVersion:2,cachedPipelines:{}};function A(F){let P=q.get(F);if(!P){if(!F)return H;P={_webGLVersion:F.TEXTURE_BINDING_3D?2:1,_context:F,parallelShaderCompile:F.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},q.set(F,P)}return P}function o(F){q.delete(F)}function j(F,P,f,c,N,q){const H=A(c);q||(q=H._createShaderProgramInjection??T);return q(F,J(P,"vertex",c,H._contextWasLost),J(f,"fragment",c,H._contextWasLost),c,N,H.validateShaderPrograms)}function i(F,P,f,c,N){let q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,H=arguments.length>6?arguments[6]:void 0;const o=A(N);H||(H=o._createShaderProgramInjection??T);const j=o._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return H(F,L(P,"vertex",c,j,N,o._contextWasLost),L(f,"fragment",c,j,N,o._contextWasLost),N,q,o.validateShaderPrograms)}function u(F,P){const f=new c,N=A(F);return N.parallelShaderCompile&&!N.disableParallelShaderCompile&&(f.isParallelCompiled=!0),f.context=N._context,f}function T(F,P,f,c){let N=arguments.length>5?arguments[5]:void 0;const q=c.createProgram();if(F.program=q,!q)throw new Error("Unable to create program");return c.attachShader(q,P),c.attachShader(q,f),c.linkProgram(q),F.context=c,F.vertexShader=P,F.fragmentShader=f,F.isParallelCompiled||t(F,c,N),q}function Y(F,P,f){const c=F;if(c._isDisposed)return!1;const N=A(P);return!!(N&&N.parallelShaderCompile&&N.parallelShaderCompile.COMPLETION_STATUS_KHR&&c.program&&P.getProgramParameter(c.program,N.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(t(c,P,f),!0)}function t(F,P,f){const c=F.context,N=F.vertexShader,q=F.fragmentShader,H=F.program;if(!c.getProgramParameter(H,c.LINK_STATUS)){if(!P.getShaderParameter(N,P.COMPILE_STATUS)){const f=P.getShaderInfoLog(N);if(f)throw F.vertexCompilationError=f,new Error("VERTEX SHADER "+f)}if(!P.getShaderParameter(q,P.COMPILE_STATUS)){const f=P.getShaderInfoLog(q);if(f)throw F.fragmentCompilationError=f,new Error("FRAGMENT SHADER "+f)}const f=c.getProgramInfoLog(H);if(f)throw F.programLinkError=f,new Error(f)}if(f){c.validateProgram(H);if(!c.getProgramParameter(H,c.VALIDATE_STATUS)){const P=c.getProgramInfoLog(H);if(P)throw F.programValidationError=P,new Error(P)}}c.deleteShader(N),c.deleteShader(q),F.vertexShader=void 0,F.fragmentShader=void 0,F.onCompiled&&(F.onCompiled(),F.onCompiled=void 0)}function C(F,P,f,c,N,q,H,o,u){let T=arguments.length>10?arguments[10]:void 0,Y=arguments.length>11?arguments[11]:void 0,t=arguments.length>12?arguments[12]:void 0;const C=A(F.context);Y||(Y=C.createRawShaderProgramInjection??j),t||(t=C.createShaderProgramInjection??i);const L=F;L.program=c?Y(L,P,f,L.context,u):t(L,P,f,o,L.context,u),L.program.__SPECTOR_rebuildProgram=H,T()}function L(F,P,f,c,q,H){return J((0,N.f)(F,f,c),P,q,H)}function J(F,P,f,c){const N=f.createShader("vertex"===P?f.VERTEX_SHADER:f.FRAGMENT_SHADER);if(!N){let F=f.NO_ERROR,N=f.NO_ERROR;for(;(N=f.getError())!==f.NO_ERROR;)F=N;throw new Error(`Something went wrong while creating a gl ${P} shader object. gl error=${F}, gl isContextLost=${f.isContextLost()}, _contextWasLost=${c}`)}return f.shaderSource(N,F),f.compileShader(N),N}function B(F,P){P.useProgram(F)}function z(F,P){const f=F;if(!f.isParallelCompiled)return void P(F);const c=f.onCompiled;f.onCompiled=()=>{null===c||void 0===c||c(),P(F)}}},11552:(F,P,f)=>{f.d(P,{e:()=>u,h:()=>Y,i:()=>j,k:()=>i});var c=f(11471),N=f(11554),q=f(11548),H=f(11474),A=f(11530),o=f(11533);function j(F,P){return(0,N.z)(P).cachedPipelines[F]}function i(F){const P=F._name,f=F.context;if(P&&f){const F=(0,N.z)(f),c=F.cachedPipelines[P];null===c||void 0===c||c.dispose(),delete F.cachedPipelines[P]}}function u(F,P,f,N,q,H,o){let j,i;const u=(0,c.l)()?null===H||void 0===H?void 0:H.getHostDocument():null;j="string"===typeof P?P:P.vertexSource?"source:"+P.vertexSource:P.vertexElement?(null===u||void 0===u?void 0:u.getElementById(P.vertexElement))||P.vertexElement:P.vertex||P,i="string"===typeof P?P:P.fragmentSource?"source:"+P.fragmentSource:P.fragmentElement?(null===u||void 0===u?void 0:u.getElementById(P.fragmentElement))||P.fragmentElement:P.fragment||P;const Y=[void 0,void 0],t=()=>{if(Y[0]&&Y[1]){F.isFragment=!0;const[c,j]=Y;(0,A.i)(j,F,((H,j)=>{o&&(o._fragmentSourceCodeBeforeMigration=j),f&&(H=f("fragment",H));const i=(0,A.b)(c,H,F);F=null;const u=function(F,P,f,c){if(f){return{vertexSourceCode:(1===c?"//":"")+"#define SHADER_NAME vertex:"+(f.vertexElement||f.vertex||f.spectorName||f)+"\n"+F,fragmentSourceCode:(1===c?"//":"")+"#define SHADER_NAME fragment:"+(f.fragmentElement||f.fragment||f.spectorName||f)+"\n"+P}}return{vertexSourceCode:F,fragmentSourceCode:P}}(i.vertexCode,i.fragmentCode,P,q);null===N||void 0===N||N(u.vertexSourceCode,u.fragmentSourceCode)}),H)}};T(j,"Vertex","",(P=>{(0,A.f)(F),(0,A.i)(P,F,((F,c)=>{o&&(o._rawVertexSourceCode=P,o._vertexSourceCodeBeforeMigration=c),f&&(F=f("vertex",F)),Y[0]=F,t()}),H)}),q),T(i,"Fragment","Pixel",(F=>{o&&(o._rawFragmentSourceCode=F),Y[1]=F,t()}),q)}function T(F,P,f,N,H,A){if("undefined"!==typeof HTMLElement&&F instanceof HTMLElement){return void N((0,c.d)(F))}if("source:"===F.substring(0,7))return void N(F.substring(7));if("base64:"===F.substring(0,7)){return void N(window.atob(F.substring(7)))}const j=q.c.GetShadersStore(H);if(j[F+P+"Shader"])return void N(j[F+P+"Shader"]);if(f&&j[F+f+"Shader"])return void N(j[F+f+"Shader"]);let i;if(i="."===F[0]||"/"===F[0]||F.indexOf("http")>-1?F:q.c.GetShadersRepository(H)+F,!(A=A||o.j))throw new Error("loadFileInjection is not defined");A(i+"."+P.toLowerCase()+".fx",N)}const Y=(F,P,f,c)=>{try{const q=F.context?(0,N.z)(F.context):null;q&&(q.disableParallelShaderCompile=F.disableParallelCompilation);const H=F.existingPipelineContext||P(F.shaderProcessingContext);return H._name=F.name,F.name&&q&&(q.cachedPipelines[F.name]=H),f(H,F.vertex,F.fragment,!!F.createAsRaw,"","",F.rebuildRebind,F.defines,F.transformFeedbackVaryings,"",(()=>{c(H,(()=>{var P;null===(P=F.onRenderingStateCompiled)||void 0===P||P.call(F,H)}))})),H}catch(q){throw H.d.Error("Error compiling effect"),q}}},11544:(F,P,f)=>{f.r(P),f.d(P,{Effect:()=>o});var c=f(11464),N=f(11474),q=f(11548),H=f(11552),A=f(11538);class o{static get ShadersRepository(){return q.c.ShadersRepository}static set ShadersRepository(F){q.c.ShadersRepository=F}get u(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new c.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(F,P,f){let N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,q=arguments.length>4?arguments[4]:void 0,A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,j=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,T=arguments.length>9?arguments[9]:void 0,Y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",t=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,C=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new c.d,this.onErrorObservable=new c.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=F,this._key=Y;const L=this._key.replace(/\r/g,"").replace(/\n/g,"|");let J;if(P.attributes){const F=P;if(this._engine=f,this._attributesNames=F.attributes,this._uniformsNames=F.uniformsNames.concat(F.samplers),this._samplerList=F.samplers.slice(),this.defines=F.defines,this.onError=F.onError,this.onCompiled=F.onCompiled,this._fallbacks=F.fallbacks,this._indexParameters=F.indexParameters,this._transformFeedbackVaryings=F.transformFeedbackVaryings||null,this._multiTarget=!!F.multiTarget,this._shaderLanguage=F.shaderLanguage??0,this._disableParallelShaderCompilation=!!F.disableParallelShaderCompilation,F.uniformBuffersNames){this._uniformBuffersNamesList=F.uniformBuffersNames.slice();for(let P=0;P<F.uniformBuffersNames.length;P++)this._uniformBuffersNames[F.uniformBuffersNames[P]]=P}this._processFinalCode=F.processFinalCode??null,this._processCodeAfterIncludes=F.processCodeAfterIncludes??void 0,C=F.extraInitializationsAsync,J=F.existingPipelineContext}else this._engine=q,this.defines=null==A?"":A,this._uniformsNames=f.concat(N),this._samplerList=N?N.slice():[],this._attributesNames=P,this._uniformBuffersNamesList=[],this._shaderLanguage=t,this.onError=u,this.onCompiled=i,this._indexParameters=T,this._fallbacks=j;"WEBGL2"===this._engine.shaderPlatformName&&(J=(0,H.i)(L,this._engine._gl)??J),this._attributeLocationByName={},this.uniqueId=o._UniqueIdSeed++,J?(this._pipelineContext=J,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,C),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.u||this.dispose(!0)}))}async _processShaderCodeAsync(){let F=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3?arguments[3]:void 0;c&&await c(),this._processingContext=f||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const N={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:F??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:q.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:q.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,H.e)(N,this.name,this._processFinalCode,((F,f)=>{this._vertexSourceCode=F,this._fragmentSourceCode=f,this._prepareEffect(P)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.u||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(F){return this._attributes[F]}getAttributeLocationByName(F){return this._attributeLocationByName[F]}getAttributesCount(){return this._attributes.length}getUniformIndex(F){return this._uniformsNames.indexOf(F)}getUniform(F){return this._uniforms[F]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((F=>{this.executeWhenCompiled(F)}))}executeWhenCompiled(F){this.isReady()?F(this):(this.onCompileObservable.add((P=>{F(P)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(F){(0,A.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(P=>{this._processCompilationErrors(P,F)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var F;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(F=this._pipelineContext)||void 0===F?void 0:F._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var F;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(F=this._pipelineContext)||void 0===F?void 0:F._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(F,P,f,c){this._isReady=!1,this._vertexSourceCodeOverride=F,this._fragmentSourceCodeOverride=P,this.onError=(F,P)=>{c&&c(P)},this.onCompiled=()=>{var F,P;const c=this.getEngine().scenes;if(c)for(let f=0;f<c.length;f++)c[f].markAllMaterialsAsDirty(127);null===(F=(P=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===F||F.call(P,f)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(F){if(this._pipelineContext=F,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let P=0;P<this._attributesNames.length;P++){const F=this._attributesNames[P];this._attributeLocationByName[F]=this._attributes[P]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),o.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let F=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const P=this._pipelineContext;this._isReady=!1;try{const f=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),c=f?null:this.defines,N=f?this._vertexSourceCodeOverride:this._vertexSourceCode,q=f?this._fragmentSourceCodeOverride:this._fragmentSourceCode,A=this._engine;this._pipelineContext=(0,H.h)({existingPipelineContext:F?P:null,vertex:N,fragment:q,context:"WEBGL2"===A.shaderPlatformName||"WEBGL1"===A.shaderPlatformName?A._gl:void 0,rebuildRebind:(F,P,f,c)=>this._rebuildProgram(F,P,f,c),defines:c,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:f,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:f=>{P&&!F&&this._engine._deletePipelineContext(P),f&&this._onRenderingStateCompiled(f)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(P)}catch(f){this._processCompilationErrors(f,P)}}_getShaderCodeAndErrorLine(F,P,f){const c=f?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let N=null;if(P&&F){const q=P.match(c);if(q&&2===q.length){const P=parseInt(q[1]),c=F.split("\n",-1);c.length>=P&&(N=`Offending line [${P}] in ${f?"fragment":"vertex"} code: ${c[P-1]}`)}}return[F,N]}_processCompilationErrors(F){let P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=F.message;const f=this._attributesNames,c=this._fallbacks;if(N.d.Error("Unable to compile effect:"),N.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),N.d.Error(`Attributes: ${f.join(" ")}`),N.d.Error("Defines:\n"+this.defines),o.LogShaderCodeOnCompilationError){var q,H;let F=null,P=null,f=null;var A;if(null!==(q=this._pipelineContext)&&void 0!==q&&q._getVertexShaderCode()&&([f,F]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),f&&(N.d.Error("Vertex code:"),N.d.Error(f))),null!==(H=this._pipelineContext)&&void 0!==H&&H._getFragmentShaderCode())[f,P]=this._getShaderCodeAndErrorLine(null===(A=this._pipelineContext)||void 0===A?void 0:A._getFragmentShaderCode(),this._compilationError,!0),f&&(N.d.Error("Fragment code:"),N.d.Error(f));F&&N.d.Error(F),P&&N.d.Error(P)}N.d.Error("Error: "+this._compilationError);const j=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};P&&(this._pipelineContext=P,this._isReady=!0,j()),c?(this._pipelineContext=null,c.hasMoreFallbacks?(this._allFallbacksProcessed=!1,N.d.Error("Trying next fallback."),this.defines=c.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,j(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,P||j())}get isSupported(){return""===this._compilationError}_bindTexture(F,P){this._engine._bindTexture(this._samplers[F],P,F)}setTexture(F,P){this._engine.setTexture(this._samplers[F],this._uniforms[F],P,F)}setTextureArray(F,P){const f=F+"Ex";if(-1===this._samplerList.indexOf(f+"0")){const c=this._samplerList.indexOf(F);for(let F=1;F<P.length;F++){const P=f+(F-1).toString();this._samplerList.splice(c+F,0,P)}let N=0;for(const F of this._samplerList)this._samplers[F]=N,N+=1}this._engine.setTextureArray(this._samplers[F],this._uniforms[F],P,F)}bindUniformBuffer(F,P){const f=this._uniformBuffersNames[P];void 0===f||o._BaseCache[f]===F&&this._engine._features.useUBOBindingCache||(o._BaseCache[f]=F,this._engine.bindUniformBufferBase(F,f,P))}bindUniformBlock(F,P){this._engine.bindUniformBlock(this._pipelineContext,F,P)}setInt(F,P){return this._pipelineContext.setInt(F,P),this}setInt2(F,P,f){return this._pipelineContext.setInt2(F,P,f),this}setInt3(F,P,f,c){return this._pipelineContext.setInt3(F,P,f,c),this}setInt4(F,P,f,c,N){return this._pipelineContext.setInt4(F,P,f,c,N),this}setIntArray(F,P){return this._pipelineContext.setIntArray(F,P),this}setIntArray2(F,P){return this._pipelineContext.setIntArray2(F,P),this}setIntArray3(F,P){return this._pipelineContext.setIntArray3(F,P),this}setIntArray4(F,P){return this._pipelineContext.setIntArray4(F,P),this}setUInt(F,P){return this._pipelineContext.setUInt(F,P),this}setUInt2(F,P,f){return this._pipelineContext.setUInt2(F,P,f),this}setUInt3(F,P,f,c){return this._pipelineContext.setUInt3(F,P,f,c),this}setUInt4(F,P,f,c,N){return this._pipelineContext.setUInt4(F,P,f,c,N),this}setUIntArray(F,P){return this._pipelineContext.setUIntArray(F,P),this}setUIntArray2(F,P){return this._pipelineContext.setUIntArray2(F,P),this}setUIntArray3(F,P){return this._pipelineContext.setUIntArray3(F,P),this}setUIntArray4(F,P){return this._pipelineContext.setUIntArray4(F,P),this}setFloatArray(F,P){return this._pipelineContext.setArray(F,P),this}setFloatArray2(F,P){return this._pipelineContext.setArray2(F,P),this}setFloatArray3(F,P){return this._pipelineContext.setArray3(F,P),this}setFloatArray4(F,P){return this._pipelineContext.setArray4(F,P),this}setArray(F,P){return this._pipelineContext.setArray(F,P),this}setArray2(F,P){return this._pipelineContext.setArray2(F,P),this}setArray3(F,P){return this._pipelineContext.setArray3(F,P),this}setArray4(F,P){return this._pipelineContext.setArray4(F,P),this}setMatrices(F,P){return this._pipelineContext.setMatrices(F,P),this}setMatrix(F,P){return this._pipelineContext.setMatrix(F,P),this}setMatrix3x3(F,P){return this._pipelineContext.setMatrix3x3(F,P),this}setMatrix2x2(F,P){return this._pipelineContext.setMatrix2x2(F,P),this}setFloat(F,P){return this._pipelineContext.setFloat(F,P),this}setBool(F,P){return this._pipelineContext.setInt(F,P?1:0),this}setVector2(F,P){return this._pipelineContext.setVector2(F,P),this}setFloat2(F,P,f){return this._pipelineContext.setFloat2(F,P,f),this}setVector3(F,P){return this._pipelineContext.setVector3(F,P),this}setFloat3(F,P,f,c){return this._pipelineContext.setFloat3(F,P,f,c),this}setVector4(F,P){return this._pipelineContext.setVector4(F,P),this}setQuaternion(F,P){return this._pipelineContext.setQuaternion(F,P),this}setFloat4(F,P,f,c,N){return this._pipelineContext.setFloat4(F,P,f,c,N),this}setColor3(F,P){return this._pipelineContext.setColor3(F,P),this}setColor4(F,P,f){return this._pipelineContext.setColor4(F,P,f),this}setDirectColor4(F,P){return this._pipelineContext.setDirectColor4(F,P),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(o.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,H.k)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(F,P,f){let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;P&&(q.c.GetShadersStore(c)[`${F}PixelShader`]=P),f&&(q.c.GetShadersStore(c)[`${F}VertexShader`]=f)}static ResetCache(){o._BaseCache={}}}o.LogShaderCodeOnCompilationError=!0,o.PersistentMode=!1,o.AutomaticallyClearCodeCache=!1,o._UniqueIdSeed=0,o._BaseCache={},o.ShadersStore=q.c.ShadersStore,o.IncludesShadersStore=q.c.IncludesShadersStore},11488:(F,P,f)=>{f.d(P,{e:()=>N});const c={};function N(F){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!c[F])return c[F]=!0,`${F} needs to be imported before as it contains a side-effect required by your code.`}},11471:(F,P,f)=>{function c(){return"undefined"!==typeof window}function N(){return"undefined"!==typeof navigator}function q(){return"undefined"!==typeof document}function H(F){let P="",f=F.firstChild;for(;f;)3===f.nodeType&&(P+=f.textContent),f=f.nextSibling;return P}f.d(P,{d:()=>H,e:()=>q,i:()=>N,l:()=>c})},11474:(F,P,f)=>{f.d(P,{d:()=>c});class c{static _CheckLimit(F,P){let f=c._LogLimitOutputs[F];return f?f.current++:(f={limit:P,current:1},c._LogLimitOutputs[F]=f),f.current<=f.limit}static _GenerateLimitMessage(F){let P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const f=c._LogLimitOutputs[F];if(!f||!c.MessageLimitReached)return;const N=this._Levels[P];f.current===f.limit&&c[N.name](c.MessageLimitReached.replace(/%LIMIT%/g,""+f.limit).replace(/%TYPE%/g,N.name??""))}static _AddLogEntry(F){c._LogCache=F+c._LogCache,c.OnNewCacheEntry&&c.OnNewCacheEntry(F)}static _FormatMessage(F){const P=F=>F<10?"0"+F:""+F,f=new Date;return"["+P(f.getHours())+":"+P(f.getMinutes())+":"+P(f.getSeconds())+"]: "+F}static _LogDisabled(F,P){}static _LogEnabled(){let F=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,P=arguments.length>1?arguments[1]:void 0,f=arguments.length>2?arguments[2]:void 0;const N=Array.isArray(P)?P[0]:P;if(void 0!==f&&!c._CheckLimit(N,f))return;const q=c._FormatMessage(N),H=this._Levels[F],A=Array.isArray(P)?P.slice(1):[];H.logFunc&&H.logFunc("BJS - "+q,...A);const o=`<div style='color:${H.color}'>${q}</div><br>`;c._AddLogEntry(o),c._GenerateLimitMessage(N,F)}static get LogCache(){return c._LogCache}static ClearLogCache(){c._LogCache="",c._LogLimitOutputs={},c.errorsCount=0}static set LogLevels(F){c.Log=c._LogDisabled,c.Warn=c._LogDisabled,c.Error=c._LogDisabled;const P=[c.MessageLogLevel,c.WarningLogLevel,c.ErrorLogLevel];for(const f of P)if((F&f)===f){const F=this._Levels[f];c[F.name]=c._LogEnabled.bind(c,f)}}}c.NoneLogLevel=0,c.MessageLogLevel=1,c.WarningLogLevel=2,c.ErrorLogLevel=4,c.AllLogLevel=7,c.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",c._LogCache="",c._LogLimitOutputs={},c._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],c.errorsCount=0,c.Log=c._LogEnabled.bind(c,c.MessageLogLevel),c.Warn=c._LogEnabled.bind(c,c.WarningLogLevel),c.Error=c._LogEnabled.bind(c,c.ErrorLogLevel)},11464:(F,P,f)=>{f.d(P,{d:()=>H});const c="undefined"!==typeof WeakRef;class N{constructor(F){let P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;this.initialize(F,P,f,c)}initialize(F){let P=arguments.length>1&&void 0!==arguments[1]&&arguments[1],f=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;return this.mask=F,this.skipNextObservers=P,this.target=f,this.currentTarget=c,this}}class q{constructor(F,P){let f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=F,this.mask=P,this.scope=f,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let F=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(F)}}class H{static FromPromise(F,P){const f=new H;return F.then((F=>{f.notifyObservers(F)})).catch((F=>{if(!P)throw F;P.notifyObservers(F)})),f}get observers(){return this._observers}constructor(F){let P=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=P,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new N(0),F&&(this._onObserverAdded=F)}add(F){let P=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!F)return null;const N=new q(F,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);N.unregisterOnNextCall=f,P?this._observers.unshift(N):this._observers.push(N),this._onObserverAdded&&this._onObserverAdded(N),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(N,this._lastNotifiedValue);const H=c?new WeakRef(this):{deref:()=>this};return N._remove=function(){let F=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const P=H.deref();P&&(F?P.remove(N):P._remove(N))},N}addOnce(F){return this.add(F,void 0,void 0,void 0,!0)}remove(F){if(!F)return!1;F._remove=null;return-1!==this._observers.indexOf(F)&&(this._deferUnregister(F),!0)}removeCallback(F,P){for(let f=0;f<this._observers.length;f++){const c=this._observers[f];if(!c._willBeUnregistered&&(c.callback===F&&(!P||P===c.scope)))return this._deferUnregister(c),!0}return!1}_deferUnregister(F){F._willBeUnregistered||(this._numObserversMarkedAsDeleted++,F.unregisterOnNextCall=!1,F._willBeUnregistered=!0,setTimeout((()=>{this._remove(F)}),0))}_remove(F){let P=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!F)return!1;const f=this._observers.indexOf(F);return-1!==f&&(P&&this._numObserversMarkedAsDeleted--,this._observers.splice(f,1),!0)}makeObserverTopPriority(F){this._remove(F,!1),this._observers.unshift(F)}makeObserverBottomPriority(F){this._remove(F,!1),this._observers.push(F)}notifyObservers(F){let P=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,f=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,N=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=F),!this._observers.length)return!0;const q=this._eventState;q.mask=P,q.target=f,q.currentTarget=c,q.skipNextObservers=!1,q.lastReturnValue=F,q.userInfo=N;for(const H of this._observers)if(!H._willBeUnregistered&&(H.mask&P&&(H.unregisterOnNextCall&&this._deferUnregister(H),H.scope?q.lastReturnValue=H.callback.apply(H.scope,[F,q]):q.lastReturnValue=H.callback(F,q)),q.skipNextObservers))return!1;return!0}notifyObserver(F,P){let f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=P),F._willBeUnregistered)return;const c=this._eventState;c.mask=f,c.skipNextObservers=!1,F.unregisterOnNextCall&&this._deferUnregister(F),F.callback(P,c)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const F=this._observers.pop();F&&(F._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const F=new H;return F._observers=this._observers.slice(0),F}hasSpecificMask(){let F=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const P of this._observers)if(P.mask&F||P.mask===F)return!0;return!1}}},11538:(F,P,f)=>{f.d(P,{c:()=>N,f:()=>H});let c=[];class N{static SetImmediate(F){0===c.length&&setTimeout((()=>{const F=c;c=[];for(const P of F)P()}),1),c.push(F)}}function q(F,P,f){try{if(F())return P(),!0}catch(c){return null===f||void 0===f||f(c),!0}return!1}const H=function(F,P,f){let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,N=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,H=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&q(F,P,f))return null;const A=setInterval((()=>{q(F,P,f)?clearInterval(A):(N-=c,N<0&&(clearInterval(A),null===f||void 0===f||f(new Error("Operation timed out after maximum retries. "+(H||"")),!0)))}),c);return()=>clearInterval(A)}}}]);