"use strict";(self.nyfa010khv=self.nyfa010khv||[]).push([[9],{12025:(L,r,p)=>{p.d(r,{c:()=>Q,g:()=>B,l:()=>F,j:()=>q,n:()=>Z});class J{constructor(){this.children=[]}isValid(L){return!0}process(L,r,p){let J="";if(this.line){let p=this.line;const t=r.processor;if(t){var i,n,j,z,G,C;t.lineProcessor&&(p=t.lineProcessor(p,r.isFragment,r.processingContext));const J=(null===(i=r.processor)||void 0===i?void 0:i.attributeKeywordName)??"attribute",E=r.isFragment&&null!==(n=r.processor)&&void 0!==n&&n.varyingFragmentKeywordName?null===(j=r.processor)||void 0===j?void 0:j.varyingFragmentKeywordName:!r.isFragment&&null!==(z=r.processor)&&void 0!==z&&z.varyingVertexKeywordName?null===(G=r.processor)||void 0===G?void 0:G.varyingVertexKeywordName:"varying";if(!r.isFragment&&t.attributeProcessor&&this.line.startsWith(J))p=t.attributeProcessor(this.line,L,r.processingContext);else if(t.varyingProcessor&&(null!==(C=t.varyingCheck)&&void 0!==C&&C.call(t,this.line,r.isFragment)||!t.varyingCheck&&this.line.startsWith(E)))p=t.varyingProcessor(this.line,r.isFragment,L,r.processingContext);else if(t.uniformProcessor&&t.uniformRegexp&&t.uniformRegexp.test(this.line))r.lookForClosingBracketForUniformBuffer||(p=t.uniformProcessor(this.line,r.isFragment,L,r.processingContext));else if(t.uniformBufferProcessor&&t.uniformBufferRegexp&&t.uniformBufferRegexp.test(this.line))r.lookForClosingBracketForUniformBuffer||(p=t.uniformBufferProcessor(this.line,r.isFragment,r.processingContext),r.lookForClosingBracketForUniformBuffer=!0);else if(t.textureProcessor&&t.textureRegexp&&t.textureRegexp.test(this.line))p=t.textureProcessor(this.line,r.isFragment,L,r.processingContext);else if((t.uniformProcessor||t.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!r.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?t.uniformProcessor&&(p=t.uniformProcessor(this.line,r.isFragment,L,r.processingContext)):t.uniformBufferProcessor&&(p=t.uniformBufferProcessor(this.line,r.isFragment,r.processingContext),r.lookForClosingBracketForUniformBuffer=!0)}r.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(r.lookForClosingBracketForUniformBuffer=!1,t.endOfUniformBufferProcessor&&(p=t.endOfUniformBufferProcessor(this.line,r.isFragment,r.processingContext)))}J+=p+"\n"}for(const t of this.children)J+=t.process(L,r,p);return this.additionalDefineKey&&(L[this.additionalDefineKey]=this.additionalDefineValue||"true",p[this.additionalDefineKey]=L[this.additionalDefineKey]),J}}class i{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(L){this._lines.length=0;for(const r of L){if(!r||"\r"===r)continue;if("#"===r[0]){this._lines.push(r);continue}const L=r.trim();if(!L)continue;if(L.startsWith("//")){this._lines.push(r);continue}const p=L.indexOf(";");if(-1===p)this._lines.push(L);else if(p===L.length-1)L.length>1&&this._lines.push(L);else{const L=r.split(";");for(let r=0;r<L.length;r++){let p=L[r];p&&(p=p.trim(),p&&this._lines.push(p+(r!==L.length-1?";":"")))}}}}}class n extends J{process(L,r,p){for(let J=0;J<this.children.length;J++){const i=this.children[J];if(i.isValid(L))return i.process(L,r,p)}return""}}class j extends J{isValid(L){return this.testExpression.isTrue(L)}}class z{isTrue(L){return!0}static postfixToInfix(L){const r=[];for(const p of L)if(void 0===z._OperatorPriority[p])r.push(p);else{const L=r[r.length-1],J=r[r.length-2];r.length-=2,r.push(`(${J}${p}${L})`)}return r[r.length-1]}static infixToPostfix(L){const r=z._InfixToPostfixCache.get(L);if(r)return r.accessTime=Date.now(),r.result;if(!L.includes("&&")&&!L.includes("||")&&!L.includes(")")&&!L.includes("("))return[L];const p=[];let J=-1;const i=()=>{t=t.trim(),""!==t&&(p.push(t),t="")},n=L=>{J<z._Stack.length-1&&(z._Stack[++J]=L)},j=()=>z._Stack[J],G=()=>-1===J?"!!INVALID EXPRESSION!!":z._Stack[J--];let C=0,t="";for(;C<L.length;){const r=L.charAt(C),E=C<L.length-1?L.substring(C,2+C):"";if("("===r)t="",n(r);else if(")"===r){for(i();-1!==J&&"("!==j();)p.push(G());G()}else if(z._OperatorPriority[E]>1){for(i();-1!==J&&z._OperatorPriority[j()]>=z._OperatorPriority[E];)p.push(G());n(E),C++}else t+=r;C++}for(i();-1!==J;)"("===j()?G():p.push(G());return z._InfixToPostfixCache.size>=z.InfixToPostfixCacheLimitSize&&z.ClearCache(),z._InfixToPostfixCache.set(L,{result:p,accessTime:Date.now()}),p}static ClearCache(){const L=Array.from(z._InfixToPostfixCache.entries()).sort(((L,r)=>L[1].accessTime-r[1].accessTime));for(let r=0;r<z.InfixToPostfixCacheCleanupSize;r++)z._InfixToPostfixCache.delete(L[r][0])}}z.InfixToPostfixCacheLimitSize=5e4,z.InfixToPostfixCacheCleanupSize=25e3,z._InfixToPostfixCache=new Map,z._OperatorPriority={")":0,"(":1,"||":2,"&&":3},z._Stack=["","","","","","","","","","","","","","","","","","","",""];class G extends z{constructor(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=L,this.not=r}isTrue(L){let r=void 0!==L[this.define];return this.not&&(r=!r),r}}class C extends z{isTrue(L){return this.leftOperand.isTrue(L)||this.rightOperand.isTrue(L)}}class t extends z{isTrue(L){return this.leftOperand.isTrue(L)&&this.rightOperand.isTrue(L)}}class E extends z{constructor(L,r,p){super(),this.define=L,this.operand=r,this.testValue=p}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(L){let r=!1;const p=parseInt(void 0!=L[this.define]?L[this.define]:this.define),J=parseInt(void 0!=L[this.testValue]?L[this.testValue]:this.testValue);if(isNaN(p)||isNaN(J))return!1;switch(this.operand){case">":r=p>J;break;case"<":r=p<J;break;case"<=":r=p<=J;break;case">=":r=p>=J;break;case"==":r=p===J;break;case"!=":r=p!==J}return r}}var x=p(11996),w=p(12028);const g=/defined\s*?\((.+?)\)/g,b=/defined\s*?\[(.+?)\]/g,c=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,P=/__decl__/,O=/light\{X\}.(\w*)/g,h=/\{X\}/g,U=[],W=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function B(L){L.processor&&L.processor.initializeShaders&&L.processor.initializeShaders(L.processingContext)}function F(L,r,p,J){var i;null!==(i=r.processor)&&void 0!==i&&i.preProcessShaderCode&&(L=r.processor.preProcessShaderCode(L,r.isFragment)),q(L,r,(L=>{r.processCodeAfterIncludes&&(L=r.processCodeAfterIncludes(r.isFragment?"fragment":"vertex",L,r.defines));const i=function(L,r,p){let J=function(L,r){var p;if(null!==(p=r.processor)&&void 0!==p&&p.noPrecision)return L;const J=r.shouldUseHighPrecisionShader;-1===L.indexOf("precision highp float")?L=J?"precision highp float;\n"+L:"precision mediump float;\n"+L:J||(L=L.replace("precision highp float","precision mediump float"));return L}(L,r);if(!r.processor)return J;if(0===r.processor.shaderLanguage&&-1!==J.indexOf("#version 3")&&(J=J.replace("#version 300 es",""),!r.processor.parseGLES3))return J;const i=r.defines,n=a(r,p);r.processor.preProcessor&&(J=r.processor.preProcessor(J,i,n,r.isFragment,r.processingContext));const j={};J=u(J,n,r,j),r.processor.postProcessor&&(J=r.processor.postProcessor(J,i,r.isFragment,r.processingContext,p?{drawBuffersExtensionDisabled:!p.getCaps().drawBuffersExtension}:{},n,j));null!==p&&void 0!==p&&p._features.needShaderCodeInlining&&(J=p.inlineShaderCode(J));return J}(L,r,J);p(i,L)}))}function Q(L,r,p){return p.processor&&p.processor.finalizeShaders?p.processor.finalizeShaders(L,r,p.processingContext):{vertexCode:L,fragmentCode:r}}function e(L){const r=/defined\((.+)\)/.exec(L);if(r&&r.length)return new G(r[1].trim(),"!"===L[0]);const p=["==","!=",">=","<=","<",">"];let J="",i=0;for(J of p)if(i=L.indexOf(J),i>-1)break;if(-1===i)return new G(L);const n=L.substring(0,i).trim(),j=L.substring(i+J.length).trim();return new E(n,J,j)}function v(L,r){const p=new j,J=L.substring(0,r);let i=L.substring(r);return i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim(),p.testExpression="#ifdef"===J?new G(i):"#ifndef"===J?new G(i,!0):function(L){L=L.replace(g,"defined[$1]");const r=z.infixToPostfix(L),p=[];for(const i of r)if("||"!==i&&"&&"!==i)p.push(i);else if(p.length>=2){let L=p[p.length-1],r=p[p.length-2];p.length-=2;const J="&&"==i?new t:new C;"string"===typeof L&&(L=L.replace(b,"defined($1)")),"string"===typeof r&&(r=r.replace(b,"defined($1)")),J.leftOperand="string"===typeof r?e(r):r,J.rightOperand="string"===typeof L?e(L):L,p.push(J)}let J=p[p.length-1];return"string"===typeof J&&(J=J.replace(b,"defined($1)")),"string"===typeof J?e(J):J}(i),p}function y(L,r,p,i){let n=L.currentLine;for(;A(L,p,i);){n=L.currentLine;const j=n.substring(0,5).toLowerCase();if("#else"===j){const p=new J;return r.children.push(p),void A(L,p,i)}if("#elif"===j){const L=v(n,5);r.children.push(L),p=L}}}function A(L,r,p){for(;L.canRead;){L.lineIndex++;const i=L.currentLine;if(i.indexOf("#")>=0){const J=W.exec(i);if(J&&J.length){switch(J[0]){case"#ifdef":{const J=new n;r.children.push(J);const j=v(i,6);J.children.push(j),y(L,J,j,p);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const J=new n;r.children.push(J);const j=v(i,7);J.children.push(j),y(L,J,j,p);break}case"#if":{const J=new n,j=v(i,3);r.children.push(J),J.children.push(j),y(L,J,j,p);break}}continue}}const j=new J;if(j.line=i,r.children.push(j),"#"===i[0]&&"d"===i[1]){const L=i.replace(";","").split(" ");j.additionalDefineKey=L[1],3===L.length&&(j.additionalDefineValue=L[2])}}return!1}function u(L,r,p,n){const j=new J,z=new i;return z.lineIndex=-1,z.lines=L.split("\n"),A(z,j,n),j.process(r,p,n)}function a(L,r){var p;const J=L.defines,i={};for(const n of J){const L=n.replace("#define","").replace(";","").trim().split(" ");i[L[0]]=L.length>1?L[1]:""}return 0===(null===(p=L.processor)||void 0===p?void 0:p.shaderLanguage)&&(i.GL_ES="true"),i.__VERSION__=L.version,i[L.platformName]="true",(0,w.h)(i,null===r||void 0===r?void 0:r.isNDCHalfZRange,null===r||void 0===r?void 0:r.o,null===r||void 0===r?void 0:r.useExactSrgbConversions),i}function q(L,r,p){let J;for(U.length=0;null!==(J=c.exec(L));)U.push(J);let i=String(L),n=[L],j=!1;for(const z of U){let L=z[1];if(-1!==L.indexOf("__decl__")&&(L=L.replace(P,""),r.supportsUniformBuffers&&(L=L.replace("Vertex","Ubo").replace("Fragment","Ubo")),L+="Declaration"),!r.includesShadersStore[L]){const J=r.shadersRepository+"ShadersInclude/"+L+".fx";return void Z.loadFile(J,(J=>{r.includesShadersStore[L]=J,q(n.join(""),r,p)}))}{let p=r.includesShadersStore[L];if(z[2]){const L=z[3].split(",");for(let r=0;r<L.length;r+=2){const J=new RegExp(L[r],"g"),i=L[r+1];p=p.replace(J,i)}}if(z[4]){const L=z[5];if(-1!==L.indexOf("..")){const J=L.split(".."),i=parseInt(J[0]);let n=parseInt(J[1]),j=p.slice(0);p="",isNaN(n)&&(n=r.indexParameters[J[1]]);for(let L=i;L<n;L++)r.supportsUniformBuffers||(j=j.replace(O,((L,r)=>r+"{X}"))),p+=j.replace(h,L.toString())+"\n"}else r.supportsUniformBuffers||(p=p.replace(O,((L,r)=>r+"{X}"))),p=p.replace(h,L)}const J=[];for(const L of n){const r=L.split(z[0]);for(let L=0;L<r.length-1;L++)J.push(r[L]),J.push(p);J.push(r[r.length-1])}n=J,j=j||p.indexOf("#include<")>=0||p.indexOf("#include <")>=0}}U.length=0,i=n.join(""),j?q(i.toString(),r,p):p(i)}const Z={loadFile:(L,r,p,J,i,n)=>{throw(0,x.d)("FileTools")}}},12028:(L,r,p)=>{p.d(r,{c:()=>i,g:()=>n,h:()=>z,i:()=>j,l:()=>G});var J=p(11996);p(11971);const i={};function n(L,r){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(r?r+"\n":"")+L}function j(L,r,p,n,j,z,G){const C=G||i.loadFile;if(C){return C(L,r,p,n,j,z)}throw(0,J.d)("FileTools")}function z(L,r,p,J){if(L)return r?L.IS_NDC_HALF_ZRANGE="":delete L.IS_NDC_HALF_ZRANGE,p?L.USE_REVERSE_DEPTHBUFFER="":delete L.USE_REVERSE_DEPTHBUFFER,void(J?L.USE_EXACT_SRGB_CONVERSIONS="":delete L.USE_EXACT_SRGB_CONVERSIONS);{let L="";return r&&(L+="#define IS_NDC_HALF_ZRANGE"),p&&(L&&(L+="\n"),L+="#define USE_REVERSE_DEPTHBUFFER"),J&&(L&&(L+="\n"),L+="#define USE_EXACT_SRGB_CONVERSIONS"),L}}function G(L,r){let p=arguments.length>2&&void 0!==arguments[2]&&arguments[2],J=arguments.length>3?arguments[3]:void 0;switch(L){case 3:{const L=(ArrayBuffer,new Int8Array(r));return J&&L.set(new Int8Array(J)),L}case 0:{const L=(ArrayBuffer,new Uint8Array(r));return J&&L.set(new Uint8Array(J)),L}case 4:{const L=r instanceof ArrayBuffer?new Int16Array(r):new Int16Array(p?r/2:r);return J&&L.set(new Int16Array(J)),L}case 5:case 8:case 9:case 10:case 2:{const L=r instanceof ArrayBuffer?new Uint16Array(r):new Uint16Array(p?r/2:r);return J&&L.set(new Uint16Array(J)),L}case 6:{const L=r instanceof ArrayBuffer?new Int32Array(r):new Int32Array(p?r/4:r);return J&&L.set(new Int32Array(J)),L}case 7:case 11:case 12:case 13:case 14:case 15:{const L=r instanceof ArrayBuffer?new Uint32Array(r):new Uint32Array(p?r/4:r);return J&&L.set(new Uint32Array(J)),L}case 1:{const L=r instanceof ArrayBuffer?new Float32Array(r):new Float32Array(p?r/4:r);return J&&L.set(new Float32Array(J)),L}}const i=(ArrayBuffer,new Uint8Array(r));return J&&i.set(new Uint8Array(J)),i}},12045:(L,r,p)=>{p.d(r,{d:()=>J});class J{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?J.ShadersRepository:J.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?J.ShadersStore:J.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?J.IncludesShadersStore:J.IncludesShadersStoreWGSL}}J.ShadersRepository="src/Shaders/",J.ShadersStore={},J.IncludesShadersStore={},J.ShadersRepositoryWGSL="src/ShadersWGSL/",J.ShadersStoreWGSL={},J.IncludesShadersStoreWGSL={}},12049:(L,r,p)=>{p.d(r,{c:()=>x,d:()=>h,g:()=>g,k:()=>w,n:()=>b,p:()=>O,r:()=>E,s:()=>C,w:()=>t,z:()=>G,C:()=>z});class J{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.gr._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(L){L&&this.program&&L(this.program)}setEngine(L){this.gr=L}_fillEffectInformation(L,r,p,J,i,n,j,z){const G=this.gr;if(G.supportsUniformBuffers)for(const t in r)L.bindUniformBlock(t,r[t]);let C;for(this.gr.getUniforms(this,p).forEach(((L,r)=>{J[p[r]]=L})),this._uniforms=J,C=0;C<i.length;C++){null==L.getUniform(i[C])&&(i.splice(C,1),C--)}i.forEach(((L,r)=>{n[L]=r}));for(const t of G.getAttributes(this,j))z.push(t)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(L,r){const p=this._valueCache[L],J=r.updateFlag;return(void 0===p||p!==J)&&(this._valueCache[L]=J,!0)}_cacheFloat2(L,r,p){let J=this._valueCache[L];if(!J||2!==J.length)return J=[r,p],this._valueCache[L]=J,!0;let i=!1;return J[0]!==r&&(J[0]=r,i=!0),J[1]!==p&&(J[1]=p,i=!0),i}_cacheFloat3(L,r,p,J){let i=this._valueCache[L];if(!i||3!==i.length)return i=[r,p,J],this._valueCache[L]=i,!0;let n=!1;return i[0]!==r&&(i[0]=r,n=!0),i[1]!==p&&(i[1]=p,n=!0),i[2]!==J&&(i[2]=J,n=!0),n}_cacheFloat4(L,r,p,J,i){let n=this._valueCache[L];if(!n||4!==n.length)return n=[r,p,J,i],this._valueCache[L]=n,!0;let j=!1;return n[0]!==r&&(n[0]=r,j=!0),n[1]!==p&&(n[1]=p,j=!0),n[2]!==J&&(n[2]=J,j=!0),n[3]!==i&&(n[3]=i,j=!0),j}setInt(L,r){const p=this._valueCache[L];void 0!==p&&p===r||this.gr.setInt(this._uniforms[L],r)&&(this._valueCache[L]=r)}setInt2(L,r,p){this._cacheFloat2(L,r,p)&&(this.gr.setInt2(this._uniforms[L],r,p)||(this._valueCache[L]=null))}setInt3(L,r,p,J){this._cacheFloat3(L,r,p,J)&&(this.gr.setInt3(this._uniforms[L],r,p,J)||(this._valueCache[L]=null))}setInt4(L,r,p,J,i){this._cacheFloat4(L,r,p,J,i)&&(this.gr.setInt4(this._uniforms[L],r,p,J,i)||(this._valueCache[L]=null))}setIntArray(L,r){this._valueCache[L]=null,this.gr.setIntArray(this._uniforms[L],r)}setIntArray2(L,r){this._valueCache[L]=null,this.gr.setIntArray2(this._uniforms[L],r)}setIntArray3(L,r){this._valueCache[L]=null,this.gr.setIntArray3(this._uniforms[L],r)}setIntArray4(L,r){this._valueCache[L]=null,this.gr.setIntArray4(this._uniforms[L],r)}setUInt(L,r){const p=this._valueCache[L];void 0!==p&&p===r||this.gr.setUInt(this._uniforms[L],r)&&(this._valueCache[L]=r)}setUInt2(L,r,p){this._cacheFloat2(L,r,p)&&(this.gr.setUInt2(this._uniforms[L],r,p)||(this._valueCache[L]=null))}setUInt3(L,r,p,J){this._cacheFloat3(L,r,p,J)&&(this.gr.setUInt3(this._uniforms[L],r,p,J)||(this._valueCache[L]=null))}setUInt4(L,r,p,J,i){this._cacheFloat4(L,r,p,J,i)&&(this.gr.setUInt4(this._uniforms[L],r,p,J,i)||(this._valueCache[L]=null))}setUIntArray(L,r){this._valueCache[L]=null,this.gr.setUIntArray(this._uniforms[L],r)}setUIntArray2(L,r){this._valueCache[L]=null,this.gr.setUIntArray2(this._uniforms[L],r)}setUIntArray3(L,r){this._valueCache[L]=null,this.gr.setUIntArray3(this._uniforms[L],r)}setUIntArray4(L,r){this._valueCache[L]=null,this.gr.setUIntArray4(this._uniforms[L],r)}setArray(L,r){this._valueCache[L]=null,this.gr.setArray(this._uniforms[L],r)}setArray2(L,r){this._valueCache[L]=null,this.gr.setArray2(this._uniforms[L],r)}setArray3(L,r){this._valueCache[L]=null,this.gr.setArray3(this._uniforms[L],r)}setArray4(L,r){this._valueCache[L]=null,this.gr.setArray4(this._uniforms[L],r)}setMatrices(L,r){r&&(this._valueCache[L]=null,this.gr.setMatrices(this._uniforms[L],r))}setMatrix(L,r){this._cacheMatrix(L,r)&&(this.gr.setMatrices(this._uniforms[L],r.mz())||(this._valueCache[L]=null))}setMatrix3x3(L,r){this._valueCache[L]=null,this.gr.setMatrix3x3(this._uniforms[L],r)}setMatrix2x2(L,r){this._valueCache[L]=null,this.gr.setMatrix2x2(this._uniforms[L],r)}setFloat(L,r){const p=this._valueCache[L];void 0!==p&&p===r||this.gr.setFloat(this._uniforms[L],r)&&(this._valueCache[L]=r)}setVector2(L,r){this._cacheFloat2(L,r.x,r.y)&&(this.gr.setFloat2(this._uniforms[L],r.x,r.y)||(this._valueCache[L]=null))}setFloat2(L,r,p){this._cacheFloat2(L,r,p)&&(this.gr.setFloat2(this._uniforms[L],r,p)||(this._valueCache[L]=null))}setVector3(L,r){this._cacheFloat3(L,r.x,r.y,r.z)&&(this.gr.setFloat3(this._uniforms[L],r.x,r.y,r.z)||(this._valueCache[L]=null))}setFloat3(L,r,p,J){this._cacheFloat3(L,r,p,J)&&(this.gr.setFloat3(this._uniforms[L],r,p,J)||(this._valueCache[L]=null))}setVector4(L,r){this._cacheFloat4(L,r.x,r.y,r.z,r.w)&&(this.gr.setFloat4(this._uniforms[L],r.x,r.y,r.z,r.w)||(this._valueCache[L]=null))}setQuaternion(L,r){this._cacheFloat4(L,r.x,r.y,r.z,r.w)&&(this.gr.setFloat4(this._uniforms[L],r.x,r.y,r.z,r.w)||(this._valueCache[L]=null))}setFloat4(L,r,p,J,i){this._cacheFloat4(L,r,p,J,i)&&(this.gr.setFloat4(this._uniforms[L],r,p,J,i)||(this._valueCache[L]=null))}setColor3(L,r){this._cacheFloat3(L,r.r,r.g,r.b)&&(this.gr.setFloat3(this._uniforms[L],r.r,r.g,r.b)||(this._valueCache[L]=null))}setColor4(L,r,p){this._cacheFloat4(L,r.r,r.g,r.b,p)&&(this.gr.setFloat4(this._uniforms[L],r.r,r.g,r.b,p)||(this._valueCache[L]=null))}setDirectColor4(L,r){this._cacheFloat4(L,r.r,r.g,r.b,r.a)&&(this.gr.setFloat4(this._uniforms[L],r.r,r.g,r.b,r.a)||(this._valueCache[L]=null))}_getVertexShaderCode(){return this.vertexShader?this.gr._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.gr._getShaderSource(this.fragmentShader):null}}var i=p(12028);const n=new WeakMap,j={_webGLVersion:2,cachedPipelines:{}};function z(L){let r=n.get(L);if(!r){if(!L)return j;r={_webGLVersion:L.TEXTURE_BINDING_3D?2:1,_context:L,parallelShaderCompile:L.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},n.set(L,r)}return r}function G(L){n.delete(L)}function C(L,r,p,J,i,n){const j=z(J);n||(n=j._createShaderProgramInjection??x);return n(L,P(r,"vertex",J,j._contextWasLost),P(p,"fragment",J,j._contextWasLost),J,i,j.validateShaderPrograms)}function t(L,r,p,J,i){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,j=arguments.length>6?arguments[6]:void 0;const G=z(i);j||(j=G._createShaderProgramInjection??x);const C=G._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return j(L,c(r,"vertex",J,C,i,G._contextWasLost),c(p,"fragment",J,C,i,G._contextWasLost),i,n,G.validateShaderPrograms)}function E(L,r){const p=new J,i=z(L);return i.parallelShaderCompile&&!i.disableParallelShaderCompile&&(p.isParallelCompiled=!0),p.context=i._context,p}function x(L,r,p,J){let i=arguments.length>5?arguments[5]:void 0;const n=J.createProgram();if(L.program=n,!n)throw new Error("Unable to create program");return J.attachShader(n,r),J.attachShader(n,p),J.linkProgram(n),L.context=J,L.vertexShader=r,L.fragmentShader=p,L.isParallelCompiled||g(L,J,i),n}function w(L,r,p){const J=L;if(J._isDisposed)return!1;const i=z(r);return!!(i&&i.parallelShaderCompile&&i.parallelShaderCompile.COMPLETION_STATUS_KHR&&J.program&&r.getProgramParameter(J.program,i.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(g(J,r,p),!0)}function g(L,r,p){const J=L.context,i=L.vertexShader,n=L.fragmentShader,j=L.program;if(!J.getProgramParameter(j,J.LINK_STATUS)){if(!r.getShaderParameter(i,r.COMPILE_STATUS)){const p=r.getShaderInfoLog(i);if(p)throw L.vertexCompilationError=p,new Error("VERTEX SHADER "+p)}if(!r.getShaderParameter(n,r.COMPILE_STATUS)){const p=r.getShaderInfoLog(n);if(p)throw L.fragmentCompilationError=p,new Error("FRAGMENT SHADER "+p)}const p=J.getProgramInfoLog(j);if(p)throw L.programLinkError=p,new Error(p)}if(p){J.validateProgram(j);if(!J.getProgramParameter(j,J.VALIDATE_STATUS)){const r=J.getProgramInfoLog(j);if(r)throw L.programValidationError=r,new Error(r)}}J.deleteShader(i),J.deleteShader(n),L.vertexShader=void 0,L.fragmentShader=void 0,L.onCompiled&&(L.onCompiled(),L.onCompiled=void 0)}function b(L,r,p,J,i,n,j,G,E){let x=arguments.length>10?arguments[10]:void 0,w=arguments.length>11?arguments[11]:void 0,g=arguments.length>12?arguments[12]:void 0;const b=z(L.context);w||(w=b.createRawShaderProgramInjection??C),g||(g=b.createShaderProgramInjection??t);const c=L;c.program=J?w(c,r,p,c.context,E):g(c,r,p,G,c.context,E),c.program.__SPECTOR_rebuildProgram=j,x()}function c(L,r,p,J,n,j){return P((0,i.g)(L,p,J),r,n,j)}function P(L,r,p,J){const i=p.createShader("vertex"===r?p.VERTEX_SHADER:p.FRAGMENT_SHADER);if(!i){let L=p.NO_ERROR,i=p.NO_ERROR;for(;(i=p.getError())!==p.NO_ERROR;)L=i;throw new Error(`Something went wrong while creating a gl ${r} shader object. gl error=${L}, gl isContextLost=${p.isContextLost()}, _contextWasLost=${J}`)}return p.shaderSource(i,L),p.compileShader(i),i}function O(L,r){r.useProgram(L)}function h(L,r){const p=L;if(!p.isParallelCompiled)return void r(L);const J=p.onCompiled;p.onCompiled=()=>{null===J||void 0===J||J(),r(L)}}},12047:(L,r,p)=>{p.d(r,{d:()=>E,f:()=>w,h:()=>C,j:()=>t});var J=p(11971),i=p(12049),n=p(12045),j=p(11975),z=p(12025),G=p(12028);function C(L,r){return(0,i.C)(r).cachedPipelines[L]}function t(L){const r=L._name,p=L.context;if(r&&p){const L=(0,i.C)(p),J=L.cachedPipelines[r];null===J||void 0===J||J.dispose(),delete L.cachedPipelines[r]}}function E(L,r,p,i,n,j,G){let C,t;const E=(0,J.k)()?null===j||void 0===j?void 0:j.getHostDocument():null;C="string"===typeof r?r:r.vertexSource?"source:"+r.vertexSource:r.vertexElement?(null===E||void 0===E?void 0:E.getElementById(r.vertexElement))||r.vertexElement:r.vertex||r,t="string"===typeof r?r:r.fragmentSource?"source:"+r.fragmentSource:r.fragmentElement?(null===E||void 0===E?void 0:E.getElementById(r.fragmentElement))||r.fragmentElement:r.fragment||r;const w=[void 0,void 0],g=()=>{if(w[0]&&w[1]){L.isFragment=!0;const[J,C]=w;(0,z.l)(C,L,((j,C)=>{G&&(G._fragmentSourceCodeBeforeMigration=C),p&&(j=p("fragment",j));const t=(0,z.c)(J,j,L);L=null;const E=function(L,r,p,J){if(p){return{vertexSourceCode:(1===J?"//":"")+"#define SHADER_NAME vertex:"+(p.vertexElement||p.vertex||p.spectorName||p)+"\n"+L,fragmentSourceCode:(1===J?"//":"")+"#define SHADER_NAME fragment:"+(p.fragmentElement||p.fragment||p.spectorName||p)+"\n"+r}}return{vertexSourceCode:L,fragmentSourceCode:r}}(t.vertexCode,t.fragmentCode,r,n);null===i||void 0===i||i(E.vertexSourceCode,E.fragmentSourceCode)}),j)}};x(C,"Vertex","",(r=>{(0,z.g)(L),(0,z.l)(r,L,((L,J)=>{G&&(G._rawVertexSourceCode=r,G._vertexSourceCodeBeforeMigration=J),p&&(L=p("vertex",L)),w[0]=L,g()}),j)}),n),x(t,"Fragment","Pixel",(L=>{G&&(G._rawFragmentSourceCode=L),w[1]=L,g()}),n)}function x(L,r,p,i,j,z){if("undefined"!==typeof HTMLElement&&L instanceof HTMLElement){return void i((0,J.b)(L))}if("source:"===L.substring(0,7))return void i(L.substring(7));if("base64:"===L.substring(0,7)){return void i(window.atob(L.substring(7)))}const C=n.d.GetShadersStore(j);if(C[L+r+"Shader"])return void i(C[L+r+"Shader"]);if(p&&C[L+p+"Shader"])return void i(C[L+p+"Shader"]);let t;if(t="."===L[0]||"/"===L[0]||L.indexOf("http")>-1?L:n.d.GetShadersRepository(j)+L,!(z=z||G.i))throw new Error("loadFileInjection is not defined");z(t+"."+r.toLowerCase()+".fx",i)}const w=(L,r,p,J)=>{try{const n=L.context?(0,i.C)(L.context):null;n&&(n.disableParallelShaderCompile=L.disableParallelCompilation);const j=L.existingPipelineContext||r(L.shaderProcessingContext);return j._name=L.name,L.name&&n&&(n.cachedPipelines[L.name]=j),p(j,L.vertex,L.fragment,!!L.createAsRaw,"","",L.rebuildRebind,L.defines,L.transformFeedbackVaryings,"",(()=>{J(j,(()=>{var r;null===(r=L.onRenderingStateCompiled)||void 0===r||r.call(L,j)}))})),j}catch(n){throw j.d.Error("Error compiling effect"),n}}},12043:(L,r,p)=>{p.r(r),p.d(r,{Effect:()=>G});var J=p(11964),i=p(11975),n=p(12045),j=p(12047),z=p(12032);class G{static get ShadersRepository(){return n.d.ShadersRepository}static set ShadersRepository(L){n.d.ShadersRepository=L}get P(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new J.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(L,r,p){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0,z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,t=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,E=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,x=arguments.length>9?arguments[9]:void 0,w=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",g=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,b=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new J.c,this.onErrorObservable=new J.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=L,this._key=w;const c=this._key.replace(/\r/g,"").replace(/\n/g,"|");let P;if(r.attributes){const L=r;if(this._engine=p,this._attributesNames=L.attributes,this._uniformsNames=L.uniformsNames.concat(L.samplers),this._samplerList=L.samplers.slice(),this.defines=L.defines,this.onError=L.onError,this.onCompiled=L.onCompiled,this._fallbacks=L.fallbacks,this._indexParameters=L.indexParameters,this._transformFeedbackVaryings=L.transformFeedbackVaryings||null,this._multiTarget=!!L.multiTarget,this._shaderLanguage=L.shaderLanguage??0,this._disableParallelShaderCompilation=!!L.disableParallelShaderCompilation,L.uniformBuffersNames){this._uniformBuffersNamesList=L.uniformBuffersNames.slice();for(let r=0;r<L.uniformBuffersNames.length;r++)this._uniformBuffersNames[L.uniformBuffersNames[r]]=r}this._processFinalCode=L.processFinalCode??null,this._processCodeAfterIncludes=L.processCodeAfterIncludes??void 0,b=L.extraInitializationsAsync,P=L.existingPipelineContext}else this._engine=n,this.defines=null==z?"":z,this._uniformsNames=p.concat(i),this._samplerList=i?i.slice():[],this._attributesNames=r,this._uniformBuffersNamesList=[],this._shaderLanguage=g,this.onError=E,this.onCompiled=t,this._indexParameters=x,this._fallbacks=C;"WEBGL2"===this._engine.shaderPlatformName&&(P=(0,j.h)(c,this._engine._gl)??P),this._attributeLocationByName={},this.uniqueId=G._UniqueIdSeed++,P?(this._pipelineContext=P,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,b),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.P||this.dispose(!0)}))}async _processShaderCodeAsync(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,J=arguments.length>3?arguments[3]:void 0;J&&await J(),this._processingContext=p||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const i={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:L??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:n.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:n.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,o:this._engine.o,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,j.d)(i,this.name,this._processFinalCode,((L,p)=>{this._vertexSourceCode=L,this._fragmentSourceCode=p,this._prepareEffect(r)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.P||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(L){return this._attributes[L]}getAttributeLocationByName(L){return this._attributeLocationByName[L]}getAttributesCount(){return this._attributes.length}getUniformIndex(L){return this._uniformsNames.indexOf(L)}getUniform(L){return this._uniforms[L]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((L=>{this.executeWhenCompiled(L)}))}executeWhenCompiled(L){this.isReady()?L(this):(this.onCompileObservable.add((r=>{L(r)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(L){(0,z.g)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(r=>{this._processCompilationErrors(r,L)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var L;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(L=this._pipelineContext)||void 0===L?void 0:L._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var L;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(L=this._pipelineContext)||void 0===L?void 0:L._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,o:this._engine.o,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(L,r,p,J){this._isReady=!1,this._vertexSourceCodeOverride=L,this._fragmentSourceCodeOverride=r,this.onError=(L,r)=>{J&&J(r)},this.onCompiled=()=>{var L,r;const J=this.getEngine().scenes;if(J)for(let p=0;p<J.length;p++)J[p].markAllMaterialsAsDirty(127);null===(L=(r=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===L||L.call(r,p)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(L){if(this._pipelineContext=L,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let r=0;r<this._attributesNames.length;r++){const L=this._attributesNames[r];this._attributeLocationByName[L]=this._attributes[r]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),G.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=this._pipelineContext;this._isReady=!1;try{const p=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),J=p?null:this.defines,i=p?this._vertexSourceCodeOverride:this._vertexSourceCode,n=p?this._fragmentSourceCodeOverride:this._fragmentSourceCode,z=this._engine;this._pipelineContext=(0,j.f)({existingPipelineContext:L?r:null,vertex:i,fragment:n,context:"WEBGL2"===z.shaderPlatformName||"WEBGL1"===z.shaderPlatformName?z._gl:void 0,rebuildRebind:(L,r,p,J)=>this._rebuildProgram(L,r,p,J),defines:J,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:p,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:p=>{r&&!L&&this._engine._deletePipelineContext(r),p&&this._onRenderingStateCompiled(p)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(p){this._processCompilationErrors(p,r)}}_getShaderCodeAndErrorLine(L,r,p){const J=p?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let i=null;if(r&&L){const n=r.match(J);if(n&&2===n.length){const r=parseInt(n[1]),J=L.split("\n",-1);J.length>=r&&(i=`Offending line [${r}] in ${p?"fragment":"vertex"} code: ${J[r-1]}`)}}return[L,i]}_processCompilationErrors(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=L.message;const p=this._attributesNames,J=this._fallbacks;if(i.d.Error("Unable to compile effect:"),i.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),i.d.Error(`Attributes: ${p.join(" ")}`),i.d.Error("Defines:\n"+this.defines),G.LogShaderCodeOnCompilationError){var n,j;let L=null,r=null,p=null;var z;if(null!==(n=this._pipelineContext)&&void 0!==n&&n._getVertexShaderCode()&&([p,L]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),p&&(i.d.Error("Vertex code:"),i.d.Error(p))),null!==(j=this._pipelineContext)&&void 0!==j&&j._getFragmentShaderCode())[p,r]=this._getShaderCodeAndErrorLine(null===(z=this._pipelineContext)||void 0===z?void 0:z._getFragmentShaderCode(),this._compilationError,!0),p&&(i.d.Error("Fragment code:"),i.d.Error(p));L&&i.d.Error(L),r&&i.d.Error(r)}i.d.Error("Error: "+this._compilationError);const C=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};r&&(this._pipelineContext=r,this._isReady=!0,C()),J?(this._pipelineContext=null,J.hasMoreFallbacks?(this._allFallbacksProcessed=!1,i.d.Error("Trying next fallback."),this.defines=J.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,C(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,r||C())}get isSupported(){return""===this._compilationError}_bindTexture(L,r){this._engine._bindTexture(this._samplers[L],r,L)}setTexture(L,r){this._engine.setTexture(this._samplers[L],this._uniforms[L],r,L)}setTextureArray(L,r){const p=L+"Ex";if(-1===this._samplerList.indexOf(p+"0")){const J=this._samplerList.indexOf(L);for(let L=1;L<r.length;L++){const r=p+(L-1).toString();this._samplerList.splice(J+L,0,r)}let i=0;for(const L of this._samplerList)this._samplers[L]=i,i+=1}this._engine.setTextureArray(this._samplers[L],this._uniforms[L],r,L)}bindUniformBuffer(L,r){const p=this._uniformBuffersNames[r];void 0===p||G._BaseCache[p]===L&&this._engine._features.useUBOBindingCache||(G._BaseCache[p]=L,this._engine.bindUniformBufferBase(L,p,r))}bindUniformBlock(L,r){this._engine.bindUniformBlock(this._pipelineContext,L,r)}setInt(L,r){return this._pipelineContext.setInt(L,r),this}setInt2(L,r,p){return this._pipelineContext.setInt2(L,r,p),this}setInt3(L,r,p,J){return this._pipelineContext.setInt3(L,r,p,J),this}setInt4(L,r,p,J,i){return this._pipelineContext.setInt4(L,r,p,J,i),this}setIntArray(L,r){return this._pipelineContext.setIntArray(L,r),this}setIntArray2(L,r){return this._pipelineContext.setIntArray2(L,r),this}setIntArray3(L,r){return this._pipelineContext.setIntArray3(L,r),this}setIntArray4(L,r){return this._pipelineContext.setIntArray4(L,r),this}setUInt(L,r){return this._pipelineContext.setUInt(L,r),this}setUInt2(L,r,p){return this._pipelineContext.setUInt2(L,r,p),this}setUInt3(L,r,p,J){return this._pipelineContext.setUInt3(L,r,p,J),this}setUInt4(L,r,p,J,i){return this._pipelineContext.setUInt4(L,r,p,J,i),this}setUIntArray(L,r){return this._pipelineContext.setUIntArray(L,r),this}setUIntArray2(L,r){return this._pipelineContext.setUIntArray2(L,r),this}setUIntArray3(L,r){return this._pipelineContext.setUIntArray3(L,r),this}setUIntArray4(L,r){return this._pipelineContext.setUIntArray4(L,r),this}setFloatArray(L,r){return this._pipelineContext.setArray(L,r),this}setFloatArray2(L,r){return this._pipelineContext.setArray2(L,r),this}setFloatArray3(L,r){return this._pipelineContext.setArray3(L,r),this}setFloatArray4(L,r){return this._pipelineContext.setArray4(L,r),this}setArray(L,r){return this._pipelineContext.setArray(L,r),this}setArray2(L,r){return this._pipelineContext.setArray2(L,r),this}setArray3(L,r){return this._pipelineContext.setArray3(L,r),this}setArray4(L,r){return this._pipelineContext.setArray4(L,r),this}setMatrices(L,r){return this._pipelineContext.setMatrices(L,r),this}setMatrix(L,r){return this._pipelineContext.setMatrix(L,r),this}setMatrix3x3(L,r){return this._pipelineContext.setMatrix3x3(L,r),this}setMatrix2x2(L,r){return this._pipelineContext.setMatrix2x2(L,r),this}setFloat(L,r){return this._pipelineContext.setFloat(L,r),this}setBool(L,r){return this._pipelineContext.setInt(L,r?1:0),this}setVector2(L,r){return this._pipelineContext.setVector2(L,r),this}setFloat2(L,r,p){return this._pipelineContext.setFloat2(L,r,p),this}setVector3(L,r){return this._pipelineContext.setVector3(L,r),this}setFloat3(L,r,p,J){return this._pipelineContext.setFloat3(L,r,p,J),this}setVector4(L,r){return this._pipelineContext.setVector4(L,r),this}setQuaternion(L,r){return this._pipelineContext.setQuaternion(L,r),this}setFloat4(L,r,p,J,i){return this._pipelineContext.setFloat4(L,r,p,J,i),this}setColor3(L,r){return this._pipelineContext.setColor3(L,r),this}setColor4(L,r,p){return this._pipelineContext.setColor4(L,r,p),this}setDirectColor4(L,r){return this._pipelineContext.setDirectColor4(L,r),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(G.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,j.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;r&&(n.d.GetShadersStore(J)[`${L}PixelShader`]=r),p&&(n.d.GetShadersStore(J)[`${L}VertexShader`]=p)}static ResetCache(){G._BaseCache={}}}G.LogShaderCodeOnCompilationError=!0,G.PersistentMode=!1,G.AutomaticallyClearCodeCache=!1,G._UniqueIdSeed=0,G._BaseCache={},G.ShadersStore=n.d.ShadersStore,G.IncludesShadersStore=n.d.IncludesShadersStore},11996:(L,r,p)=>{p.d(r,{d:()=>i});const J={};function i(L){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!J[L])return J[L]=!0,`${L} needs to be imported before as it contains a side-effect required by your code.`}},11971:(L,r,p)=>{function J(){return"undefined"!==typeof window}function i(){return"undefined"!==typeof navigator}function n(){return"undefined"!==typeof document}function j(L){let r="",p=L.firstChild;for(;p;)3===p.nodeType&&(r+=p.textContent),p=p.nextSibling;return r}p.d(r,{b:()=>j,e:()=>n,i:()=>i,k:()=>J})},11975:(L,r,p)=>{p.d(r,{d:()=>J});class J{static _CheckLimit(L,r){let p=J._LogLimitOutputs[L];return p?p.current++:(p={limit:r,current:1},J._LogLimitOutputs[L]=p),p.current<=p.limit}static _GenerateLimitMessage(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const p=J._LogLimitOutputs[L];if(!p||!J.MessageLimitReached)return;const i=this._Levels[r];p.current===p.limit&&J[i.name](J.MessageLimitReached.replace(/%LIMIT%/g,""+p.limit).replace(/%TYPE%/g,i.name??""))}static _AddLogEntry(L){J._LogCache=L+J._LogCache,J.OnNewCacheEntry&&J.OnNewCacheEntry(L)}static _FormatMessage(L){const r=L=>L<10?"0"+L:""+L,p=new Date;return"["+r(p.getHours())+":"+r(p.getMinutes())+":"+r(p.getSeconds())+"]: "+L}static _LogDisabled(L,r){}static _LogEnabled(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1?arguments[1]:void 0,p=arguments.length>2?arguments[2]:void 0;const i=Array.isArray(r)?r[0]:r;if(void 0!==p&&!J._CheckLimit(i,p))return;const n=J._FormatMessage(i),j=this._Levels[L],z=Array.isArray(r)?r.slice(1):[];j.logFunc&&j.logFunc("BJS - "+n,...z);const G=`<div style='color:${j.color}'>${n}</div><br>`;J._AddLogEntry(G),J._GenerateLimitMessage(i,L)}static get LogCache(){return J._LogCache}static ClearLogCache(){J._LogCache="",J._LogLimitOutputs={},J.errorsCount=0}static set LogLevels(L){J.Log=J._LogDisabled,J.Warn=J._LogDisabled,J.Error=J._LogDisabled;const r=[J.MessageLogLevel,J.WarningLogLevel,J.ErrorLogLevel];for(const p of r)if((L&p)===p){const L=this._Levels[p];J[L.name]=J._LogEnabled.bind(J,p)}}}J.NoneLogLevel=0,J.MessageLogLevel=1,J.WarningLogLevel=2,J.ErrorLogLevel=4,J.AllLogLevel=7,J.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",J._LogCache="",J._LogLimitOutputs={},J._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],J.errorsCount=0,J.Log=J._LogEnabled.bind(J,J.MessageLogLevel),J.Warn=J._LogEnabled.bind(J,J.WarningLogLevel),J.Error=J._LogEnabled.bind(J,J.ErrorLogLevel)},11964:(L,r,p)=>{p.d(r,{c:()=>j});const J="undefined"!==typeof WeakRef;class i{constructor(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0,J=arguments.length>3?arguments[3]:void 0;this.initialize(L,r,p,J)}initialize(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0,J=arguments.length>3?arguments[3]:void 0;return this.mask=L,this.skipNextObservers=r,this.target=p,this.currentTarget=J,this}}class n{constructor(L,r){let p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=L,this.mask=r,this.scope=p,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(L)}}class j{static FromPromise(L,r){const p=new j;return L.then((L=>{p.notifyObservers(L)})).catch((L=>{if(!r)throw L;r.notifyObservers(L)})),p}get observers(){return this._observers}constructor(L){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=r,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new i(0),L&&(this._onObserverAdded=L)}add(L){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!L)return null;const i=new n(L,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);i.unregisterOnNextCall=p,r?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(i,this._lastNotifiedValue);const j=J?new WeakRef(this):{deref:()=>this};return i._remove=function(){let L=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=j.deref();r&&(L?r.remove(i):r._remove(i))},i}addOnce(L){return this.add(L,void 0,void 0,void 0,!0)}remove(L){if(!L)return!1;L._remove=null;return-1!==this._observers.indexOf(L)&&(this._deferUnregister(L),!0)}removeCallback(L,r){for(let p=0;p<this._observers.length;p++){const J=this._observers[p];if(!J._willBeUnregistered&&(J.callback===L&&(!r||r===J.scope)))return this._deferUnregister(J),!0}return!1}_deferUnregister(L){L._willBeUnregistered||(this._numObserversMarkedAsDeleted++,L.unregisterOnNextCall=!1,L._willBeUnregistered=!0,setTimeout((()=>{this._remove(L)}),0))}_remove(L){let r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!L)return!1;const p=this._observers.indexOf(L);return-1!==p&&(r&&this._numObserversMarkedAsDeleted--,this._observers.splice(p,1),!0)}makeObserverTopPriority(L){this._remove(L,!1),this._observers.unshift(L)}makeObserverBottomPriority(L){this._remove(L,!1),this._observers.push(L)}notifyObservers(L){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,p=arguments.length>2?arguments[2]:void 0,J=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=L),!this._observers.length)return!0;const n=this._eventState;n.mask=r,n.target=p,n.currentTarget=J,n.skipNextObservers=!1,n.lastReturnValue=L,n.userInfo=i;for(const j of this._observers)if(!j._willBeUnregistered&&(j.mask&r&&(j.unregisterOnNextCall&&this._deferUnregister(j),j.scope?n.lastReturnValue=j.callback.apply(j.scope,[L,n]):n.lastReturnValue=j.callback(L,n)),n.skipNextObservers))return!1;return!0}notifyObserver(L,r){let p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=r),L._willBeUnregistered)return;const J=this._eventState;J.mask=p,J.skipNextObservers=!1,L.unregisterOnNextCall&&this._deferUnregister(L),L.callback(r,J)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const L=this._observers.pop();L&&(L._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const L=new j;return L._observers=this._observers.slice(0),L}hasSpecificMask(){let L=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const r of this._observers)if(r.mask&L||r.mask===L)return!0;return!1}}},12032:(L,r,p)=>{p.d(r,{d:()=>i,g:()=>j});let J=[];class i{static SetImmediate(L){0===J.length&&setTimeout((()=>{const L=J;J=[];for(const r of L)r()}),1),J.push(L)}}function n(L,r,p){try{if(L())return r(),!0}catch(J){return null===p||void 0===p||p(J),!0}return!1}const j=function(L,r,p){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,j=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&n(L,r,p))return null;const z=setInterval((()=>{n(L,r,p)?clearInterval(z):(i-=J,i<0&&(clearInterval(z),null===p||void 0===p||p(new Error("Operation timed out after maximum retries. "+(j||"")),!0)))}),J);return()=>clearInterval(z)}}}]);