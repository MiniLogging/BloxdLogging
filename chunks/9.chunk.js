"use strict";(self.fwuvyyymhp8=self.fwuvyyymhp8||[]).push([[9],{12251:(N,U,V)=>{V.d(U,{e:()=>W,i:()=>H,n:()=>Y,m:()=>e,p:()=>Q});class A{constructor(){this.children=[]}isValid(N){return!0}process(N,U,V){let A="";if(this.line){let V=this.line;const E=U.processor;if(E){var t,n,q,i,z,S;E.lineProcessor&&(V=E.lineProcessor(V,U.isFragment,U.processingContext));const A=(null===(t=U.processor)||void 0===t?void 0:t.attributeKeywordName)??"attribute",p=U.isFragment&&null!==(n=U.processor)&&void 0!==n&&n.varyingFragmentKeywordName?null===(q=U.processor)||void 0===q?void 0:q.varyingFragmentKeywordName:!U.isFragment&&null!==(i=U.processor)&&void 0!==i&&i.varyingVertexKeywordName?null===(z=U.processor)||void 0===z?void 0:z.varyingVertexKeywordName:"varying";if(!U.isFragment&&E.attributeProcessor&&this.line.startsWith(A))V=E.attributeProcessor(this.line,N,U.processingContext);else if(E.varyingProcessor&&(null!==(S=E.varyingCheck)&&void 0!==S&&S.call(E,this.line,U.isFragment)||!E.varyingCheck&&this.line.startsWith(p)))V=E.varyingProcessor(this.line,U.isFragment,N,U.processingContext);else if(E.uniformProcessor&&E.uniformRegexp&&E.uniformRegexp.test(this.line))U.lookForClosingBracketForUniformBuffer||(V=E.uniformProcessor(this.line,U.isFragment,N,U.processingContext));else if(E.uniformBufferProcessor&&E.uniformBufferRegexp&&E.uniformBufferRegexp.test(this.line))U.lookForClosingBracketForUniformBuffer||(V=E.uniformBufferProcessor(this.line,U.isFragment,U.processingContext),U.lookForClosingBracketForUniformBuffer=!0);else if(E.textureProcessor&&E.textureRegexp&&E.textureRegexp.test(this.line))V=E.textureProcessor(this.line,U.isFragment,N,U.processingContext);else if((E.uniformProcessor||E.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!U.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?E.uniformProcessor&&(V=E.uniformProcessor(this.line,U.isFragment,N,U.processingContext)):E.uniformBufferProcessor&&(V=E.uniformBufferProcessor(this.line,U.isFragment,U.processingContext),U.lookForClosingBracketForUniformBuffer=!0)}U.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(U.lookForClosingBracketForUniformBuffer=!1,E.endOfUniformBufferProcessor&&(V=E.endOfUniformBufferProcessor(this.line,U.isFragment,U.processingContext)))}A+=V+"\n"}for(const E of this.children)A+=E.process(N,U,V);return this.additionalDefineKey&&(N[this.additionalDefineKey]=this.additionalDefineValue||"true",V[this.additionalDefineKey]=N[this.additionalDefineKey]),A}}class t{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(N){this._lines.length=0;for(const U of N){if(!U||"\r"===U)continue;if("#"===U[0]){this._lines.push(U);continue}const N=U.trim();if(!N)continue;if(N.startsWith("//")){this._lines.push(U);continue}const V=N.indexOf(";");if(-1===V)this._lines.push(N);else if(V===N.length-1)N.length>1&&this._lines.push(N);else{const N=U.split(";");for(let U=0;U<N.length;U++){let V=N[U];V&&(V=V.trim(),V&&this._lines.push(V+(U!==N.length-1?";":"")))}}}}}class n extends A{process(N,U,V){for(let A=0;A<this.children.length;A++){const t=this.children[A];if(t.isValid(N))return t.process(N,U,V)}return""}}class q extends A{isValid(N){return this.testExpression.isTrue(N)}}class i{isTrue(N){return!0}static postfixToInfix(N){const U=[];for(const V of N)if(void 0===i._OperatorPriority[V])U.push(V);else{const N=U[U.length-1],A=U[U.length-2];U.length-=2,U.push(`(${A}${V}${N})`)}return U[U.length-1]}static infixToPostfix(N){const U=i._InfixToPostfixCache.get(N);if(U)return U.accessTime=Date.now(),U.result;if(!N.includes("&&")&&!N.includes("||")&&!N.includes(")")&&!N.includes("("))return[N];const V=[];let A=-1;const t=()=>{E=E.trim(),""!==E&&(V.push(E),E="")},n=N=>{A<i._Stack.length-1&&(i._Stack[++A]=N)},q=()=>i._Stack[A],z=()=>-1===A?"!!INVALID EXPRESSION!!":i._Stack[A--];let S=0,E="";for(;S<N.length;){const U=N.charAt(S),p=S<N.length-1?N.substring(S,2+S):"";if("("===U)E="",n(U);else if(")"===U){for(t();-1!==A&&"("!==q();)V.push(z());z()}else if(i._OperatorPriority[p]>1){for(t();-1!==A&&i._OperatorPriority[q()]>=i._OperatorPriority[p];)V.push(z());n(p),S++}else E+=U;S++}for(t();-1!==A;)"("===q()?z():V.push(z());return i._InfixToPostfixCache.size>=i.InfixToPostfixCacheLimitSize&&i.ClearCache(),i._InfixToPostfixCache.set(N,{result:V,accessTime:Date.now()}),V}static ClearCache(){const N=Array.from(i._InfixToPostfixCache.entries()).sort(((N,U)=>N[1].accessTime-U[1].accessTime));for(let U=0;U<i.InfixToPostfixCacheCleanupSize;U++)i._InfixToPostfixCache.delete(N[U][0])}}i.InfixToPostfixCacheLimitSize=5e4,i.InfixToPostfixCacheCleanupSize=25e3,i._InfixToPostfixCache=new Map,i._OperatorPriority={")":0,"(":1,"||":2,"&&":3},i._Stack=["","","","","","","","","","","","","","","","","","","",""];class z extends i{constructor(N){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=N,this.not=U}isTrue(N){let U=void 0!==N[this.define];return this.not&&(U=!U),U}}class S extends i{isTrue(N){return this.leftOperand.isTrue(N)||this.rightOperand.isTrue(N)}}class E extends i{isTrue(N){return this.leftOperand.isTrue(N)&&this.rightOperand.isTrue(N)}}class p extends i{constructor(N,U,V){super(),this.define=N,this.operand=U,this.testValue=V}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(N){let U=!1;const V=parseInt(void 0!=N[this.define]?N[this.define]:this.define),A=parseInt(void 0!=N[this.testValue]?N[this.testValue]:this.testValue);if(isNaN(V)||isNaN(A))return!1;switch(this.operand){case">":U=V>A;break;case"<":U=V<A;break;case"<=":U=V<=A;break;case">=":U=V>=A;break;case"==":U=V===A;break;case"!=":U=V!==A}return U}}var k=V(12209),B=V(12259);const C=/defined\s*?\((.+?)\)/g,x=/defined\s*?\[(.+?)\]/g,J=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,d=/__decl__/,r=/light\{X\}.(\w*)/g,v=/\{X\}/g,h=[],c=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function H(N){N.processor&&N.processor.initializeShaders&&N.processor.initializeShaders(N.processingContext)}function Y(N,U,V,A){var t;null!==(t=U.processor)&&void 0!==t&&t.preProcessShaderCode&&(N=U.processor.preProcessShaderCode(N,U.isFragment)),e(N,U,(N=>{U.processCodeAfterIncludes&&(N=U.processCodeAfterIncludes(U.isFragment?"fragment":"vertex",N,U.defines));const t=function(N,U,V){let A=function(N,U){var V;if(null!==(V=U.processor)&&void 0!==V&&V.noPrecision)return N;const A=U.shouldUseHighPrecisionShader;-1===N.indexOf("precision highp float")?N=A?"precision highp float;\n"+N:"precision mediump float;\n"+N:A||(N=N.replace("precision highp float","precision mediump float"));return N}(N,U);if(!U.processor)return A;if(0===U.processor.shaderLanguage&&-1!==A.indexOf("#version 3")&&(A=A.replace("#version 300 es",""),!U.processor.parseGLES3))return A;const t=U.defines,n=X(U,V);U.processor.preProcessor&&(A=U.processor.preProcessor(A,t,n,U.isFragment,U.processingContext));const q={};A=w(A,n,U,q),U.processor.postProcessor&&(A=U.processor.postProcessor(A,t,U.isFragment,U.processingContext,V?{drawBuffersExtensionDisabled:!V.getCaps().drawBuffersExtension}:{},n,q));null!==V&&void 0!==V&&V._features.needShaderCodeInlining&&(A=V.inlineShaderCode(A));return A}(N,U,A);V(t,N)}))}function W(N,U,V){return V.processor&&V.processor.finalizeShaders?V.processor.finalizeShaders(N,U,V.processingContext):{vertexCode:N,fragmentCode:U}}function s(N){const U=/defined\((.+)\)/.exec(N);if(U&&U.length)return new z(U[1].trim(),"!"===N[0]);const V=["==","!=",">=","<=","<",">"];let A="",t=0;for(A of V)if(t=N.indexOf(A),t>-1)break;if(-1===t)return new z(N);const n=N.substring(0,t).trim(),q=N.substring(t+A.length).trim();return new p(n,A,q)}function M(N,U){const V=new q,A=N.substring(0,U);let t=N.substring(U);return t=t.substring(0,(t.indexOf("//")+1||t.length+1)-1).trim(),V.testExpression="#ifdef"===A?new z(t):"#ifndef"===A?new z(t,!0):function(N){N=N.replace(C,"defined[$1]");const U=i.infixToPostfix(N),V=[];for(const t of U)if("||"!==t&&"&&"!==t)V.push(t);else if(V.length>=2){let N=V[V.length-1],U=V[V.length-2];V.length-=2;const A="&&"==t?new E:new S;"string"===typeof N&&(N=N.replace(x,"defined($1)")),"string"===typeof U&&(U=U.replace(x,"defined($1)")),A.leftOperand="string"===typeof U?s(U):U,A.rightOperand="string"===typeof N?s(N):N,V.push(A)}let A=V[V.length-1];return"string"===typeof A&&(A=A.replace(x,"defined($1)")),"string"===typeof A?s(A):A}(t),V}function a(N,U,V,t){let n=N.currentLine;for(;mN(N,V,t);){n=N.currentLine;const q=n.substring(0,5).toLowerCase();if("#else"===q){const V=new A;return U.children.push(V),void mN(N,V,t)}if("#elif"===q){const N=M(n,5);U.children.push(N),V=N}}}function mN(N,U,V){for(;N.canRead;){N.lineIndex++;const t=N.currentLine;if(t.indexOf("#")>=0){const A=c.exec(t);if(A&&A.length){switch(A[0]){case"#ifdef":{const A=new n;U.children.push(A);const q=M(t,6);A.children.push(q),a(N,A,q,V);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const A=new n;U.children.push(A);const q=M(t,7);A.children.push(q),a(N,A,q,V);break}case"#if":{const A=new n,q=M(t,3);U.children.push(A),A.children.push(q),a(N,A,q,V);break}}continue}}const q=new A;if(q.line=t,U.children.push(q),"#"===t[0]&&"d"===t[1]){const N=t.replace(";","").split(" ");q.additionalDefineKey=N[1],3===N.length&&(q.additionalDefineValue=N[2])}}return!1}function w(N,U,V,n){const q=new A,i=new t;return i.lineIndex=-1,i.lines=N.split("\n"),mN(i,q,n),q.process(U,V,n)}function X(N,U){var V;const A=N.defines,t={};for(const n of A){const N=n.replace("#define","").replace(";","").trim().split(" ");t[N[0]]=N.length>1?N[1]:""}return 0===(null===(V=N.processor)||void 0===V?void 0:V.shaderLanguage)&&(t.GL_ES="true"),t.__VERSION__=N.version,t[N.platformName]="true",(0,B.h)(t,null===U||void 0===U?void 0:U.isNDCHalfZRange,null===U||void 0===U?void 0:U.ln,null===U||void 0===U?void 0:U.useExactSrgbConversions),t}function e(N,U,V){let A;for(h.length=0;null!==(A=J.exec(N));)h.push(A);let t=String(N),n=[N],q=!1;for(const i of h){let N=i[1];if(-1!==N.indexOf("__decl__")&&(N=N.replace(d,""),U.supportsUniformBuffers&&(N=N.replace("Vertex","Ubo").replace("Fragment","Ubo")),N+="Declaration"),!U.includesShadersStore[N]){const A=U.shadersRepository+"ShadersInclude/"+N+".fx";return void Q.loadFile(A,(A=>{U.includesShadersStore[N]=A,e(n.join(""),U,V)}))}{let V=U.includesShadersStore[N];if(i[2]){const N=i[3].split(",");for(let U=0;U<N.length;U+=2){const A=new RegExp(N[U],"g"),t=N[U+1];V=V.replace(A,t)}}if(i[4]){const N=i[5];if(-1!==N.indexOf("..")){const A=N.split(".."),t=parseInt(A[0]);let n=parseInt(A[1]),q=V.slice(0);V="",isNaN(n)&&(n=U.indexParameters[A[1]]);for(let N=t;N<n;N++)U.supportsUniformBuffers||(q=q.replace(r,((N,U)=>U+"{X}"))),V+=q.replace(v,N.toString())+"\n"}else U.supportsUniformBuffers||(V=V.replace(r,((N,U)=>U+"{X}"))),V=V.replace(v,N)}const A=[];for(const N of n){const U=N.split(i[0]);for(let N=0;N<U.length-1;N++)A.push(U[N]),A.push(V);A.push(U[U.length-1])}n=A,q=q||V.indexOf("#include<")>=0||V.indexOf("#include <")>=0}}h.length=0,t=n.join(""),q?e(t.toString(),U,V):V(t)}const Q={loadFile:(N,U,V,A,t,n)=>{throw(0,k.d)("FileTools")}}},12259:(N,U,V)=>{V.d(U,{c:()=>t,d:()=>n,h:()=>i,k:()=>q,l:()=>z});var A=V(12209);V(12188);const t={};function n(N,U){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(U?U+"\n":"")+N}function q(N,U,V,n,q,i,z){const S=z||t.loadFile;if(S){return S(N,U,V,n,q,i)}throw(0,A.d)("FileTools")}function i(N,U,V,A){if(N)return U?N.IS_NDC_HALF_ZRANGE="":delete N.IS_NDC_HALF_ZRANGE,V?N.USE_REVERSE_DEPTHBUFFER="":delete N.USE_REVERSE_DEPTHBUFFER,void(A?N.USE_EXACT_SRGB_CONVERSIONS="":delete N.USE_EXACT_SRGB_CONVERSIONS);{let N="";return U&&(N+="#define IS_NDC_HALF_ZRANGE"),V&&(N&&(N+="\n"),N+="#define USE_REVERSE_DEPTHBUFFER"),A&&(N&&(N+="\n"),N+="#define USE_EXACT_SRGB_CONVERSIONS"),N}}function z(N,U){let V=arguments.length>2&&void 0!==arguments[2]&&arguments[2],A=arguments.length>3?arguments[3]:void 0;switch(N){case 3:{const N=(ArrayBuffer,new Int8Array(U));return A&&N.set(new Int8Array(A)),N}case 0:{const N=(ArrayBuffer,new Uint8Array(U));return A&&N.set(new Uint8Array(A)),N}case 4:{const N=U instanceof ArrayBuffer?new Int16Array(U):new Int16Array(V?U/2:U);return A&&N.set(new Int16Array(A)),N}case 5:case 8:case 9:case 10:case 2:{const N=U instanceof ArrayBuffer?new Uint16Array(U):new Uint16Array(V?U/2:U);return A&&N.set(new Uint16Array(A)),N}case 6:{const N=U instanceof ArrayBuffer?new Int32Array(U):new Int32Array(V?U/4:U);return A&&N.set(new Int32Array(A)),N}case 7:case 11:case 12:case 13:case 14:case 15:{const N=U instanceof ArrayBuffer?new Uint32Array(U):new Uint32Array(V?U/4:U);return A&&N.set(new Uint32Array(A)),N}case 1:{const N=U instanceof ArrayBuffer?new Float32Array(U):new Float32Array(V?U/4:U);return A&&N.set(new Float32Array(A)),N}}const t=(ArrayBuffer,new Uint8Array(U));return A&&t.set(new Uint8Array(A)),t}},12288:(N,U,V)=>{V.d(U,{b:()=>A});class A{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersRepository:A.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersStore:A.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.IncludesShadersStore:A.IncludesShadersStoreWGSL}}A.ShadersRepository="src/Shaders/",A.ShadersStore={},A.IncludesShadersStore={},A.ShadersRepositoryWGSL="src/ShadersWGSL/",A.ShadersStoreWGSL={},A.IncludesShadersStoreWGSL={}},12304:(N,U,V)=>{V.d(U,{b:()=>k,c:()=>v,f:()=>C,h:()=>B,k:()=>x,o:()=>r,r:()=>p,v:()=>S,w:()=>E,y:()=>z,z:()=>i});class A{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.BU._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(N){N&&this.program&&N(this.program)}setEngine(N){this.BU=N}_fillEffectInformation(N,U,V,A,t,n,q,i){const z=this.BU;if(z.supportsUniformBuffers)for(const E in U)N.bindUniformBlock(E,U[E]);let S;for(this.BU.getUniforms(this,V).forEach(((N,U)=>{A[V[U]]=N})),this._uniforms=A,S=0;S<t.length;S++){null==N.getUniform(t[S])&&(t.splice(S,1),S--)}t.forEach(((N,U)=>{n[N]=U}));for(const E of z.getAttributes(this,q))i.push(E)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(N,U){const V=this._valueCache[N],A=U.updateFlag;return(void 0===V||V!==A)&&(this._valueCache[N]=A,!0)}_cacheFloat2(N,U,V){let A=this._valueCache[N];if(!A||2!==A.length)return A=[U,V],this._valueCache[N]=A,!0;let t=!1;return A[0]!==U&&(A[0]=U,t=!0),A[1]!==V&&(A[1]=V,t=!0),t}_cacheFloat3(N,U,V,A){let t=this._valueCache[N];if(!t||3!==t.length)return t=[U,V,A],this._valueCache[N]=t,!0;let n=!1;return t[0]!==U&&(t[0]=U,n=!0),t[1]!==V&&(t[1]=V,n=!0),t[2]!==A&&(t[2]=A,n=!0),n}_cacheFloat4(N,U,V,A,t){let n=this._valueCache[N];if(!n||4!==n.length)return n=[U,V,A,t],this._valueCache[N]=n,!0;let q=!1;return n[0]!==U&&(n[0]=U,q=!0),n[1]!==V&&(n[1]=V,q=!0),n[2]!==A&&(n[2]=A,q=!0),n[3]!==t&&(n[3]=t,q=!0),q}setInt(N,U){const V=this._valueCache[N];void 0!==V&&V===U||this.BU.setInt(this._uniforms[N],U)&&(this._valueCache[N]=U)}setInt2(N,U,V){this._cacheFloat2(N,U,V)&&(this.BU.setInt2(this._uniforms[N],U,V)||(this._valueCache[N]=null))}setInt3(N,U,V,A){this._cacheFloat3(N,U,V,A)&&(this.BU.setInt3(this._uniforms[N],U,V,A)||(this._valueCache[N]=null))}setInt4(N,U,V,A,t){this._cacheFloat4(N,U,V,A,t)&&(this.BU.setInt4(this._uniforms[N],U,V,A,t)||(this._valueCache[N]=null))}setIntArray(N,U){this._valueCache[N]=null,this.BU.setIntArray(this._uniforms[N],U)}setIntArray2(N,U){this._valueCache[N]=null,this.BU.setIntArray2(this._uniforms[N],U)}setIntArray3(N,U){this._valueCache[N]=null,this.BU.setIntArray3(this._uniforms[N],U)}setIntArray4(N,U){this._valueCache[N]=null,this.BU.setIntArray4(this._uniforms[N],U)}setUInt(N,U){const V=this._valueCache[N];void 0!==V&&V===U||this.BU.setUInt(this._uniforms[N],U)&&(this._valueCache[N]=U)}setUInt2(N,U,V){this._cacheFloat2(N,U,V)&&(this.BU.setUInt2(this._uniforms[N],U,V)||(this._valueCache[N]=null))}setUInt3(N,U,V,A){this._cacheFloat3(N,U,V,A)&&(this.BU.setUInt3(this._uniforms[N],U,V,A)||(this._valueCache[N]=null))}setUInt4(N,U,V,A,t){this._cacheFloat4(N,U,V,A,t)&&(this.BU.setUInt4(this._uniforms[N],U,V,A,t)||(this._valueCache[N]=null))}setUIntArray(N,U){this._valueCache[N]=null,this.BU.setUIntArray(this._uniforms[N],U)}setUIntArray2(N,U){this._valueCache[N]=null,this.BU.setUIntArray2(this._uniforms[N],U)}setUIntArray3(N,U){this._valueCache[N]=null,this.BU.setUIntArray3(this._uniforms[N],U)}setUIntArray4(N,U){this._valueCache[N]=null,this.BU.setUIntArray4(this._uniforms[N],U)}setArray(N,U){this._valueCache[N]=null,this.BU.setArray(this._uniforms[N],U)}setArray2(N,U){this._valueCache[N]=null,this.BU.setArray2(this._uniforms[N],U)}setArray3(N,U){this._valueCache[N]=null,this.BU.setArray3(this._uniforms[N],U)}setArray4(N,U){this._valueCache[N]=null,this.BU.setArray4(this._uniforms[N],U)}setMatrices(N,U){U&&(this._valueCache[N]=null,this.BU.setMatrices(this._uniforms[N],U))}setMatrix(N,U){this._cacheMatrix(N,U)&&(this.BU.setMatrices(this._uniforms[N],U.pi())||(this._valueCache[N]=null))}setMatrix3x3(N,U){this._valueCache[N]=null,this.BU.setMatrix3x3(this._uniforms[N],U)}setMatrix2x2(N,U){this._valueCache[N]=null,this.BU.setMatrix2x2(this._uniforms[N],U)}setFloat(N,U){const V=this._valueCache[N];void 0!==V&&V===U||this.BU.setFloat(this._uniforms[N],U)&&(this._valueCache[N]=U)}setVector2(N,U){this._cacheFloat2(N,U.x,U.y)&&(this.BU.setFloat2(this._uniforms[N],U.x,U.y)||(this._valueCache[N]=null))}setFloat2(N,U,V){this._cacheFloat2(N,U,V)&&(this.BU.setFloat2(this._uniforms[N],U,V)||(this._valueCache[N]=null))}setVector3(N,U){this._cacheFloat3(N,U.x,U.y,U.z)&&(this.BU.setFloat3(this._uniforms[N],U.x,U.y,U.z)||(this._valueCache[N]=null))}setFloat3(N,U,V,A){this._cacheFloat3(N,U,V,A)&&(this.BU.setFloat3(this._uniforms[N],U,V,A)||(this._valueCache[N]=null))}setVector4(N,U){this._cacheFloat4(N,U.x,U.y,U.z,U.w)&&(this.BU.setFloat4(this._uniforms[N],U.x,U.y,U.z,U.w)||(this._valueCache[N]=null))}setQuaternion(N,U){this._cacheFloat4(N,U.x,U.y,U.z,U.w)&&(this.BU.setFloat4(this._uniforms[N],U.x,U.y,U.z,U.w)||(this._valueCache[N]=null))}setFloat4(N,U,V,A,t){this._cacheFloat4(N,U,V,A,t)&&(this.BU.setFloat4(this._uniforms[N],U,V,A,t)||(this._valueCache[N]=null))}setColor3(N,U){this._cacheFloat3(N,U.r,U.g,U.b)&&(this.BU.setFloat3(this._uniforms[N],U.r,U.g,U.b)||(this._valueCache[N]=null))}setColor4(N,U,V){this._cacheFloat4(N,U.r,U.g,U.b,V)&&(this.BU.setFloat4(this._uniforms[N],U.r,U.g,U.b,V)||(this._valueCache[N]=null))}setDirectColor4(N,U){this._cacheFloat4(N,U.r,U.g,U.b,U.a)&&(this.BU.setFloat4(this._uniforms[N],U.r,U.g,U.b,U.a)||(this._valueCache[N]=null))}_getVertexShaderCode(){return this.vertexShader?this.BU._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.BU._getShaderSource(this.fragmentShader):null}}var t=V(12259);const n=new WeakMap,q={_webGLVersion:2,cachedPipelines:{}};function i(N){let U=n.get(N);if(!U){if(!N)return q;U={_webGLVersion:N.TEXTURE_BINDING_3D?2:1,_context:N,parallelShaderCompile:N.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},n.set(N,U)}return U}function z(N){n.delete(N)}function S(N,U,V,A,t,n){const q=i(A);n||(n=q._createShaderProgramInjection??k);return n(N,d(U,"vertex",A,q._contextWasLost),d(V,"fragment",A,q._contextWasLost),A,t,q.validateShaderPrograms)}function E(N,U,V,A,t){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,q=arguments.length>6?arguments[6]:void 0;const z=i(t);q||(q=z._createShaderProgramInjection??k);const S=z._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return q(N,J(U,"vertex",A,S,t,z._contextWasLost),J(V,"fragment",A,S,t,z._contextWasLost),t,n,z.validateShaderPrograms)}function p(N,U){const V=new A,t=i(N);return t.parallelShaderCompile&&!t.disableParallelShaderCompile&&(V.isParallelCompiled=!0),V.context=t._context,V}function k(N,U,V,A){let t=arguments.length>5?arguments[5]:void 0;const n=A.createProgram();if(N.program=n,!n)throw new Error("Unable to create program");return A.attachShader(n,U),A.attachShader(n,V),A.linkProgram(n),N.context=A,N.vertexShader=U,N.fragmentShader=V,N.isParallelCompiled||C(N,A,t),n}function B(N,U,V){const A=N;if(A._isDisposed)return!1;const t=i(U);return!!(t&&t.parallelShaderCompile&&t.parallelShaderCompile.COMPLETION_STATUS_KHR&&A.program&&U.getProgramParameter(A.program,t.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(C(A,U,V),!0)}function C(N,U,V){const A=N.context,t=N.vertexShader,n=N.fragmentShader,q=N.program;if(!A.getProgramParameter(q,A.LINK_STATUS)){if(!U.getShaderParameter(t,U.COMPILE_STATUS)){const V=U.getShaderInfoLog(t);if(V)throw N.vertexCompilationError=V,new Error("VERTEX SHADER "+V)}if(!U.getShaderParameter(n,U.COMPILE_STATUS)){const V=U.getShaderInfoLog(n);if(V)throw N.fragmentCompilationError=V,new Error("FRAGMENT SHADER "+V)}const V=A.getProgramInfoLog(q);if(V)throw N.programLinkError=V,new Error(V)}if(V){A.validateProgram(q);if(!A.getProgramParameter(q,A.VALIDATE_STATUS)){const U=A.getProgramInfoLog(q);if(U)throw N.programValidationError=U,new Error(U)}}A.deleteShader(t),A.deleteShader(n),N.vertexShader=void 0,N.fragmentShader=void 0,N.onCompiled&&(N.onCompiled(),N.onCompiled=void 0)}function x(N,U,V,A,t,n,q,z,p){let k=arguments.length>10?arguments[10]:void 0,B=arguments.length>11?arguments[11]:void 0,C=arguments.length>12?arguments[12]:void 0;const x=i(N.context);B||(B=x.createRawShaderProgramInjection??S),C||(C=x.createShaderProgramInjection??E);const J=N;J.program=A?B(J,U,V,J.context,p):C(J,U,V,z,J.context,p),J.program.__SPECTOR_rebuildProgram=q,k()}function J(N,U,V,A,n,q){return d((0,t.d)(N,V,A),U,n,q)}function d(N,U,V,A){const t=V.createShader("vertex"===U?V.VERTEX_SHADER:V.FRAGMENT_SHADER);if(!t){let N=V.NO_ERROR,t=V.NO_ERROR;for(;(t=V.getError())!==V.NO_ERROR;)N=t;throw new Error(`Something went wrong while creating a gl ${U} shader object. gl error=${N}, gl isContextLost=${V.isContextLost()}, _contextWasLost=${A}`)}return V.shaderSource(t,N),V.compileShader(t),t}function r(N,U){U.useProgram(N)}function v(N,U){const V=N;if(!V.isParallelCompiled)return void U(N);const A=V.onCompiled;V.onCompiled=()=>{null===A||void 0===A||A(),U(N)}}},12296:(N,U,V)=>{V.d(U,{e:()=>p,f:()=>B,j:()=>S,k:()=>E});var A=V(12188),t=V(12304),n=V(12288),q=V(12193),i=V(12251),z=V(12259);function S(N,U){return(0,t.z)(U).cachedPipelines[N]}function E(N){const U=N._name,V=N.context;if(U&&V){const N=(0,t.z)(V),A=N.cachedPipelines[U];null===A||void 0===A||A.dispose(),delete N.cachedPipelines[U]}}function p(N,U,V,t,n,q,z){let S,E;const p=(0,A.l)()?null===q||void 0===q?void 0:q.getHostDocument():null;S="string"===typeof U?U:U.vertexSource?"source:"+U.vertexSource:U.vertexElement?(null===p||void 0===p?void 0:p.getElementById(U.vertexElement))||U.vertexElement:U.vertex||U,E="string"===typeof U?U:U.fragmentSource?"source:"+U.fragmentSource:U.fragmentElement?(null===p||void 0===p?void 0:p.getElementById(U.fragmentElement))||U.fragmentElement:U.fragment||U;const B=[void 0,void 0],C=()=>{if(B[0]&&B[1]){N.isFragment=!0;const[A,S]=B;(0,i.n)(S,N,((q,S)=>{z&&(z._fragmentSourceCodeBeforeMigration=S),V&&(q=V("fragment",q));const E=(0,i.e)(A,q,N);N=null;const p=function(N,U,V,A){if(V){return{vertexSourceCode:(1===A?"//":"")+"#define SHADER_NAME vertex:"+(V.vertexElement||V.vertex||V.spectorName||V)+"\n"+N,fragmentSourceCode:(1===A?"//":"")+"#define SHADER_NAME fragment:"+(V.fragmentElement||V.fragment||V.spectorName||V)+"\n"+U}}return{vertexSourceCode:N,fragmentSourceCode:U}}(E.vertexCode,E.fragmentCode,U,n);null===t||void 0===t||t(p.vertexSourceCode,p.fragmentSourceCode)}),q)}};k(S,"Vertex","",(U=>{(0,i.i)(N),(0,i.n)(U,N,((N,A)=>{z&&(z._rawVertexSourceCode=U,z._vertexSourceCodeBeforeMigration=A),V&&(N=V("vertex",N)),B[0]=N,C()}),q)}),n),k(E,"Fragment","Pixel",(N=>{z&&(z._rawFragmentSourceCode=N),B[1]=N,C()}),n)}function k(N,U,V,t,q,i){if("undefined"!==typeof HTMLElement&&N instanceof HTMLElement){return void t((0,A.c)(N))}if("source:"===N.substring(0,7))return void t(N.substring(7));if("base64:"===N.substring(0,7)){return void t(window.atob(N.substring(7)))}const S=n.b.GetShadersStore(q);if(S[N+U+"Shader"])return void t(S[N+U+"Shader"]);if(V&&S[N+V+"Shader"])return void t(S[N+V+"Shader"]);let E;if(E="."===N[0]||"/"===N[0]||N.indexOf("http")>-1?N:n.b.GetShadersRepository(q)+N,!(i=i||z.k))throw new Error("loadFileInjection is not defined");i(E+"."+U.toLowerCase()+".fx",t)}const B=(N,U,V,A)=>{try{const n=N.context?(0,t.z)(N.context):null;n&&(n.disableParallelShaderCompile=N.disableParallelCompilation);const q=N.existingPipelineContext||U(N.shaderProcessingContext);return q._name=N.name,N.name&&n&&(n.cachedPipelines[N.name]=q),V(q,N.vertex,N.fragment,!!N.createAsRaw,"","",N.rebuildRebind,N.defines,N.transformFeedbackVaryings,"",(()=>{A(q,(()=>{var U;null===(U=N.onRenderingStateCompiled)||void 0===U||U.call(N,q)}))})),q}catch(n){throw q.b.Error("Error compiling effect"),n}}},12280:(N,U,V)=>{V.r(U),V.d(U,{Effect:()=>z});var A=V(12182),t=V(12193),n=V(12288),q=V(12296),i=V(12264);class z{static get ShadersRepository(){return n.b.ShadersRepository}static set ShadersRepository(N){n.b.ShadersRepository=N}get S(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new A.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(N,U,V){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,S=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,E=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,k=arguments.length>9?arguments[9]:void 0,B=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",C=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,x=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new A.d,this.onErrorObservable=new A.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=N,this._key=B;const J=this._key.replace(/\r/g,"").replace(/\n/g,"|");let d;if(U.attributes){const N=U;if(this._engine=V,this._attributesNames=N.attributes,this._uniformsNames=N.uniformsNames.concat(N.samplers),this._samplerList=N.samplers.slice(),this.defines=N.defines,this.onError=N.onError,this.onCompiled=N.onCompiled,this._fallbacks=N.fallbacks,this._indexParameters=N.indexParameters,this._transformFeedbackVaryings=N.transformFeedbackVaryings||null,this._multiTarget=!!N.multiTarget,this._shaderLanguage=N.shaderLanguage??0,this._disableParallelShaderCompilation=!!N.disableParallelShaderCompilation,N.uniformBuffersNames){this._uniformBuffersNamesList=N.uniformBuffersNames.slice();for(let U=0;U<N.uniformBuffersNames.length;U++)this._uniformBuffersNames[N.uniformBuffersNames[U]]=U}this._processFinalCode=N.processFinalCode??null,this._processCodeAfterIncludes=N.processCodeAfterIncludes??void 0,x=N.extraInitializationsAsync,d=N.existingPipelineContext}else this._engine=n,this.defines=null==i?"":i,this._uniformsNames=V.concat(t),this._samplerList=t?t.slice():[],this._attributesNames=U,this._uniformBuffersNamesList=[],this._shaderLanguage=C,this.onError=p,this.onCompiled=E,this._indexParameters=k,this._fallbacks=S;"WEBGL2"===this._engine.shaderPlatformName&&(d=(0,q.j)(J,this._engine._gl)??d),this._attributeLocationByName={},this.uniqueId=z._UniqueIdSeed++,d?(this._pipelineContext=d,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,x),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.S||this.dispose(!0)}))}async _processShaderCodeAsync(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,U=arguments.length>1&&void 0!==arguments[1]&&arguments[1],V=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=arguments.length>3?arguments[3]:void 0;A&&await A(),this._processingContext=V||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const t={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:N??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:n.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:n.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,ln:this._engine.ln,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,q.e)(t,this.name,this._processFinalCode,((N,V)=>{this._vertexSourceCode=N,this._fragmentSourceCode=V,this._prepareEffect(U)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.S||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(N){return this._attributes[N]}getAttributeLocationByName(N){return this._attributeLocationByName[N]}getAttributesCount(){return this._attributes.length}getUniformIndex(N){return this._uniformsNames.indexOf(N)}getUniform(N){return this._uniforms[N]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((N=>{this.executeWhenCompiled(N)}))}executeWhenCompiled(N){this.isReady()?N(this):(this.onCompileObservable.add((U=>{N(U)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(N){(0,i.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(U=>{this._processCompilationErrors(U,N)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,ln:this._engine.ln,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(N,U,V,A){this._isReady=!1,this._vertexSourceCodeOverride=N,this._fragmentSourceCodeOverride=U,this.onError=(N,U)=>{A&&A(U)},this.onCompiled=()=>{var N,U;const A=this.getEngine().scenes;if(A)for(let V=0;V<A.length;V++)A[V].markAllMaterialsAsDirty(127);null===(N=(U=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===N||N.call(U,V)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(N){if(this._pipelineContext=N,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let U=0;U<this._attributesNames.length;U++){const N=this._attributesNames[U];this._attributeLocationByName[N]=this._attributes[U]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),z.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const U=this._pipelineContext;this._isReady=!1;try{const V=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),A=V?null:this.defines,t=V?this._vertexSourceCodeOverride:this._vertexSourceCode,n=V?this._fragmentSourceCodeOverride:this._fragmentSourceCode,i=this._engine;this._pipelineContext=(0,q.f)({existingPipelineContext:N?U:null,vertex:t,fragment:n,context:"WEBGL2"===i.shaderPlatformName||"WEBGL1"===i.shaderPlatformName?i._gl:void 0,rebuildRebind:(N,U,V,A)=>this._rebuildProgram(N,U,V,A),defines:A,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:V,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:V=>{U&&!N&&this._engine._deletePipelineContext(U),V&&this._onRenderingStateCompiled(V)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(U)}catch(V){this._processCompilationErrors(V,U)}}_getShaderCodeAndErrorLine(N,U,V){const A=V?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let t=null;if(U&&N){const n=U.match(A);if(n&&2===n.length){const U=parseInt(n[1]),A=N.split("\n",-1);A.length>=U&&(t=`Offending line [${U}] in ${V?"fragment":"vertex"} code: ${A[U-1]}`)}}return[N,t]}_processCompilationErrors(N){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=N.message;const V=this._attributesNames,A=this._fallbacks;if(t.b.Error("Unable to compile effect:"),t.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),t.b.Error(`Attributes: ${V.join(" ")}`),t.b.Error("Defines:\n"+this.defines),z.LogShaderCodeOnCompilationError){var n,q;let N=null,U=null,V=null;var i;if(null!==(n=this._pipelineContext)&&void 0!==n&&n._getVertexShaderCode()&&([V,N]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),V&&(t.b.Error("Vertex code:"),t.b.Error(V))),null!==(q=this._pipelineContext)&&void 0!==q&&q._getFragmentShaderCode())[V,U]=this._getShaderCodeAndErrorLine(null===(i=this._pipelineContext)||void 0===i?void 0:i._getFragmentShaderCode(),this._compilationError,!0),V&&(t.b.Error("Fragment code:"),t.b.Error(V));N&&t.b.Error(N),U&&t.b.Error(U)}t.b.Error("Error: "+this._compilationError);const S=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};U&&(this._pipelineContext=U,this._isReady=!0,S()),A?(this._pipelineContext=null,A.hasMoreFallbacks?(this._allFallbacksProcessed=!1,t.b.Error("Trying next fallback."),this.defines=A.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,S(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,U||S())}get isSupported(){return""===this._compilationError}_bindTexture(N,U){this._engine._bindTexture(this._samplers[N],U,N)}setTexture(N,U){this._engine.setTexture(this._samplers[N],this._uniforms[N],U,N)}setTextureArray(N,U){const V=N+"Ex";if(-1===this._samplerList.indexOf(V+"0")){const A=this._samplerList.indexOf(N);for(let N=1;N<U.length;N++){const U=V+(N-1).toString();this._samplerList.splice(A+N,0,U)}let t=0;for(const N of this._samplerList)this._samplers[N]=t,t+=1}this._engine.setTextureArray(this._samplers[N],this._uniforms[N],U,N)}bindUniformBuffer(N,U){const V=this._uniformBuffersNames[U];void 0===V||z._BaseCache[V]===N&&this._engine._features.useUBOBindingCache||(z._BaseCache[V]=N,this._engine.bindUniformBufferBase(N,V,U))}bindUniformBlock(N,U){this._engine.bindUniformBlock(this._pipelineContext,N,U)}setInt(N,U){return this._pipelineContext.setInt(N,U),this}setInt2(N,U,V){return this._pipelineContext.setInt2(N,U,V),this}setInt3(N,U,V,A){return this._pipelineContext.setInt3(N,U,V,A),this}setInt4(N,U,V,A,t){return this._pipelineContext.setInt4(N,U,V,A,t),this}setIntArray(N,U){return this._pipelineContext.setIntArray(N,U),this}setIntArray2(N,U){return this._pipelineContext.setIntArray2(N,U),this}setIntArray3(N,U){return this._pipelineContext.setIntArray3(N,U),this}setIntArray4(N,U){return this._pipelineContext.setIntArray4(N,U),this}setUInt(N,U){return this._pipelineContext.setUInt(N,U),this}setUInt2(N,U,V){return this._pipelineContext.setUInt2(N,U,V),this}setUInt3(N,U,V,A){return this._pipelineContext.setUInt3(N,U,V,A),this}setUInt4(N,U,V,A,t){return this._pipelineContext.setUInt4(N,U,V,A,t),this}setUIntArray(N,U){return this._pipelineContext.setUIntArray(N,U),this}setUIntArray2(N,U){return this._pipelineContext.setUIntArray2(N,U),this}setUIntArray3(N,U){return this._pipelineContext.setUIntArray3(N,U),this}setUIntArray4(N,U){return this._pipelineContext.setUIntArray4(N,U),this}setFloatArray(N,U){return this._pipelineContext.setArray(N,U),this}setFloatArray2(N,U){return this._pipelineContext.setArray2(N,U),this}setFloatArray3(N,U){return this._pipelineContext.setArray3(N,U),this}setFloatArray4(N,U){return this._pipelineContext.setArray4(N,U),this}setArray(N,U){return this._pipelineContext.setArray(N,U),this}setArray2(N,U){return this._pipelineContext.setArray2(N,U),this}setArray3(N,U){return this._pipelineContext.setArray3(N,U),this}setArray4(N,U){return this._pipelineContext.setArray4(N,U),this}setMatrices(N,U){return this._pipelineContext.setMatrices(N,U),this}setMatrix(N,U){return this._pipelineContext.setMatrix(N,U),this}setMatrix3x3(N,U){return this._pipelineContext.setMatrix3x3(N,U),this}setMatrix2x2(N,U){return this._pipelineContext.setMatrix2x2(N,U),this}setFloat(N,U){return this._pipelineContext.setFloat(N,U),this}setBool(N,U){return this._pipelineContext.setInt(N,U?1:0),this}setVector2(N,U){return this._pipelineContext.setVector2(N,U),this}setFloat2(N,U,V){return this._pipelineContext.setFloat2(N,U,V),this}setVector3(N,U){return this._pipelineContext.setVector3(N,U),this}setFloat3(N,U,V,A){return this._pipelineContext.setFloat3(N,U,V,A),this}setVector4(N,U){return this._pipelineContext.setVector4(N,U),this}setQuaternion(N,U){return this._pipelineContext.setQuaternion(N,U),this}setFloat4(N,U,V,A,t){return this._pipelineContext.setFloat4(N,U,V,A,t),this}setColor3(N,U){return this._pipelineContext.setColor3(N,U),this}setColor4(N,U,V){return this._pipelineContext.setColor4(N,U,V),this}setDirectColor4(N,U){return this._pipelineContext.setDirectColor4(N,U),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(z.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,q.k)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(N,U,V){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;U&&(n.b.GetShadersStore(A)[`${N}PixelShader`]=U),V&&(n.b.GetShadersStore(A)[`${N}VertexShader`]=V)}static ResetCache(){z._BaseCache={}}}z.LogShaderCodeOnCompilationError=!0,z.PersistentMode=!1,z.AutomaticallyClearCodeCache=!1,z._UniqueIdSeed=0,z._BaseCache={},z.ShadersStore=n.b.ShadersStore,z.IncludesShadersStore=n.b.IncludesShadersStore},12209:(N,U,V)=>{V.d(U,{d:()=>t});const A={};function t(N){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!A[N])return A[N]=!0,`${N} needs to be imported before as it contains a side-effect required by your code.`}},12188:(N,U,V)=>{function A(){return"undefined"!==typeof window}function t(){return"undefined"!==typeof navigator}function n(){return"undefined"!==typeof document}function q(N){let U="",V=N.firstChild;for(;V;)3===V.nodeType&&(U+=V.textContent),V=V.nextSibling;return U}V.d(U,{c:()=>q,f:()=>n,i:()=>t,l:()=>A})},12193:(N,U,V)=>{V.d(U,{b:()=>A});class A{static _CheckLimit(N,U){let V=A._LogLimitOutputs[N];return V?V.current++:(V={limit:U,current:1},A._LogLimitOutputs[N]=V),V.current<=V.limit}static _GenerateLimitMessage(N){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const V=A._LogLimitOutputs[N];if(!V||!A.MessageLimitReached)return;const t=this._Levels[U];V.current===V.limit&&A[t.name](A.MessageLimitReached.replace(/%LIMIT%/g,""+V.limit).replace(/%TYPE%/g,t.name??""))}static _AddLogEntry(N){A._LogCache=N+A._LogCache,A.OnNewCacheEntry&&A.OnNewCacheEntry(N)}static _FormatMessage(N){const U=N=>N<10?"0"+N:""+N,V=new Date;return"["+U(V.getHours())+":"+U(V.getMinutes())+":"+U(V.getSeconds())+"]: "+N}static _LogDisabled(N,U){}static _LogEnabled(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,U=arguments.length>1?arguments[1]:void 0,V=arguments.length>2?arguments[2]:void 0;const t=Array.isArray(U)?U[0]:U;if(void 0!==V&&!A._CheckLimit(t,V))return;const n=A._FormatMessage(t),q=this._Levels[N],i=Array.isArray(U)?U.slice(1):[];q.logFunc&&q.logFunc("BJS - "+n,...i);const z=`<div style='color:${q.color}'>${n}</div><br>`;A._AddLogEntry(z),A._GenerateLimitMessage(t,N)}static get LogCache(){return A._LogCache}static ClearLogCache(){A._LogCache="",A._LogLimitOutputs={},A.errorsCount=0}static set LogLevels(N){A.Log=A._LogDisabled,A.Warn=A._LogDisabled,A.Error=A._LogDisabled;const U=[A.MessageLogLevel,A.WarningLogLevel,A.ErrorLogLevel];for(const V of U)if((N&V)===V){const N=this._Levels[V];A[N.name]=A._LogEnabled.bind(A,V)}}}A.NoneLogLevel=0,A.MessageLogLevel=1,A.WarningLogLevel=2,A.ErrorLogLevel=4,A.AllLogLevel=7,A.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",A._LogCache="",A._LogLimitOutputs={},A._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],A.errorsCount=0,A.Log=A._LogEnabled.bind(A,A.MessageLogLevel),A.Warn=A._LogEnabled.bind(A,A.WarningLogLevel),A.Error=A._LogEnabled.bind(A,A.ErrorLogLevel)},12182:(N,U,V)=>{V.d(U,{d:()=>q});const A="undefined"!==typeof WeakRef;class t{constructor(N){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1],V=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;this.initialize(N,U,V,A)}initialize(N){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1],V=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;return this.mask=N,this.skipNextObservers=U,this.target=V,this.currentTarget=A,this}}class n{constructor(N,U){let V=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=N,this.mask=U,this.scope=V,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(N)}}class q{static FromPromise(N,U){const V=new q;return N.then((N=>{V.notifyObservers(N)})).catch((N=>{if(!U)throw N;U.notifyObservers(N)})),V}get observers(){return this._observers}constructor(N){let U=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=U,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new t(0),N&&(this._onObserverAdded=N)}add(N){let U=arguments.length>2&&void 0!==arguments[2]&&arguments[2],V=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!N)return null;const t=new n(N,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);t.unregisterOnNextCall=V,U?this._observers.unshift(t):this._observers.push(t),this._onObserverAdded&&this._onObserverAdded(t),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(t,this._lastNotifiedValue);const q=A?new WeakRef(this):{deref:()=>this};return t._remove=function(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const U=q.deref();U&&(N?U.remove(t):U._remove(t))},t}addOnce(N){return this.add(N,void 0,void 0,void 0,!0)}remove(N){if(!N)return!1;N._remove=null;return-1!==this._observers.indexOf(N)&&(this._deferUnregister(N),!0)}removeCallback(N,U){for(let V=0;V<this._observers.length;V++){const A=this._observers[V];if(!A._willBeUnregistered&&(A.callback===N&&(!U||U===A.scope)))return this._deferUnregister(A),!0}return!1}_deferUnregister(N){N._willBeUnregistered||(this._numObserversMarkedAsDeleted++,N.unregisterOnNextCall=!1,N._willBeUnregistered=!0,setTimeout((()=>{this._remove(N)}),0))}_remove(N){let U=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!N)return!1;const V=this._observers.indexOf(N);return-1!==V&&(U&&this._numObserversMarkedAsDeleted--,this._observers.splice(V,1),!0)}makeObserverTopPriority(N){this._remove(N,!1),this._observers.unshift(N)}makeObserverBottomPriority(N){this._remove(N,!1),this._observers.push(N)}notifyObservers(N){let U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,V=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0,t=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=N),!this._observers.length)return!0;const n=this._eventState;n.mask=U,n.target=V,n.currentTarget=A,n.skipNextObservers=!1,n.lastReturnValue=N,n.userInfo=t;for(const q of this._observers)if(!q._willBeUnregistered&&(q.mask&U&&(q.unregisterOnNextCall&&this._deferUnregister(q),q.scope?n.lastReturnValue=q.callback.apply(q.scope,[N,n]):n.lastReturnValue=q.callback(N,n)),n.skipNextObservers))return!1;return!0}notifyObserver(N,U){let V=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=U),N._willBeUnregistered)return;const A=this._eventState;A.mask=V,A.skipNextObservers=!1,N.unregisterOnNextCall&&this._deferUnregister(N),N.callback(U,A)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const N=this._observers.pop();N&&(N._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const N=new q;return N._observers=this._observers.slice(0),N}hasSpecificMask(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const U of this._observers)if(U.mask&N||U.mask===N)return!0;return!1}}},12264:(N,U,V)=>{V.d(U,{c:()=>t,f:()=>q});let A=[];class t{static SetImmediate(N){0===A.length&&setTimeout((()=>{const N=A;A=[];for(const U of N)U()}),1),A.push(N)}}function n(N,U,V){try{if(N())return U(),!0}catch(A){return null===V||void 0===V||V(A),!0}return!1}const q=function(N,U,V){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,q=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&n(N,U,V))return null;const i=setInterval((()=>{n(N,U,V)?clearInterval(i):(t-=A,t<0&&(clearInterval(i),null===V||void 0===V||V(new Error("Operation timed out after maximum retries. "+(q||"")),!0)))}),A);return()=>clearInterval(i)}}}]);