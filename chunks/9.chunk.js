"use strict";(self.fjf2z1c8il8=self.fjf2z1c8il8||[]).push([[9],{12337:(g,i,a)=>{a.d(i,{b:()=>Y,c:()=>v,k:()=>P,g:()=>T,m:()=>l});class n{constructor(){this.children=[]}isValid(g){return!0}process(g,i,a){let n="";if(this.line){let a=this.line;const F=i.processor;if(F){var L,d,b,k,e,N;F.lineProcessor&&(a=F.lineProcessor(a,i.isFragment,i.processingContext));const n=(null===(L=i.processor)||void 0===L?void 0:L.attributeKeywordName)??"attribute",I=i.isFragment&&null!==(d=i.processor)&&void 0!==d&&d.varyingFragmentKeywordName?null===(b=i.processor)||void 0===b?void 0:b.varyingFragmentKeywordName:!i.isFragment&&null!==(k=i.processor)&&void 0!==k&&k.varyingVertexKeywordName?null===(e=i.processor)||void 0===e?void 0:e.varyingVertexKeywordName:"varying";if(!i.isFragment&&F.attributeProcessor&&this.line.startsWith(n))a=F.attributeProcessor(this.line,g,i.processingContext);else if(F.varyingProcessor&&(null!==(N=F.varyingCheck)&&void 0!==N&&N.call(F,this.line,i.isFragment)||!F.varyingCheck&&this.line.startsWith(I)))a=F.varyingProcessor(this.line,i.isFragment,g,i.processingContext);else if(F.uniformProcessor&&F.uniformRegexp&&F.uniformRegexp.test(this.line))i.lookForClosingBracketForUniformBuffer||(a=F.uniformProcessor(this.line,i.isFragment,g,i.processingContext));else if(F.uniformBufferProcessor&&F.uniformBufferRegexp&&F.uniformBufferRegexp.test(this.line))i.lookForClosingBracketForUniformBuffer||(a=F.uniformBufferProcessor(this.line,i.isFragment,i.processingContext),i.lookForClosingBracketForUniformBuffer=!0);else if(F.textureProcessor&&F.textureRegexp&&F.textureRegexp.test(this.line))a=F.textureProcessor(this.line,i.isFragment,g,i.processingContext);else if((F.uniformProcessor||F.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!i.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?F.uniformProcessor&&(a=F.uniformProcessor(this.line,i.isFragment,g,i.processingContext)):F.uniformBufferProcessor&&(a=F.uniformBufferProcessor(this.line,i.isFragment,i.processingContext),i.lookForClosingBracketForUniformBuffer=!0)}i.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(i.lookForClosingBracketForUniformBuffer=!1,F.endOfUniformBufferProcessor&&(a=F.endOfUniformBufferProcessor(this.line,i.isFragment,i.processingContext)))}n+=a+"\n"}for(const F of this.children)n+=F.process(g,i,a);return this.additionalDefineKey&&(g[this.additionalDefineKey]=this.additionalDefineValue||"true",a[this.additionalDefineKey]=g[this.additionalDefineKey]),n}}class L{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(g){this._lines.length=0;for(const i of g){if(!i||"\r"===i)continue;if("#"===i[0]){this._lines.push(i);continue}const g=i.trim();if(!g)continue;if(g.startsWith("//")){this._lines.push(i);continue}const a=g.indexOf(";");if(-1===a)this._lines.push(g);else if(a===g.length-1)g.length>1&&this._lines.push(g);else{const g=i.split(";");for(let i=0;i<g.length;i++){let a=g[i];a&&(a=a.trim(),a&&this._lines.push(a+(i!==g.length-1?";":"")))}}}}}class d extends n{process(g,i,a){for(let n=0;n<this.children.length;n++){const L=this.children[n];if(L.isValid(g))return L.process(g,i,a)}return""}}class b extends n{isValid(g){return this.testExpression.isTrue(g)}}class k{isTrue(g){return!0}static postfixToInfix(g){const i=[];for(const a of g)if(void 0===k._OperatorPriority[a])i.push(a);else{const g=i[i.length-1],n=i[i.length-2];i.length-=2,i.push(`(${n}${a}${g})`)}return i[i.length-1]}static infixToPostfix(g){const i=k._InfixToPostfixCache.get(g);if(i)return i.accessTime=Date.now(),i.result;if(!g.includes("&&")&&!g.includes("||")&&!g.includes(")")&&!g.includes("("))return[g];const a=[];let n=-1;const L=()=>{F=F.trim(),""!==F&&(a.push(F),F="")},d=g=>{n<k._Stack.length-1&&(k._Stack[++n]=g)},b=()=>k._Stack[n],e=()=>-1===n?"!!INVALID EXPRESSION!!":k._Stack[n--];let N=0,F="";for(;N<g.length;){const i=g.charAt(N),I=N<g.length-1?g.substring(N,2+N):"";if("("===i)F="",d(i);else if(")"===i){for(L();-1!==n&&"("!==b();)a.push(e());e()}else if(k._OperatorPriority[I]>1){for(L();-1!==n&&k._OperatorPriority[b()]>=k._OperatorPriority[I];)a.push(e());d(I),N++}else F+=i;N++}for(L();-1!==n;)"("===b()?e():a.push(e());return k._InfixToPostfixCache.size>=k.InfixToPostfixCacheLimitSize&&k.ClearCache(),k._InfixToPostfixCache.set(g,{result:a,accessTime:Date.now()}),a}static ClearCache(){const g=Array.from(k._InfixToPostfixCache.entries()).sort(((g,i)=>g[1].accessTime-i[1].accessTime));for(let i=0;i<k.InfixToPostfixCacheCleanupSize;i++)k._InfixToPostfixCache.delete(g[i][0])}}k.InfixToPostfixCacheLimitSize=5e4,k.InfixToPostfixCacheCleanupSize=25e3,k._InfixToPostfixCache=new Map,k._OperatorPriority={")":0,"(":1,"||":2,"&&":3},k._Stack=["","","","","","","","","","","","","","","","","","","",""];class e extends k{constructor(g){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=g,this.not=i}isTrue(g){let i=void 0!==g[this.define];return this.not&&(i=!i),i}}class N extends k{isTrue(g){return this.leftOperand.isTrue(g)||this.rightOperand.isTrue(g)}}class F extends k{isTrue(g){return this.leftOperand.isTrue(g)&&this.rightOperand.isTrue(g)}}class I extends k{constructor(g,i,a){super(),this.define=g,this.operand=i,this.testValue=a}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(g){let i=!1;const a=parseInt(void 0!=g[this.define]?g[this.define]:this.define),n=parseInt(void 0!=g[this.testValue]?g[this.testValue]:this.testValue);if(isNaN(a)||isNaN(n))return!1;switch(this.operand){case">":i=a>n;break;case"<":i=a<n;break;case"<=":i=a<=n;break;case">=":i=a>=n;break;case"==":i=a===n;break;case"!=":i=a!==n}return i}}var j=a(12303),y=a(12343);const B=/defined\s*?\((.+?)\)/g,c=/defined\s*?\[(.+?)\]/g,D=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,p=/__decl__/,R=/light\{X\}.(\w*)/g,x=/\{X\}/g,E=[],X=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function v(g){g.processor&&g.processor.initializeShaders&&g.processor.initializeShaders(g.processingContext)}function P(g,i,a,n){var L;null!==(L=i.processor)&&void 0!==L&&L.preProcessShaderCode&&(g=i.processor.preProcessShaderCode(g,i.isFragment)),T(g,i,(g=>{i.processCodeAfterIncludes&&(g=i.processCodeAfterIncludes(i.isFragment?"fragment":"vertex",g,i.defines));const L=function(g,i,a){let n=function(g,i){var a;if(null!==(a=i.processor)&&void 0!==a&&a.noPrecision)return g;const n=i.shouldUseHighPrecisionShader;-1===g.indexOf("precision highp float")?g=n?"precision highp float;\n"+g:"precision mediump float;\n"+g:n||(g=g.replace("precision highp float","precision mediump float"));return g}(g,i);if(!i.processor)return n;if(0===i.processor.shaderLanguage&&-1!==n.indexOf("#version 3")&&(n=n.replace("#version 300 es",""),!i.processor.parseGLES3))return n;const L=i.defines,d=K(i,a);i.processor.preProcessor&&(n=i.processor.preProcessor(n,L,d,i.isFragment,i.processingContext));const b={};n=V(n,d,i,b),i.processor.postProcessor&&(n=i.processor.postProcessor(n,L,i.isFragment,i.processingContext,a?{drawBuffersExtensionDisabled:!a.getCaps().drawBuffersExtension}:{},d,b));null!==a&&void 0!==a&&a._features.needShaderCodeInlining&&(n=a.inlineShaderCode(n));return n}(g,i,n);a(L,g)}))}function Y(g,i,a){return a.processor&&a.processor.finalizeShaders?a.processor.finalizeShaders(g,i,a.processingContext):{vertexCode:g,fragmentCode:i}}function f(g){const i=/defined\((.+)\)/.exec(g);if(i&&i.length)return new e(i[1].trim(),"!"===g[0]);const a=["==","!=",">=","<=","<",">"];let n="",L=0;for(n of a)if(L=g.indexOf(n),L>-1)break;if(-1===L)return new e(g);const d=g.substring(0,L).trim(),b=g.substring(L+n.length).trim();return new I(d,n,b)}function C(g,i){const a=new b,n=g.substring(0,i);let L=g.substring(i);return L=L.substring(0,(L.indexOf("//")+1||L.length+1)-1).trim(),a.testExpression="#ifdef"===n?new e(L):"#ifndef"===n?new e(L,!0):function(g){g=g.replace(B,"defined[$1]");const i=k.infixToPostfix(g),a=[];for(const L of i)if("||"!==L&&"&&"!==L)a.push(L);else if(a.length>=2){let g=a[a.length-1],i=a[a.length-2];a.length-=2;const n="&&"==L?new F:new N;"string"===typeof g&&(g=g.replace(c,"defined($1)")),"string"===typeof i&&(i=i.replace(c,"defined($1)")),n.leftOperand="string"===typeof i?f(i):i,n.rightOperand="string"===typeof g?f(g):g,a.push(n)}let n=a[a.length-1];return"string"===typeof n&&(n=n.replace(c,"defined($1)")),"string"===typeof n?f(n):n}(L),a}function U(g,i,a,L){let d=g.currentLine;for(;S(g,a,L);){d=g.currentLine;const b=d.substring(0,5).toLowerCase();if("#else"===b){const a=new n;return i.children.push(a),void S(g,a,L)}if("#elif"===b){const g=C(d,5);i.children.push(g),a=g}}}function S(g,i,a){for(;g.canRead;){g.lineIndex++;const L=g.currentLine;if(L.indexOf("#")>=0){const n=X.exec(L);if(n&&n.length){switch(n[0]){case"#ifdef":{const n=new d;i.children.push(n);const b=C(L,6);n.children.push(b),U(g,n,b,a);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const n=new d;i.children.push(n);const b=C(L,7);n.children.push(b),U(g,n,b,a);break}case"#if":{const n=new d,b=C(L,3);i.children.push(n),n.children.push(b),U(g,n,b,a);break}}continue}}const b=new n;if(b.line=L,i.children.push(b),"#"===L[0]&&"d"===L[1]){const g=L.replace(";","").split(" ");b.additionalDefineKey=g[1],3===g.length&&(b.additionalDefineValue=g[2])}}return!1}function V(g,i,a,d){const b=new n,k=new L;return k.lineIndex=-1,k.lines=g.split("\n"),S(k,b,d),b.process(i,a,d)}function K(g,i){var a;const n=g.defines,L={};for(const d of n){const g=d.replace("#define","").replace(";","").trim().split(" ");L[g[0]]=g.length>1?g[1]:""}return 0===(null===(a=g.processor)||void 0===a?void 0:a.shaderLanguage)&&(L.GL_ES="true"),L.__VERSION__=g.version,L[g.platformName]="true",(0,y.j)(L,null===i||void 0===i?void 0:i.isNDCHalfZRange,null===i||void 0===i?void 0:i.o,null===i||void 0===i?void 0:i.useExactSrgbConversions),L}function T(g,i,a){let n;for(E.length=0;null!==(n=D.exec(g));)E.push(n);let L=String(g),d=[g],b=!1;for(const k of E){let g=k[1];if(-1!==g.indexOf("__decl__")&&(g=g.replace(p,""),i.supportsUniformBuffers&&(g=g.replace("Vertex","Ubo").replace("Fragment","Ubo")),g+="Declaration"),!i.includesShadersStore[g]){const n=i.shadersRepository+"ShadersInclude/"+g+".fx";return void l.loadFile(n,(n=>{i.includesShadersStore[g]=n,T(d.join(""),i,a)}))}{let a=i.includesShadersStore[g];if(k[2]){const g=k[3].split(",");for(let i=0;i<g.length;i+=2){const n=new RegExp(g[i],"g"),L=g[i+1];a=a.replace(n,L)}}if(k[4]){const g=k[5];if(-1!==g.indexOf("..")){const n=g.split(".."),L=parseInt(n[0]);let d=parseInt(n[1]),b=a.slice(0);a="",isNaN(d)&&(d=i.indexParameters[n[1]]);for(let g=L;g<d;g++)i.supportsUniformBuffers||(b=b.replace(R,((g,i)=>i+"{X}"))),a+=b.replace(x,g.toString())+"\n"}else i.supportsUniformBuffers||(a=a.replace(R,((g,i)=>i+"{X}"))),a=a.replace(x,g)}const n=[];for(const g of d){const i=g.split(k[0]);for(let g=0;g<i.length-1;g++)n.push(i[g]),n.push(a);n.push(i[i.length-1])}d=n,b=b||a.indexOf("#include<")>=0||a.indexOf("#include <")>=0}}E.length=0,L=d.join(""),b?T(L.toString(),i,a):a(L)}const l={loadFile:(g,i,a,n,L,d)=>{throw(0,j.b)("FileTools")}}},12343:(g,i,a)=>{a.d(i,{d:()=>L,g:()=>d,j:()=>k,m:()=>b,o:()=>e});var n=a(12303);a(12289);const L={};function d(g,i){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(i?i+"\n":"")+g}function b(g,i,a,d,b,k,e){const N=e||L.loadFile;if(N){return N(g,i,a,d,b,k)}throw(0,n.b)("FileTools")}function k(g,i,a,n){if(g)return i?g.IS_NDC_HALF_ZRANGE="":delete g.IS_NDC_HALF_ZRANGE,a?g.USE_REVERSE_DEPTHBUFFER="":delete g.USE_REVERSE_DEPTHBUFFER,void(n?g.USE_EXACT_SRGB_CONVERSIONS="":delete g.USE_EXACT_SRGB_CONVERSIONS);{let g="";return i&&(g+="#define IS_NDC_HALF_ZRANGE"),a&&(g&&(g+="\n"),g+="#define USE_REVERSE_DEPTHBUFFER"),n&&(g&&(g+="\n"),g+="#define USE_EXACT_SRGB_CONVERSIONS"),g}}function e(g,i){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;switch(g){case 3:{const g=(ArrayBuffer,new Int8Array(i));return n&&g.set(new Int8Array(n)),g}case 0:{const g=(ArrayBuffer,new Uint8Array(i));return n&&g.set(new Uint8Array(n)),g}case 4:{const g=i instanceof ArrayBuffer?new Int16Array(i):new Int16Array(a?i/2:i);return n&&g.set(new Int16Array(n)),g}case 5:case 8:case 9:case 10:case 2:{const g=i instanceof ArrayBuffer?new Uint16Array(i):new Uint16Array(a?i/2:i);return n&&g.set(new Uint16Array(n)),g}case 6:{const g=i instanceof ArrayBuffer?new Int32Array(i):new Int32Array(a?i/4:i);return n&&g.set(new Int32Array(n)),g}case 7:case 11:case 12:case 13:case 14:case 15:{const g=i instanceof ArrayBuffer?new Uint32Array(i):new Uint32Array(a?i/4:i);return n&&g.set(new Uint32Array(n)),g}case 1:{const g=i instanceof ArrayBuffer?new Float32Array(i):new Float32Array(a?i/4:i);return n&&g.set(new Float32Array(n)),g}}const L=(ArrayBuffer,new Uint8Array(i));return n&&L.set(new Uint8Array(n)),L}},12367:(g,i,a)=>{a.d(i,{c:()=>n});class n{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?n.ShadersRepository:n.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?n.ShadersStore:n.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?n.IncludesShadersStore:n.IncludesShadersStoreWGSL}}n.ShadersRepository="src/Shaders/",n.ShadersStore={},n.IncludesShadersStore={},n.ShadersRepositoryWGSL="src/ShadersWGSL/",n.ShadersStoreWGSL={},n.IncludesShadersStoreWGSL={}},12381:(g,i,a)=>{a.d(i,{d:()=>j,f:()=>x,g:()=>B,h:()=>y,j:()=>c,k:()=>R,n:()=>I,p:()=>N,q:()=>F,u:()=>e,y:()=>k});class n{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.yi._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(g){g&&this.program&&g(this.program)}setEngine(g){this.yi=g}_fillEffectInformation(g,i,a,n,L,d,b,k){const e=this.yi;if(e.supportsUniformBuffers)for(const F in i)g.bindUniformBlock(F,i[F]);let N;for(this.yi.getUniforms(this,a).forEach(((g,i)=>{n[a[i]]=g})),this._uniforms=n,N=0;N<L.length;N++){null==g.getUniform(L[N])&&(L.splice(N,1),N--)}L.forEach(((g,i)=>{d[g]=i}));for(const F of e.getAttributes(this,b))k.push(F)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(g,i){const a=this._valueCache[g],n=i.updateFlag;return(void 0===a||a!==n)&&(this._valueCache[g]=n,!0)}_cacheFloat2(g,i,a){let n=this._valueCache[g];if(!n||2!==n.length)return n=[i,a],this._valueCache[g]=n,!0;let L=!1;return n[0]!==i&&(n[0]=i,L=!0),n[1]!==a&&(n[1]=a,L=!0),L}_cacheFloat3(g,i,a,n){let L=this._valueCache[g];if(!L||3!==L.length)return L=[i,a,n],this._valueCache[g]=L,!0;let d=!1;return L[0]!==i&&(L[0]=i,d=!0),L[1]!==a&&(L[1]=a,d=!0),L[2]!==n&&(L[2]=n,d=!0),d}_cacheFloat4(g,i,a,n,L){let d=this._valueCache[g];if(!d||4!==d.length)return d=[i,a,n,L],this._valueCache[g]=d,!0;let b=!1;return d[0]!==i&&(d[0]=i,b=!0),d[1]!==a&&(d[1]=a,b=!0),d[2]!==n&&(d[2]=n,b=!0),d[3]!==L&&(d[3]=L,b=!0),b}setInt(g,i){const a=this._valueCache[g];void 0!==a&&a===i||this.yi.setInt(this._uniforms[g],i)&&(this._valueCache[g]=i)}setInt2(g,i,a){this._cacheFloat2(g,i,a)&&(this.yi.setInt2(this._uniforms[g],i,a)||(this._valueCache[g]=null))}setInt3(g,i,a,n){this._cacheFloat3(g,i,a,n)&&(this.yi.setInt3(this._uniforms[g],i,a,n)||(this._valueCache[g]=null))}setInt4(g,i,a,n,L){this._cacheFloat4(g,i,a,n,L)&&(this.yi.setInt4(this._uniforms[g],i,a,n,L)||(this._valueCache[g]=null))}setIntArray(g,i){this._valueCache[g]=null,this.yi.setIntArray(this._uniforms[g],i)}setIntArray2(g,i){this._valueCache[g]=null,this.yi.setIntArray2(this._uniforms[g],i)}setIntArray3(g,i){this._valueCache[g]=null,this.yi.setIntArray3(this._uniforms[g],i)}setIntArray4(g,i){this._valueCache[g]=null,this.yi.setIntArray4(this._uniforms[g],i)}setUInt(g,i){const a=this._valueCache[g];void 0!==a&&a===i||this.yi.setUInt(this._uniforms[g],i)&&(this._valueCache[g]=i)}setUInt2(g,i,a){this._cacheFloat2(g,i,a)&&(this.yi.setUInt2(this._uniforms[g],i,a)||(this._valueCache[g]=null))}setUInt3(g,i,a,n){this._cacheFloat3(g,i,a,n)&&(this.yi.setUInt3(this._uniforms[g],i,a,n)||(this._valueCache[g]=null))}setUInt4(g,i,a,n,L){this._cacheFloat4(g,i,a,n,L)&&(this.yi.setUInt4(this._uniforms[g],i,a,n,L)||(this._valueCache[g]=null))}setUIntArray(g,i){this._valueCache[g]=null,this.yi.setUIntArray(this._uniforms[g],i)}setUIntArray2(g,i){this._valueCache[g]=null,this.yi.setUIntArray2(this._uniforms[g],i)}setUIntArray3(g,i){this._valueCache[g]=null,this.yi.setUIntArray3(this._uniforms[g],i)}setUIntArray4(g,i){this._valueCache[g]=null,this.yi.setUIntArray4(this._uniforms[g],i)}setArray(g,i){this._valueCache[g]=null,this.yi.setArray(this._uniforms[g],i)}setArray2(g,i){this._valueCache[g]=null,this.yi.setArray2(this._uniforms[g],i)}setArray3(g,i){this._valueCache[g]=null,this.yi.setArray3(this._uniforms[g],i)}setArray4(g,i){this._valueCache[g]=null,this.yi.setArray4(this._uniforms[g],i)}setMatrices(g,i){i&&(this._valueCache[g]=null,this.yi.setMatrices(this._uniforms[g],i))}setMatrix(g,i){this._cacheMatrix(g,i)&&(this.yi.setMatrices(this._uniforms[g],i.fd())||(this._valueCache[g]=null))}setMatrix3x3(g,i){this._valueCache[g]=null,this.yi.setMatrix3x3(this._uniforms[g],i)}setMatrix2x2(g,i){this._valueCache[g]=null,this.yi.setMatrix2x2(this._uniforms[g],i)}setFloat(g,i){const a=this._valueCache[g];void 0!==a&&a===i||this.yi.setFloat(this._uniforms[g],i)&&(this._valueCache[g]=i)}setVector2(g,i){this._cacheFloat2(g,i.x,i.y)&&(this.yi.setFloat2(this._uniforms[g],i.x,i.y)||(this._valueCache[g]=null))}setFloat2(g,i,a){this._cacheFloat2(g,i,a)&&(this.yi.setFloat2(this._uniforms[g],i,a)||(this._valueCache[g]=null))}setVector3(g,i){this._cacheFloat3(g,i.x,i.y,i.z)&&(this.yi.setFloat3(this._uniforms[g],i.x,i.y,i.z)||(this._valueCache[g]=null))}setFloat3(g,i,a,n){this._cacheFloat3(g,i,a,n)&&(this.yi.setFloat3(this._uniforms[g],i,a,n)||(this._valueCache[g]=null))}setVector4(g,i){this._cacheFloat4(g,i.x,i.y,i.z,i.w)&&(this.yi.setFloat4(this._uniforms[g],i.x,i.y,i.z,i.w)||(this._valueCache[g]=null))}setQuaternion(g,i){this._cacheFloat4(g,i.x,i.y,i.z,i.w)&&(this.yi.setFloat4(this._uniforms[g],i.x,i.y,i.z,i.w)||(this._valueCache[g]=null))}setFloat4(g,i,a,n,L){this._cacheFloat4(g,i,a,n,L)&&(this.yi.setFloat4(this._uniforms[g],i,a,n,L)||(this._valueCache[g]=null))}setColor3(g,i){this._cacheFloat3(g,i.r,i.g,i.b)&&(this.yi.setFloat3(this._uniforms[g],i.r,i.g,i.b)||(this._valueCache[g]=null))}setColor4(g,i,a){this._cacheFloat4(g,i.r,i.g,i.b,a)&&(this.yi.setFloat4(this._uniforms[g],i.r,i.g,i.b,a)||(this._valueCache[g]=null))}setDirectColor4(g,i){this._cacheFloat4(g,i.r,i.g,i.b,i.a)&&(this.yi.setFloat4(this._uniforms[g],i.r,i.g,i.b,i.a)||(this._valueCache[g]=null))}_getVertexShaderCode(){return this.vertexShader?this.yi._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.yi._getShaderSource(this.fragmentShader):null}}var L=a(12343);const d=new WeakMap,b={_webGLVersion:2,cachedPipelines:{}};function k(g){let i=d.get(g);if(!i){if(!g)return b;i={_webGLVersion:g.TEXTURE_BINDING_3D?2:1,_context:g,parallelShaderCompile:g.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},d.set(g,i)}return i}function e(g){d.delete(g)}function N(g,i,a,n,L,d){const b=k(n);d||(d=b._createShaderProgramInjection??j);return d(g,p(i,"vertex",n,b._contextWasLost),p(a,"fragment",n,b._contextWasLost),n,L,b.validateShaderPrograms)}function F(g,i,a,n,L){let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,b=arguments.length>6?arguments[6]:void 0;const e=k(L);b||(b=e._createShaderProgramInjection??j);const N=e._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return b(g,D(i,"vertex",n,N,L,e._contextWasLost),D(a,"fragment",n,N,L,e._contextWasLost),L,d,e.validateShaderPrograms)}function I(g,i){const a=new n,L=k(g);return L.parallelShaderCompile&&!L.disableParallelShaderCompile&&(a.isParallelCompiled=!0),a.context=L._context,a}function j(g,i,a,n){let L=arguments.length>5?arguments[5]:void 0;const d=n.createProgram();if(g.program=d,!d)throw new Error("Unable to create program");return n.attachShader(d,i),n.attachShader(d,a),n.linkProgram(d),g.context=n,g.vertexShader=i,g.fragmentShader=a,g.isParallelCompiled||B(g,n,L),d}function y(g,i,a){const n=g;if(n._isDisposed)return!1;const L=k(i);return!!(L&&L.parallelShaderCompile&&L.parallelShaderCompile.COMPLETION_STATUS_KHR&&n.program&&i.getProgramParameter(n.program,L.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(B(n,i,a),!0)}function B(g,i,a){const n=g.context,L=g.vertexShader,d=g.fragmentShader,b=g.program;if(!n.getProgramParameter(b,n.LINK_STATUS)){if(!i.getShaderParameter(L,i.COMPILE_STATUS)){const a=i.getShaderInfoLog(L);if(a)throw g.vertexCompilationError=a,new Error("VERTEX SHADER "+a)}if(!i.getShaderParameter(d,i.COMPILE_STATUS)){const a=i.getShaderInfoLog(d);if(a)throw g.fragmentCompilationError=a,new Error("FRAGMENT SHADER "+a)}const a=n.getProgramInfoLog(b);if(a)throw g.programLinkError=a,new Error(a)}if(a){n.validateProgram(b);if(!n.getProgramParameter(b,n.VALIDATE_STATUS)){const i=n.getProgramInfoLog(b);if(i)throw g.programValidationError=i,new Error(i)}}n.deleteShader(L),n.deleteShader(d),g.vertexShader=void 0,g.fragmentShader=void 0,g.onCompiled&&(g.onCompiled(),g.onCompiled=void 0)}function c(g,i,a,n,L,d,b,e,I){let j=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0,B=arguments.length>12?arguments[12]:void 0;const c=k(g.context);y||(y=c.createRawShaderProgramInjection??N),B||(B=c.createShaderProgramInjection??F);const D=g;D.program=n?y(D,i,a,D.context,I):B(D,i,a,e,D.context,I),D.program.__SPECTOR_rebuildProgram=b,j()}function D(g,i,a,n,d,b){return p((0,L.g)(g,a,n),i,d,b)}function p(g,i,a,n){const L=a.createShader("vertex"===i?a.VERTEX_SHADER:a.FRAGMENT_SHADER);if(!L){let g=a.NO_ERROR,L=a.NO_ERROR;for(;(L=a.getError())!==a.NO_ERROR;)g=L;throw new Error(`Something went wrong while creating a gl ${i} shader object. gl error=${g}, gl isContextLost=${a.isContextLost()}, _contextWasLost=${n}`)}return a.shaderSource(L,g),a.compileShader(L),L}function R(g,i){i.useProgram(g)}function x(g,i){const a=g;if(!a.isParallelCompiled)return void i(g);const n=a.onCompiled;a.onCompiled=()=>{null===n||void 0===n||n(),i(g)}}},12373:(g,i,a)=>{a.d(i,{c:()=>I,e:()=>y,i:()=>N,m:()=>F});var n=a(12289),L=a(12381),d=a(12367),b=a(12292),k=a(12337),e=a(12343);function N(g,i){return(0,L.y)(i).cachedPipelines[g]}function F(g){const i=g._name,a=g.context;if(i&&a){const g=(0,L.y)(a),n=g.cachedPipelines[i];null===n||void 0===n||n.dispose(),delete g.cachedPipelines[i]}}function I(g,i,a,L,d,b,e){let N,F;const I=(0,n.k)()?null===b||void 0===b?void 0:b.getHostDocument():null;N="string"===typeof i?i:i.vertexSource?"source:"+i.vertexSource:i.vertexElement?(null===I||void 0===I?void 0:I.getElementById(i.vertexElement))||i.vertexElement:i.vertex||i,F="string"===typeof i?i:i.fragmentSource?"source:"+i.fragmentSource:i.fragmentElement?(null===I||void 0===I?void 0:I.getElementById(i.fragmentElement))||i.fragmentElement:i.fragment||i;const y=[void 0,void 0],B=()=>{if(y[0]&&y[1]){g.isFragment=!0;const[n,N]=y;(0,k.k)(N,g,((b,N)=>{e&&(e._fragmentSourceCodeBeforeMigration=N),a&&(b=a("fragment",b));const F=(0,k.b)(n,b,g);g=null;const I=function(g,i,a,n){if(a){return{vertexSourceCode:(1===n?"//":"")+"#define SHADER_NAME vertex:"+(a.vertexElement||a.vertex||a.spectorName||a)+"\n"+g,fragmentSourceCode:(1===n?"//":"")+"#define SHADER_NAME fragment:"+(a.fragmentElement||a.fragment||a.spectorName||a)+"\n"+i}}return{vertexSourceCode:g,fragmentSourceCode:i}}(F.vertexCode,F.fragmentCode,i,d);null===L||void 0===L||L(I.vertexSourceCode,I.fragmentSourceCode)}),b)}};j(N,"Vertex","",(i=>{(0,k.c)(g),(0,k.k)(i,g,((g,n)=>{e&&(e._rawVertexSourceCode=i,e._vertexSourceCodeBeforeMigration=n),a&&(g=a("vertex",g)),y[0]=g,B()}),b)}),d),j(F,"Fragment","Pixel",(g=>{e&&(e._rawFragmentSourceCode=g),y[1]=g,B()}),d)}function j(g,i,a,L,b,k){if("undefined"!==typeof HTMLElement&&g instanceof HTMLElement){return void L((0,n.b)(g))}if("source:"===g.substring(0,7))return void L(g.substring(7));if("base64:"===g.substring(0,7)){return void L(window.atob(g.substring(7)))}const N=d.c.GetShadersStore(b);if(N[g+i+"Shader"])return void L(N[g+i+"Shader"]);if(a&&N[g+a+"Shader"])return void L(N[g+a+"Shader"]);let F;if(F="."===g[0]||"/"===g[0]||g.indexOf("http")>-1?g:d.c.GetShadersRepository(b)+g,!(k=k||e.m))throw new Error("loadFileInjection is not defined");k(F+"."+i.toLowerCase()+".fx",L)}const y=(g,i,a,n)=>{try{const d=g.context?(0,L.y)(g.context):null;d&&(d.disableParallelShaderCompile=g.disableParallelCompilation);const b=g.existingPipelineContext||i(g.shaderProcessingContext);return b._name=g.name,g.name&&d&&(d.cachedPipelines[g.name]=b),a(b,g.vertex,g.fragment,!!g.createAsRaw,"","",g.rebuildRebind,g.defines,g.transformFeedbackVaryings,"",(()=>{n(b,(()=>{var i;null===(i=g.onRenderingStateCompiled)||void 0===i||i.call(g,b)}))})),b}catch(d){throw b.b.Error("Error compiling effect"),d}}},12362:(g,i,a)=>{a.r(i),a.d(i,{Effect:()=>e});var n=a(12286),L=a(12292),d=a(12367),b=a(12373),k=a(12352);class e{static get ShadersRepository(){return d.c.ShadersRepository}static set ShadersRepository(g){d.c.ShadersRepository=g}get p(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new n.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(g,i,a){let L=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,d=arguments.length>4?arguments[4]:void 0,k=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,N=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,F=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,I=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,j=arguments.length>9?arguments[9]:void 0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",B=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,c=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new n.b,this.onErrorObservable=new n.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=g,this._key=y;const D=this._key.replace(/\r/g,"").replace(/\n/g,"|");let p;if(i.attributes){const g=i;if(this._engine=a,this._attributesNames=g.attributes,this._uniformsNames=g.uniformsNames.concat(g.samplers),this._samplerList=g.samplers.slice(),this.defines=g.defines,this.onError=g.onError,this.onCompiled=g.onCompiled,this._fallbacks=g.fallbacks,this._indexParameters=g.indexParameters,this._transformFeedbackVaryings=g.transformFeedbackVaryings||null,this._multiTarget=!!g.multiTarget,this._shaderLanguage=g.shaderLanguage??0,this._disableParallelShaderCompilation=!!g.disableParallelShaderCompilation,g.uniformBuffersNames){this._uniformBuffersNamesList=g.uniformBuffersNames.slice();for(let i=0;i<g.uniformBuffersNames.length;i++)this._uniformBuffersNames[g.uniformBuffersNames[i]]=i}this._processFinalCode=g.processFinalCode??null,this._processCodeAfterIncludes=g.processCodeAfterIncludes??void 0,c=g.extraInitializationsAsync,p=g.existingPipelineContext}else this._engine=d,this.defines=null==k?"":k,this._uniformsNames=a.concat(L),this._samplerList=L?L.slice():[],this._attributesNames=i,this._uniformBuffersNamesList=[],this._shaderLanguage=B,this.onError=I,this.onCompiled=F,this._indexParameters=j,this._fallbacks=N;"WEBGL2"===this._engine.shaderPlatformName&&(p=(0,b.i)(D,this._engine._gl)??p),this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++,p?(this._pipelineContext=p,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,c),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.p||this.dispose(!0)}))}async _processShaderCodeAsync(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;n&&await n(),this._processingContext=a||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const L={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:g??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:d.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:d.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,o:this._engine.o,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,b.c)(L,this.name,this._processFinalCode,((g,a)=>{this._vertexSourceCode=g,this._fragmentSourceCode=a,this._prepareEffect(i)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.p||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(g){return this._attributes[g]}getAttributeLocationByName(g){return this._attributeLocationByName[g]}getAttributesCount(){return this._attributes.length}getUniformIndex(g){return this._uniformsNames.indexOf(g)}getUniform(g){return this._uniforms[g]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((g=>{this.executeWhenCompiled(g)}))}executeWhenCompiled(g){this.isReady()?g(this):(this.onCompileObservable.add((i=>{g(i)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(g){(0,k.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(i=>{this._processCompilationErrors(i,g)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var g;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(g=this._pipelineContext)||void 0===g?void 0:g._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var g;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(g=this._pipelineContext)||void 0===g?void 0:g._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,o:this._engine.o,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(g,i,a,n){this._isReady=!1,this._vertexSourceCodeOverride=g,this._fragmentSourceCodeOverride=i,this.onError=(g,i)=>{n&&n(i)},this.onCompiled=()=>{var g,i;const n=this.getEngine().scenes;if(n)for(let a=0;a<n.length;a++)n[a].markAllMaterialsAsDirty(127);null===(g=(i=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===g||g.call(i,a)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(g){if(this._pipelineContext=g,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let i=0;i<this._attributesNames.length;i++){const g=this._attributesNames[i];this._attributeLocationByName[g]=this._attributes[i]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),e.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const i=this._pipelineContext;this._isReady=!1;try{const a=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),n=a?null:this.defines,L=a?this._vertexSourceCodeOverride:this._vertexSourceCode,d=a?this._fragmentSourceCodeOverride:this._fragmentSourceCode,k=this._engine;this._pipelineContext=(0,b.e)({existingPipelineContext:g?i:null,vertex:L,fragment:d,context:"WEBGL2"===k.shaderPlatformName||"WEBGL1"===k.shaderPlatformName?k._gl:void 0,rebuildRebind:(g,i,a,n)=>this._rebuildProgram(g,i,a,n),defines:n,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:a,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:a=>{i&&!g&&this._engine._deletePipelineContext(i),a&&this._onRenderingStateCompiled(a)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(i)}catch(a){this._processCompilationErrors(a,i)}}_getShaderCodeAndErrorLine(g,i,a){const n=a?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let L=null;if(i&&g){const d=i.match(n);if(d&&2===d.length){const i=parseInt(d[1]),n=g.split("\n",-1);n.length>=i&&(L=`Offending line [${i}] in ${a?"fragment":"vertex"} code: ${n[i-1]}`)}}return[g,L]}_processCompilationErrors(g){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=g.message;const a=this._attributesNames,n=this._fallbacks;if(L.b.Error("Unable to compile effect:"),L.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),L.b.Error(`Attributes: ${a.join(" ")}`),L.b.Error("Defines:\n"+this.defines),e.LogShaderCodeOnCompilationError){var d,b;let g=null,i=null,a=null;var k;if(null!==(d=this._pipelineContext)&&void 0!==d&&d._getVertexShaderCode()&&([a,g]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),a&&(L.b.Error("Vertex code:"),L.b.Error(a))),null!==(b=this._pipelineContext)&&void 0!==b&&b._getFragmentShaderCode())[a,i]=this._getShaderCodeAndErrorLine(null===(k=this._pipelineContext)||void 0===k?void 0:k._getFragmentShaderCode(),this._compilationError,!0),a&&(L.b.Error("Fragment code:"),L.b.Error(a));g&&L.b.Error(g),i&&L.b.Error(i)}L.b.Error("Error: "+this._compilationError);const N=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};i&&(this._pipelineContext=i,this._isReady=!0,N()),n?(this._pipelineContext=null,n.hasMoreFallbacks?(this._allFallbacksProcessed=!1,L.b.Error("Trying next fallback."),this.defines=n.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,N(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,i||N())}get isSupported(){return""===this._compilationError}_bindTexture(g,i){this._engine._bindTexture(this._samplers[g],i,g)}setTexture(g,i){this._engine.setTexture(this._samplers[g],this._uniforms[g],i,g)}setTextureArray(g,i){const a=g+"Ex";if(-1===this._samplerList.indexOf(a+"0")){const n=this._samplerList.indexOf(g);for(let g=1;g<i.length;g++){const i=a+(g-1).toString();this._samplerList.splice(n+g,0,i)}let L=0;for(const g of this._samplerList)this._samplers[g]=L,L+=1}this._engine.setTextureArray(this._samplers[g],this._uniforms[g],i,g)}bindUniformBuffer(g,i){const a=this._uniformBuffersNames[i];void 0===a||e._BaseCache[a]===g&&this._engine._features.useUBOBindingCache||(e._BaseCache[a]=g,this._engine.bindUniformBufferBase(g,a,i))}bindUniformBlock(g,i){this._engine.bindUniformBlock(this._pipelineContext,g,i)}setInt(g,i){return this._pipelineContext.setInt(g,i),this}setInt2(g,i,a){return this._pipelineContext.setInt2(g,i,a),this}setInt3(g,i,a,n){return this._pipelineContext.setInt3(g,i,a,n),this}setInt4(g,i,a,n,L){return this._pipelineContext.setInt4(g,i,a,n,L),this}setIntArray(g,i){return this._pipelineContext.setIntArray(g,i),this}setIntArray2(g,i){return this._pipelineContext.setIntArray2(g,i),this}setIntArray3(g,i){return this._pipelineContext.setIntArray3(g,i),this}setIntArray4(g,i){return this._pipelineContext.setIntArray4(g,i),this}setUInt(g,i){return this._pipelineContext.setUInt(g,i),this}setUInt2(g,i,a){return this._pipelineContext.setUInt2(g,i,a),this}setUInt3(g,i,a,n){return this._pipelineContext.setUInt3(g,i,a,n),this}setUInt4(g,i,a,n,L){return this._pipelineContext.setUInt4(g,i,a,n,L),this}setUIntArray(g,i){return this._pipelineContext.setUIntArray(g,i),this}setUIntArray2(g,i){return this._pipelineContext.setUIntArray2(g,i),this}setUIntArray3(g,i){return this._pipelineContext.setUIntArray3(g,i),this}setUIntArray4(g,i){return this._pipelineContext.setUIntArray4(g,i),this}setFloatArray(g,i){return this._pipelineContext.setArray(g,i),this}setFloatArray2(g,i){return this._pipelineContext.setArray2(g,i),this}setFloatArray3(g,i){return this._pipelineContext.setArray3(g,i),this}setFloatArray4(g,i){return this._pipelineContext.setArray4(g,i),this}setArray(g,i){return this._pipelineContext.setArray(g,i),this}setArray2(g,i){return this._pipelineContext.setArray2(g,i),this}setArray3(g,i){return this._pipelineContext.setArray3(g,i),this}setArray4(g,i){return this._pipelineContext.setArray4(g,i),this}setMatrices(g,i){return this._pipelineContext.setMatrices(g,i),this}setMatrix(g,i){return this._pipelineContext.setMatrix(g,i),this}setMatrix3x3(g,i){return this._pipelineContext.setMatrix3x3(g,i),this}setMatrix2x2(g,i){return this._pipelineContext.setMatrix2x2(g,i),this}setFloat(g,i){return this._pipelineContext.setFloat(g,i),this}setBool(g,i){return this._pipelineContext.setInt(g,i?1:0),this}setVector2(g,i){return this._pipelineContext.setVector2(g,i),this}setFloat2(g,i,a){return this._pipelineContext.setFloat2(g,i,a),this}setVector3(g,i){return this._pipelineContext.setVector3(g,i),this}setFloat3(g,i,a,n){return this._pipelineContext.setFloat3(g,i,a,n),this}setVector4(g,i){return this._pipelineContext.setVector4(g,i),this}setQuaternion(g,i){return this._pipelineContext.setQuaternion(g,i),this}setFloat4(g,i,a,n,L){return this._pipelineContext.setFloat4(g,i,a,n,L),this}setColor3(g,i){return this._pipelineContext.setColor3(g,i),this}setColor4(g,i,a){return this._pipelineContext.setColor4(g,i,a),this}setDirectColor4(g,i){return this._pipelineContext.setDirectColor4(g,i),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(e.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,b.m)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(g,i,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i&&(d.c.GetShadersStore(n)[`${g}PixelShader`]=i),a&&(d.c.GetShadersStore(n)[`${g}VertexShader`]=a)}static ResetCache(){e._BaseCache={}}}e.LogShaderCodeOnCompilationError=!0,e.PersistentMode=!1,e.AutomaticallyClearCodeCache=!1,e._UniqueIdSeed=0,e._BaseCache={},e.ShadersStore=d.c.ShadersStore,e.IncludesShadersStore=d.c.IncludesShadersStore},12303:(g,i,a)=>{a.d(i,{b:()=>L});const n={};function L(g){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!n[g])return n[g]=!0,`${g} needs to be imported before as it contains a side-effect required by your code.`}},12289:(g,i,a)=>{function n(){return"undefined"!==typeof window}function L(){return"undefined"!==typeof navigator}function d(){return"undefined"!==typeof document}function b(g){let i="",a=g.firstChild;for(;a;)3===a.nodeType&&(i+=a.textContent),a=a.nextSibling;return i}a.d(i,{b:()=>b,f:()=>d,j:()=>L,k:()=>n})},12292:(g,i,a)=>{a.d(i,{b:()=>n});class n{static _CheckLimit(g,i){let a=n._LogLimitOutputs[g];return a?a.current++:(a={limit:i,current:1},n._LogLimitOutputs[g]=a),a.current<=a.limit}static _GenerateLimitMessage(g){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const a=n._LogLimitOutputs[g];if(!a||!n.MessageLimitReached)return;const L=this._Levels[i];a.current===a.limit&&n[L.name](n.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,L.name??""))}static _AddLogEntry(g){n._LogCache=g+n._LogCache,n.OnNewCacheEntry&&n.OnNewCacheEntry(g)}static _FormatMessage(g){const i=g=>g<10?"0"+g:""+g,a=new Date;return"["+i(a.getHours())+":"+i(a.getMinutes())+":"+i(a.getSeconds())+"]: "+g}static _LogDisabled(g,i){}static _LogEnabled(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;const L=Array.isArray(i)?i[0]:i;if(void 0!==a&&!n._CheckLimit(L,a))return;const d=n._FormatMessage(L),b=this._Levels[g],k=Array.isArray(i)?i.slice(1):[];b.logFunc&&b.logFunc("BJS - "+d,...k);const e=`<div style='color:${b.color}'>${d}</div><br>`;n._AddLogEntry(e),n._GenerateLimitMessage(L,g)}static get LogCache(){return n._LogCache}static ClearLogCache(){n._LogCache="",n._LogLimitOutputs={},n.errorsCount=0}static set LogLevels(g){n.Log=n._LogDisabled,n.Warn=n._LogDisabled,n.Error=n._LogDisabled;const i=[n.MessageLogLevel,n.WarningLogLevel,n.ErrorLogLevel];for(const a of i)if((g&a)===a){const g=this._Levels[a];n[g.name]=n._LogEnabled.bind(n,a)}}}n.NoneLogLevel=0,n.MessageLogLevel=1,n.WarningLogLevel=2,n.ErrorLogLevel=4,n.AllLogLevel=7,n.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",n._LogCache="",n._LogLimitOutputs={},n._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],n.errorsCount=0,n.Log=n._LogEnabled.bind(n,n.MessageLogLevel),n.Warn=n._LogEnabled.bind(n,n.WarningLogLevel),n.Error=n._LogEnabled.bind(n,n.ErrorLogLevel)},12286:(g,i,a)=>{a.d(i,{b:()=>b});const n="undefined"!==typeof WeakRef;class L{constructor(g){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.initialize(g,i,a,n)}initialize(g){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return this.mask=g,this.skipNextObservers=i,this.target=a,this.currentTarget=n,this}}class d{constructor(g,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=g,this.mask=i,this.scope=a,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(g)}}class b{static FromPromise(g,i){const a=new b;return g.then((g=>{a.notifyObservers(g)})).catch((g=>{if(!i)throw g;i.notifyObservers(g)})),a}get observers(){return this._observers}constructor(g){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=i,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new L(0),g&&(this._onObserverAdded=g)}add(g){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!g)return null;const L=new d(g,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);L.unregisterOnNextCall=a,i?this._observers.unshift(L):this._observers.push(L),this._onObserverAdded&&this._onObserverAdded(L),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(L,this._lastNotifiedValue);const b=n?new WeakRef(this):{deref:()=>this};return L._remove=function(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const i=b.deref();i&&(g?i.remove(L):i._remove(L))},L}addOnce(g){return this.add(g,void 0,void 0,void 0,!0)}remove(g){if(!g)return!1;g._remove=null;return-1!==this._observers.indexOf(g)&&(this._deferUnregister(g),!0)}removeCallback(g,i){for(let a=0;a<this._observers.length;a++){const n=this._observers[a];if(!n._willBeUnregistered&&(n.callback===g&&(!i||i===n.scope)))return this._deferUnregister(n),!0}return!1}_deferUnregister(g){g._willBeUnregistered||(this._numObserversMarkedAsDeleted++,g.unregisterOnNextCall=!1,g._willBeUnregistered=!0,setTimeout((()=>{this._remove(g)}),0))}_remove(g){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!g)return!1;const a=this._observers.indexOf(g);return-1!==a&&(i&&this._numObserversMarkedAsDeleted--,this._observers.splice(a,1),!0)}makeObserverTopPriority(g){this._remove(g,!1),this._observers.unshift(g)}makeObserverBottomPriority(g){this._remove(g,!1),this._observers.push(g)}notifyObservers(g){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=g),!this._observers.length)return!0;const d=this._eventState;d.mask=i,d.target=a,d.currentTarget=n,d.skipNextObservers=!1,d.lastReturnValue=g,d.userInfo=L;for(const b of this._observers)if(!b._willBeUnregistered&&(b.mask&i&&(b.unregisterOnNextCall&&this._deferUnregister(b),b.scope?d.lastReturnValue=b.callback.apply(b.scope,[g,d]):d.lastReturnValue=b.callback(g,d)),d.skipNextObservers))return!1;return!0}notifyObserver(g,i){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=i),g._willBeUnregistered)return;const n=this._eventState;n.mask=a,n.skipNextObservers=!1,g.unregisterOnNextCall&&this._deferUnregister(g),g.callback(i,n)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const g=this._observers.pop();g&&(g._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const g=new b;return g._observers=this._observers.slice(0),g}hasSpecificMask(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const i of this._observers)if(i.mask&g||i.mask===g)return!0;return!1}}},12352:(g,i,a)=>{a.d(i,{c:()=>L,f:()=>b});let n=[];class L{static SetImmediate(g){0===n.length&&setTimeout((()=>{const g=n;n=[];for(const i of g)i()}),1),n.push(g)}}function d(g,i,a){try{if(g())return i(),!0}catch(n){return null===a||void 0===a||a(n),!0}return!1}const b=function(g,i,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,b=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&d(g,i,a))return null;const k=setInterval((()=>{d(g,i,a)?clearInterval(k):(L-=n,L<0&&(clearInterval(k),null===a||void 0===a||a(new Error("Operation timed out after maximum retries. "+(b||"")),!0)))}),n);return()=>clearInterval(k)}}}]);