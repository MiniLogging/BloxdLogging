"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[9],{2460:(f,z,w)=>{w.r(z),w.d(z,{Dispose:()=>K,DumpData:()=>X,DumpDataAsync:()=>h,DumpFramebuffer:()=>u,DumpTools:()=>c});var S=w(2348),C=w(535),E=w(741),F=w(580);let J,x=null;async function u(f,z,w,S){let C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",E=arguments.length>5?arguments[5]:void 0,F=arguments.length>6?arguments[6]:void 0;const J=await w.readPixels(0,0,f,z);X(f,z,new Uint8Array(J.buffer),S,C,E,!0,void 0,F)}function h(f,z,w){let S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",C=arguments.length>4?arguments[4]:void 0,E=arguments.length>5&&void 0!==arguments[5]&&arguments[5],F=arguments.length>6&&void 0!==arguments[6]&&arguments[6],J=arguments.length>7?arguments[7]:void 0;return new Promise((x=>{X(f,z,w,(f=>x(f)),S,C,E,F,J)}))}function X(f,z,u,h){let X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",c=arguments.length>5?arguments[5]:void 0,y=arguments.length>6&&void 0!==arguments[6]&&arguments[6],e=arguments.length>7&&void 0!==arguments[7]&&arguments[7],O=arguments.length>8?arguments[8]:void 0;(async function(){return x||(x=new Promise(((f,z)=>{let C,E=null;const x={Og:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};w.e(22).then(w.bind(w,12186)).then((u=>{let{ThinEngine:h}=u;try{C=new OffscreenCanvas(100,100),E=new h(C,!1,x)}catch(c){C=document.createElement("canvas"),E=new h(C,!1,x)}F.c.Instances.pop(),F.c.OnEnginesDisposedObservable.add((f=>{E&&f!==E&&!E.u&&0===F.c.Instances.length&&K()})),E.getCaps().parallelShaderCompile=void 0;const X=new S.d(E);w.e(33).then(w.bind(w,13157)).then((w=>{let{passPixelShader:F}=w;if(!E)return void z("Engine is not defined");const x=new S.g({Wj:E,name:F.name,fragmentShader:F.shader,samplerNames:["textureSampler"]});J={canvas:C,Wj:E,renderer:X,wrapper:x},f(J)}))})).catch(z)}))),await x})().then((w=>{if(w.Wj.setSize(f,z,!0),u instanceof Float32Array){const f=new Uint8Array(u.length);let z=u.length;for(;z--;){const w=u[z];f[z]=Math.round(255*(0,E.c)(w))}u=f}const S=w.Wj.createRawTexture(u,f,z,5,!1,!y,1);w.renderer.setViewport(),w.renderer.applyEffectWrapper(w.wrapper),w.wrapper.effect._bindTexture("textureSampler",S),w.renderer.draw(),e?C.h.ToBlob(w.canvas,(f=>{const z=new FileReader;z.onload=f=>{const z=f.target.result;h&&h(z)},z.readAsArrayBuffer(f)}),X,O):C.h.EncodeScreenshotCanvasData(w.canvas,h,X,c,O),S.dispose()}))}function K(){var f;J?(J.wrapper.dispose(),J.renderer.dispose(),J.Wj.dispose()):null===(f=x)||void 0===f||f.then((f=>{f.wrapper.dispose(),f.renderer.dispose(),f.Wj.dispose()}));x=null,J=null}const c={DumpData:X,DumpDataAsync:h,DumpFramebuffer:u,Dispose:K};C.h.DumpData=X,C.h.DumpDataAsync=h,C.h.DumpFramebuffer=u}}]);