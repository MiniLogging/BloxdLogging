"use strict";(self.hwpa2z1pqte=self.hwpa2z1pqte||[]).push([[9],{12781:(h,R,l)=>{l.d(R,{c:()=>O,g:()=>G,m:()=>p,k:()=>r,n:()=>P});class j{constructor(){this.children=[]}isValid(h){return!0}process(h,R,l){let j="";if(this.line){let l=this.line;const u=R.processor;if(u){var a,D,U,F,w,mh;u.lineProcessor&&(l=u.lineProcessor(l,R.isFragment,R.processingContext));const j=(null===(a=R.processor)||void 0===a?void 0:a.attributeKeywordName)??"attribute",c=R.isFragment&&null!==(D=R.processor)&&void 0!==D&&D.varyingFragmentKeywordName?null===(U=R.processor)||void 0===U?void 0:U.varyingFragmentKeywordName:!R.isFragment&&null!==(F=R.processor)&&void 0!==F&&F.varyingVertexKeywordName?null===(w=R.processor)||void 0===w?void 0:w.varyingVertexKeywordName:"varying";if(!R.isFragment&&u.attributeProcessor&&this.line.startsWith(j))l=u.attributeProcessor(this.line,h,R.processingContext);else if(u.varyingProcessor&&(null!==(mh=u.varyingCheck)&&void 0!==mh&&mh.call(u,this.line,R.isFragment)||!u.varyingCheck&&this.line.startsWith(c)))l=u.varyingProcessor(this.line,R.isFragment,h,R.processingContext);else if(u.uniformProcessor&&u.uniformRegexp&&u.uniformRegexp.test(this.line))R.lookForClosingBracketForUniformBuffer||(l=u.uniformProcessor(this.line,R.isFragment,h,R.processingContext));else if(u.uniformBufferProcessor&&u.uniformBufferRegexp&&u.uniformBufferRegexp.test(this.line))R.lookForClosingBracketForUniformBuffer||(l=u.uniformBufferProcessor(this.line,R.isFragment,R.processingContext),R.lookForClosingBracketForUniformBuffer=!0);else if(u.textureProcessor&&u.textureRegexp&&u.textureRegexp.test(this.line))l=u.textureProcessor(this.line,R.isFragment,h,R.processingContext);else if((u.uniformProcessor||u.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!R.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?u.uniformProcessor&&(l=u.uniformProcessor(this.line,R.isFragment,h,R.processingContext)):u.uniformBufferProcessor&&(l=u.uniformBufferProcessor(this.line,R.isFragment,R.processingContext),R.lookForClosingBracketForUniformBuffer=!0)}R.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(R.lookForClosingBracketForUniformBuffer=!1,u.endOfUniformBufferProcessor&&(l=u.endOfUniformBufferProcessor(this.line,R.isFragment,R.processingContext)))}j+=l+"\n"}for(const u of this.children)j+=u.process(h,R,l);return this.additionalDefineKey&&(h[this.additionalDefineKey]=this.additionalDefineValue||"true",l[this.additionalDefineKey]=h[this.additionalDefineKey]),j}}class a{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(h){this._lines.length=0;for(const R of h){if(!R||"\r"===R)continue;if("#"===R[0]){this._lines.push(R);continue}const h=R.trim();if(!h)continue;if(h.startsWith("//")){this._lines.push(R);continue}const l=h.indexOf(";");if(-1===l)this._lines.push(h);else if(l===h.length-1)h.length>1&&this._lines.push(h);else{const h=R.split(";");for(let R=0;R<h.length;R++){let l=h[R];l&&(l=l.trim(),l&&this._lines.push(l+(R!==h.length-1?";":"")))}}}}}class D extends j{process(h,R,l){for(let j=0;j<this.children.length;j++){const a=this.children[j];if(a.isValid(h))return a.process(h,R,l)}return""}}class U extends j{isValid(h){return this.testExpression.isTrue(h)}}class F{isTrue(h){return!0}static postfixToInfix(h){const R=[];for(const l of h)if(void 0===F._OperatorPriority[l])R.push(l);else{const h=R[R.length-1],j=R[R.length-2];R.length-=2,R.push(`(${j}${l}${h})`)}return R[R.length-1]}static infixToPostfix(h){const R=F._InfixToPostfixCache.get(h);if(R)return R.accessTime=Date.now(),R.result;if(!h.includes("&&")&&!h.includes("||")&&!h.includes(")")&&!h.includes("("))return[h];const l=[];let j=-1;const a=()=>{u=u.trim(),""!==u&&(l.push(u),u="")},D=h=>{j<F._Stack.length-1&&(F._Stack[++j]=h)},U=()=>F._Stack[j],w=()=>-1===j?"!!INVALID EXPRESSION!!":F._Stack[j--];let mh=0,u="";for(;mh<h.length;){const R=h.charAt(mh),c=mh<h.length-1?h.substring(mh,2+mh):"";if("("===R)u="",D(R);else if(")"===R){for(a();-1!==j&&"("!==U();)l.push(w());w()}else if(F._OperatorPriority[c]>1){for(a();-1!==j&&F._OperatorPriority[U()]>=F._OperatorPriority[c];)l.push(w());D(c),mh++}else u+=R;mh++}for(a();-1!==j;)"("===U()?w():l.push(w());return F._InfixToPostfixCache.size>=F.InfixToPostfixCacheLimitSize&&F.ClearCache(),F._InfixToPostfixCache.set(h,{result:l,accessTime:Date.now()}),l}static ClearCache(){const h=Array.from(F._InfixToPostfixCache.entries()).sort(((h,R)=>h[1].accessTime-R[1].accessTime));for(let R=0;R<F.InfixToPostfixCacheCleanupSize;R++)F._InfixToPostfixCache.delete(h[R][0])}}F.InfixToPostfixCacheLimitSize=5e4,F.InfixToPostfixCacheCleanupSize=25e3,F._InfixToPostfixCache=new Map,F._OperatorPriority={")":0,"(":1,"||":2,"&&":3},F._Stack=["","","","","","","","","","","","","","","","","","","",""];class w extends F{constructor(h){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=h,this.not=R}isTrue(h){let R=void 0!==h[this.define];return this.not&&(R=!R),R}}class mh extends F{isTrue(h){return this.leftOperand.isTrue(h)||this.rightOperand.isTrue(h)}}class u extends F{isTrue(h){return this.leftOperand.isTrue(h)&&this.rightOperand.isTrue(h)}}class c extends F{constructor(h,R,l){super(),this.define=h,this.operand=R,this.testValue=l}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(h){let R=!1;const l=parseInt(void 0!=h[this.define]?h[this.define]:this.define),j=parseInt(void 0!=h[this.testValue]?h[this.testValue]:this.testValue);if(isNaN(l)||isNaN(j))return!1;switch(this.operand){case">":R=l>j;break;case"<":R=l<j;break;case"<=":R=l<=j;break;case">=":R=l>=j;break;case"==":R=l===j;break;case"!=":R=l!==j}return R}}var J=l(12733),q=l(12787);const Q=/defined\s*?\((.+?)\)/g,Y=/defined\s*?\[(.+?)\]/g,s=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,t=/__decl__/,f=/light\{X\}.(\w*)/g,T=/\{X\}/g,E=[],x=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function G(h){h.processor&&h.processor.initializeShaders&&h.processor.initializeShaders(h.processingContext)}function p(h,R,l,j){var a;null!==(a=R.processor)&&void 0!==a&&a.preProcessShaderCode&&(h=R.processor.preProcessShaderCode(h,R.isFragment)),r(h,R,(h=>{R.processCodeAfterIncludes&&(h=R.processCodeAfterIncludes(R.isFragment?"fragment":"vertex",h,R.defines));const a=function(h,R,l){let j=function(h,R){var l;if(null!==(l=R.processor)&&void 0!==l&&l.noPrecision)return h;const j=R.shouldUseHighPrecisionShader;-1===h.indexOf("precision highp float")?h=j?"precision highp float;\n"+h:"precision mediump float;\n"+h:j||(h=h.replace("precision highp float","precision mediump float"));return h}(h,R);if(!R.processor)return j;if(0===R.processor.shaderLanguage&&-1!==j.indexOf("#version 3")&&(j=j.replace("#version 300 es",""),!R.processor.parseGLES3))return j;const a=R.defines,D=n(R,l);R.processor.preProcessor&&(j=R.processor.preProcessor(j,a,D,R.isFragment,R.processingContext));const U={};j=L(j,D,R,U),R.processor.postProcessor&&(j=R.processor.postProcessor(j,a,R.isFragment,R.processingContext,l?{drawBuffersExtensionDisabled:!l.getCaps().drawBuffersExtension}:{},D,U));null!==l&&void 0!==l&&l._features.needShaderCodeInlining&&(j=l.inlineShaderCode(j));return j}(h,R,j);l(a,h)}))}function O(h,R,l){return l.processor&&l.processor.finalizeShaders?l.processor.finalizeShaders(h,R,l.processingContext):{vertexCode:h,fragmentCode:R}}function y(h){const R=/defined\((.+)\)/.exec(h);if(R&&R.length)return new w(R[1].trim(),"!"===h[0]);const l=["==","!=",">=","<=","<",">"];let j="",a=0;for(j of l)if(a=h.indexOf(j),a>-1)break;if(-1===a)return new w(h);const D=h.substring(0,a).trim(),U=h.substring(a+j.length).trim();return new c(D,j,U)}function v(h,R){const l=new U,j=h.substring(0,R);let a=h.substring(R);return a=a.substring(0,(a.indexOf("//")+1||a.length+1)-1).trim(),l.testExpression="#ifdef"===j?new w(a):"#ifndef"===j?new w(a,!0):function(h){h=h.replace(Q,"defined[$1]");const R=F.infixToPostfix(h),l=[];for(const a of R)if("||"!==a&&"&&"!==a)l.push(a);else if(l.length>=2){let h=l[l.length-1],R=l[l.length-2];l.length-=2;const j="&&"==a?new u:new mh;"string"===typeof h&&(h=h.replace(Y,"defined($1)")),"string"===typeof R&&(R=R.replace(Y,"defined($1)")),j.leftOperand="string"===typeof R?y(R):R,j.rightOperand="string"===typeof h?y(h):h,l.push(j)}let j=l[l.length-1];return"string"===typeof j&&(j=j.replace(Y,"defined($1)")),"string"===typeof j?y(j):j}(a),l}function b(h,R,l,a){let D=h.currentLine;for(;I(h,l,a);){D=h.currentLine;const U=D.substring(0,5).toLowerCase();if("#else"===U){const l=new j;return R.children.push(l),void I(h,l,a)}if("#elif"===U){const h=v(D,5);R.children.push(h),l=h}}}function I(h,R,l){for(;h.canRead;){h.lineIndex++;const a=h.currentLine;if(a.indexOf("#")>=0){const j=x.exec(a);if(j&&j.length){switch(j[0]){case"#ifdef":{const j=new D;R.children.push(j);const U=v(a,6);j.children.push(U),b(h,j,U,l);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const j=new D;R.children.push(j);const U=v(a,7);j.children.push(U),b(h,j,U,l);break}case"#if":{const j=new D,U=v(a,3);R.children.push(j),j.children.push(U),b(h,j,U,l);break}}continue}}const U=new j;if(U.line=a,R.children.push(U),"#"===a[0]&&"d"===a[1]){const h=a.replace(";","").split(" ");U.additionalDefineKey=h[1],3===h.length&&(U.additionalDefineValue=h[2])}}return!1}function L(h,R,l,D){const U=new j,F=new a;return F.lineIndex=-1,F.lines=h.split("\n"),I(F,U,D),U.process(R,l,D)}function n(h,R){var l;const j=h.defines,a={};for(const D of j){const h=D.replace("#define","").replace(";","").trim().split(" ");a[h[0]]=h.length>1?h[1]:""}return 0===(null===(l=h.processor)||void 0===l?void 0:l.shaderLanguage)&&(a.GL_ES="true"),a.__VERSION__=h.version,a[h.platformName]="true",(0,q.h)(a,null===R||void 0===R?void 0:R.isNDCHalfZRange,null===R||void 0===R?void 0:R.UF,null===R||void 0===R?void 0:R.useExactSrgbConversions),a}function r(h,R,l){let j;for(E.length=0;null!==(j=s.exec(h));)E.push(j);let a=String(h),D=[h],U=!1;for(const F of E){let h=F[1];if(-1!==h.indexOf("__decl__")&&(h=h.replace(t,""),R.supportsUniformBuffers&&(h=h.replace("Vertex","Ubo").replace("Fragment","Ubo")),h+="Declaration"),!R.includesShadersStore[h]){const j=R.shadersRepository+"ShadersInclude/"+h+".fx";return void P.loadFile(j,(j=>{R.includesShadersStore[h]=j,r(D.join(""),R,l)}))}{let l=R.includesShadersStore[h];if(F[2]){const h=F[3].split(",");for(let R=0;R<h.length;R+=2){const j=new RegExp(h[R],"g"),a=h[R+1];l=l.replace(j,a)}}if(F[4]){const h=F[5];if(-1!==h.indexOf("..")){const j=h.split(".."),a=parseInt(j[0]);let D=parseInt(j[1]),U=l.slice(0);l="",isNaN(D)&&(D=R.indexParameters[j[1]]);for(let h=a;h<D;h++)R.supportsUniformBuffers||(U=U.replace(f,((h,R)=>R+"{X}"))),l+=U.replace(T,h.toString())+"\n"}else R.supportsUniformBuffers||(l=l.replace(f,((h,R)=>R+"{X}"))),l=l.replace(T,h)}const j=[];for(const h of D){const R=h.split(F[0]);for(let h=0;h<R.length-1;h++)j.push(R[h]),j.push(l);j.push(R[R.length-1])}D=j,U=U||l.indexOf("#include<")>=0||l.indexOf("#include <")>=0}}E.length=0,a=D.join(""),U?r(a.toString(),R,l):l(a)}const P={loadFile:(h,R,l,j,a,D)=>{throw(0,J.b)("FileTools")}}},12787:(h,R,l)=>{l.d(R,{b:()=>a,e:()=>D,h:()=>F,j:()=>U,n:()=>w});var j=l(12733);l(12705);const a={};function D(h,R){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(R?R+"\n":"")+h}function U(h,R,l,D,U,F,w){const mh=w||a.loadFile;if(mh){return mh(h,R,l,D,U,F)}throw(0,j.b)("FileTools")}function F(h,R,l,j){if(h)return R?h.IS_NDC_HALF_ZRANGE="":delete h.IS_NDC_HALF_ZRANGE,l?h.USE_REVERSE_DEPTHBUFFER="":delete h.USE_REVERSE_DEPTHBUFFER,void(j?h.USE_EXACT_SRGB_CONVERSIONS="":delete h.USE_EXACT_SRGB_CONVERSIONS);{let h="";return R&&(h+="#define IS_NDC_HALF_ZRANGE"),l&&(h&&(h+="\n"),h+="#define USE_REVERSE_DEPTHBUFFER"),j&&(h&&(h+="\n"),h+="#define USE_EXACT_SRGB_CONVERSIONS"),h}}function w(h,R){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],j=arguments.length>3?arguments[3]:void 0;switch(h){case 3:{const h=(ArrayBuffer,new Int8Array(R));return j&&h.set(new Int8Array(j)),h}case 0:{const h=(ArrayBuffer,new Uint8Array(R));return j&&h.set(new Uint8Array(j)),h}case 4:{const h=R instanceof ArrayBuffer?new Int16Array(R):new Int16Array(l?R/2:R);return j&&h.set(new Int16Array(j)),h}case 5:case 8:case 9:case 10:case 2:{const h=R instanceof ArrayBuffer?new Uint16Array(R):new Uint16Array(l?R/2:R);return j&&h.set(new Uint16Array(j)),h}case 6:{const h=R instanceof ArrayBuffer?new Int32Array(R):new Int32Array(l?R/4:R);return j&&h.set(new Int32Array(j)),h}case 7:case 11:case 12:case 13:case 14:case 15:{const h=R instanceof ArrayBuffer?new Uint32Array(R):new Uint32Array(l?R/4:R);return j&&h.set(new Uint32Array(j)),h}case 1:{const h=R instanceof ArrayBuffer?new Float32Array(R):new Float32Array(l?R/4:R);return j&&h.set(new Float32Array(j)),h}}const a=(ArrayBuffer,new Uint8Array(R));return j&&a.set(new Uint8Array(j)),a}},12808:(h,R,l)=>{l.d(R,{d:()=>j});class j{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.ShadersRepository:j.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.ShadersStore:j.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.IncludesShadersStore:j.IncludesShadersStoreWGSL}}j.ShadersRepository="src/Shaders/",j.ShadersStore={},j.IncludesShadersStore={},j.ShadersRepositoryWGSL="src/ShadersWGSL/",j.ShadersStoreWGSL={},j.IncludesShadersStoreWGSL={}},12824:(h,R,l)=>{l.d(R,{b:()=>J,e:()=>T,h:()=>Q,k:()=>q,m:()=>Y,o:()=>f,p:()=>c,s:()=>mh,v:()=>u,x:()=>w,y:()=>F});class j{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.sR._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(h){h&&this.program&&h(this.program)}setEngine(h){this.sR=h}_fillEffectInformation(h,R,l,j,a,D,U,F){const w=this.sR;if(w.supportsUniformBuffers)for(const u in R)h.bindUniformBlock(u,R[u]);let mh;for(this.sR.getUniforms(this,l).forEach(((h,R)=>{j[l[R]]=h})),this._uniforms=j,mh=0;mh<a.length;mh++){null==h.getUniform(a[mh])&&(a.splice(mh,1),mh--)}a.forEach(((h,R)=>{D[h]=R}));for(const u of w.getAttributes(this,U))F.push(u)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(h,R){const l=this._valueCache[h],j=R.updateFlag;return(void 0===l||l!==j)&&(this._valueCache[h]=j,!0)}_cacheFloat2(h,R,l){let j=this._valueCache[h];if(!j||2!==j.length)return j=[R,l],this._valueCache[h]=j,!0;let a=!1;return j[0]!==R&&(j[0]=R,a=!0),j[1]!==l&&(j[1]=l,a=!0),a}_cacheFloat3(h,R,l,j){let a=this._valueCache[h];if(!a||3!==a.length)return a=[R,l,j],this._valueCache[h]=a,!0;let D=!1;return a[0]!==R&&(a[0]=R,D=!0),a[1]!==l&&(a[1]=l,D=!0),a[2]!==j&&(a[2]=j,D=!0),D}_cacheFloat4(h,R,l,j,a){let D=this._valueCache[h];if(!D||4!==D.length)return D=[R,l,j,a],this._valueCache[h]=D,!0;let U=!1;return D[0]!==R&&(D[0]=R,U=!0),D[1]!==l&&(D[1]=l,U=!0),D[2]!==j&&(D[2]=j,U=!0),D[3]!==a&&(D[3]=a,U=!0),U}setInt(h,R){const l=this._valueCache[h];void 0!==l&&l===R||this.sR.setInt(this._uniforms[h],R)&&(this._valueCache[h]=R)}setInt2(h,R,l){this._cacheFloat2(h,R,l)&&(this.sR.setInt2(this._uniforms[h],R,l)||(this._valueCache[h]=null))}setInt3(h,R,l,j){this._cacheFloat3(h,R,l,j)&&(this.sR.setInt3(this._uniforms[h],R,l,j)||(this._valueCache[h]=null))}setInt4(h,R,l,j,a){this._cacheFloat4(h,R,l,j,a)&&(this.sR.setInt4(this._uniforms[h],R,l,j,a)||(this._valueCache[h]=null))}setIntArray(h,R){this._valueCache[h]=null,this.sR.setIntArray(this._uniforms[h],R)}setIntArray2(h,R){this._valueCache[h]=null,this.sR.setIntArray2(this._uniforms[h],R)}setIntArray3(h,R){this._valueCache[h]=null,this.sR.setIntArray3(this._uniforms[h],R)}setIntArray4(h,R){this._valueCache[h]=null,this.sR.setIntArray4(this._uniforms[h],R)}setUInt(h,R){const l=this._valueCache[h];void 0!==l&&l===R||this.sR.setUInt(this._uniforms[h],R)&&(this._valueCache[h]=R)}setUInt2(h,R,l){this._cacheFloat2(h,R,l)&&(this.sR.setUInt2(this._uniforms[h],R,l)||(this._valueCache[h]=null))}setUInt3(h,R,l,j){this._cacheFloat3(h,R,l,j)&&(this.sR.setUInt3(this._uniforms[h],R,l,j)||(this._valueCache[h]=null))}setUInt4(h,R,l,j,a){this._cacheFloat4(h,R,l,j,a)&&(this.sR.setUInt4(this._uniforms[h],R,l,j,a)||(this._valueCache[h]=null))}setUIntArray(h,R){this._valueCache[h]=null,this.sR.setUIntArray(this._uniforms[h],R)}setUIntArray2(h,R){this._valueCache[h]=null,this.sR.setUIntArray2(this._uniforms[h],R)}setUIntArray3(h,R){this._valueCache[h]=null,this.sR.setUIntArray3(this._uniforms[h],R)}setUIntArray4(h,R){this._valueCache[h]=null,this.sR.setUIntArray4(this._uniforms[h],R)}setArray(h,R){this._valueCache[h]=null,this.sR.setArray(this._uniforms[h],R)}setArray2(h,R){this._valueCache[h]=null,this.sR.setArray2(this._uniforms[h],R)}setArray3(h,R){this._valueCache[h]=null,this.sR.setArray3(this._uniforms[h],R)}setArray4(h,R){this._valueCache[h]=null,this.sR.setArray4(this._uniforms[h],R)}setMatrices(h,R){R&&(this._valueCache[h]=null,this.sR.setMatrices(this._uniforms[h],R))}setMatrix(h,R){this._cacheMatrix(h,R)&&(this.sR.setMatrices(this._uniforms[h],R.sF())||(this._valueCache[h]=null))}setMatrix3x3(h,R){this._valueCache[h]=null,this.sR.setMatrix3x3(this._uniforms[h],R)}setMatrix2x2(h,R){this._valueCache[h]=null,this.sR.setMatrix2x2(this._uniforms[h],R)}setFloat(h,R){const l=this._valueCache[h];void 0!==l&&l===R||this.sR.setFloat(this._uniforms[h],R)&&(this._valueCache[h]=R)}setVector2(h,R){this._cacheFloat2(h,R.x,R.y)&&(this.sR.setFloat2(this._uniforms[h],R.x,R.y)||(this._valueCache[h]=null))}setFloat2(h,R,l){this._cacheFloat2(h,R,l)&&(this.sR.setFloat2(this._uniforms[h],R,l)||(this._valueCache[h]=null))}setVector3(h,R){this._cacheFloat3(h,R.x,R.y,R.z)&&(this.sR.setFloat3(this._uniforms[h],R.x,R.y,R.z)||(this._valueCache[h]=null))}setFloat3(h,R,l,j){this._cacheFloat3(h,R,l,j)&&(this.sR.setFloat3(this._uniforms[h],R,l,j)||(this._valueCache[h]=null))}setVector4(h,R){this._cacheFloat4(h,R.x,R.y,R.z,R.w)&&(this.sR.setFloat4(this._uniforms[h],R.x,R.y,R.z,R.w)||(this._valueCache[h]=null))}setQuaternion(h,R){this._cacheFloat4(h,R.x,R.y,R.z,R.w)&&(this.sR.setFloat4(this._uniforms[h],R.x,R.y,R.z,R.w)||(this._valueCache[h]=null))}setFloat4(h,R,l,j,a){this._cacheFloat4(h,R,l,j,a)&&(this.sR.setFloat4(this._uniforms[h],R,l,j,a)||(this._valueCache[h]=null))}setColor3(h,R){this._cacheFloat3(h,R.r,R.g,R.b)&&(this.sR.setFloat3(this._uniforms[h],R.r,R.g,R.b)||(this._valueCache[h]=null))}setColor4(h,R,l){this._cacheFloat4(h,R.r,R.g,R.b,l)&&(this.sR.setFloat4(this._uniforms[h],R.r,R.g,R.b,l)||(this._valueCache[h]=null))}setDirectColor4(h,R){this._cacheFloat4(h,R.r,R.g,R.b,R.a)&&(this.sR.setFloat4(this._uniforms[h],R.r,R.g,R.b,R.a)||(this._valueCache[h]=null))}_getVertexShaderCode(){return this.vertexShader?this.sR._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.sR._getShaderSource(this.fragmentShader):null}}var a=l(12787);const D=new WeakMap,U={_webGLVersion:2,cachedPipelines:{}};function F(h){let R=D.get(h);if(!R){if(!h)return U;R={_webGLVersion:h.TEXTURE_BINDING_3D?2:1,_context:h,parallelShaderCompile:h.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},D.set(h,R)}return R}function w(h){D.delete(h)}function mh(h,R,l,j,a,D){const U=F(j);D||(D=U._createShaderProgramInjection??J);return D(h,t(R,"vertex",j,U._contextWasLost),t(l,"fragment",j,U._contextWasLost),j,a,U.validateShaderPrograms)}function u(h,R,l,j,a){let D=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,U=arguments.length>6?arguments[6]:void 0;const w=F(a);U||(U=w._createShaderProgramInjection??J);const mh=w._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return U(h,s(R,"vertex",j,mh,a,w._contextWasLost),s(l,"fragment",j,mh,a,w._contextWasLost),a,D,w.validateShaderPrograms)}function c(h,R){const l=new j,a=F(h);return a.parallelShaderCompile&&!a.disableParallelShaderCompile&&(l.isParallelCompiled=!0),l.context=a._context,l}function J(h,R,l,j){let a=arguments.length>5?arguments[5]:void 0;const D=j.createProgram();if(h.program=D,!D)throw new Error("Unable to create program");return j.attachShader(D,R),j.attachShader(D,l),j.linkProgram(D),h.context=j,h.vertexShader=R,h.fragmentShader=l,h.isParallelCompiled||Q(h,j,a),D}function q(h,R,l){const j=h;if(j._isDisposed)return!1;const a=F(R);return!!(a&&a.parallelShaderCompile&&a.parallelShaderCompile.COMPLETION_STATUS_KHR&&j.program&&R.getProgramParameter(j.program,a.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(Q(j,R,l),!0)}function Q(h,R,l){const j=h.context,a=h.vertexShader,D=h.fragmentShader,U=h.program;if(!j.getProgramParameter(U,j.LINK_STATUS)){if(!R.getShaderParameter(a,R.COMPILE_STATUS)){const l=R.getShaderInfoLog(a);if(l)throw h.vertexCompilationError=l,new Error("VERTEX SHADER "+l)}if(!R.getShaderParameter(D,R.COMPILE_STATUS)){const l=R.getShaderInfoLog(D);if(l)throw h.fragmentCompilationError=l,new Error("FRAGMENT SHADER "+l)}const l=j.getProgramInfoLog(U);if(l)throw h.programLinkError=l,new Error(l)}if(l){j.validateProgram(U);if(!j.getProgramParameter(U,j.VALIDATE_STATUS)){const R=j.getProgramInfoLog(U);if(R)throw h.programValidationError=R,new Error(R)}}j.deleteShader(a),j.deleteShader(D),h.vertexShader=void 0,h.fragmentShader=void 0,h.onCompiled&&(h.onCompiled(),h.onCompiled=void 0)}function Y(h,R,l,j,a,D,U,w,c){let J=arguments.length>10?arguments[10]:void 0,q=arguments.length>11?arguments[11]:void 0,Q=arguments.length>12?arguments[12]:void 0;const Y=F(h.context);q||(q=Y.createRawShaderProgramInjection??mh),Q||(Q=Y.createShaderProgramInjection??u);const s=h;s.program=j?q(s,R,l,s.context,c):Q(s,R,l,w,s.context,c),s.program.__SPECTOR_rebuildProgram=U,J()}function s(h,R,l,j,D,U){return t((0,a.e)(h,l,j),R,D,U)}function t(h,R,l,j){const a=l.createShader("vertex"===R?l.VERTEX_SHADER:l.FRAGMENT_SHADER);if(!a){let h=l.NO_ERROR,a=l.NO_ERROR;for(;(a=l.getError())!==l.NO_ERROR;)h=a;throw new Error(`Something went wrong while creating a gl ${R} shader object. gl error=${h}, gl isContextLost=${l.isContextLost()}, _contextWasLost=${j}`)}return l.shaderSource(a,h),l.compileShader(a),a}function f(h,R){R.useProgram(h)}function T(h,R){const l=h;if(!l.isParallelCompiled)return void R(h);const j=l.onCompiled;l.onCompiled=()=>{null===j||void 0===j||j(),R(h)}}},12816:(h,R,l)=>{l.d(R,{d:()=>c,g:()=>q,i:()=>mh,k:()=>u});var j=l(12705),a=l(12824),D=l(12808),U=l(12711),F=l(12781),w=l(12787);function mh(h,R){return(0,a.y)(R).cachedPipelines[h]}function u(h){const R=h._name,l=h.context;if(R&&l){const h=(0,a.y)(l),j=h.cachedPipelines[R];null===j||void 0===j||j.dispose(),delete h.cachedPipelines[R]}}function c(h,R,l,a,D,U,w){let mh,u;const c=(0,j.n)()?null===U||void 0===U?void 0:U.getHostDocument():null;mh="string"===typeof R?R:R.vertexSource?"source:"+R.vertexSource:R.vertexElement?(null===c||void 0===c?void 0:c.getElementById(R.vertexElement))||R.vertexElement:R.vertex||R,u="string"===typeof R?R:R.fragmentSource?"source:"+R.fragmentSource:R.fragmentElement?(null===c||void 0===c?void 0:c.getElementById(R.fragmentElement))||R.fragmentElement:R.fragment||R;const q=[void 0,void 0],Q=()=>{if(q[0]&&q[1]){h.isFragment=!0;const[j,mh]=q;(0,F.m)(mh,h,((U,mh)=>{w&&(w._fragmentSourceCodeBeforeMigration=mh),l&&(U=l("fragment",U));const u=(0,F.c)(j,U,h);h=null;const c=function(h,R,l,j){if(l){return{vertexSourceCode:(1===j?"//":"")+"#define SHADER_NAME vertex:"+(l.vertexElement||l.vertex||l.spectorName||l)+"\n"+h,fragmentSourceCode:(1===j?"//":"")+"#define SHADER_NAME fragment:"+(l.fragmentElement||l.fragment||l.spectorName||l)+"\n"+R}}return{vertexSourceCode:h,fragmentSourceCode:R}}(u.vertexCode,u.fragmentCode,R,D);null===a||void 0===a||a(c.vertexSourceCode,c.fragmentSourceCode)}),U)}};J(mh,"Vertex","",(R=>{(0,F.g)(h),(0,F.m)(R,h,((h,j)=>{w&&(w._rawVertexSourceCode=R,w._vertexSourceCodeBeforeMigration=j),l&&(h=l("vertex",h)),q[0]=h,Q()}),U)}),D),J(u,"Fragment","Pixel",(h=>{w&&(w._rawFragmentSourceCode=h),q[1]=h,Q()}),D)}function J(h,R,l,a,U,F){if("undefined"!==typeof HTMLElement&&h instanceof HTMLElement){return void a((0,j.e)(h))}if("source:"===h.substring(0,7))return void a(h.substring(7));if("base64:"===h.substring(0,7)){return void a(window.atob(h.substring(7)))}const mh=D.d.GetShadersStore(U);if(mh[h+R+"Shader"])return void a(mh[h+R+"Shader"]);if(l&&mh[h+l+"Shader"])return void a(mh[h+l+"Shader"]);let u;if(u="."===h[0]||"/"===h[0]||h.indexOf("http")>-1?h:D.d.GetShadersRepository(U)+h,!(F=F||w.j))throw new Error("loadFileInjection is not defined");F(u+"."+R.toLowerCase()+".fx",a)}const q=(h,R,l,j)=>{try{const D=h.context?(0,a.y)(h.context):null;D&&(D.disableParallelShaderCompile=h.disableParallelCompilation);const U=h.existingPipelineContext||R(h.shaderProcessingContext);return U._name=h.name,h.name&&D&&(D.cachedPipelines[h.name]=U),l(U,h.vertex,h.fragment,!!h.createAsRaw,"","",h.rebuildRebind,h.defines,h.transformFeedbackVaryings,"",(()=>{j(U,(()=>{var R;null===(R=h.onRenderingStateCompiled)||void 0===R||R.call(h,U)}))})),U}catch(D){throw U.c.Error("Error compiling effect"),D}}},12799:(h,R,l)=>{l.r(R),l.d(R,{Effect:()=>w});var j=l(12696),a=l(12711),D=l(12808),U=l(12816),F=l(12790);class w{static get ShadersRepository(){return D.d.ShadersRepository}static set ShadersRepository(h){D.d.ShadersRepository=h}get mh(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new j.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(h,R,l){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,D=arguments.length>4?arguments[4]:void 0,F=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,mh=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,J=arguments.length>9?arguments[9]:void 0,q=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",Q=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,Y=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new j.d,this.onErrorObservable=new j.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=h,this._key=q;const s=this._key.replace(/\r/g,"").replace(/\n/g,"|");let t;if(R.attributes){const h=R;if(this._engine=l,this._attributesNames=h.attributes,this._uniformsNames=h.uniformsNames.concat(h.samplers),this._samplerList=h.samplers.slice(),this.defines=h.defines,this.onError=h.onError,this.onCompiled=h.onCompiled,this._fallbacks=h.fallbacks,this._indexParameters=h.indexParameters,this._transformFeedbackVaryings=h.transformFeedbackVaryings||null,this._multiTarget=!!h.multiTarget,this._shaderLanguage=h.shaderLanguage??0,this._disableParallelShaderCompilation=!!h.disableParallelShaderCompilation,h.uniformBuffersNames){this._uniformBuffersNamesList=h.uniformBuffersNames.slice();for(let R=0;R<h.uniformBuffersNames.length;R++)this._uniformBuffersNames[h.uniformBuffersNames[R]]=R}this._processFinalCode=h.processFinalCode??null,this._processCodeAfterIncludes=h.processCodeAfterIncludes??void 0,Y=h.extraInitializationsAsync,t=h.existingPipelineContext}else this._engine=D,this.defines=null==F?"":F,this._uniformsNames=l.concat(a),this._samplerList=a?a.slice():[],this._attributesNames=R,this._uniformBuffersNamesList=[],this._shaderLanguage=Q,this.onError=c,this.onCompiled=u,this._indexParameters=J,this._fallbacks=mh;"WEBGL2"===this._engine.shaderPlatformName&&(t=(0,U.i)(s,this._engine._gl)??t),this._attributeLocationByName={},this.uniqueId=w._UniqueIdSeed++,t?(this._pipelineContext=t,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,Y),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.mh||this.dispose(!0)}))}async _processShaderCodeAsync(){let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,R=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,j=arguments.length>3?arguments[3]:void 0;j&&await j(),this._processingContext=l||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const a={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:h??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:D.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:D.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,UF:this._engine.UF,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,U.d)(a,this.name,this._processFinalCode,((h,l)=>{this._vertexSourceCode=h,this._fragmentSourceCode=l,this._prepareEffect(R)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.mh||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(h){return this._attributes[h]}getAttributeLocationByName(h){return this._attributeLocationByName[h]}getAttributesCount(){return this._attributes.length}getUniformIndex(h){return this._uniformsNames.indexOf(h)}getUniform(h){return this._uniforms[h]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((h=>{this.executeWhenCompiled(h)}))}executeWhenCompiled(h){this.isReady()?h(this):(this.onCompileObservable.add((R=>{h(R)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(h){(0,F.c)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(R=>{this._processCompilationErrors(R,h)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var h;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(h=this._pipelineContext)||void 0===h?void 0:h._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var h;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(h=this._pipelineContext)||void 0===h?void 0:h._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,UF:this._engine.UF,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(h,R,l,j){this._isReady=!1,this._vertexSourceCodeOverride=h,this._fragmentSourceCodeOverride=R,this.onError=(h,R)=>{j&&j(R)},this.onCompiled=()=>{var h,R;const j=this.getEngine().scenes;if(j)for(let l=0;l<j.length;l++)j[l].markAllMaterialsAsDirty(127);null===(h=(R=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===h||h.call(R,l)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(h){if(this._pipelineContext=h,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let R=0;R<this._attributesNames.length;R++){const h=this._attributesNames[R];this._attributeLocationByName[h]=this._attributes[R]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),w.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let h=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const R=this._pipelineContext;this._isReady=!1;try{const l=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),j=l?null:this.defines,a=l?this._vertexSourceCodeOverride:this._vertexSourceCode,D=l?this._fragmentSourceCodeOverride:this._fragmentSourceCode,F=this._engine;this._pipelineContext=(0,U.g)({existingPipelineContext:h?R:null,vertex:a,fragment:D,context:"WEBGL2"===F.shaderPlatformName||"WEBGL1"===F.shaderPlatformName?F._gl:void 0,rebuildRebind:(h,R,l,j)=>this._rebuildProgram(h,R,l,j),defines:j,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:l,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:l=>{R&&!h&&this._engine._deletePipelineContext(R),l&&this._onRenderingStateCompiled(l)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(R)}catch(l){this._processCompilationErrors(l,R)}}_getShaderCodeAndErrorLine(h,R,l){const j=l?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let a=null;if(R&&h){const D=R.match(j);if(D&&2===D.length){const R=parseInt(D[1]),j=h.split("\n",-1);j.length>=R&&(a=`Offending line [${R}] in ${l?"fragment":"vertex"} code: ${j[R-1]}`)}}return[h,a]}_processCompilationErrors(h){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=h.message;const l=this._attributesNames,j=this._fallbacks;if(a.c.Error("Unable to compile effect:"),a.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),a.c.Error(`Attributes: ${l.join(" ")}`),a.c.Error("Defines:\n"+this.defines),w.LogShaderCodeOnCompilationError){var D,U;let h=null,R=null,l=null;var F;if(null!==(D=this._pipelineContext)&&void 0!==D&&D._getVertexShaderCode()&&([l,h]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),l&&(a.c.Error("Vertex code:"),a.c.Error(l))),null!==(U=this._pipelineContext)&&void 0!==U&&U._getFragmentShaderCode())[l,R]=this._getShaderCodeAndErrorLine(null===(F=this._pipelineContext)||void 0===F?void 0:F._getFragmentShaderCode(),this._compilationError,!0),l&&(a.c.Error("Fragment code:"),a.c.Error(l));h&&a.c.Error(h),R&&a.c.Error(R)}a.c.Error("Error: "+this._compilationError);const mh=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};R&&(this._pipelineContext=R,this._isReady=!0,mh()),j?(this._pipelineContext=null,j.hasMoreFallbacks?(this._allFallbacksProcessed=!1,a.c.Error("Trying next fallback."),this.defines=j.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,mh(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,R||mh())}get isSupported(){return""===this._compilationError}_bindTexture(h,R){this._engine._bindTexture(this._samplers[h],R,h)}setTexture(h,R){this._engine.setTexture(this._samplers[h],this._uniforms[h],R,h)}setTextureArray(h,R){const l=h+"Ex";if(-1===this._samplerList.indexOf(l+"0")){const j=this._samplerList.indexOf(h);for(let h=1;h<R.length;h++){const R=l+(h-1).toString();this._samplerList.splice(j+h,0,R)}let a=0;for(const h of this._samplerList)this._samplers[h]=a,a+=1}this._engine.setTextureArray(this._samplers[h],this._uniforms[h],R,h)}bindUniformBuffer(h,R){const l=this._uniformBuffersNames[R];void 0===l||w._BaseCache[l]===h&&this._engine._features.useUBOBindingCache||(w._BaseCache[l]=h,this._engine.bindUniformBufferBase(h,l,R))}bindUniformBlock(h,R){this._engine.bindUniformBlock(this._pipelineContext,h,R)}setInt(h,R){return this._pipelineContext.setInt(h,R),this}setInt2(h,R,l){return this._pipelineContext.setInt2(h,R,l),this}setInt3(h,R,l,j){return this._pipelineContext.setInt3(h,R,l,j),this}setInt4(h,R,l,j,a){return this._pipelineContext.setInt4(h,R,l,j,a),this}setIntArray(h,R){return this._pipelineContext.setIntArray(h,R),this}setIntArray2(h,R){return this._pipelineContext.setIntArray2(h,R),this}setIntArray3(h,R){return this._pipelineContext.setIntArray3(h,R),this}setIntArray4(h,R){return this._pipelineContext.setIntArray4(h,R),this}setUInt(h,R){return this._pipelineContext.setUInt(h,R),this}setUInt2(h,R,l){return this._pipelineContext.setUInt2(h,R,l),this}setUInt3(h,R,l,j){return this._pipelineContext.setUInt3(h,R,l,j),this}setUInt4(h,R,l,j,a){return this._pipelineContext.setUInt4(h,R,l,j,a),this}setUIntArray(h,R){return this._pipelineContext.setUIntArray(h,R),this}setUIntArray2(h,R){return this._pipelineContext.setUIntArray2(h,R),this}setUIntArray3(h,R){return this._pipelineContext.setUIntArray3(h,R),this}setUIntArray4(h,R){return this._pipelineContext.setUIntArray4(h,R),this}setFloatArray(h,R){return this._pipelineContext.setArray(h,R),this}setFloatArray2(h,R){return this._pipelineContext.setArray2(h,R),this}setFloatArray3(h,R){return this._pipelineContext.setArray3(h,R),this}setFloatArray4(h,R){return this._pipelineContext.setArray4(h,R),this}setArray(h,R){return this._pipelineContext.setArray(h,R),this}setArray2(h,R){return this._pipelineContext.setArray2(h,R),this}setArray3(h,R){return this._pipelineContext.setArray3(h,R),this}setArray4(h,R){return this._pipelineContext.setArray4(h,R),this}setMatrices(h,R){return this._pipelineContext.setMatrices(h,R),this}setMatrix(h,R){return this._pipelineContext.setMatrix(h,R),this}setMatrix3x3(h,R){return this._pipelineContext.setMatrix3x3(h,R),this}setMatrix2x2(h,R){return this._pipelineContext.setMatrix2x2(h,R),this}setFloat(h,R){return this._pipelineContext.setFloat(h,R),this}setBool(h,R){return this._pipelineContext.setInt(h,R?1:0),this}setVector2(h,R){return this._pipelineContext.setVector2(h,R),this}setFloat2(h,R,l){return this._pipelineContext.setFloat2(h,R,l),this}setVector3(h,R){return this._pipelineContext.setVector3(h,R),this}setFloat3(h,R,l,j){return this._pipelineContext.setFloat3(h,R,l,j),this}setVector4(h,R){return this._pipelineContext.setVector4(h,R),this}setQuaternion(h,R){return this._pipelineContext.setQuaternion(h,R),this}setFloat4(h,R,l,j,a){return this._pipelineContext.setFloat4(h,R,l,j,a),this}setColor3(h,R){return this._pipelineContext.setColor3(h,R),this}setColor4(h,R,l){return this._pipelineContext.setColor4(h,R,l),this}setDirectColor4(h,R){return this._pipelineContext.setDirectColor4(h,R),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(w.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,U.k)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(h,R,l){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;R&&(D.d.GetShadersStore(j)[`${h}PixelShader`]=R),l&&(D.d.GetShadersStore(j)[`${h}VertexShader`]=l)}static ResetCache(){w._BaseCache={}}}w.LogShaderCodeOnCompilationError=!0,w.PersistentMode=!1,w.AutomaticallyClearCodeCache=!1,w._UniqueIdSeed=0,w._BaseCache={},w.ShadersStore=D.d.ShadersStore,w.IncludesShadersStore=D.d.IncludesShadersStore},12733:(h,R,l)=>{l.d(R,{b:()=>a});const j={};function a(h){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!j[h])return j[h]=!0,`${h} needs to be imported before as it contains a side-effect required by your code.`}},12705:(h,R,l)=>{function j(){return"undefined"!==typeof window}function a(){return"undefined"!==typeof navigator}function D(){return"undefined"!==typeof document}function U(h){let R="",l=h.firstChild;for(;l;)3===l.nodeType&&(R+=l.textContent),l=l.nextSibling;return R}l.d(R,{e:()=>U,h:()=>D,l:()=>a,n:()=>j})},12711:(h,R,l)=>{l.d(R,{c:()=>j});class j{static _CheckLimit(h,R){let l=j._LogLimitOutputs[h];return l?l.current++:(l={limit:R,current:1},j._LogLimitOutputs[h]=l),l.current<=l.limit}static _GenerateLimitMessage(h){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const l=j._LogLimitOutputs[h];if(!l||!j.MessageLimitReached)return;const a=this._Levels[R];l.current===l.limit&&j[a.name](j.MessageLimitReached.replace(/%LIMIT%/g,""+l.limit).replace(/%TYPE%/g,a.name??""))}static _AddLogEntry(h){j._LogCache=h+j._LogCache,j.OnNewCacheEntry&&j.OnNewCacheEntry(h)}static _FormatMessage(h){const R=h=>h<10?"0"+h:""+h,l=new Date;return"["+R(l.getHours())+":"+R(l.getMinutes())+":"+R(l.getSeconds())+"]: "+h}static _LogDisabled(h,R){}static _LogEnabled(){let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,R=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;const a=Array.isArray(R)?R[0]:R;if(void 0!==l&&!j._CheckLimit(a,l))return;const D=j._FormatMessage(a),U=this._Levels[h],F=Array.isArray(R)?R.slice(1):[];U.logFunc&&U.logFunc("BJS - "+D,...F);const w=`<div style='color:${U.color}'>${D}</div><br>`;j._AddLogEntry(w),j._GenerateLimitMessage(a,h)}static get LogCache(){return j._LogCache}static ClearLogCache(){j._LogCache="",j._LogLimitOutputs={},j.errorsCount=0}static set LogLevels(h){j.Log=j._LogDisabled,j.Warn=j._LogDisabled,j.Error=j._LogDisabled;const R=[j.MessageLogLevel,j.WarningLogLevel,j.ErrorLogLevel];for(const l of R)if((h&l)===l){const h=this._Levels[l];j[h.name]=j._LogEnabled.bind(j,l)}}}j.NoneLogLevel=0,j.MessageLogLevel=1,j.WarningLogLevel=2,j.ErrorLogLevel=4,j.AllLogLevel=7,j.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",j._LogCache="",j._LogLimitOutputs={},j._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],j.errorsCount=0,j.Log=j._LogEnabled.bind(j,j.MessageLogLevel),j.Warn=j._LogEnabled.bind(j,j.WarningLogLevel),j.Error=j._LogEnabled.bind(j,j.ErrorLogLevel)},12696:(h,R,l)=>{l.d(R,{d:()=>U});const j="undefined"!==typeof WeakRef;class a{constructor(h){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0;this.initialize(h,R,l,j)}initialize(h){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0;return this.mask=h,this.skipNextObservers=R,this.target=l,this.currentTarget=j,this}}class D{constructor(h,R){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=h,this.mask=R,this.scope=l,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let h=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(h)}}class U{static FromPromise(h,R){const l=new U;return h.then((h=>{l.notifyObservers(h)})).catch((h=>{if(!R)throw h;R.notifyObservers(h)})),l}get observers(){return this._observers}constructor(h){let R=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=R,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new a(0),h&&(this._onObserverAdded=h)}add(h){let R=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!h)return null;const a=new D(h,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);a.unregisterOnNextCall=l,R?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(a,this._lastNotifiedValue);const U=j?new WeakRef(this):{deref:()=>this};return a._remove=function(){let h=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const R=U.deref();R&&(h?R.remove(a):R._remove(a))},a}addOnce(h){return this.add(h,void 0,void 0,void 0,!0)}remove(h){if(!h)return!1;h._remove=null;return-1!==this._observers.indexOf(h)&&(this._deferUnregister(h),!0)}removeCallback(h,R){for(let l=0;l<this._observers.length;l++){const j=this._observers[l];if(!j._willBeUnregistered&&(j.callback===h&&(!R||R===j.scope)))return this._deferUnregister(j),!0}return!1}_deferUnregister(h){h._willBeUnregistered||(this._numObserversMarkedAsDeleted++,h.unregisterOnNextCall=!1,h._willBeUnregistered=!0,setTimeout((()=>{this._remove(h)}),0))}_remove(h){let R=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!h)return!1;const l=this._observers.indexOf(h);return-1!==l&&(R&&this._numObserversMarkedAsDeleted--,this._observers.splice(l,1),!0)}makeObserverTopPriority(h){this._remove(h,!1),this._observers.unshift(h)}makeObserverBottomPriority(h){this._remove(h,!1),this._observers.push(h)}notifyObservers(h){let R=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,l=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=h),!this._observers.length)return!0;const D=this._eventState;D.mask=R,D.target=l,D.currentTarget=j,D.skipNextObservers=!1,D.lastReturnValue=h,D.userInfo=a;for(const U of this._observers)if(!U._willBeUnregistered&&(U.mask&R&&(U.unregisterOnNextCall&&this._deferUnregister(U),U.scope?D.lastReturnValue=U.callback.apply(U.scope,[h,D]):D.lastReturnValue=U.callback(h,D)),D.skipNextObservers))return!1;return!0}notifyObserver(h,R){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=R),h._willBeUnregistered)return;const j=this._eventState;j.mask=l,j.skipNextObservers=!1,h.unregisterOnNextCall&&this._deferUnregister(h),h.callback(R,j)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const h=this._observers.pop();h&&(h._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const h=new U;return h._observers=this._observers.slice(0),h}hasSpecificMask(){let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const R of this._observers)if(R.mask&h||R.mask===h)return!0;return!1}}},12790:(h,R,l)=>{l.d(R,{b:()=>a,c:()=>U});let j=[];class a{static SetImmediate(h){0===j.length&&setTimeout((()=>{const h=j;j=[];for(const R of h)R()}),1),j.push(h)}}function D(h,R,l){try{if(h())return R(),!0}catch(j){return null===l||void 0===l||l(j),!0}return!1}const U=function(h,R,l){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,U=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&D(h,R,l))return null;const F=setInterval((()=>{D(h,R,l)?clearInterval(F):(a-=j,a<0&&(clearInterval(F),null===l||void 0===l||l(new Error("Operation timed out after maximum retries. "+(U||"")),!0)))}),j);return()=>clearInterval(F)}}}]);