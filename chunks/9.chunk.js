"use strict";(self.qcdfysujsyf=self.qcdfysujsyf||[]).push([[9],{12586:(K,A,T)=>{T.d(A,{d:()=>S,e:()=>z,k:()=>g,h:()=>p,o:()=>r});class G{constructor(){this.children=[]}isValid(K){return!0}process(K,A,T){let G="";if(this.line){let T=this.line;const Y=A.processor;if(Y){var B,L,f,O,C,Q;Y.lineProcessor&&(T=Y.lineProcessor(T,A.isFragment,A.processingContext));const G=(null===(B=A.processor)||void 0===B?void 0:B.attributeKeywordName)??"attribute",Z=A.isFragment&&null!==(L=A.processor)&&void 0!==L&&L.varyingFragmentKeywordName?null===(f=A.processor)||void 0===f?void 0:f.varyingFragmentKeywordName:!A.isFragment&&null!==(O=A.processor)&&void 0!==O&&O.varyingVertexKeywordName?null===(C=A.processor)||void 0===C?void 0:C.varyingVertexKeywordName:"varying";if(!A.isFragment&&Y.attributeProcessor&&this.line.startsWith(G))T=Y.attributeProcessor(this.line,K,A.processingContext);else if(Y.varyingProcessor&&(null!==(Q=Y.varyingCheck)&&void 0!==Q&&Q.call(Y,this.line,A.isFragment)||!Y.varyingCheck&&this.line.startsWith(Z)))T=Y.varyingProcessor(this.line,A.isFragment,K,A.processingContext);else if(Y.uniformProcessor&&Y.uniformRegexp&&Y.uniformRegexp.test(this.line))A.lookForClosingBracketForUniformBuffer||(T=Y.uniformProcessor(this.line,A.isFragment,K,A.processingContext));else if(Y.uniformBufferProcessor&&Y.uniformBufferRegexp&&Y.uniformBufferRegexp.test(this.line))A.lookForClosingBracketForUniformBuffer||(T=Y.uniformBufferProcessor(this.line,A.isFragment,A.processingContext),A.lookForClosingBracketForUniformBuffer=!0);else if(Y.textureProcessor&&Y.textureRegexp&&Y.textureRegexp.test(this.line))T=Y.textureProcessor(this.line,A.isFragment,K,A.processingContext);else if((Y.uniformProcessor||Y.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!A.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?Y.uniformProcessor&&(T=Y.uniformProcessor(this.line,A.isFragment,K,A.processingContext)):Y.uniformBufferProcessor&&(T=Y.uniformBufferProcessor(this.line,A.isFragment,A.processingContext),A.lookForClosingBracketForUniformBuffer=!0)}A.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(A.lookForClosingBracketForUniformBuffer=!1,Y.endOfUniformBufferProcessor&&(T=Y.endOfUniformBufferProcessor(this.line,A.isFragment,A.processingContext)))}G+=T+"\n"}for(const Y of this.children)G+=Y.process(K,A,T);return this.additionalDefineKey&&(K[this.additionalDefineKey]=this.additionalDefineValue||"true",T[this.additionalDefineKey]=K[this.additionalDefineKey]),G}}class B{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(K){this._lines.length=0;for(const A of K){if(!A||"\r"===A)continue;if("#"===A[0]){this._lines.push(A);continue}const K=A.trim();if(!K)continue;if(K.startsWith("//")){this._lines.push(A);continue}const T=K.indexOf(";");if(-1===T)this._lines.push(K);else if(T===K.length-1)K.length>1&&this._lines.push(K);else{const K=A.split(";");for(let A=0;A<K.length;A++){let T=K[A];T&&(T=T.trim(),T&&this._lines.push(T+(A!==K.length-1?";":"")))}}}}}class L extends G{process(K,A,T){for(let G=0;G<this.children.length;G++){const B=this.children[G];if(B.isValid(K))return B.process(K,A,T)}return""}}class f extends G{isValid(K){return this.testExpression.isTrue(K)}}class O{isTrue(K){return!0}static postfixToInfix(K){const A=[];for(const T of K)if(void 0===O._OperatorPriority[T])A.push(T);else{const K=A[A.length-1],G=A[A.length-2];A.length-=2,A.push(`(${G}${T}${K})`)}return A[A.length-1]}static infixToPostfix(K){const A=O._InfixToPostfixCache.get(K);if(A)return A.accessTime=Date.now(),A.result;if(!K.includes("&&")&&!K.includes("||")&&!K.includes(")")&&!K.includes("("))return[K];const T=[];let G=-1;const B=()=>{Y=Y.trim(),""!==Y&&(T.push(Y),Y="")},L=K=>{G<O._Stack.length-1&&(O._Stack[++G]=K)},f=()=>O._Stack[G],C=()=>-1===G?"!!INVALID EXPRESSION!!":O._Stack[G--];let Q=0,Y="";for(;Q<K.length;){const A=K.charAt(Q),Z=Q<K.length-1?K.substring(Q,2+Q):"";if("("===A)Y="",L(A);else if(")"===A){for(B();-1!==G&&"("!==f();)T.push(C());C()}else if(O._OperatorPriority[Z]>1){for(B();-1!==G&&O._OperatorPriority[f()]>=O._OperatorPriority[Z];)T.push(C());L(Z),Q++}else Y+=A;Q++}for(B();-1!==G;)"("===f()?C():T.push(C());return O._InfixToPostfixCache.size>=O.InfixToPostfixCacheLimitSize&&O.ClearCache(),O._InfixToPostfixCache.set(K,{result:T,accessTime:Date.now()}),T}static ClearCache(){const K=Array.from(O._InfixToPostfixCache.entries()).sort(((K,A)=>K[1].accessTime-A[1].accessTime));for(let A=0;A<O.InfixToPostfixCacheCleanupSize;A++)O._InfixToPostfixCache.delete(K[A][0])}}O.InfixToPostfixCacheLimitSize=5e4,O.InfixToPostfixCacheCleanupSize=25e3,O._InfixToPostfixCache=new Map,O._OperatorPriority={")":0,"(":1,"||":2,"&&":3},O._Stack=["","","","","","","","","","","","","","","","","","","",""];class C extends O{constructor(K){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=K,this.not=A}isTrue(K){let A=void 0!==K[this.define];return this.not&&(A=!A),A}}class Q extends O{isTrue(K){return this.leftOperand.isTrue(K)||this.rightOperand.isTrue(K)}}class Y extends O{isTrue(K){return this.leftOperand.isTrue(K)&&this.rightOperand.isTrue(K)}}class Z extends O{constructor(K,A,T){super(),this.define=K,this.operand=A,this.testValue=T}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(K){let A=!1;const T=parseInt(void 0!=K[this.define]?K[this.define]:this.define),G=parseInt(void 0!=K[this.testValue]?K[this.testValue]:this.testValue);if(isNaN(T)||isNaN(G))return!1;switch(this.operand){case">":A=T>G;break;case"<":A=T<G;break;case"<=":A=T<=G;break;case">=":A=T>=G;break;case"==":A=T===G;break;case"!=":A=T!==G}return A}}var x=T(12555),J=T(12589);const b=/defined\s*?\((.+?)\)/g,P=/defined\s*?\[(.+?)\]/g,F=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,d=/__decl__/,N=/light\{X\}.(\w*)/g,D=/\{X\}/g,mK=[],U=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function z(K){K.processor&&K.processor.initializeShaders&&K.processor.initializeShaders(K.processingContext)}function g(K,A,T,G){var B;null!==(B=A.processor)&&void 0!==B&&B.preProcessShaderCode&&(K=A.processor.preProcessShaderCode(K,A.isFragment)),p(K,A,(K=>{A.processCodeAfterIncludes&&(K=A.processCodeAfterIncludes(A.isFragment?"fragment":"vertex",K,A.defines));const B=function(K,A,T){let G=function(K,A){var T;if(null!==(T=A.processor)&&void 0!==T&&T.noPrecision)return K;const G=A.shouldUseHighPrecisionShader;-1===K.indexOf("precision highp float")?K=G?"precision highp float;\n"+K:"precision mediump float;\n"+K:G||(K=K.replace("precision highp float","precision mediump float"));return K}(K,A);if(!A.processor)return G;if(0===A.processor.shaderLanguage&&-1!==G.indexOf("#version 3")&&(G=G.replace("#version 300 es",""),!A.processor.parseGLES3))return G;const B=A.defines,L=e(A,T);A.processor.preProcessor&&(G=A.processor.preProcessor(G,B,L,A.isFragment,A.processingContext));const f={};G=H(G,L,A,f),A.processor.postProcessor&&(G=A.processor.postProcessor(G,B,A.isFragment,A.processingContext,T?{drawBuffersExtensionDisabled:!T.getCaps().drawBuffersExtension}:{},L,f));null!==T&&void 0!==T&&T._features.needShaderCodeInlining&&(G=T.inlineShaderCode(G));return G}(K,A,G);T(B,K)}))}function S(K,A,T){return T.processor&&T.processor.finalizeShaders?T.processor.finalizeShaders(K,A,T.processingContext):{vertexCode:K,fragmentCode:A}}function l(K){const A=/defined\((.+)\)/.exec(K);if(A&&A.length)return new C(A[1].trim(),"!"===K[0]);const T=["==","!=",">=","<=","<",">"];let G="",B=0;for(G of T)if(B=K.indexOf(G),B>-1)break;if(-1===B)return new C(K);const L=K.substring(0,B).trim(),f=K.substring(B+G.length).trim();return new Z(L,G,f)}function u(K,A){const T=new f,G=K.substring(0,A);let B=K.substring(A);return B=B.substring(0,(B.indexOf("//")+1||B.length+1)-1).trim(),T.testExpression="#ifdef"===G?new C(B):"#ifndef"===G?new C(B,!0):function(K){K=K.replace(b,"defined[$1]");const A=O.infixToPostfix(K),T=[];for(const B of A)if("||"!==B&&"&&"!==B)T.push(B);else if(T.length>=2){let K=T[T.length-1],A=T[T.length-2];T.length-=2;const G="&&"==B?new Y:new Q;"string"===typeof K&&(K=K.replace(P,"defined($1)")),"string"===typeof A&&(A=A.replace(P,"defined($1)")),G.leftOperand="string"===typeof A?l(A):A,G.rightOperand="string"===typeof K?l(K):K,T.push(G)}let G=T[T.length-1];return"string"===typeof G&&(G=G.replace(P,"defined($1)")),"string"===typeof G?l(G):G}(B),T}function c(K,A,T,B){let L=K.currentLine;for(;n(K,T,B);){L=K.currentLine;const f=L.substring(0,5).toLowerCase();if("#else"===f){const T=new G;return A.children.push(T),void n(K,T,B)}if("#elif"===f){const K=u(L,5);A.children.push(K),T=K}}}function n(K,A,T){for(;K.canRead;){K.lineIndex++;const B=K.currentLine;if(B.indexOf("#")>=0){const G=U.exec(B);if(G&&G.length){switch(G[0]){case"#ifdef":{const G=new L;A.children.push(G);const f=u(B,6);G.children.push(f),c(K,G,f,T);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const G=new L;A.children.push(G);const f=u(B,7);G.children.push(f),c(K,G,f,T);break}case"#if":{const G=new L,f=u(B,3);A.children.push(G),G.children.push(f),c(K,G,f,T);break}}continue}}const f=new G;if(f.line=B,A.children.push(f),"#"===B[0]&&"d"===B[1]){const K=B.replace(";","").split(" ");f.additionalDefineKey=K[1],3===K.length&&(f.additionalDefineValue=K[2])}}return!1}function H(K,A,T,L){const f=new G,O=new B;return O.lineIndex=-1,O.lines=K.split("\n"),n(O,f,L),f.process(A,T,L)}function e(K,A){var T;const G=K.defines,B={};for(const L of G){const K=L.replace("#define","").replace(";","").trim().split(" ");B[K[0]]=K.length>1?K[1]:""}return 0===(null===(T=K.processor)||void 0===T?void 0:T.shaderLanguage)&&(B.GL_ES="true"),B.__VERSION__=K.version,B[K.platformName]="true",(0,J.k)(B,null===A||void 0===A?void 0:A.isNDCHalfZRange,null===A||void 0===A?void 0:A.Zf,null===A||void 0===A?void 0:A.useExactSrgbConversions),B}function p(K,A,T){let G;for(mK.length=0;null!==(G=F.exec(K));)mK.push(G);let B=String(K),L=[K],f=!1;for(const O of mK){let K=O[1];if(-1!==K.indexOf("__decl__")&&(K=K.replace(d,""),A.supportsUniformBuffers&&(K=K.replace("Vertex","Ubo").replace("Fragment","Ubo")),K+="Declaration"),!A.includesShadersStore[K]){const G=A.shadersRepository+"ShadersInclude/"+K+".fx";return void r.loadFile(G,(G=>{A.includesShadersStore[K]=G,p(L.join(""),A,T)}))}{let T=A.includesShadersStore[K];if(O[2]){const K=O[3].split(",");for(let A=0;A<K.length;A+=2){const G=new RegExp(K[A],"g"),B=K[A+1];T=T.replace(G,B)}}if(O[4]){const K=O[5];if(-1!==K.indexOf("..")){const G=K.split(".."),B=parseInt(G[0]);let L=parseInt(G[1]),f=T.slice(0);T="",isNaN(L)&&(L=A.indexParameters[G[1]]);for(let K=B;K<L;K++)A.supportsUniformBuffers||(f=f.replace(N,((K,A)=>A+"{X}"))),T+=f.replace(D,K.toString())+"\n"}else A.supportsUniformBuffers||(T=T.replace(N,((K,A)=>A+"{X}"))),T=T.replace(D,K)}const G=[];for(const K of L){const A=K.split(O[0]);for(let K=0;K<A.length-1;K++)G.push(A[K]),G.push(T);G.push(A[A.length-1])}L=G,f=f||T.indexOf("#include<")>=0||T.indexOf("#include <")>=0}}mK.length=0,B=L.join(""),f?p(B.toString(),A,T):T(B)}const r={loadFile:(K,A,T,G,B,L)=>{throw(0,x.c)("FileTools")}}},12589:(K,A,T)=>{T.d(A,{e:()=>B,h:()=>L,k:()=>O,l:()=>f,o:()=>C});var G=T(12555);T(12540);const B={};function L(K,A){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(A?A+"\n":"")+K}function f(K,A,T,L,f,O,C){const Q=C||B.loadFile;if(Q){return Q(K,A,T,L,f,O)}throw(0,G.c)("FileTools")}function O(K,A,T,G){if(K)return A?K.IS_NDC_HALF_ZRANGE="":delete K.IS_NDC_HALF_ZRANGE,T?K.USE_REVERSE_DEPTHBUFFER="":delete K.USE_REVERSE_DEPTHBUFFER,void(G?K.USE_EXACT_SRGB_CONVERSIONS="":delete K.USE_EXACT_SRGB_CONVERSIONS);{let K="";return A&&(K+="#define IS_NDC_HALF_ZRANGE"),T&&(K&&(K+="\n"),K+="#define USE_REVERSE_DEPTHBUFFER"),G&&(K&&(K+="\n"),K+="#define USE_EXACT_SRGB_CONVERSIONS"),K}}function C(K,A){let T=arguments.length>2&&void 0!==arguments[2]&&arguments[2],G=arguments.length>3?arguments[3]:void 0;switch(K){case 3:{const K=(ArrayBuffer,new Int8Array(A));return G&&K.set(new Int8Array(G)),K}case 0:{const K=(ArrayBuffer,new Uint8Array(A));return G&&K.set(new Uint8Array(G)),K}case 4:{const K=A instanceof ArrayBuffer?new Int16Array(A):new Int16Array(T?A/2:A);return G&&K.set(new Int16Array(G)),K}case 5:case 8:case 9:case 10:case 2:{const K=A instanceof ArrayBuffer?new Uint16Array(A):new Uint16Array(T?A/2:A);return G&&K.set(new Uint16Array(G)),K}case 6:{const K=A instanceof ArrayBuffer?new Int32Array(A):new Int32Array(T?A/4:A);return G&&K.set(new Int32Array(G)),K}case 7:case 11:case 12:case 13:case 14:case 15:{const K=A instanceof ArrayBuffer?new Uint32Array(A):new Uint32Array(T?A/4:A);return G&&K.set(new Uint32Array(G)),K}case 1:{const K=A instanceof ArrayBuffer?new Float32Array(A):new Float32Array(T?A/4:A);return G&&K.set(new Float32Array(G)),K}}const B=(ArrayBuffer,new Uint8Array(A));return G&&B.set(new Uint8Array(G)),B}},12618:(K,A,T)=>{T.d(A,{b:()=>G});class G{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.ShadersRepository:G.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.ShadersStore:G.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?G.IncludesShadersStore:G.IncludesShadersStoreWGSL}}G.ShadersRepository="src/Shaders/",G.ShadersStore={},G.IncludesShadersStore={},G.ShadersRepositoryWGSL="src/ShadersWGSL/",G.ShadersStoreWGSL={},G.IncludesShadersStoreWGSL={}},12624:(K,A,T)=>{T.d(A,{b:()=>x,d:()=>D,h:()=>b,l:()=>J,p:()=>P,q:()=>N,r:()=>Z,t:()=>Q,v:()=>Y,y:()=>C,z:()=>O});class G{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.bA._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(K){K&&this.program&&K(this.program)}setEngine(K){this.bA=K}_fillEffectInformation(K,A,T,G,B,L,f,O){const C=this.bA;if(C.supportsUniformBuffers)for(const Y in A)K.bindUniformBlock(Y,A[Y]);let Q;for(this.bA.getUniforms(this,T).forEach(((K,A)=>{G[T[A]]=K})),this._uniforms=G,Q=0;Q<B.length;Q++){null==K.getUniform(B[Q])&&(B.splice(Q,1),Q--)}B.forEach(((K,A)=>{L[K]=A}));for(const Y of C.getAttributes(this,f))O.push(Y)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(K,A){const T=this._valueCache[K],G=A.updateFlag;return(void 0===T||T!==G)&&(this._valueCache[K]=G,!0)}_cacheFloat2(K,A,T){let G=this._valueCache[K];if(!G||2!==G.length)return G=[A,T],this._valueCache[K]=G,!0;let B=!1;return G[0]!==A&&(G[0]=A,B=!0),G[1]!==T&&(G[1]=T,B=!0),B}_cacheFloat3(K,A,T,G){let B=this._valueCache[K];if(!B||3!==B.length)return B=[A,T,G],this._valueCache[K]=B,!0;let L=!1;return B[0]!==A&&(B[0]=A,L=!0),B[1]!==T&&(B[1]=T,L=!0),B[2]!==G&&(B[2]=G,L=!0),L}_cacheFloat4(K,A,T,G,B){let L=this._valueCache[K];if(!L||4!==L.length)return L=[A,T,G,B],this._valueCache[K]=L,!0;let f=!1;return L[0]!==A&&(L[0]=A,f=!0),L[1]!==T&&(L[1]=T,f=!0),L[2]!==G&&(L[2]=G,f=!0),L[3]!==B&&(L[3]=B,f=!0),f}setInt(K,A){const T=this._valueCache[K];void 0!==T&&T===A||this.bA.setInt(this._uniforms[K],A)&&(this._valueCache[K]=A)}setInt2(K,A,T){this._cacheFloat2(K,A,T)&&(this.bA.setInt2(this._uniforms[K],A,T)||(this._valueCache[K]=null))}setInt3(K,A,T,G){this._cacheFloat3(K,A,T,G)&&(this.bA.setInt3(this._uniforms[K],A,T,G)||(this._valueCache[K]=null))}setInt4(K,A,T,G,B){this._cacheFloat4(K,A,T,G,B)&&(this.bA.setInt4(this._uniforms[K],A,T,G,B)||(this._valueCache[K]=null))}setIntArray(K,A){this._valueCache[K]=null,this.bA.setIntArray(this._uniforms[K],A)}setIntArray2(K,A){this._valueCache[K]=null,this.bA.setIntArray2(this._uniforms[K],A)}setIntArray3(K,A){this._valueCache[K]=null,this.bA.setIntArray3(this._uniforms[K],A)}setIntArray4(K,A){this._valueCache[K]=null,this.bA.setIntArray4(this._uniforms[K],A)}setUInt(K,A){const T=this._valueCache[K];void 0!==T&&T===A||this.bA.setUInt(this._uniforms[K],A)&&(this._valueCache[K]=A)}setUInt2(K,A,T){this._cacheFloat2(K,A,T)&&(this.bA.setUInt2(this._uniforms[K],A,T)||(this._valueCache[K]=null))}setUInt3(K,A,T,G){this._cacheFloat3(K,A,T,G)&&(this.bA.setUInt3(this._uniforms[K],A,T,G)||(this._valueCache[K]=null))}setUInt4(K,A,T,G,B){this._cacheFloat4(K,A,T,G,B)&&(this.bA.setUInt4(this._uniforms[K],A,T,G,B)||(this._valueCache[K]=null))}setUIntArray(K,A){this._valueCache[K]=null,this.bA.setUIntArray(this._uniforms[K],A)}setUIntArray2(K,A){this._valueCache[K]=null,this.bA.setUIntArray2(this._uniforms[K],A)}setUIntArray3(K,A){this._valueCache[K]=null,this.bA.setUIntArray3(this._uniforms[K],A)}setUIntArray4(K,A){this._valueCache[K]=null,this.bA.setUIntArray4(this._uniforms[K],A)}setArray(K,A){this._valueCache[K]=null,this.bA.setArray(this._uniforms[K],A)}setArray2(K,A){this._valueCache[K]=null,this.bA.setArray2(this._uniforms[K],A)}setArray3(K,A){this._valueCache[K]=null,this.bA.setArray3(this._uniforms[K],A)}setArray4(K,A){this._valueCache[K]=null,this.bA.setArray4(this._uniforms[K],A)}setMatrices(K,A){A&&(this._valueCache[K]=null,this.bA.setMatrices(this._uniforms[K],A))}setMatrix(K,A){this._cacheMatrix(K,A)&&(this.bA.setMatrices(this._uniforms[K],A.kf())||(this._valueCache[K]=null))}setMatrix3x3(K,A){this._valueCache[K]=null,this.bA.setMatrix3x3(this._uniforms[K],A)}setMatrix2x2(K,A){this._valueCache[K]=null,this.bA.setMatrix2x2(this._uniforms[K],A)}setFloat(K,A){const T=this._valueCache[K];void 0!==T&&T===A||this.bA.setFloat(this._uniforms[K],A)&&(this._valueCache[K]=A)}setVector2(K,A){this._cacheFloat2(K,A.x,A.y)&&(this.bA.setFloat2(this._uniforms[K],A.x,A.y)||(this._valueCache[K]=null))}setFloat2(K,A,T){this._cacheFloat2(K,A,T)&&(this.bA.setFloat2(this._uniforms[K],A,T)||(this._valueCache[K]=null))}setVector3(K,A){this._cacheFloat3(K,A.x,A.y,A.z)&&(this.bA.setFloat3(this._uniforms[K],A.x,A.y,A.z)||(this._valueCache[K]=null))}setFloat3(K,A,T,G){this._cacheFloat3(K,A,T,G)&&(this.bA.setFloat3(this._uniforms[K],A,T,G)||(this._valueCache[K]=null))}setVector4(K,A){this._cacheFloat4(K,A.x,A.y,A.z,A.w)&&(this.bA.setFloat4(this._uniforms[K],A.x,A.y,A.z,A.w)||(this._valueCache[K]=null))}setQuaternion(K,A){this._cacheFloat4(K,A.x,A.y,A.z,A.w)&&(this.bA.setFloat4(this._uniforms[K],A.x,A.y,A.z,A.w)||(this._valueCache[K]=null))}setFloat4(K,A,T,G,B){this._cacheFloat4(K,A,T,G,B)&&(this.bA.setFloat4(this._uniforms[K],A,T,G,B)||(this._valueCache[K]=null))}setColor3(K,A){this._cacheFloat3(K,A.r,A.g,A.b)&&(this.bA.setFloat3(this._uniforms[K],A.r,A.g,A.b)||(this._valueCache[K]=null))}setColor4(K,A,T){this._cacheFloat4(K,A.r,A.g,A.b,T)&&(this.bA.setFloat4(this._uniforms[K],A.r,A.g,A.b,T)||(this._valueCache[K]=null))}setDirectColor4(K,A){this._cacheFloat4(K,A.r,A.g,A.b,A.a)&&(this.bA.setFloat4(this._uniforms[K],A.r,A.g,A.b,A.a)||(this._valueCache[K]=null))}_getVertexShaderCode(){return this.vertexShader?this.bA._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.bA._getShaderSource(this.fragmentShader):null}}var B=T(12589);const L=new WeakMap,f={_webGLVersion:2,cachedPipelines:{}};function O(K){let A=L.get(K);if(!A){if(!K)return f;A={_webGLVersion:K.TEXTURE_BINDING_3D?2:1,_context:K,parallelShaderCompile:K.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},L.set(K,A)}return A}function C(K){L.delete(K)}function Q(K,A,T,G,B,L){const f=O(G);L||(L=f._createShaderProgramInjection??x);return L(K,d(A,"vertex",G,f._contextWasLost),d(T,"fragment",G,f._contextWasLost),G,B,f.validateShaderPrograms)}function Y(K,A,T,G,B){let L=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,f=arguments.length>6?arguments[6]:void 0;const C=O(B);f||(f=C._createShaderProgramInjection??x);const Q=C._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return f(K,F(A,"vertex",G,Q,B,C._contextWasLost),F(T,"fragment",G,Q,B,C._contextWasLost),B,L,C.validateShaderPrograms)}function Z(K,A){const T=new G,B=O(K);return B.parallelShaderCompile&&!B.disableParallelShaderCompile&&(T.isParallelCompiled=!0),T.context=B._context,T}function x(K,A,T,G){let B=arguments.length>5?arguments[5]:void 0;const L=G.createProgram();if(K.program=L,!L)throw new Error("Unable to create program");return G.attachShader(L,A),G.attachShader(L,T),G.linkProgram(L),K.context=G,K.vertexShader=A,K.fragmentShader=T,K.isParallelCompiled||b(K,G,B),L}function J(K,A,T){const G=K;if(G._isDisposed)return!1;const B=O(A);return!!(B&&B.parallelShaderCompile&&B.parallelShaderCompile.COMPLETION_STATUS_KHR&&G.program&&A.getProgramParameter(G.program,B.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(b(G,A,T),!0)}function b(K,A,T){const G=K.context,B=K.vertexShader,L=K.fragmentShader,f=K.program;if(!G.getProgramParameter(f,G.LINK_STATUS)){if(!A.getShaderParameter(B,A.COMPILE_STATUS)){const T=A.getShaderInfoLog(B);if(T)throw K.vertexCompilationError=T,new Error("VERTEX SHADER "+T)}if(!A.getShaderParameter(L,A.COMPILE_STATUS)){const T=A.getShaderInfoLog(L);if(T)throw K.fragmentCompilationError=T,new Error("FRAGMENT SHADER "+T)}const T=G.getProgramInfoLog(f);if(T)throw K.programLinkError=T,new Error(T)}if(T){G.validateProgram(f);if(!G.getProgramParameter(f,G.VALIDATE_STATUS)){const A=G.getProgramInfoLog(f);if(A)throw K.programValidationError=A,new Error(A)}}G.deleteShader(B),G.deleteShader(L),K.vertexShader=void 0,K.fragmentShader=void 0,K.onCompiled&&(K.onCompiled(),K.onCompiled=void 0)}function P(K,A,T,G,B,L,f,C,Z){let x=arguments.length>10?arguments[10]:void 0,J=arguments.length>11?arguments[11]:void 0,b=arguments.length>12?arguments[12]:void 0;const P=O(K.context);J||(J=P.createRawShaderProgramInjection??Q),b||(b=P.createShaderProgramInjection??Y);const F=K;F.program=G?J(F,A,T,F.context,Z):b(F,A,T,C,F.context,Z),F.program.__SPECTOR_rebuildProgram=f,x()}function F(K,A,T,G,L,f){return d((0,B.h)(K,T,G),A,L,f)}function d(K,A,T,G){const B=T.createShader("vertex"===A?T.VERTEX_SHADER:T.FRAGMENT_SHADER);if(!B){let K=T.NO_ERROR,B=T.NO_ERROR;for(;(B=T.getError())!==T.NO_ERROR;)K=B;throw new Error(`Something went wrong while creating a gl ${A} shader object. gl error=${K}, gl isContextLost=${T.isContextLost()}, _contextWasLost=${G}`)}return T.shaderSource(B,K),T.compileShader(B),B}function N(K,A){A.useProgram(K)}function D(K,A){const T=K;if(!T.isParallelCompiled)return void A(K);const G=T.onCompiled;T.onCompiled=()=>{null===G||void 0===G||G(),A(K)}}},12620:(K,A,T)=>{T.d(A,{b:()=>Z,d:()=>J,f:()=>Q,g:()=>Y});var G=T(12540),B=T(12624),L=T(12618),f=T(12548),O=T(12586),C=T(12589);function Q(K,A){return(0,B.z)(A).cachedPipelines[K]}function Y(K){const A=K._name,T=K.context;if(A&&T){const K=(0,B.z)(T),G=K.cachedPipelines[A];null===G||void 0===G||G.dispose(),delete K.cachedPipelines[A]}}function Z(K,A,T,B,L,f,C){let Q,Y;const Z=(0,G.i)()?null===f||void 0===f?void 0:f.getHostDocument():null;Q="string"===typeof A?A:A.vertexSource?"source:"+A.vertexSource:A.vertexElement?(null===Z||void 0===Z?void 0:Z.getElementById(A.vertexElement))||A.vertexElement:A.vertex||A,Y="string"===typeof A?A:A.fragmentSource?"source:"+A.fragmentSource:A.fragmentElement?(null===Z||void 0===Z?void 0:Z.getElementById(A.fragmentElement))||A.fragmentElement:A.fragment||A;const J=[void 0,void 0],b=()=>{if(J[0]&&J[1]){K.isFragment=!0;const[G,Q]=J;(0,O.k)(Q,K,((f,Q)=>{C&&(C._fragmentSourceCodeBeforeMigration=Q),T&&(f=T("fragment",f));const Y=(0,O.d)(G,f,K);K=null;const Z=function(K,A,T,G){if(T){return{vertexSourceCode:(1===G?"//":"")+"#define SHADER_NAME vertex:"+(T.vertexElement||T.vertex||T.spectorName||T)+"\n"+K,fragmentSourceCode:(1===G?"//":"")+"#define SHADER_NAME fragment:"+(T.fragmentElement||T.fragment||T.spectorName||T)+"\n"+A}}return{vertexSourceCode:K,fragmentSourceCode:A}}(Y.vertexCode,Y.fragmentCode,A,L);null===B||void 0===B||B(Z.vertexSourceCode,Z.fragmentSourceCode)}),f)}};x(Q,"Vertex","",(A=>{(0,O.e)(K),(0,O.k)(A,K,((K,G)=>{C&&(C._rawVertexSourceCode=A,C._vertexSourceCodeBeforeMigration=G),T&&(K=T("vertex",K)),J[0]=K,b()}),f)}),L),x(Y,"Fragment","Pixel",(K=>{C&&(C._rawFragmentSourceCode=K),J[1]=K,b()}),L)}function x(K,A,T,B,f,O){if("undefined"!==typeof HTMLElement&&K instanceof HTMLElement){return void B((0,G.c)(K))}if("source:"===K.substring(0,7))return void B(K.substring(7));if("base64:"===K.substring(0,7)){return void B(window.atob(K.substring(7)))}const Q=L.b.GetShadersStore(f);if(Q[K+A+"Shader"])return void B(Q[K+A+"Shader"]);if(T&&Q[K+T+"Shader"])return void B(Q[K+T+"Shader"]);let Y;if(Y="."===K[0]||"/"===K[0]||K.indexOf("http")>-1?K:L.b.GetShadersRepository(f)+K,!(O=O||C.l))throw new Error("loadFileInjection is not defined");O(Y+"."+A.toLowerCase()+".fx",B)}const J=(K,A,T,G)=>{try{const L=K.context?(0,B.z)(K.context):null;L&&(L.disableParallelShaderCompile=K.disableParallelCompilation);const f=K.existingPipelineContext||A(K.shaderProcessingContext);return f._name=K.name,K.name&&L&&(L.cachedPipelines[K.name]=f),T(f,K.vertex,K.fragment,!!K.createAsRaw,"","",K.rebuildRebind,K.defines,K.transformFeedbackVaryings,"",(()=>{G(f,(()=>{var A;null===(A=K.onRenderingStateCompiled)||void 0===A||A.call(K,f)}))})),f}catch(L){throw f.d.Error("Error compiling effect"),L}}},12610:(K,A,T)=>{T.r(A),T.d(A,{Effect:()=>C});var G=T(12534),B=T(12548),L=T(12618),f=T(12620),O=T(12596);class C{static get ShadersRepository(){return L.b.ShadersRepository}static set ShadersRepository(K){L.b.ShadersRepository=K}get O(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new G.e),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(K,A,T){let B=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,L=arguments.length>4?arguments[4]:void 0,O=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,Q=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,Y=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Z=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,x=arguments.length>9?arguments[9]:void 0,J=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",b=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,P=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new G.e,this.onErrorObservable=new G.e,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=K,this._key=J;const F=this._key.replace(/\r/g,"").replace(/\n/g,"|");let d;if(A.attributes){const K=A;if(this._engine=T,this._attributesNames=K.attributes,this._uniformsNames=K.uniformsNames.concat(K.samplers),this._samplerList=K.samplers.slice(),this.defines=K.defines,this.onError=K.onError,this.onCompiled=K.onCompiled,this._fallbacks=K.fallbacks,this._indexParameters=K.indexParameters,this._transformFeedbackVaryings=K.transformFeedbackVaryings||null,this._multiTarget=!!K.multiTarget,this._shaderLanguage=K.shaderLanguage??0,this._disableParallelShaderCompilation=!!K.disableParallelShaderCompilation,K.uniformBuffersNames){this._uniformBuffersNamesList=K.uniformBuffersNames.slice();for(let A=0;A<K.uniformBuffersNames.length;A++)this._uniformBuffersNames[K.uniformBuffersNames[A]]=A}this._processFinalCode=K.processFinalCode??null,this._processCodeAfterIncludes=K.processCodeAfterIncludes??void 0,P=K.extraInitializationsAsync,d=K.existingPipelineContext}else this._engine=L,this.defines=null==O?"":O,this._uniformsNames=T.concat(B),this._samplerList=B?B.slice():[],this._attributesNames=A,this._uniformBuffersNamesList=[],this._shaderLanguage=b,this.onError=Z,this.onCompiled=Y,this._indexParameters=x,this._fallbacks=Q;"WEBGL2"===this._engine.shaderPlatformName&&(d=(0,f.f)(F,this._engine._gl)??d),this._attributeLocationByName={},this.uniqueId=C._UniqueIdSeed++,d?(this._pipelineContext=d,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,P),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.O||this.dispose(!0)}))}async _processShaderCodeAsync(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,G=arguments.length>3?arguments[3]:void 0;G&&await G(),this._processingContext=T||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const B={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:K??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:L.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:L.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,Zf:this._engine.Zf,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,f.b)(B,this.name,this._processFinalCode,((K,T)=>{this._vertexSourceCode=K,this._fragmentSourceCode=T,this._prepareEffect(A)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.O||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(K){return this._attributes[K]}getAttributeLocationByName(K){return this._attributeLocationByName[K]}getAttributesCount(){return this._attributes.length}getUniformIndex(K){return this._uniformsNames.indexOf(K)}getUniform(K){return this._uniforms[K]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((K=>{this.executeWhenCompiled(K)}))}executeWhenCompiled(K){this.isReady()?K(this):(this.onCompileObservable.add((A=>{K(A)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(K){(0,O.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(A=>{this._processCompilationErrors(A,K)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,Zf:this._engine.Zf,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(K,A,T,G){this._isReady=!1,this._vertexSourceCodeOverride=K,this._fragmentSourceCodeOverride=A,this.onError=(K,A)=>{G&&G(A)},this.onCompiled=()=>{var K,A;const G=this.getEngine().scenes;if(G)for(let T=0;T<G.length;T++)G[T].markAllMaterialsAsDirty(127);null===(K=(A=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===K||K.call(A,T)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(K){if(this._pipelineContext=K,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let A=0;A<this._attributesNames.length;A++){const K=this._attributesNames[A];this._attributeLocationByName[K]=this._attributes[A]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),C.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const A=this._pipelineContext;this._isReady=!1;try{const T=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),G=T?null:this.defines,B=T?this._vertexSourceCodeOverride:this._vertexSourceCode,L=T?this._fragmentSourceCodeOverride:this._fragmentSourceCode,O=this._engine;this._pipelineContext=(0,f.d)({existingPipelineContext:K?A:null,vertex:B,fragment:L,context:"WEBGL2"===O.shaderPlatformName||"WEBGL1"===O.shaderPlatformName?O._gl:void 0,rebuildRebind:(K,A,T,G)=>this._rebuildProgram(K,A,T,G),defines:G,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:T,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:T=>{A&&!K&&this._engine._deletePipelineContext(A),T&&this._onRenderingStateCompiled(T)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(A)}catch(T){this._processCompilationErrors(T,A)}}_getShaderCodeAndErrorLine(K,A,T){const G=T?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let B=null;if(A&&K){const L=A.match(G);if(L&&2===L.length){const A=parseInt(L[1]),G=K.split("\n",-1);G.length>=A&&(B=`Offending line [${A}] in ${T?"fragment":"vertex"} code: ${G[A-1]}`)}}return[K,B]}_processCompilationErrors(K){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=K.message;const T=this._attributesNames,G=this._fallbacks;if(B.d.Error("Unable to compile effect:"),B.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),B.d.Error(`Attributes: ${T.join(" ")}`),B.d.Error("Defines:\n"+this.defines),C.LogShaderCodeOnCompilationError){var L,f;let K=null,A=null,T=null;var O;if(null!==(L=this._pipelineContext)&&void 0!==L&&L._getVertexShaderCode()&&([T,K]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),T&&(B.d.Error("Vertex code:"),B.d.Error(T))),null!==(f=this._pipelineContext)&&void 0!==f&&f._getFragmentShaderCode())[T,A]=this._getShaderCodeAndErrorLine(null===(O=this._pipelineContext)||void 0===O?void 0:O._getFragmentShaderCode(),this._compilationError,!0),T&&(B.d.Error("Fragment code:"),B.d.Error(T));K&&B.d.Error(K),A&&B.d.Error(A)}B.d.Error("Error: "+this._compilationError);const Q=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};A&&(this._pipelineContext=A,this._isReady=!0,Q()),G?(this._pipelineContext=null,G.hasMoreFallbacks?(this._allFallbacksProcessed=!1,B.d.Error("Trying next fallback."),this.defines=G.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,Q(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,A||Q())}get isSupported(){return""===this._compilationError}_bindTexture(K,A){this._engine._bindTexture(this._samplers[K],A,K)}setTexture(K,A){this._engine.setTexture(this._samplers[K],this._uniforms[K],A,K)}setTextureArray(K,A){const T=K+"Ex";if(-1===this._samplerList.indexOf(T+"0")){const G=this._samplerList.indexOf(K);for(let K=1;K<A.length;K++){const A=T+(K-1).toString();this._samplerList.splice(G+K,0,A)}let B=0;for(const K of this._samplerList)this._samplers[K]=B,B+=1}this._engine.setTextureArray(this._samplers[K],this._uniforms[K],A,K)}bindUniformBuffer(K,A){const T=this._uniformBuffersNames[A];void 0===T||C._BaseCache[T]===K&&this._engine._features.useUBOBindingCache||(C._BaseCache[T]=K,this._engine.bindUniformBufferBase(K,T,A))}bindUniformBlock(K,A){this._engine.bindUniformBlock(this._pipelineContext,K,A)}setInt(K,A){return this._pipelineContext.setInt(K,A),this}setInt2(K,A,T){return this._pipelineContext.setInt2(K,A,T),this}setInt3(K,A,T,G){return this._pipelineContext.setInt3(K,A,T,G),this}setInt4(K,A,T,G,B){return this._pipelineContext.setInt4(K,A,T,G,B),this}setIntArray(K,A){return this._pipelineContext.setIntArray(K,A),this}setIntArray2(K,A){return this._pipelineContext.setIntArray2(K,A),this}setIntArray3(K,A){return this._pipelineContext.setIntArray3(K,A),this}setIntArray4(K,A){return this._pipelineContext.setIntArray4(K,A),this}setUInt(K,A){return this._pipelineContext.setUInt(K,A),this}setUInt2(K,A,T){return this._pipelineContext.setUInt2(K,A,T),this}setUInt3(K,A,T,G){return this._pipelineContext.setUInt3(K,A,T,G),this}setUInt4(K,A,T,G,B){return this._pipelineContext.setUInt4(K,A,T,G,B),this}setUIntArray(K,A){return this._pipelineContext.setUIntArray(K,A),this}setUIntArray2(K,A){return this._pipelineContext.setUIntArray2(K,A),this}setUIntArray3(K,A){return this._pipelineContext.setUIntArray3(K,A),this}setUIntArray4(K,A){return this._pipelineContext.setUIntArray4(K,A),this}setFloatArray(K,A){return this._pipelineContext.setArray(K,A),this}setFloatArray2(K,A){return this._pipelineContext.setArray2(K,A),this}setFloatArray3(K,A){return this._pipelineContext.setArray3(K,A),this}setFloatArray4(K,A){return this._pipelineContext.setArray4(K,A),this}setArray(K,A){return this._pipelineContext.setArray(K,A),this}setArray2(K,A){return this._pipelineContext.setArray2(K,A),this}setArray3(K,A){return this._pipelineContext.setArray3(K,A),this}setArray4(K,A){return this._pipelineContext.setArray4(K,A),this}setMatrices(K,A){return this._pipelineContext.setMatrices(K,A),this}setMatrix(K,A){return this._pipelineContext.setMatrix(K,A),this}setMatrix3x3(K,A){return this._pipelineContext.setMatrix3x3(K,A),this}setMatrix2x2(K,A){return this._pipelineContext.setMatrix2x2(K,A),this}setFloat(K,A){return this._pipelineContext.setFloat(K,A),this}setBool(K,A){return this._pipelineContext.setInt(K,A?1:0),this}setVector2(K,A){return this._pipelineContext.setVector2(K,A),this}setFloat2(K,A,T){return this._pipelineContext.setFloat2(K,A,T),this}setVector3(K,A){return this._pipelineContext.setVector3(K,A),this}setFloat3(K,A,T,G){return this._pipelineContext.setFloat3(K,A,T,G),this}setVector4(K,A){return this._pipelineContext.setVector4(K,A),this}setQuaternion(K,A){return this._pipelineContext.setQuaternion(K,A),this}setFloat4(K,A,T,G,B){return this._pipelineContext.setFloat4(K,A,T,G,B),this}setColor3(K,A){return this._pipelineContext.setColor3(K,A),this}setColor4(K,A,T){return this._pipelineContext.setColor4(K,A,T),this}setDirectColor4(K,A){return this._pipelineContext.setDirectColor4(K,A),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(C.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,f.g)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(K,A,T){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;A&&(L.b.GetShadersStore(G)[`${K}PixelShader`]=A),T&&(L.b.GetShadersStore(G)[`${K}VertexShader`]=T)}static ResetCache(){C._BaseCache={}}}C.LogShaderCodeOnCompilationError=!0,C.PersistentMode=!1,C.AutomaticallyClearCodeCache=!1,C._UniqueIdSeed=0,C._BaseCache={},C.ShadersStore=L.b.ShadersStore,C.IncludesShadersStore=L.b.IncludesShadersStore},12555:(K,A,T)=>{T.d(A,{c:()=>B});const G={};function B(K){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!G[K])return G[K]=!0,`${K} needs to be imported before as it contains a side-effect required by your code.`}},12540:(K,A,T)=>{function G(){return"undefined"!==typeof window}function B(){return"undefined"!==typeof navigator}function L(){return"undefined"!==typeof document}function f(K){let A="",T=K.firstChild;for(;T;)3===T.nodeType&&(A+=T.textContent),T=T.nextSibling;return A}T.d(A,{c:()=>f,d:()=>L,e:()=>B,i:()=>G})},12548:(K,A,T)=>{T.d(A,{d:()=>G});class G{static _CheckLimit(K,A){let T=G._LogLimitOutputs[K];return T?T.current++:(T={limit:A,current:1},G._LogLimitOutputs[K]=T),T.current<=T.limit}static _GenerateLimitMessage(K){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const T=G._LogLimitOutputs[K];if(!T||!G.MessageLimitReached)return;const B=this._Levels[A];T.current===T.limit&&G[B.name](G.MessageLimitReached.replace(/%LIMIT%/g,""+T.limit).replace(/%TYPE%/g,B.name??""))}static _AddLogEntry(K){G._LogCache=K+G._LogCache,G.OnNewCacheEntry&&G.OnNewCacheEntry(K)}static _FormatMessage(K){const A=K=>K<10?"0"+K:""+K,T=new Date;return"["+A(T.getHours())+":"+A(T.getMinutes())+":"+A(T.getSeconds())+"]: "+K}static _LogDisabled(K,A){}static _LogEnabled(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,A=arguments.length>1?arguments[1]:void 0,T=arguments.length>2?arguments[2]:void 0;const B=Array.isArray(A)?A[0]:A;if(void 0!==T&&!G._CheckLimit(B,T))return;const L=G._FormatMessage(B),f=this._Levels[K],O=Array.isArray(A)?A.slice(1):[];f.logFunc&&f.logFunc("BJS - "+L,...O);const C=`<div style='color:${f.color}'>${L}</div><br>`;G._AddLogEntry(C),G._GenerateLimitMessage(B,K)}static get LogCache(){return G._LogCache}static ClearLogCache(){G._LogCache="",G._LogLimitOutputs={},G.errorsCount=0}static set LogLevels(K){G.Log=G._LogDisabled,G.Warn=G._LogDisabled,G.Error=G._LogDisabled;const A=[G.MessageLogLevel,G.WarningLogLevel,G.ErrorLogLevel];for(const T of A)if((K&T)===T){const K=this._Levels[T];G[K.name]=G._LogEnabled.bind(G,T)}}}G.NoneLogLevel=0,G.MessageLogLevel=1,G.WarningLogLevel=2,G.ErrorLogLevel=4,G.AllLogLevel=7,G.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",G._LogCache="",G._LogLimitOutputs={},G._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],G.errorsCount=0,G.Log=G._LogEnabled.bind(G,G.MessageLogLevel),G.Warn=G._LogEnabled.bind(G,G.WarningLogLevel),G.Error=G._LogEnabled.bind(G,G.ErrorLogLevel)},12534:(K,A,T)=>{T.d(A,{e:()=>f});const G="undefined"!==typeof WeakRef;class B{constructor(K){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0;this.initialize(K,A,T,G)}initialize(K){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0;return this.mask=K,this.skipNextObservers=A,this.target=T,this.currentTarget=G,this}}class L{constructor(K,A){let T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=K,this.mask=A,this.scope=T,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(K)}}class f{static FromPromise(K,A){const T=new f;return K.then((K=>{T.notifyObservers(K)})).catch((K=>{if(!A)throw K;A.notifyObservers(K)})),T}get observers(){return this._observers}constructor(K){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=A,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new B(0),K&&(this._onObserverAdded=K)}add(K){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],T=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!K)return null;const B=new L(K,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);B.unregisterOnNextCall=T,A?this._observers.unshift(B):this._observers.push(B),this._onObserverAdded&&this._onObserverAdded(B),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(B,this._lastNotifiedValue);const f=G?new WeakRef(this):{deref:()=>this};return B._remove=function(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const A=f.deref();A&&(K?A.remove(B):A._remove(B))},B}addOnce(K){return this.add(K,void 0,void 0,void 0,!0)}remove(K){if(!K)return!1;K._remove=null;return-1!==this._observers.indexOf(K)&&(this._deferUnregister(K),!0)}removeCallback(K,A){for(let T=0;T<this._observers.length;T++){const G=this._observers[T];if(!G._willBeUnregistered&&(G.callback===K&&(!A||A===G.scope)))return this._deferUnregister(G),!0}return!1}_deferUnregister(K){K._willBeUnregistered||(this._numObserversMarkedAsDeleted++,K.unregisterOnNextCall=!1,K._willBeUnregistered=!0,setTimeout((()=>{this._remove(K)}),0))}_remove(K){let A=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!K)return!1;const T=this._observers.indexOf(K);return-1!==T&&(A&&this._numObserversMarkedAsDeleted--,this._observers.splice(T,1),!0)}makeObserverTopPriority(K){this._remove(K,!1),this._observers.unshift(K)}makeObserverBottomPriority(K){this._remove(K,!1),this._observers.push(K)}notifyObservers(K){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,T=arguments.length>2?arguments[2]:void 0,G=arguments.length>3?arguments[3]:void 0,B=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=K),!this._observers.length)return!0;const L=this._eventState;L.mask=A,L.target=T,L.currentTarget=G,L.skipNextObservers=!1,L.lastReturnValue=K,L.userInfo=B;for(const f of this._observers)if(!f._willBeUnregistered&&(f.mask&A&&(f.unregisterOnNextCall&&this._deferUnregister(f),f.scope?L.lastReturnValue=f.callback.apply(f.scope,[K,L]):L.lastReturnValue=f.callback(K,L)),L.skipNextObservers))return!1;return!0}notifyObserver(K,A){let T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=A),K._willBeUnregistered)return;const G=this._eventState;G.mask=T,G.skipNextObservers=!1,K.unregisterOnNextCall&&this._deferUnregister(K),K.callback(A,G)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const K=this._observers.pop();K&&(K._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const K=new f;return K._observers=this._observers.slice(0),K}hasSpecificMask(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const A of this._observers)if(A.mask&K||A.mask===K)return!0;return!1}}},12596:(K,A,T)=>{T.d(A,{d:()=>B,f:()=>f});let G=[];class B{static SetImmediate(K){0===G.length&&setTimeout((()=>{const K=G;G=[];for(const A of K)A()}),1),G.push(K)}}function L(K,A,T){try{if(K())return A(),!0}catch(G){return null===T||void 0===T||T(G),!0}return!1}const f=function(K,A,T){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,B=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,f=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&L(K,A,T))return null;const O=setInterval((()=>{L(K,A,T)?clearInterval(O):(B-=G,B<0&&(clearInterval(O),null===T||void 0===T||T(new Error("Operation timed out after maximum retries. "+(f||"")),!0)))}),G);return()=>clearInterval(O)}}}]);