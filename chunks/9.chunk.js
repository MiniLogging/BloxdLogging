"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[9],{11062:(g,w,q)=>{q.d(w,{e:()=>a,g:()=>U,l:()=>N,j:()=>V,n:()=>s});class R{constructor(){this.children=[]}isValid(g){return!0}process(g,w,q){let R="";if(this.line){let q=this.line;const t=w.processor;if(t){var o,r,S,i,T,z;t.lineProcessor&&(q=t.lineProcessor(q,w.isFragment,w.processingContext));const R=(null===(o=w.processor)||void 0===o?void 0:o.attributeKeywordName)??"attribute",m=w.isFragment&&null!==(r=w.processor)&&void 0!==r&&r.varyingFragmentKeywordName?null===(S=w.processor)||void 0===S?void 0:S.varyingFragmentKeywordName:!w.isFragment&&null!==(i=w.processor)&&void 0!==i&&i.varyingVertexKeywordName?null===(T=w.processor)||void 0===T?void 0:T.varyingVertexKeywordName:"varying";if(!w.isFragment&&t.attributeProcessor&&this.line.startsWith(R))q=t.attributeProcessor(this.line,g,w.processingContext);else if(t.varyingProcessor&&(null!==(z=t.varyingCheck)&&void 0!==z&&z.call(t,this.line,w.isFragment)||!t.varyingCheck&&this.line.startsWith(m)))q=t.varyingProcessor(this.line,w.isFragment,g,w.processingContext);else if(t.uniformProcessor&&t.uniformRegexp&&t.uniformRegexp.test(this.line))w.lookForClosingBracketForUniformBuffer||(q=t.uniformProcessor(this.line,w.isFragment,g,w.processingContext));else if(t.uniformBufferProcessor&&t.uniformBufferRegexp&&t.uniformBufferRegexp.test(this.line))w.lookForClosingBracketForUniformBuffer||(q=t.uniformBufferProcessor(this.line,w.isFragment,w.processingContext),w.lookForClosingBracketForUniformBuffer=!0);else if(t.textureProcessor&&t.textureRegexp&&t.textureRegexp.test(this.line))q=t.textureProcessor(this.line,w.isFragment,g,w.processingContext);else if((t.uniformProcessor||t.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!w.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?t.uniformProcessor&&(q=t.uniformProcessor(this.line,w.isFragment,g,w.processingContext)):t.uniformBufferProcessor&&(q=t.uniformBufferProcessor(this.line,w.isFragment,w.processingContext),w.lookForClosingBracketForUniformBuffer=!0)}w.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(w.lookForClosingBracketForUniformBuffer=!1,t.endOfUniformBufferProcessor&&(q=t.endOfUniformBufferProcessor(this.line,w.isFragment,w.processingContext)))}R+=q+"\n"}for(const t of this.children)R+=t.process(g,w,q);return this.additionalDefineKey&&(g[this.additionalDefineKey]=this.additionalDefineValue||"true",q[this.additionalDefineKey]=g[this.additionalDefineKey]),R}}class o{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(g){this._lines.length=0;for(const w of g){if(!w||"\r"===w)continue;if("#"===w[0]){this._lines.push(w);continue}const g=w.trim();if(!g)continue;if(g.startsWith("//")){this._lines.push(w);continue}const q=g.indexOf(";");if(-1===q)this._lines.push(g);else if(q===g.length-1)g.length>1&&this._lines.push(g);else{const g=w.split(";");for(let w=0;w<g.length;w++){let q=g[w];q&&(q=q.trim(),q&&this._lines.push(q+(w!==g.length-1?";":"")))}}}}}class r extends R{process(g,w,q){for(let R=0;R<this.children.length;R++){const o=this.children[R];if(o.isValid(g))return o.process(g,w,q)}return""}}class S extends R{isValid(g){return this.testExpression.isTrue(g)}}class i{isTrue(g){return!0}static postfixToInfix(g){const w=[];for(const q of g)if(void 0===i._OperatorPriority[q])w.push(q);else{const g=w[w.length-1],R=w[w.length-2];w.length-=2,w.push(`(${R}${q}${g})`)}return w[w.length-1]}static infixToPostfix(g){const w=i._InfixToPostfixCache.get(g);if(w)return w.accessTime=Date.now(),w.result;if(!g.includes("&&")&&!g.includes("||")&&!g.includes(")")&&!g.includes("("))return[g];const q=[];let R=-1;const o=()=>{t=t.trim(),""!==t&&(q.push(t),t="")},r=g=>{R<i._Stack.length-1&&(i._Stack[++R]=g)},S=()=>i._Stack[R],T=()=>-1===R?"!!INVALID EXPRESSION!!":i._Stack[R--];let z=0,t="";for(;z<g.length;){const w=g.charAt(z),m=z<g.length-1?g.substring(z,2+z):"";if("("===w)t="",r(w);else if(")"===w){for(o();-1!==R&&"("!==S();)q.push(T());T()}else if(i._OperatorPriority[m]>1){for(o();-1!==R&&i._OperatorPriority[S()]>=i._OperatorPriority[m];)q.push(T());r(m),z++}else t+=w;z++}for(o();-1!==R;)"("===S()?T():q.push(T());return i._InfixToPostfixCache.size>=i.InfixToPostfixCacheLimitSize&&i.ClearCache(),i._InfixToPostfixCache.set(g,{result:q,accessTime:Date.now()}),q}static ClearCache(){const g=Array.from(i._InfixToPostfixCache.entries()).sort(((g,w)=>g[1].accessTime-w[1].accessTime));for(let w=0;w<i.InfixToPostfixCacheCleanupSize;w++)i._InfixToPostfixCache.delete(g[w][0])}}i.InfixToPostfixCacheLimitSize=5e4,i.InfixToPostfixCacheCleanupSize=25e3,i._InfixToPostfixCache=new Map,i._OperatorPriority={")":0,"(":1,"||":2,"&&":3},i._Stack=["","","","","","","","","","","","","","","","","","","",""];class T extends i{constructor(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=g,this.not=w}isTrue(g){let w=void 0!==g[this.define];return this.not&&(w=!w),w}}class z extends i{isTrue(g){return this.leftOperand.isTrue(g)||this.rightOperand.isTrue(g)}}class t extends i{isTrue(g){return this.leftOperand.isTrue(g)&&this.rightOperand.isTrue(g)}}class m extends i{constructor(g,w,q){super(),this.define=g,this.operand=w,this.testValue=q}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(g){let w=!1;const q=parseInt(void 0!=g[this.define]?g[this.define]:this.define),R=parseInt(void 0!=g[this.testValue]?g[this.testValue]:this.testValue);if(isNaN(q)||isNaN(R))return!1;switch(this.operand){case">":w=q>R;break;case"<":w=q<R;break;case"<=":w=q<=R;break;case">=":w=q>=R;break;case"==":w=q===R;break;case"!=":w=q!==R}return w}}var e=q(11029),y=q(11068);const L=/defined\s*?\((.+?)\)/g,A=/defined\s*?\[(.+?)\]/g,l=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,J=/__decl__/,x=/light\{X\}.(\w*)/g,G=/\{X\}/g,d=[],D=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function U(g){g.processor&&g.processor.initializeShaders&&g.processor.initializeShaders(g.processingContext)}function N(g,w,q,R){var o;null!==(o=w.processor)&&void 0!==o&&o.preProcessShaderCode&&(g=w.processor.preProcessShaderCode(g,w.isFragment)),V(g,w,(g=>{w.processCodeAfterIncludes&&(g=w.processCodeAfterIncludes(w.isFragment?"fragment":"vertex",g,w.defines));const o=function(g,w,q){let R=function(g,w){var q;if(null!==(q=w.processor)&&void 0!==q&&q.noPrecision)return g;const R=w.shouldUseHighPrecisionShader;-1===g.indexOf("precision highp float")?g=R?"precision highp float;\n"+g:"precision mediump float;\n"+g:R||(g=g.replace("precision highp float","precision mediump float"));return g}(g,w);if(!w.processor)return R;if(0===w.processor.shaderLanguage&&-1!==R.indexOf("#version 3")&&(R=R.replace("#version 300 es",""),!w.processor.parseGLES3))return R;const o=w.defines,r=M(w,q);w.processor.preProcessor&&(R=w.processor.preProcessor(R,o,r,w.isFragment,w.processingContext));const S={};R=j(R,r,w,S),w.processor.postProcessor&&(R=w.processor.postProcessor(R,o,w.isFragment,w.processingContext,q?{drawBuffersExtensionDisabled:!q.getCaps().drawBuffersExtension}:{},r,S));null!==q&&void 0!==q&&q._features.needShaderCodeInlining&&(R=q.inlineShaderCode(R));return R}(g,w,R);q(o,g)}))}function a(g,w,q){return q.processor&&q.processor.finalizeShaders?q.processor.finalizeShaders(g,w,q.processingContext):{vertexCode:g,fragmentCode:w}}function H(g){const w=/defined\((.+)\)/.exec(g);if(w&&w.length)return new T(w[1].trim(),"!"===g[0]);const q=["==","!=",">=","<=","<",">"];let R="",o=0;for(R of q)if(o=g.indexOf(R),o>-1)break;if(-1===o)return new T(g);const r=g.substring(0,o).trim(),S=g.substring(o+R.length).trim();return new m(r,R,S)}function C(g,w){const q=new S,R=g.substring(0,w);let o=g.substring(w);return o=o.substring(0,(o.indexOf("//")+1||o.length+1)-1).trim(),q.testExpression="#ifdef"===R?new T(o):"#ifndef"===R?new T(o,!0):function(g){g=g.replace(L,"defined[$1]");const w=i.infixToPostfix(g),q=[];for(const o of w)if("||"!==o&&"&&"!==o)q.push(o);else if(q.length>=2){let g=q[q.length-1],w=q[q.length-2];q.length-=2;const R="&&"==o?new t:new z;"string"===typeof g&&(g=g.replace(A,"defined($1)")),"string"===typeof w&&(w=w.replace(A,"defined($1)")),R.leftOperand="string"===typeof w?H(w):w,R.rightOperand="string"===typeof g?H(g):g,q.push(R)}let R=q[q.length-1];return"string"===typeof R&&(R=R.replace(A,"defined($1)")),"string"===typeof R?H(R):R}(o),q}function c(g,w,q,o){let r=g.currentLine;for(;P(g,q,o);){r=g.currentLine;const S=r.substring(0,5).toLowerCase();if("#else"===S){const q=new R;return w.children.push(q),void P(g,q,o)}if("#elif"===S){const g=C(r,5);w.children.push(g),q=g}}}function P(g,w,q){for(;g.canRead;){g.lineIndex++;const o=g.currentLine;if(o.indexOf("#")>=0){const R=D.exec(o);if(R&&R.length){switch(R[0]){case"#ifdef":{const R=new r;w.children.push(R);const S=C(o,6);R.children.push(S),c(g,R,S,q);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const R=new r;w.children.push(R);const S=C(o,7);R.children.push(S),c(g,R,S,q);break}case"#if":{const R=new r,S=C(o,3);w.children.push(R),R.children.push(S),c(g,R,S,q);break}}continue}}const S=new R;if(S.line=o,w.children.push(S),"#"===o[0]&&"d"===o[1]){const g=o.replace(";","").split(" ");S.additionalDefineKey=g[1],3===g.length&&(S.additionalDefineValue=g[2])}}return!1}function j(g,w,q,r){const S=new R,i=new o;return i.lineIndex=-1,i.lines=g.split("\n"),P(i,S,r),S.process(w,q,r)}function M(g,w){var q;const R=g.defines,o={};for(const r of R){const g=r.replace("#define","").replace(";","").trim().split(" ");o[g[0]]=g.length>1?g[1]:""}return 0===(null===(q=g.processor)||void 0===q?void 0:q.shaderLanguage)&&(o.GL_ES="true"),o.__VERSION__=g.version,o[g.platformName]="true",(0,y.j)(o,null===w||void 0===w?void 0:w.isNDCHalfZRange,null===w||void 0===w?void 0:w.useReverseDepthBuffer,null===w||void 0===w?void 0:w.useExactSrgbConversions),o}function V(g,w,q){let R;for(d.length=0;null!==(R=l.exec(g));)d.push(R);let o=String(g),r=[g],S=!1;for(const i of d){let g=i[1];if(-1!==g.indexOf("__decl__")&&(g=g.replace(J,""),w.supportsUniformBuffers&&(g=g.replace("Vertex","Ubo").replace("Fragment","Ubo")),g+="Declaration"),!w.includesShadersStore[g]){const R=w.shadersRepository+"ShadersInclude/"+g+".fx";return void s.loadFile(R,(R=>{w.includesShadersStore[g]=R,V(r.join(""),w,q)}))}{let q=w.includesShadersStore[g];if(i[2]){const g=i[3].split(",");for(let w=0;w<g.length;w+=2){const R=new RegExp(g[w],"g"),o=g[w+1];q=q.replace(R,o)}}if(i[4]){const g=i[5];if(-1!==g.indexOf("..")){const R=g.split(".."),o=parseInt(R[0]);let r=parseInt(R[1]),S=q.slice(0);q="",isNaN(r)&&(r=w.indexParameters[R[1]]);for(let g=o;g<r;g++)w.supportsUniformBuffers||(S=S.replace(x,((g,w)=>w+"{X}"))),q+=S.replace(G,g.toString())+"\n"}else w.supportsUniformBuffers||(q=q.replace(x,((g,w)=>w+"{X}"))),q=q.replace(G,g)}const R=[];for(const g of r){const w=g.split(i[0]);for(let g=0;g<w.length-1;g++)R.push(w[g]),R.push(q);R.push(w[w.length-1])}r=R,S=S||q.indexOf("#include<")>=0||q.indexOf("#include <")>=0}}d.length=0,o=r.join(""),S?V(o.toString(),w,q):q(o)}const s={loadFile:(g,w,q,R,o,r)=>{throw(0,e.b)("FileTools")}}},11068:(g,w,q)=>{q.d(w,{c:()=>o,g:()=>r,j:()=>i,n:()=>S,p:()=>T});var R=q(11029);q(11007);const o={};function r(g,w){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(w?w+"\n":"")+g}function S(g,w,q,r,S,i,T){const z=T||o.loadFile;if(z){return z(g,w,q,r,S,i)}throw(0,R.b)("FileTools")}function i(g,w,q,R){if(g)return w?g.IS_NDC_HALF_ZRANGE="":delete g.IS_NDC_HALF_ZRANGE,q?g.USE_REVERSE_DEPTHBUFFER="":delete g.USE_REVERSE_DEPTHBUFFER,void(R?g.USE_EXACT_SRGB_CONVERSIONS="":delete g.USE_EXACT_SRGB_CONVERSIONS);{let g="";return w&&(g+="#define IS_NDC_HALF_ZRANGE"),q&&(g&&(g+="\n"),g+="#define USE_REVERSE_DEPTHBUFFER"),R&&(g&&(g+="\n"),g+="#define USE_EXACT_SRGB_CONVERSIONS"),g}}function T(g,w){let q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],R=arguments.length>3?arguments[3]:void 0;switch(g){case 3:{const g=(ArrayBuffer,new Int8Array(w));return R&&g.set(new Int8Array(R)),g}case 0:{const g=(ArrayBuffer,new Uint8Array(w));return R&&g.set(new Uint8Array(R)),g}case 4:{const g=w instanceof ArrayBuffer?new Int16Array(w):new Int16Array(q?w/2:w);return R&&g.set(new Int16Array(R)),g}case 5:case 8:case 9:case 10:case 2:{const g=w instanceof ArrayBuffer?new Uint16Array(w):new Uint16Array(q?w/2:w);return R&&g.set(new Uint16Array(R)),g}case 6:{const g=w instanceof ArrayBuffer?new Int32Array(w):new Int32Array(q?w/4:w);return R&&g.set(new Int32Array(R)),g}case 7:case 11:case 12:case 13:case 14:case 15:{const g=w instanceof ArrayBuffer?new Uint32Array(w):new Uint32Array(q?w/4:w);return R&&g.set(new Uint32Array(R)),g}case 1:{const g=w instanceof ArrayBuffer?new Float32Array(w):new Float32Array(q?w/4:w);return R&&g.set(new Float32Array(R)),g}}const o=(ArrayBuffer,new Uint8Array(w));return R&&o.set(new Uint8Array(R)),o}},11081:(g,w,q)=>{q.d(w,{d:()=>R});class R{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?R.ShadersRepository:R.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?R.ShadersStore:R.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?R.IncludesShadersStore:R.IncludesShadersStoreWGSL}}R.ShadersRepository="src/Shaders/",R.ShadersStore={},R.IncludesShadersStore={},R.ShadersRepositoryWGSL="src/ShadersWGSL/",R.ShadersStoreWGSL={},R.IncludesShadersStoreWGSL={}},11096:(g,w,q)=>{q.d(w,{e:()=>e,h:()=>G,l:()=>L,n:()=>y,p:()=>A,t:()=>x,v:()=>m,w:()=>z,y:()=>t,z:()=>T,A:()=>i});class R{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.mw._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(g){g&&this.program&&g(this.program)}setEngine(g){this.mw=g}_fillEffectInformation(g,w,q,R,o,r,S,i){const T=this.mw;if(T.supportsUniformBuffers)for(const t in w)g.bindUniformBlock(t,w[t]);let z;for(this.mw.getUniforms(this,q).forEach(((g,w)=>{R[q[w]]=g})),this._uniforms=R,z=0;z<o.length;z++){null==g.getUniform(o[z])&&(o.splice(z,1),z--)}o.forEach(((g,w)=>{r[g]=w}));for(const t of T.getAttributes(this,S))i.push(t)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(g,w){const q=this._valueCache[g],R=w.updateFlag;return(void 0===q||q!==R)&&(this._valueCache[g]=R,!0)}_cacheFloat2(g,w,q){let R=this._valueCache[g];if(!R||2!==R.length)return R=[w,q],this._valueCache[g]=R,!0;let o=!1;return R[0]!==w&&(R[0]=w,o=!0),R[1]!==q&&(R[1]=q,o=!0),o}_cacheFloat3(g,w,q,R){let o=this._valueCache[g];if(!o||3!==o.length)return o=[w,q,R],this._valueCache[g]=o,!0;let r=!1;return o[0]!==w&&(o[0]=w,r=!0),o[1]!==q&&(o[1]=q,r=!0),o[2]!==R&&(o[2]=R,r=!0),r}_cacheFloat4(g,w,q,R,o){let r=this._valueCache[g];if(!r||4!==r.length)return r=[w,q,R,o],this._valueCache[g]=r,!0;let S=!1;return r[0]!==w&&(r[0]=w,S=!0),r[1]!==q&&(r[1]=q,S=!0),r[2]!==R&&(r[2]=R,S=!0),r[3]!==o&&(r[3]=o,S=!0),S}setInt(g,w){const q=this._valueCache[g];void 0!==q&&q===w||this.mw.setInt(this._uniforms[g],w)&&(this._valueCache[g]=w)}setInt2(g,w,q){this._cacheFloat2(g,w,q)&&(this.mw.setInt2(this._uniforms[g],w,q)||(this._valueCache[g]=null))}setInt3(g,w,q,R){this._cacheFloat3(g,w,q,R)&&(this.mw.setInt3(this._uniforms[g],w,q,R)||(this._valueCache[g]=null))}setInt4(g,w,q,R,o){this._cacheFloat4(g,w,q,R,o)&&(this.mw.setInt4(this._uniforms[g],w,q,R,o)||(this._valueCache[g]=null))}setIntArray(g,w){this._valueCache[g]=null,this.mw.setIntArray(this._uniforms[g],w)}setIntArray2(g,w){this._valueCache[g]=null,this.mw.setIntArray2(this._uniforms[g],w)}setIntArray3(g,w){this._valueCache[g]=null,this.mw.setIntArray3(this._uniforms[g],w)}setIntArray4(g,w){this._valueCache[g]=null,this.mw.setIntArray4(this._uniforms[g],w)}setUInt(g,w){const q=this._valueCache[g];void 0!==q&&q===w||this.mw.setUInt(this._uniforms[g],w)&&(this._valueCache[g]=w)}setUInt2(g,w,q){this._cacheFloat2(g,w,q)&&(this.mw.setUInt2(this._uniforms[g],w,q)||(this._valueCache[g]=null))}setUInt3(g,w,q,R){this._cacheFloat3(g,w,q,R)&&(this.mw.setUInt3(this._uniforms[g],w,q,R)||(this._valueCache[g]=null))}setUInt4(g,w,q,R,o){this._cacheFloat4(g,w,q,R,o)&&(this.mw.setUInt4(this._uniforms[g],w,q,R,o)||(this._valueCache[g]=null))}setUIntArray(g,w){this._valueCache[g]=null,this.mw.setUIntArray(this._uniforms[g],w)}setUIntArray2(g,w){this._valueCache[g]=null,this.mw.setUIntArray2(this._uniforms[g],w)}setUIntArray3(g,w){this._valueCache[g]=null,this.mw.setUIntArray3(this._uniforms[g],w)}setUIntArray4(g,w){this._valueCache[g]=null,this.mw.setUIntArray4(this._uniforms[g],w)}setArray(g,w){this._valueCache[g]=null,this.mw.setArray(this._uniforms[g],w)}setArray2(g,w){this._valueCache[g]=null,this.mw.setArray2(this._uniforms[g],w)}setArray3(g,w){this._valueCache[g]=null,this.mw.setArray3(this._uniforms[g],w)}setArray4(g,w){this._valueCache[g]=null,this.mw.setArray4(this._uniforms[g],w)}setMatrices(g,w){w&&(this._valueCache[g]=null,this.mw.setMatrices(this._uniforms[g],w))}setMatrix(g,w){this._cacheMatrix(g,w)&&(this.mw.setMatrices(this._uniforms[g],w.qi())||(this._valueCache[g]=null))}setMatrix3x3(g,w){this._valueCache[g]=null,this.mw.setMatrix3x3(this._uniforms[g],w)}setMatrix2x2(g,w){this._valueCache[g]=null,this.mw.setMatrix2x2(this._uniforms[g],w)}setFloat(g,w){const q=this._valueCache[g];void 0!==q&&q===w||this.mw.setFloat(this._uniforms[g],w)&&(this._valueCache[g]=w)}setVector2(g,w){this._cacheFloat2(g,w.x,w.y)&&(this.mw.setFloat2(this._uniforms[g],w.x,w.y)||(this._valueCache[g]=null))}setFloat2(g,w,q){this._cacheFloat2(g,w,q)&&(this.mw.setFloat2(this._uniforms[g],w,q)||(this._valueCache[g]=null))}setVector3(g,w){this._cacheFloat3(g,w.x,w.y,w.z)&&(this.mw.setFloat3(this._uniforms[g],w.x,w.y,w.z)||(this._valueCache[g]=null))}setFloat3(g,w,q,R){this._cacheFloat3(g,w,q,R)&&(this.mw.setFloat3(this._uniforms[g],w,q,R)||(this._valueCache[g]=null))}setVector4(g,w){this._cacheFloat4(g,w.x,w.y,w.z,w.w)&&(this.mw.setFloat4(this._uniforms[g],w.x,w.y,w.z,w.w)||(this._valueCache[g]=null))}setQuaternion(g,w){this._cacheFloat4(g,w.x,w.y,w.z,w.w)&&(this.mw.setFloat4(this._uniforms[g],w.x,w.y,w.z,w.w)||(this._valueCache[g]=null))}setFloat4(g,w,q,R,o){this._cacheFloat4(g,w,q,R,o)&&(this.mw.setFloat4(this._uniforms[g],w,q,R,o)||(this._valueCache[g]=null))}setColor3(g,w){this._cacheFloat3(g,w.r,w.g,w.b)&&(this.mw.setFloat3(this._uniforms[g],w.r,w.g,w.b)||(this._valueCache[g]=null))}setColor4(g,w,q){this._cacheFloat4(g,w.r,w.g,w.b,q)&&(this.mw.setFloat4(this._uniforms[g],w.r,w.g,w.b,q)||(this._valueCache[g]=null))}setDirectColor4(g,w){this._cacheFloat4(g,w.r,w.g,w.b,w.a)&&(this.mw.setFloat4(this._uniforms[g],w.r,w.g,w.b,w.a)||(this._valueCache[g]=null))}_getVertexShaderCode(){return this.vertexShader?this.mw._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.mw._getShaderSource(this.fragmentShader):null}}var o=q(11068);const r=new WeakMap,S={_webGLVersion:2,cachedPipelines:{}};function i(g){let w=r.get(g);if(!w){if(!g)return S;w={_webGLVersion:g.TEXTURE_BINDING_3D?2:1,_context:g,parallelShaderCompile:g.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},r.set(g,w)}return w}function T(g){r.delete(g)}function z(g,w,q,R,o,r){const S=i(R);r||(r=S._createShaderProgramInjection??e);return r(g,J(w,"vertex",R,S._contextWasLost),J(q,"fragment",R,S._contextWasLost),R,o,S.validateShaderPrograms)}function t(g,w,q,R,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,S=arguments.length>6?arguments[6]:void 0;const T=i(o);S||(S=T._createShaderProgramInjection??e);const z=T._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return S(g,l(w,"vertex",R,z,o,T._contextWasLost),l(q,"fragment",R,z,o,T._contextWasLost),o,r,T.validateShaderPrograms)}function m(g,w){const q=new R,o=i(g);return o.parallelShaderCompile&&!o.disableParallelShaderCompile&&(q.isParallelCompiled=!0),q.context=o._context,q}function e(g,w,q,R){let o=arguments.length>5?arguments[5]:void 0;const r=R.createProgram();if(g.program=r,!r)throw new Error("Unable to create program");return R.attachShader(r,w),R.attachShader(r,q),R.linkProgram(r),g.context=R,g.vertexShader=w,g.fragmentShader=q,g.isParallelCompiled||L(g,R,o),r}function y(g,w,q){const R=g;if(R._isDisposed)return!1;const o=i(w);return!!(o&&o.parallelShaderCompile&&o.parallelShaderCompile.COMPLETION_STATUS_KHR&&R.program&&w.getProgramParameter(R.program,o.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(L(R,w,q),!0)}function L(g,w,q){const R=g.context,o=g.vertexShader,r=g.fragmentShader,S=g.program;if(!R.getProgramParameter(S,R.LINK_STATUS)){if(!w.getShaderParameter(o,w.COMPILE_STATUS)){const q=w.getShaderInfoLog(o);if(q)throw g.vertexCompilationError=q,new Error("VERTEX SHADER "+q)}if(!w.getShaderParameter(r,w.COMPILE_STATUS)){const q=w.getShaderInfoLog(r);if(q)throw g.fragmentCompilationError=q,new Error("FRAGMENT SHADER "+q)}const q=R.getProgramInfoLog(S);if(q)throw g.programLinkError=q,new Error(q)}if(q){R.validateProgram(S);if(!R.getProgramParameter(S,R.VALIDATE_STATUS)){const w=R.getProgramInfoLog(S);if(w)throw g.programValidationError=w,new Error(w)}}R.deleteShader(o),R.deleteShader(r),g.vertexShader=void 0,g.fragmentShader=void 0,g.onCompiled&&(g.onCompiled(),g.onCompiled=void 0)}function A(g,w,q,R,o,r,S,T,m){let e=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0,L=arguments.length>12?arguments[12]:void 0;const A=i(g.context);y||(y=A.createRawShaderProgramInjection??z),L||(L=A.createShaderProgramInjection??t);const l=g;l.program=R?y(l,w,q,l.context,m):L(l,w,q,T,l.context,m),l.program.__SPECTOR_rebuildProgram=S,e()}function l(g,w,q,R,r,S){return J((0,o.g)(g,q,R),w,r,S)}function J(g,w,q,R){const o=q.createShader("vertex"===w?q.VERTEX_SHADER:q.FRAGMENT_SHADER);if(!o){let g=q.NO_ERROR,o=q.NO_ERROR;for(;(o=q.getError())!==q.NO_ERROR;)g=o;throw new Error(`Something went wrong while creating a gl ${w} shader object. gl error=${g}, gl isContextLost=${q.isContextLost()}, _contextWasLost=${R}`)}return q.shaderSource(o,g),q.compileShader(o),o}function x(g,w){w.useProgram(g)}function G(g,w){const q=g;if(!q.isParallelCompiled)return void w(g);const R=q.onCompiled;q.onCompiled=()=>{null===R||void 0===R||R(),w(g)}}},11090:(g,w,q)=>{q.d(w,{c:()=>m,g:()=>y,k:()=>z,m:()=>t});var R=q(11007),o=q(11096),r=q(11081),S=q(11011),i=q(11062),T=q(11068);function z(g,w){return(0,o.A)(w).cachedPipelines[g]}function t(g){const w=g._name,q=g.context;if(w&&q){const g=(0,o.A)(q),R=g.cachedPipelines[w];null===R||void 0===R||R.dispose(),delete g.cachedPipelines[w]}}function m(g,w,q,o,r,S,T){let z,t;const m=(0,R.m)()?null===S||void 0===S?void 0:S.getHostDocument():null;z="string"===typeof w?w:w.vertexSource?"source:"+w.vertexSource:w.vertexElement?(null===m||void 0===m?void 0:m.getElementById(w.vertexElement))||w.vertexElement:w.vertex||w,t="string"===typeof w?w:w.fragmentSource?"source:"+w.fragmentSource:w.fragmentElement?(null===m||void 0===m?void 0:m.getElementById(w.fragmentElement))||w.fragmentElement:w.fragment||w;const y=[void 0,void 0],L=()=>{if(y[0]&&y[1]){g.isFragment=!0;const[R,z]=y;(0,i.l)(z,g,((S,z)=>{T&&(T._fragmentSourceCodeBeforeMigration=z),q&&(S=q("fragment",S));const t=(0,i.e)(R,S,g);g=null;const m=function(g,w,q,R){if(q){return{vertexSourceCode:(1===R?"//":"")+"#define SHADER_NAME vertex:"+(q.vertexElement||q.vertex||q.spectorName||q)+"\n"+g,fragmentSourceCode:(1===R?"//":"")+"#define SHADER_NAME fragment:"+(q.fragmentElement||q.fragment||q.spectorName||q)+"\n"+w}}return{vertexSourceCode:g,fragmentSourceCode:w}}(t.vertexCode,t.fragmentCode,w,r);null===o||void 0===o||o(m.vertexSourceCode,m.fragmentSourceCode)}),S)}};e(z,"Vertex","",(w=>{(0,i.g)(g),(0,i.l)(w,g,((g,R)=>{T&&(T._rawVertexSourceCode=w,T._vertexSourceCodeBeforeMigration=R),q&&(g=q("vertex",g)),y[0]=g,L()}),S)}),r),e(t,"Fragment","Pixel",(g=>{T&&(T._rawFragmentSourceCode=g),y[1]=g,L()}),r)}function e(g,w,q,o,S,i){if("undefined"!==typeof HTMLElement&&g instanceof HTMLElement){return void o((0,R.d)(g))}if("source:"===g.substring(0,7))return void o(g.substring(7));if("base64:"===g.substring(0,7)){return void o(window.atob(g.substring(7)))}const z=r.d.GetShadersStore(S);if(z[g+w+"Shader"])return void o(z[g+w+"Shader"]);if(q&&z[g+q+"Shader"])return void o(z[g+q+"Shader"]);let t;if(t="."===g[0]||"/"===g[0]||g.indexOf("http")>-1?g:r.d.GetShadersRepository(S)+g,!(i=i||T.n))throw new Error("loadFileInjection is not defined");i(t+"."+w.toLowerCase()+".fx",o)}const y=(g,w,q,R)=>{try{const r=g.context?(0,o.A)(g.context):null;r&&(r.disableParallelShaderCompile=g.disableParallelCompilation);const S=g.existingPipelineContext||w(g.shaderProcessingContext);return S._name=g.name,g.name&&r&&(r.cachedPipelines[g.name]=S),q(S,g.vertex,g.fragment,!!g.createAsRaw,"","",g.rebuildRebind,g.defines,g.transformFeedbackVaryings,"",(()=>{R(S,(()=>{var w;null===(w=g.onRenderingStateCompiled)||void 0===w||w.call(g,S)}))})),S}catch(r){throw S.d.Error("Error compiling effect"),r}}},11076:(g,w,q)=>{q.r(w),q.d(w,{Effect:()=>T});var R=q(10998),o=q(11011),r=q(11081),S=q(11090),i=q(11071);class T{static get ShadersRepository(){return r.d.ShadersRepository}static set ShadersRepository(g){r.d.ShadersRepository=g}get L(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new R.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(g,w,q){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,z=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,t=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,e=arguments.length>9?arguments[9]:void 0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",L=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,A=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new R.b,this.onErrorObservable=new R.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=g,this._key=y;const l=this._key.replace(/\r/g,"").replace(/\n/g,"|");let J;if(w.attributes){const g=w;if(this._engine=q,this._attributesNames=g.attributes,this._uniformsNames=g.uniformsNames.concat(g.samplers),this._samplerList=g.samplers.slice(),this.defines=g.defines,this.onError=g.onError,this.onCompiled=g.onCompiled,this._fallbacks=g.fallbacks,this._indexParameters=g.indexParameters,this._transformFeedbackVaryings=g.transformFeedbackVaryings||null,this._multiTarget=!!g.multiTarget,this._shaderLanguage=g.shaderLanguage??0,this._disableParallelShaderCompilation=!!g.disableParallelShaderCompilation,g.uniformBuffersNames){this._uniformBuffersNamesList=g.uniformBuffersNames.slice();for(let w=0;w<g.uniformBuffersNames.length;w++)this._uniformBuffersNames[g.uniformBuffersNames[w]]=w}this._processFinalCode=g.processFinalCode??null,this._processCodeAfterIncludes=g.processCodeAfterIncludes??void 0,A=g.extraInitializationsAsync,J=g.existingPipelineContext}else this._engine=r,this.defines=null==i?"":i,this._uniformsNames=q.concat(o),this._samplerList=o?o.slice():[],this._attributesNames=w,this._uniformBuffersNamesList=[],this._shaderLanguage=L,this.onError=m,this.onCompiled=t,this._indexParameters=e,this._fallbacks=z;"WEBGL2"===this._engine.shaderPlatformName&&(J=(0,S.k)(l,this._engine._gl)??J),this._attributeLocationByName={},this.uniqueId=T._UniqueIdSeed++,J?(this._pipelineContext=J,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,A),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.L||this.dispose(!0)}))}async _processShaderCodeAsync(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,R=arguments.length>3?arguments[3]:void 0;R&&await R(),this._processingContext=q||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const o={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:g??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:r.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:r.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,S.c)(o,this.name,this._processFinalCode,((g,q)=>{this._vertexSourceCode=g,this._fragmentSourceCode=q,this._prepareEffect(w)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.L||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(g){return this._attributes[g]}getAttributeLocationByName(g){return this._attributeLocationByName[g]}getAttributesCount(){return this._attributes.length}getUniformIndex(g){return this._uniformsNames.indexOf(g)}getUniform(g){return this._uniforms[g]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((g=>{this.executeWhenCompiled(g)}))}executeWhenCompiled(g){this.isReady()?g(this):(this.onCompileObservable.add((w=>{g(w)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(g){(0,i.h)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(w=>{this._processCompilationErrors(w,g)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var g;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(g=this._pipelineContext)||void 0===g?void 0:g._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var g;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(g=this._pipelineContext)||void 0===g?void 0:g._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(g,w,q,R){this._isReady=!1,this._vertexSourceCodeOverride=g,this._fragmentSourceCodeOverride=w,this.onError=(g,w)=>{R&&R(w)},this.onCompiled=()=>{var g,w;const R=this.getEngine().scenes;if(R)for(let q=0;q<R.length;q++)R[q].markAllMaterialsAsDirty(127);null===(g=(w=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===g||g.call(w,q)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(g){if(this._pipelineContext=g,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let w=0;w<this._attributesNames.length;w++){const g=this._attributesNames[w];this._attributeLocationByName[g]=this._attributes[w]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),T.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const w=this._pipelineContext;this._isReady=!1;try{const q=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),R=q?null:this.defines,o=q?this._vertexSourceCodeOverride:this._vertexSourceCode,r=q?this._fragmentSourceCodeOverride:this._fragmentSourceCode,i=this._engine;this._pipelineContext=(0,S.g)({existingPipelineContext:g?w:null,vertex:o,fragment:r,context:"WEBGL2"===i.shaderPlatformName||"WEBGL1"===i.shaderPlatformName?i._gl:void 0,rebuildRebind:(g,w,q,R)=>this._rebuildProgram(g,w,q,R),defines:R,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:q,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:q=>{w&&!g&&this._engine._deletePipelineContext(w),q&&this._onRenderingStateCompiled(q)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(w)}catch(q){this._processCompilationErrors(q,w)}}_getShaderCodeAndErrorLine(g,w,q){const R=q?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let o=null;if(w&&g){const r=w.match(R);if(r&&2===r.length){const w=parseInt(r[1]),R=g.split("\n",-1);R.length>=w&&(o=`Offending line [${w}] in ${q?"fragment":"vertex"} code: ${R[w-1]}`)}}return[g,o]}_processCompilationErrors(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=g.message;const q=this._attributesNames,R=this._fallbacks;if(o.d.Error("Unable to compile effect:"),o.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),o.d.Error(`Attributes: ${q.join(" ")}`),o.d.Error("Defines:\n"+this.defines),T.LogShaderCodeOnCompilationError){var r,S;let g=null,w=null,q=null;var i;if(null!==(r=this._pipelineContext)&&void 0!==r&&r._getVertexShaderCode()&&([q,g]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),q&&(o.d.Error("Vertex code:"),o.d.Error(q))),null!==(S=this._pipelineContext)&&void 0!==S&&S._getFragmentShaderCode())[q,w]=this._getShaderCodeAndErrorLine(null===(i=this._pipelineContext)||void 0===i?void 0:i._getFragmentShaderCode(),this._compilationError,!0),q&&(o.d.Error("Fragment code:"),o.d.Error(q));g&&o.d.Error(g),w&&o.d.Error(w)}o.d.Error("Error: "+this._compilationError);const z=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};w&&(this._pipelineContext=w,this._isReady=!0,z()),R?(this._pipelineContext=null,R.hasMoreFallbacks?(this._allFallbacksProcessed=!1,o.d.Error("Trying next fallback."),this.defines=R.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,z(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,w||z())}get isSupported(){return""===this._compilationError}_bindTexture(g,w){this._engine._bindTexture(this._samplers[g],w,g)}setTexture(g,w){this._engine.setTexture(this._samplers[g],this._uniforms[g],w,g)}setTextureArray(g,w){const q=g+"Ex";if(-1===this._samplerList.indexOf(q+"0")){const R=this._samplerList.indexOf(g);for(let g=1;g<w.length;g++){const w=q+(g-1).toString();this._samplerList.splice(R+g,0,w)}let o=0;for(const g of this._samplerList)this._samplers[g]=o,o+=1}this._engine.setTextureArray(this._samplers[g],this._uniforms[g],w,g)}bindUniformBuffer(g,w){const q=this._uniformBuffersNames[w];void 0===q||T._BaseCache[q]===g&&this._engine._features.useUBOBindingCache||(T._BaseCache[q]=g,this._engine.bindUniformBufferBase(g,q,w))}bindUniformBlock(g,w){this._engine.bindUniformBlock(this._pipelineContext,g,w)}setInt(g,w){return this._pipelineContext.setInt(g,w),this}setInt2(g,w,q){return this._pipelineContext.setInt2(g,w,q),this}setInt3(g,w,q,R){return this._pipelineContext.setInt3(g,w,q,R),this}setInt4(g,w,q,R,o){return this._pipelineContext.setInt4(g,w,q,R,o),this}setIntArray(g,w){return this._pipelineContext.setIntArray(g,w),this}setIntArray2(g,w){return this._pipelineContext.setIntArray2(g,w),this}setIntArray3(g,w){return this._pipelineContext.setIntArray3(g,w),this}setIntArray4(g,w){return this._pipelineContext.setIntArray4(g,w),this}setUInt(g,w){return this._pipelineContext.setUInt(g,w),this}setUInt2(g,w,q){return this._pipelineContext.setUInt2(g,w,q),this}setUInt3(g,w,q,R){return this._pipelineContext.setUInt3(g,w,q,R),this}setUInt4(g,w,q,R,o){return this._pipelineContext.setUInt4(g,w,q,R,o),this}setUIntArray(g,w){return this._pipelineContext.setUIntArray(g,w),this}setUIntArray2(g,w){return this._pipelineContext.setUIntArray2(g,w),this}setUIntArray3(g,w){return this._pipelineContext.setUIntArray3(g,w),this}setUIntArray4(g,w){return this._pipelineContext.setUIntArray4(g,w),this}setFloatArray(g,w){return this._pipelineContext.setArray(g,w),this}setFloatArray2(g,w){return this._pipelineContext.setArray2(g,w),this}setFloatArray3(g,w){return this._pipelineContext.setArray3(g,w),this}setFloatArray4(g,w){return this._pipelineContext.setArray4(g,w),this}setArray(g,w){return this._pipelineContext.setArray(g,w),this}setArray2(g,w){return this._pipelineContext.setArray2(g,w),this}setArray3(g,w){return this._pipelineContext.setArray3(g,w),this}setArray4(g,w){return this._pipelineContext.setArray4(g,w),this}setMatrices(g,w){return this._pipelineContext.setMatrices(g,w),this}setMatrix(g,w){return this._pipelineContext.setMatrix(g,w),this}setMatrix3x3(g,w){return this._pipelineContext.setMatrix3x3(g,w),this}setMatrix2x2(g,w){return this._pipelineContext.setMatrix2x2(g,w),this}setFloat(g,w){return this._pipelineContext.setFloat(g,w),this}setBool(g,w){return this._pipelineContext.setInt(g,w?1:0),this}setVector2(g,w){return this._pipelineContext.setVector2(g,w),this}setFloat2(g,w,q){return this._pipelineContext.setFloat2(g,w,q),this}setVector3(g,w){return this._pipelineContext.setVector3(g,w),this}setFloat3(g,w,q,R){return this._pipelineContext.setFloat3(g,w,q,R),this}setVector4(g,w){return this._pipelineContext.setVector4(g,w),this}setQuaternion(g,w){return this._pipelineContext.setQuaternion(g,w),this}setFloat4(g,w,q,R,o){return this._pipelineContext.setFloat4(g,w,q,R,o),this}setColor3(g,w){return this._pipelineContext.setColor3(g,w),this}setColor4(g,w,q){return this._pipelineContext.setColor4(g,w,q),this}setDirectColor4(g,w){return this._pipelineContext.setDirectColor4(g,w),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(T.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,S.m)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(g,w,q){let R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;w&&(r.d.GetShadersStore(R)[`${g}PixelShader`]=w),q&&(r.d.GetShadersStore(R)[`${g}VertexShader`]=q)}static ResetCache(){T._BaseCache={}}}T.LogShaderCodeOnCompilationError=!0,T.PersistentMode=!1,T.AutomaticallyClearCodeCache=!1,T._UniqueIdSeed=0,T._BaseCache={},T.ShadersStore=r.d.ShadersStore,T.IncludesShadersStore=r.d.IncludesShadersStore},11029:(g,w,q)=>{q.d(w,{b:()=>o});const R={};function o(g){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!R[g])return R[g]=!0,`${g} needs to be imported before as it contains a side-effect required by your code.`}},11007:(g,w,q)=>{function R(){return"undefined"!==typeof window}function o(){return"undefined"!==typeof navigator}function r(){return"undefined"!==typeof document}function S(g){let w="",q=g.firstChild;for(;q;)3===q.nodeType&&(w+=q.textContent),q=q.nextSibling;return w}q.d(w,{d:()=>S,h:()=>r,j:()=>o,m:()=>R})},11011:(g,w,q)=>{q.d(w,{d:()=>R});class R{static _CheckLimit(g,w){let q=R._LogLimitOutputs[g];return q?q.current++:(q={limit:w,current:1},R._LogLimitOutputs[g]=q),q.current<=q.limit}static _GenerateLimitMessage(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const q=R._LogLimitOutputs[g];if(!q||!R.MessageLimitReached)return;const o=this._Levels[w];q.current===q.limit&&R[o.name](R.MessageLimitReached.replace(/%LIMIT%/g,""+q.limit).replace(/%TYPE%/g,o.name??""))}static _AddLogEntry(g){R._LogCache=g+R._LogCache,R.OnNewCacheEntry&&R.OnNewCacheEntry(g)}static _FormatMessage(g){const w=g=>g<10?"0"+g:""+g,q=new Date;return"["+w(q.getHours())+":"+w(q.getMinutes())+":"+w(q.getSeconds())+"]: "+g}static _LogDisabled(g,w){}static _LogEnabled(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,w=arguments.length>1?arguments[1]:void 0,q=arguments.length>2?arguments[2]:void 0;const o=Array.isArray(w)?w[0]:w;if(void 0!==q&&!R._CheckLimit(o,q))return;const r=R._FormatMessage(o),S=this._Levels[g],i=Array.isArray(w)?w.slice(1):[];S.logFunc&&S.logFunc("BJS - "+r,...i);const T=`<div style='color:${S.color}'>${r}</div><br>`;R._AddLogEntry(T),R._GenerateLimitMessage(o,g)}static get LogCache(){return R._LogCache}static ClearLogCache(){R._LogCache="",R._LogLimitOutputs={},R.errorsCount=0}static set LogLevels(g){R.Log=R._LogDisabled,R.Warn=R._LogDisabled,R.Error=R._LogDisabled;const w=[R.MessageLogLevel,R.WarningLogLevel,R.ErrorLogLevel];for(const q of w)if((g&q)===q){const g=this._Levels[q];R[g.name]=R._LogEnabled.bind(R,q)}}}R.NoneLogLevel=0,R.MessageLogLevel=1,R.WarningLogLevel=2,R.ErrorLogLevel=4,R.AllLogLevel=7,R.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",R._LogCache="",R._LogLimitOutputs={},R._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],R.errorsCount=0,R.Log=R._LogEnabled.bind(R,R.MessageLogLevel),R.Warn=R._LogEnabled.bind(R,R.WarningLogLevel),R.Error=R._LogEnabled.bind(R,R.ErrorLogLevel)},10998:(g,w,q)=>{q.d(w,{b:()=>S});const R="undefined"!==typeof WeakRef;class o{constructor(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],q=arguments.length>2?arguments[2]:void 0,R=arguments.length>3?arguments[3]:void 0;this.initialize(g,w,q,R)}initialize(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1],q=arguments.length>2?arguments[2]:void 0,R=arguments.length>3?arguments[3]:void 0;return this.mask=g,this.skipNextObservers=w,this.target=q,this.currentTarget=R,this}}class r{constructor(g,w){let q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=g,this.mask=w,this.scope=q,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(g)}}class S{static FromPromise(g,w){const q=new S;return g.then((g=>{q.notifyObservers(g)})).catch((g=>{if(!w)throw g;w.notifyObservers(g)})),q}get observers(){return this._observers}constructor(g){let w=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=w,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new o(0),g&&(this._onObserverAdded=g)}add(g){let w=arguments.length>2&&void 0!==arguments[2]&&arguments[2],q=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!g)return null;const o=new r(g,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);o.unregisterOnNextCall=q,w?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(o,this._lastNotifiedValue);const S=R?new WeakRef(this):{deref:()=>this};return o._remove=function(){let g=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const w=S.deref();w&&(g?w.remove(o):w._remove(o))},o}addOnce(g){return this.add(g,void 0,void 0,void 0,!0)}remove(g){if(!g)return!1;g._remove=null;return-1!==this._observers.indexOf(g)&&(this._deferUnregister(g),!0)}removeCallback(g,w){for(let q=0;q<this._observers.length;q++){const R=this._observers[q];if(!R._willBeUnregistered&&(R.callback===g&&(!w||w===R.scope)))return this._deferUnregister(R),!0}return!1}_deferUnregister(g){g._willBeUnregistered||(this._numObserversMarkedAsDeleted++,g.unregisterOnNextCall=!1,g._willBeUnregistered=!0,setTimeout((()=>{this._remove(g)}),0))}_remove(g){let w=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!g)return!1;const q=this._observers.indexOf(g);return-1!==q&&(w&&this._numObserversMarkedAsDeleted--,this._observers.splice(q,1),!0)}makeObserverTopPriority(g){this._remove(g,!1),this._observers.unshift(g)}makeObserverBottomPriority(g){this._remove(g,!1),this._observers.push(g)}notifyObservers(g){let w=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,q=arguments.length>2?arguments[2]:void 0,R=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=g),!this._observers.length)return!0;const r=this._eventState;r.mask=w,r.target=q,r.currentTarget=R,r.skipNextObservers=!1,r.lastReturnValue=g,r.userInfo=o;for(const S of this._observers)if(!S._willBeUnregistered&&(S.mask&w&&(S.unregisterOnNextCall&&this._deferUnregister(S),S.scope?r.lastReturnValue=S.callback.apply(S.scope,[g,r]):r.lastReturnValue=S.callback(g,r)),r.skipNextObservers))return!1;return!0}notifyObserver(g,w){let q=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=w),g._willBeUnregistered)return;const R=this._eventState;R.mask=q,R.skipNextObservers=!1,g.unregisterOnNextCall&&this._deferUnregister(g),g.callback(w,R)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const g=this._observers.pop();g&&(g._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const g=new S;return g._observers=this._observers.slice(0),g}hasSpecificMask(){let g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const w of this._observers)if(w.mask&g||w.mask===g)return!0;return!1}}},11071:(g,w,q)=>{q.d(w,{e:()=>o,h:()=>S});let R=[];class o{static SetImmediate(g){0===R.length&&setTimeout((()=>{const g=R;R=[];for(const w of g)w()}),1),R.push(g)}}function r(g,w,q){try{if(g())return w(),!0}catch(R){return null===q||void 0===q||q(R),!0}return!1}const S=function(g,w,q){let R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,S=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&r(g,w,q))return null;const i=setInterval((()=>{r(g,w,q)?clearInterval(i):(o-=R,o<0&&(clearInterval(i),null===q||void 0===q||q(new Error("Operation timed out after maximum retries. "+(S||"")),!0)))}),R);return()=>clearInterval(i)}}}]);