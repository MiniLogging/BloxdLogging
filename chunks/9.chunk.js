"use strict";(self.g111kvdsqxc=self.g111kvdsqxc||[]).push([[9],{11169:(K,H,M)=>{M.d(H,{b:()=>s,c:()=>E,k:()=>l,g:()=>d,m:()=>x});class q{constructor(){this.children=[]}isValid(K){return!0}process(K,H,M){let q="";if(this.line){let M=this.line;const f=H.processor;if(f){var w,u,y,h,W,I;f.lineProcessor&&(M=f.lineProcessor(M,H.isFragment,H.processingContext));const q=(null===(w=H.processor)||void 0===w?void 0:w.attributeKeywordName)??"attribute",z=H.isFragment&&null!==(u=H.processor)&&void 0!==u&&u.varyingFragmentKeywordName?null===(y=H.processor)||void 0===y?void 0:y.varyingFragmentKeywordName:!H.isFragment&&null!==(h=H.processor)&&void 0!==h&&h.varyingVertexKeywordName?null===(W=H.processor)||void 0===W?void 0:W.varyingVertexKeywordName:"varying";if(!H.isFragment&&f.attributeProcessor&&this.line.startsWith(q))M=f.attributeProcessor(this.line,K,H.processingContext);else if(f.varyingProcessor&&(null!==(I=f.varyingCheck)&&void 0!==I&&I.call(f,this.line,H.isFragment)||!f.varyingCheck&&this.line.startsWith(z)))M=f.varyingProcessor(this.line,H.isFragment,K,H.processingContext);else if(f.uniformProcessor&&f.uniformRegexp&&f.uniformRegexp.test(this.line))H.lookForClosingBracketForUniformBuffer||(M=f.uniformProcessor(this.line,H.isFragment,K,H.processingContext));else if(f.uniformBufferProcessor&&f.uniformBufferRegexp&&f.uniformBufferRegexp.test(this.line))H.lookForClosingBracketForUniformBuffer||(M=f.uniformBufferProcessor(this.line,H.isFragment,H.processingContext),H.lookForClosingBracketForUniformBuffer=!0);else if(f.textureProcessor&&f.textureRegexp&&f.textureRegexp.test(this.line))M=f.textureProcessor(this.line,H.isFragment,K,H.processingContext);else if((f.uniformProcessor||f.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!H.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?f.uniformProcessor&&(M=f.uniformProcessor(this.line,H.isFragment,K,H.processingContext)):f.uniformBufferProcessor&&(M=f.uniformBufferProcessor(this.line,H.isFragment,H.processingContext),H.lookForClosingBracketForUniformBuffer=!0)}H.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(H.lookForClosingBracketForUniformBuffer=!1,f.endOfUniformBufferProcessor&&(M=f.endOfUniformBufferProcessor(this.line,H.isFragment,H.processingContext)))}q+=M+"\n"}for(const f of this.children)q+=f.process(K,H,M);return this.additionalDefineKey&&(K[this.additionalDefineKey]=this.additionalDefineValue||"true",M[this.additionalDefineKey]=K[this.additionalDefineKey]),q}}class w{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(K){this._lines.length=0;for(const H of K){if(!H||"\r"===H)continue;if("#"===H[0]){this._lines.push(H);continue}const K=H.trim();if(!K)continue;if(K.startsWith("//")){this._lines.push(H);continue}const M=K.indexOf(";");if(-1===M)this._lines.push(K);else if(M===K.length-1)K.length>1&&this._lines.push(K);else{const K=H.split(";");for(let H=0;H<K.length;H++){let M=K[H];M&&(M=M.trim(),M&&this._lines.push(M+(H!==K.length-1?";":"")))}}}}}class u extends q{process(K,H,M){for(let q=0;q<this.children.length;q++){const w=this.children[q];if(w.isValid(K))return w.process(K,H,M)}return""}}class y extends q{isValid(K){return this.testExpression.isTrue(K)}}class h{isTrue(K){return!0}static postfixToInfix(K){const H=[];for(const M of K)if(void 0===h._OperatorPriority[M])H.push(M);else{const K=H[H.length-1],q=H[H.length-2];H.length-=2,H.push(`(${q}${M}${K})`)}return H[H.length-1]}static infixToPostfix(K){const H=h._InfixToPostfixCache.get(K);if(H)return H.accessTime=Date.now(),H.result;if(!K.includes("&&")&&!K.includes("||")&&!K.includes(")")&&!K.includes("("))return[K];const M=[];let q=-1;const w=()=>{f=f.trim(),""!==f&&(M.push(f),f="")},u=K=>{q<h._Stack.length-1&&(h._Stack[++q]=K)},y=()=>h._Stack[q],W=()=>-1===q?"!!INVALID EXPRESSION!!":h._Stack[q--];let I=0,f="";for(;I<K.length;){const H=K.charAt(I),z=I<K.length-1?K.substring(I,2+I):"";if("("===H)f="",u(H);else if(")"===H){for(w();-1!==q&&"("!==y();)M.push(W());W()}else if(h._OperatorPriority[z]>1){for(w();-1!==q&&h._OperatorPriority[y()]>=h._OperatorPriority[z];)M.push(W());u(z),I++}else f+=H;I++}for(w();-1!==q;)"("===y()?W():M.push(W());return h._InfixToPostfixCache.size>=h.InfixToPostfixCacheLimitSize&&h.ClearCache(),h._InfixToPostfixCache.set(K,{result:M,accessTime:Date.now()}),M}static ClearCache(){const K=Array.from(h._InfixToPostfixCache.entries()).sort(((K,H)=>K[1].accessTime-H[1].accessTime));for(let H=0;H<h.InfixToPostfixCacheCleanupSize;H++)h._InfixToPostfixCache.delete(K[H][0])}}h.InfixToPostfixCacheLimitSize=5e4,h.InfixToPostfixCacheCleanupSize=25e3,h._InfixToPostfixCache=new Map,h._OperatorPriority={")":0,"(":1,"||":2,"&&":3},h._Stack=["","","","","","","","","","","","","","","","","","","",""];class W extends h{constructor(K){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=K,this.not=H}isTrue(K){let H=void 0!==K[this.define];return this.not&&(H=!H),H}}class I extends h{isTrue(K){return this.leftOperand.isTrue(K)||this.rightOperand.isTrue(K)}}class f extends h{isTrue(K){return this.leftOperand.isTrue(K)&&this.rightOperand.isTrue(K)}}class z extends h{constructor(K,H,M){super(),this.define=K,this.operand=H,this.testValue=M}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(K){let H=!1;const M=parseInt(void 0!=K[this.define]?K[this.define]:this.define),q=parseInt(void 0!=K[this.testValue]?K[this.testValue]:this.testValue);if(isNaN(M)||isNaN(q))return!1;switch(this.operand){case">":H=M>q;break;case"<":H=M<q;break;case"<=":H=M<=q;break;case">=":H=M>=q;break;case"==":H=M===q;break;case"!=":H=M!==q}return H}}var G=M(11132),a=M(11174);const v=/defined\s*?\((.+?)\)/g,O=/defined\s*?\[(.+?)\]/g,L=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,S=/__decl__/,B=/light\{X\}.(\w*)/g,C=/\{X\}/g,i=[],Z=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function E(K){K.processor&&K.processor.initializeShaders&&K.processor.initializeShaders(K.processingContext)}function l(K,H,M,q){var w;null!==(w=H.processor)&&void 0!==w&&w.preProcessShaderCode&&(K=H.processor.preProcessShaderCode(K,H.isFragment)),d(K,H,(K=>{H.processCodeAfterIncludes&&(K=H.processCodeAfterIncludes(H.isFragment?"fragment":"vertex",K,H.defines));const w=function(K,H,M){let q=function(K,H){var M;if(null!==(M=H.processor)&&void 0!==M&&M.noPrecision)return K;const q=H.shouldUseHighPrecisionShader;-1===K.indexOf("precision highp float")?K=q?"precision highp float;\n"+K:"precision mediump float;\n"+K:q||(K=K.replace("precision highp float","precision mediump float"));return K}(K,H);if(!H.processor)return q;if(0===H.processor.shaderLanguage&&-1!==q.indexOf("#version 3")&&(q=q.replace("#version 300 es",""),!H.processor.parseGLES3))return q;const w=H.defines,u=T(H,M);H.processor.preProcessor&&(q=H.processor.preProcessor(q,w,u,H.isFragment,H.processingContext));const y={};q=k(q,u,H,y),H.processor.postProcessor&&(q=H.processor.postProcessor(q,w,H.isFragment,H.processingContext,M?{drawBuffersExtensionDisabled:!M.getCaps().drawBuffersExtension}:{},u,y));null!==M&&void 0!==M&&M._features.needShaderCodeInlining&&(q=M.inlineShaderCode(q));return q}(K,H,q);M(w,K)}))}function s(K,H,M){return M.processor&&M.processor.finalizeShaders?M.processor.finalizeShaders(K,H,M.processingContext):{vertexCode:K,fragmentCode:H}}function D(K){const H=/defined\((.+)\)/.exec(K);if(H&&H.length)return new W(H[1].trim(),"!"===K[0]);const M=["==","!=",">=","<=","<",">"];let q="",w=0;for(q of M)if(w=K.indexOf(q),w>-1)break;if(-1===w)return new W(K);const u=K.substring(0,w).trim(),y=K.substring(w+q.length).trim();return new z(u,q,y)}function V(K,H){const M=new y,q=K.substring(0,H);let w=K.substring(H);return w=w.substring(0,(w.indexOf("//")+1||w.length+1)-1).trim(),M.testExpression="#ifdef"===q?new W(w):"#ifndef"===q?new W(w,!0):function(K){K=K.replace(v,"defined[$1]");const H=h.infixToPostfix(K),M=[];for(const w of H)if("||"!==w&&"&&"!==w)M.push(w);else if(M.length>=2){let K=M[M.length-1],H=M[M.length-2];M.length-=2;const q="&&"==w?new f:new I;"string"===typeof K&&(K=K.replace(O,"defined($1)")),"string"===typeof H&&(H=H.replace(O,"defined($1)")),q.leftOperand="string"===typeof H?D(H):H,q.rightOperand="string"===typeof K?D(K):K,M.push(q)}let q=M[M.length-1];return"string"===typeof q&&(q=q.replace(O,"defined($1)")),"string"===typeof q?D(q):q}(w),M}function n(K,H,M,w){let u=K.currentLine;for(;c(K,M,w);){u=K.currentLine;const y=u.substring(0,5).toLowerCase();if("#else"===y){const M=new q;return H.children.push(M),void c(K,M,w)}if("#elif"===y){const K=V(u,5);H.children.push(K),M=K}}}function c(K,H,M){for(;K.canRead;){K.lineIndex++;const w=K.currentLine;if(w.indexOf("#")>=0){const q=Z.exec(w);if(q&&q.length){switch(q[0]){case"#ifdef":{const q=new u;H.children.push(q);const y=V(w,6);q.children.push(y),n(K,q,y,M);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const q=new u;H.children.push(q);const y=V(w,7);q.children.push(y),n(K,q,y,M);break}case"#if":{const q=new u,y=V(w,3);H.children.push(q),q.children.push(y),n(K,q,y,M);break}}continue}}const y=new q;if(y.line=w,H.children.push(y),"#"===w[0]&&"d"===w[1]){const K=w.replace(";","").split(" ");y.additionalDefineKey=K[1],3===K.length&&(y.additionalDefineValue=K[2])}}return!1}function k(K,H,M,u){const y=new q,h=new w;return h.lineIndex=-1,h.lines=K.split("\n"),c(h,y,u),y.process(H,M,u)}function T(K,H){var M;const q=K.defines,w={};for(const u of q){const K=u.replace("#define","").replace(";","").trim().split(" ");w[K[0]]=K.length>1?K[1]:""}return 0===(null===(M=K.processor)||void 0===M?void 0:M.shaderLanguage)&&(w.GL_ES="true"),w.__VERSION__=K.version,w[K.platformName]="true",(0,a.f)(w,null===H||void 0===H?void 0:H.isNDCHalfZRange,null===H||void 0===H?void 0:H.useReverseDepthBuffer,null===H||void 0===H?void 0:H.useExactSrgbConversions),w}function d(K,H,M){let q;for(i.length=0;null!==(q=L.exec(K));)i.push(q);let w=String(K),u=[K],y=!1;for(const h of i){let K=h[1];if(-1!==K.indexOf("__decl__")&&(K=K.replace(S,""),H.supportsUniformBuffers&&(K=K.replace("Vertex","Ubo").replace("Fragment","Ubo")),K+="Declaration"),!H.includesShadersStore[K]){const q=H.shadersRepository+"ShadersInclude/"+K+".fx";return void x.loadFile(q,(q=>{H.includesShadersStore[K]=q,d(u.join(""),H,M)}))}{let M=H.includesShadersStore[K];if(h[2]){const K=h[3].split(",");for(let H=0;H<K.length;H+=2){const q=new RegExp(K[H],"g"),w=K[H+1];M=M.replace(q,w)}}if(h[4]){const K=h[5];if(-1!==K.indexOf("..")){const q=K.split(".."),w=parseInt(q[0]);let u=parseInt(q[1]),y=M.slice(0);M="",isNaN(u)&&(u=H.indexParameters[q[1]]);for(let K=w;K<u;K++)H.supportsUniformBuffers||(y=y.replace(B,((K,H)=>H+"{X}"))),M+=y.replace(C,K.toString())+"\n"}else H.supportsUniformBuffers||(M=M.replace(B,((K,H)=>H+"{X}"))),M=M.replace(C,K)}const q=[];for(const K of u){const H=K.split(h[0]);for(let K=0;K<H.length-1;K++)q.push(H[K]),q.push(M);q.push(H[H.length-1])}u=q,y=y||M.indexOf("#include<")>=0||M.indexOf("#include <")>=0}}i.length=0,w=u.join(""),y?d(w.toString(),H,M):M(w)}const x={loadFile:(K,H,M,q,w,u)=>{throw(0,G.c)("FileTools")}}},11174:(K,H,M)=>{M.d(H,{c:()=>w,d:()=>u,f:()=>h,g:()=>y,k:()=>W});var q=M(11132);M(11105);const w={};function u(K,H){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(H?H+"\n":"")+K}function y(K,H,M,u,y,h,W){const I=W||w.loadFile;if(I){return I(K,H,M,u,y,h)}throw(0,q.c)("FileTools")}function h(K,H,M,q){if(K)return H?K.IS_NDC_HALF_ZRANGE="":delete K.IS_NDC_HALF_ZRANGE,M?K.USE_REVERSE_DEPTHBUFFER="":delete K.USE_REVERSE_DEPTHBUFFER,void(q?K.USE_EXACT_SRGB_CONVERSIONS="":delete K.USE_EXACT_SRGB_CONVERSIONS);{let K="";return H&&(K+="#define IS_NDC_HALF_ZRANGE"),M&&(K&&(K+="\n"),K+="#define USE_REVERSE_DEPTHBUFFER"),q&&(K&&(K+="\n"),K+="#define USE_EXACT_SRGB_CONVERSIONS"),K}}function W(K,H){let M=arguments.length>2&&void 0!==arguments[2]&&arguments[2],q=arguments.length>3?arguments[3]:void 0;switch(K){case 3:{const K=(ArrayBuffer,new Int8Array(H));return q&&K.set(new Int8Array(q)),K}case 0:{const K=(ArrayBuffer,new Uint8Array(H));return q&&K.set(new Uint8Array(q)),K}case 4:{const K=H instanceof ArrayBuffer?new Int16Array(H):new Int16Array(M?H/2:H);return q&&K.set(new Int16Array(q)),K}case 5:case 8:case 9:case 10:case 2:{const K=H instanceof ArrayBuffer?new Uint16Array(H):new Uint16Array(M?H/2:H);return q&&K.set(new Uint16Array(q)),K}case 6:{const K=H instanceof ArrayBuffer?new Int32Array(H):new Int32Array(M?H/4:H);return q&&K.set(new Int32Array(q)),K}case 7:case 11:case 12:case 13:case 14:case 15:{const K=H instanceof ArrayBuffer?new Uint32Array(H):new Uint32Array(M?H/4:H);return q&&K.set(new Uint32Array(q)),K}case 1:{const K=H instanceof ArrayBuffer?new Float32Array(H):new Float32Array(M?H/4:H);return q&&K.set(new Float32Array(q)),K}}const w=(ArrayBuffer,new Uint8Array(H));return q&&w.set(new Uint8Array(q)),w}},11193:(K,H,M)=>{M.d(H,{d:()=>q});class q{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?q.ShadersRepository:q.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?q.ShadersStore:q.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?q.IncludesShadersStore:q.IncludesShadersStoreWGSL}}q.ShadersRepository="src/Shaders/",q.ShadersStore={},q.IncludesShadersStore={},q.ShadersRepositoryWGSL="src/ShadersWGSL/",q.ShadersStoreWGSL={},q.IncludesShadersStoreWGSL={}},11204:(K,H,M)=>{M.d(H,{c:()=>G,g:()=>C,j:()=>v,l:()=>a,p:()=>O,r:()=>B,t:()=>z,w:()=>I,A:()=>f,E:()=>W,F:()=>h});class q{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.vH._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(K){K&&this.program&&K(this.program)}setEngine(K){this.vH=K}_fillEffectInformation(K,H,M,q,w,u,y,h){const W=this.vH;if(W.supportsUniformBuffers)for(const f in H)K.bindUniformBlock(f,H[f]);let I;for(this.vH.getUniforms(this,M).forEach(((K,H)=>{q[M[H]]=K})),this._uniforms=q,I=0;I<w.length;I++){null==K.getUniform(w[I])&&(w.splice(I,1),I--)}w.forEach(((K,H)=>{u[K]=H}));for(const f of W.getAttributes(this,y))h.push(f)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(K,H){const M=this._valueCache[K],q=H.updateFlag;return(void 0===M||M!==q)&&(this._valueCache[K]=q,!0)}_cacheFloat2(K,H,M){let q=this._valueCache[K];if(!q||2!==q.length)return q=[H,M],this._valueCache[K]=q,!0;let w=!1;return q[0]!==H&&(q[0]=H,w=!0),q[1]!==M&&(q[1]=M,w=!0),w}_cacheFloat3(K,H,M,q){let w=this._valueCache[K];if(!w||3!==w.length)return w=[H,M,q],this._valueCache[K]=w,!0;let u=!1;return w[0]!==H&&(w[0]=H,u=!0),w[1]!==M&&(w[1]=M,u=!0),w[2]!==q&&(w[2]=q,u=!0),u}_cacheFloat4(K,H,M,q,w){let u=this._valueCache[K];if(!u||4!==u.length)return u=[H,M,q,w],this._valueCache[K]=u,!0;let y=!1;return u[0]!==H&&(u[0]=H,y=!0),u[1]!==M&&(u[1]=M,y=!0),u[2]!==q&&(u[2]=q,y=!0),u[3]!==w&&(u[3]=w,y=!0),y}setInt(K,H){const M=this._valueCache[K];void 0!==M&&M===H||this.vH.setInt(this._uniforms[K],H)&&(this._valueCache[K]=H)}setInt2(K,H,M){this._cacheFloat2(K,H,M)&&(this.vH.setInt2(this._uniforms[K],H,M)||(this._valueCache[K]=null))}setInt3(K,H,M,q){this._cacheFloat3(K,H,M,q)&&(this.vH.setInt3(this._uniforms[K],H,M,q)||(this._valueCache[K]=null))}setInt4(K,H,M,q,w){this._cacheFloat4(K,H,M,q,w)&&(this.vH.setInt4(this._uniforms[K],H,M,q,w)||(this._valueCache[K]=null))}setIntArray(K,H){this._valueCache[K]=null,this.vH.setIntArray(this._uniforms[K],H)}setIntArray2(K,H){this._valueCache[K]=null,this.vH.setIntArray2(this._uniforms[K],H)}setIntArray3(K,H){this._valueCache[K]=null,this.vH.setIntArray3(this._uniforms[K],H)}setIntArray4(K,H){this._valueCache[K]=null,this.vH.setIntArray4(this._uniforms[K],H)}setUInt(K,H){const M=this._valueCache[K];void 0!==M&&M===H||this.vH.setUInt(this._uniforms[K],H)&&(this._valueCache[K]=H)}setUInt2(K,H,M){this._cacheFloat2(K,H,M)&&(this.vH.setUInt2(this._uniforms[K],H,M)||(this._valueCache[K]=null))}setUInt3(K,H,M,q){this._cacheFloat3(K,H,M,q)&&(this.vH.setUInt3(this._uniforms[K],H,M,q)||(this._valueCache[K]=null))}setUInt4(K,H,M,q,w){this._cacheFloat4(K,H,M,q,w)&&(this.vH.setUInt4(this._uniforms[K],H,M,q,w)||(this._valueCache[K]=null))}setUIntArray(K,H){this._valueCache[K]=null,this.vH.setUIntArray(this._uniforms[K],H)}setUIntArray2(K,H){this._valueCache[K]=null,this.vH.setUIntArray2(this._uniforms[K],H)}setUIntArray3(K,H){this._valueCache[K]=null,this.vH.setUIntArray3(this._uniforms[K],H)}setUIntArray4(K,H){this._valueCache[K]=null,this.vH.setUIntArray4(this._uniforms[K],H)}setArray(K,H){this._valueCache[K]=null,this.vH.setArray(this._uniforms[K],H)}setArray2(K,H){this._valueCache[K]=null,this.vH.setArray2(this._uniforms[K],H)}setArray3(K,H){this._valueCache[K]=null,this.vH.setArray3(this._uniforms[K],H)}setArray4(K,H){this._valueCache[K]=null,this.vH.setArray4(this._uniforms[K],H)}setMatrices(K,H){H&&(this._valueCache[K]=null,this.vH.setMatrices(this._uniforms[K],H))}setMatrix(K,H){this._cacheMatrix(K,H)&&(this.vH.setMatrices(this._uniforms[K],H.hh())||(this._valueCache[K]=null))}setMatrix3x3(K,H){this._valueCache[K]=null,this.vH.setMatrix3x3(this._uniforms[K],H)}setMatrix2x2(K,H){this._valueCache[K]=null,this.vH.setMatrix2x2(this._uniforms[K],H)}setFloat(K,H){const M=this._valueCache[K];void 0!==M&&M===H||this.vH.setFloat(this._uniforms[K],H)&&(this._valueCache[K]=H)}setVector2(K,H){this._cacheFloat2(K,H.x,H.y)&&(this.vH.setFloat2(this._uniforms[K],H.x,H.y)||(this._valueCache[K]=null))}setFloat2(K,H,M){this._cacheFloat2(K,H,M)&&(this.vH.setFloat2(this._uniforms[K],H,M)||(this._valueCache[K]=null))}setVector3(K,H){this._cacheFloat3(K,H.x,H.y,H.z)&&(this.vH.setFloat3(this._uniforms[K],H.x,H.y,H.z)||(this._valueCache[K]=null))}setFloat3(K,H,M,q){this._cacheFloat3(K,H,M,q)&&(this.vH.setFloat3(this._uniforms[K],H,M,q)||(this._valueCache[K]=null))}setVector4(K,H){this._cacheFloat4(K,H.x,H.y,H.z,H.w)&&(this.vH.setFloat4(this._uniforms[K],H.x,H.y,H.z,H.w)||(this._valueCache[K]=null))}setQuaternion(K,H){this._cacheFloat4(K,H.x,H.y,H.z,H.w)&&(this.vH.setFloat4(this._uniforms[K],H.x,H.y,H.z,H.w)||(this._valueCache[K]=null))}setFloat4(K,H,M,q,w){this._cacheFloat4(K,H,M,q,w)&&(this.vH.setFloat4(this._uniforms[K],H,M,q,w)||(this._valueCache[K]=null))}setColor3(K,H){this._cacheFloat3(K,H.r,H.g,H.b)&&(this.vH.setFloat3(this._uniforms[K],H.r,H.g,H.b)||(this._valueCache[K]=null))}setColor4(K,H,M){this._cacheFloat4(K,H.r,H.g,H.b,M)&&(this.vH.setFloat4(this._uniforms[K],H.r,H.g,H.b,M)||(this._valueCache[K]=null))}setDirectColor4(K,H){this._cacheFloat4(K,H.r,H.g,H.b,H.a)&&(this.vH.setFloat4(this._uniforms[K],H.r,H.g,H.b,H.a)||(this._valueCache[K]=null))}_getVertexShaderCode(){return this.vertexShader?this.vH._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.vH._getShaderSource(this.fragmentShader):null}}var w=M(11174);const u=new WeakMap,y={_webGLVersion:2,cachedPipelines:{}};function h(K){let H=u.get(K);if(!H){if(!K)return y;H={_webGLVersion:K.TEXTURE_BINDING_3D?2:1,_context:K,parallelShaderCompile:K.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},u.set(K,H)}return H}function W(K){u.delete(K)}function I(K,H,M,q,w,u){const y=h(q);u||(u=y._createShaderProgramInjection??G);return u(K,S(H,"vertex",q,y._contextWasLost),S(M,"fragment",q,y._contextWasLost),q,w,y.validateShaderPrograms)}function f(K,H,M,q,w){let u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,y=arguments.length>6?arguments[6]:void 0;const W=h(w);y||(y=W._createShaderProgramInjection??G);const I=W._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return y(K,L(H,"vertex",q,I,w,W._contextWasLost),L(M,"fragment",q,I,w,W._contextWasLost),w,u,W.validateShaderPrograms)}function z(K,H){const M=new q,w=h(K);return w.parallelShaderCompile&&!w.disableParallelShaderCompile&&(M.isParallelCompiled=!0),M.context=w._context,M}function G(K,H,M,q){let w=arguments.length>5?arguments[5]:void 0;const u=q.createProgram();if(K.program=u,!u)throw new Error("Unable to create program");return q.attachShader(u,H),q.attachShader(u,M),q.linkProgram(u),K.context=q,K.vertexShader=H,K.fragmentShader=M,K.isParallelCompiled||v(K,q,w),u}function a(K,H,M){const q=K;if(q._isDisposed)return!1;const w=h(H);return!!(w&&w.parallelShaderCompile&&w.parallelShaderCompile.COMPLETION_STATUS_KHR&&q.program&&H.getProgramParameter(q.program,w.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(v(q,H,M),!0)}function v(K,H,M){const q=K.context,w=K.vertexShader,u=K.fragmentShader,y=K.program;if(!q.getProgramParameter(y,q.LINK_STATUS)){if(!H.getShaderParameter(w,H.COMPILE_STATUS)){const M=H.getShaderInfoLog(w);if(M)throw K.vertexCompilationError=M,new Error("VERTEX SHADER "+M)}if(!H.getShaderParameter(u,H.COMPILE_STATUS)){const M=H.getShaderInfoLog(u);if(M)throw K.fragmentCompilationError=M,new Error("FRAGMENT SHADER "+M)}const M=q.getProgramInfoLog(y);if(M)throw K.programLinkError=M,new Error(M)}if(M){q.validateProgram(y);if(!q.getProgramParameter(y,q.VALIDATE_STATUS)){const H=q.getProgramInfoLog(y);if(H)throw K.programValidationError=H,new Error(H)}}q.deleteShader(w),q.deleteShader(u),K.vertexShader=void 0,K.fragmentShader=void 0,K.onCompiled&&(K.onCompiled(),K.onCompiled=void 0)}function O(K,H,M,q,w,u,y,W,z){let G=arguments.length>10?arguments[10]:void 0,a=arguments.length>11?arguments[11]:void 0,v=arguments.length>12?arguments[12]:void 0;const O=h(K.context);a||(a=O.createRawShaderProgramInjection??I),v||(v=O.createShaderProgramInjection??f);const L=K;L.program=q?a(L,H,M,L.context,z):v(L,H,M,W,L.context,z),L.program.__SPECTOR_rebuildProgram=y,G()}function L(K,H,M,q,u,y){return S((0,w.d)(K,M,q),H,u,y)}function S(K,H,M,q){const w=M.createShader("vertex"===H?M.VERTEX_SHADER:M.FRAGMENT_SHADER);if(!w){let K=M.NO_ERROR,w=M.NO_ERROR;for(;(w=M.getError())!==M.NO_ERROR;)K=w;throw new Error(`Something went wrong while creating a gl ${H} shader object. gl error=${K}, gl isContextLost=${M.isContextLost()}, _contextWasLost=${q}`)}return M.shaderSource(w,K),M.compileShader(w),w}function B(K,H){H.useProgram(K)}function C(K,H){const M=K;if(!M.isParallelCompiled)return void H(K);const q=M.onCompiled;M.onCompiled=()=>{null===q||void 0===q||q(),H(K)}}},11199:(K,H,M)=>{M.d(H,{d:()=>z,e:()=>a,f:()=>I,j:()=>f});var q=M(11105),w=M(11204),u=M(11193),y=M(11112),h=M(11169),W=M(11174);function I(K,H){return(0,w.F)(H).cachedPipelines[K]}function f(K){const H=K._name,M=K.context;if(H&&M){const K=(0,w.F)(M),q=K.cachedPipelines[H];null===q||void 0===q||q.dispose(),delete K.cachedPipelines[H]}}function z(K,H,M,w,u,y,W){let I,f;const z=(0,q.i)()?null===y||void 0===y?void 0:y.getHostDocument():null;I="string"===typeof H?H:H.vertexSource?"source:"+H.vertexSource:H.vertexElement?(null===z||void 0===z?void 0:z.getElementById(H.vertexElement))||H.vertexElement:H.vertex||H,f="string"===typeof H?H:H.fragmentSource?"source:"+H.fragmentSource:H.fragmentElement?(null===z||void 0===z?void 0:z.getElementById(H.fragmentElement))||H.fragmentElement:H.fragment||H;const a=[void 0,void 0],v=()=>{if(a[0]&&a[1]){K.isFragment=!0;const[q,I]=a;(0,h.k)(I,K,((y,I)=>{W&&(W._fragmentSourceCodeBeforeMigration=I),M&&(y=M("fragment",y));const f=(0,h.b)(q,y,K);K=null;const z=function(K,H,M,q){if(M){return{vertexSourceCode:(1===q?"//":"")+"#define SHADER_NAME vertex:"+(M.vertexElement||M.vertex||M.spectorName||M)+"\n"+K,fragmentSourceCode:(1===q?"//":"")+"#define SHADER_NAME fragment:"+(M.fragmentElement||M.fragment||M.spectorName||M)+"\n"+H}}return{vertexSourceCode:K,fragmentSourceCode:H}}(f.vertexCode,f.fragmentCode,H,u);null===w||void 0===w||w(z.vertexSourceCode,z.fragmentSourceCode)}),y)}};G(I,"Vertex","",(H=>{(0,h.c)(K),(0,h.k)(H,K,((K,q)=>{W&&(W._rawVertexSourceCode=H,W._vertexSourceCodeBeforeMigration=q),M&&(K=M("vertex",K)),a[0]=K,v()}),y)}),u),G(f,"Fragment","Pixel",(K=>{W&&(W._rawFragmentSourceCode=K),a[1]=K,v()}),u)}function G(K,H,M,w,y,h){if("undefined"!==typeof HTMLElement&&K instanceof HTMLElement){return void w((0,q.d)(K))}if("source:"===K.substring(0,7))return void w(K.substring(7));if("base64:"===K.substring(0,7)){return void w(window.atob(K.substring(7)))}const I=u.d.GetShadersStore(y);if(I[K+H+"Shader"])return void w(I[K+H+"Shader"]);if(M&&I[K+M+"Shader"])return void w(I[K+M+"Shader"]);let f;if(f="."===K[0]||"/"===K[0]||K.indexOf("http")>-1?K:u.d.GetShadersRepository(y)+K,!(h=h||W.g))throw new Error("loadFileInjection is not defined");h(f+"."+H.toLowerCase()+".fx",w)}const a=(K,H,M,q)=>{try{const u=K.context?(0,w.F)(K.context):null;u&&(u.disableParallelShaderCompile=K.disableParallelCompilation);const y=K.existingPipelineContext||H(K.shaderProcessingContext);return y._name=K.name,K.name&&u&&(u.cachedPipelines[K.name]=y),M(y,K.vertex,K.fragment,!!K.createAsRaw,"","",K.rebuildRebind,K.defines,K.transformFeedbackVaryings,"",(()=>{q(y,(()=>{var H;null===(H=K.onRenderingStateCompiled)||void 0===H||H.call(K,y)}))})),y}catch(u){throw y.e.Error("Error compiling effect"),u}}},11186:(K,H,M)=>{M.r(H),M.d(H,{Effect:()=>W});var q=M(11102),w=M(11112),u=M(11193),y=M(11199),h=M(11176);class W{static get ShadersRepository(){return u.d.ShadersRepository}static set ShadersRepository(K){u.d.ShadersRepository=K}get W(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new q.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(K,H,M){let w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4?arguments[4]:void 0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,I=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,z=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,G=arguments.length>9?arguments[9]:void 0,a=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",v=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,O=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new q.d,this.onErrorObservable=new q.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=K,this._key=a;const L=this._key.replace(/\r/g,"").replace(/\n/g,"|");let S;if(H.attributes){const K=H;if(this._engine=M,this._attributesNames=K.attributes,this._uniformsNames=K.uniformsNames.concat(K.samplers),this._samplerList=K.samplers.slice(),this.defines=K.defines,this.onError=K.onError,this.onCompiled=K.onCompiled,this._fallbacks=K.fallbacks,this._indexParameters=K.indexParameters,this._transformFeedbackVaryings=K.transformFeedbackVaryings||null,this._multiTarget=!!K.multiTarget,this._shaderLanguage=K.shaderLanguage??0,this._disableParallelShaderCompilation=!!K.disableParallelShaderCompilation,K.uniformBuffersNames){this._uniformBuffersNamesList=K.uniformBuffersNames.slice();for(let H=0;H<K.uniformBuffersNames.length;H++)this._uniformBuffersNames[K.uniformBuffersNames[H]]=H}this._processFinalCode=K.processFinalCode??null,this._processCodeAfterIncludes=K.processCodeAfterIncludes??void 0,O=K.extraInitializationsAsync,S=K.existingPipelineContext}else this._engine=u,this.defines=null==h?"":h,this._uniformsNames=M.concat(w),this._samplerList=w?w.slice():[],this._attributesNames=H,this._uniformBuffersNamesList=[],this._shaderLanguage=v,this.onError=z,this.onCompiled=f,this._indexParameters=G,this._fallbacks=I;"WEBGL2"===this._engine.shaderPlatformName&&(S=(0,y.f)(L,this._engine._gl)??S),this._attributeLocationByName={},this.uniqueId=W._UniqueIdSeed++,S?(this._pipelineContext=S,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,O),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.W||this.dispose(!0)}))}async _processShaderCodeAsync(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,q=arguments.length>3?arguments[3]:void 0;q&&await q(),this._processingContext=M||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const w={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:K??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:u.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:u.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,y.d)(w,this.name,this._processFinalCode,((K,M)=>{this._vertexSourceCode=K,this._fragmentSourceCode=M,this._prepareEffect(H)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.W||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(K){return this._attributes[K]}getAttributeLocationByName(K){return this._attributeLocationByName[K]}getAttributesCount(){return this._attributes.length}getUniformIndex(K){return this._uniformsNames.indexOf(K)}getUniform(K){return this._uniforms[K]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((K=>{this.executeWhenCompiled(K)}))}executeWhenCompiled(K){this.isReady()?K(this):(this.onCompileObservable.add((H=>{K(H)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(K){(0,h.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(H=>{this._processCompilationErrors(H,K)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(K,H,M,q){this._isReady=!1,this._vertexSourceCodeOverride=K,this._fragmentSourceCodeOverride=H,this.onError=(K,H)=>{q&&q(H)},this.onCompiled=()=>{var K,H;const q=this.getEngine().scenes;if(q)for(let M=0;M<q.length;M++)q[M].markAllMaterialsAsDirty(127);null===(K=(H=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===K||K.call(H,M)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(K){if(this._pipelineContext=K,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let H=0;H<this._attributesNames.length;H++){const K=this._attributesNames[H];this._attributeLocationByName[K]=this._attributes[H]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),W.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const H=this._pipelineContext;this._isReady=!1;try{const M=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),q=M?null:this.defines,w=M?this._vertexSourceCodeOverride:this._vertexSourceCode,u=M?this._fragmentSourceCodeOverride:this._fragmentSourceCode,h=this._engine;this._pipelineContext=(0,y.e)({existingPipelineContext:K?H:null,vertex:w,fragment:u,context:"WEBGL2"===h.shaderPlatformName||"WEBGL1"===h.shaderPlatformName?h._gl:void 0,rebuildRebind:(K,H,M,q)=>this._rebuildProgram(K,H,M,q),defines:q,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:M,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:M=>{H&&!K&&this._engine._deletePipelineContext(H),M&&this._onRenderingStateCompiled(M)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(H)}catch(M){this._processCompilationErrors(M,H)}}_getShaderCodeAndErrorLine(K,H,M){const q=M?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let w=null;if(H&&K){const u=H.match(q);if(u&&2===u.length){const H=parseInt(u[1]),q=K.split("\n",-1);q.length>=H&&(w=`Offending line [${H}] in ${M?"fragment":"vertex"} code: ${q[H-1]}`)}}return[K,w]}_processCompilationErrors(K){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=K.message;const M=this._attributesNames,q=this._fallbacks;if(w.e.Error("Unable to compile effect:"),w.e.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),w.e.Error(`Attributes: ${M.join(" ")}`),w.e.Error("Defines:\n"+this.defines),W.LogShaderCodeOnCompilationError){var u,y;let K=null,H=null,M=null;var h;if(null!==(u=this._pipelineContext)&&void 0!==u&&u._getVertexShaderCode()&&([M,K]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),M&&(w.e.Error("Vertex code:"),w.e.Error(M))),null!==(y=this._pipelineContext)&&void 0!==y&&y._getFragmentShaderCode())[M,H]=this._getShaderCodeAndErrorLine(null===(h=this._pipelineContext)||void 0===h?void 0:h._getFragmentShaderCode(),this._compilationError,!0),M&&(w.e.Error("Fragment code:"),w.e.Error(M));K&&w.e.Error(K),H&&w.e.Error(H)}w.e.Error("Error: "+this._compilationError);const I=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};H&&(this._pipelineContext=H,this._isReady=!0,I()),q?(this._pipelineContext=null,q.hasMoreFallbacks?(this._allFallbacksProcessed=!1,w.e.Error("Trying next fallback."),this.defines=q.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,I(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,H||I())}get isSupported(){return""===this._compilationError}_bindTexture(K,H){this._engine._bindTexture(this._samplers[K],H,K)}setTexture(K,H){this._engine.setTexture(this._samplers[K],this._uniforms[K],H,K)}setTextureArray(K,H){const M=K+"Ex";if(-1===this._samplerList.indexOf(M+"0")){const q=this._samplerList.indexOf(K);for(let K=1;K<H.length;K++){const H=M+(K-1).toString();this._samplerList.splice(q+K,0,H)}let w=0;for(const K of this._samplerList)this._samplers[K]=w,w+=1}this._engine.setTextureArray(this._samplers[K],this._uniforms[K],H,K)}bindUniformBuffer(K,H){const M=this._uniformBuffersNames[H];void 0===M||W._BaseCache[M]===K&&this._engine._features.useUBOBindingCache||(W._BaseCache[M]=K,this._engine.bindUniformBufferBase(K,M,H))}bindUniformBlock(K,H){this._engine.bindUniformBlock(this._pipelineContext,K,H)}setInt(K,H){return this._pipelineContext.setInt(K,H),this}setInt2(K,H,M){return this._pipelineContext.setInt2(K,H,M),this}setInt3(K,H,M,q){return this._pipelineContext.setInt3(K,H,M,q),this}setInt4(K,H,M,q,w){return this._pipelineContext.setInt4(K,H,M,q,w),this}setIntArray(K,H){return this._pipelineContext.setIntArray(K,H),this}setIntArray2(K,H){return this._pipelineContext.setIntArray2(K,H),this}setIntArray3(K,H){return this._pipelineContext.setIntArray3(K,H),this}setIntArray4(K,H){return this._pipelineContext.setIntArray4(K,H),this}setUInt(K,H){return this._pipelineContext.setUInt(K,H),this}setUInt2(K,H,M){return this._pipelineContext.setUInt2(K,H,M),this}setUInt3(K,H,M,q){return this._pipelineContext.setUInt3(K,H,M,q),this}setUInt4(K,H,M,q,w){return this._pipelineContext.setUInt4(K,H,M,q,w),this}setUIntArray(K,H){return this._pipelineContext.setUIntArray(K,H),this}setUIntArray2(K,H){return this._pipelineContext.setUIntArray2(K,H),this}setUIntArray3(K,H){return this._pipelineContext.setUIntArray3(K,H),this}setUIntArray4(K,H){return this._pipelineContext.setUIntArray4(K,H),this}setFloatArray(K,H){return this._pipelineContext.setArray(K,H),this}setFloatArray2(K,H){return this._pipelineContext.setArray2(K,H),this}setFloatArray3(K,H){return this._pipelineContext.setArray3(K,H),this}setFloatArray4(K,H){return this._pipelineContext.setArray4(K,H),this}setArray(K,H){return this._pipelineContext.setArray(K,H),this}setArray2(K,H){return this._pipelineContext.setArray2(K,H),this}setArray3(K,H){return this._pipelineContext.setArray3(K,H),this}setArray4(K,H){return this._pipelineContext.setArray4(K,H),this}setMatrices(K,H){return this._pipelineContext.setMatrices(K,H),this}setMatrix(K,H){return this._pipelineContext.setMatrix(K,H),this}setMatrix3x3(K,H){return this._pipelineContext.setMatrix3x3(K,H),this}setMatrix2x2(K,H){return this._pipelineContext.setMatrix2x2(K,H),this}setFloat(K,H){return this._pipelineContext.setFloat(K,H),this}setBool(K,H){return this._pipelineContext.setInt(K,H?1:0),this}setVector2(K,H){return this._pipelineContext.setVector2(K,H),this}setFloat2(K,H,M){return this._pipelineContext.setFloat2(K,H,M),this}setVector3(K,H){return this._pipelineContext.setVector3(K,H),this}setFloat3(K,H,M,q){return this._pipelineContext.setFloat3(K,H,M,q),this}setVector4(K,H){return this._pipelineContext.setVector4(K,H),this}setQuaternion(K,H){return this._pipelineContext.setQuaternion(K,H),this}setFloat4(K,H,M,q,w){return this._pipelineContext.setFloat4(K,H,M,q,w),this}setColor3(K,H){return this._pipelineContext.setColor3(K,H),this}setColor4(K,H,M){return this._pipelineContext.setColor4(K,H,M),this}setDirectColor4(K,H){return this._pipelineContext.setDirectColor4(K,H),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(W.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,y.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(K,H,M){let q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;H&&(u.d.GetShadersStore(q)[`${K}PixelShader`]=H),M&&(u.d.GetShadersStore(q)[`${K}VertexShader`]=M)}static ResetCache(){W._BaseCache={}}}W.LogShaderCodeOnCompilationError=!0,W.PersistentMode=!1,W.AutomaticallyClearCodeCache=!1,W._UniqueIdSeed=0,W._BaseCache={},W.ShadersStore=u.d.ShadersStore,W.IncludesShadersStore=u.d.IncludesShadersStore},11132:(K,H,M)=>{M.d(H,{c:()=>w});const q={};function w(K){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!q[K])return q[K]=!0,`${K} needs to be imported before as it contains a side-effect required by your code.`}},11105:(K,H,M)=>{function q(){return"undefined"!==typeof window}function w(){return"undefined"!==typeof navigator}function u(){return"undefined"!==typeof document}function y(K){let H="",M=K.firstChild;for(;M;)3===M.nodeType&&(H+=M.textContent),M=M.nextSibling;return H}M.d(H,{d:()=>y,e:()=>u,g:()=>w,i:()=>q})},11112:(K,H,M)=>{M.d(H,{e:()=>q});class q{static _CheckLimit(K,H){let M=q._LogLimitOutputs[K];return M?M.current++:(M={limit:H,current:1},q._LogLimitOutputs[K]=M),M.current<=M.limit}static _GenerateLimitMessage(K){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const M=q._LogLimitOutputs[K];if(!M||!q.MessageLimitReached)return;const w=this._Levels[H];M.current===M.limit&&q[w.name](q.MessageLimitReached.replace(/%LIMIT%/g,""+M.limit).replace(/%TYPE%/g,w.name??""))}static _AddLogEntry(K){q._LogCache=K+q._LogCache,q.OnNewCacheEntry&&q.OnNewCacheEntry(K)}static _FormatMessage(K){const H=K=>K<10?"0"+K:""+K,M=new Date;return"["+H(M.getHours())+":"+H(M.getMinutes())+":"+H(M.getSeconds())+"]: "+K}static _LogDisabled(K,H){}static _LogEnabled(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,H=arguments.length>1?arguments[1]:void 0,M=arguments.length>2?arguments[2]:void 0;const w=Array.isArray(H)?H[0]:H;if(void 0!==M&&!q._CheckLimit(w,M))return;const u=q._FormatMessage(w),y=this._Levels[K],h=Array.isArray(H)?H.slice(1):[];y.logFunc&&y.logFunc("BJS - "+u,...h);const W=`<div style='color:${y.color}'>${u}</div><br>`;q._AddLogEntry(W),q._GenerateLimitMessage(w,K)}static get LogCache(){return q._LogCache}static ClearLogCache(){q._LogCache="",q._LogLimitOutputs={},q.errorsCount=0}static set LogLevels(K){q.Log=q._LogDisabled,q.Warn=q._LogDisabled,q.Error=q._LogDisabled;const H=[q.MessageLogLevel,q.WarningLogLevel,q.ErrorLogLevel];for(const M of H)if((K&M)===M){const K=this._Levels[M];q[K.name]=q._LogEnabled.bind(q,M)}}}q.NoneLogLevel=0,q.MessageLogLevel=1,q.WarningLogLevel=2,q.ErrorLogLevel=4,q.AllLogLevel=7,q.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",q._LogCache="",q._LogLimitOutputs={},q._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],q.errorsCount=0,q.Log=q._LogEnabled.bind(q,q.MessageLogLevel),q.Warn=q._LogEnabled.bind(q,q.WarningLogLevel),q.Error=q._LogEnabled.bind(q,q.ErrorLogLevel)},11102:(K,H,M)=>{M.d(H,{d:()=>y});const q="undefined"!==typeof WeakRef;class w{constructor(K){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],M=arguments.length>2?arguments[2]:void 0,q=arguments.length>3?arguments[3]:void 0;this.initialize(K,H,M,q)}initialize(K){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1],M=arguments.length>2?arguments[2]:void 0,q=arguments.length>3?arguments[3]:void 0;return this.mask=K,this.skipNextObservers=H,this.target=M,this.currentTarget=q,this}}class u{constructor(K,H){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=K,this.mask=H,this.scope=M,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(K)}}class y{static FromPromise(K,H){const M=new y;return K.then((K=>{M.notifyObservers(K)})).catch((K=>{if(!H)throw K;H.notifyObservers(K)})),M}get observers(){return this._observers}constructor(K){let H=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=H,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new w(0),K&&(this._onObserverAdded=K)}add(K){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2],M=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!K)return null;const w=new u(K,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);w.unregisterOnNextCall=M,H?this._observers.unshift(w):this._observers.push(w),this._onObserverAdded&&this._onObserverAdded(w),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(w,this._lastNotifiedValue);const y=q?new WeakRef(this):{deref:()=>this};return w._remove=function(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const H=y.deref();H&&(K?H.remove(w):H._remove(w))},w}addOnce(K){return this.add(K,void 0,void 0,void 0,!0)}remove(K){if(!K)return!1;K._remove=null;return-1!==this._observers.indexOf(K)&&(this._deferUnregister(K),!0)}removeCallback(K,H){for(let M=0;M<this._observers.length;M++){const q=this._observers[M];if(!q._willBeUnregistered&&(q.callback===K&&(!H||H===q.scope)))return this._deferUnregister(q),!0}return!1}_deferUnregister(K){K._willBeUnregistered||(this._numObserversMarkedAsDeleted++,K.unregisterOnNextCall=!1,K._willBeUnregistered=!0,setTimeout((()=>{this._remove(K)}),0))}_remove(K){let H=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!K)return!1;const M=this._observers.indexOf(K);return-1!==M&&(H&&this._numObserversMarkedAsDeleted--,this._observers.splice(M,1),!0)}makeObserverTopPriority(K){this._remove(K,!1),this._observers.unshift(K)}makeObserverBottomPriority(K){this._remove(K,!1),this._observers.push(K)}notifyObservers(K){let H=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,M=arguments.length>2?arguments[2]:void 0,q=arguments.length>3?arguments[3]:void 0,w=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=K),!this._observers.length)return!0;const u=this._eventState;u.mask=H,u.target=M,u.currentTarget=q,u.skipNextObservers=!1,u.lastReturnValue=K,u.userInfo=w;for(const y of this._observers)if(!y._willBeUnregistered&&(y.mask&H&&(y.unregisterOnNextCall&&this._deferUnregister(y),y.scope?u.lastReturnValue=y.callback.apply(y.scope,[K,u]):u.lastReturnValue=y.callback(K,u)),u.skipNextObservers))return!1;return!0}notifyObserver(K,H){let M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=H),K._willBeUnregistered)return;const q=this._eventState;q.mask=M,q.skipNextObservers=!1,K.unregisterOnNextCall&&this._deferUnregister(K),K.callback(H,q)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const K=this._observers.pop();K&&(K._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const K=new y;return K._observers=this._observers.slice(0),K}hasSpecificMask(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const H of this._observers)if(H.mask&K||H.mask===K)return!0;return!1}}},11176:(K,H,M)=>{M.d(H,{c:()=>w,e:()=>y});let q=[];class w{static SetImmediate(K){0===q.length&&setTimeout((()=>{const K=q;q=[];for(const H of K)H()}),1),q.push(K)}}function u(K,H,M){try{if(K())return H(),!0}catch(q){return null===M||void 0===M||M(q),!0}return!1}const y=function(K,H,M){let q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,y=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&u(K,H,M))return null;const h=setInterval((()=>{u(K,H,M)?clearInterval(h):(w-=q,w<0&&(clearInterval(h),null===M||void 0===M||M(new Error("Operation timed out after maximum retries. "+(y||"")),!0)))}),q);return()=>clearInterval(h)}}}]);