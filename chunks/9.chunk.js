"use strict";(self.rsqbdnwe5e=self.rsqbdnwe5e||[]).push([[9],{12257:(N,p,T)=>{T.d(p,{b:()=>F,c:()=>i,i:()=>K,g:()=>G,j:()=>o});class A{constructor(){this.children=[]}isValid(N){return!0}process(N,p,T){let A="";if(this.line){let T=this.line;const H=p.processor;if(H){var a,C,U,X,y,e;H.lineProcessor&&(T=H.lineProcessor(T,p.isFragment,p.processingContext));const A=(null===(a=p.processor)||void 0===a?void 0:a.attributeKeywordName)??"attribute",M=p.isFragment&&null!==(C=p.processor)&&void 0!==C&&C.varyingFragmentKeywordName?null===(U=p.processor)||void 0===U?void 0:U.varyingFragmentKeywordName:!p.isFragment&&null!==(X=p.processor)&&void 0!==X&&X.varyingVertexKeywordName?null===(y=p.processor)||void 0===y?void 0:y.varyingVertexKeywordName:"varying";if(!p.isFragment&&H.attributeProcessor&&this.line.startsWith(A))T=H.attributeProcessor(this.line,N,p.processingContext);else if(H.varyingProcessor&&(null!==(e=H.varyingCheck)&&void 0!==e&&e.call(H,this.line,p.isFragment)||!H.varyingCheck&&this.line.startsWith(M)))T=H.varyingProcessor(this.line,p.isFragment,N,p.processingContext);else if(H.uniformProcessor&&H.uniformRegexp&&H.uniformRegexp.test(this.line))p.lookForClosingBracketForUniformBuffer||(T=H.uniformProcessor(this.line,p.isFragment,N,p.processingContext));else if(H.uniformBufferProcessor&&H.uniformBufferRegexp&&H.uniformBufferRegexp.test(this.line))p.lookForClosingBracketForUniformBuffer||(T=H.uniformBufferProcessor(this.line,p.isFragment,p.processingContext),p.lookForClosingBracketForUniformBuffer=!0);else if(H.textureProcessor&&H.textureRegexp&&H.textureRegexp.test(this.line))T=H.textureProcessor(this.line,p.isFragment,N,p.processingContext);else if((H.uniformProcessor||H.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!p.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?H.uniformProcessor&&(T=H.uniformProcessor(this.line,p.isFragment,N,p.processingContext)):H.uniformBufferProcessor&&(T=H.uniformBufferProcessor(this.line,p.isFragment,p.processingContext),p.lookForClosingBracketForUniformBuffer=!0)}p.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(p.lookForClosingBracketForUniformBuffer=!1,H.endOfUniformBufferProcessor&&(T=H.endOfUniformBufferProcessor(this.line,p.isFragment,p.processingContext)))}A+=T+"\n"}for(const H of this.children)A+=H.process(N,p,T);return this.additionalDefineKey&&(N[this.additionalDefineKey]=this.additionalDefineValue||"true",T[this.additionalDefineKey]=N[this.additionalDefineKey]),A}}class a{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(N){this._lines.length=0;for(const p of N){if(!p||"\r"===p)continue;if("#"===p[0]){this._lines.push(p);continue}const N=p.trim();if(!N)continue;if(N.startsWith("//")){this._lines.push(p);continue}const T=N.indexOf(";");if(-1===T)this._lines.push(N);else if(T===N.length-1)N.length>1&&this._lines.push(N);else{const N=p.split(";");for(let p=0;p<N.length;p++){let T=N[p];T&&(T=T.trim(),T&&this._lines.push(T+(p!==N.length-1?";":"")))}}}}}class C extends A{process(N,p,T){for(let A=0;A<this.children.length;A++){const a=this.children[A];if(a.isValid(N))return a.process(N,p,T)}return""}}class U extends A{isValid(N){return this.testExpression.isTrue(N)}}class X{isTrue(N){return!0}static postfixToInfix(N){const p=[];for(const T of N)if(void 0===X._OperatorPriority[T])p.push(T);else{const N=p[p.length-1],A=p[p.length-2];p.length-=2,p.push(`(${A}${T}${N})`)}return p[p.length-1]}static infixToPostfix(N){const p=X._InfixToPostfixCache.get(N);if(p)return p.accessTime=Date.now(),p.result;if(!N.includes("&&")&&!N.includes("||")&&!N.includes(")")&&!N.includes("("))return[N];const T=[];let A=-1;const a=()=>{H=H.trim(),""!==H&&(T.push(H),H="")},C=N=>{A<X._Stack.length-1&&(X._Stack[++A]=N)},U=()=>X._Stack[A],y=()=>-1===A?"!!INVALID EXPRESSION!!":X._Stack[A--];let e=0,H="";for(;e<N.length;){const p=N.charAt(e),M=e<N.length-1?N.substring(e,2+e):"";if("("===p)H="",C(p);else if(")"===p){for(a();-1!==A&&"("!==U();)T.push(y());y()}else if(X._OperatorPriority[M]>1){for(a();-1!==A&&X._OperatorPriority[U()]>=X._OperatorPriority[M];)T.push(y());C(M),e++}else H+=p;e++}for(a();-1!==A;)"("===U()?y():T.push(y());return X._InfixToPostfixCache.size>=X.InfixToPostfixCacheLimitSize&&X.ClearCache(),X._InfixToPostfixCache.set(N,{result:T,accessTime:Date.now()}),T}static ClearCache(){const N=Array.from(X._InfixToPostfixCache.entries()).sort(((N,p)=>N[1].accessTime-p[1].accessTime));for(let p=0;p<X.InfixToPostfixCacheCleanupSize;p++)X._InfixToPostfixCache.delete(N[p][0])}}X.InfixToPostfixCacheLimitSize=5e4,X.InfixToPostfixCacheCleanupSize=25e3,X._InfixToPostfixCache=new Map,X._OperatorPriority={")":0,"(":1,"||":2,"&&":3},X._Stack=["","","","","","","","","","","","","","","","","","","",""];class y extends X{constructor(N){let p=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=N,this.not=p}isTrue(N){let p=void 0!==N[this.define];return this.not&&(p=!p),p}}class e extends X{isTrue(N){return this.leftOperand.isTrue(N)||this.rightOperand.isTrue(N)}}class H extends X{isTrue(N){return this.leftOperand.isTrue(N)&&this.rightOperand.isTrue(N)}}class M extends X{constructor(N,p,T){super(),this.define=N,this.operand=p,this.testValue=T}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(N){let p=!1;const T=parseInt(void 0!=N[this.define]?N[this.define]:this.define),A=parseInt(void 0!=N[this.testValue]?N[this.testValue]:this.testValue);if(isNaN(T)||isNaN(A))return!1;switch(this.operand){case">":p=T>A;break;case"<":p=T<A;break;case"<=":p=T<=A;break;case">=":p=T>=A;break;case"==":p=T===A;break;case"!=":p=T!==A}return p}}var b=T(12218),l=T(12261);const k=/defined\s*?\((.+?)\)/g,x=/defined\s*?\[(.+?)\]/g,I=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,L=/__decl__/,n=/light\{X\}.(\w*)/g,w=/\{X\}/g,g=[],P=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function i(N){N.processor&&N.processor.initializeShaders&&N.processor.initializeShaders(N.processingContext)}function K(N,p,T,A){var a;null!==(a=p.processor)&&void 0!==a&&a.preProcessShaderCode&&(N=p.processor.preProcessShaderCode(N,p.isFragment)),G(N,p,(N=>{p.processCodeAfterIncludes&&(N=p.processCodeAfterIncludes(p.isFragment?"fragment":"vertex",N,p.defines));const a=function(N,p,T){let A=function(N,p){var T;if(null!==(T=p.processor)&&void 0!==T&&T.noPrecision)return N;const A=p.shouldUseHighPrecisionShader;-1===N.indexOf("precision highp float")?N=A?"precision highp float;\n"+N:"precision mediump float;\n"+N:A||(N=N.replace("precision highp float","precision mediump float"));return N}(N,p);if(!p.processor)return A;if(0===p.processor.shaderLanguage&&-1!==A.indexOf("#version 3")&&(A=A.replace("#version 300 es",""),!p.processor.parseGLES3))return A;const a=p.defines,C=f(p,T);p.processor.preProcessor&&(A=p.processor.preProcessor(A,a,C,p.isFragment,p.processingContext));const U={};A=J(A,C,p,U),p.processor.postProcessor&&(A=p.processor.postProcessor(A,a,p.isFragment,p.processingContext,T?{drawBuffersExtensionDisabled:!T.getCaps().drawBuffersExtension}:{},C,U));null!==T&&void 0!==T&&T._features.needShaderCodeInlining&&(A=T.inlineShaderCode(A));return A}(N,p,A);T(a,N)}))}function F(N,p,T){return T.processor&&T.processor.finalizeShaders?T.processor.finalizeShaders(N,p,T.processingContext):{vertexCode:N,fragmentCode:p}}function v(N){const p=/defined\((.+)\)/.exec(N);if(p&&p.length)return new y(p[1].trim(),"!"===N[0]);const T=["==","!=",">=","<=","<",">"];let A="",a=0;for(A of T)if(a=N.indexOf(A),a>-1)break;if(-1===a)return new y(N);const C=N.substring(0,a).trim(),U=N.substring(a+A.length).trim();return new M(C,A,U)}function W(N,p){const T=new U,A=N.substring(0,p);let a=N.substring(p);return a=a.substring(0,(a.indexOf("//")+1||a.length+1)-1).trim(),T.testExpression="#ifdef"===A?new y(a):"#ifndef"===A?new y(a,!0):function(N){N=N.replace(k,"defined[$1]");const p=X.infixToPostfix(N),T=[];for(const a of p)if("||"!==a&&"&&"!==a)T.push(a);else if(T.length>=2){let N=T[T.length-1],p=T[T.length-2];T.length-=2;const A="&&"==a?new H:new e;"string"===typeof N&&(N=N.replace(x,"defined($1)")),"string"===typeof p&&(p=p.replace(x,"defined($1)")),A.leftOperand="string"===typeof p?v(p):p,A.rightOperand="string"===typeof N?v(N):N,T.push(A)}let A=T[T.length-1];return"string"===typeof A&&(A=A.replace(x,"defined($1)")),"string"===typeof A?v(A):A}(a),T}function z(N,p,T,a){let C=N.currentLine;for(;R(N,T,a);){C=N.currentLine;const U=C.substring(0,5).toLowerCase();if("#else"===U){const T=new A;return p.children.push(T),void R(N,T,a)}if("#elif"===U){const N=W(C,5);p.children.push(N),T=N}}}function R(N,p,T){for(;N.canRead;){N.lineIndex++;const a=N.currentLine;if(a.indexOf("#")>=0){const A=P.exec(a);if(A&&A.length){switch(A[0]){case"#ifdef":{const A=new C;p.children.push(A);const U=W(a,6);A.children.push(U),z(N,A,U,T);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const A=new C;p.children.push(A);const U=W(a,7);A.children.push(U),z(N,A,U,T);break}case"#if":{const A=new C,U=W(a,3);p.children.push(A),A.children.push(U),z(N,A,U,T);break}}continue}}const U=new A;if(U.line=a,p.children.push(U),"#"===a[0]&&"d"===a[1]){const N=a.replace(";","").split(" ");U.additionalDefineKey=N[1],3===N.length&&(U.additionalDefineValue=N[2])}}return!1}function J(N,p,T,C){const U=new A,X=new a;return X.lineIndex=-1,X.lines=N.split("\n"),R(X,U,C),U.process(p,T,C)}function f(N,p){var T;const A=N.defines,a={};for(const C of A){const N=C.replace("#define","").replace(";","").trim().split(" ");a[N[0]]=N.length>1?N[1]:""}return 0===(null===(T=N.processor)||void 0===T?void 0:T.shaderLanguage)&&(a.GL_ES="true"),a.__VERSION__=N.version,a[N.platformName]="true",(0,l.j)(a,null===p||void 0===p?void 0:p.isNDCHalfZRange,null===p||void 0===p?void 0:p.BU,null===p||void 0===p?void 0:p.useExactSrgbConversions),a}function G(N,p,T){let A;for(g.length=0;null!==(A=I.exec(N));)g.push(A);let a=String(N),C=[N],U=!1;for(const X of g){let N=X[1];if(-1!==N.indexOf("__decl__")&&(N=N.replace(L,""),p.supportsUniformBuffers&&(N=N.replace("Vertex","Ubo").replace("Fragment","Ubo")),N+="Declaration"),!p.includesShadersStore[N]){const A=p.shadersRepository+"ShadersInclude/"+N+".fx";return void o.loadFile(A,(A=>{p.includesShadersStore[N]=A,G(C.join(""),p,T)}))}{let T=p.includesShadersStore[N];if(X[2]){const N=X[3].split(",");for(let p=0;p<N.length;p+=2){const A=new RegExp(N[p],"g"),a=N[p+1];T=T.replace(A,a)}}if(X[4]){const N=X[5];if(-1!==N.indexOf("..")){const A=N.split(".."),a=parseInt(A[0]);let C=parseInt(A[1]),U=T.slice(0);T="",isNaN(C)&&(C=p.indexParameters[A[1]]);for(let N=a;N<C;N++)p.supportsUniformBuffers||(U=U.replace(n,((N,p)=>p+"{X}"))),T+=U.replace(w,N.toString())+"\n"}else p.supportsUniformBuffers||(T=T.replace(n,((N,p)=>p+"{X}"))),T=T.replace(w,N)}const A=[];for(const N of C){const p=N.split(X[0]);for(let N=0;N<p.length-1;N++)A.push(p[N]),A.push(T);A.push(p[p.length-1])}C=A,U=U||T.indexOf("#include<")>=0||T.indexOf("#include <")>=0}}g.length=0,a=C.join(""),U?G(a.toString(),p,T):T(a)}const o={loadFile:(N,p,T,A,a,C)=>{throw(0,b.c)("FileTools")}}},12261:(N,p,T)=>{T.d(p,{d:()=>a,h:()=>C,j:()=>X,l:()=>U,n:()=>y});var A=T(12218);T(12198);const a={};function C(N,p){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(p?p+"\n":"")+N}function U(N,p,T,C,U,X,y){const e=y||a.loadFile;if(e){return e(N,p,T,C,U,X)}throw(0,A.c)("FileTools")}function X(N,p,T,A){if(N)return p?N.IS_NDC_HALF_ZRANGE="":delete N.IS_NDC_HALF_ZRANGE,T?N.USE_REVERSE_DEPTHBUFFER="":delete N.USE_REVERSE_DEPTHBUFFER,void(A?N.USE_EXACT_SRGB_CONVERSIONS="":delete N.USE_EXACT_SRGB_CONVERSIONS);{let N="";return p&&(N+="#define IS_NDC_HALF_ZRANGE"),T&&(N&&(N+="\n"),N+="#define USE_REVERSE_DEPTHBUFFER"),A&&(N&&(N+="\n"),N+="#define USE_EXACT_SRGB_CONVERSIONS"),N}}function y(N,p){let T=arguments.length>2&&void 0!==arguments[2]&&arguments[2],A=arguments.length>3?arguments[3]:void 0;switch(N){case 3:{const N=(ArrayBuffer,new Int8Array(p));return A&&N.set(new Int8Array(A)),N}case 0:{const N=(ArrayBuffer,new Uint8Array(p));return A&&N.set(new Uint8Array(A)),N}case 4:{const N=p instanceof ArrayBuffer?new Int16Array(p):new Int16Array(T?p/2:p);return A&&N.set(new Int16Array(A)),N}case 5:case 8:case 9:case 10:case 2:{const N=p instanceof ArrayBuffer?new Uint16Array(p):new Uint16Array(T?p/2:p);return A&&N.set(new Uint16Array(A)),N}case 6:{const N=p instanceof ArrayBuffer?new Int32Array(p):new Int32Array(T?p/4:p);return A&&N.set(new Int32Array(A)),N}case 7:case 11:case 12:case 13:case 14:case 15:{const N=p instanceof ArrayBuffer?new Uint32Array(p):new Uint32Array(T?p/4:p);return A&&N.set(new Uint32Array(A)),N}case 1:{const N=p instanceof ArrayBuffer?new Float32Array(p):new Float32Array(T?p/4:p);return A&&N.set(new Float32Array(A)),N}}const a=(ArrayBuffer,new Uint8Array(p));return A&&a.set(new Uint8Array(A)),a}},12281:(N,p,T)=>{T.d(p,{b:()=>A});class A{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersRepository:A.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersStore:A.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.IncludesShadersStore:A.IncludesShadersStoreWGSL}}A.ShadersRepository="src/Shaders/",A.ShadersStore={},A.IncludesShadersStore={},A.ShadersRepositoryWGSL="src/ShadersWGSL/",A.ShadersStoreWGSL={},A.IncludesShadersStoreWGSL={}},12294:(N,p,T)=>{T.d(p,{c:()=>b,d:()=>w,f:()=>k,g:()=>l,j:()=>x,k:()=>n,o:()=>M,s:()=>e,v:()=>H,y:()=>y,z:()=>X});class A{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.kp._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(N){N&&this.program&&N(this.program)}setEngine(N){this.kp=N}_fillEffectInformation(N,p,T,A,a,C,U,X){const y=this.kp;if(y.supportsUniformBuffers)for(const H in p)N.bindUniformBlock(H,p[H]);let e;for(this.kp.getUniforms(this,T).forEach(((N,p)=>{A[T[p]]=N})),this._uniforms=A,e=0;e<a.length;e++){null==N.getUniform(a[e])&&(a.splice(e,1),e--)}a.forEach(((N,p)=>{C[N]=p}));for(const H of y.getAttributes(this,U))X.push(H)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(N,p){const T=this._valueCache[N],A=p.updateFlag;return(void 0===T||T!==A)&&(this._valueCache[N]=A,!0)}_cacheFloat2(N,p,T){let A=this._valueCache[N];if(!A||2!==A.length)return A=[p,T],this._valueCache[N]=A,!0;let a=!1;return A[0]!==p&&(A[0]=p,a=!0),A[1]!==T&&(A[1]=T,a=!0),a}_cacheFloat3(N,p,T,A){let a=this._valueCache[N];if(!a||3!==a.length)return a=[p,T,A],this._valueCache[N]=a,!0;let C=!1;return a[0]!==p&&(a[0]=p,C=!0),a[1]!==T&&(a[1]=T,C=!0),a[2]!==A&&(a[2]=A,C=!0),C}_cacheFloat4(N,p,T,A,a){let C=this._valueCache[N];if(!C||4!==C.length)return C=[p,T,A,a],this._valueCache[N]=C,!0;let U=!1;return C[0]!==p&&(C[0]=p,U=!0),C[1]!==T&&(C[1]=T,U=!0),C[2]!==A&&(C[2]=A,U=!0),C[3]!==a&&(C[3]=a,U=!0),U}setInt(N,p){const T=this._valueCache[N];void 0!==T&&T===p||this.kp.setInt(this._uniforms[N],p)&&(this._valueCache[N]=p)}setInt2(N,p,T){this._cacheFloat2(N,p,T)&&(this.kp.setInt2(this._uniforms[N],p,T)||(this._valueCache[N]=null))}setInt3(N,p,T,A){this._cacheFloat3(N,p,T,A)&&(this.kp.setInt3(this._uniforms[N],p,T,A)||(this._valueCache[N]=null))}setInt4(N,p,T,A,a){this._cacheFloat4(N,p,T,A,a)&&(this.kp.setInt4(this._uniforms[N],p,T,A,a)||(this._valueCache[N]=null))}setIntArray(N,p){this._valueCache[N]=null,this.kp.setIntArray(this._uniforms[N],p)}setIntArray2(N,p){this._valueCache[N]=null,this.kp.setIntArray2(this._uniforms[N],p)}setIntArray3(N,p){this._valueCache[N]=null,this.kp.setIntArray3(this._uniforms[N],p)}setIntArray4(N,p){this._valueCache[N]=null,this.kp.setIntArray4(this._uniforms[N],p)}setUInt(N,p){const T=this._valueCache[N];void 0!==T&&T===p||this.kp.setUInt(this._uniforms[N],p)&&(this._valueCache[N]=p)}setUInt2(N,p,T){this._cacheFloat2(N,p,T)&&(this.kp.setUInt2(this._uniforms[N],p,T)||(this._valueCache[N]=null))}setUInt3(N,p,T,A){this._cacheFloat3(N,p,T,A)&&(this.kp.setUInt3(this._uniforms[N],p,T,A)||(this._valueCache[N]=null))}setUInt4(N,p,T,A,a){this._cacheFloat4(N,p,T,A,a)&&(this.kp.setUInt4(this._uniforms[N],p,T,A,a)||(this._valueCache[N]=null))}setUIntArray(N,p){this._valueCache[N]=null,this.kp.setUIntArray(this._uniforms[N],p)}setUIntArray2(N,p){this._valueCache[N]=null,this.kp.setUIntArray2(this._uniforms[N],p)}setUIntArray3(N,p){this._valueCache[N]=null,this.kp.setUIntArray3(this._uniforms[N],p)}setUIntArray4(N,p){this._valueCache[N]=null,this.kp.setUIntArray4(this._uniforms[N],p)}setArray(N,p){this._valueCache[N]=null,this.kp.setArray(this._uniforms[N],p)}setArray2(N,p){this._valueCache[N]=null,this.kp.setArray2(this._uniforms[N],p)}setArray3(N,p){this._valueCache[N]=null,this.kp.setArray3(this._uniforms[N],p)}setArray4(N,p){this._valueCache[N]=null,this.kp.setArray4(this._uniforms[N],p)}setMatrices(N,p){p&&(this._valueCache[N]=null,this.kp.setMatrices(this._uniforms[N],p))}setMatrix(N,p){this._cacheMatrix(N,p)&&(this.kp.setMatrices(this._uniforms[N],p.UX())||(this._valueCache[N]=null))}setMatrix3x3(N,p){this._valueCache[N]=null,this.kp.setMatrix3x3(this._uniforms[N],p)}setMatrix2x2(N,p){this._valueCache[N]=null,this.kp.setMatrix2x2(this._uniforms[N],p)}setFloat(N,p){const T=this._valueCache[N];void 0!==T&&T===p||this.kp.setFloat(this._uniforms[N],p)&&(this._valueCache[N]=p)}setVector2(N,p){this._cacheFloat2(N,p.x,p.y)&&(this.kp.setFloat2(this._uniforms[N],p.x,p.y)||(this._valueCache[N]=null))}setFloat2(N,p,T){this._cacheFloat2(N,p,T)&&(this.kp.setFloat2(this._uniforms[N],p,T)||(this._valueCache[N]=null))}setVector3(N,p){this._cacheFloat3(N,p.x,p.y,p.z)&&(this.kp.setFloat3(this._uniforms[N],p.x,p.y,p.z)||(this._valueCache[N]=null))}setFloat3(N,p,T,A){this._cacheFloat3(N,p,T,A)&&(this.kp.setFloat3(this._uniforms[N],p,T,A)||(this._valueCache[N]=null))}setVector4(N,p){this._cacheFloat4(N,p.x,p.y,p.z,p.w)&&(this.kp.setFloat4(this._uniforms[N],p.x,p.y,p.z,p.w)||(this._valueCache[N]=null))}setQuaternion(N,p){this._cacheFloat4(N,p.x,p.y,p.z,p.w)&&(this.kp.setFloat4(this._uniforms[N],p.x,p.y,p.z,p.w)||(this._valueCache[N]=null))}setFloat4(N,p,T,A,a){this._cacheFloat4(N,p,T,A,a)&&(this.kp.setFloat4(this._uniforms[N],p,T,A,a)||(this._valueCache[N]=null))}setColor3(N,p){this._cacheFloat3(N,p.r,p.g,p.b)&&(this.kp.setFloat3(this._uniforms[N],p.r,p.g,p.b)||(this._valueCache[N]=null))}setColor4(N,p,T){this._cacheFloat4(N,p.r,p.g,p.b,T)&&(this.kp.setFloat4(this._uniforms[N],p.r,p.g,p.b,T)||(this._valueCache[N]=null))}setDirectColor4(N,p){this._cacheFloat4(N,p.r,p.g,p.b,p.a)&&(this.kp.setFloat4(this._uniforms[N],p.r,p.g,p.b,p.a)||(this._valueCache[N]=null))}_getVertexShaderCode(){return this.vertexShader?this.kp._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.kp._getShaderSource(this.fragmentShader):null}}var a=T(12261);const C=new WeakMap,U={_webGLVersion:2,cachedPipelines:{}};function X(N){let p=C.get(N);if(!p){if(!N)return U;p={_webGLVersion:N.TEXTURE_BINDING_3D?2:1,_context:N,parallelShaderCompile:N.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},C.set(N,p)}return p}function y(N){C.delete(N)}function e(N,p,T,A,a,C){const U=X(A);C||(C=U._createShaderProgramInjection??b);return C(N,L(p,"vertex",A,U._contextWasLost),L(T,"fragment",A,U._contextWasLost),A,a,U.validateShaderPrograms)}function H(N,p,T,A,a){let C=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,U=arguments.length>6?arguments[6]:void 0;const y=X(a);U||(U=y._createShaderProgramInjection??b);const e=y._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return U(N,I(p,"vertex",A,e,a,y._contextWasLost),I(T,"fragment",A,e,a,y._contextWasLost),a,C,y.validateShaderPrograms)}function M(N,p){const T=new A,a=X(N);return a.parallelShaderCompile&&!a.disableParallelShaderCompile&&(T.isParallelCompiled=!0),T.context=a._context,T}function b(N,p,T,A){let a=arguments.length>5?arguments[5]:void 0;const C=A.createProgram();if(N.program=C,!C)throw new Error("Unable to create program");return A.attachShader(C,p),A.attachShader(C,T),A.linkProgram(C),N.context=A,N.vertexShader=p,N.fragmentShader=T,N.isParallelCompiled||k(N,A,a),C}function l(N,p,T){const A=N;if(A._isDisposed)return!1;const a=X(p);return!!(a&&a.parallelShaderCompile&&a.parallelShaderCompile.COMPLETION_STATUS_KHR&&A.program&&p.getProgramParameter(A.program,a.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(k(A,p,T),!0)}function k(N,p,T){const A=N.context,a=N.vertexShader,C=N.fragmentShader,U=N.program;if(!A.getProgramParameter(U,A.LINK_STATUS)){if(!p.getShaderParameter(a,p.COMPILE_STATUS)){const T=p.getShaderInfoLog(a);if(T)throw N.vertexCompilationError=T,new Error("VERTEX SHADER "+T)}if(!p.getShaderParameter(C,p.COMPILE_STATUS)){const T=p.getShaderInfoLog(C);if(T)throw N.fragmentCompilationError=T,new Error("FRAGMENT SHADER "+T)}const T=A.getProgramInfoLog(U);if(T)throw N.programLinkError=T,new Error(T)}if(T){A.validateProgram(U);if(!A.getProgramParameter(U,A.VALIDATE_STATUS)){const p=A.getProgramInfoLog(U);if(p)throw N.programValidationError=p,new Error(p)}}A.deleteShader(a),A.deleteShader(C),N.vertexShader=void 0,N.fragmentShader=void 0,N.onCompiled&&(N.onCompiled(),N.onCompiled=void 0)}function x(N,p,T,A,a,C,U,y,M){let b=arguments.length>10?arguments[10]:void 0,l=arguments.length>11?arguments[11]:void 0,k=arguments.length>12?arguments[12]:void 0;const x=X(N.context);l||(l=x.createRawShaderProgramInjection??e),k||(k=x.createShaderProgramInjection??H);const I=N;I.program=A?l(I,p,T,I.context,M):k(I,p,T,y,I.context,M),I.program.__SPECTOR_rebuildProgram=U,b()}function I(N,p,T,A,C,U){return L((0,a.h)(N,T,A),p,C,U)}function L(N,p,T,A){const a=T.createShader("vertex"===p?T.VERTEX_SHADER:T.FRAGMENT_SHADER);if(!a){let N=T.NO_ERROR,a=T.NO_ERROR;for(;(a=T.getError())!==T.NO_ERROR;)N=a;throw new Error(`Something went wrong while creating a gl ${p} shader object. gl error=${N}, gl isContextLost=${T.isContextLost()}, _contextWasLost=${A}`)}return T.shaderSource(a,N),T.compileShader(a),a}function n(N,p){p.useProgram(N)}function w(N,p){const T=N;if(!T.isParallelCompiled)return void p(N);const A=T.onCompiled;T.onCompiled=()=>{null===A||void 0===A||A(),p(N)}}},12285:(N,p,T)=>{T.d(p,{d:()=>M,h:()=>l,l:()=>e,o:()=>H});var A=T(12198),a=T(12294),C=T(12281),U=T(12205),X=T(12257),y=T(12261);function e(N,p){return(0,a.z)(p).cachedPipelines[N]}function H(N){const p=N._name,T=N.context;if(p&&T){const N=(0,a.z)(T),A=N.cachedPipelines[p];null===A||void 0===A||A.dispose(),delete N.cachedPipelines[p]}}function M(N,p,T,a,C,U,y){let e,H;const M=(0,A.h)()?null===U||void 0===U?void 0:U.getHostDocument():null;e="string"===typeof p?p:p.vertexSource?"source:"+p.vertexSource:p.vertexElement?(null===M||void 0===M?void 0:M.getElementById(p.vertexElement))||p.vertexElement:p.vertex||p,H="string"===typeof p?p:p.fragmentSource?"source:"+p.fragmentSource:p.fragmentElement?(null===M||void 0===M?void 0:M.getElementById(p.fragmentElement))||p.fragmentElement:p.fragment||p;const l=[void 0,void 0],k=()=>{if(l[0]&&l[1]){N.isFragment=!0;const[A,e]=l;(0,X.i)(e,N,((U,e)=>{y&&(y._fragmentSourceCodeBeforeMigration=e),T&&(U=T("fragment",U));const H=(0,X.b)(A,U,N);N=null;const M=function(N,p,T,A){if(T){return{vertexSourceCode:(1===A?"//":"")+"#define SHADER_NAME vertex:"+(T.vertexElement||T.vertex||T.spectorName||T)+"\n"+N,fragmentSourceCode:(1===A?"//":"")+"#define SHADER_NAME fragment:"+(T.fragmentElement||T.fragment||T.spectorName||T)+"\n"+p}}return{vertexSourceCode:N,fragmentSourceCode:p}}(H.vertexCode,H.fragmentCode,p,C);null===a||void 0===a||a(M.vertexSourceCode,M.fragmentSourceCode)}),U)}};b(e,"Vertex","",(p=>{(0,X.c)(N),(0,X.i)(p,N,((N,A)=>{y&&(y._rawVertexSourceCode=p,y._vertexSourceCodeBeforeMigration=A),T&&(N=T("vertex",N)),l[0]=N,k()}),U)}),C),b(H,"Fragment","Pixel",(N=>{y&&(y._rawFragmentSourceCode=N),l[1]=N,k()}),C)}function b(N,p,T,a,U,X){if("undefined"!==typeof HTMLElement&&N instanceof HTMLElement){return void a((0,A.c)(N))}if("source:"===N.substring(0,7))return void a(N.substring(7));if("base64:"===N.substring(0,7)){return void a(window.atob(N.substring(7)))}const e=C.b.GetShadersStore(U);if(e[N+p+"Shader"])return void a(e[N+p+"Shader"]);if(T&&e[N+T+"Shader"])return void a(e[N+T+"Shader"]);let H;if(H="."===N[0]||"/"===N[0]||N.indexOf("http")>-1?N:C.b.GetShadersRepository(U)+N,!(X=X||y.l))throw new Error("loadFileInjection is not defined");X(H+"."+p.toLowerCase()+".fx",a)}const l=(N,p,T,A)=>{try{const C=N.context?(0,a.z)(N.context):null;C&&(C.disableParallelShaderCompile=N.disableParallelCompilation);const U=N.existingPipelineContext||p(N.shaderProcessingContext);return U._name=N.name,N.name&&C&&(C.cachedPipelines[N.name]=U),T(U,N.vertex,N.fragment,!!N.createAsRaw,"","",N.rebuildRebind,N.defines,N.transformFeedbackVaryings,"",(()=>{A(U,(()=>{var p;null===(p=N.onRenderingStateCompiled)||void 0===p||p.call(N,U)}))})),U}catch(C){throw U.d.Error("Error compiling effect"),C}}},12276:(N,p,T)=>{T.r(p),T.d(p,{Effect:()=>y});var A=T(12194),a=T(12205),C=T(12281),U=T(12285),X=T(12264);class y{static get ShadersRepository(){return C.b.ShadersRepository}static set ShadersRepository(N){C.b.ShadersRepository=N}get X(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new A.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(N,p,T){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,C=arguments.length>4?arguments[4]:void 0,X=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,e=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,H=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,M=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,b=arguments.length>9?arguments[9]:void 0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",k=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,x=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new A.c,this.onErrorObservable=new A.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=N,this._key=l;const I=this._key.replace(/\r/g,"").replace(/\n/g,"|");let L;if(p.attributes){const N=p;if(this._engine=T,this._attributesNames=N.attributes,this._uniformsNames=N.uniformsNames.concat(N.samplers),this._samplerList=N.samplers.slice(),this.defines=N.defines,this.onError=N.onError,this.onCompiled=N.onCompiled,this._fallbacks=N.fallbacks,this._indexParameters=N.indexParameters,this._transformFeedbackVaryings=N.transformFeedbackVaryings||null,this._multiTarget=!!N.multiTarget,this._shaderLanguage=N.shaderLanguage??0,this._disableParallelShaderCompilation=!!N.disableParallelShaderCompilation,N.uniformBuffersNames){this._uniformBuffersNamesList=N.uniformBuffersNames.slice();for(let p=0;p<N.uniformBuffersNames.length;p++)this._uniformBuffersNames[N.uniformBuffersNames[p]]=p}this._processFinalCode=N.processFinalCode??null,this._processCodeAfterIncludes=N.processCodeAfterIncludes??void 0,x=N.extraInitializationsAsync,L=N.existingPipelineContext}else this._engine=C,this.defines=null==X?"":X,this._uniformsNames=T.concat(a),this._samplerList=a?a.slice():[],this._attributesNames=p,this._uniformBuffersNamesList=[],this._shaderLanguage=k,this.onError=M,this.onCompiled=H,this._indexParameters=b,this._fallbacks=e;"WEBGL2"===this._engine.shaderPlatformName&&(L=(0,U.l)(I,this._engine._gl)??L),this._attributeLocationByName={},this.uniqueId=y._UniqueIdSeed++,L?(this._pipelineContext=L,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,x),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.X||this.dispose(!0)}))}async _processShaderCodeAsync(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,p=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=arguments.length>3?arguments[3]:void 0;A&&await A(),this._processingContext=T||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const a={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:N??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:C.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:C.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,BU:this._engine.BU,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,U.d)(a,this.name,this._processFinalCode,((N,T)=>{this._vertexSourceCode=N,this._fragmentSourceCode=T,this._prepareEffect(p)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.X||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(N){return this._attributes[N]}getAttributeLocationByName(N){return this._attributeLocationByName[N]}getAttributesCount(){return this._attributes.length}getUniformIndex(N){return this._uniformsNames.indexOf(N)}getUniform(N){return this._uniforms[N]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((N=>{this.executeWhenCompiled(N)}))}executeWhenCompiled(N){this.isReady()?N(this):(this.onCompileObservable.add((p=>{N(p)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(N){(0,X.g)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(p=>{this._processCompilationErrors(p,N)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,BU:this._engine.BU,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(N,p,T,A){this._isReady=!1,this._vertexSourceCodeOverride=N,this._fragmentSourceCodeOverride=p,this.onError=(N,p)=>{A&&A(p)},this.onCompiled=()=>{var N,p;const A=this.getEngine().scenes;if(A)for(let T=0;T<A.length;T++)A[T].markAllMaterialsAsDirty(127);null===(N=(p=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===N||N.call(p,T)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(N){if(this._pipelineContext=N,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let p=0;p<this._attributesNames.length;p++){const N=this._attributesNames[p];this._attributeLocationByName[N]=this._attributes[p]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),y.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const p=this._pipelineContext;this._isReady=!1;try{const T=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),A=T?null:this.defines,a=T?this._vertexSourceCodeOverride:this._vertexSourceCode,C=T?this._fragmentSourceCodeOverride:this._fragmentSourceCode,X=this._engine;this._pipelineContext=(0,U.h)({existingPipelineContext:N?p:null,vertex:a,fragment:C,context:"WEBGL2"===X.shaderPlatformName||"WEBGL1"===X.shaderPlatformName?X._gl:void 0,rebuildRebind:(N,p,T,A)=>this._rebuildProgram(N,p,T,A),defines:A,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:T,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:T=>{p&&!N&&this._engine._deletePipelineContext(p),T&&this._onRenderingStateCompiled(T)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(p)}catch(T){this._processCompilationErrors(T,p)}}_getShaderCodeAndErrorLine(N,p,T){const A=T?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let a=null;if(p&&N){const C=p.match(A);if(C&&2===C.length){const p=parseInt(C[1]),A=N.split("\n",-1);A.length>=p&&(a=`Offending line [${p}] in ${T?"fragment":"vertex"} code: ${A[p-1]}`)}}return[N,a]}_processCompilationErrors(N){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=N.message;const T=this._attributesNames,A=this._fallbacks;if(a.d.Error("Unable to compile effect:"),a.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),a.d.Error(`Attributes: ${T.join(" ")}`),a.d.Error("Defines:\n"+this.defines),y.LogShaderCodeOnCompilationError){var C,U;let N=null,p=null,T=null;var X;if(null!==(C=this._pipelineContext)&&void 0!==C&&C._getVertexShaderCode()&&([T,N]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),T&&(a.d.Error("Vertex code:"),a.d.Error(T))),null!==(U=this._pipelineContext)&&void 0!==U&&U._getFragmentShaderCode())[T,p]=this._getShaderCodeAndErrorLine(null===(X=this._pipelineContext)||void 0===X?void 0:X._getFragmentShaderCode(),this._compilationError,!0),T&&(a.d.Error("Fragment code:"),a.d.Error(T));N&&a.d.Error(N),p&&a.d.Error(p)}a.d.Error("Error: "+this._compilationError);const e=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};p&&(this._pipelineContext=p,this._isReady=!0,e()),A?(this._pipelineContext=null,A.hasMoreFallbacks?(this._allFallbacksProcessed=!1,a.d.Error("Trying next fallback."),this.defines=A.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,e(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,p||e())}get isSupported(){return""===this._compilationError}_bindTexture(N,p){this._engine._bindTexture(this._samplers[N],p,N)}setTexture(N,p){this._engine.setTexture(this._samplers[N],this._uniforms[N],p,N)}setTextureArray(N,p){const T=N+"Ex";if(-1===this._samplerList.indexOf(T+"0")){const A=this._samplerList.indexOf(N);for(let N=1;N<p.length;N++){const p=T+(N-1).toString();this._samplerList.splice(A+N,0,p)}let a=0;for(const N of this._samplerList)this._samplers[N]=a,a+=1}this._engine.setTextureArray(this._samplers[N],this._uniforms[N],p,N)}bindUniformBuffer(N,p){const T=this._uniformBuffersNames[p];void 0===T||y._BaseCache[T]===N&&this._engine._features.useUBOBindingCache||(y._BaseCache[T]=N,this._engine.bindUniformBufferBase(N,T,p))}bindUniformBlock(N,p){this._engine.bindUniformBlock(this._pipelineContext,N,p)}setInt(N,p){return this._pipelineContext.setInt(N,p),this}setInt2(N,p,T){return this._pipelineContext.setInt2(N,p,T),this}setInt3(N,p,T,A){return this._pipelineContext.setInt3(N,p,T,A),this}setInt4(N,p,T,A,a){return this._pipelineContext.setInt4(N,p,T,A,a),this}setIntArray(N,p){return this._pipelineContext.setIntArray(N,p),this}setIntArray2(N,p){return this._pipelineContext.setIntArray2(N,p),this}setIntArray3(N,p){return this._pipelineContext.setIntArray3(N,p),this}setIntArray4(N,p){return this._pipelineContext.setIntArray4(N,p),this}setUInt(N,p){return this._pipelineContext.setUInt(N,p),this}setUInt2(N,p,T){return this._pipelineContext.setUInt2(N,p,T),this}setUInt3(N,p,T,A){return this._pipelineContext.setUInt3(N,p,T,A),this}setUInt4(N,p,T,A,a){return this._pipelineContext.setUInt4(N,p,T,A,a),this}setUIntArray(N,p){return this._pipelineContext.setUIntArray(N,p),this}setUIntArray2(N,p){return this._pipelineContext.setUIntArray2(N,p),this}setUIntArray3(N,p){return this._pipelineContext.setUIntArray3(N,p),this}setUIntArray4(N,p){return this._pipelineContext.setUIntArray4(N,p),this}setFloatArray(N,p){return this._pipelineContext.setArray(N,p),this}setFloatArray2(N,p){return this._pipelineContext.setArray2(N,p),this}setFloatArray3(N,p){return this._pipelineContext.setArray3(N,p),this}setFloatArray4(N,p){return this._pipelineContext.setArray4(N,p),this}setArray(N,p){return this._pipelineContext.setArray(N,p),this}setArray2(N,p){return this._pipelineContext.setArray2(N,p),this}setArray3(N,p){return this._pipelineContext.setArray3(N,p),this}setArray4(N,p){return this._pipelineContext.setArray4(N,p),this}setMatrices(N,p){return this._pipelineContext.setMatrices(N,p),this}setMatrix(N,p){return this._pipelineContext.setMatrix(N,p),this}setMatrix3x3(N,p){return this._pipelineContext.setMatrix3x3(N,p),this}setMatrix2x2(N,p){return this._pipelineContext.setMatrix2x2(N,p),this}setFloat(N,p){return this._pipelineContext.setFloat(N,p),this}setBool(N,p){return this._pipelineContext.setInt(N,p?1:0),this}setVector2(N,p){return this._pipelineContext.setVector2(N,p),this}setFloat2(N,p,T){return this._pipelineContext.setFloat2(N,p,T),this}setVector3(N,p){return this._pipelineContext.setVector3(N,p),this}setFloat3(N,p,T,A){return this._pipelineContext.setFloat3(N,p,T,A),this}setVector4(N,p){return this._pipelineContext.setVector4(N,p),this}setQuaternion(N,p){return this._pipelineContext.setQuaternion(N,p),this}setFloat4(N,p,T,A,a){return this._pipelineContext.setFloat4(N,p,T,A,a),this}setColor3(N,p){return this._pipelineContext.setColor3(N,p),this}setColor4(N,p,T){return this._pipelineContext.setColor4(N,p,T),this}setDirectColor4(N,p){return this._pipelineContext.setDirectColor4(N,p),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(y.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,U.o)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(N,p,T){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;p&&(C.b.GetShadersStore(A)[`${N}PixelShader`]=p),T&&(C.b.GetShadersStore(A)[`${N}VertexShader`]=T)}static ResetCache(){y._BaseCache={}}}y.LogShaderCodeOnCompilationError=!0,y.PersistentMode=!1,y.AutomaticallyClearCodeCache=!1,y._UniqueIdSeed=0,y._BaseCache={},y.ShadersStore=C.b.ShadersStore,y.IncludesShadersStore=C.b.IncludesShadersStore},12218:(N,p,T)=>{T.d(p,{c:()=>a});const A={};function a(N){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!A[N])return A[N]=!0,`${N} needs to be imported before as it contains a side-effect required by your code.`}},12198:(N,p,T)=>{function A(){return"undefined"!==typeof window}function a(){return"undefined"!==typeof navigator}function C(){return"undefined"!==typeof document}function U(N){let p="",T=N.firstChild;for(;T;)3===T.nodeType&&(p+=T.textContent),T=T.nextSibling;return p}T.d(p,{c:()=>U,d:()=>C,g:()=>a,h:()=>A})},12205:(N,p,T)=>{T.d(p,{d:()=>A});class A{static _CheckLimit(N,p){let T=A._LogLimitOutputs[N];return T?T.current++:(T={limit:p,current:1},A._LogLimitOutputs[N]=T),T.current<=T.limit}static _GenerateLimitMessage(N){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const T=A._LogLimitOutputs[N];if(!T||!A.MessageLimitReached)return;const a=this._Levels[p];T.current===T.limit&&A[a.name](A.MessageLimitReached.replace(/%LIMIT%/g,""+T.limit).replace(/%TYPE%/g,a.name??""))}static _AddLogEntry(N){A._LogCache=N+A._LogCache,A.OnNewCacheEntry&&A.OnNewCacheEntry(N)}static _FormatMessage(N){const p=N=>N<10?"0"+N:""+N,T=new Date;return"["+p(T.getHours())+":"+p(T.getMinutes())+":"+p(T.getSeconds())+"]: "+N}static _LogDisabled(N,p){}static _LogEnabled(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,p=arguments.length>1?arguments[1]:void 0,T=arguments.length>2?arguments[2]:void 0;const a=Array.isArray(p)?p[0]:p;if(void 0!==T&&!A._CheckLimit(a,T))return;const C=A._FormatMessage(a),U=this._Levels[N],X=Array.isArray(p)?p.slice(1):[];U.logFunc&&U.logFunc("BJS - "+C,...X);const y=`<div style='color:${U.color}'>${C}</div><br>`;A._AddLogEntry(y),A._GenerateLimitMessage(a,N)}static get LogCache(){return A._LogCache}static ClearLogCache(){A._LogCache="",A._LogLimitOutputs={},A.errorsCount=0}static set LogLevels(N){A.Log=A._LogDisabled,A.Warn=A._LogDisabled,A.Error=A._LogDisabled;const p=[A.MessageLogLevel,A.WarningLogLevel,A.ErrorLogLevel];for(const T of p)if((N&T)===T){const N=this._Levels[T];A[N.name]=A._LogEnabled.bind(A,T)}}}A.NoneLogLevel=0,A.MessageLogLevel=1,A.WarningLogLevel=2,A.ErrorLogLevel=4,A.AllLogLevel=7,A.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",A._LogCache="",A._LogLimitOutputs={},A._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],A.errorsCount=0,A.Log=A._LogEnabled.bind(A,A.MessageLogLevel),A.Warn=A._LogEnabled.bind(A,A.WarningLogLevel),A.Error=A._LogEnabled.bind(A,A.ErrorLogLevel)},12194:(N,p,T)=>{T.d(p,{c:()=>U});const A="undefined"!==typeof WeakRef;class a{constructor(N){let p=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;this.initialize(N,p,T,A)}initialize(N){let p=arguments.length>1&&void 0!==arguments[1]&&arguments[1],T=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;return this.mask=N,this.skipNextObservers=p,this.target=T,this.currentTarget=A,this}}class C{constructor(N,p){let T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=N,this.mask=p,this.scope=T,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(N)}}class U{static FromPromise(N,p){const T=new U;return N.then((N=>{T.notifyObservers(N)})).catch((N=>{if(!p)throw N;p.notifyObservers(N)})),T}get observers(){return this._observers}constructor(N){let p=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=p,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new a(0),N&&(this._onObserverAdded=N)}add(N){let p=arguments.length>2&&void 0!==arguments[2]&&arguments[2],T=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!N)return null;const a=new C(N,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);a.unregisterOnNextCall=T,p?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(a,this._lastNotifiedValue);const U=A?new WeakRef(this):{deref:()=>this};return a._remove=function(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const p=U.deref();p&&(N?p.remove(a):p._remove(a))},a}addOnce(N){return this.add(N,void 0,void 0,void 0,!0)}remove(N){if(!N)return!1;N._remove=null;return-1!==this._observers.indexOf(N)&&(this._deferUnregister(N),!0)}removeCallback(N,p){for(let T=0;T<this._observers.length;T++){const A=this._observers[T];if(!A._willBeUnregistered&&(A.callback===N&&(!p||p===A.scope)))return this._deferUnregister(A),!0}return!1}_deferUnregister(N){N._willBeUnregistered||(this._numObserversMarkedAsDeleted++,N.unregisterOnNextCall=!1,N._willBeUnregistered=!0,setTimeout((()=>{this._remove(N)}),0))}_remove(N){let p=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!N)return!1;const T=this._observers.indexOf(N);return-1!==T&&(p&&this._numObserversMarkedAsDeleted--,this._observers.splice(T,1),!0)}makeObserverTopPriority(N){this._remove(N,!1),this._observers.unshift(N)}makeObserverBottomPriority(N){this._remove(N,!1),this._observers.push(N)}notifyObservers(N){let p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,T=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=N),!this._observers.length)return!0;const C=this._eventState;C.mask=p,C.target=T,C.currentTarget=A,C.skipNextObservers=!1,C.lastReturnValue=N,C.userInfo=a;for(const U of this._observers)if(!U._willBeUnregistered&&(U.mask&p&&(U.unregisterOnNextCall&&this._deferUnregister(U),U.scope?C.lastReturnValue=U.callback.apply(U.scope,[N,C]):C.lastReturnValue=U.callback(N,C)),C.skipNextObservers))return!1;return!0}notifyObserver(N,p){let T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=p),N._willBeUnregistered)return;const A=this._eventState;A.mask=T,A.skipNextObservers=!1,N.unregisterOnNextCall&&this._deferUnregister(N),N.callback(p,A)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const N=this._observers.pop();N&&(N._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const N=new U;return N._observers=this._observers.slice(0),N}hasSpecificMask(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const p of this._observers)if(p.mask&N||p.mask===N)return!0;return!1}}},12264:(N,p,T)=>{T.d(p,{d:()=>a,g:()=>U});let A=[];class a{static SetImmediate(N){0===A.length&&setTimeout((()=>{const N=A;A=[];for(const p of N)p()}),1),A.push(N)}}function C(N,p,T){try{if(N())return p(),!0}catch(A){return null===T||void 0===T||T(A),!0}return!1}const U=function(N,p,T){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,U=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&C(N,p,T))return null;const X=setInterval((()=>{C(N,p,T)?clearInterval(X):(a-=A,a<0&&(clearInterval(X),null===T||void 0===T||T(new Error("Operation timed out after maximum retries. "+(U||"")),!0)))}),A);return()=>clearInterval(X)}}}]);