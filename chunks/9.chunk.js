"use strict";(self.bjbkv7h3qsd=self.bjbkv7h3qsd||[]).push([[9],{11106:(G,A,j)=>{j.d(A,{c:()=>g,e:()=>I,j:()=>D,g:()=>W,l:()=>J});class u{constructor(){this.children=[]}isValid(G){return!0}process(G,A,j){let u="";if(this.line){let j=this.line;const h=A.processor;if(h){var k,B,x,s,O,d;h.lineProcessor&&(j=h.lineProcessor(j,A.isFragment,A.processingContext));const u=(null===(k=A.processor)||void 0===k?void 0:k.attributeKeywordName)??"attribute",H=A.isFragment&&null!==(B=A.processor)&&void 0!==B&&B.varyingFragmentKeywordName?null===(x=A.processor)||void 0===x?void 0:x.varyingFragmentKeywordName:!A.isFragment&&null!==(s=A.processor)&&void 0!==s&&s.varyingVertexKeywordName?null===(O=A.processor)||void 0===O?void 0:O.varyingVertexKeywordName:"varying";if(!A.isFragment&&h.attributeProcessor&&this.line.startsWith(u))j=h.attributeProcessor(this.line,G,A.processingContext);else if(h.varyingProcessor&&(null!==(d=h.varyingCheck)&&void 0!==d&&d.call(h,this.line,A.isFragment)||!h.varyingCheck&&this.line.startsWith(H)))j=h.varyingProcessor(this.line,A.isFragment,G,A.processingContext);else if(h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line))A.lookForClosingBracketForUniformBuffer||(j=h.uniformProcessor(this.line,A.isFragment,G,A.processingContext));else if(h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line))A.lookForClosingBracketForUniformBuffer||(j=h.uniformBufferProcessor(this.line,A.isFragment,A.processingContext),A.lookForClosingBracketForUniformBuffer=!0);else if(h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line))j=h.textureProcessor(this.line,A.isFragment,G,A.processingContext);else if((h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!A.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?h.uniformProcessor&&(j=h.uniformProcessor(this.line,A.isFragment,G,A.processingContext)):h.uniformBufferProcessor&&(j=h.uniformBufferProcessor(this.line,A.isFragment,A.processingContext),A.lookForClosingBracketForUniformBuffer=!0)}A.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(A.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(j=h.endOfUniformBufferProcessor(this.line,A.isFragment,A.processingContext)))}u+=j+"\n"}for(const h of this.children)u+=h.process(G,A,j);return this.additionalDefineKey&&(G[this.additionalDefineKey]=this.additionalDefineValue||"true",j[this.additionalDefineKey]=G[this.additionalDefineKey]),u}}class k{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(G){this._lines.length=0;for(const A of G){if(!A||"\r"===A)continue;if("#"===A[0]){this._lines.push(A);continue}const G=A.trim();if(!G)continue;if(G.startsWith("//")){this._lines.push(A);continue}const j=G.indexOf(";");if(-1===j)this._lines.push(G);else if(j===G.length-1)G.length>1&&this._lines.push(G);else{const G=A.split(";");for(let A=0;A<G.length;A++){let j=G[A];j&&(j=j.trim(),j&&this._lines.push(j+(A!==G.length-1?";":"")))}}}}}class B extends u{process(G,A,j){for(let u=0;u<this.children.length;u++){const k=this.children[u];if(k.isValid(G))return k.process(G,A,j)}return""}}class x extends u{isValid(G){return this.testExpression.isTrue(G)}}class s{isTrue(G){return!0}static postfixToInfix(G){const A=[];for(const j of G)if(void 0===s._OperatorPriority[j])A.push(j);else{const G=A[A.length-1],u=A[A.length-2];A.length-=2,A.push(`(${u}${j}${G})`)}return A[A.length-1]}static infixToPostfix(G){const A=s._InfixToPostfixCache.get(G);if(A)return A.accessTime=Date.now(),A.result;if(!G.includes("&&")&&!G.includes("||")&&!G.includes(")")&&!G.includes("("))return[G];const j=[];let u=-1;const k=()=>{h=h.trim(),""!==h&&(j.push(h),h="")},B=G=>{u<s._Stack.length-1&&(s._Stack[++u]=G)},x=()=>s._Stack[u],O=()=>-1===u?"!!INVALID EXPRESSION!!":s._Stack[u--];let d=0,h="";for(;d<G.length;){const A=G.charAt(d),H=d<G.length-1?G.substring(d,2+d):"";if("("===A)h="",B(A);else if(")"===A){for(k();-1!==u&&"("!==x();)j.push(O());O()}else if(s._OperatorPriority[H]>1){for(k();-1!==u&&s._OperatorPriority[x()]>=s._OperatorPriority[H];)j.push(O());B(H),d++}else h+=A;d++}for(k();-1!==u;)"("===x()?O():j.push(O());return s._InfixToPostfixCache.size>=s.InfixToPostfixCacheLimitSize&&s.ClearCache(),s._InfixToPostfixCache.set(G,{result:j,accessTime:Date.now()}),j}static ClearCache(){const G=Array.from(s._InfixToPostfixCache.entries()).sort(((G,A)=>G[1].accessTime-A[1].accessTime));for(let A=0;A<s.InfixToPostfixCacheCleanupSize;A++)s._InfixToPostfixCache.delete(G[A][0])}}s.InfixToPostfixCacheLimitSize=5e4,s.InfixToPostfixCacheCleanupSize=25e3,s._InfixToPostfixCache=new Map,s._OperatorPriority={")":0,"(":1,"||":2,"&&":3},s._Stack=["","","","","","","","","","","","","","","","","","","",""];class O extends s{constructor(G){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=G,this.not=A}isTrue(G){let A=void 0!==G[this.define];return this.not&&(A=!A),A}}class d extends s{isTrue(G){return this.leftOperand.isTrue(G)||this.rightOperand.isTrue(G)}}class h extends s{isTrue(G){return this.leftOperand.isTrue(G)&&this.rightOperand.isTrue(G)}}class H extends s{constructor(G,A,j){super(),this.define=G,this.operand=A,this.testValue=j}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(G){let A=!1;const j=parseInt(void 0!=G[this.define]?G[this.define]:this.define),u=parseInt(void 0!=G[this.testValue]?G[this.testValue]:this.testValue);if(isNaN(j)||isNaN(u))return!1;switch(this.operand){case">":A=j>u;break;case"<":A=j<u;break;case"<=":A=j<=u;break;case">=":A=j>=u;break;case"==":A=j===u;break;case"!=":A=j!==u}return A}}var F=j(11075),R=j(11112);const U=/defined\s*?\((.+?)\)/g,S=/defined\s*?\[(.+?)\]/g,C=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,t=/__decl__/,Y=/light\{X\}.(\w*)/g,n=/\{X\}/g,Q=[],X=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function I(G){G.processor&&G.processor.initializeShaders&&G.processor.initializeShaders(G.processingContext)}function D(G,A,j,u){var k;null!==(k=A.processor)&&void 0!==k&&k.preProcessShaderCode&&(G=A.processor.preProcessShaderCode(G,A.isFragment)),W(G,A,(G=>{A.processCodeAfterIncludes&&(G=A.processCodeAfterIncludes(A.isFragment?"fragment":"vertex",G,A.defines));const k=function(G,A,j){let u=function(G,A){var j;if(null!==(j=A.processor)&&void 0!==j&&j.noPrecision)return G;const u=A.shouldUseHighPrecisionShader;-1===G.indexOf("precision highp float")?G=u?"precision highp float;\n"+G:"precision mediump float;\n"+G:u||(G=G.replace("precision highp float","precision mediump float"));return G}(G,A);if(!A.processor)return u;if(0===A.processor.shaderLanguage&&-1!==u.indexOf("#version 3")&&(u=u.replace("#version 300 es",""),!A.processor.parseGLES3))return u;const k=A.defines,B=o(A,j);A.processor.preProcessor&&(u=A.processor.preProcessor(u,k,B,A.isFragment,A.processingContext));const x={};u=M(u,B,A,x),A.processor.postProcessor&&(u=A.processor.postProcessor(u,k,A.isFragment,A.processingContext,j?{drawBuffersExtensionDisabled:!j.getCaps().drawBuffersExtension}:{},B,x));null!==j&&void 0!==j&&j._features.needShaderCodeInlining&&(u=j.inlineShaderCode(u));return u}(G,A,u);j(k,G)}))}function g(G,A,j){return j.processor&&j.processor.finalizeShaders?j.processor.finalizeShaders(G,A,j.processingContext):{vertexCode:G,fragmentCode:A}}function c(G){const A=/defined\((.+)\)/.exec(G);if(A&&A.length)return new O(A[1].trim(),"!"===G[0]);const j=["==","!=",">=","<=","<",">"];let u="",k=0;for(u of j)if(k=G.indexOf(u),k>-1)break;if(-1===k)return new O(G);const B=G.substring(0,k).trim(),x=G.substring(k+u.length).trim();return new H(B,u,x)}function E(G,A){const j=new x,u=G.substring(0,A);let k=G.substring(A);return k=k.substring(0,(k.indexOf("//")+1||k.length+1)-1).trim(),j.testExpression="#ifdef"===u?new O(k):"#ifndef"===u?new O(k,!0):function(G){G=G.replace(U,"defined[$1]");const A=s.infixToPostfix(G),j=[];for(const k of A)if("||"!==k&&"&&"!==k)j.push(k);else if(j.length>=2){let G=j[j.length-1],A=j[j.length-2];j.length-=2;const u="&&"==k?new h:new d;"string"===typeof G&&(G=G.replace(S,"defined($1)")),"string"===typeof A&&(A=A.replace(S,"defined($1)")),u.leftOperand="string"===typeof A?c(A):A,u.rightOperand="string"===typeof G?c(G):G,j.push(u)}let u=j[j.length-1];return"string"===typeof u&&(u=u.replace(S,"defined($1)")),"string"===typeof u?c(u):u}(k),j}function r(G,A,j,k){let B=G.currentLine;for(;b(G,j,k);){B=G.currentLine;const x=B.substring(0,5).toLowerCase();if("#else"===x){const j=new u;return A.children.push(j),void b(G,j,k)}if("#elif"===x){const G=E(B,5);A.children.push(G),j=G}}}function b(G,A,j){for(;G.canRead;){G.lineIndex++;const k=G.currentLine;if(k.indexOf("#")>=0){const u=X.exec(k);if(u&&u.length){switch(u[0]){case"#ifdef":{const u=new B;A.children.push(u);const x=E(k,6);u.children.push(x),r(G,u,x,j);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const u=new B;A.children.push(u);const x=E(k,7);u.children.push(x),r(G,u,x,j);break}case"#if":{const u=new B,x=E(k,3);A.children.push(u),u.children.push(x),r(G,u,x,j);break}}continue}}const x=new u;if(x.line=k,A.children.push(x),"#"===k[0]&&"d"===k[1]){const G=k.replace(";","").split(" ");x.additionalDefineKey=G[1],3===G.length&&(x.additionalDefineValue=G[2])}}return!1}function M(G,A,j,B){const x=new u,s=new k;return s.lineIndex=-1,s.lines=G.split("\n"),b(s,x,B),x.process(A,j,B)}function o(G,A){var j;const u=G.defines,k={};for(const B of u){const G=B.replace("#define","").replace(";","").trim().split(" ");k[G[0]]=G.length>1?G[1]:""}return 0===(null===(j=G.processor)||void 0===j?void 0:j.shaderLanguage)&&(k.GL_ES="true"),k.__VERSION__=G.version,k[G.platformName]="true",(0,R.d)(k,null===A||void 0===A?void 0:A.isNDCHalfZRange,null===A||void 0===A?void 0:A.useReverseDepthBuffer,null===A||void 0===A?void 0:A.useExactSrgbConversions),k}function W(G,A,j){let u;for(Q.length=0;null!==(u=C.exec(G));)Q.push(u);let k=String(G),B=[G],x=!1;for(const s of Q){let G=s[1];if(-1!==G.indexOf("__decl__")&&(G=G.replace(t,""),A.supportsUniformBuffers&&(G=G.replace("Vertex","Ubo").replace("Fragment","Ubo")),G+="Declaration"),!A.includesShadersStore[G]){const u=A.shadersRepository+"ShadersInclude/"+G+".fx";return void J.loadFile(u,(u=>{A.includesShadersStore[G]=u,W(B.join(""),A,j)}))}{let j=A.includesShadersStore[G];if(s[2]){const G=s[3].split(",");for(let A=0;A<G.length;A+=2){const u=new RegExp(G[A],"g"),k=G[A+1];j=j.replace(u,k)}}if(s[4]){const G=s[5];if(-1!==G.indexOf("..")){const u=G.split(".."),k=parseInt(u[0]);let B=parseInt(u[1]),x=j.slice(0);j="",isNaN(B)&&(B=A.indexParameters[u[1]]);for(let G=k;G<B;G++)A.supportsUniformBuffers||(x=x.replace(Y,((G,A)=>A+"{X}"))),j+=x.replace(n,G.toString())+"\n"}else A.supportsUniformBuffers||(j=j.replace(Y,((G,A)=>A+"{X}"))),j=j.replace(n,G)}const u=[];for(const G of B){const A=G.split(s[0]);for(let G=0;G<A.length-1;G++)u.push(A[G]),u.push(j);u.push(A[A.length-1])}B=u,x=x||j.indexOf("#include<")>=0||j.indexOf("#include <")>=0}}Q.length=0,k=B.join(""),x?W(k.toString(),A,j):j(k)}const J={loadFile:(G,A,j,u,k,B)=>{throw(0,F.c)("FileTools")}}},11112:(G,A,j)=>{j.d(A,{b:()=>k,c:()=>B,d:()=>s,e:()=>x,f:()=>O});var u=j(11075);j(11057);const k={};function B(G,A){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(A?A+"\n":"")+G}function x(G,A,j,B,x,s,O){const d=O||k.loadFile;if(d){return d(G,A,j,B,x,s)}throw(0,u.c)("FileTools")}function s(G,A,j,u){if(G)return A?G.IS_NDC_HALF_ZRANGE="":delete G.IS_NDC_HALF_ZRANGE,j?G.USE_REVERSE_DEPTHBUFFER="":delete G.USE_REVERSE_DEPTHBUFFER,void(u?G.USE_EXACT_SRGB_CONVERSIONS="":delete G.USE_EXACT_SRGB_CONVERSIONS);{let G="";return A&&(G+="#define IS_NDC_HALF_ZRANGE"),j&&(G&&(G+="\n"),G+="#define USE_REVERSE_DEPTHBUFFER"),u&&(G&&(G+="\n"),G+="#define USE_EXACT_SRGB_CONVERSIONS"),G}}function O(G,A){let j=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3?arguments[3]:void 0;switch(G){case 3:{const G=(ArrayBuffer,new Int8Array(A));return u&&G.set(new Int8Array(u)),G}case 0:{const G=(ArrayBuffer,new Uint8Array(A));return u&&G.set(new Uint8Array(u)),G}case 4:{const G=A instanceof ArrayBuffer?new Int16Array(A):new Int16Array(j?A/2:A);return u&&G.set(new Int16Array(u)),G}case 5:case 8:case 9:case 10:case 2:{const G=A instanceof ArrayBuffer?new Uint16Array(A):new Uint16Array(j?A/2:A);return u&&G.set(new Uint16Array(u)),G}case 6:{const G=A instanceof ArrayBuffer?new Int32Array(A):new Int32Array(j?A/4:A);return u&&G.set(new Int32Array(u)),G}case 7:case 11:case 12:case 13:case 14:case 15:{const G=A instanceof ArrayBuffer?new Uint32Array(A):new Uint32Array(j?A/4:A);return u&&G.set(new Uint32Array(u)),G}case 1:{const G=A instanceof ArrayBuffer?new Float32Array(A):new Float32Array(j?A/4:A);return u&&G.set(new Float32Array(u)),G}}const k=(ArrayBuffer,new Uint8Array(A));return u&&k.set(new Uint8Array(u)),k}},11134:(G,A,j)=>{j.d(A,{e:()=>u});class u{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?u.ShadersRepository:u.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?u.ShadersStore:u.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?u.IncludesShadersStore:u.IncludesShadersStoreWGSL}}u.ShadersRepository="src/Shaders/",u.ShadersStore={},u.IncludesShadersStore={},u.ShadersRepositoryWGSL="src/ShadersWGSL/",u.ShadersStoreWGSL={},u.IncludesShadersStoreWGSL={}},11144:(G,A,j)=>{j.d(A,{d:()=>F,h:()=>n,l:()=>U,p:()=>R,s:()=>S,w:()=>Y,x:()=>H,A:()=>d,B:()=>h,E:()=>O,F:()=>s});class u{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.UA._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(G){G&&this.program&&G(this.program)}setEngine(G){this.UA=G}_fillEffectInformation(G,A,j,u,k,B,x,s){const O=this.UA;if(O.supportsUniformBuffers)for(const h in A)G.bindUniformBlock(h,A[h]);let d;for(this.UA.getUniforms(this,j).forEach(((G,A)=>{u[j[A]]=G})),this._uniforms=u,d=0;d<k.length;d++){null==G.getUniform(k[d])&&(k.splice(d,1),d--)}k.forEach(((G,A)=>{B[G]=A}));for(const h of O.getAttributes(this,x))s.push(h)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(G,A){const j=this._valueCache[G],u=A.updateFlag;return(void 0===j||j!==u)&&(this._valueCache[G]=u,!0)}_cacheFloat2(G,A,j){let u=this._valueCache[G];if(!u||2!==u.length)return u=[A,j],this._valueCache[G]=u,!0;let k=!1;return u[0]!==A&&(u[0]=A,k=!0),u[1]!==j&&(u[1]=j,k=!0),k}_cacheFloat3(G,A,j,u){let k=this._valueCache[G];if(!k||3!==k.length)return k=[A,j,u],this._valueCache[G]=k,!0;let B=!1;return k[0]!==A&&(k[0]=A,B=!0),k[1]!==j&&(k[1]=j,B=!0),k[2]!==u&&(k[2]=u,B=!0),B}_cacheFloat4(G,A,j,u,k){let B=this._valueCache[G];if(!B||4!==B.length)return B=[A,j,u,k],this._valueCache[G]=B,!0;let x=!1;return B[0]!==A&&(B[0]=A,x=!0),B[1]!==j&&(B[1]=j,x=!0),B[2]!==u&&(B[2]=u,x=!0),B[3]!==k&&(B[3]=k,x=!0),x}setInt(G,A){const j=this._valueCache[G];void 0!==j&&j===A||this.UA.setInt(this._uniforms[G],A)&&(this._valueCache[G]=A)}setInt2(G,A,j){this._cacheFloat2(G,A,j)&&(this.UA.setInt2(this._uniforms[G],A,j)||(this._valueCache[G]=null))}setInt3(G,A,j,u){this._cacheFloat3(G,A,j,u)&&(this.UA.setInt3(this._uniforms[G],A,j,u)||(this._valueCache[G]=null))}setInt4(G,A,j,u,k){this._cacheFloat4(G,A,j,u,k)&&(this.UA.setInt4(this._uniforms[G],A,j,u,k)||(this._valueCache[G]=null))}setIntArray(G,A){this._valueCache[G]=null,this.UA.setIntArray(this._uniforms[G],A)}setIntArray2(G,A){this._valueCache[G]=null,this.UA.setIntArray2(this._uniforms[G],A)}setIntArray3(G,A){this._valueCache[G]=null,this.UA.setIntArray3(this._uniforms[G],A)}setIntArray4(G,A){this._valueCache[G]=null,this.UA.setIntArray4(this._uniforms[G],A)}setUInt(G,A){const j=this._valueCache[G];void 0!==j&&j===A||this.UA.setUInt(this._uniforms[G],A)&&(this._valueCache[G]=A)}setUInt2(G,A,j){this._cacheFloat2(G,A,j)&&(this.UA.setUInt2(this._uniforms[G],A,j)||(this._valueCache[G]=null))}setUInt3(G,A,j,u){this._cacheFloat3(G,A,j,u)&&(this.UA.setUInt3(this._uniforms[G],A,j,u)||(this._valueCache[G]=null))}setUInt4(G,A,j,u,k){this._cacheFloat4(G,A,j,u,k)&&(this.UA.setUInt4(this._uniforms[G],A,j,u,k)||(this._valueCache[G]=null))}setUIntArray(G,A){this._valueCache[G]=null,this.UA.setUIntArray(this._uniforms[G],A)}setUIntArray2(G,A){this._valueCache[G]=null,this.UA.setUIntArray2(this._uniforms[G],A)}setUIntArray3(G,A){this._valueCache[G]=null,this.UA.setUIntArray3(this._uniforms[G],A)}setUIntArray4(G,A){this._valueCache[G]=null,this.UA.setUIntArray4(this._uniforms[G],A)}setArray(G,A){this._valueCache[G]=null,this.UA.setArray(this._uniforms[G],A)}setArray2(G,A){this._valueCache[G]=null,this.UA.setArray2(this._uniforms[G],A)}setArray3(G,A){this._valueCache[G]=null,this.UA.setArray3(this._uniforms[G],A)}setArray4(G,A){this._valueCache[G]=null,this.UA.setArray4(this._uniforms[G],A)}setMatrices(G,A){A&&(this._valueCache[G]=null,this.UA.setMatrices(this._uniforms[G],A))}setMatrix(G,A){this._cacheMatrix(G,A)&&(this.UA.setMatrices(this._uniforms[G],A.hs())||(this._valueCache[G]=null))}setMatrix3x3(G,A){this._valueCache[G]=null,this.UA.setMatrix3x3(this._uniforms[G],A)}setMatrix2x2(G,A){this._valueCache[G]=null,this.UA.setMatrix2x2(this._uniforms[G],A)}setFloat(G,A){const j=this._valueCache[G];void 0!==j&&j===A||this.UA.setFloat(this._uniforms[G],A)&&(this._valueCache[G]=A)}setVector2(G,A){this._cacheFloat2(G,A.x,A.y)&&(this.UA.setFloat2(this._uniforms[G],A.x,A.y)||(this._valueCache[G]=null))}setFloat2(G,A,j){this._cacheFloat2(G,A,j)&&(this.UA.setFloat2(this._uniforms[G],A,j)||(this._valueCache[G]=null))}setVector3(G,A){this._cacheFloat3(G,A.x,A.y,A.z)&&(this.UA.setFloat3(this._uniforms[G],A.x,A.y,A.z)||(this._valueCache[G]=null))}setFloat3(G,A,j,u){this._cacheFloat3(G,A,j,u)&&(this.UA.setFloat3(this._uniforms[G],A,j,u)||(this._valueCache[G]=null))}setVector4(G,A){this._cacheFloat4(G,A.x,A.y,A.z,A.w)&&(this.UA.setFloat4(this._uniforms[G],A.x,A.y,A.z,A.w)||(this._valueCache[G]=null))}setQuaternion(G,A){this._cacheFloat4(G,A.x,A.y,A.z,A.w)&&(this.UA.setFloat4(this._uniforms[G],A.x,A.y,A.z,A.w)||(this._valueCache[G]=null))}setFloat4(G,A,j,u,k){this._cacheFloat4(G,A,j,u,k)&&(this.UA.setFloat4(this._uniforms[G],A,j,u,k)||(this._valueCache[G]=null))}setColor3(G,A){this._cacheFloat3(G,A.r,A.g,A.b)&&(this.UA.setFloat3(this._uniforms[G],A.r,A.g,A.b)||(this._valueCache[G]=null))}setColor4(G,A,j){this._cacheFloat4(G,A.r,A.g,A.b,j)&&(this.UA.setFloat4(this._uniforms[G],A.r,A.g,A.b,j)||(this._valueCache[G]=null))}setDirectColor4(G,A){this._cacheFloat4(G,A.r,A.g,A.b,A.a)&&(this.UA.setFloat4(this._uniforms[G],A.r,A.g,A.b,A.a)||(this._valueCache[G]=null))}_getVertexShaderCode(){return this.vertexShader?this.UA._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.UA._getShaderSource(this.fragmentShader):null}}var k=j(11112);const B=new WeakMap,x={_webGLVersion:2,cachedPipelines:{}};function s(G){let A=B.get(G);if(!A){if(!G)return x;A={_webGLVersion:G.TEXTURE_BINDING_3D?2:1,_context:G,parallelShaderCompile:G.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},B.set(G,A)}return A}function O(G){B.delete(G)}function d(G,A,j,u,k,B){const x=s(u);B||(B=x._createShaderProgramInjection??F);return B(G,t(A,"vertex",u,x._contextWasLost),t(j,"fragment",u,x._contextWasLost),u,k,x.validateShaderPrograms)}function h(G,A,j,u,k){let B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,x=arguments.length>6?arguments[6]:void 0;const O=s(k);x||(x=O._createShaderProgramInjection??F);const d=O._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return x(G,C(A,"vertex",u,d,k,O._contextWasLost),C(j,"fragment",u,d,k,O._contextWasLost),k,B,O.validateShaderPrograms)}function H(G,A){const j=new u,k=s(G);return k.parallelShaderCompile&&!k.disableParallelShaderCompile&&(j.isParallelCompiled=!0),j.context=k._context,j}function F(G,A,j,u){let k=arguments.length>5?arguments[5]:void 0;const B=u.createProgram();if(G.program=B,!B)throw new Error("Unable to create program");return u.attachShader(B,A),u.attachShader(B,j),u.linkProgram(B),G.context=u,G.vertexShader=A,G.fragmentShader=j,G.isParallelCompiled||U(G,u,k),B}function R(G,A,j){const u=G;if(u._isDisposed)return!1;const k=s(A);return!!(k&&k.parallelShaderCompile&&k.parallelShaderCompile.COMPLETION_STATUS_KHR&&u.program&&A.getProgramParameter(u.program,k.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(U(u,A,j),!0)}function U(G,A,j){const u=G.context,k=G.vertexShader,B=G.fragmentShader,x=G.program;if(!u.getProgramParameter(x,u.LINK_STATUS)){if(!A.getShaderParameter(k,A.COMPILE_STATUS)){const j=A.getShaderInfoLog(k);if(j)throw G.vertexCompilationError=j,new Error("VERTEX SHADER "+j)}if(!A.getShaderParameter(B,A.COMPILE_STATUS)){const j=A.getShaderInfoLog(B);if(j)throw G.fragmentCompilationError=j,new Error("FRAGMENT SHADER "+j)}const j=u.getProgramInfoLog(x);if(j)throw G.programLinkError=j,new Error(j)}if(j){u.validateProgram(x);if(!u.getProgramParameter(x,u.VALIDATE_STATUS)){const A=u.getProgramInfoLog(x);if(A)throw G.programValidationError=A,new Error(A)}}u.deleteShader(k),u.deleteShader(B),G.vertexShader=void 0,G.fragmentShader=void 0,G.onCompiled&&(G.onCompiled(),G.onCompiled=void 0)}function S(G,A,j,u,k,B,x,O,H){let F=arguments.length>10?arguments[10]:void 0,R=arguments.length>11?arguments[11]:void 0,U=arguments.length>12?arguments[12]:void 0;const S=s(G.context);R||(R=S.createRawShaderProgramInjection??d),U||(U=S.createShaderProgramInjection??h);const C=G;C.program=u?R(C,A,j,C.context,H):U(C,A,j,O,C.context,H),C.program.__SPECTOR_rebuildProgram=x,F()}function C(G,A,j,u,B,x){return t((0,k.c)(G,j,u),A,B,x)}function t(G,A,j,u){const k=j.createShader("vertex"===A?j.VERTEX_SHADER:j.FRAGMENT_SHADER);if(!k){let G=j.NO_ERROR,k=j.NO_ERROR;for(;(k=j.getError())!==j.NO_ERROR;)G=k;throw new Error(`Something went wrong while creating a gl ${A} shader object. gl error=${G}, gl isContextLost=${j.isContextLost()}, _contextWasLost=${u}`)}return j.shaderSource(k,G),j.compileShader(k),k}function Y(G,A){A.useProgram(G)}function n(G,A){const j=G;if(!j.isParallelCompiled)return void A(G);const u=j.onCompiled;j.onCompiled=()=>{null===u||void 0===u||u(),A(G)}}},11141:(G,A,j)=>{j.d(A,{c:()=>H,f:()=>R,j:()=>d,n:()=>h});var u=j(11057),k=j(11144),B=j(11134),x=j(11065),s=j(11106),O=j(11112);function d(G,A){return(0,k.F)(A).cachedPipelines[G]}function h(G){const A=G._name,j=G.context;if(A&&j){const G=(0,k.F)(j),u=G.cachedPipelines[A];null===u||void 0===u||u.dispose(),delete G.cachedPipelines[A]}}function H(G,A,j,k,B,x,O){let d,h;const H=(0,u.f)()?null===x||void 0===x?void 0:x.getHostDocument():null;d="string"===typeof A?A:A.vertexSource?"source:"+A.vertexSource:A.vertexElement?(null===H||void 0===H?void 0:H.getElementById(A.vertexElement))||A.vertexElement:A.vertex||A,h="string"===typeof A?A:A.fragmentSource?"source:"+A.fragmentSource:A.fragmentElement?(null===H||void 0===H?void 0:H.getElementById(A.fragmentElement))||A.fragmentElement:A.fragment||A;const R=[void 0,void 0],U=()=>{if(R[0]&&R[1]){G.isFragment=!0;const[u,d]=R;(0,s.j)(d,G,((x,d)=>{O&&(O._fragmentSourceCodeBeforeMigration=d),j&&(x=j("fragment",x));const h=(0,s.c)(u,x,G);G=null;const H=function(G,A,j,u){if(j){return{vertexSourceCode:(1===u?"//":"")+"#define SHADER_NAME vertex:"+(j.vertexElement||j.vertex||j.spectorName||j)+"\n"+G,fragmentSourceCode:(1===u?"//":"")+"#define SHADER_NAME fragment:"+(j.fragmentElement||j.fragment||j.spectorName||j)+"\n"+A}}return{vertexSourceCode:G,fragmentSourceCode:A}}(h.vertexCode,h.fragmentCode,A,B);null===k||void 0===k||k(H.vertexSourceCode,H.fragmentSourceCode)}),x)}};F(d,"Vertex","",(A=>{(0,s.e)(G),(0,s.j)(A,G,((G,u)=>{O&&(O._rawVertexSourceCode=A,O._vertexSourceCodeBeforeMigration=u),j&&(G=j("vertex",G)),R[0]=G,U()}),x)}),B),F(h,"Fragment","Pixel",(G=>{O&&(O._rawFragmentSourceCode=G),R[1]=G,U()}),B)}function F(G,A,j,k,x,s){if("undefined"!==typeof HTMLElement&&G instanceof HTMLElement){return void k((0,u.b)(G))}if("source:"===G.substring(0,7))return void k(G.substring(7));if("base64:"===G.substring(0,7)){return void k(window.atob(G.substring(7)))}const d=B.e.GetShadersStore(x);if(d[G+A+"Shader"])return void k(d[G+A+"Shader"]);if(j&&d[G+j+"Shader"])return void k(d[G+j+"Shader"]);let h;if(h="."===G[0]||"/"===G[0]||G.indexOf("http")>-1?G:B.e.GetShadersRepository(x)+G,!(s=s||O.e))throw new Error("loadFileInjection is not defined");s(h+"."+A.toLowerCase()+".fx",k)}const R=(G,A,j,u)=>{try{const B=G.context?(0,k.F)(G.context):null;B&&(B.disableParallelShaderCompile=G.disableParallelCompilation);const x=G.existingPipelineContext||A(G.shaderProcessingContext);return x._name=G.name,G.name&&B&&(B.cachedPipelines[G.name]=x),j(x,G.vertex,G.fragment,!!G.createAsRaw,"","",G.rebuildRebind,G.defines,G.transformFeedbackVaryings,"",(()=>{u(x,(()=>{var A;null===(A=G.onRenderingStateCompiled)||void 0===A||A.call(G,x)}))})),x}catch(B){throw x.e.Error("Error compiling effect"),B}}},11127:(G,A,j)=>{j.r(A),j.d(A,{Effect:()=>O});var u=j(11050),k=j(11065),B=j(11134),x=j(11141),s=j(11114);class O{static get ShadersRepository(){return B.e.ShadersRepository}static set ShadersRepository(G){B.e.ShadersRepository=G}get H(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new u.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(G,A,j){let k=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,B=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,H=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,F=arguments.length>9?arguments[9]:void 0,R=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",U=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,S=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new u.b,this.onErrorObservable=new u.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=G,this._key=R;const C=this._key.replace(/\r/g,"").replace(/\n/g,"|");let t;if(A.attributes){const G=A;if(this._engine=j,this._attributesNames=G.attributes,this._uniformsNames=G.uniformsNames.concat(G.samplers),this._samplerList=G.samplers.slice(),this.defines=G.defines,this.onError=G.onError,this.onCompiled=G.onCompiled,this._fallbacks=G.fallbacks,this._indexParameters=G.indexParameters,this._transformFeedbackVaryings=G.transformFeedbackVaryings||null,this._multiTarget=!!G.multiTarget,this._shaderLanguage=G.shaderLanguage??0,this._disableParallelShaderCompilation=!!G.disableParallelShaderCompilation,G.uniformBuffersNames){this._uniformBuffersNamesList=G.uniformBuffersNames.slice();for(let A=0;A<G.uniformBuffersNames.length;A++)this._uniformBuffersNames[G.uniformBuffersNames[A]]=A}this._processFinalCode=G.processFinalCode??null,this._processCodeAfterIncludes=G.processCodeAfterIncludes??void 0,S=G.extraInitializationsAsync,t=G.existingPipelineContext}else this._engine=B,this.defines=null==s?"":s,this._uniformsNames=j.concat(k),this._samplerList=k?k.slice():[],this._attributesNames=A,this._uniformBuffersNamesList=[],this._shaderLanguage=U,this.onError=H,this.onCompiled=h,this._indexParameters=F,this._fallbacks=d;"WEBGL2"===this._engine.shaderPlatformName&&(t=(0,x.j)(C,this._engine._gl)??t),this._attributeLocationByName={},this.uniqueId=O._UniqueIdSeed++,t?(this._pipelineContext=t,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,S),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.H||this.dispose(!0)}))}async _processShaderCodeAsync(){let G=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3?arguments[3]:void 0;u&&await u(),this._processingContext=j||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const k={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:G??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:B.e.GetShadersRepository(this._shaderLanguage),includesShadersStore:B.e.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,x.c)(k,this.name,this._processFinalCode,((G,j)=>{this._vertexSourceCode=G,this._fragmentSourceCode=j,this._prepareEffect(A)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.H||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(G){return this._attributes[G]}getAttributeLocationByName(G){return this._attributeLocationByName[G]}getAttributesCount(){return this._attributes.length}getUniformIndex(G){return this._uniformsNames.indexOf(G)}getUniform(G){return this._uniforms[G]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((G=>{this.executeWhenCompiled(G)}))}executeWhenCompiled(G){this.isReady()?G(this):(this.onCompileObservable.add((A=>{G(A)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(G){(0,s.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(A=>{this._processCompilationErrors(A,G)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var G;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(G=this._pipelineContext)||void 0===G?void 0:G._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var G;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(G=this._pipelineContext)||void 0===G?void 0:G._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(G,A,j,u){this._isReady=!1,this._vertexSourceCodeOverride=G,this._fragmentSourceCodeOverride=A,this.onError=(G,A)=>{u&&u(A)},this.onCompiled=()=>{var G,A;const u=this.getEngine().scenes;if(u)for(let j=0;j<u.length;j++)u[j].markAllMaterialsAsDirty(127);null===(G=(A=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===G||G.call(A,j)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(G){if(this._pipelineContext=G,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let A=0;A<this._attributesNames.length;A++){const G=this._attributesNames[A];this._attributeLocationByName[G]=this._attributes[A]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),O.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let G=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const A=this._pipelineContext;this._isReady=!1;try{const j=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),u=j?null:this.defines,k=j?this._vertexSourceCodeOverride:this._vertexSourceCode,B=j?this._fragmentSourceCodeOverride:this._fragmentSourceCode,s=this._engine;this._pipelineContext=(0,x.f)({existingPipelineContext:G?A:null,vertex:k,fragment:B,context:"WEBGL2"===s.shaderPlatformName||"WEBGL1"===s.shaderPlatformName?s._gl:void 0,rebuildRebind:(G,A,j,u)=>this._rebuildProgram(G,A,j,u),defines:u,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:j,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:j=>{A&&!G&&this._engine._deletePipelineContext(A),j&&this._onRenderingStateCompiled(j)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(A)}catch(j){this._processCompilationErrors(j,A)}}_getShaderCodeAndErrorLine(G,A,j){const u=j?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let k=null;if(A&&G){const B=A.match(u);if(B&&2===B.length){const A=parseInt(B[1]),u=G.split("\n",-1);u.length>=A&&(k=`Offending line [${A}] in ${j?"fragment":"vertex"} code: ${u[A-1]}`)}}return[G,k]}_processCompilationErrors(G){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=G.message;const j=this._attributesNames,u=this._fallbacks;if(k.e.Error("Unable to compile effect:"),k.e.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),k.e.Error(`Attributes: ${j.join(" ")}`),k.e.Error("Defines:\n"+this.defines),O.LogShaderCodeOnCompilationError){var B,x;let G=null,A=null,j=null;var s;if(null!==(B=this._pipelineContext)&&void 0!==B&&B._getVertexShaderCode()&&([j,G]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),j&&(k.e.Error("Vertex code:"),k.e.Error(j))),null!==(x=this._pipelineContext)&&void 0!==x&&x._getFragmentShaderCode())[j,A]=this._getShaderCodeAndErrorLine(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode(),this._compilationError,!0),j&&(k.e.Error("Fragment code:"),k.e.Error(j));G&&k.e.Error(G),A&&k.e.Error(A)}k.e.Error("Error: "+this._compilationError);const d=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};A&&(this._pipelineContext=A,this._isReady=!0,d()),u?(this._pipelineContext=null,u.hasMoreFallbacks?(this._allFallbacksProcessed=!1,k.e.Error("Trying next fallback."),this.defines=u.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,d(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,A||d())}get isSupported(){return""===this._compilationError}_bindTexture(G,A){this._engine._bindTexture(this._samplers[G],A,G)}setTexture(G,A){this._engine.setTexture(this._samplers[G],this._uniforms[G],A,G)}setTextureArray(G,A){const j=G+"Ex";if(-1===this._samplerList.indexOf(j+"0")){const u=this._samplerList.indexOf(G);for(let G=1;G<A.length;G++){const A=j+(G-1).toString();this._samplerList.splice(u+G,0,A)}let k=0;for(const G of this._samplerList)this._samplers[G]=k,k+=1}this._engine.setTextureArray(this._samplers[G],this._uniforms[G],A,G)}bindUniformBuffer(G,A){const j=this._uniformBuffersNames[A];void 0===j||O._BaseCache[j]===G&&this._engine._features.useUBOBindingCache||(O._BaseCache[j]=G,this._engine.bindUniformBufferBase(G,j,A))}bindUniformBlock(G,A){this._engine.bindUniformBlock(this._pipelineContext,G,A)}setInt(G,A){return this._pipelineContext.setInt(G,A),this}setInt2(G,A,j){return this._pipelineContext.setInt2(G,A,j),this}setInt3(G,A,j,u){return this._pipelineContext.setInt3(G,A,j,u),this}setInt4(G,A,j,u,k){return this._pipelineContext.setInt4(G,A,j,u,k),this}setIntArray(G,A){return this._pipelineContext.setIntArray(G,A),this}setIntArray2(G,A){return this._pipelineContext.setIntArray2(G,A),this}setIntArray3(G,A){return this._pipelineContext.setIntArray3(G,A),this}setIntArray4(G,A){return this._pipelineContext.setIntArray4(G,A),this}setUInt(G,A){return this._pipelineContext.setUInt(G,A),this}setUInt2(G,A,j){return this._pipelineContext.setUInt2(G,A,j),this}setUInt3(G,A,j,u){return this._pipelineContext.setUInt3(G,A,j,u),this}setUInt4(G,A,j,u,k){return this._pipelineContext.setUInt4(G,A,j,u,k),this}setUIntArray(G,A){return this._pipelineContext.setUIntArray(G,A),this}setUIntArray2(G,A){return this._pipelineContext.setUIntArray2(G,A),this}setUIntArray3(G,A){return this._pipelineContext.setUIntArray3(G,A),this}setUIntArray4(G,A){return this._pipelineContext.setUIntArray4(G,A),this}setFloatArray(G,A){return this._pipelineContext.setArray(G,A),this}setFloatArray2(G,A){return this._pipelineContext.setArray2(G,A),this}setFloatArray3(G,A){return this._pipelineContext.setArray3(G,A),this}setFloatArray4(G,A){return this._pipelineContext.setArray4(G,A),this}setArray(G,A){return this._pipelineContext.setArray(G,A),this}setArray2(G,A){return this._pipelineContext.setArray2(G,A),this}setArray3(G,A){return this._pipelineContext.setArray3(G,A),this}setArray4(G,A){return this._pipelineContext.setArray4(G,A),this}setMatrices(G,A){return this._pipelineContext.setMatrices(G,A),this}setMatrix(G,A){return this._pipelineContext.setMatrix(G,A),this}setMatrix3x3(G,A){return this._pipelineContext.setMatrix3x3(G,A),this}setMatrix2x2(G,A){return this._pipelineContext.setMatrix2x2(G,A),this}setFloat(G,A){return this._pipelineContext.setFloat(G,A),this}setBool(G,A){return this._pipelineContext.setInt(G,A?1:0),this}setVector2(G,A){return this._pipelineContext.setVector2(G,A),this}setFloat2(G,A,j){return this._pipelineContext.setFloat2(G,A,j),this}setVector3(G,A){return this._pipelineContext.setVector3(G,A),this}setFloat3(G,A,j,u){return this._pipelineContext.setFloat3(G,A,j,u),this}setVector4(G,A){return this._pipelineContext.setVector4(G,A),this}setQuaternion(G,A){return this._pipelineContext.setQuaternion(G,A),this}setFloat4(G,A,j,u,k){return this._pipelineContext.setFloat4(G,A,j,u,k),this}setColor3(G,A){return this._pipelineContext.setColor3(G,A),this}setColor4(G,A,j){return this._pipelineContext.setColor4(G,A,j),this}setDirectColor4(G,A){return this._pipelineContext.setDirectColor4(G,A),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(O.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,x.n)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(G,A,j){let u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;A&&(B.e.GetShadersStore(u)[`${G}PixelShader`]=A),j&&(B.e.GetShadersStore(u)[`${G}VertexShader`]=j)}static ResetCache(){O._BaseCache={}}}O.LogShaderCodeOnCompilationError=!0,O.PersistentMode=!1,O.AutomaticallyClearCodeCache=!1,O._UniqueIdSeed=0,O._BaseCache={},O.ShadersStore=B.e.ShadersStore,O.IncludesShadersStore=B.e.IncludesShadersStore},11075:(G,A,j)=>{j.d(A,{c:()=>k});const u={};function k(G){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!u[G])return u[G]=!0,`${G} needs to be imported before as it contains a side-effect required by your code.`}},11057:(G,A,j)=>{function u(){return"undefined"!==typeof window}function k(){return"undefined"!==typeof navigator}function B(){return"undefined"!==typeof document}function x(G){let A="",j=G.firstChild;for(;j;)3===j.nodeType&&(A+=j.textContent),j=j.nextSibling;return A}j.d(A,{b:()=>x,c:()=>B,e:()=>k,f:()=>u})},11065:(G,A,j)=>{j.d(A,{e:()=>u});class u{static _CheckLimit(G,A){let j=u._LogLimitOutputs[G];return j?j.current++:(j={limit:A,current:1},u._LogLimitOutputs[G]=j),j.current<=j.limit}static _GenerateLimitMessage(G){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const j=u._LogLimitOutputs[G];if(!j||!u.MessageLimitReached)return;const k=this._Levels[A];j.current===j.limit&&u[k.name](u.MessageLimitReached.replace(/%LIMIT%/g,""+j.limit).replace(/%TYPE%/g,k.name??""))}static _AddLogEntry(G){u._LogCache=G+u._LogCache,u.OnNewCacheEntry&&u.OnNewCacheEntry(G)}static _FormatMessage(G){const A=G=>G<10?"0"+G:""+G,j=new Date;return"["+A(j.getHours())+":"+A(j.getMinutes())+":"+A(j.getSeconds())+"]: "+G}static _LogDisabled(G,A){}static _LogEnabled(){let G=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,A=arguments.length>1?arguments[1]:void 0,j=arguments.length>2?arguments[2]:void 0;const k=Array.isArray(A)?A[0]:A;if(void 0!==j&&!u._CheckLimit(k,j))return;const B=u._FormatMessage(k),x=this._Levels[G],s=Array.isArray(A)?A.slice(1):[];x.logFunc&&x.logFunc("BJS - "+B,...s);const O=`<div style='color:${x.color}'>${B}</div><br>`;u._AddLogEntry(O),u._GenerateLimitMessage(k,G)}static get LogCache(){return u._LogCache}static ClearLogCache(){u._LogCache="",u._LogLimitOutputs={},u.errorsCount=0}static set LogLevels(G){u.Log=u._LogDisabled,u.Warn=u._LogDisabled,u.Error=u._LogDisabled;const A=[u.MessageLogLevel,u.WarningLogLevel,u.ErrorLogLevel];for(const j of A)if((G&j)===j){const G=this._Levels[j];u[G.name]=u._LogEnabled.bind(u,j)}}}u.NoneLogLevel=0,u.MessageLogLevel=1,u.WarningLogLevel=2,u.ErrorLogLevel=4,u.AllLogLevel=7,u.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",u._LogCache="",u._LogLimitOutputs={},u._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],u.errorsCount=0,u.Log=u._LogEnabled.bind(u,u.MessageLogLevel),u.Warn=u._LogEnabled.bind(u,u.WarningLogLevel),u.Error=u._LogEnabled.bind(u,u.ErrorLogLevel)},11050:(G,A,j)=>{j.d(A,{b:()=>x});const u="undefined"!==typeof WeakRef;class k{constructor(G){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;this.initialize(G,A,j,u)}initialize(G){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;return this.mask=G,this.skipNextObservers=A,this.target=j,this.currentTarget=u,this}}class B{constructor(G,A){let j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=G,this.mask=A,this.scope=j,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let G=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(G)}}class x{static FromPromise(G,A){const j=new x;return G.then((G=>{j.notifyObservers(G)})).catch((G=>{if(!A)throw G;A.notifyObservers(G)})),j}get observers(){return this._observers}constructor(G){let A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=A,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new k(0),G&&(this._onObserverAdded=G)}add(G){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],j=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!G)return null;const k=new B(G,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);k.unregisterOnNextCall=j,A?this._observers.unshift(k):this._observers.push(k),this._onObserverAdded&&this._onObserverAdded(k),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(k,this._lastNotifiedValue);const x=u?new WeakRef(this):{deref:()=>this};return k._remove=function(){let G=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const A=x.deref();A&&(G?A.remove(k):A._remove(k))},k}addOnce(G){return this.add(G,void 0,void 0,void 0,!0)}remove(G){if(!G)return!1;G._remove=null;return-1!==this._observers.indexOf(G)&&(this._deferUnregister(G),!0)}removeCallback(G,A){for(let j=0;j<this._observers.length;j++){const u=this._observers[j];if(!u._willBeUnregistered&&(u.callback===G&&(!A||A===u.scope)))return this._deferUnregister(u),!0}return!1}_deferUnregister(G){G._willBeUnregistered||(this._numObserversMarkedAsDeleted++,G.unregisterOnNextCall=!1,G._willBeUnregistered=!0,setTimeout((()=>{this._remove(G)}),0))}_remove(G){let A=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!G)return!1;const j=this._observers.indexOf(G);return-1!==j&&(A&&this._numObserversMarkedAsDeleted--,this._observers.splice(j,1),!0)}makeObserverTopPriority(G){this._remove(G,!1),this._observers.unshift(G)}makeObserverBottomPriority(G){this._remove(G,!1),this._observers.push(G)}notifyObservers(G){let A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,j=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,k=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=G),!this._observers.length)return!0;const B=this._eventState;B.mask=A,B.target=j,B.currentTarget=u,B.skipNextObservers=!1,B.lastReturnValue=G,B.userInfo=k;for(const x of this._observers)if(!x._willBeUnregistered&&(x.mask&A&&(x.unregisterOnNextCall&&this._deferUnregister(x),x.scope?B.lastReturnValue=x.callback.apply(x.scope,[G,B]):B.lastReturnValue=x.callback(G,B)),B.skipNextObservers))return!1;return!0}notifyObserver(G,A){let j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=A),G._willBeUnregistered)return;const u=this._eventState;u.mask=j,u.skipNextObservers=!1,G.unregisterOnNextCall&&this._deferUnregister(G),G.callback(A,u)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const G=this._observers.pop();G&&(G._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const G=new x;return G._observers=this._observers.slice(0),G}hasSpecificMask(){let G=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const A of this._observers)if(A.mask&G||A.mask===G)return!0;return!1}}},11114:(G,A,j)=>{j.d(A,{d:()=>k,e:()=>x});let u=[];class k{static SetImmediate(G){0===u.length&&setTimeout((()=>{const G=u;u=[];for(const A of G)A()}),1),u.push(G)}}function B(G,A,j){try{if(G())return A(),!0}catch(u){return null===j||void 0===j||j(u),!0}return!1}const x=function(G,A,j){let u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,x=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&B(G,A,j))return null;const s=setInterval((()=>{B(G,A,j)?clearInterval(s):(k-=u,k<0&&(clearInterval(s),null===j||void 0===j||j(new Error("Operation timed out after maximum retries. "+(x||"")),!0)))}),u);return()=>clearInterval(s)}}}]);