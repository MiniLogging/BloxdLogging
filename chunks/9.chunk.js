"use strict";(self["5dou0t7wntc"]=self["5dou0t7wntc"]||[]).push([[9],{11572:(K,O,F)=>{F.d(O,{b:()=>H,d:()=>a,f:()=>g,e:()=>R,g:()=>G});class f{constructor(){this.children=[]}isValid(K){return!0}process(K,O,F){let f="";if(this.line){let F=this.line;const M=O.processor;if(M){var r,l,q,J,c,E;M.lineProcessor&&(F=M.lineProcessor(F,O.isFragment,O.processingContext));const f=(null===(r=O.processor)||void 0===r?void 0:r.attributeKeywordName)??"attribute",t=O.isFragment&&null!==(l=O.processor)&&void 0!==l&&l.varyingFragmentKeywordName?null===(q=O.processor)||void 0===q?void 0:q.varyingFragmentKeywordName:!O.isFragment&&null!==(J=O.processor)&&void 0!==J&&J.varyingVertexKeywordName?null===(c=O.processor)||void 0===c?void 0:c.varyingVertexKeywordName:"varying";if(!O.isFragment&&M.attributeProcessor&&this.line.startsWith(f))F=M.attributeProcessor(this.line,K,O.processingContext);else if(M.varyingProcessor&&(null!==(E=M.varyingCheck)&&void 0!==E&&E.call(M,this.line,O.isFragment)||!M.varyingCheck&&this.line.startsWith(t)))F=M.varyingProcessor(this.line,O.isFragment,K,O.processingContext);else if(M.uniformProcessor&&M.uniformRegexp&&M.uniformRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(F=M.uniformProcessor(this.line,O.isFragment,K,O.processingContext));else if(M.uniformBufferProcessor&&M.uniformBufferRegexp&&M.uniformBufferRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(F=M.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0);else if(M.textureProcessor&&M.textureRegexp&&M.textureRegexp.test(this.line))F=M.textureProcessor(this.line,O.isFragment,K,O.processingContext);else if((M.uniformProcessor||M.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!O.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?M.uniformProcessor&&(F=M.uniformProcessor(this.line,O.isFragment,K,O.processingContext)):M.uniformBufferProcessor&&(F=M.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0)}O.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(O.lookForClosingBracketForUniformBuffer=!1,M.endOfUniformBufferProcessor&&(F=M.endOfUniformBufferProcessor(this.line,O.isFragment,O.processingContext)))}f+=F+"\n"}for(const M of this.children)f+=M.process(K,O,F);return this.additionalDefineKey&&(K[this.additionalDefineKey]=this.additionalDefineValue||"true",F[this.additionalDefineKey]=K[this.additionalDefineKey]),f}}class r{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(K){this._lines.length=0;for(const O of K){if(!O||"\r"===O)continue;if("#"===O[0]){this._lines.push(O);continue}const K=O.trim();if(!K)continue;if(K.startsWith("//")){this._lines.push(O);continue}const F=K.indexOf(";");if(-1===F)this._lines.push(K);else if(F===K.length-1)K.length>1&&this._lines.push(K);else{const K=O.split(";");for(let O=0;O<K.length;O++){let F=K[O];F&&(F=F.trim(),F&&this._lines.push(F+(O!==K.length-1?";":"")))}}}}}class l extends f{process(K,O,F){for(let f=0;f<this.children.length;f++){const r=this.children[f];if(r.isValid(K))return r.process(K,O,F)}return""}}class q extends f{isValid(K){return this.testExpression.isTrue(K)}}class J{isTrue(K){return!0}static postfixToInfix(K){const O=[];for(const F of K)if(void 0===J._OperatorPriority[F])O.push(F);else{const K=O[O.length-1],f=O[O.length-2];O.length-=2,O.push(`(${f}${F}${K})`)}return O[O.length-1]}static infixToPostfix(K){const O=J._InfixToPostfixCache.get(K);if(O)return O.accessTime=Date.now(),O.result;if(!K.includes("&&")&&!K.includes("||")&&!K.includes(")")&&!K.includes("("))return[K];const F=[];let f=-1;const r=()=>{M=M.trim(),""!==M&&(F.push(M),M="")},l=K=>{f<J._Stack.length-1&&(J._Stack[++f]=K)},q=()=>J._Stack[f],c=()=>-1===f?"!!INVALID EXPRESSION!!":J._Stack[f--];let E=0,M="";for(;E<K.length;){const O=K.charAt(E),t=E<K.length-1?K.substring(E,2+E):"";if("("===O)M="",l(O);else if(")"===O){for(r();-1!==f&&"("!==q();)F.push(c());c()}else if(J._OperatorPriority[t]>1){for(r();-1!==f&&J._OperatorPriority[q()]>=J._OperatorPriority[t];)F.push(c());l(t),E++}else M+=O;E++}for(r();-1!==f;)"("===q()?c():F.push(c());return J._InfixToPostfixCache.size>=J.InfixToPostfixCacheLimitSize&&J.ClearCache(),J._InfixToPostfixCache.set(K,{result:F,accessTime:Date.now()}),F}static ClearCache(){const K=Array.from(J._InfixToPostfixCache.entries()).sort(((K,O)=>K[1].accessTime-O[1].accessTime));for(let O=0;O<J.InfixToPostfixCacheCleanupSize;O++)J._InfixToPostfixCache.delete(K[O][0])}}J.InfixToPostfixCacheLimitSize=5e4,J.InfixToPostfixCacheCleanupSize=25e3,J._InfixToPostfixCache=new Map,J._OperatorPriority={")":0,"(":1,"||":2,"&&":3},J._Stack=["","","","","","","","","","","","","","","","","","","",""];class c extends J{constructor(K){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=K,this.not=O}isTrue(K){let O=void 0!==K[this.define];return this.not&&(O=!O),O}}class E extends J{isTrue(K){return this.leftOperand.isTrue(K)||this.rightOperand.isTrue(K)}}class M extends J{isTrue(K){return this.leftOperand.isTrue(K)&&this.rightOperand.isTrue(K)}}class t extends J{constructor(K,O,F){super(),this.define=K,this.operand=O,this.testValue=F}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(K){let O=!1;const F=parseInt(void 0!=K[this.define]?K[this.define]:this.define),f=parseInt(void 0!=K[this.testValue]?K[this.testValue]:this.testValue);if(isNaN(F)||isNaN(f))return!1;switch(this.operand){case">":O=F>f;break;case"<":O=F<f;break;case"<=":O=F<=f;break;case">=":O=F>=f;break;case"==":O=F===f;break;case"!=":O=F!==f}return O}}var j=F(11546),X=F(11579);const u=/defined\s*?\((.+?)\)/g,T=/defined\s*?\[(.+?)\]/g,o=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,k=/__decl__/,N=/light\{X\}.(\w*)/g,Z=/\{X\}/g,L=[],d=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function a(K){K.processor&&K.processor.initializeShaders&&K.processor.initializeShaders(K.processingContext)}function g(K,O,F,f){var r;null!==(r=O.processor)&&void 0!==r&&r.preProcessShaderCode&&(K=O.processor.preProcessShaderCode(K,O.isFragment)),R(K,O,(K=>{O.processCodeAfterIncludes&&(K=O.processCodeAfterIncludes(O.isFragment?"fragment":"vertex",K,O.defines));const r=function(K,O,F){let f=function(K,O){var F;if(null!==(F=O.processor)&&void 0!==F&&F.noPrecision)return K;const f=O.shouldUseHighPrecisionShader;-1===K.indexOf("precision highp float")?K=f?"precision highp float;\n"+K:"precision mediump float;\n"+K:f||(K=K.replace("precision highp float","precision mediump float"));return K}(K,O);if(!O.processor)return f;if(0===O.processor.shaderLanguage&&-1!==f.indexOf("#version 3")&&(f=f.replace("#version 300 es",""),!O.processor.parseGLES3))return f;const r=O.defines,l=Q(O,F);O.processor.preProcessor&&(f=O.processor.preProcessor(f,r,l,O.isFragment,O.processingContext));const q={};f=A(f,l,O,q),O.processor.postProcessor&&(f=O.processor.postProcessor(f,r,O.isFragment,O.processingContext,F?{drawBuffersExtensionDisabled:!F.getCaps().drawBuffersExtension}:{},l,q));null!==F&&void 0!==F&&F._features.needShaderCodeInlining&&(f=F.inlineShaderCode(f));return f}(K,O,f);F(r,K)}))}function H(K,O,F){return F.processor&&F.processor.finalizeShaders?F.processor.finalizeShaders(K,O,F.processingContext):{vertexCode:K,fragmentCode:O}}function e(K){const O=/defined\((.+)\)/.exec(K);if(O&&O.length)return new c(O[1].trim(),"!"===K[0]);const F=["==","!=",">=","<=","<",">"];let f="",r=0;for(f of F)if(r=K.indexOf(f),r>-1)break;if(-1===r)return new c(K);const l=K.substring(0,r).trim(),q=K.substring(r+f.length).trim();return new t(l,f,q)}function W(K,O){const F=new q,f=K.substring(0,O);let r=K.substring(O);return r=r.substring(0,(r.indexOf("//")+1||r.length+1)-1).trim(),F.testExpression="#ifdef"===f?new c(r):"#ifndef"===f?new c(r,!0):function(K){K=K.replace(u,"defined[$1]");const O=J.infixToPostfix(K),F=[];for(const r of O)if("||"!==r&&"&&"!==r)F.push(r);else if(F.length>=2){let K=F[F.length-1],O=F[F.length-2];F.length-=2;const f="&&"==r?new M:new E;"string"===typeof K&&(K=K.replace(T,"defined($1)")),"string"===typeof O&&(O=O.replace(T,"defined($1)")),f.leftOperand="string"===typeof O?e(O):O,f.rightOperand="string"===typeof K?e(K):K,F.push(f)}let f=F[F.length-1];return"string"===typeof f&&(f=f.replace(T,"defined($1)")),"string"===typeof f?e(f):f}(r),F}function p(K,O,F,r){let l=K.currentLine;for(;y(K,F,r);){l=K.currentLine;const q=l.substring(0,5).toLowerCase();if("#else"===q){const F=new f;return O.children.push(F),void y(K,F,r)}if("#elif"===q){const K=W(l,5);O.children.push(K),F=K}}}function y(K,O,F){for(;K.canRead;){K.lineIndex++;const r=K.currentLine;if(r.indexOf("#")>=0){const f=d.exec(r);if(f&&f.length){switch(f[0]){case"#ifdef":{const f=new l;O.children.push(f);const q=W(r,6);f.children.push(q),p(K,f,q,F);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const f=new l;O.children.push(f);const q=W(r,7);f.children.push(q),p(K,f,q,F);break}case"#if":{const f=new l,q=W(r,3);O.children.push(f),f.children.push(q),p(K,f,q,F);break}}continue}}const q=new f;if(q.line=r,O.children.push(q),"#"===r[0]&&"d"===r[1]){const K=r.replace(";","").split(" ");q.additionalDefineKey=K[1],3===K.length&&(q.additionalDefineValue=K[2])}}return!1}function A(K,O,F,l){const q=new f,J=new r;return J.lineIndex=-1,J.lines=K.split("\n"),y(J,q,l),q.process(O,F,l)}function Q(K,O){var F;const f=K.defines,r={};for(const l of f){const K=l.replace("#define","").replace(";","").trim().split(" ");r[K[0]]=K.length>1?K[1]:""}return 0===(null===(F=K.processor)||void 0===F?void 0:F.shaderLanguage)&&(r.GL_ES="true"),r.__VERSION__=K.version,r[K.platformName]="true",(0,X.i)(r,null===O||void 0===O?void 0:O.isNDCHalfZRange,null===O||void 0===O?void 0:O.useReverseDepthBuffer,null===O||void 0===O?void 0:O.useExactSrgbConversions),r}function R(K,O,F){let f;for(L.length=0;null!==(f=o.exec(K));)L.push(f);let r=String(K),l=[K],q=!1;for(const J of L){let K=J[1];if(-1!==K.indexOf("__decl__")&&(K=K.replace(k,""),O.supportsUniformBuffers&&(K=K.replace("Vertex","Ubo").replace("Fragment","Ubo")),K+="Declaration"),!O.includesShadersStore[K]){const f=O.shadersRepository+"ShadersInclude/"+K+".fx";return void G.loadFile(f,(f=>{O.includesShadersStore[K]=f,R(l.join(""),O,F)}))}{let F=O.includesShadersStore[K];if(J[2]){const K=J[3].split(",");for(let O=0;O<K.length;O+=2){const f=new RegExp(K[O],"g"),r=K[O+1];F=F.replace(f,r)}}if(J[4]){const K=J[5];if(-1!==K.indexOf("..")){const f=K.split(".."),r=parseInt(f[0]);let l=parseInt(f[1]),q=F.slice(0);F="",isNaN(l)&&(l=O.indexParameters[f[1]]);for(let K=r;K<l;K++)O.supportsUniformBuffers||(q=q.replace(N,((K,O)=>O+"{X}"))),F+=q.replace(Z,K.toString())+"\n"}else O.supportsUniformBuffers||(F=F.replace(N,((K,O)=>O+"{X}"))),F=F.replace(Z,K)}const f=[];for(const K of l){const O=K.split(J[0]);for(let K=0;K<O.length-1;K++)f.push(O[K]),f.push(F);f.push(O[O.length-1])}l=f,q=q||F.indexOf("#include<")>=0||F.indexOf("#include <")>=0}}L.length=0,r=l.join(""),q?R(r.toString(),O,F):F(r)}const G={loadFile:(K,O,F,f,r,l)=>{throw(0,j.d)("FileTools")}}},11579:(K,O,F)=>{F.d(O,{e:()=>r,h:()=>l,i:()=>J,k:()=>q,m:()=>c});var f=F(11546);F(11530);const r={};function l(K,O){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(O?O+"\n":"")+K}function q(K,O,F,l,q,J,c){const E=c||r.loadFile;if(E){return E(K,O,F,l,q,J)}throw(0,f.d)("FileTools")}function J(K,O,F,f){if(K)return O?K.IS_NDC_HALF_ZRANGE="":delete K.IS_NDC_HALF_ZRANGE,F?K.USE_REVERSE_DEPTHBUFFER="":delete K.USE_REVERSE_DEPTHBUFFER,void(f?K.USE_EXACT_SRGB_CONVERSIONS="":delete K.USE_EXACT_SRGB_CONVERSIONS);{let K="";return O&&(K+="#define IS_NDC_HALF_ZRANGE"),F&&(K&&(K+="\n"),K+="#define USE_REVERSE_DEPTHBUFFER"),f&&(K&&(K+="\n"),K+="#define USE_EXACT_SRGB_CONVERSIONS"),K}}function c(K,O){let F=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>3?arguments[3]:void 0;switch(K){case 3:{const K=(ArrayBuffer,new Int8Array(O));return f&&K.set(new Int8Array(f)),K}case 0:{const K=(ArrayBuffer,new Uint8Array(O));return f&&K.set(new Uint8Array(f)),K}case 4:{const K=O instanceof ArrayBuffer?new Int16Array(O):new Int16Array(F?O/2:O);return f&&K.set(new Int16Array(f)),K}case 5:case 8:case 9:case 10:case 2:{const K=O instanceof ArrayBuffer?new Uint16Array(O):new Uint16Array(F?O/2:O);return f&&K.set(new Uint16Array(f)),K}case 6:{const K=O instanceof ArrayBuffer?new Int32Array(O):new Int32Array(F?O/4:O);return f&&K.set(new Int32Array(f)),K}case 7:case 11:case 12:case 13:case 14:case 15:{const K=O instanceof ArrayBuffer?new Uint32Array(O):new Uint32Array(F?O/4:O);return f&&K.set(new Uint32Array(f)),K}case 1:{const K=O instanceof ArrayBuffer?new Float32Array(O):new Float32Array(F?O/4:O);return f&&K.set(new Float32Array(f)),K}}const r=(ArrayBuffer,new Uint8Array(O));return f&&r.set(new Uint8Array(f)),r}},11610:(K,O,F)=>{F.d(O,{c:()=>f});class f{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?f.ShadersRepository:f.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?f.ShadersStore:f.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?f.IncludesShadersStore:f.IncludesShadersStoreWGSL}}f.ShadersRepository="src/Shaders/",f.ShadersStore={},f.IncludesShadersStore={},f.ShadersRepositoryWGSL="src/ShadersWGSL/",f.ShadersStoreWGSL={},f.IncludesShadersStoreWGSL={}},11621:(K,O,F)=>{F.d(O,{c:()=>j,g:()=>Z,j:()=>u,n:()=>X,o:()=>T,s:()=>N,w:()=>t,x:()=>E,B:()=>M,E:()=>c,F:()=>J});class f{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.uO._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(K){K&&this.program&&K(this.program)}setEngine(K){this.uO=K}_fillEffectInformation(K,O,F,f,r,l,q,J){const c=this.uO;if(c.supportsUniformBuffers)for(const M in O)K.bindUniformBlock(M,O[M]);let E;for(this.uO.getUniforms(this,F).forEach(((K,O)=>{f[F[O]]=K})),this._uniforms=f,E=0;E<r.length;E++){null==K.getUniform(r[E])&&(r.splice(E,1),E--)}r.forEach(((K,O)=>{l[K]=O}));for(const M of c.getAttributes(this,q))J.push(M)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(K,O){const F=this._valueCache[K],f=O.updateFlag;return(void 0===F||F!==f)&&(this._valueCache[K]=f,!0)}_cacheFloat2(K,O,F){let f=this._valueCache[K];if(!f||2!==f.length)return f=[O,F],this._valueCache[K]=f,!0;let r=!1;return f[0]!==O&&(f[0]=O,r=!0),f[1]!==F&&(f[1]=F,r=!0),r}_cacheFloat3(K,O,F,f){let r=this._valueCache[K];if(!r||3!==r.length)return r=[O,F,f],this._valueCache[K]=r,!0;let l=!1;return r[0]!==O&&(r[0]=O,l=!0),r[1]!==F&&(r[1]=F,l=!0),r[2]!==f&&(r[2]=f,l=!0),l}_cacheFloat4(K,O,F,f,r){let l=this._valueCache[K];if(!l||4!==l.length)return l=[O,F,f,r],this._valueCache[K]=l,!0;let q=!1;return l[0]!==O&&(l[0]=O,q=!0),l[1]!==F&&(l[1]=F,q=!0),l[2]!==f&&(l[2]=f,q=!0),l[3]!==r&&(l[3]=r,q=!0),q}setInt(K,O){const F=this._valueCache[K];void 0!==F&&F===O||this.uO.setInt(this._uniforms[K],O)&&(this._valueCache[K]=O)}setInt2(K,O,F){this._cacheFloat2(K,O,F)&&(this.uO.setInt2(this._uniforms[K],O,F)||(this._valueCache[K]=null))}setInt3(K,O,F,f){this._cacheFloat3(K,O,F,f)&&(this.uO.setInt3(this._uniforms[K],O,F,f)||(this._valueCache[K]=null))}setInt4(K,O,F,f,r){this._cacheFloat4(K,O,F,f,r)&&(this.uO.setInt4(this._uniforms[K],O,F,f,r)||(this._valueCache[K]=null))}setIntArray(K,O){this._valueCache[K]=null,this.uO.setIntArray(this._uniforms[K],O)}setIntArray2(K,O){this._valueCache[K]=null,this.uO.setIntArray2(this._uniforms[K],O)}setIntArray3(K,O){this._valueCache[K]=null,this.uO.setIntArray3(this._uniforms[K],O)}setIntArray4(K,O){this._valueCache[K]=null,this.uO.setIntArray4(this._uniforms[K],O)}setUInt(K,O){const F=this._valueCache[K];void 0!==F&&F===O||this.uO.setUInt(this._uniforms[K],O)&&(this._valueCache[K]=O)}setUInt2(K,O,F){this._cacheFloat2(K,O,F)&&(this.uO.setUInt2(this._uniforms[K],O,F)||(this._valueCache[K]=null))}setUInt3(K,O,F,f){this._cacheFloat3(K,O,F,f)&&(this.uO.setUInt3(this._uniforms[K],O,F,f)||(this._valueCache[K]=null))}setUInt4(K,O,F,f,r){this._cacheFloat4(K,O,F,f,r)&&(this.uO.setUInt4(this._uniforms[K],O,F,f,r)||(this._valueCache[K]=null))}setUIntArray(K,O){this._valueCache[K]=null,this.uO.setUIntArray(this._uniforms[K],O)}setUIntArray2(K,O){this._valueCache[K]=null,this.uO.setUIntArray2(this._uniforms[K],O)}setUIntArray3(K,O){this._valueCache[K]=null,this.uO.setUIntArray3(this._uniforms[K],O)}setUIntArray4(K,O){this._valueCache[K]=null,this.uO.setUIntArray4(this._uniforms[K],O)}setArray(K,O){this._valueCache[K]=null,this.uO.setArray(this._uniforms[K],O)}setArray2(K,O){this._valueCache[K]=null,this.uO.setArray2(this._uniforms[K],O)}setArray3(K,O){this._valueCache[K]=null,this.uO.setArray3(this._uniforms[K],O)}setArray4(K,O){this._valueCache[K]=null,this.uO.setArray4(this._uniforms[K],O)}setMatrices(K,O){O&&(this._valueCache[K]=null,this.uO.setMatrices(this._uniforms[K],O))}setMatrix(K,O){this._cacheMatrix(K,O)&&(this.uO.setMatrices(this._uniforms[K],O.hf())||(this._valueCache[K]=null))}setMatrix3x3(K,O){this._valueCache[K]=null,this.uO.setMatrix3x3(this._uniforms[K],O)}setMatrix2x2(K,O){this._valueCache[K]=null,this.uO.setMatrix2x2(this._uniforms[K],O)}setFloat(K,O){const F=this._valueCache[K];void 0!==F&&F===O||this.uO.setFloat(this._uniforms[K],O)&&(this._valueCache[K]=O)}setVector2(K,O){this._cacheFloat2(K,O.x,O.y)&&(this.uO.setFloat2(this._uniforms[K],O.x,O.y)||(this._valueCache[K]=null))}setFloat2(K,O,F){this._cacheFloat2(K,O,F)&&(this.uO.setFloat2(this._uniforms[K],O,F)||(this._valueCache[K]=null))}setVector3(K,O){this._cacheFloat3(K,O.x,O.y,O.z)&&(this.uO.setFloat3(this._uniforms[K],O.x,O.y,O.z)||(this._valueCache[K]=null))}setFloat3(K,O,F,f){this._cacheFloat3(K,O,F,f)&&(this.uO.setFloat3(this._uniforms[K],O,F,f)||(this._valueCache[K]=null))}setVector4(K,O){this._cacheFloat4(K,O.x,O.y,O.z,O.w)&&(this.uO.setFloat4(this._uniforms[K],O.x,O.y,O.z,O.w)||(this._valueCache[K]=null))}setQuaternion(K,O){this._cacheFloat4(K,O.x,O.y,O.z,O.w)&&(this.uO.setFloat4(this._uniforms[K],O.x,O.y,O.z,O.w)||(this._valueCache[K]=null))}setFloat4(K,O,F,f,r){this._cacheFloat4(K,O,F,f,r)&&(this.uO.setFloat4(this._uniforms[K],O,F,f,r)||(this._valueCache[K]=null))}setColor3(K,O){this._cacheFloat3(K,O.r,O.g,O.b)&&(this.uO.setFloat3(this._uniforms[K],O.r,O.g,O.b)||(this._valueCache[K]=null))}setColor4(K,O,F){this._cacheFloat4(K,O.r,O.g,O.b,F)&&(this.uO.setFloat4(this._uniforms[K],O.r,O.g,O.b,F)||(this._valueCache[K]=null))}setDirectColor4(K,O){this._cacheFloat4(K,O.r,O.g,O.b,O.a)&&(this.uO.setFloat4(this._uniforms[K],O.r,O.g,O.b,O.a)||(this._valueCache[K]=null))}_getVertexShaderCode(){return this.vertexShader?this.uO._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.uO._getShaderSource(this.fragmentShader):null}}var r=F(11579);const l=new WeakMap,q={_webGLVersion:2,cachedPipelines:{}};function J(K){let O=l.get(K);if(!O){if(!K)return q;O={_webGLVersion:K.TEXTURE_BINDING_3D?2:1,_context:K,parallelShaderCompile:K.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},l.set(K,O)}return O}function c(K){l.delete(K)}function E(K,O,F,f,r,l){const q=J(f);l||(l=q._createShaderProgramInjection??j);return l(K,k(O,"vertex",f,q._contextWasLost),k(F,"fragment",f,q._contextWasLost),f,r,q.validateShaderPrograms)}function M(K,O,F,f,r){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,q=arguments.length>6?arguments[6]:void 0;const c=J(r);q||(q=c._createShaderProgramInjection??j);const E=c._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return q(K,o(O,"vertex",f,E,r,c._contextWasLost),o(F,"fragment",f,E,r,c._contextWasLost),r,l,c.validateShaderPrograms)}function t(K,O){const F=new f,r=J(K);return r.parallelShaderCompile&&!r.disableParallelShaderCompile&&(F.isParallelCompiled=!0),F.context=r._context,F}function j(K,O,F,f){let r=arguments.length>5?arguments[5]:void 0;const l=f.createProgram();if(K.program=l,!l)throw new Error("Unable to create program");return f.attachShader(l,O),f.attachShader(l,F),f.linkProgram(l),K.context=f,K.vertexShader=O,K.fragmentShader=F,K.isParallelCompiled||u(K,f,r),l}function X(K,O,F){const f=K;if(f._isDisposed)return!1;const r=J(O);return!!(r&&r.parallelShaderCompile&&r.parallelShaderCompile.COMPLETION_STATUS_KHR&&f.program&&O.getProgramParameter(f.program,r.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(u(f,O,F),!0)}function u(K,O,F){const f=K.context,r=K.vertexShader,l=K.fragmentShader,q=K.program;if(!f.getProgramParameter(q,f.LINK_STATUS)){if(!O.getShaderParameter(r,O.COMPILE_STATUS)){const F=O.getShaderInfoLog(r);if(F)throw K.vertexCompilationError=F,new Error("VERTEX SHADER "+F)}if(!O.getShaderParameter(l,O.COMPILE_STATUS)){const F=O.getShaderInfoLog(l);if(F)throw K.fragmentCompilationError=F,new Error("FRAGMENT SHADER "+F)}const F=f.getProgramInfoLog(q);if(F)throw K.programLinkError=F,new Error(F)}if(F){f.validateProgram(q);if(!f.getProgramParameter(q,f.VALIDATE_STATUS)){const O=f.getProgramInfoLog(q);if(O)throw K.programValidationError=O,new Error(O)}}f.deleteShader(r),f.deleteShader(l),K.vertexShader=void 0,K.fragmentShader=void 0,K.onCompiled&&(K.onCompiled(),K.onCompiled=void 0)}function T(K,O,F,f,r,l,q,c,t){let j=arguments.length>10?arguments[10]:void 0,X=arguments.length>11?arguments[11]:void 0,u=arguments.length>12?arguments[12]:void 0;const T=J(K.context);X||(X=T.createRawShaderProgramInjection??E),u||(u=T.createShaderProgramInjection??M);const o=K;o.program=f?X(o,O,F,o.context,t):u(o,O,F,c,o.context,t),o.program.__SPECTOR_rebuildProgram=q,j()}function o(K,O,F,f,l,q){return k((0,r.h)(K,F,f),O,l,q)}function k(K,O,F,f){const r=F.createShader("vertex"===O?F.VERTEX_SHADER:F.FRAGMENT_SHADER);if(!r){let K=F.NO_ERROR,r=F.NO_ERROR;for(;(r=F.getError())!==F.NO_ERROR;)K=r;throw new Error(`Something went wrong while creating a gl ${O} shader object. gl error=${K}, gl isContextLost=${F.isContextLost()}, _contextWasLost=${f}`)}return F.shaderSource(r,K),F.compileShader(r),r}function N(K,O){O.useProgram(K)}function Z(K,O){const F=K;if(!F.isParallelCompiled)return void O(K);const f=F.onCompiled;F.onCompiled=()=>{null===f||void 0===f||f(),O(K)}}},11614:(K,O,F)=>{F.d(O,{e:()=>t,h:()=>X,j:()=>E,l:()=>M});var f=F(11530),r=F(11621),l=F(11610),q=F(11534),J=F(11572),c=F(11579);function E(K,O){return(0,r.F)(O).cachedPipelines[K]}function M(K){const O=K._name,F=K.context;if(O&&F){const K=(0,r.F)(F),f=K.cachedPipelines[O];null===f||void 0===f||f.dispose(),delete K.cachedPipelines[O]}}function t(K,O,F,r,l,q,c){let E,M;const t=(0,f.k)()?null===q||void 0===q?void 0:q.getHostDocument():null;E="string"===typeof O?O:O.vertexSource?"source:"+O.vertexSource:O.vertexElement?(null===t||void 0===t?void 0:t.getElementById(O.vertexElement))||O.vertexElement:O.vertex||O,M="string"===typeof O?O:O.fragmentSource?"source:"+O.fragmentSource:O.fragmentElement?(null===t||void 0===t?void 0:t.getElementById(O.fragmentElement))||O.fragmentElement:O.fragment||O;const X=[void 0,void 0],u=()=>{if(X[0]&&X[1]){K.isFragment=!0;const[f,E]=X;(0,J.f)(E,K,((q,E)=>{c&&(c._fragmentSourceCodeBeforeMigration=E),F&&(q=F("fragment",q));const M=(0,J.b)(f,q,K);K=null;const t=function(K,O,F,f){if(F){return{vertexSourceCode:(1===f?"//":"")+"#define SHADER_NAME vertex:"+(F.vertexElement||F.vertex||F.spectorName||F)+"\n"+K,fragmentSourceCode:(1===f?"//":"")+"#define SHADER_NAME fragment:"+(F.fragmentElement||F.fragment||F.spectorName||F)+"\n"+O}}return{vertexSourceCode:K,fragmentSourceCode:O}}(M.vertexCode,M.fragmentCode,O,l);null===r||void 0===r||r(t.vertexSourceCode,t.fragmentSourceCode)}),q)}};j(E,"Vertex","",(O=>{(0,J.d)(K),(0,J.f)(O,K,((K,f)=>{c&&(c._rawVertexSourceCode=O,c._vertexSourceCodeBeforeMigration=f),F&&(K=F("vertex",K)),X[0]=K,u()}),q)}),l),j(M,"Fragment","Pixel",(K=>{c&&(c._rawFragmentSourceCode=K),X[1]=K,u()}),l)}function j(K,O,F,r,q,J){if("undefined"!==typeof HTMLElement&&K instanceof HTMLElement){return void r((0,f.d)(K))}if("source:"===K.substring(0,7))return void r(K.substring(7));if("base64:"===K.substring(0,7)){return void r(window.atob(K.substring(7)))}const E=l.c.GetShadersStore(q);if(E[K+O+"Shader"])return void r(E[K+O+"Shader"]);if(F&&E[K+F+"Shader"])return void r(E[K+F+"Shader"]);let M;if(M="."===K[0]||"/"===K[0]||K.indexOf("http")>-1?K:l.c.GetShadersRepository(q)+K,!(J=J||c.k))throw new Error("loadFileInjection is not defined");J(M+"."+O.toLowerCase()+".fx",r)}const X=(K,O,F,f)=>{try{const l=K.context?(0,r.F)(K.context):null;l&&(l.disableParallelShaderCompile=K.disableParallelCompilation);const q=K.existingPipelineContext||O(K.shaderProcessingContext);return q._name=K.name,K.name&&l&&(l.cachedPipelines[K.name]=q),F(q,K.vertex,K.fragment,!!K.createAsRaw,"","",K.rebuildRebind,K.defines,K.transformFeedbackVaryings,"",(()=>{f(q,(()=>{var O;null===(O=K.onRenderingStateCompiled)||void 0===O||O.call(K,q)}))})),q}catch(l){throw q.c.Error("Error compiling effect"),l}}},11603:(K,O,F)=>{F.r(O),F.d(O,{Effect:()=>c});var f=F(11523),r=F(11534),l=F(11610),q=F(11614),J=F(11588);class c{static get ShadersRepository(){return l.c.ShadersRepository}static set ShadersRepository(K){l.c.ShadersRepository=K}get M(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new f.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(K,O,F){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4?arguments[4]:void 0,J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,E=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,M=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,j=arguments.length>9?arguments[9]:void 0,X=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,T=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new f.c,this.onErrorObservable=new f.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=K,this._key=X;const o=this._key.replace(/\r/g,"").replace(/\n/g,"|");let k;if(O.attributes){const K=O;if(this._engine=F,this._attributesNames=K.attributes,this._uniformsNames=K.uniformsNames.concat(K.samplers),this._samplerList=K.samplers.slice(),this.defines=K.defines,this.onError=K.onError,this.onCompiled=K.onCompiled,this._fallbacks=K.fallbacks,this._indexParameters=K.indexParameters,this._transformFeedbackVaryings=K.transformFeedbackVaryings||null,this._multiTarget=!!K.multiTarget,this._shaderLanguage=K.shaderLanguage??0,this._disableParallelShaderCompilation=!!K.disableParallelShaderCompilation,K.uniformBuffersNames){this._uniformBuffersNamesList=K.uniformBuffersNames.slice();for(let O=0;O<K.uniformBuffersNames.length;O++)this._uniformBuffersNames[K.uniformBuffersNames[O]]=O}this._processFinalCode=K.processFinalCode??null,this._processCodeAfterIncludes=K.processCodeAfterIncludes??void 0,T=K.extraInitializationsAsync,k=K.existingPipelineContext}else this._engine=l,this.defines=null==J?"":J,this._uniformsNames=F.concat(r),this._samplerList=r?r.slice():[],this._attributesNames=O,this._uniformBuffersNamesList=[],this._shaderLanguage=u,this.onError=t,this.onCompiled=M,this._indexParameters=j,this._fallbacks=E;"WEBGL2"===this._engine.shaderPlatformName&&(k=(0,q.j)(o,this._engine._gl)??k),this._attributeLocationByName={},this.uniqueId=c._UniqueIdSeed++,k?(this._pipelineContext=k,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,T),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.M||this.dispose(!0)}))}async _processShaderCodeAsync(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=arguments.length>3?arguments[3]:void 0;f&&await f(),this._processingContext=F||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const r={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:K??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:l.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:l.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,q.e)(r,this.name,this._processFinalCode,((K,F)=>{this._vertexSourceCode=K,this._fragmentSourceCode=F,this._prepareEffect(O)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.M||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(K){return this._attributes[K]}getAttributeLocationByName(K){return this._attributeLocationByName[K]}getAttributesCount(){return this._attributes.length}getUniformIndex(K){return this._uniformsNames.indexOf(K)}getUniform(K){return this._uniforms[K]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((K=>{this.executeWhenCompiled(K)}))}executeWhenCompiled(K){this.isReady()?K(this):(this.onCompileObservable.add((O=>{K(O)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(K){(0,J.g)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(O=>{this._processCompilationErrors(O,K)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var K;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(K=this._pipelineContext)||void 0===K?void 0:K._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(K,O,F,f){this._isReady=!1,this._vertexSourceCodeOverride=K,this._fragmentSourceCodeOverride=O,this.onError=(K,O)=>{f&&f(O)},this.onCompiled=()=>{var K,O;const f=this.getEngine().scenes;if(f)for(let F=0;F<f.length;F++)f[F].markAllMaterialsAsDirty(127);null===(K=(O=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===K||K.call(O,F)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(K){if(this._pipelineContext=K,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let O=0;O<this._attributesNames.length;O++){const K=this._attributesNames[O];this._attributeLocationByName[K]=this._attributes[O]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),c.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=this._pipelineContext;this._isReady=!1;try{const F=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),f=F?null:this.defines,r=F?this._vertexSourceCodeOverride:this._vertexSourceCode,l=F?this._fragmentSourceCodeOverride:this._fragmentSourceCode,J=this._engine;this._pipelineContext=(0,q.h)({existingPipelineContext:K?O:null,vertex:r,fragment:l,context:"WEBGL2"===J.shaderPlatformName||"WEBGL1"===J.shaderPlatformName?J._gl:void 0,rebuildRebind:(K,O,F,f)=>this._rebuildProgram(K,O,F,f),defines:f,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:F,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:F=>{O&&!K&&this._engine._deletePipelineContext(O),F&&this._onRenderingStateCompiled(F)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(O)}catch(F){this._processCompilationErrors(F,O)}}_getShaderCodeAndErrorLine(K,O,F){const f=F?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let r=null;if(O&&K){const l=O.match(f);if(l&&2===l.length){const O=parseInt(l[1]),f=K.split("\n",-1);f.length>=O&&(r=`Offending line [${O}] in ${F?"fragment":"vertex"} code: ${f[O-1]}`)}}return[K,r]}_processCompilationErrors(K){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=K.message;const F=this._attributesNames,f=this._fallbacks;if(r.c.Error("Unable to compile effect:"),r.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),r.c.Error(`Attributes: ${F.join(" ")}`),r.c.Error("Defines:\n"+this.defines),c.LogShaderCodeOnCompilationError){var l,q;let K=null,O=null,F=null;var J;if(null!==(l=this._pipelineContext)&&void 0!==l&&l._getVertexShaderCode()&&([F,K]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),F&&(r.c.Error("Vertex code:"),r.c.Error(F))),null!==(q=this._pipelineContext)&&void 0!==q&&q._getFragmentShaderCode())[F,O]=this._getShaderCodeAndErrorLine(null===(J=this._pipelineContext)||void 0===J?void 0:J._getFragmentShaderCode(),this._compilationError,!0),F&&(r.c.Error("Fragment code:"),r.c.Error(F));K&&r.c.Error(K),O&&r.c.Error(O)}r.c.Error("Error: "+this._compilationError);const E=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};O&&(this._pipelineContext=O,this._isReady=!0,E()),f?(this._pipelineContext=null,f.hasMoreFallbacks?(this._allFallbacksProcessed=!1,r.c.Error("Trying next fallback."),this.defines=f.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,E(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,O||E())}get isSupported(){return""===this._compilationError}_bindTexture(K,O){this._engine._bindTexture(this._samplers[K],O,K)}setTexture(K,O){this._engine.setTexture(this._samplers[K],this._uniforms[K],O,K)}setTextureArray(K,O){const F=K+"Ex";if(-1===this._samplerList.indexOf(F+"0")){const f=this._samplerList.indexOf(K);for(let K=1;K<O.length;K++){const O=F+(K-1).toString();this._samplerList.splice(f+K,0,O)}let r=0;for(const K of this._samplerList)this._samplers[K]=r,r+=1}this._engine.setTextureArray(this._samplers[K],this._uniforms[K],O,K)}bindUniformBuffer(K,O){const F=this._uniformBuffersNames[O];void 0===F||c._BaseCache[F]===K&&this._engine._features.useUBOBindingCache||(c._BaseCache[F]=K,this._engine.bindUniformBufferBase(K,F,O))}bindUniformBlock(K,O){this._engine.bindUniformBlock(this._pipelineContext,K,O)}setInt(K,O){return this._pipelineContext.setInt(K,O),this}setInt2(K,O,F){return this._pipelineContext.setInt2(K,O,F),this}setInt3(K,O,F,f){return this._pipelineContext.setInt3(K,O,F,f),this}setInt4(K,O,F,f,r){return this._pipelineContext.setInt4(K,O,F,f,r),this}setIntArray(K,O){return this._pipelineContext.setIntArray(K,O),this}setIntArray2(K,O){return this._pipelineContext.setIntArray2(K,O),this}setIntArray3(K,O){return this._pipelineContext.setIntArray3(K,O),this}setIntArray4(K,O){return this._pipelineContext.setIntArray4(K,O),this}setUInt(K,O){return this._pipelineContext.setUInt(K,O),this}setUInt2(K,O,F){return this._pipelineContext.setUInt2(K,O,F),this}setUInt3(K,O,F,f){return this._pipelineContext.setUInt3(K,O,F,f),this}setUInt4(K,O,F,f,r){return this._pipelineContext.setUInt4(K,O,F,f,r),this}setUIntArray(K,O){return this._pipelineContext.setUIntArray(K,O),this}setUIntArray2(K,O){return this._pipelineContext.setUIntArray2(K,O),this}setUIntArray3(K,O){return this._pipelineContext.setUIntArray3(K,O),this}setUIntArray4(K,O){return this._pipelineContext.setUIntArray4(K,O),this}setFloatArray(K,O){return this._pipelineContext.setArray(K,O),this}setFloatArray2(K,O){return this._pipelineContext.setArray2(K,O),this}setFloatArray3(K,O){return this._pipelineContext.setArray3(K,O),this}setFloatArray4(K,O){return this._pipelineContext.setArray4(K,O),this}setArray(K,O){return this._pipelineContext.setArray(K,O),this}setArray2(K,O){return this._pipelineContext.setArray2(K,O),this}setArray3(K,O){return this._pipelineContext.setArray3(K,O),this}setArray4(K,O){return this._pipelineContext.setArray4(K,O),this}setMatrices(K,O){return this._pipelineContext.setMatrices(K,O),this}setMatrix(K,O){return this._pipelineContext.setMatrix(K,O),this}setMatrix3x3(K,O){return this._pipelineContext.setMatrix3x3(K,O),this}setMatrix2x2(K,O){return this._pipelineContext.setMatrix2x2(K,O),this}setFloat(K,O){return this._pipelineContext.setFloat(K,O),this}setBool(K,O){return this._pipelineContext.setInt(K,O?1:0),this}setVector2(K,O){return this._pipelineContext.setVector2(K,O),this}setFloat2(K,O,F){return this._pipelineContext.setFloat2(K,O,F),this}setVector3(K,O){return this._pipelineContext.setVector3(K,O),this}setFloat3(K,O,F,f){return this._pipelineContext.setFloat3(K,O,F,f),this}setVector4(K,O){return this._pipelineContext.setVector4(K,O),this}setQuaternion(K,O){return this._pipelineContext.setQuaternion(K,O),this}setFloat4(K,O,F,f,r){return this._pipelineContext.setFloat4(K,O,F,f,r),this}setColor3(K,O){return this._pipelineContext.setColor3(K,O),this}setColor4(K,O,F){return this._pipelineContext.setColor4(K,O,F),this}setDirectColor4(K,O){return this._pipelineContext.setDirectColor4(K,O),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(c.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,q.l)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(K,O,F){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;O&&(l.c.GetShadersStore(f)[`${K}PixelShader`]=O),F&&(l.c.GetShadersStore(f)[`${K}VertexShader`]=F)}static ResetCache(){c._BaseCache={}}}c.LogShaderCodeOnCompilationError=!0,c.PersistentMode=!1,c.AutomaticallyClearCodeCache=!1,c._UniqueIdSeed=0,c._BaseCache={},c.ShadersStore=l.c.ShadersStore,c.IncludesShadersStore=l.c.IncludesShadersStore},11546:(K,O,F)=>{F.d(O,{d:()=>r});const f={};function r(K){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!f[K])return f[K]=!0,`${K} needs to be imported before as it contains a side-effect required by your code.`}},11530:(K,O,F)=>{function f(){return"undefined"!==typeof window}function r(){return"undefined"!==typeof navigator}function l(){return"undefined"!==typeof document}function q(K){let O="",F=K.firstChild;for(;F;)3===F.nodeType&&(O+=F.textContent),F=F.nextSibling;return O}F.d(O,{d:()=>q,g:()=>l,h:()=>r,k:()=>f})},11534:(K,O,F)=>{F.d(O,{c:()=>f});class f{static _CheckLimit(K,O){let F=f._LogLimitOutputs[K];return F?F.current++:(F={limit:O,current:1},f._LogLimitOutputs[K]=F),F.current<=F.limit}static _GenerateLimitMessage(K){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const F=f._LogLimitOutputs[K];if(!F||!f.MessageLimitReached)return;const r=this._Levels[O];F.current===F.limit&&f[r.name](f.MessageLimitReached.replace(/%LIMIT%/g,""+F.limit).replace(/%TYPE%/g,r.name??""))}static _AddLogEntry(K){f._LogCache=K+f._LogCache,f.OnNewCacheEntry&&f.OnNewCacheEntry(K)}static _FormatMessage(K){const O=K=>K<10?"0"+K:""+K,F=new Date;return"["+O(F.getHours())+":"+O(F.getMinutes())+":"+O(F.getSeconds())+"]: "+K}static _LogDisabled(K,O){}static _LogEnabled(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,O=arguments.length>1?arguments[1]:void 0,F=arguments.length>2?arguments[2]:void 0;const r=Array.isArray(O)?O[0]:O;if(void 0!==F&&!f._CheckLimit(r,F))return;const l=f._FormatMessage(r),q=this._Levels[K],J=Array.isArray(O)?O.slice(1):[];q.logFunc&&q.logFunc("BJS - "+l,...J);const c=`<div style='color:${q.color}'>${l}</div><br>`;f._AddLogEntry(c),f._GenerateLimitMessage(r,K)}static get LogCache(){return f._LogCache}static ClearLogCache(){f._LogCache="",f._LogLimitOutputs={},f.errorsCount=0}static set LogLevels(K){f.Log=f._LogDisabled,f.Warn=f._LogDisabled,f.Error=f._LogDisabled;const O=[f.MessageLogLevel,f.WarningLogLevel,f.ErrorLogLevel];for(const F of O)if((K&F)===F){const K=this._Levels[F];f[K.name]=f._LogEnabled.bind(f,F)}}}f.NoneLogLevel=0,f.MessageLogLevel=1,f.WarningLogLevel=2,f.ErrorLogLevel=4,f.AllLogLevel=7,f.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",f._LogCache="",f._LogLimitOutputs={},f._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],f.errorsCount=0,f.Log=f._LogEnabled.bind(f,f.MessageLogLevel),f.Warn=f._LogEnabled.bind(f,f.WarningLogLevel),f.Error=f._LogEnabled.bind(f,f.ErrorLogLevel)},11523:(K,O,F)=>{F.d(O,{c:()=>q});const f="undefined"!==typeof WeakRef;class r{constructor(K){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],F=arguments.length>2?arguments[2]:void 0,f=arguments.length>3?arguments[3]:void 0;this.initialize(K,O,F,f)}initialize(K){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],F=arguments.length>2?arguments[2]:void 0,f=arguments.length>3?arguments[3]:void 0;return this.mask=K,this.skipNextObservers=O,this.target=F,this.currentTarget=f,this}}class l{constructor(K,O){let F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=K,this.mask=O,this.scope=F,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(K)}}class q{static FromPromise(K,O){const F=new q;return K.then((K=>{F.notifyObservers(K)})).catch((K=>{if(!O)throw K;O.notifyObservers(K)})),F}get observers(){return this._observers}constructor(K){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=O,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new r(0),K&&(this._onObserverAdded=K)}add(K){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2],F=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!K)return null;const r=new l(K,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);r.unregisterOnNextCall=F,O?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(r,this._lastNotifiedValue);const q=f?new WeakRef(this):{deref:()=>this};return r._remove=function(){let K=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=q.deref();O&&(K?O.remove(r):O._remove(r))},r}addOnce(K){return this.add(K,void 0,void 0,void 0,!0)}remove(K){if(!K)return!1;K._remove=null;return-1!==this._observers.indexOf(K)&&(this._deferUnregister(K),!0)}removeCallback(K,O){for(let F=0;F<this._observers.length;F++){const f=this._observers[F];if(!f._willBeUnregistered&&(f.callback===K&&(!O||O===f.scope)))return this._deferUnregister(f),!0}return!1}_deferUnregister(K){K._willBeUnregistered||(this._numObserversMarkedAsDeleted++,K.unregisterOnNextCall=!1,K._willBeUnregistered=!0,setTimeout((()=>{this._remove(K)}),0))}_remove(K){let O=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!K)return!1;const F=this._observers.indexOf(K);return-1!==F&&(O&&this._numObserversMarkedAsDeleted--,this._observers.splice(F,1),!0)}makeObserverTopPriority(K){this._remove(K,!1),this._observers.unshift(K)}makeObserverBottomPriority(K){this._remove(K,!1),this._observers.push(K)}notifyObservers(K){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,F=arguments.length>2?arguments[2]:void 0,f=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=K),!this._observers.length)return!0;const l=this._eventState;l.mask=O,l.target=F,l.currentTarget=f,l.skipNextObservers=!1,l.lastReturnValue=K,l.userInfo=r;for(const q of this._observers)if(!q._willBeUnregistered&&(q.mask&O&&(q.unregisterOnNextCall&&this._deferUnregister(q),q.scope?l.lastReturnValue=q.callback.apply(q.scope,[K,l]):l.lastReturnValue=q.callback(K,l)),l.skipNextObservers))return!1;return!0}notifyObserver(K,O){let F=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=O),K._willBeUnregistered)return;const f=this._eventState;f.mask=F,f.skipNextObservers=!1,K.unregisterOnNextCall&&this._deferUnregister(K),K.callback(O,f)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const K=this._observers.pop();K&&(K._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const K=new q;return K._observers=this._observers.slice(0),K}hasSpecificMask(){let K=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const O of this._observers)if(O.mask&K||O.mask===K)return!0;return!1}}},11588:(K,O,F)=>{F.d(O,{c:()=>r,g:()=>q});let f=[];class r{static SetImmediate(K){0===f.length&&setTimeout((()=>{const K=f;f=[];for(const O of K)O()}),1),f.push(K)}}function l(K,O,F){try{if(K())return O(),!0}catch(f){return null===F||void 0===F||F(f),!0}return!1}const q=function(K,O,F){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,q=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&l(K,O,F))return null;const J=setInterval((()=>{l(K,O,F)?clearInterval(J):(r-=f,r<0&&(clearInterval(J),null===F||void 0===F||F(new Error("Operation timed out after maximum retries. "+(q||"")),!0)))}),f);return()=>clearInterval(J)}}}]);