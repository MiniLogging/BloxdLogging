"use strict";(self.wx5iyvo7rvn=self.wx5iyvo7rvn||[]).push([[9],{11041:(P,e,n)=>{n.d(e,{e:()=>l,g:()=>i,l:()=>B,j:()=>r,p:()=>o});class H{constructor(){this.children=[]}isValid(P){return!0}process(P,e,n){let H="";if(this.line){let n=this.line;const R=e.processor;if(R){var S,p,k,m,t,C;R.lineProcessor&&(n=R.lineProcessor(n,e.isFragment,e.processingContext));const H=(null===(S=e.processor)||void 0===S?void 0:S.attributeKeywordName)??"attribute",q=e.isFragment&&null!==(p=e.processor)&&void 0!==p&&p.varyingFragmentKeywordName?null===(k=e.processor)||void 0===k?void 0:k.varyingFragmentKeywordName:!e.isFragment&&null!==(m=e.processor)&&void 0!==m&&m.varyingVertexKeywordName?null===(t=e.processor)||void 0===t?void 0:t.varyingVertexKeywordName:"varying";if(!e.isFragment&&R.attributeProcessor&&this.line.startsWith(H))n=R.attributeProcessor(this.line,P,e.processingContext);else if(R.varyingProcessor&&(null!==(C=R.varyingCheck)&&void 0!==C&&C.call(R,this.line,e.isFragment)||!R.varyingCheck&&this.line.startsWith(q)))n=R.varyingProcessor(this.line,e.isFragment,P,e.processingContext);else if(R.uniformProcessor&&R.uniformRegexp&&R.uniformRegexp.test(this.line))e.lookForClosingBracketForUniformBuffer||(n=R.uniformProcessor(this.line,e.isFragment,P,e.processingContext));else if(R.uniformBufferProcessor&&R.uniformBufferRegexp&&R.uniformBufferRegexp.test(this.line))e.lookForClosingBracketForUniformBuffer||(n=R.uniformBufferProcessor(this.line,e.isFragment,e.processingContext),e.lookForClosingBracketForUniformBuffer=!0);else if(R.textureProcessor&&R.textureRegexp&&R.textureRegexp.test(this.line))n=R.textureProcessor(this.line,e.isFragment,P,e.processingContext);else if((R.uniformProcessor||R.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!e.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?R.uniformProcessor&&(n=R.uniformProcessor(this.line,e.isFragment,P,e.processingContext)):R.uniformBufferProcessor&&(n=R.uniformBufferProcessor(this.line,e.isFragment,e.processingContext),e.lookForClosingBracketForUniformBuffer=!0)}e.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(e.lookForClosingBracketForUniformBuffer=!1,R.endOfUniformBufferProcessor&&(n=R.endOfUniformBufferProcessor(this.line,e.isFragment,e.processingContext)))}H+=n+"\n"}for(const R of this.children)H+=R.process(P,e,n);return this.additionalDefineKey&&(P[this.additionalDefineKey]=this.additionalDefineValue||"true",n[this.additionalDefineKey]=P[this.additionalDefineKey]),H}}class S{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(P){this._lines.length=0;for(const e of P){if(!e||"\r"===e)continue;if("#"===e[0]){this._lines.push(e);continue}const P=e.trim();if(!P)continue;if(P.startsWith("//")){this._lines.push(e);continue}const n=P.indexOf(";");if(-1===n)this._lines.push(P);else if(n===P.length-1)P.length>1&&this._lines.push(P);else{const P=e.split(";");for(let e=0;e<P.length;e++){let n=P[e];n&&(n=n.trim(),n&&this._lines.push(n+(e!==P.length-1?";":"")))}}}}}class p extends H{process(P,e,n){for(let H=0;H<this.children.length;H++){const S=this.children[H];if(S.isValid(P))return S.process(P,e,n)}return""}}class k extends H{isValid(P){return this.testExpression.isTrue(P)}}class m{isTrue(P){return!0}static postfixToInfix(P){const e=[];for(const n of P)if(void 0===m._OperatorPriority[n])e.push(n);else{const P=e[e.length-1],H=e[e.length-2];e.length-=2,e.push(`(${H}${n}${P})`)}return e[e.length-1]}static infixToPostfix(P){const e=m._InfixToPostfixCache.get(P);if(e)return e.accessTime=Date.now(),e.result;if(!P.includes("&&")&&!P.includes("||")&&!P.includes(")")&&!P.includes("("))return[P];const n=[];let H=-1;const S=()=>{R=R.trim(),""!==R&&(n.push(R),R="")},p=P=>{H<m._Stack.length-1&&(m._Stack[++H]=P)},k=()=>m._Stack[H],t=()=>-1===H?"!!INVALID EXPRESSION!!":m._Stack[H--];let C=0,R="";for(;C<P.length;){const e=P.charAt(C),q=C<P.length-1?P.substring(C,2+C):"";if("("===e)R="",p(e);else if(")"===e){for(S();-1!==H&&"("!==k();)n.push(t());t()}else if(m._OperatorPriority[q]>1){for(S();-1!==H&&m._OperatorPriority[k()]>=m._OperatorPriority[q];)n.push(t());p(q),C++}else R+=e;C++}for(S();-1!==H;)"("===k()?t():n.push(t());return m._InfixToPostfixCache.size>=m.InfixToPostfixCacheLimitSize&&m.ClearCache(),m._InfixToPostfixCache.set(P,{result:n,accessTime:Date.now()}),n}static ClearCache(){const P=Array.from(m._InfixToPostfixCache.entries()).sort(((P,e)=>P[1].accessTime-e[1].accessTime));for(let e=0;e<m.InfixToPostfixCacheCleanupSize;e++)m._InfixToPostfixCache.delete(P[e][0])}}m.InfixToPostfixCacheLimitSize=5e4,m.InfixToPostfixCacheCleanupSize=25e3,m._InfixToPostfixCache=new Map,m._OperatorPriority={")":0,"(":1,"||":2,"&&":3},m._Stack=["","","","","","","","","","","","","","","","","","","",""];class t extends m{constructor(P){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=P,this.not=e}isTrue(P){let e=void 0!==P[this.define];return this.not&&(e=!e),e}}class C extends m{isTrue(P){return this.leftOperand.isTrue(P)||this.rightOperand.isTrue(P)}}class R extends m{isTrue(P){return this.leftOperand.isTrue(P)&&this.rightOperand.isTrue(P)}}class q extends m{constructor(P,e,n){super(),this.define=P,this.operand=e,this.testValue=n}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(P){let e=!1;const n=parseInt(void 0!=P[this.define]?P[this.define]:this.define),H=parseInt(void 0!=P[this.testValue]?P[this.testValue]:this.testValue);if(isNaN(n)||isNaN(H))return!1;switch(this.operand){case">":e=n>H;break;case"<":e=n<H;break;case"<=":e=n<=H;break;case">=":e=n>=H;break;case"==":e=n===H;break;case"!=":e=n!==H}return e}}var A=n(11007),F=n(11044);const Y=/defined\s*?\((.+?)\)/g,j=/defined\s*?\[(.+?)\]/g,z=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,w=/__decl__/,J=/light\{X\}.(\w*)/g,I=/\{X\}/g,O=[],V=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function i(P){P.processor&&P.processor.initializeShaders&&P.processor.initializeShaders(P.processingContext)}function B(P,e,n,H){var S;null!==(S=e.processor)&&void 0!==S&&S.preProcessShaderCode&&(P=e.processor.preProcessShaderCode(P,e.isFragment)),r(P,e,(P=>{e.processCodeAfterIncludes&&(P=e.processCodeAfterIncludes(e.isFragment?"fragment":"vertex",P,e.defines));const S=function(P,e,n){let H=function(P,e){var n;if(null!==(n=e.processor)&&void 0!==n&&n.noPrecision)return P;const H=e.shouldUseHighPrecisionShader;-1===P.indexOf("precision highp float")?P=H?"precision highp float;\n"+P:"precision mediump float;\n"+P:H||(P=P.replace("precision highp float","precision mediump float"));return P}(P,e);if(!e.processor)return H;if(0===e.processor.shaderLanguage&&-1!==H.indexOf("#version 3")&&(H=H.replace("#version 300 es",""),!e.processor.parseGLES3))return H;const S=e.defines,p=c(e,n);e.processor.preProcessor&&(H=e.processor.preProcessor(H,S,p,e.isFragment,e.processingContext));const k={};H=Q(H,p,e,k),e.processor.postProcessor&&(H=e.processor.postProcessor(H,S,e.isFragment,e.processingContext,n?{drawBuffersExtensionDisabled:!n.getCaps().drawBuffersExtension}:{},p,k));null!==n&&void 0!==n&&n._features.needShaderCodeInlining&&(H=n.inlineShaderCode(H));return H}(P,e,H);n(S,P)}))}function l(P,e,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(P,e,n.processingContext):{vertexCode:P,fragmentCode:e}}function b(P){const e=/defined\((.+)\)/.exec(P);if(e&&e.length)return new t(e[1].trim(),"!"===P[0]);const n=["==","!=",">=","<=","<",">"];let H="",S=0;for(H of n)if(S=P.indexOf(H),S>-1)break;if(-1===S)return new t(P);const p=P.substring(0,S).trim(),k=P.substring(S+H.length).trim();return new q(p,H,k)}function T(P,e){const n=new k,H=P.substring(0,e);let S=P.substring(e);return S=S.substring(0,(S.indexOf("//")+1||S.length+1)-1).trim(),n.testExpression="#ifdef"===H?new t(S):"#ifndef"===H?new t(S,!0):function(P){P=P.replace(Y,"defined[$1]");const e=m.infixToPostfix(P),n=[];for(const S of e)if("||"!==S&&"&&"!==S)n.push(S);else if(n.length>=2){let P=n[n.length-1],e=n[n.length-2];n.length-=2;const H="&&"==S?new R:new C;"string"===typeof P&&(P=P.replace(j,"defined($1)")),"string"===typeof e&&(e=e.replace(j,"defined($1)")),H.leftOperand="string"===typeof e?b(e):e,H.rightOperand="string"===typeof P?b(P):P,n.push(H)}let H=n[n.length-1];return"string"===typeof H&&(H=H.replace(j,"defined($1)")),"string"===typeof H?b(H):H}(S),n}function d(P,e,n,S){let p=P.currentLine;for(;N(P,n,S);){p=P.currentLine;const k=p.substring(0,5).toLowerCase();if("#else"===k){const n=new H;return e.children.push(n),void N(P,n,S)}if("#elif"===k){const P=T(p,5);e.children.push(P),n=P}}}function N(P,e,n){for(;P.canRead;){P.lineIndex++;const S=P.currentLine;if(S.indexOf("#")>=0){const H=V.exec(S);if(H&&H.length){switch(H[0]){case"#ifdef":{const H=new p;e.children.push(H);const k=T(S,6);H.children.push(k),d(P,H,k,n);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const H=new p;e.children.push(H);const k=T(S,7);H.children.push(k),d(P,H,k,n);break}case"#if":{const H=new p,k=T(S,3);e.children.push(H),H.children.push(k),d(P,H,k,n);break}}continue}}const k=new H;if(k.line=S,e.children.push(k),"#"===S[0]&&"d"===S[1]){const P=S.replace(";","").split(" ");k.additionalDefineKey=P[1],3===P.length&&(k.additionalDefineValue=P[2])}}return!1}function Q(P,e,n,p){const k=new H,m=new S;return m.lineIndex=-1,m.lines=P.split("\n"),N(m,k,p),k.process(e,n,p)}function c(P,e){var n;const H=P.defines,S={};for(const p of H){const P=p.replace("#define","").replace(";","").trim().split(" ");S[P[0]]=P.length>1?P[1]:""}return 0===(null===(n=P.processor)||void 0===n?void 0:n.shaderLanguage)&&(S.GL_ES="true"),S.__VERSION__=P.version,S[P.platformName]="true",(0,F.j)(S,null===e||void 0===e?void 0:e.isNDCHalfZRange,null===e||void 0===e?void 0:e.useReverseDepthBuffer,null===e||void 0===e?void 0:e.useExactSrgbConversions),S}function r(P,e,n){let H;for(O.length=0;null!==(H=z.exec(P));)O.push(H);let S=String(P),p=[P],k=!1;for(const m of O){let P=m[1];if(-1!==P.indexOf("__decl__")&&(P=P.replace(w,""),e.supportsUniformBuffers&&(P=P.replace("Vertex","Ubo").replace("Fragment","Ubo")),P+="Declaration"),!e.includesShadersStore[P]){const H=e.shadersRepository+"ShadersInclude/"+P+".fx";return void o.loadFile(H,(H=>{e.includesShadersStore[P]=H,r(p.join(""),e,n)}))}{let n=e.includesShadersStore[P];if(m[2]){const P=m[3].split(",");for(let e=0;e<P.length;e+=2){const H=new RegExp(P[e],"g"),S=P[e+1];n=n.replace(H,S)}}if(m[4]){const P=m[5];if(-1!==P.indexOf("..")){const H=P.split(".."),S=parseInt(H[0]);let p=parseInt(H[1]),k=n.slice(0);n="",isNaN(p)&&(p=e.indexParameters[H[1]]);for(let P=S;P<p;P++)e.supportsUniformBuffers||(k=k.replace(J,((P,e)=>e+"{X}"))),n+=k.replace(I,P.toString())+"\n"}else e.supportsUniformBuffers||(n=n.replace(J,((P,e)=>e+"{X}"))),n=n.replace(I,P)}const H=[];for(const P of p){const e=P.split(m[0]);for(let P=0;P<e.length-1;P++)H.push(e[P]),H.push(n);H.push(e[e.length-1])}p=H,k=k||n.indexOf("#include<")>=0||n.indexOf("#include <")>=0}}O.length=0,S=p.join(""),k?r(S.toString(),e,n):n(S)}const o={loadFile:(P,e,n,H,S,p)=>{throw(0,A.d)("FileTools")}}},11044:(P,e,n)=>{n.d(e,{d:()=>S,g:()=>p,j:()=>m,k:()=>k,n:()=>t});var H=n(11007);n(10983);const S={};function p(P,e){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(e?e+"\n":"")+P}function k(P,e,n,p,k,m,t){const C=t||S.loadFile;if(C){return C(P,e,n,p,k,m)}throw(0,H.d)("FileTools")}function m(P,e,n,H){if(P)return e?P.IS_NDC_HALF_ZRANGE="":delete P.IS_NDC_HALF_ZRANGE,n?P.USE_REVERSE_DEPTHBUFFER="":delete P.USE_REVERSE_DEPTHBUFFER,void(H?P.USE_EXACT_SRGB_CONVERSIONS="":delete P.USE_EXACT_SRGB_CONVERSIONS);{let P="";return e&&(P+="#define IS_NDC_HALF_ZRANGE"),n&&(P&&(P+="\n"),P+="#define USE_REVERSE_DEPTHBUFFER"),H&&(P&&(P+="\n"),P+="#define USE_EXACT_SRGB_CONVERSIONS"),P}}function t(P,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>3?arguments[3]:void 0;switch(P){case 3:{const P=(ArrayBuffer,new Int8Array(e));return H&&P.set(new Int8Array(H)),P}case 0:{const P=(ArrayBuffer,new Uint8Array(e));return H&&P.set(new Uint8Array(H)),P}case 4:{const P=e instanceof ArrayBuffer?new Int16Array(e):new Int16Array(n?e/2:e);return H&&P.set(new Int16Array(H)),P}case 5:case 8:case 9:case 10:case 2:{const P=e instanceof ArrayBuffer?new Uint16Array(e):new Uint16Array(n?e/2:e);return H&&P.set(new Uint16Array(H)),P}case 6:{const P=e instanceof ArrayBuffer?new Int32Array(e):new Int32Array(n?e/4:e);return H&&P.set(new Int32Array(H)),P}case 7:case 11:case 12:case 13:case 14:case 15:{const P=e instanceof ArrayBuffer?new Uint32Array(e):new Uint32Array(n?e/4:e);return H&&P.set(new Uint32Array(H)),P}case 1:{const P=e instanceof ArrayBuffer?new Float32Array(e):new Float32Array(n?e/4:e);return H&&P.set(new Float32Array(H)),P}}const S=(ArrayBuffer,new Uint8Array(e));return H&&S.set(new Uint8Array(H)),S}},11058:(P,e,n)=>{n.d(e,{d:()=>H});class H{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersRepository:H.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersStore:H.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.IncludesShadersStore:H.IncludesShadersStoreWGSL}}H.ShadersRepository="src/Shaders/",H.ShadersStore={},H.IncludesShadersStore={},H.ShadersRepositoryWGSL="src/ShadersWGSL/",H.ShadersStoreWGSL={},H.IncludesShadersStoreWGSL={}},11069:(P,e,n)=>{n.d(e,{d:()=>A,e:()=>I,i:()=>Y,m:()=>F,n:()=>j,p:()=>J,t:()=>q,u:()=>C,x:()=>R,z:()=>t,B:()=>m});class H{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Je._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(P){P&&this.program&&P(this.program)}setEngine(P){this.Je=P}_fillEffectInformation(P,e,n,H,S,p,k,m){const t=this.Je;if(t.supportsUniformBuffers)for(const R in e)P.bindUniformBlock(R,e[R]);let C;for(this.Je.getUniforms(this,n).forEach(((P,e)=>{H[n[e]]=P})),this._uniforms=H,C=0;C<S.length;C++){null==P.getUniform(S[C])&&(S.splice(C,1),C--)}S.forEach(((P,e)=>{p[P]=e}));for(const R of t.getAttributes(this,k))m.push(R)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(P,e){const n=this._valueCache[P],H=e.updateFlag;return(void 0===n||n!==H)&&(this._valueCache[P]=H,!0)}_cacheFloat2(P,e,n){let H=this._valueCache[P];if(!H||2!==H.length)return H=[e,n],this._valueCache[P]=H,!0;let S=!1;return H[0]!==e&&(H[0]=e,S=!0),H[1]!==n&&(H[1]=n,S=!0),S}_cacheFloat3(P,e,n,H){let S=this._valueCache[P];if(!S||3!==S.length)return S=[e,n,H],this._valueCache[P]=S,!0;let p=!1;return S[0]!==e&&(S[0]=e,p=!0),S[1]!==n&&(S[1]=n,p=!0),S[2]!==H&&(S[2]=H,p=!0),p}_cacheFloat4(P,e,n,H,S){let p=this._valueCache[P];if(!p||4!==p.length)return p=[e,n,H,S],this._valueCache[P]=p,!0;let k=!1;return p[0]!==e&&(p[0]=e,k=!0),p[1]!==n&&(p[1]=n,k=!0),p[2]!==H&&(p[2]=H,k=!0),p[3]!==S&&(p[3]=S,k=!0),k}setInt(P,e){const n=this._valueCache[P];void 0!==n&&n===e||this.Je.setInt(this._uniforms[P],e)&&(this._valueCache[P]=e)}setInt2(P,e,n){this._cacheFloat2(P,e,n)&&(this.Je.setInt2(this._uniforms[P],e,n)||(this._valueCache[P]=null))}setInt3(P,e,n,H){this._cacheFloat3(P,e,n,H)&&(this.Je.setInt3(this._uniforms[P],e,n,H)||(this._valueCache[P]=null))}setInt4(P,e,n,H,S){this._cacheFloat4(P,e,n,H,S)&&(this.Je.setInt4(this._uniforms[P],e,n,H,S)||(this._valueCache[P]=null))}setIntArray(P,e){this._valueCache[P]=null,this.Je.setIntArray(this._uniforms[P],e)}setIntArray2(P,e){this._valueCache[P]=null,this.Je.setIntArray2(this._uniforms[P],e)}setIntArray3(P,e){this._valueCache[P]=null,this.Je.setIntArray3(this._uniforms[P],e)}setIntArray4(P,e){this._valueCache[P]=null,this.Je.setIntArray4(this._uniforms[P],e)}setUInt(P,e){const n=this._valueCache[P];void 0!==n&&n===e||this.Je.setUInt(this._uniforms[P],e)&&(this._valueCache[P]=e)}setUInt2(P,e,n){this._cacheFloat2(P,e,n)&&(this.Je.setUInt2(this._uniforms[P],e,n)||(this._valueCache[P]=null))}setUInt3(P,e,n,H){this._cacheFloat3(P,e,n,H)&&(this.Je.setUInt3(this._uniforms[P],e,n,H)||(this._valueCache[P]=null))}setUInt4(P,e,n,H,S){this._cacheFloat4(P,e,n,H,S)&&(this.Je.setUInt4(this._uniforms[P],e,n,H,S)||(this._valueCache[P]=null))}setUIntArray(P,e){this._valueCache[P]=null,this.Je.setUIntArray(this._uniforms[P],e)}setUIntArray2(P,e){this._valueCache[P]=null,this.Je.setUIntArray2(this._uniforms[P],e)}setUIntArray3(P,e){this._valueCache[P]=null,this.Je.setUIntArray3(this._uniforms[P],e)}setUIntArray4(P,e){this._valueCache[P]=null,this.Je.setUIntArray4(this._uniforms[P],e)}setArray(P,e){this._valueCache[P]=null,this.Je.setArray(this._uniforms[P],e)}setArray2(P,e){this._valueCache[P]=null,this.Je.setArray2(this._uniforms[P],e)}setArray3(P,e){this._valueCache[P]=null,this.Je.setArray3(this._uniforms[P],e)}setArray4(P,e){this._valueCache[P]=null,this.Je.setArray4(this._uniforms[P],e)}setMatrices(P,e){e&&(this._valueCache[P]=null,this.Je.setMatrices(this._uniforms[P],e))}setMatrix(P,e){this._cacheMatrix(P,e)&&(this.Je.setMatrices(this._uniforms[P],e.fe())||(this._valueCache[P]=null))}setMatrix3x3(P,e){this._valueCache[P]=null,this.Je.setMatrix3x3(this._uniforms[P],e)}setMatrix2x2(P,e){this._valueCache[P]=null,this.Je.setMatrix2x2(this._uniforms[P],e)}setFloat(P,e){const n=this._valueCache[P];void 0!==n&&n===e||this.Je.setFloat(this._uniforms[P],e)&&(this._valueCache[P]=e)}setVector2(P,e){this._cacheFloat2(P,e.x,e.y)&&(this.Je.setFloat2(this._uniforms[P],e.x,e.y)||(this._valueCache[P]=null))}setFloat2(P,e,n){this._cacheFloat2(P,e,n)&&(this.Je.setFloat2(this._uniforms[P],e,n)||(this._valueCache[P]=null))}setVector3(P,e){this._cacheFloat3(P,e.x,e.y,e.z)&&(this.Je.setFloat3(this._uniforms[P],e.x,e.y,e.z)||(this._valueCache[P]=null))}setFloat3(P,e,n,H){this._cacheFloat3(P,e,n,H)&&(this.Je.setFloat3(this._uniforms[P],e,n,H)||(this._valueCache[P]=null))}setVector4(P,e){this._cacheFloat4(P,e.x,e.y,e.z,e.w)&&(this.Je.setFloat4(this._uniforms[P],e.x,e.y,e.z,e.w)||(this._valueCache[P]=null))}setQuaternion(P,e){this._cacheFloat4(P,e.x,e.y,e.z,e.w)&&(this.Je.setFloat4(this._uniforms[P],e.x,e.y,e.z,e.w)||(this._valueCache[P]=null))}setFloat4(P,e,n,H,S){this._cacheFloat4(P,e,n,H,S)&&(this.Je.setFloat4(this._uniforms[P],e,n,H,S)||(this._valueCache[P]=null))}setColor3(P,e){this._cacheFloat3(P,e.r,e.g,e.b)&&(this.Je.setFloat3(this._uniforms[P],e.r,e.g,e.b)||(this._valueCache[P]=null))}setColor4(P,e,n){this._cacheFloat4(P,e.r,e.g,e.b,n)&&(this.Je.setFloat4(this._uniforms[P],e.r,e.g,e.b,n)||(this._valueCache[P]=null))}setDirectColor4(P,e){this._cacheFloat4(P,e.r,e.g,e.b,e.a)&&(this.Je.setFloat4(this._uniforms[P],e.r,e.g,e.b,e.a)||(this._valueCache[P]=null))}_getVertexShaderCode(){return this.vertexShader?this.Je._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Je._getShaderSource(this.fragmentShader):null}}var S=n(11044);const p=new WeakMap,k={_webGLVersion:2,cachedPipelines:{}};function m(P){let e=p.get(P);if(!e){if(!P)return k;e={_webGLVersion:P.TEXTURE_BINDING_3D?2:1,_context:P,parallelShaderCompile:P.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},p.set(P,e)}return e}function t(P){p.delete(P)}function C(P,e,n,H,S,p){const k=m(H);p||(p=k._createShaderProgramInjection??A);return p(P,w(e,"vertex",H,k._contextWasLost),w(n,"fragment",H,k._contextWasLost),H,S,k.validateShaderPrograms)}function R(P,e,n,H,S){let p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,k=arguments.length>6?arguments[6]:void 0;const t=m(S);k||(k=t._createShaderProgramInjection??A);const C=t._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return k(P,z(e,"vertex",H,C,S,t._contextWasLost),z(n,"fragment",H,C,S,t._contextWasLost),S,p,t.validateShaderPrograms)}function q(P,e){const n=new H,S=m(P);return S.parallelShaderCompile&&!S.disableParallelShaderCompile&&(n.isParallelCompiled=!0),n.context=S._context,n}function A(P,e,n,H){let S=arguments.length>5?arguments[5]:void 0;const p=H.createProgram();if(P.program=p,!p)throw new Error("Unable to create program");return H.attachShader(p,e),H.attachShader(p,n),H.linkProgram(p),P.context=H,P.vertexShader=e,P.fragmentShader=n,P.isParallelCompiled||Y(P,H,S),p}function F(P,e,n){const H=P;if(H._isDisposed)return!1;const S=m(e);return!!(S&&S.parallelShaderCompile&&S.parallelShaderCompile.COMPLETION_STATUS_KHR&&H.program&&e.getProgramParameter(H.program,S.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(Y(H,e,n),!0)}function Y(P,e,n){const H=P.context,S=P.vertexShader,p=P.fragmentShader,k=P.program;if(!H.getProgramParameter(k,H.LINK_STATUS)){if(!e.getShaderParameter(S,e.COMPILE_STATUS)){const n=e.getShaderInfoLog(S);if(n)throw P.vertexCompilationError=n,new Error("VERTEX SHADER "+n)}if(!e.getShaderParameter(p,e.COMPILE_STATUS)){const n=e.getShaderInfoLog(p);if(n)throw P.fragmentCompilationError=n,new Error("FRAGMENT SHADER "+n)}const n=H.getProgramInfoLog(k);if(n)throw P.programLinkError=n,new Error(n)}if(n){H.validateProgram(k);if(!H.getProgramParameter(k,H.VALIDATE_STATUS)){const e=H.getProgramInfoLog(k);if(e)throw P.programValidationError=e,new Error(e)}}H.deleteShader(S),H.deleteShader(p),P.vertexShader=void 0,P.fragmentShader=void 0,P.onCompiled&&(P.onCompiled(),P.onCompiled=void 0)}function j(P,e,n,H,S,p,k,t,q){let A=arguments.length>10?arguments[10]:void 0,F=arguments.length>11?arguments[11]:void 0,Y=arguments.length>12?arguments[12]:void 0;const j=m(P.context);F||(F=j.createRawShaderProgramInjection??C),Y||(Y=j.createShaderProgramInjection??R);const z=P;z.program=H?F(z,e,n,z.context,q):Y(z,e,n,t,z.context,q),z.program.__SPECTOR_rebuildProgram=k,A()}function z(P,e,n,H,p,k){return w((0,S.g)(P,n,H),e,p,k)}function w(P,e,n,H){const S=n.createShader("vertex"===e?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(!S){let P=n.NO_ERROR,S=n.NO_ERROR;for(;(S=n.getError())!==n.NO_ERROR;)P=S;throw new Error(`Something went wrong while creating a gl ${e} shader object. gl error=${P}, gl isContextLost=${n.isContextLost()}, _contextWasLost=${H}`)}return n.shaderSource(S,P),n.compileShader(S),S}function J(P,e){e.useProgram(P)}function I(P,e){const n=P;if(!n.isParallelCompiled)return void e(P);const H=n.onCompiled;n.onCompiled=()=>{null===H||void 0===H||H(),e(P)}}},11065:(P,e,n)=>{n.d(e,{d:()=>q,e:()=>F,g:()=>C,j:()=>R});var H=n(10983),S=n(11069),p=n(11058),k=n(10988),m=n(11041),t=n(11044);function C(P,e){return(0,S.B)(e).cachedPipelines[P]}function R(P){const e=P._name,n=P.context;if(e&&n){const P=(0,S.B)(n),H=P.cachedPipelines[e];null===H||void 0===H||H.dispose(),delete P.cachedPipelines[e]}}function q(P,e,n,S,p,k,t){let C,R;const q=(0,H.h)()?null===k||void 0===k?void 0:k.getHostDocument():null;C="string"===typeof e?e:e.vertexSource?"source:"+e.vertexSource:e.vertexElement?(null===q||void 0===q?void 0:q.getElementById(e.vertexElement))||e.vertexElement:e.vertex||e,R="string"===typeof e?e:e.fragmentSource?"source:"+e.fragmentSource:e.fragmentElement?(null===q||void 0===q?void 0:q.getElementById(e.fragmentElement))||e.fragmentElement:e.fragment||e;const F=[void 0,void 0],Y=()=>{if(F[0]&&F[1]){P.isFragment=!0;const[H,C]=F;(0,m.l)(C,P,((k,C)=>{t&&(t._fragmentSourceCodeBeforeMigration=C),n&&(k=n("fragment",k));const R=(0,m.e)(H,k,P);P=null;const q=function(P,e,n,H){if(n){return{vertexSourceCode:(1===H?"//":"")+"#define SHADER_NAME vertex:"+(n.vertexElement||n.vertex||n.spectorName||n)+"\n"+P,fragmentSourceCode:(1===H?"//":"")+"#define SHADER_NAME fragment:"+(n.fragmentElement||n.fragment||n.spectorName||n)+"\n"+e}}return{vertexSourceCode:P,fragmentSourceCode:e}}(R.vertexCode,R.fragmentCode,e,p);null===S||void 0===S||S(q.vertexSourceCode,q.fragmentSourceCode)}),k)}};A(C,"Vertex","",(e=>{(0,m.g)(P),(0,m.l)(e,P,((P,H)=>{t&&(t._rawVertexSourceCode=e,t._vertexSourceCodeBeforeMigration=H),n&&(P=n("vertex",P)),F[0]=P,Y()}),k)}),p),A(R,"Fragment","Pixel",(P=>{t&&(t._rawFragmentSourceCode=P),F[1]=P,Y()}),p)}function A(P,e,n,S,k,m){if("undefined"!==typeof HTMLElement&&P instanceof HTMLElement){return void S((0,H.d)(P))}if("source:"===P.substring(0,7))return void S(P.substring(7));if("base64:"===P.substring(0,7)){return void S(window.atob(P.substring(7)))}const C=p.d.GetShadersStore(k);if(C[P+e+"Shader"])return void S(C[P+e+"Shader"]);if(n&&C[P+n+"Shader"])return void S(C[P+n+"Shader"]);let R;if(R="."===P[0]||"/"===P[0]||P.indexOf("http")>-1?P:p.d.GetShadersRepository(k)+P,!(m=m||t.k))throw new Error("loadFileInjection is not defined");m(R+"."+e.toLowerCase()+".fx",S)}const F=(P,e,n,H)=>{try{const p=P.context?(0,S.B)(P.context):null;p&&(p.disableParallelShaderCompile=P.disableParallelCompilation);const k=P.existingPipelineContext||e(P.shaderProcessingContext);return k._name=P.name,P.name&&p&&(p.cachedPipelines[P.name]=k),n(k,P.vertex,P.fragment,!!P.createAsRaw,"","",P.rebuildRebind,P.defines,P.transformFeedbackVaryings,"",(()=>{H(k,(()=>{var e;null===(e=P.onRenderingStateCompiled)||void 0===e||e.call(P,k)}))})),k}catch(p){throw k.c.Error("Error compiling effect"),p}}},11056:(P,e,n)=>{n.r(e),n.d(e,{Effect:()=>t});var H=n(10976),S=n(10988),p=n(11058),k=n(11065),m=n(11047);class t{static get ShadersRepository(){return p.d.ShadersRepository}static set ShadersRepository(P){p.d.ShadersRepository=P}get C(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new H.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(P,e,n){let S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4?arguments[4]:void 0,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,R=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,q=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,A=arguments.length>9?arguments[9]:void 0,F=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",Y=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,j=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new H.b,this.onErrorObservable=new H.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=P,this._key=F;const z=this._key.replace(/\r/g,"").replace(/\n/g,"|");let w;if(e.attributes){const P=e;if(this._engine=n,this._attributesNames=P.attributes,this._uniformsNames=P.uniformsNames.concat(P.samplers),this._samplerList=P.samplers.slice(),this.defines=P.defines,this.onError=P.onError,this.onCompiled=P.onCompiled,this._fallbacks=P.fallbacks,this._indexParameters=P.indexParameters,this._transformFeedbackVaryings=P.transformFeedbackVaryings||null,this._multiTarget=!!P.multiTarget,this._shaderLanguage=P.shaderLanguage??0,this._disableParallelShaderCompilation=!!P.disableParallelShaderCompilation,P.uniformBuffersNames){this._uniformBuffersNamesList=P.uniformBuffersNames.slice();for(let e=0;e<P.uniformBuffersNames.length;e++)this._uniformBuffersNames[P.uniformBuffersNames[e]]=e}this._processFinalCode=P.processFinalCode??null,this._processCodeAfterIncludes=P.processCodeAfterIncludes??void 0,j=P.extraInitializationsAsync,w=P.existingPipelineContext}else this._engine=p,this.defines=null==m?"":m,this._uniformsNames=n.concat(S),this._samplerList=S?S.slice():[],this._attributesNames=e,this._uniformBuffersNamesList=[],this._shaderLanguage=Y,this.onError=q,this.onCompiled=R,this._indexParameters=A,this._fallbacks=C;"WEBGL2"===this._engine.shaderPlatformName&&(w=(0,k.g)(z,this._engine._gl)??w),this._attributeLocationByName={},this.uniqueId=t._UniqueIdSeed++,w?(this._pipelineContext=w,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,j),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.C||this.dispose(!0)}))}async _processShaderCodeAsync(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,H=arguments.length>3?arguments[3]:void 0;H&&await H(),this._processingContext=n||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const S={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:P??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:p.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:p.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,k.d)(S,this.name,this._processFinalCode,((P,n)=>{this._vertexSourceCode=P,this._fragmentSourceCode=n,this._prepareEffect(e)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.C||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(P){return this._attributes[P]}getAttributeLocationByName(P){return this._attributeLocationByName[P]}getAttributesCount(){return this._attributes.length}getUniformIndex(P){return this._uniformsNames.indexOf(P)}getUniform(P){return this._uniforms[P]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((P=>{this.executeWhenCompiled(P)}))}executeWhenCompiled(P){this.isReady()?P(this):(this.onCompileObservable.add((e=>{P(e)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(P){(0,m.d)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(e=>{this._processCompilationErrors(e,P)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var P;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(P=this._pipelineContext)||void 0===P?void 0:P._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var P;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(P=this._pipelineContext)||void 0===P?void 0:P._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(P,e,n,H){this._isReady=!1,this._vertexSourceCodeOverride=P,this._fragmentSourceCodeOverride=e,this.onError=(P,e)=>{H&&H(e)},this.onCompiled=()=>{var P,e;const H=this.getEngine().scenes;if(H)for(let n=0;n<H.length;n++)H[n].markAllMaterialsAsDirty(127);null===(P=(e=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===P||P.call(e,n)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(P){if(this._pipelineContext=P,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let e=0;e<this._attributesNames.length;e++){const P=this._attributesNames[e];this._attributeLocationByName[P]=this._attributes[e]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),t.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let P=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this._pipelineContext;this._isReady=!1;try{const n=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),H=n?null:this.defines,S=n?this._vertexSourceCodeOverride:this._vertexSourceCode,p=n?this._fragmentSourceCodeOverride:this._fragmentSourceCode,m=this._engine;this._pipelineContext=(0,k.e)({existingPipelineContext:P?e:null,vertex:S,fragment:p,context:"WEBGL2"===m.shaderPlatformName||"WEBGL1"===m.shaderPlatformName?m._gl:void 0,rebuildRebind:(P,e,n,H)=>this._rebuildProgram(P,e,n,H),defines:H,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:n,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:n=>{e&&!P&&this._engine._deletePipelineContext(e),n&&this._onRenderingStateCompiled(n)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(e)}catch(n){this._processCompilationErrors(n,e)}}_getShaderCodeAndErrorLine(P,e,n){const H=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let S=null;if(e&&P){const p=e.match(H);if(p&&2===p.length){const e=parseInt(p[1]),H=P.split("\n",-1);H.length>=e&&(S=`Offending line [${e}] in ${n?"fragment":"vertex"} code: ${H[e-1]}`)}}return[P,S]}_processCompilationErrors(P){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=P.message;const n=this._attributesNames,H=this._fallbacks;if(S.c.Error("Unable to compile effect:"),S.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),S.c.Error(`Attributes: ${n.join(" ")}`),S.c.Error("Defines:\n"+this.defines),t.LogShaderCodeOnCompilationError){var p,k;let P=null,e=null,n=null;var m;if(null!==(p=this._pipelineContext)&&void 0!==p&&p._getVertexShaderCode()&&([n,P]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),n&&(S.c.Error("Vertex code:"),S.c.Error(n))),null!==(k=this._pipelineContext)&&void 0!==k&&k._getFragmentShaderCode())[n,e]=this._getShaderCodeAndErrorLine(null===(m=this._pipelineContext)||void 0===m?void 0:m._getFragmentShaderCode(),this._compilationError,!0),n&&(S.c.Error("Fragment code:"),S.c.Error(n));P&&S.c.Error(P),e&&S.c.Error(e)}S.c.Error("Error: "+this._compilationError);const C=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};e&&(this._pipelineContext=e,this._isReady=!0,C()),H?(this._pipelineContext=null,H.hasMoreFallbacks?(this._allFallbacksProcessed=!1,S.c.Error("Trying next fallback."),this.defines=H.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,C(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,e||C())}get isSupported(){return""===this._compilationError}_bindTexture(P,e){this._engine._bindTexture(this._samplers[P],e,P)}setTexture(P,e){this._engine.setTexture(this._samplers[P],this._uniforms[P],e,P)}setTextureArray(P,e){const n=P+"Ex";if(-1===this._samplerList.indexOf(n+"0")){const H=this._samplerList.indexOf(P);for(let P=1;P<e.length;P++){const e=n+(P-1).toString();this._samplerList.splice(H+P,0,e)}let S=0;for(const P of this._samplerList)this._samplers[P]=S,S+=1}this._engine.setTextureArray(this._samplers[P],this._uniforms[P],e,P)}bindUniformBuffer(P,e){const n=this._uniformBuffersNames[e];void 0===n||t._BaseCache[n]===P&&this._engine._features.useUBOBindingCache||(t._BaseCache[n]=P,this._engine.bindUniformBufferBase(P,n,e))}bindUniformBlock(P,e){this._engine.bindUniformBlock(this._pipelineContext,P,e)}setInt(P,e){return this._pipelineContext.setInt(P,e),this}setInt2(P,e,n){return this._pipelineContext.setInt2(P,e,n),this}setInt3(P,e,n,H){return this._pipelineContext.setInt3(P,e,n,H),this}setInt4(P,e,n,H,S){return this._pipelineContext.setInt4(P,e,n,H,S),this}setIntArray(P,e){return this._pipelineContext.setIntArray(P,e),this}setIntArray2(P,e){return this._pipelineContext.setIntArray2(P,e),this}setIntArray3(P,e){return this._pipelineContext.setIntArray3(P,e),this}setIntArray4(P,e){return this._pipelineContext.setIntArray4(P,e),this}setUInt(P,e){return this._pipelineContext.setUInt(P,e),this}setUInt2(P,e,n){return this._pipelineContext.setUInt2(P,e,n),this}setUInt3(P,e,n,H){return this._pipelineContext.setUInt3(P,e,n,H),this}setUInt4(P,e,n,H,S){return this._pipelineContext.setUInt4(P,e,n,H,S),this}setUIntArray(P,e){return this._pipelineContext.setUIntArray(P,e),this}setUIntArray2(P,e){return this._pipelineContext.setUIntArray2(P,e),this}setUIntArray3(P,e){return this._pipelineContext.setUIntArray3(P,e),this}setUIntArray4(P,e){return this._pipelineContext.setUIntArray4(P,e),this}setFloatArray(P,e){return this._pipelineContext.setArray(P,e),this}setFloatArray2(P,e){return this._pipelineContext.setArray2(P,e),this}setFloatArray3(P,e){return this._pipelineContext.setArray3(P,e),this}setFloatArray4(P,e){return this._pipelineContext.setArray4(P,e),this}setArray(P,e){return this._pipelineContext.setArray(P,e),this}setArray2(P,e){return this._pipelineContext.setArray2(P,e),this}setArray3(P,e){return this._pipelineContext.setArray3(P,e),this}setArray4(P,e){return this._pipelineContext.setArray4(P,e),this}setMatrices(P,e){return this._pipelineContext.setMatrices(P,e),this}setMatrix(P,e){return this._pipelineContext.setMatrix(P,e),this}setMatrix3x3(P,e){return this._pipelineContext.setMatrix3x3(P,e),this}setMatrix2x2(P,e){return this._pipelineContext.setMatrix2x2(P,e),this}setFloat(P,e){return this._pipelineContext.setFloat(P,e),this}setBool(P,e){return this._pipelineContext.setInt(P,e?1:0),this}setVector2(P,e){return this._pipelineContext.setVector2(P,e),this}setFloat2(P,e,n){return this._pipelineContext.setFloat2(P,e,n),this}setVector3(P,e){return this._pipelineContext.setVector3(P,e),this}setFloat3(P,e,n,H){return this._pipelineContext.setFloat3(P,e,n,H),this}setVector4(P,e){return this._pipelineContext.setVector4(P,e),this}setQuaternion(P,e){return this._pipelineContext.setQuaternion(P,e),this}setFloat4(P,e,n,H,S){return this._pipelineContext.setFloat4(P,e,n,H,S),this}setColor3(P,e){return this._pipelineContext.setColor3(P,e),this}setColor4(P,e,n){return this._pipelineContext.setColor4(P,e,n),this}setDirectColor4(P,e){return this._pipelineContext.setDirectColor4(P,e),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(t.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,k.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(P,e,n){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;e&&(p.d.GetShadersStore(H)[`${P}PixelShader`]=e),n&&(p.d.GetShadersStore(H)[`${P}VertexShader`]=n)}static ResetCache(){t._BaseCache={}}}t.LogShaderCodeOnCompilationError=!0,t.PersistentMode=!1,t.AutomaticallyClearCodeCache=!1,t._UniqueIdSeed=0,t._BaseCache={},t.ShadersStore=p.d.ShadersStore,t.IncludesShadersStore=p.d.IncludesShadersStore},11007:(P,e,n)=>{n.d(e,{d:()=>S});const H={};function S(P){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!H[P])return H[P]=!0,`${P} needs to be imported before as it contains a side-effect required by your code.`}},10983:(P,e,n)=>{function H(){return"undefined"!==typeof window}function S(){return"undefined"!==typeof navigator}function p(){return"undefined"!==typeof document}function k(P){let e="",n=P.firstChild;for(;n;)3===n.nodeType&&(e+=n.textContent),n=n.nextSibling;return e}n.d(e,{d:()=>k,f:()=>p,g:()=>S,h:()=>H})},10988:(P,e,n)=>{n.d(e,{c:()=>H});class H{static _CheckLimit(P,e){let n=H._LogLimitOutputs[P];return n?n.current++:(n={limit:e,current:1},H._LogLimitOutputs[P]=n),n.current<=n.limit}static _GenerateLimitMessage(P){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=H._LogLimitOutputs[P];if(!n||!H.MessageLimitReached)return;const S=this._Levels[e];n.current===n.limit&&H[S.name](H.MessageLimitReached.replace(/%LIMIT%/g,""+n.limit).replace(/%TYPE%/g,S.name??""))}static _AddLogEntry(P){H._LogCache=P+H._LogCache,H.OnNewCacheEntry&&H.OnNewCacheEntry(P)}static _FormatMessage(P){const e=P=>P<10?"0"+P:""+P,n=new Date;return"["+e(n.getHours())+":"+e(n.getMinutes())+":"+e(n.getSeconds())+"]: "+P}static _LogDisabled(P,e){}static _LogEnabled(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const S=Array.isArray(e)?e[0]:e;if(void 0!==n&&!H._CheckLimit(S,n))return;const p=H._FormatMessage(S),k=this._Levels[P],m=Array.isArray(e)?e.slice(1):[];k.logFunc&&k.logFunc("BJS - "+p,...m);const t=`<div style='color:${k.color}'>${p}</div><br>`;H._AddLogEntry(t),H._GenerateLimitMessage(S,P)}static get LogCache(){return H._LogCache}static ClearLogCache(){H._LogCache="",H._LogLimitOutputs={},H.errorsCount=0}static set LogLevels(P){H.Log=H._LogDisabled,H.Warn=H._LogDisabled,H.Error=H._LogDisabled;const e=[H.MessageLogLevel,H.WarningLogLevel,H.ErrorLogLevel];for(const n of e)if((P&n)===n){const P=this._Levels[n];H[P.name]=H._LogEnabled.bind(H,n)}}}H.NoneLogLevel=0,H.MessageLogLevel=1,H.WarningLogLevel=2,H.ErrorLogLevel=4,H.AllLogLevel=7,H.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",H._LogCache="",H._LogLimitOutputs={},H._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],H.errorsCount=0,H.Log=H._LogEnabled.bind(H,H.MessageLogLevel),H.Warn=H._LogEnabled.bind(H,H.WarningLogLevel),H.Error=H._LogEnabled.bind(H,H.ErrorLogLevel)},10976:(P,e,n)=>{n.d(e,{b:()=>k});const H="undefined"!==typeof WeakRef;class S{constructor(P){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;this.initialize(P,e,n,H)}initialize(P){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;return this.mask=P,this.skipNextObservers=e,this.target=n,this.currentTarget=H,this}}class p{constructor(P,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=P,this.mask=e,this.scope=n,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let P=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(P)}}class k{static FromPromise(P,e){const n=new k;return P.then((P=>{n.notifyObservers(P)})).catch((P=>{if(!e)throw P;e.notifyObservers(P)})),n}get observers(){return this._observers}constructor(P){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=e,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new S(0),P&&(this._onObserverAdded=P)}add(P){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!P)return null;const S=new p(P,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);S.unregisterOnNextCall=n,e?this._observers.unshift(S):this._observers.push(S),this._onObserverAdded&&this._onObserverAdded(S),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(S,this._lastNotifiedValue);const k=H?new WeakRef(this):{deref:()=>this};return S._remove=function(){let P=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=k.deref();e&&(P?e.remove(S):e._remove(S))},S}addOnce(P){return this.add(P,void 0,void 0,void 0,!0)}remove(P){if(!P)return!1;P._remove=null;return-1!==this._observers.indexOf(P)&&(this._deferUnregister(P),!0)}removeCallback(P,e){for(let n=0;n<this._observers.length;n++){const H=this._observers[n];if(!H._willBeUnregistered&&(H.callback===P&&(!e||e===H.scope)))return this._deferUnregister(H),!0}return!1}_deferUnregister(P){P._willBeUnregistered||(this._numObserversMarkedAsDeleted++,P.unregisterOnNextCall=!1,P._willBeUnregistered=!0,setTimeout((()=>{this._remove(P)}),0))}_remove(P){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!P)return!1;const n=this._observers.indexOf(P);return-1!==n&&(e&&this._numObserversMarkedAsDeleted--,this._observers.splice(n,1),!0)}makeObserverTopPriority(P){this._remove(P,!1),this._observers.unshift(P)}makeObserverBottomPriority(P){this._remove(P,!1),this._observers.push(P)}notifyObservers(P){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0,S=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=P),!this._observers.length)return!0;const p=this._eventState;p.mask=e,p.target=n,p.currentTarget=H,p.skipNextObservers=!1,p.lastReturnValue=P,p.userInfo=S;for(const k of this._observers)if(!k._willBeUnregistered&&(k.mask&e&&(k.unregisterOnNextCall&&this._deferUnregister(k),k.scope?p.lastReturnValue=k.callback.apply(k.scope,[P,p]):p.lastReturnValue=k.callback(P,p)),p.skipNextObservers))return!1;return!0}notifyObserver(P,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),P._willBeUnregistered)return;const H=this._eventState;H.mask=n,H.skipNextObservers=!1,P.unregisterOnNextCall&&this._deferUnregister(P),P.callback(e,H)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const P=this._observers.pop();P&&(P._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const P=new k;return P._observers=this._observers.slice(0),P}hasSpecificMask(){let P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const e of this._observers)if(e.mask&P||e.mask===P)return!0;return!1}}},11047:(P,e,n)=>{n.d(e,{c:()=>S,d:()=>k});let H=[];class S{static SetImmediate(P){0===H.length&&setTimeout((()=>{const P=H;H=[];for(const e of P)e()}),1),H.push(P)}}function p(P,e,n){try{if(P())return e(),!0}catch(H){return null===n||void 0===n||n(H),!0}return!1}const k=function(P,e,n){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,k=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&p(P,e,n))return null;const m=setInterval((()=>{p(P,e,n)?clearInterval(m):(S-=H,S<0&&(clearInterval(m),null===n||void 0===n||n(new Error("Operation timed out after maximum retries. "+(k||"")),!0)))}),H);return()=>clearInterval(m)}}}]);