"use strict";(self.u4k1rqylno=self.u4k1rqylno||[]).push([[9],{11600:(e,E,H)=>{H.d(E,{c:()=>w,e:()=>Y,k:()=>f,i:()=>l,l:()=>O});class N{constructor(){this.children=[]}isValid(e){return!0}process(e,E,H){let N="";if(this.line){let H=this.line;const C=E.processor;if(C){var u,z,P,M,D,A;C.lineProcessor&&(H=C.lineProcessor(H,E.isFragment,E.processingContext));const N=(null===(u=E.processor)||void 0===u?void 0:u.attributeKeywordName)??"attribute",i=E.isFragment&&null!==(z=E.processor)&&void 0!==z&&z.varyingFragmentKeywordName?null===(P=E.processor)||void 0===P?void 0:P.varyingFragmentKeywordName:!E.isFragment&&null!==(M=E.processor)&&void 0!==M&&M.varyingVertexKeywordName?null===(D=E.processor)||void 0===D?void 0:D.varyingVertexKeywordName:"varying";if(!E.isFragment&&C.attributeProcessor&&this.line.startsWith(N))H=C.attributeProcessor(this.line,e,E.processingContext);else if(C.varyingProcessor&&(null!==(A=C.varyingCheck)&&void 0!==A&&A.call(C,this.line,E.isFragment)||!C.varyingCheck&&this.line.startsWith(i)))H=C.varyingProcessor(this.line,E.isFragment,e,E.processingContext);else if(C.uniformProcessor&&C.uniformRegexp&&C.uniformRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(H=C.uniformProcessor(this.line,E.isFragment,e,E.processingContext));else if(C.uniformBufferProcessor&&C.uniformBufferRegexp&&C.uniformBufferRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(H=C.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0);else if(C.textureProcessor&&C.textureRegexp&&C.textureRegexp.test(this.line))H=C.textureProcessor(this.line,E.isFragment,e,E.processingContext);else if((C.uniformProcessor||C.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!E.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?C.uniformProcessor&&(H=C.uniformProcessor(this.line,E.isFragment,e,E.processingContext)):C.uniformBufferProcessor&&(H=C.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0)}E.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(E.lookForClosingBracketForUniformBuffer=!1,C.endOfUniformBufferProcessor&&(H=C.endOfUniformBufferProcessor(this.line,E.isFragment,E.processingContext)))}N+=H+"\n"}for(const C of this.children)N+=C.process(e,E,H);return this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true",H[this.additionalDefineKey]=e[this.additionalDefineKey]),N}}class u{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){this._lines.length=0;for(const E of e){if(!E||"\r"===E)continue;if("#"===E[0]){this._lines.push(E);continue}const e=E.trim();if(!e)continue;if(e.startsWith("//")){this._lines.push(E);continue}const H=e.indexOf(";");if(-1===H)this._lines.push(e);else if(H===e.length-1)e.length>1&&this._lines.push(e);else{const e=E.split(";");for(let E=0;E<e.length;E++){let H=e[E];H&&(H=H.trim(),H&&this._lines.push(H+(E!==e.length-1?";":"")))}}}}}class z extends N{process(e,E,H){for(let N=0;N<this.children.length;N++){const u=this.children[N];if(u.isValid(e))return u.process(e,E,H)}return""}}class P extends N{isValid(e){return this.testExpression.isTrue(e)}}class M{isTrue(e){return!0}static postfixToInfix(e){const E=[];for(const H of e)if(void 0===M._OperatorPriority[H])E.push(H);else{const e=E[E.length-1],N=E[E.length-2];E.length-=2,E.push(`(${N}${H}${e})`)}return E[E.length-1]}static infixToPostfix(e){const E=M._InfixToPostfixCache.get(e);if(E)return E.accessTime=Date.now(),E.result;if(!e.includes("&&")&&!e.includes("||")&&!e.includes(")")&&!e.includes("("))return[e];const H=[];let N=-1;const u=()=>{C=C.trim(),""!==C&&(H.push(C),C="")},z=e=>{N<M._Stack.length-1&&(M._Stack[++N]=e)},P=()=>M._Stack[N],D=()=>-1===N?"!!INVALID EXPRESSION!!":M._Stack[N--];let A=0,C="";for(;A<e.length;){const E=e.charAt(A),i=A<e.length-1?e.substring(A,2+A):"";if("("===E)C="",z(E);else if(")"===E){for(u();-1!==N&&"("!==P();)H.push(D());D()}else if(M._OperatorPriority[i]>1){for(u();-1!==N&&M._OperatorPriority[P()]>=M._OperatorPriority[i];)H.push(D());z(i),A++}else C+=E;A++}for(u();-1!==N;)"("===P()?D():H.push(D());return M._InfixToPostfixCache.size>=M.InfixToPostfixCacheLimitSize&&M.ClearCache(),M._InfixToPostfixCache.set(e,{result:H,accessTime:Date.now()}),H}static ClearCache(){const e=Array.from(M._InfixToPostfixCache.entries()).sort(((e,E)=>e[1].accessTime-E[1].accessTime));for(let E=0;E<M.InfixToPostfixCacheCleanupSize;E++)M._InfixToPostfixCache.delete(e[E][0])}}M.InfixToPostfixCacheLimitSize=5e4,M.InfixToPostfixCacheCleanupSize=25e3,M._InfixToPostfixCache=new Map,M._OperatorPriority={")":0,"(":1,"||":2,"&&":3},M._Stack=["","","","","","","","","","","","","","","","","","","",""];class D extends M{constructor(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=e,this.not=E}isTrue(e){let E=void 0!==e[this.define];return this.not&&(E=!E),E}}class A extends M{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class C extends M{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class i extends M{constructor(e,E,H){super(),this.define=e,this.operand=E,this.testValue=H}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(e){let E=!1;const H=parseInt(void 0!=e[this.define]?e[this.define]:this.define),N=parseInt(void 0!=e[this.testValue]?e[this.testValue]:this.testValue);if(isNaN(H)||isNaN(N))return!1;switch(this.operand){case">":E=H>N;break;case"<":E=H<N;break;case"<=":E=H<=N;break;case">=":E=H>=N;break;case"==":E=H===N;break;case"!=":E=H!==N}return E}}var V=H(11565),U=H(11602);const j=/defined\s*?\((.+?)\)/g,F=/defined\s*?\[(.+?)\]/g,h=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,S=/__decl__/,X=/light\{X\}.(\w*)/g,a=/\{X\}/g,W=[],r=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function Y(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}function f(e,E,H,N){var u;null!==(u=E.processor)&&void 0!==u&&u.preProcessShaderCode&&(e=E.processor.preProcessShaderCode(e,E.isFragment)),l(e,E,(e=>{E.processCodeAfterIncludes&&(e=E.processCodeAfterIncludes(E.isFragment?"fragment":"vertex",e,E.defines));const u=function(e,E,H){let N=function(e,E){var H;if(null!==(H=E.processor)&&void 0!==H&&H.noPrecision)return e;const N=E.shouldUseHighPrecisionShader;-1===e.indexOf("precision highp float")?e=N?"precision highp float;\n"+e:"precision mediump float;\n"+e:N||(e=e.replace("precision highp float","precision mediump float"));return e}(e,E);if(!E.processor)return N;if(0===E.processor.shaderLanguage&&-1!==N.indexOf("#version 3")&&(N=N.replace("#version 300 es",""),!E.processor.parseGLES3))return N;const u=E.defines,z=K(E,H);E.processor.preProcessor&&(N=E.processor.preProcessor(N,u,z,E.isFragment,E.processingContext));const P={};N=b(N,z,E,P),E.processor.postProcessor&&(N=E.processor.postProcessor(N,u,E.isFragment,E.processingContext,H?{drawBuffersExtensionDisabled:!H.getCaps().drawBuffersExtension}:{},z,P));null!==H&&void 0!==H&&H._features.needShaderCodeInlining&&(N=H.inlineShaderCode(N));return N}(e,E,N);H(u,e)}))}function w(e,E,H){return H.processor&&H.processor.finalizeShaders?H.processor.finalizeShaders(e,E,H.processingContext):{vertexCode:e,fragmentCode:E}}function s(e){const E=/defined\((.+)\)/.exec(e);if(E&&E.length)return new D(E[1].trim(),"!"===e[0]);const H=["==","!=",">=","<=","<",">"];let N="",u=0;for(N of H)if(u=e.indexOf(N),u>-1)break;if(-1===u)return new D(e);const z=e.substring(0,u).trim(),P=e.substring(u+N.length).trim();return new i(z,N,P)}function p(e,E){const H=new P,N=e.substring(0,E);let u=e.substring(E);return u=u.substring(0,(u.indexOf("//")+1||u.length+1)-1).trim(),H.testExpression="#ifdef"===N?new D(u):"#ifndef"===N?new D(u,!0):function(e){e=e.replace(j,"defined[$1]");const E=M.infixToPostfix(e),H=[];for(const u of E)if("||"!==u&&"&&"!==u)H.push(u);else if(H.length>=2){let e=H[H.length-1],E=H[H.length-2];H.length-=2;const N="&&"==u?new C:new A;"string"===typeof e&&(e=e.replace(F,"defined($1)")),"string"===typeof E&&(E=E.replace(F,"defined($1)")),N.leftOperand="string"===typeof E?s(E):E,N.rightOperand="string"===typeof e?s(e):e,H.push(N)}let N=H[H.length-1];return"string"===typeof N&&(N=N.replace(F,"defined($1)")),"string"===typeof N?s(N):N}(u),H}function o(e,E,H,u){let z=e.currentLine;for(;y(e,H,u);){z=e.currentLine;const P=z.substring(0,5).toLowerCase();if("#else"===P){const H=new N;return E.children.push(H),void y(e,H,u)}if("#elif"===P){const e=p(z,5);E.children.push(e),H=e}}}function y(e,E,H){for(;e.canRead;){e.lineIndex++;const u=e.currentLine;if(u.indexOf("#")>=0){const N=r.exec(u);if(N&&N.length){switch(N[0]){case"#ifdef":{const N=new z;E.children.push(N);const P=p(u,6);N.children.push(P),o(e,N,P,H);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const N=new z;E.children.push(N);const P=p(u,7);N.children.push(P),o(e,N,P,H);break}case"#if":{const N=new z,P=p(u,3);E.children.push(N),N.children.push(P),o(e,N,P,H);break}}continue}}const P=new N;if(P.line=u,E.children.push(P),"#"===u[0]&&"d"===u[1]){const e=u.replace(";","").split(" ");P.additionalDefineKey=e[1],3===e.length&&(P.additionalDefineValue=e[2])}}return!1}function b(e,E,H,z){const P=new N,M=new u;return M.lineIndex=-1,M.lines=e.split("\n"),y(M,P,z),P.process(E,H,z)}function K(e,E){var H;const N=e.defines,u={};for(const z of N){const e=z.replace("#define","").replace(";","").trim().split(" ");u[e[0]]=e.length>1?e[1]:""}return 0===(null===(H=e.processor)||void 0===H?void 0:H.shaderLanguage)&&(u.GL_ES="true"),u.__VERSION__=e.version,u[e.platformName]="true",(0,U.h)(u,null===E||void 0===E?void 0:E.isNDCHalfZRange,null===E||void 0===E?void 0:E.IP,null===E||void 0===E?void 0:E.useExactSrgbConversions),u}function l(e,E,H){let N;for(W.length=0;null!==(N=h.exec(e));)W.push(N);let u=String(e),z=[e],P=!1;for(const M of W){let e=M[1];if(-1!==e.indexOf("__decl__")&&(e=e.replace(S,""),E.supportsUniformBuffers&&(e=e.replace("Vertex","Ubo").replace("Fragment","Ubo")),e+="Declaration"),!E.includesShadersStore[e]){const N=E.shadersRepository+"ShadersInclude/"+e+".fx";return void O.loadFile(N,(N=>{E.includesShadersStore[e]=N,l(z.join(""),E,H)}))}{let H=E.includesShadersStore[e];if(M[2]){const e=M[3].split(",");for(let E=0;E<e.length;E+=2){const N=new RegExp(e[E],"g"),u=e[E+1];H=H.replace(N,u)}}if(M[4]){const e=M[5];if(-1!==e.indexOf("..")){const N=e.split(".."),u=parseInt(N[0]);let z=parseInt(N[1]),P=H.slice(0);H="",isNaN(z)&&(z=E.indexParameters[N[1]]);for(let e=u;e<z;e++)E.supportsUniformBuffers||(P=P.replace(X,((e,E)=>E+"{X}"))),H+=P.replace(a,e.toString())+"\n"}else E.supportsUniformBuffers||(H=H.replace(X,((e,E)=>E+"{X}"))),H=H.replace(a,e)}const N=[];for(const e of z){const E=e.split(M[0]);for(let e=0;e<E.length-1;e++)N.push(E[e]),N.push(H);N.push(E[E.length-1])}z=N,P=P||H.indexOf("#include<")>=0||H.indexOf("#include <")>=0}}W.length=0,u=z.join(""),P?l(u.toString(),E,H):H(u)}const O={loadFile:(e,E,H,N,u,z)=>{throw(0,V.b)("FileTools")}}},11602:(e,E,H)=>{H.d(E,{b:()=>u,d:()=>z,h:()=>M,j:()=>P,n:()=>D});var N=H(11565);H(11546);const u={};function z(e,E){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(E?E+"\n":"")+e}function P(e,E,H,z,P,M,D){const A=D||u.loadFile;if(A){return A(e,E,H,z,P,M)}throw(0,N.b)("FileTools")}function M(e,E,H,N){if(e)return E?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,H?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(N?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);{let e="";return E&&(e+="#define IS_NDC_HALF_ZRANGE"),H&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),N&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}function D(e,E){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2],N=arguments.length>3?arguments[3]:void 0;switch(e){case 3:{const e=(ArrayBuffer,new Int8Array(E));return N&&e.set(new Int8Array(N)),e}case 0:{const e=(ArrayBuffer,new Uint8Array(E));return N&&e.set(new Uint8Array(N)),e}case 4:{const e=E instanceof ArrayBuffer?new Int16Array(E):new Int16Array(H?E/2:E);return N&&e.set(new Int16Array(N)),e}case 5:case 8:case 9:case 10:case 2:{const e=E instanceof ArrayBuffer?new Uint16Array(E):new Uint16Array(H?E/2:E);return N&&e.set(new Uint16Array(N)),e}case 6:{const e=E instanceof ArrayBuffer?new Int32Array(E):new Int32Array(H?E/4:E);return N&&e.set(new Int32Array(N)),e}case 7:case 11:case 12:case 13:case 14:case 15:{const e=E instanceof ArrayBuffer?new Uint32Array(E):new Uint32Array(H?E/4:E);return N&&e.set(new Uint32Array(N)),e}case 1:{const e=E instanceof ArrayBuffer?new Float32Array(E):new Float32Array(H?E/4:E);return N&&e.set(new Float32Array(N)),e}}const u=(ArrayBuffer,new Uint8Array(E));return N&&u.set(new Uint8Array(N)),u}},11633:(e,E,H)=>{H.d(E,{d:()=>N});class N{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?N.ShadersRepository:N.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?N.ShadersStore:N.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?N.IncludesShadersStore:N.IncludesShadersStoreWGSL}}N.ShadersRepository="src/Shaders/",N.ShadersStore={},N.IncludesShadersStore={},N.ShadersRepositoryWGSL="src/ShadersWGSL/",N.ShadersStoreWGSL={},N.IncludesShadersStoreWGSL={}},11646:(e,E,H)=>{H.d(E,{c:()=>V,e:()=>a,h:()=>j,l:()=>U,m:()=>F,q:()=>X,t:()=>i,w:()=>A,A:()=>C,B:()=>D,E:()=>M});class N{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.UE._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}setEngine(e){this.UE=e}_fillEffectInformation(e,E,H,N,u,z,P,M){const D=this.UE;if(D.supportsUniformBuffers)for(const C in E)e.bindUniformBlock(C,E[C]);let A;for(this.UE.getUniforms(this,H).forEach(((e,E)=>{N[H[E]]=e})),this._uniforms=N,A=0;A<u.length;A++){null==e.getUniform(u[A])&&(u.splice(A,1),A--)}u.forEach(((e,E)=>{z[e]=E}));for(const C of D.getAttributes(this,P))M.push(C)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(e,E){const H=this._valueCache[e],N=E.updateFlag;return(void 0===H||H!==N)&&(this._valueCache[e]=N,!0)}_cacheFloat2(e,E,H){let N=this._valueCache[e];if(!N||2!==N.length)return N=[E,H],this._valueCache[e]=N,!0;let u=!1;return N[0]!==E&&(N[0]=E,u=!0),N[1]!==H&&(N[1]=H,u=!0),u}_cacheFloat3(e,E,H,N){let u=this._valueCache[e];if(!u||3!==u.length)return u=[E,H,N],this._valueCache[e]=u,!0;let z=!1;return u[0]!==E&&(u[0]=E,z=!0),u[1]!==H&&(u[1]=H,z=!0),u[2]!==N&&(u[2]=N,z=!0),z}_cacheFloat4(e,E,H,N,u){let z=this._valueCache[e];if(!z||4!==z.length)return z=[E,H,N,u],this._valueCache[e]=z,!0;let P=!1;return z[0]!==E&&(z[0]=E,P=!0),z[1]!==H&&(z[1]=H,P=!0),z[2]!==N&&(z[2]=N,P=!0),z[3]!==u&&(z[3]=u,P=!0),P}setInt(e,E){const H=this._valueCache[e];void 0!==H&&H===E||this.UE.setInt(this._uniforms[e],E)&&(this._valueCache[e]=E)}setInt2(e,E,H){this._cacheFloat2(e,E,H)&&(this.UE.setInt2(this._uniforms[e],E,H)||(this._valueCache[e]=null))}setInt3(e,E,H,N){this._cacheFloat3(e,E,H,N)&&(this.UE.setInt3(this._uniforms[e],E,H,N)||(this._valueCache[e]=null))}setInt4(e,E,H,N,u){this._cacheFloat4(e,E,H,N,u)&&(this.UE.setInt4(this._uniforms[e],E,H,N,u)||(this._valueCache[e]=null))}setIntArray(e,E){this._valueCache[e]=null,this.UE.setIntArray(this._uniforms[e],E)}setIntArray2(e,E){this._valueCache[e]=null,this.UE.setIntArray2(this._uniforms[e],E)}setIntArray3(e,E){this._valueCache[e]=null,this.UE.setIntArray3(this._uniforms[e],E)}setIntArray4(e,E){this._valueCache[e]=null,this.UE.setIntArray4(this._uniforms[e],E)}setUInt(e,E){const H=this._valueCache[e];void 0!==H&&H===E||this.UE.setUInt(this._uniforms[e],E)&&(this._valueCache[e]=E)}setUInt2(e,E,H){this._cacheFloat2(e,E,H)&&(this.UE.setUInt2(this._uniforms[e],E,H)||(this._valueCache[e]=null))}setUInt3(e,E,H,N){this._cacheFloat3(e,E,H,N)&&(this.UE.setUInt3(this._uniforms[e],E,H,N)||(this._valueCache[e]=null))}setUInt4(e,E,H,N,u){this._cacheFloat4(e,E,H,N,u)&&(this.UE.setUInt4(this._uniforms[e],E,H,N,u)||(this._valueCache[e]=null))}setUIntArray(e,E){this._valueCache[e]=null,this.UE.setUIntArray(this._uniforms[e],E)}setUIntArray2(e,E){this._valueCache[e]=null,this.UE.setUIntArray2(this._uniforms[e],E)}setUIntArray3(e,E){this._valueCache[e]=null,this.UE.setUIntArray3(this._uniforms[e],E)}setUIntArray4(e,E){this._valueCache[e]=null,this.UE.setUIntArray4(this._uniforms[e],E)}setArray(e,E){this._valueCache[e]=null,this.UE.setArray(this._uniforms[e],E)}setArray2(e,E){this._valueCache[e]=null,this.UE.setArray2(this._uniforms[e],E)}setArray3(e,E){this._valueCache[e]=null,this.UE.setArray3(this._uniforms[e],E)}setArray4(e,E){this._valueCache[e]=null,this.UE.setArray4(this._uniforms[e],E)}setMatrices(e,E){E&&(this._valueCache[e]=null,this.UE.setMatrices(this._uniforms[e],E))}setMatrix(e,E){this._cacheMatrix(e,E)&&(this.UE.setMatrices(this._uniforms[e],E.uM())||(this._valueCache[e]=null))}setMatrix3x3(e,E){this._valueCache[e]=null,this.UE.setMatrix3x3(this._uniforms[e],E)}setMatrix2x2(e,E){this._valueCache[e]=null,this.UE.setMatrix2x2(this._uniforms[e],E)}setFloat(e,E){const H=this._valueCache[e];void 0!==H&&H===E||this.UE.setFloat(this._uniforms[e],E)&&(this._valueCache[e]=E)}setVector2(e,E){this._cacheFloat2(e,E.x,E.y)&&(this.UE.setFloat2(this._uniforms[e],E.x,E.y)||(this._valueCache[e]=null))}setFloat2(e,E,H){this._cacheFloat2(e,E,H)&&(this.UE.setFloat2(this._uniforms[e],E,H)||(this._valueCache[e]=null))}setVector3(e,E){this._cacheFloat3(e,E.x,E.y,E.z)&&(this.UE.setFloat3(this._uniforms[e],E.x,E.y,E.z)||(this._valueCache[e]=null))}setFloat3(e,E,H,N){this._cacheFloat3(e,E,H,N)&&(this.UE.setFloat3(this._uniforms[e],E,H,N)||(this._valueCache[e]=null))}setVector4(e,E){this._cacheFloat4(e,E.x,E.y,E.z,E.w)&&(this.UE.setFloat4(this._uniforms[e],E.x,E.y,E.z,E.w)||(this._valueCache[e]=null))}setQuaternion(e,E){this._cacheFloat4(e,E.x,E.y,E.z,E.w)&&(this.UE.setFloat4(this._uniforms[e],E.x,E.y,E.z,E.w)||(this._valueCache[e]=null))}setFloat4(e,E,H,N,u){this._cacheFloat4(e,E,H,N,u)&&(this.UE.setFloat4(this._uniforms[e],E,H,N,u)||(this._valueCache[e]=null))}setColor3(e,E){this._cacheFloat3(e,E.r,E.g,E.b)&&(this.UE.setFloat3(this._uniforms[e],E.r,E.g,E.b)||(this._valueCache[e]=null))}setColor4(e,E,H){this._cacheFloat4(e,E.r,E.g,E.b,H)&&(this.UE.setFloat4(this._uniforms[e],E.r,E.g,E.b,H)||(this._valueCache[e]=null))}setDirectColor4(e,E){this._cacheFloat4(e,E.r,E.g,E.b,E.a)&&(this.UE.setFloat4(this._uniforms[e],E.r,E.g,E.b,E.a)||(this._valueCache[e]=null))}_getVertexShaderCode(){return this.vertexShader?this.UE._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.UE._getShaderSource(this.fragmentShader):null}}var u=H(11602);const z=new WeakMap,P={_webGLVersion:2,cachedPipelines:{}};function M(e){let E=z.get(e);if(!E){if(!e)return P;E={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,parallelShaderCompile:e.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},z.set(e,E)}return E}function D(e){z.delete(e)}function A(e,E,H,N,u,z){const P=M(N);z||(z=P._createShaderProgramInjection??V);return z(e,S(E,"vertex",N,P._contextWasLost),S(H,"fragment",N,P._contextWasLost),N,u,P.validateShaderPrograms)}function C(e,E,H,N,u){let z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,P=arguments.length>6?arguments[6]:void 0;const D=M(u);P||(P=D._createShaderProgramInjection??V);const A=D._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return P(e,h(E,"vertex",N,A,u,D._contextWasLost),h(H,"fragment",N,A,u,D._contextWasLost),u,z,D.validateShaderPrograms)}function i(e,E){const H=new N,u=M(e);return u.parallelShaderCompile&&!u.disableParallelShaderCompile&&(H.isParallelCompiled=!0),H.context=u._context,H}function V(e,E,H,N){let u=arguments.length>5?arguments[5]:void 0;const z=N.createProgram();if(e.program=z,!z)throw new Error("Unable to create program");return N.attachShader(z,E),N.attachShader(z,H),N.linkProgram(z),e.context=N,e.vertexShader=E,e.fragmentShader=H,e.isParallelCompiled||j(e,N,u),z}function U(e,E,H){const N=e;if(N._isDisposed)return!1;const u=M(E);return!!(u&&u.parallelShaderCompile&&u.parallelShaderCompile.COMPLETION_STATUS_KHR&&N.program&&E.getProgramParameter(N.program,u.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(j(N,E,H),!0)}function j(e,E,H){const N=e.context,u=e.vertexShader,z=e.fragmentShader,P=e.program;if(!N.getProgramParameter(P,N.LINK_STATUS)){if(!E.getShaderParameter(u,E.COMPILE_STATUS)){const H=E.getShaderInfoLog(u);if(H)throw e.vertexCompilationError=H,new Error("VERTEX SHADER "+H)}if(!E.getShaderParameter(z,E.COMPILE_STATUS)){const H=E.getShaderInfoLog(z);if(H)throw e.fragmentCompilationError=H,new Error("FRAGMENT SHADER "+H)}const H=N.getProgramInfoLog(P);if(H)throw e.programLinkError=H,new Error(H)}if(H){N.validateProgram(P);if(!N.getProgramParameter(P,N.VALIDATE_STATUS)){const E=N.getProgramInfoLog(P);if(E)throw e.programValidationError=E,new Error(E)}}N.deleteShader(u),N.deleteShader(z),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function F(e,E,H,N,u,z,P,D,i){let V=arguments.length>10?arguments[10]:void 0,U=arguments.length>11?arguments[11]:void 0,j=arguments.length>12?arguments[12]:void 0;const F=M(e.context);U||(U=F.createRawShaderProgramInjection??A),j||(j=F.createShaderProgramInjection??C);const h=e;h.program=N?U(h,E,H,h.context,i):j(h,E,H,D,h.context,i),h.program.__SPECTOR_rebuildProgram=P,V()}function h(e,E,H,N,z,P){return S((0,u.d)(e,H,N),E,z,P)}function S(e,E,H,N){const u=H.createShader("vertex"===E?H.VERTEX_SHADER:H.FRAGMENT_SHADER);if(!u){let e=H.NO_ERROR,u=H.NO_ERROR;for(;(u=H.getError())!==H.NO_ERROR;)e=u;throw new Error(`Something went wrong while creating a gl ${E} shader object. gl error=${e}, gl isContextLost=${H.isContextLost()}, _contextWasLost=${N}`)}return H.shaderSource(u,e),H.compileShader(u),u}function X(e,E){E.useProgram(e)}function a(e,E){const H=e;if(!H.isParallelCompiled)return void E(e);const N=H.onCompiled;H.onCompiled=()=>{null===N||void 0===N||N(),E(e)}}},11641:(e,E,H)=>{H.d(E,{b:()=>i,c:()=>U,f:()=>A,j:()=>C});var N=H(11546),u=H(11646),z=H(11633),P=H(11548),M=H(11600),D=H(11602);function A(e,E){return(0,u.E)(E).cachedPipelines[e]}function C(e){const E=e._name,H=e.context;if(E&&H){const e=(0,u.E)(H),N=e.cachedPipelines[E];null===N||void 0===N||N.dispose(),delete e.cachedPipelines[E]}}function i(e,E,H,u,z,P,D){let A,C;const i=(0,N.i)()?null===P||void 0===P?void 0:P.getHostDocument():null;A="string"===typeof E?E:E.vertexSource?"source:"+E.vertexSource:E.vertexElement?(null===i||void 0===i?void 0:i.getElementById(E.vertexElement))||E.vertexElement:E.vertex||E,C="string"===typeof E?E:E.fragmentSource?"source:"+E.fragmentSource:E.fragmentElement?(null===i||void 0===i?void 0:i.getElementById(E.fragmentElement))||E.fragmentElement:E.fragment||E;const U=[void 0,void 0],j=()=>{if(U[0]&&U[1]){e.isFragment=!0;const[N,A]=U;(0,M.k)(A,e,((P,A)=>{D&&(D._fragmentSourceCodeBeforeMigration=A),H&&(P=H("fragment",P));const C=(0,M.c)(N,P,e);e=null;const i=function(e,E,H,N){if(H){return{vertexSourceCode:(1===N?"//":"")+"#define SHADER_NAME vertex:"+(H.vertexElement||H.vertex||H.spectorName||H)+"\n"+e,fragmentSourceCode:(1===N?"//":"")+"#define SHADER_NAME fragment:"+(H.fragmentElement||H.fragment||H.spectorName||H)+"\n"+E}}return{vertexSourceCode:e,fragmentSourceCode:E}}(C.vertexCode,C.fragmentCode,E,z);null===u||void 0===u||u(i.vertexSourceCode,i.fragmentSourceCode)}),P)}};V(A,"Vertex","",(E=>{(0,M.e)(e),(0,M.k)(E,e,((e,N)=>{D&&(D._rawVertexSourceCode=E,D._vertexSourceCodeBeforeMigration=N),H&&(e=H("vertex",e)),U[0]=e,j()}),P)}),z),V(C,"Fragment","Pixel",(e=>{D&&(D._rawFragmentSourceCode=e),U[1]=e,j()}),z)}function V(e,E,H,u,P,M){if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement){return void u((0,N.c)(e))}if("source:"===e.substring(0,7))return void u(e.substring(7));if("base64:"===e.substring(0,7)){return void u(window.atob(e.substring(7)))}const A=z.d.GetShadersStore(P);if(A[e+E+"Shader"])return void u(A[e+E+"Shader"]);if(H&&A[e+H+"Shader"])return void u(A[e+H+"Shader"]);let C;if(C="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:z.d.GetShadersRepository(P)+e,!(M=M||D.j))throw new Error("loadFileInjection is not defined");M(C+"."+E.toLowerCase()+".fx",u)}const U=(e,E,H,N)=>{try{const z=e.context?(0,u.E)(e.context):null;z&&(z.disableParallelShaderCompile=e.disableParallelCompilation);const P=e.existingPipelineContext||E(e.shaderProcessingContext);return P._name=e.name,e.name&&z&&(z.cachedPipelines[e.name]=P),H(P,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,"",(()=>{N(P,(()=>{var E;null===(E=e.onRenderingStateCompiled)||void 0===E||E.call(e,P)}))})),P}catch(z){throw P.d.Error("Error compiling effect"),z}}},11627:(e,E,H)=>{H.r(E),H.d(E,{Effect:()=>D});var N=H(11541),u=H(11548),z=H(11633),P=H(11641),M=H(11611);class D{static get ShadersRepository(){return z.d.ShadersRepository}static set ShadersRepository(e){z.d.ShadersRepository=e}get A(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new N.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(e,E,H){let u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,z=arguments.length>4?arguments[4]:void 0,M=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,C=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,i=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,V=arguments.length>9?arguments[9]:void 0,U=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",j=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,F=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new N.d,this.onErrorObservable=new N.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=e,this._key=U;const h=this._key.replace(/\r/g,"").replace(/\n/g,"|");let S;if(E.attributes){const e=E;if(this._engine=H,this._attributesNames=e.attributes,this._uniformsNames=e.uniformsNames.concat(e.samplers),this._samplerList=e.samplers.slice(),this.defines=e.defines,this.onError=e.onError,this.onCompiled=e.onCompiled,this._fallbacks=e.fallbacks,this._indexParameters=e.indexParameters,this._transformFeedbackVaryings=e.transformFeedbackVaryings||null,this._multiTarget=!!e.multiTarget,this._shaderLanguage=e.shaderLanguage??0,this._disableParallelShaderCompilation=!!e.disableParallelShaderCompilation,e.uniformBuffersNames){this._uniformBuffersNamesList=e.uniformBuffersNames.slice();for(let E=0;E<e.uniformBuffersNames.length;E++)this._uniformBuffersNames[e.uniformBuffersNames[E]]=E}this._processFinalCode=e.processFinalCode??null,this._processCodeAfterIncludes=e.processCodeAfterIncludes??void 0,F=e.extraInitializationsAsync,S=e.existingPipelineContext}else this._engine=z,this.defines=null==M?"":M,this._uniformsNames=H.concat(u),this._samplerList=u?u.slice():[],this._attributesNames=E,this._uniformBuffersNamesList=[],this._shaderLanguage=j,this.onError=i,this.onCompiled=C,this._indexParameters=V,this._fallbacks=A;"WEBGL2"===this._engine.shaderPlatformName&&(S=(0,P.f)(h,this._engine._gl)??S),this._attributeLocationByName={},this.uniqueId=D._UniqueIdSeed++,S?(this._pipelineContext=S,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,F),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.A||this.dispose(!0)}))}async _processShaderCodeAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,N=arguments.length>3?arguments[3]:void 0;N&&await N(),this._processingContext=H||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const u={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:e??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:z.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:z.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,IP:this._engine.IP,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,P.b)(u,this.name,this._processFinalCode,((e,H)=>{this._vertexSourceCode=e,this._fragmentSourceCode=H,this._prepareEffect(E)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.A||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((e=>{this.executeWhenCompiled(e)}))}executeWhenCompiled(e){this.isReady()?e(this):(this.onCompileObservable.add((E=>{e(E)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(e){(0,M.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(E=>{this._processCompilationErrors(E,e)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,IP:this._engine.IP,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(e,E,H,N){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=E,this.onError=(e,E)=>{N&&N(E)},this.onCompiled=()=>{var e,E;const N=this.getEngine().scenes;if(N)for(let H=0;H<N.length;H++)N[H].markAllMaterialsAsDirty(127);null===(e=(E=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===e||e.call(E,H)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let E=0;E<this._attributesNames.length;E++){const e=this._attributesNames[E];this._attributeLocationByName[e]=this._attributes[E]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),D.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=this._pipelineContext;this._isReady=!1;try{const H=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),N=H?null:this.defines,u=H?this._vertexSourceCodeOverride:this._vertexSourceCode,z=H?this._fragmentSourceCodeOverride:this._fragmentSourceCode,M=this._engine;this._pipelineContext=(0,P.c)({existingPipelineContext:e?E:null,vertex:u,fragment:z,context:"WEBGL2"===M.shaderPlatformName||"WEBGL1"===M.shaderPlatformName?M._gl:void 0,rebuildRebind:(e,E,H,N)=>this._rebuildProgram(e,E,H,N),defines:N,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:H,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:H=>{E&&!e&&this._engine._deletePipelineContext(E),H&&this._onRenderingStateCompiled(H)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(E)}catch(H){this._processCompilationErrors(H,E)}}_getShaderCodeAndErrorLine(e,E,H){const N=H?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let u=null;if(E&&e){const z=E.match(N);if(z&&2===z.length){const E=parseInt(z[1]),N=e.split("\n",-1);N.length>=E&&(u=`Offending line [${E}] in ${H?"fragment":"vertex"} code: ${N[E-1]}`)}}return[e,u]}_processCompilationErrors(e){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=e.message;const H=this._attributesNames,N=this._fallbacks;if(u.d.Error("Unable to compile effect:"),u.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),u.d.Error(`Attributes: ${H.join(" ")}`),u.d.Error("Defines:\n"+this.defines),D.LogShaderCodeOnCompilationError){var z,P;let e=null,E=null,H=null;var M;if(null!==(z=this._pipelineContext)&&void 0!==z&&z._getVertexShaderCode()&&([H,e]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),H&&(u.d.Error("Vertex code:"),u.d.Error(H))),null!==(P=this._pipelineContext)&&void 0!==P&&P._getFragmentShaderCode())[H,E]=this._getShaderCodeAndErrorLine(null===(M=this._pipelineContext)||void 0===M?void 0:M._getFragmentShaderCode(),this._compilationError,!0),H&&(u.d.Error("Fragment code:"),u.d.Error(H));e&&u.d.Error(e),E&&u.d.Error(E)}u.d.Error("Error: "+this._compilationError);const A=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};E&&(this._pipelineContext=E,this._isReady=!0,A()),N?(this._pipelineContext=null,N.hasMoreFallbacks?(this._allFallbacksProcessed=!1,u.d.Error("Trying next fallback."),this.defines=N.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,A(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,E||A())}get isSupported(){return""===this._compilationError}_bindTexture(e,E){this._engine._bindTexture(this._samplers[e],E,e)}setTexture(e,E){this._engine.setTexture(this._samplers[e],this._uniforms[e],E,e)}setTextureArray(e,E){const H=e+"Ex";if(-1===this._samplerList.indexOf(H+"0")){const N=this._samplerList.indexOf(e);for(let e=1;e<E.length;e++){const E=H+(e-1).toString();this._samplerList.splice(N+e,0,E)}let u=0;for(const e of this._samplerList)this._samplers[e]=u,u+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],E,e)}bindUniformBuffer(e,E){const H=this._uniformBuffersNames[E];void 0===H||D._BaseCache[H]===e&&this._engine._features.useUBOBindingCache||(D._BaseCache[H]=e,this._engine.bindUniformBufferBase(e,H,E))}bindUniformBlock(e,E){this._engine.bindUniformBlock(this._pipelineContext,e,E)}setInt(e,E){return this._pipelineContext.setInt(e,E),this}setInt2(e,E,H){return this._pipelineContext.setInt2(e,E,H),this}setInt3(e,E,H,N){return this._pipelineContext.setInt3(e,E,H,N),this}setInt4(e,E,H,N,u){return this._pipelineContext.setInt4(e,E,H,N,u),this}setIntArray(e,E){return this._pipelineContext.setIntArray(e,E),this}setIntArray2(e,E){return this._pipelineContext.setIntArray2(e,E),this}setIntArray3(e,E){return this._pipelineContext.setIntArray3(e,E),this}setIntArray4(e,E){return this._pipelineContext.setIntArray4(e,E),this}setUInt(e,E){return this._pipelineContext.setUInt(e,E),this}setUInt2(e,E,H){return this._pipelineContext.setUInt2(e,E,H),this}setUInt3(e,E,H,N){return this._pipelineContext.setUInt3(e,E,H,N),this}setUInt4(e,E,H,N,u){return this._pipelineContext.setUInt4(e,E,H,N,u),this}setUIntArray(e,E){return this._pipelineContext.setUIntArray(e,E),this}setUIntArray2(e,E){return this._pipelineContext.setUIntArray2(e,E),this}setUIntArray3(e,E){return this._pipelineContext.setUIntArray3(e,E),this}setUIntArray4(e,E){return this._pipelineContext.setUIntArray4(e,E),this}setFloatArray(e,E){return this._pipelineContext.setArray(e,E),this}setFloatArray2(e,E){return this._pipelineContext.setArray2(e,E),this}setFloatArray3(e,E){return this._pipelineContext.setArray3(e,E),this}setFloatArray4(e,E){return this._pipelineContext.setArray4(e,E),this}setArray(e,E){return this._pipelineContext.setArray(e,E),this}setArray2(e,E){return this._pipelineContext.setArray2(e,E),this}setArray3(e,E){return this._pipelineContext.setArray3(e,E),this}setArray4(e,E){return this._pipelineContext.setArray4(e,E),this}setMatrices(e,E){return this._pipelineContext.setMatrices(e,E),this}setMatrix(e,E){return this._pipelineContext.setMatrix(e,E),this}setMatrix3x3(e,E){return this._pipelineContext.setMatrix3x3(e,E),this}setMatrix2x2(e,E){return this._pipelineContext.setMatrix2x2(e,E),this}setFloat(e,E){return this._pipelineContext.setFloat(e,E),this}setBool(e,E){return this._pipelineContext.setInt(e,E?1:0),this}setVector2(e,E){return this._pipelineContext.setVector2(e,E),this}setFloat2(e,E,H){return this._pipelineContext.setFloat2(e,E,H),this}setVector3(e,E){return this._pipelineContext.setVector3(e,E),this}setFloat3(e,E,H,N){return this._pipelineContext.setFloat3(e,E,H,N),this}setVector4(e,E){return this._pipelineContext.setVector4(e,E),this}setQuaternion(e,E){return this._pipelineContext.setQuaternion(e,E),this}setFloat4(e,E,H,N,u){return this._pipelineContext.setFloat4(e,E,H,N,u),this}setColor3(e,E){return this._pipelineContext.setColor3(e,E),this}setColor4(e,E,H){return this._pipelineContext.setColor4(e,E,H),this}setDirectColor4(e,E){return this._pipelineContext.setDirectColor4(e,E),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(D.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,P.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(e,E,H){let N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;E&&(z.d.GetShadersStore(N)[`${e}PixelShader`]=E),H&&(z.d.GetShadersStore(N)[`${e}VertexShader`]=H)}static ResetCache(){D._BaseCache={}}}D.LogShaderCodeOnCompilationError=!0,D.PersistentMode=!1,D.AutomaticallyClearCodeCache=!1,D._UniqueIdSeed=0,D._BaseCache={},D.ShadersStore=z.d.ShadersStore,D.IncludesShadersStore=z.d.IncludesShadersStore},11565:(e,E,H)=>{H.d(E,{b:()=>u});const N={};function u(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!N[e])return N[e]=!0,`${e} needs to be imported before as it contains a side-effect required by your code.`}},11546:(e,E,H)=>{function N(){return"undefined"!==typeof window}function u(){return"undefined"!==typeof navigator}function z(){return"undefined"!==typeof document}function P(e){let E="",H=e.firstChild;for(;H;)3===H.nodeType&&(E+=H.textContent),H=H.nextSibling;return E}H.d(E,{c:()=>P,d:()=>z,e:()=>u,i:()=>N})},11548:(e,E,H)=>{H.d(E,{d:()=>N});class N{static _CheckLimit(e,E){let H=N._LogLimitOutputs[e];return H?H.current++:(H={limit:E,current:1},N._LogLimitOutputs[e]=H),H.current<=H.limit}static _GenerateLimitMessage(e){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const H=N._LogLimitOutputs[e];if(!H||!N.MessageLimitReached)return;const u=this._Levels[E];H.current===H.limit&&N[u.name](N.MessageLimitReached.replace(/%LIMIT%/g,""+H.limit).replace(/%TYPE%/g,u.name??""))}static _AddLogEntry(e){N._LogCache=e+N._LogCache,N.OnNewCacheEntry&&N.OnNewCacheEntry(e)}static _FormatMessage(e){const E=e=>e<10?"0"+e:""+e,H=new Date;return"["+E(H.getHours())+":"+E(H.getMinutes())+":"+E(H.getSeconds())+"]: "+e}static _LogDisabled(e,E){}static _LogEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,E=arguments.length>1?arguments[1]:void 0,H=arguments.length>2?arguments[2]:void 0;const u=Array.isArray(E)?E[0]:E;if(void 0!==H&&!N._CheckLimit(u,H))return;const z=N._FormatMessage(u),P=this._Levels[e],M=Array.isArray(E)?E.slice(1):[];P.logFunc&&P.logFunc("BJS - "+z,...M);const D=`<div style='color:${P.color}'>${z}</div><br>`;N._AddLogEntry(D),N._GenerateLimitMessage(u,e)}static get LogCache(){return N._LogCache}static ClearLogCache(){N._LogCache="",N._LogLimitOutputs={},N.errorsCount=0}static set LogLevels(e){N.Log=N._LogDisabled,N.Warn=N._LogDisabled,N.Error=N._LogDisabled;const E=[N.MessageLogLevel,N.WarningLogLevel,N.ErrorLogLevel];for(const H of E)if((e&H)===H){const e=this._Levels[H];N[e.name]=N._LogEnabled.bind(N,H)}}}N.NoneLogLevel=0,N.MessageLogLevel=1,N.WarningLogLevel=2,N.ErrorLogLevel=4,N.AllLogLevel=7,N.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",N._LogCache="",N._LogLimitOutputs={},N._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],N.errorsCount=0,N.Log=N._LogEnabled.bind(N,N.MessageLogLevel),N.Warn=N._LogEnabled.bind(N,N.WarningLogLevel),N.Error=N._LogEnabled.bind(N,N.ErrorLogLevel)},11541:(e,E,H)=>{H.d(E,{d:()=>P});const N="undefined"!==typeof WeakRef;class u{constructor(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,N=arguments.length>3?arguments[3]:void 0;this.initialize(e,E,H,N)}initialize(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=arguments.length>2?arguments[2]:void 0,N=arguments.length>3?arguments[3]:void 0;return this.mask=e,this.skipNextObservers=E,this.target=H,this.currentTarget=N,this}}class z{constructor(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=e,this.mask=E,this.scope=H,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(e)}}class P{static FromPromise(e,E){const H=new P;return e.then((e=>{H.notifyObservers(e)})).catch((e=>{if(!E)throw e;E.notifyObservers(e)})),H}get observers(){return this._observers}constructor(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=E,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new u(0),e&&(this._onObserverAdded=e)}add(e){let E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;const u=new z(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);u.unregisterOnNextCall=H,E?this._observers.unshift(u):this._observers.push(u),this._onObserverAdded&&this._onObserverAdded(u),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(u,this._lastNotifiedValue);const P=N?new WeakRef(this):{deref:()=>this};return u._remove=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=P.deref();E&&(e?E.remove(u):E._remove(u))},u}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){if(!e)return!1;e._remove=null;return-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)}removeCallback(e,E){for(let H=0;H<this._observers.length;H++){const N=this._observers[H];if(!N._willBeUnregistered&&(N.callback===e&&(!E||E===N.scope)))return this._deferUnregister(N),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0))}_remove(e){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;const H=this._observers.indexOf(e);return-1!==H&&(E&&this._numObserversMarkedAsDeleted--,this._observers.splice(H,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,H=arguments.length>2?arguments[2]:void 0,N=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;const z=this._eventState;z.mask=E,z.target=H,z.currentTarget=N,z.skipNextObservers=!1,z.lastReturnValue=e,z.userInfo=u;for(const P of this._observers)if(!P._willBeUnregistered&&(P.mask&E&&(P.unregisterOnNextCall&&this._deferUnregister(P),P.scope?z.lastReturnValue=P.callback.apply(P.scope,[e,z]):z.lastReturnValue=P.callback(e,z)),z.skipNextObservers))return!1;return!0}notifyObserver(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=E),e._willBeUnregistered)return;const N=this._eventState;N.mask=H,N.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(E,N)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const e=new P;return e._observers=this._observers.slice(0),e}hasSpecificMask(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const E of this._observers)if(E.mask&e||E.mask===e)return!0;return!1}}},11611:(e,E,H)=>{H.d(E,{e:()=>u,f:()=>P});let N=[];class u{static SetImmediate(e){0===N.length&&setTimeout((()=>{const e=N;N=[];for(const E of e)E()}),1),N.push(e)}}function z(e,E,H){try{if(e())return E(),!0}catch(N){return null===H||void 0===H||H(N),!0}return!1}const P=function(e,E,H){let N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,P=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&z(e,E,H))return null;const M=setInterval((()=>{z(e,E,H)?clearInterval(M):(u-=N,u<0&&(clearInterval(M),null===H||void 0===H||H(new Error("Operation timed out after maximum retries. "+(P||"")),!0)))}),N);return()=>clearInterval(M)}}}]);