"use strict";(self.uw9p3pwwsje=self.uw9p3pwwsje||[]).push([[9],{12709:(D,h,o)=>{o.d(h,{d:()=>N,g:()=>i,o:()=>G,k:()=>e,r:()=>p});class H{constructor(){this.children=[]}isValid(D){return!0}process(D,h,o){let H="";if(this.line){let o=this.line;const k=h.processor;if(k){var g,j,M,R,t,S;k.lineProcessor&&(o=k.lineProcessor(o,h.isFragment,h.processingContext));const H=(null===(g=h.processor)||void 0===g?void 0:g.attributeKeywordName)??"attribute",K=h.isFragment&&null!==(j=h.processor)&&void 0!==j&&j.varyingFragmentKeywordName?null===(M=h.processor)||void 0===M?void 0:M.varyingFragmentKeywordName:!h.isFragment&&null!==(R=h.processor)&&void 0!==R&&R.varyingVertexKeywordName?null===(t=h.processor)||void 0===t?void 0:t.varyingVertexKeywordName:"varying";if(!h.isFragment&&k.attributeProcessor&&this.line.startsWith(H))o=k.attributeProcessor(this.line,D,h.processingContext);else if(k.varyingProcessor&&(null!==(S=k.varyingCheck)&&void 0!==S&&S.call(k,this.line,h.isFragment)||!k.varyingCheck&&this.line.startsWith(K)))o=k.varyingProcessor(this.line,h.isFragment,D,h.processingContext);else if(k.uniformProcessor&&k.uniformRegexp&&k.uniformRegexp.test(this.line))h.lookForClosingBracketForUniformBuffer||(o=k.uniformProcessor(this.line,h.isFragment,D,h.processingContext));else if(k.uniformBufferProcessor&&k.uniformBufferRegexp&&k.uniformBufferRegexp.test(this.line))h.lookForClosingBracketForUniformBuffer||(o=k.uniformBufferProcessor(this.line,h.isFragment,h.processingContext),h.lookForClosingBracketForUniformBuffer=!0);else if(k.textureProcessor&&k.textureRegexp&&k.textureRegexp.test(this.line))o=k.textureProcessor(this.line,h.isFragment,D,h.processingContext);else if((k.uniformProcessor||k.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!h.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?k.uniformProcessor&&(o=k.uniformProcessor(this.line,h.isFragment,D,h.processingContext)):k.uniformBufferProcessor&&(o=k.uniformBufferProcessor(this.line,h.isFragment,h.processingContext),h.lookForClosingBracketForUniformBuffer=!0)}h.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(h.lookForClosingBracketForUniformBuffer=!1,k.endOfUniformBufferProcessor&&(o=k.endOfUniformBufferProcessor(this.line,h.isFragment,h.processingContext)))}H+=o+"\n"}for(const k of this.children)H+=k.process(D,h,o);return this.additionalDefineKey&&(D[this.additionalDefineKey]=this.additionalDefineValue||"true",o[this.additionalDefineKey]=D[this.additionalDefineKey]),H}}class g{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(D){this._lines.length=0;for(const h of D){if(!h||"\r"===h)continue;if("#"===h[0]){this._lines.push(h);continue}const D=h.trim();if(!D)continue;if(D.startsWith("//")){this._lines.push(h);continue}const o=D.indexOf(";");if(-1===o)this._lines.push(D);else if(o===D.length-1)D.length>1&&this._lines.push(D);else{const D=h.split(";");for(let h=0;h<D.length;h++){let o=D[h];o&&(o=o.trim(),o&&this._lines.push(o+(h!==D.length-1?";":"")))}}}}}class j extends H{process(D,h,o){for(let H=0;H<this.children.length;H++){const g=this.children[H];if(g.isValid(D))return g.process(D,h,o)}return""}}class M extends H{isValid(D){return this.testExpression.isTrue(D)}}class R{isTrue(D){return!0}static postfixToInfix(D){const h=[];for(const o of D)if(void 0===R._OperatorPriority[o])h.push(o);else{const D=h[h.length-1],H=h[h.length-2];h.length-=2,h.push(`(${H}${o}${D})`)}return h[h.length-1]}static infixToPostfix(D){const h=R._InfixToPostfixCache.get(D);if(h)return h.accessTime=Date.now(),h.result;if(!D.includes("&&")&&!D.includes("||")&&!D.includes(")")&&!D.includes("("))return[D];const o=[];let H=-1;const g=()=>{k=k.trim(),""!==k&&(o.push(k),k="")},j=D=>{H<R._Stack.length-1&&(R._Stack[++H]=D)},M=()=>R._Stack[H],t=()=>-1===H?"!!INVALID EXPRESSION!!":R._Stack[H--];let S=0,k="";for(;S<D.length;){const h=D.charAt(S),K=S<D.length-1?D.substring(S,2+S):"";if("("===h)k="",j(h);else if(")"===h){for(g();-1!==H&&"("!==M();)o.push(t());t()}else if(R._OperatorPriority[K]>1){for(g();-1!==H&&R._OperatorPriority[M()]>=R._OperatorPriority[K];)o.push(t());j(K),S++}else k+=h;S++}for(g();-1!==H;)"("===M()?t():o.push(t());return R._InfixToPostfixCache.size>=R.InfixToPostfixCacheLimitSize&&R.ClearCache(),R._InfixToPostfixCache.set(D,{result:o,accessTime:Date.now()}),o}static ClearCache(){const D=Array.from(R._InfixToPostfixCache.entries()).sort(((D,h)=>D[1].accessTime-h[1].accessTime));for(let h=0;h<R.InfixToPostfixCacheCleanupSize;h++)R._InfixToPostfixCache.delete(D[h][0])}}R.InfixToPostfixCacheLimitSize=5e4,R.InfixToPostfixCacheCleanupSize=25e3,R._InfixToPostfixCache=new Map,R._OperatorPriority={")":0,"(":1,"||":2,"&&":3},R._Stack=["","","","","","","","","","","","","","","","","","","",""];class t extends R{constructor(D){let h=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=D,this.not=h}isTrue(D){let h=void 0!==D[this.define];return this.not&&(h=!h),h}}class S extends R{isTrue(D){return this.leftOperand.isTrue(D)||this.rightOperand.isTrue(D)}}class k extends R{isTrue(D){return this.leftOperand.isTrue(D)&&this.rightOperand.isTrue(D)}}class K extends R{constructor(D,h,o){super(),this.define=D,this.operand=h,this.testValue=o}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(D){let h=!1;const o=parseInt(void 0!=D[this.define]?D[this.define]:this.define),H=parseInt(void 0!=D[this.testValue]?D[this.testValue]:this.testValue);if(isNaN(o)||isNaN(H))return!1;switch(this.operand){case">":h=o>H;break;case"<":h=o<H;break;case"<=":h=o<=H;break;case">=":h=o>=H;break;case"==":h=o===H;break;case"!=":h=o!==H}return h}}var Q=o(12672),v=o(12715);const r=/defined\s*?\((.+?)\)/g,B=/defined\s*?\[(.+?)\]/g,s=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,U=/__decl__/,q=/light\{X\}.(\w*)/g,c=/\{X\}/g,y=[],b=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function i(D){D.processor&&D.processor.initializeShaders&&D.processor.initializeShaders(D.processingContext)}function G(D,h,o,H){var g;null!==(g=h.processor)&&void 0!==g&&g.preProcessShaderCode&&(D=h.processor.preProcessShaderCode(D,h.isFragment)),e(D,h,(D=>{h.processCodeAfterIncludes&&(D=h.processCodeAfterIncludes(h.isFragment?"fragment":"vertex",D,h.defines));const g=function(D,h,o){let H=function(D,h){var o;if(null!==(o=h.processor)&&void 0!==o&&o.noPrecision)return D;const H=h.shouldUseHighPrecisionShader;-1===D.indexOf("precision highp float")?D=H?"precision highp float;\n"+D:"precision mediump float;\n"+D:H||(D=D.replace("precision highp float","precision mediump float"));return D}(D,h);if(!h.processor)return H;if(0===h.processor.shaderLanguage&&-1!==H.indexOf("#version 3")&&(H=H.replace("#version 300 es",""),!h.processor.parseGLES3))return H;const g=h.defines,j=Z(h,o);h.processor.preProcessor&&(H=h.processor.preProcessor(H,g,j,h.isFragment,h.processingContext));const M={};H=T(H,j,h,M),h.processor.postProcessor&&(H=h.processor.postProcessor(H,g,h.isFragment,h.processingContext,o?{drawBuffersExtensionDisabled:!o.getCaps().drawBuffersExtension}:{},j,M));null!==o&&void 0!==o&&o._features.needShaderCodeInlining&&(H=o.inlineShaderCode(H));return H}(D,h,H);o(g,D)}))}function N(D,h,o){return o.processor&&o.processor.finalizeShaders?o.processor.finalizeShaders(D,h,o.processingContext):{vertexCode:D,fragmentCode:h}}function J(D){const h=/defined\((.+)\)/.exec(D);if(h&&h.length)return new t(h[1].trim(),"!"===D[0]);const o=["==","!=",">=","<=","<",">"];let H="",g=0;for(H of o)if(g=D.indexOf(H),g>-1)break;if(-1===g)return new t(D);const j=D.substring(0,g).trim(),M=D.substring(g+H.length).trim();return new K(j,H,M)}function O(D,h){const o=new M,H=D.substring(0,h);let g=D.substring(h);return g=g.substring(0,(g.indexOf("//")+1||g.length+1)-1).trim(),o.testExpression="#ifdef"===H?new t(g):"#ifndef"===H?new t(g,!0):function(D){D=D.replace(r,"defined[$1]");const h=R.infixToPostfix(D),o=[];for(const g of h)if("||"!==g&&"&&"!==g)o.push(g);else if(o.length>=2){let D=o[o.length-1],h=o[o.length-2];o.length-=2;const H="&&"==g?new k:new S;"string"===typeof D&&(D=D.replace(B,"defined($1)")),"string"===typeof h&&(h=h.replace(B,"defined($1)")),H.leftOperand="string"===typeof h?J(h):h,H.rightOperand="string"===typeof D?J(D):D,o.push(H)}let H=o[o.length-1];return"string"===typeof H&&(H=H.replace(B,"defined($1)")),"string"===typeof H?J(H):H}(g),o}function E(D,h,o,g){let j=D.currentLine;for(;L(D,o,g);){j=D.currentLine;const M=j.substring(0,5).toLowerCase();if("#else"===M){const o=new H;return h.children.push(o),void L(D,o,g)}if("#elif"===M){const D=O(j,5);h.children.push(D),o=D}}}function L(D,h,o){for(;D.canRead;){D.lineIndex++;const g=D.currentLine;if(g.indexOf("#")>=0){const H=b.exec(g);if(H&&H.length){switch(H[0]){case"#ifdef":{const H=new j;h.children.push(H);const M=O(g,6);H.children.push(M),E(D,H,M,o);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const H=new j;h.children.push(H);const M=O(g,7);H.children.push(M),E(D,H,M,o);break}case"#if":{const H=new j,M=O(g,3);h.children.push(H),H.children.push(M),E(D,H,M,o);break}}continue}}const M=new H;if(M.line=g,h.children.push(M),"#"===g[0]&&"d"===g[1]){const D=g.replace(";","").split(" ");M.additionalDefineKey=D[1],3===D.length&&(M.additionalDefineValue=D[2])}}return!1}function T(D,h,o,j){const M=new H,R=new g;return R.lineIndex=-1,R.lines=D.split("\n"),L(R,M,j),M.process(h,o,j)}function Z(D,h){var o;const H=D.defines,g={};for(const j of H){const D=j.replace("#define","").replace(";","").trim().split(" ");g[D[0]]=D.length>1?D[1]:""}return 0===(null===(o=D.processor)||void 0===o?void 0:o.shaderLanguage)&&(g.GL_ES="true"),g.__VERSION__=D.version,g[D.platformName]="true",(0,v.f)(g,null===h||void 0===h?void 0:h.isNDCHalfZRange,null===h||void 0===h?void 0:h.Bh,null===h||void 0===h?void 0:h.useExactSrgbConversions),g}function e(D,h,o){let H;for(y.length=0;null!==(H=s.exec(D));)y.push(H);let g=String(D),j=[D],M=!1;for(const R of y){let D=R[1];if(-1!==D.indexOf("__decl__")&&(D=D.replace(U,""),h.supportsUniformBuffers&&(D=D.replace("Vertex","Ubo").replace("Fragment","Ubo")),D+="Declaration"),!h.includesShadersStore[D]){const H=h.shadersRepository+"ShadersInclude/"+D+".fx";return void p.loadFile(H,(H=>{h.includesShadersStore[D]=H,e(j.join(""),h,o)}))}{let o=h.includesShadersStore[D];if(R[2]){const D=R[3].split(",");for(let h=0;h<D.length;h+=2){const H=new RegExp(D[h],"g"),g=D[h+1];o=o.replace(H,g)}}if(R[4]){const D=R[5];if(-1!==D.indexOf("..")){const H=D.split(".."),g=parseInt(H[0]);let j=parseInt(H[1]),M=o.slice(0);o="",isNaN(j)&&(j=h.indexParameters[H[1]]);for(let D=g;D<j;D++)h.supportsUniformBuffers||(M=M.replace(q,((D,h)=>h+"{X}"))),o+=M.replace(c,D.toString())+"\n"}else h.supportsUniformBuffers||(o=o.replace(q,((D,h)=>h+"{X}"))),o=o.replace(c,D)}const H=[];for(const D of j){const h=D.split(R[0]);for(let D=0;D<h.length-1;D++)H.push(h[D]),H.push(o);H.push(h[h.length-1])}j=H,M=M||o.indexOf("#include<")>=0||o.indexOf("#include <")>=0}}y.length=0,g=j.join(""),M?e(g.toString(),h,o):o(g)}const p={loadFile:(D,h,o,H,g,j)=>{throw(0,Q.e)("FileTools")}}},12715:(D,h,o)=>{o.d(h,{c:()=>g,d:()=>j,f:()=>R,h:()=>M,j:()=>t});var H=o(12672);o(12656);const g={};function j(D,h){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(h?h+"\n":"")+D}function M(D,h,o,j,M,R,t){const S=t||g.loadFile;if(S){return S(D,h,o,j,M,R)}throw(0,H.e)("FileTools")}function R(D,h,o,H){if(D)return h?D.IS_NDC_HALF_ZRANGE="":delete D.IS_NDC_HALF_ZRANGE,o?D.USE_REVERSE_DEPTHBUFFER="":delete D.USE_REVERSE_DEPTHBUFFER,void(H?D.USE_EXACT_SRGB_CONVERSIONS="":delete D.USE_EXACT_SRGB_CONVERSIONS);{let D="";return h&&(D+="#define IS_NDC_HALF_ZRANGE"),o&&(D&&(D+="\n"),D+="#define USE_REVERSE_DEPTHBUFFER"),H&&(D&&(D+="\n"),D+="#define USE_EXACT_SRGB_CONVERSIONS"),D}}function t(D,h){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>3?arguments[3]:void 0;switch(D){case 3:{const D=(ArrayBuffer,new Int8Array(h));return H&&D.set(new Int8Array(H)),D}case 0:{const D=(ArrayBuffer,new Uint8Array(h));return H&&D.set(new Uint8Array(H)),D}case 4:{const D=h instanceof ArrayBuffer?new Int16Array(h):new Int16Array(o?h/2:h);return H&&D.set(new Int16Array(H)),D}case 5:case 8:case 9:case 10:case 2:{const D=h instanceof ArrayBuffer?new Uint16Array(h):new Uint16Array(o?h/2:h);return H&&D.set(new Uint16Array(H)),D}case 6:{const D=h instanceof ArrayBuffer?new Int32Array(h):new Int32Array(o?h/4:h);return H&&D.set(new Int32Array(H)),D}case 7:case 11:case 12:case 13:case 14:case 15:{const D=h instanceof ArrayBuffer?new Uint32Array(h):new Uint32Array(o?h/4:h);return H&&D.set(new Uint32Array(H)),D}case 1:{const D=h instanceof ArrayBuffer?new Float32Array(h):new Float32Array(o?h/4:h);return H&&D.set(new Float32Array(H)),D}}const g=(ArrayBuffer,new Uint8Array(h));return H&&g.set(new Uint8Array(H)),g}},12741:(D,h,o)=>{o.d(h,{d:()=>H});class H{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersRepository:H.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersStore:H.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.IncludesShadersStore:H.IncludesShadersStoreWGSL}}H.ShadersRepository="src/Shaders/",H.ShadersStore={},H.IncludesShadersStore={},H.ShadersRepositoryWGSL="src/ShadersWGSL/",H.ShadersStoreWGSL={},H.IncludesShadersStoreWGSL={}},12753:(D,h,o)=>{o.d(h,{c:()=>Q,f:()=>c,g:()=>r,k:()=>v,l:()=>B,o:()=>q,p:()=>K,s:()=>S,w:()=>k,A:()=>t,B:()=>R});class H{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.bh._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(D){D&&this.program&&D(this.program)}setEngine(D){this.bh=D}_fillEffectInformation(D,h,o,H,g,j,M,R){const t=this.bh;if(t.supportsUniformBuffers)for(const k in h)D.bindUniformBlock(k,h[k]);let S;for(this.bh.getUniforms(this,o).forEach(((D,h)=>{H[o[h]]=D})),this._uniforms=H,S=0;S<g.length;S++){null==D.getUniform(g[S])&&(g.splice(S,1),S--)}g.forEach(((D,h)=>{j[D]=h}));for(const k of t.getAttributes(this,M))R.push(k)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(D,h){const o=this._valueCache[D],H=h.updateFlag;return(void 0===o||o!==H)&&(this._valueCache[D]=H,!0)}_cacheFloat2(D,h,o){let H=this._valueCache[D];if(!H||2!==H.length)return H=[h,o],this._valueCache[D]=H,!0;let g=!1;return H[0]!==h&&(H[0]=h,g=!0),H[1]!==o&&(H[1]=o,g=!0),g}_cacheFloat3(D,h,o,H){let g=this._valueCache[D];if(!g||3!==g.length)return g=[h,o,H],this._valueCache[D]=g,!0;let j=!1;return g[0]!==h&&(g[0]=h,j=!0),g[1]!==o&&(g[1]=o,j=!0),g[2]!==H&&(g[2]=H,j=!0),j}_cacheFloat4(D,h,o,H,g){let j=this._valueCache[D];if(!j||4!==j.length)return j=[h,o,H,g],this._valueCache[D]=j,!0;let M=!1;return j[0]!==h&&(j[0]=h,M=!0),j[1]!==o&&(j[1]=o,M=!0),j[2]!==H&&(j[2]=H,M=!0),j[3]!==g&&(j[3]=g,M=!0),M}setInt(D,h){const o=this._valueCache[D];void 0!==o&&o===h||this.bh.setInt(this._uniforms[D],h)&&(this._valueCache[D]=h)}setInt2(D,h,o){this._cacheFloat2(D,h,o)&&(this.bh.setInt2(this._uniforms[D],h,o)||(this._valueCache[D]=null))}setInt3(D,h,o,H){this._cacheFloat3(D,h,o,H)&&(this.bh.setInt3(this._uniforms[D],h,o,H)||(this._valueCache[D]=null))}setInt4(D,h,o,H,g){this._cacheFloat4(D,h,o,H,g)&&(this.bh.setInt4(this._uniforms[D],h,o,H,g)||(this._valueCache[D]=null))}setIntArray(D,h){this._valueCache[D]=null,this.bh.setIntArray(this._uniforms[D],h)}setIntArray2(D,h){this._valueCache[D]=null,this.bh.setIntArray2(this._uniforms[D],h)}setIntArray3(D,h){this._valueCache[D]=null,this.bh.setIntArray3(this._uniforms[D],h)}setIntArray4(D,h){this._valueCache[D]=null,this.bh.setIntArray4(this._uniforms[D],h)}setUInt(D,h){const o=this._valueCache[D];void 0!==o&&o===h||this.bh.setUInt(this._uniforms[D],h)&&(this._valueCache[D]=h)}setUInt2(D,h,o){this._cacheFloat2(D,h,o)&&(this.bh.setUInt2(this._uniforms[D],h,o)||(this._valueCache[D]=null))}setUInt3(D,h,o,H){this._cacheFloat3(D,h,o,H)&&(this.bh.setUInt3(this._uniforms[D],h,o,H)||(this._valueCache[D]=null))}setUInt4(D,h,o,H,g){this._cacheFloat4(D,h,o,H,g)&&(this.bh.setUInt4(this._uniforms[D],h,o,H,g)||(this._valueCache[D]=null))}setUIntArray(D,h){this._valueCache[D]=null,this.bh.setUIntArray(this._uniforms[D],h)}setUIntArray2(D,h){this._valueCache[D]=null,this.bh.setUIntArray2(this._uniforms[D],h)}setUIntArray3(D,h){this._valueCache[D]=null,this.bh.setUIntArray3(this._uniforms[D],h)}setUIntArray4(D,h){this._valueCache[D]=null,this.bh.setUIntArray4(this._uniforms[D],h)}setArray(D,h){this._valueCache[D]=null,this.bh.setArray(this._uniforms[D],h)}setArray2(D,h){this._valueCache[D]=null,this.bh.setArray2(this._uniforms[D],h)}setArray3(D,h){this._valueCache[D]=null,this.bh.setArray3(this._uniforms[D],h)}setArray4(D,h){this._valueCache[D]=null,this.bh.setArray4(this._uniforms[D],h)}setMatrices(D,h){h&&(this._valueCache[D]=null,this.bh.setMatrices(this._uniforms[D],h))}setMatrix(D,h){this._cacheMatrix(D,h)&&(this.bh.setMatrices(this._uniforms[D],h.Fh())||(this._valueCache[D]=null))}setMatrix3x3(D,h){this._valueCache[D]=null,this.bh.setMatrix3x3(this._uniforms[D],h)}setMatrix2x2(D,h){this._valueCache[D]=null,this.bh.setMatrix2x2(this._uniforms[D],h)}setFloat(D,h){const o=this._valueCache[D];void 0!==o&&o===h||this.bh.setFloat(this._uniforms[D],h)&&(this._valueCache[D]=h)}setVector2(D,h){this._cacheFloat2(D,h.x,h.y)&&(this.bh.setFloat2(this._uniforms[D],h.x,h.y)||(this._valueCache[D]=null))}setFloat2(D,h,o){this._cacheFloat2(D,h,o)&&(this.bh.setFloat2(this._uniforms[D],h,o)||(this._valueCache[D]=null))}setVector3(D,h){this._cacheFloat3(D,h.x,h.y,h.z)&&(this.bh.setFloat3(this._uniforms[D],h.x,h.y,h.z)||(this._valueCache[D]=null))}setFloat3(D,h,o,H){this._cacheFloat3(D,h,o,H)&&(this.bh.setFloat3(this._uniforms[D],h,o,H)||(this._valueCache[D]=null))}setVector4(D,h){this._cacheFloat4(D,h.x,h.y,h.z,h.w)&&(this.bh.setFloat4(this._uniforms[D],h.x,h.y,h.z,h.w)||(this._valueCache[D]=null))}setQuaternion(D,h){this._cacheFloat4(D,h.x,h.y,h.z,h.w)&&(this.bh.setFloat4(this._uniforms[D],h.x,h.y,h.z,h.w)||(this._valueCache[D]=null))}setFloat4(D,h,o,H,g){this._cacheFloat4(D,h,o,H,g)&&(this.bh.setFloat4(this._uniforms[D],h,o,H,g)||(this._valueCache[D]=null))}setColor3(D,h){this._cacheFloat3(D,h.r,h.g,h.b)&&(this.bh.setFloat3(this._uniforms[D],h.r,h.g,h.b)||(this._valueCache[D]=null))}setColor4(D,h,o){this._cacheFloat4(D,h.r,h.g,h.b,o)&&(this.bh.setFloat4(this._uniforms[D],h.r,h.g,h.b,o)||(this._valueCache[D]=null))}setDirectColor4(D,h){this._cacheFloat4(D,h.r,h.g,h.b,h.a)&&(this.bh.setFloat4(this._uniforms[D],h.r,h.g,h.b,h.a)||(this._valueCache[D]=null))}_getVertexShaderCode(){return this.vertexShader?this.bh._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.bh._getShaderSource(this.fragmentShader):null}}var g=o(12715);const j=new WeakMap,M={_webGLVersion:2,cachedPipelines:{}};function R(D){let h=j.get(D);if(!h){if(!D)return M;h={_webGLVersion:D.TEXTURE_BINDING_3D?2:1,_context:D,parallelShaderCompile:D.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},j.set(D,h)}return h}function t(D){j.delete(D)}function S(D,h,o,H,g,j){const M=R(H);j||(j=M._createShaderProgramInjection??Q);return j(D,U(h,"vertex",H,M._contextWasLost),U(o,"fragment",H,M._contextWasLost),H,g,M.validateShaderPrograms)}function k(D,h,o,H,g){let j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,M=arguments.length>6?arguments[6]:void 0;const t=R(g);M||(M=t._createShaderProgramInjection??Q);const S=t._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return M(D,s(h,"vertex",H,S,g,t._contextWasLost),s(o,"fragment",H,S,g,t._contextWasLost),g,j,t.validateShaderPrograms)}function K(D,h){const o=new H,g=R(D);return g.parallelShaderCompile&&!g.disableParallelShaderCompile&&(o.isParallelCompiled=!0),o.context=g._context,o}function Q(D,h,o,H){let g=arguments.length>5?arguments[5]:void 0;const j=H.createProgram();if(D.program=j,!j)throw new Error("Unable to create program");return H.attachShader(j,h),H.attachShader(j,o),H.linkProgram(j),D.context=H,D.vertexShader=h,D.fragmentShader=o,D.isParallelCompiled||r(D,H,g),j}function v(D,h,o){const H=D;if(H._isDisposed)return!1;const g=R(h);return!!(g&&g.parallelShaderCompile&&g.parallelShaderCompile.COMPLETION_STATUS_KHR&&H.program&&h.getProgramParameter(H.program,g.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(r(H,h,o),!0)}function r(D,h,o){const H=D.context,g=D.vertexShader,j=D.fragmentShader,M=D.program;if(!H.getProgramParameter(M,H.LINK_STATUS)){if(!h.getShaderParameter(g,h.COMPILE_STATUS)){const o=h.getShaderInfoLog(g);if(o)throw D.vertexCompilationError=o,new Error("VERTEX SHADER "+o)}if(!h.getShaderParameter(j,h.COMPILE_STATUS)){const o=h.getShaderInfoLog(j);if(o)throw D.fragmentCompilationError=o,new Error("FRAGMENT SHADER "+o)}const o=H.getProgramInfoLog(M);if(o)throw D.programLinkError=o,new Error(o)}if(o){H.validateProgram(M);if(!H.getProgramParameter(M,H.VALIDATE_STATUS)){const h=H.getProgramInfoLog(M);if(h)throw D.programValidationError=h,new Error(h)}}H.deleteShader(g),H.deleteShader(j),D.vertexShader=void 0,D.fragmentShader=void 0,D.onCompiled&&(D.onCompiled(),D.onCompiled=void 0)}function B(D,h,o,H,g,j,M,t,K){let Q=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0,r=arguments.length>12?arguments[12]:void 0;const B=R(D.context);v||(v=B.createRawShaderProgramInjection??S),r||(r=B.createShaderProgramInjection??k);const s=D;s.program=H?v(s,h,o,s.context,K):r(s,h,o,t,s.context,K),s.program.__SPECTOR_rebuildProgram=M,Q()}function s(D,h,o,H,j,M){return U((0,g.d)(D,o,H),h,j,M)}function U(D,h,o,H){const g=o.createShader("vertex"===h?o.VERTEX_SHADER:o.FRAGMENT_SHADER);if(!g){let D=o.NO_ERROR,g=o.NO_ERROR;for(;(g=o.getError())!==o.NO_ERROR;)D=g;throw new Error(`Something went wrong while creating a gl ${h} shader object. gl error=${D}, gl isContextLost=${o.isContextLost()}, _contextWasLost=${H}`)}return o.shaderSource(g,D),o.compileShader(g),g}function q(D,h){h.useProgram(D)}function c(D,h){const o=D;if(!o.isParallelCompiled)return void h(D);const H=o.onCompiled;o.onCompiled=()=>{null===H||void 0===H||H(),h(D)}}},12748:(D,h,o)=>{o.d(h,{c:()=>K,g:()=>v,k:()=>S,l:()=>k});var H=o(12656),g=o(12753),j=o(12741),M=o(12658),R=o(12709),t=o(12715);function S(D,h){return(0,g.B)(h).cachedPipelines[D]}function k(D){const h=D._name,o=D.context;if(h&&o){const D=(0,g.B)(o),H=D.cachedPipelines[h];null===H||void 0===H||H.dispose(),delete D.cachedPipelines[h]}}function K(D,h,o,g,j,M,t){let S,k;const K=(0,H.m)()?null===M||void 0===M?void 0:M.getHostDocument():null;S="string"===typeof h?h:h.vertexSource?"source:"+h.vertexSource:h.vertexElement?(null===K||void 0===K?void 0:K.getElementById(h.vertexElement))||h.vertexElement:h.vertex||h,k="string"===typeof h?h:h.fragmentSource?"source:"+h.fragmentSource:h.fragmentElement?(null===K||void 0===K?void 0:K.getElementById(h.fragmentElement))||h.fragmentElement:h.fragment||h;const v=[void 0,void 0],r=()=>{if(v[0]&&v[1]){D.isFragment=!0;const[H,S]=v;(0,R.o)(S,D,((M,S)=>{t&&(t._fragmentSourceCodeBeforeMigration=S),o&&(M=o("fragment",M));const k=(0,R.d)(H,M,D);D=null;const K=function(D,h,o,H){if(o){return{vertexSourceCode:(1===H?"//":"")+"#define SHADER_NAME vertex:"+(o.vertexElement||o.vertex||o.spectorName||o)+"\n"+D,fragmentSourceCode:(1===H?"//":"")+"#define SHADER_NAME fragment:"+(o.fragmentElement||o.fragment||o.spectorName||o)+"\n"+h}}return{vertexSourceCode:D,fragmentSourceCode:h}}(k.vertexCode,k.fragmentCode,h,j);null===g||void 0===g||g(K.vertexSourceCode,K.fragmentSourceCode)}),M)}};Q(S,"Vertex","",(h=>{(0,R.g)(D),(0,R.o)(h,D,((D,H)=>{t&&(t._rawVertexSourceCode=h,t._vertexSourceCodeBeforeMigration=H),o&&(D=o("vertex",D)),v[0]=D,r()}),M)}),j),Q(k,"Fragment","Pixel",(D=>{t&&(t._rawFragmentSourceCode=D),v[1]=D,r()}),j)}function Q(D,h,o,g,M,R){if("undefined"!==typeof HTMLElement&&D instanceof HTMLElement){return void g((0,H.d)(D))}if("source:"===D.substring(0,7))return void g(D.substring(7));if("base64:"===D.substring(0,7)){return void g(window.atob(D.substring(7)))}const S=j.d.GetShadersStore(M);if(S[D+h+"Shader"])return void g(S[D+h+"Shader"]);if(o&&S[D+o+"Shader"])return void g(S[D+o+"Shader"]);let k;if(k="."===D[0]||"/"===D[0]||D.indexOf("http")>-1?D:j.d.GetShadersRepository(M)+D,!(R=R||t.h))throw new Error("loadFileInjection is not defined");R(k+"."+h.toLowerCase()+".fx",g)}const v=(D,h,o,H)=>{try{const j=D.context?(0,g.B)(D.context):null;j&&(j.disableParallelShaderCompile=D.disableParallelCompilation);const M=D.existingPipelineContext||h(D.shaderProcessingContext);return M._name=D.name,D.name&&j&&(j.cachedPipelines[D.name]=M),o(M,D.vertex,D.fragment,!!D.createAsRaw,"","",D.rebuildRebind,D.defines,D.transformFeedbackVaryings,"",(()=>{H(M,(()=>{var h;null===(h=D.onRenderingStateCompiled)||void 0===h||h.call(D,M)}))})),M}catch(j){throw M.d.Error("Error compiling effect"),j}}},12737:(D,h,o)=>{o.r(h),o.d(h,{Effect:()=>t});var H=o(12648),g=o(12658),j=o(12741),M=o(12748),R=o(12722);class t{static get ShadersRepository(){return j.d.ShadersRepository}static set ShadersRepository(D){j.d.ShadersRepository=D}get S(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new H.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(D,h,o){let g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,j=arguments.length>4?arguments[4]:void 0,R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,S=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,k=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,K=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,Q=arguments.length>9?arguments[9]:void 0,v=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",r=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,B=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new H.c,this.onErrorObservable=new H.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=D,this._key=v;const s=this._key.replace(/\r/g,"").replace(/\n/g,"|");let U;if(h.attributes){const D=h;if(this._engine=o,this._attributesNames=D.attributes,this._uniformsNames=D.uniformsNames.concat(D.samplers),this._samplerList=D.samplers.slice(),this.defines=D.defines,this.onError=D.onError,this.onCompiled=D.onCompiled,this._fallbacks=D.fallbacks,this._indexParameters=D.indexParameters,this._transformFeedbackVaryings=D.transformFeedbackVaryings||null,this._multiTarget=!!D.multiTarget,this._shaderLanguage=D.shaderLanguage??0,this._disableParallelShaderCompilation=!!D.disableParallelShaderCompilation,D.uniformBuffersNames){this._uniformBuffersNamesList=D.uniformBuffersNames.slice();for(let h=0;h<D.uniformBuffersNames.length;h++)this._uniformBuffersNames[D.uniformBuffersNames[h]]=h}this._processFinalCode=D.processFinalCode??null,this._processCodeAfterIncludes=D.processCodeAfterIncludes??void 0,B=D.extraInitializationsAsync,U=D.existingPipelineContext}else this._engine=j,this.defines=null==R?"":R,this._uniformsNames=o.concat(g),this._samplerList=g?g.slice():[],this._attributesNames=h,this._uniformBuffersNamesList=[],this._shaderLanguage=r,this.onError=K,this.onCompiled=k,this._indexParameters=Q,this._fallbacks=S;"WEBGL2"===this._engine.shaderPlatformName&&(U=(0,M.k)(s,this._engine._gl)??U),this._attributeLocationByName={},this.uniqueId=t._UniqueIdSeed++,U?(this._pipelineContext=U,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,B),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.S||this.dispose(!0)}))}async _processShaderCodeAsync(){let D=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,h=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,H=arguments.length>3?arguments[3]:void 0;H&&await H(),this._processingContext=o||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const g={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:D??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:j.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:j.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,Bh:this._engine.Bh,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,M.c)(g,this.name,this._processFinalCode,((D,o)=>{this._vertexSourceCode=D,this._fragmentSourceCode=o,this._prepareEffect(h)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.S||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(D){return this._attributes[D]}getAttributeLocationByName(D){return this._attributeLocationByName[D]}getAttributesCount(){return this._attributes.length}getUniformIndex(D){return this._uniformsNames.indexOf(D)}getUniform(D){return this._uniforms[D]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((D=>{this.executeWhenCompiled(D)}))}executeWhenCompiled(D){this.isReady()?D(this):(this.onCompileObservable.add((h=>{D(h)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(D){(0,R.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(h=>{this._processCompilationErrors(h,D)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var D;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(D=this._pipelineContext)||void 0===D?void 0:D._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var D;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(D=this._pipelineContext)||void 0===D?void 0:D._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,Bh:this._engine.Bh,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(D,h,o,H){this._isReady=!1,this._vertexSourceCodeOverride=D,this._fragmentSourceCodeOverride=h,this.onError=(D,h)=>{H&&H(h)},this.onCompiled=()=>{var D,h;const H=this.getEngine().scenes;if(H)for(let o=0;o<H.length;o++)H[o].markAllMaterialsAsDirty(127);null===(D=(h=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===D||D.call(h,o)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(D){if(this._pipelineContext=D,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let h=0;h<this._attributesNames.length;h++){const D=this._attributesNames[h];this._attributeLocationByName[D]=this._attributes[h]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),t.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let D=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const h=this._pipelineContext;this._isReady=!1;try{const o=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),H=o?null:this.defines,g=o?this._vertexSourceCodeOverride:this._vertexSourceCode,j=o?this._fragmentSourceCodeOverride:this._fragmentSourceCode,R=this._engine;this._pipelineContext=(0,M.g)({existingPipelineContext:D?h:null,vertex:g,fragment:j,context:"WEBGL2"===R.shaderPlatformName||"WEBGL1"===R.shaderPlatformName?R._gl:void 0,rebuildRebind:(D,h,o,H)=>this._rebuildProgram(D,h,o,H),defines:H,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:o,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:o=>{h&&!D&&this._engine._deletePipelineContext(h),o&&this._onRenderingStateCompiled(o)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(h)}catch(o){this._processCompilationErrors(o,h)}}_getShaderCodeAndErrorLine(D,h,o){const H=o?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let g=null;if(h&&D){const j=h.match(H);if(j&&2===j.length){const h=parseInt(j[1]),H=D.split("\n",-1);H.length>=h&&(g=`Offending line [${h}] in ${o?"fragment":"vertex"} code: ${H[h-1]}`)}}return[D,g]}_processCompilationErrors(D){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=D.message;const o=this._attributesNames,H=this._fallbacks;if(g.d.Error("Unable to compile effect:"),g.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),g.d.Error(`Attributes: ${o.join(" ")}`),g.d.Error("Defines:\n"+this.defines),t.LogShaderCodeOnCompilationError){var j,M;let D=null,h=null,o=null;var R;if(null!==(j=this._pipelineContext)&&void 0!==j&&j._getVertexShaderCode()&&([o,D]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),o&&(g.d.Error("Vertex code:"),g.d.Error(o))),null!==(M=this._pipelineContext)&&void 0!==M&&M._getFragmentShaderCode())[o,h]=this._getShaderCodeAndErrorLine(null===(R=this._pipelineContext)||void 0===R?void 0:R._getFragmentShaderCode(),this._compilationError,!0),o&&(g.d.Error("Fragment code:"),g.d.Error(o));D&&g.d.Error(D),h&&g.d.Error(h)}g.d.Error("Error: "+this._compilationError);const S=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};h&&(this._pipelineContext=h,this._isReady=!0,S()),H?(this._pipelineContext=null,H.hasMoreFallbacks?(this._allFallbacksProcessed=!1,g.d.Error("Trying next fallback."),this.defines=H.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,S(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,h||S())}get isSupported(){return""===this._compilationError}_bindTexture(D,h){this._engine._bindTexture(this._samplers[D],h,D)}setTexture(D,h){this._engine.setTexture(this._samplers[D],this._uniforms[D],h,D)}setTextureArray(D,h){const o=D+"Ex";if(-1===this._samplerList.indexOf(o+"0")){const H=this._samplerList.indexOf(D);for(let D=1;D<h.length;D++){const h=o+(D-1).toString();this._samplerList.splice(H+D,0,h)}let g=0;for(const D of this._samplerList)this._samplers[D]=g,g+=1}this._engine.setTextureArray(this._samplers[D],this._uniforms[D],h,D)}bindUniformBuffer(D,h){const o=this._uniformBuffersNames[h];void 0===o||t._BaseCache[o]===D&&this._engine._features.useUBOBindingCache||(t._BaseCache[o]=D,this._engine.bindUniformBufferBase(D,o,h))}bindUniformBlock(D,h){this._engine.bindUniformBlock(this._pipelineContext,D,h)}setInt(D,h){return this._pipelineContext.setInt(D,h),this}setInt2(D,h,o){return this._pipelineContext.setInt2(D,h,o),this}setInt3(D,h,o,H){return this._pipelineContext.setInt3(D,h,o,H),this}setInt4(D,h,o,H,g){return this._pipelineContext.setInt4(D,h,o,H,g),this}setIntArray(D,h){return this._pipelineContext.setIntArray(D,h),this}setIntArray2(D,h){return this._pipelineContext.setIntArray2(D,h),this}setIntArray3(D,h){return this._pipelineContext.setIntArray3(D,h),this}setIntArray4(D,h){return this._pipelineContext.setIntArray4(D,h),this}setUInt(D,h){return this._pipelineContext.setUInt(D,h),this}setUInt2(D,h,o){return this._pipelineContext.setUInt2(D,h,o),this}setUInt3(D,h,o,H){return this._pipelineContext.setUInt3(D,h,o,H),this}setUInt4(D,h,o,H,g){return this._pipelineContext.setUInt4(D,h,o,H,g),this}setUIntArray(D,h){return this._pipelineContext.setUIntArray(D,h),this}setUIntArray2(D,h){return this._pipelineContext.setUIntArray2(D,h),this}setUIntArray3(D,h){return this._pipelineContext.setUIntArray3(D,h),this}setUIntArray4(D,h){return this._pipelineContext.setUIntArray4(D,h),this}setFloatArray(D,h){return this._pipelineContext.setArray(D,h),this}setFloatArray2(D,h){return this._pipelineContext.setArray2(D,h),this}setFloatArray3(D,h){return this._pipelineContext.setArray3(D,h),this}setFloatArray4(D,h){return this._pipelineContext.setArray4(D,h),this}setArray(D,h){return this._pipelineContext.setArray(D,h),this}setArray2(D,h){return this._pipelineContext.setArray2(D,h),this}setArray3(D,h){return this._pipelineContext.setArray3(D,h),this}setArray4(D,h){return this._pipelineContext.setArray4(D,h),this}setMatrices(D,h){return this._pipelineContext.setMatrices(D,h),this}setMatrix(D,h){return this._pipelineContext.setMatrix(D,h),this}setMatrix3x3(D,h){return this._pipelineContext.setMatrix3x3(D,h),this}setMatrix2x2(D,h){return this._pipelineContext.setMatrix2x2(D,h),this}setFloat(D,h){return this._pipelineContext.setFloat(D,h),this}setBool(D,h){return this._pipelineContext.setInt(D,h?1:0),this}setVector2(D,h){return this._pipelineContext.setVector2(D,h),this}setFloat2(D,h,o){return this._pipelineContext.setFloat2(D,h,o),this}setVector3(D,h){return this._pipelineContext.setVector3(D,h),this}setFloat3(D,h,o,H){return this._pipelineContext.setFloat3(D,h,o,H),this}setVector4(D,h){return this._pipelineContext.setVector4(D,h),this}setQuaternion(D,h){return this._pipelineContext.setQuaternion(D,h),this}setFloat4(D,h,o,H,g){return this._pipelineContext.setFloat4(D,h,o,H,g),this}setColor3(D,h){return this._pipelineContext.setColor3(D,h),this}setColor4(D,h,o){return this._pipelineContext.setColor4(D,h,o),this}setDirectColor4(D,h){return this._pipelineContext.setDirectColor4(D,h),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(t.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,M.l)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(D,h,o){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;h&&(j.d.GetShadersStore(H)[`${D}PixelShader`]=h),o&&(j.d.GetShadersStore(H)[`${D}VertexShader`]=o)}static ResetCache(){t._BaseCache={}}}t.LogShaderCodeOnCompilationError=!0,t.PersistentMode=!1,t.AutomaticallyClearCodeCache=!1,t._UniqueIdSeed=0,t._BaseCache={},t.ShadersStore=j.d.ShadersStore,t.IncludesShadersStore=j.d.IncludesShadersStore},12672:(D,h,o)=>{o.d(h,{e:()=>g});const H={};function g(D){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!H[D])return H[D]=!0,`${D} needs to be imported before as it contains a side-effect required by your code.`}},12656:(D,h,o)=>{function H(){return"undefined"!==typeof window}function g(){return"undefined"!==typeof navigator}function j(){return"undefined"!==typeof document}function M(D){let h="",o=D.firstChild;for(;o;)3===o.nodeType&&(h+=o.textContent),o=o.nextSibling;return h}o.d(h,{d:()=>M,h:()=>j,l:()=>g,m:()=>H})},12658:(D,h,o)=>{o.d(h,{d:()=>H});class H{static _CheckLimit(D,h){let o=H._LogLimitOutputs[D];return o?o.current++:(o={limit:h,current:1},H._LogLimitOutputs[D]=o),o.current<=o.limit}static _GenerateLimitMessage(D){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const o=H._LogLimitOutputs[D];if(!o||!H.MessageLimitReached)return;const g=this._Levels[h];o.current===o.limit&&H[g.name](H.MessageLimitReached.replace(/%LIMIT%/g,""+o.limit).replace(/%TYPE%/g,g.name??""))}static _AddLogEntry(D){H._LogCache=D+H._LogCache,H.OnNewCacheEntry&&H.OnNewCacheEntry(D)}static _FormatMessage(D){const h=D=>D<10?"0"+D:""+D,o=new Date;return"["+h(o.getHours())+":"+h(o.getMinutes())+":"+h(o.getSeconds())+"]: "+D}static _LogDisabled(D,h){}static _LogEnabled(){let D=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,h=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;const g=Array.isArray(h)?h[0]:h;if(void 0!==o&&!H._CheckLimit(g,o))return;const j=H._FormatMessage(g),M=this._Levels[D],R=Array.isArray(h)?h.slice(1):[];M.logFunc&&M.logFunc("BJS - "+j,...R);const t=`<div style='color:${M.color}'>${j}</div><br>`;H._AddLogEntry(t),H._GenerateLimitMessage(g,D)}static get LogCache(){return H._LogCache}static ClearLogCache(){H._LogCache="",H._LogLimitOutputs={},H.errorsCount=0}static set LogLevels(D){H.Log=H._LogDisabled,H.Warn=H._LogDisabled,H.Error=H._LogDisabled;const h=[H.MessageLogLevel,H.WarningLogLevel,H.ErrorLogLevel];for(const o of h)if((D&o)===o){const D=this._Levels[o];H[D.name]=H._LogEnabled.bind(H,o)}}}H.NoneLogLevel=0,H.MessageLogLevel=1,H.WarningLogLevel=2,H.ErrorLogLevel=4,H.AllLogLevel=7,H.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",H._LogCache="",H._LogLimitOutputs={},H._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],H.errorsCount=0,H.Log=H._LogEnabled.bind(H,H.MessageLogLevel),H.Warn=H._LogEnabled.bind(H,H.WarningLogLevel),H.Error=H._LogEnabled.bind(H,H.ErrorLogLevel)},12648:(D,h,o)=>{o.d(h,{c:()=>M});const H="undefined"!==typeof WeakRef;class g{constructor(D){let h=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;this.initialize(D,h,o,H)}initialize(D){let h=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;return this.mask=D,this.skipNextObservers=h,this.target=o,this.currentTarget=H,this}}class j{constructor(D,h){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=D,this.mask=h,this.scope=o,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let D=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(D)}}class M{static FromPromise(D,h){const o=new M;return D.then((D=>{o.notifyObservers(D)})).catch((D=>{if(!h)throw D;h.notifyObservers(D)})),o}get observers(){return this._observers}constructor(D){let h=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=h,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new g(0),D&&(this._onObserverAdded=D)}add(D){let h=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!D)return null;const g=new j(D,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);g.unregisterOnNextCall=o,h?this._observers.unshift(g):this._observers.push(g),this._onObserverAdded&&this._onObserverAdded(g),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(g,this._lastNotifiedValue);const M=H?new WeakRef(this):{deref:()=>this};return g._remove=function(){let D=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const h=M.deref();h&&(D?h.remove(g):h._remove(g))},g}addOnce(D){return this.add(D,void 0,void 0,void 0,!0)}remove(D){if(!D)return!1;D._remove=null;return-1!==this._observers.indexOf(D)&&(this._deferUnregister(D),!0)}removeCallback(D,h){for(let o=0;o<this._observers.length;o++){const H=this._observers[o];if(!H._willBeUnregistered&&(H.callback===D&&(!h||h===H.scope)))return this._deferUnregister(H),!0}return!1}_deferUnregister(D){D._willBeUnregistered||(this._numObserversMarkedAsDeleted++,D.unregisterOnNextCall=!1,D._willBeUnregistered=!0,setTimeout((()=>{this._remove(D)}),0))}_remove(D){let h=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!D)return!1;const o=this._observers.indexOf(D);return-1!==o&&(h&&this._numObserversMarkedAsDeleted--,this._observers.splice(o,1),!0)}makeObserverTopPriority(D){this._remove(D,!1),this._observers.unshift(D)}makeObserverBottomPriority(D){this._remove(D,!1),this._observers.push(D)}notifyObservers(D){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0,g=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=D),!this._observers.length)return!0;const j=this._eventState;j.mask=h,j.target=o,j.currentTarget=H,j.skipNextObservers=!1,j.lastReturnValue=D,j.userInfo=g;for(const M of this._observers)if(!M._willBeUnregistered&&(M.mask&h&&(M.unregisterOnNextCall&&this._deferUnregister(M),M.scope?j.lastReturnValue=M.callback.apply(M.scope,[D,j]):j.lastReturnValue=M.callback(D,j)),j.skipNextObservers))return!1;return!0}notifyObserver(D,h){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=h),D._willBeUnregistered)return;const H=this._eventState;H.mask=o,H.skipNextObservers=!1,D.unregisterOnNextCall&&this._deferUnregister(D),D.callback(h,H)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const D=this._observers.pop();D&&(D._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const D=new M;return D._observers=this._observers.slice(0),D}hasSpecificMask(){let D=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const h of this._observers)if(h.mask&D||h.mask===D)return!0;return!1}}},12722:(D,h,o)=>{o.d(h,{e:()=>g,f:()=>M});let H=[];class g{static SetImmediate(D){0===H.length&&setTimeout((()=>{const D=H;H=[];for(const h of D)h()}),1),H.push(D)}}function j(D,h,o){try{if(D())return h(),!0}catch(H){return null===o||void 0===o||o(H),!0}return!1}const M=function(D,h,o){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,M=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&j(D,h,o))return null;const R=setInterval((()=>{j(D,h,o)?clearInterval(R):(g-=H,g<0&&(clearInterval(R),null===o||void 0===o||o(new Error("Operation timed out after maximum retries. "+(M||"")),!0)))}),H);return()=>clearInterval(R)}}}]);