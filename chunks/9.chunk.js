"use strict";(self.n52dyox90qa=self.n52dyox90qa||[]).push([[9],{11695:(E,t,z)=>{z.d(t,{e:()=>l,f:()=>D,h:()=>S,g:()=>J,k:()=>V});class A{constructor(){this.children=[]}isValid(E){return!0}process(E,t,z){let A="";if(this.line){let z=this.line;const H=t.processor;if(H){var X,R,u,p,C,Z;H.lineProcessor&&(z=H.lineProcessor(z,t.isFragment,t.processingContext));const A=(null===(X=t.processor)||void 0===X?void 0:X.attributeKeywordName)??"attribute",h=t.isFragment&&null!==(R=t.processor)&&void 0!==R&&R.varyingFragmentKeywordName?null===(u=t.processor)||void 0===u?void 0:u.varyingFragmentKeywordName:!t.isFragment&&null!==(p=t.processor)&&void 0!==p&&p.varyingVertexKeywordName?null===(C=t.processor)||void 0===C?void 0:C.varyingVertexKeywordName:"varying";if(!t.isFragment&&H.attributeProcessor&&this.line.startsWith(A))z=H.attributeProcessor(this.line,E,t.processingContext);else if(H.varyingProcessor&&(null!==(Z=H.varyingCheck)&&void 0!==Z&&Z.call(H,this.line,t.isFragment)||!H.varyingCheck&&this.line.startsWith(h)))z=H.varyingProcessor(this.line,t.isFragment,E,t.processingContext);else if(H.uniformProcessor&&H.uniformRegexp&&H.uniformRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(z=H.uniformProcessor(this.line,t.isFragment,E,t.processingContext));else if(H.uniformBufferProcessor&&H.uniformBufferRegexp&&H.uniformBufferRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(z=H.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0);else if(H.textureProcessor&&H.textureRegexp&&H.textureRegexp.test(this.line))z=H.textureProcessor(this.line,t.isFragment,E,t.processingContext);else if((H.uniformProcessor||H.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?H.uniformProcessor&&(z=H.uniformProcessor(this.line,t.isFragment,E,t.processingContext)):H.uniformBufferProcessor&&(z=H.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)}t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,H.endOfUniformBufferProcessor&&(z=H.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}A+=z+"\n"}for(const H of this.children)A+=H.process(E,t,z);return this.additionalDefineKey&&(E[this.additionalDefineKey]=this.additionalDefineValue||"true",z[this.additionalDefineKey]=E[this.additionalDefineKey]),A}}class X{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(E){this._lines.length=0;for(const t of E){if(!t||"\r"===t)continue;if("#"===t[0]){this._lines.push(t);continue}const E=t.trim();if(!E)continue;if(E.startsWith("//")){this._lines.push(t);continue}const z=E.indexOf(";");if(-1===z)this._lines.push(E);else if(z===E.length-1)E.length>1&&this._lines.push(E);else{const E=t.split(";");for(let t=0;t<E.length;t++){let z=E[t];z&&(z=z.trim(),z&&this._lines.push(z+(t!==E.length-1?";":"")))}}}}}class R extends A{process(E,t,z){for(let A=0;A<this.children.length;A++){const X=this.children[A];if(X.isValid(E))return X.process(E,t,z)}return""}}class u extends A{isValid(E){return this.testExpression.isTrue(E)}}class p{isTrue(E){return!0}static postfixToInfix(E){const t=[];for(const z of E)if(void 0===p._OperatorPriority[z])t.push(z);else{const E=t[t.length-1],A=t[t.length-2];t.length-=2,t.push(`(${A}${z}${E})`)}return t[t.length-1]}static infixToPostfix(E){const t=p._InfixToPostfixCache.get(E);if(t)return t.accessTime=Date.now(),t.result;if(!E.includes("&&")&&!E.includes("||")&&!E.includes(")")&&!E.includes("("))return[E];const z=[];let A=-1;const X=()=>{H=H.trim(),""!==H&&(z.push(H),H="")},R=E=>{A<p._Stack.length-1&&(p._Stack[++A]=E)},u=()=>p._Stack[A],C=()=>-1===A?"!!INVALID EXPRESSION!!":p._Stack[A--];let Z=0,H="";for(;Z<E.length;){const t=E.charAt(Z),h=Z<E.length-1?E.substring(Z,2+Z):"";if("("===t)H="",R(t);else if(")"===t){for(X();-1!==A&&"("!==u();)z.push(C());C()}else if(p._OperatorPriority[h]>1){for(X();-1!==A&&p._OperatorPriority[u()]>=p._OperatorPriority[h];)z.push(C());R(h),Z++}else H+=t;Z++}for(X();-1!==A;)"("===u()?C():z.push(C());return p._InfixToPostfixCache.size>=p.InfixToPostfixCacheLimitSize&&p.ClearCache(),p._InfixToPostfixCache.set(E,{result:z,accessTime:Date.now()}),z}static ClearCache(){const E=Array.from(p._InfixToPostfixCache.entries()).sort(((E,t)=>E[1].accessTime-t[1].accessTime));for(let t=0;t<p.InfixToPostfixCacheCleanupSize;t++)p._InfixToPostfixCache.delete(E[t][0])}}p.InfixToPostfixCacheLimitSize=5e4,p.InfixToPostfixCacheCleanupSize=25e3,p._InfixToPostfixCache=new Map,p._OperatorPriority={")":0,"(":1,"||":2,"&&":3},p._Stack=["","","","","","","","","","","","","","","","","","","",""];class C extends p{constructor(E){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=E,this.not=t}isTrue(E){let t=void 0!==E[this.define];return this.not&&(t=!t),t}}class Z extends p{isTrue(E){return this.leftOperand.isTrue(E)||this.rightOperand.isTrue(E)}}class H extends p{isTrue(E){return this.leftOperand.isTrue(E)&&this.rightOperand.isTrue(E)}}class h extends p{constructor(E,t,z){super(),this.define=E,this.operand=t,this.testValue=z}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(E){let t=!1;const z=parseInt(void 0!=E[this.define]?E[this.define]:this.define),A=parseInt(void 0!=E[this.testValue]?E[this.testValue]:this.testValue);if(isNaN(z)||isNaN(A))return!1;switch(this.operand){case">":t=z>A;break;case"<":t=z<A;break;case"<=":t=z<=A;break;case">=":t=z>=A;break;case"==":t=z===A;break;case"!=":t=z!==A}return t}}var d=z(11657),y=z(11700);const O=/defined\s*?\((.+?)\)/g,c=/defined\s*?\[(.+?)\]/g,a=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,L=/__decl__/,mE=/light\{X\}.(\w*)/g,W=/\{X\}/g,I=[],e=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function D(E){E.processor&&E.processor.initializeShaders&&E.processor.initializeShaders(E.processingContext)}function S(E,t,z,A){var X;null!==(X=t.processor)&&void 0!==X&&X.preProcessShaderCode&&(E=t.processor.preProcessShaderCode(E,t.isFragment)),J(E,t,(E=>{t.processCodeAfterIncludes&&(E=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",E,t.defines));const X=function(E,t,z){let A=function(E,t){var z;if(null!==(z=t.processor)&&void 0!==z&&z.noPrecision)return E;const A=t.shouldUseHighPrecisionShader;-1===E.indexOf("precision highp float")?E=A?"precision highp float;\n"+E:"precision mediump float;\n"+E:A||(E=E.replace("precision highp float","precision mediump float"));return E}(E,t);if(!t.processor)return A;if(0===t.processor.shaderLanguage&&-1!==A.indexOf("#version 3")&&(A=A.replace("#version 300 es",""),!t.processor.parseGLES3))return A;const X=t.defines,R=x(t,z);t.processor.preProcessor&&(A=t.processor.preProcessor(A,X,R,t.isFragment,t.processingContext));const u={};A=b(A,R,t,u),t.processor.postProcessor&&(A=t.processor.postProcessor(A,X,t.isFragment,t.processingContext,z?{drawBuffersExtensionDisabled:!z.getCaps().drawBuffersExtension}:{},R,u));null!==z&&void 0!==z&&z._features.needShaderCodeInlining&&(A=z.inlineShaderCode(A));return A}(E,t,A);z(X,E)}))}function l(E,t,z){return z.processor&&z.processor.finalizeShaders?z.processor.finalizeShaders(E,t,z.processingContext):{vertexCode:E,fragmentCode:t}}function f(E){const t=/defined\((.+)\)/.exec(E);if(t&&t.length)return new C(t[1].trim(),"!"===E[0]);const z=["==","!=",">=","<=","<",">"];let A="",X=0;for(A of z)if(X=E.indexOf(A),X>-1)break;if(-1===X)return new C(E);const R=E.substring(0,X).trim(),u=E.substring(X+A.length).trim();return new h(R,A,u)}function K(E,t){const z=new u,A=E.substring(0,t);let X=E.substring(t);return X=X.substring(0,(X.indexOf("//")+1||X.length+1)-1).trim(),z.testExpression="#ifdef"===A?new C(X):"#ifndef"===A?new C(X,!0):function(E){E=E.replace(O,"defined[$1]");const t=p.infixToPostfix(E),z=[];for(const X of t)if("||"!==X&&"&&"!==X)z.push(X);else if(z.length>=2){let E=z[z.length-1],t=z[z.length-2];z.length-=2;const A="&&"==X?new H:new Z;"string"===typeof E&&(E=E.replace(c,"defined($1)")),"string"===typeof t&&(t=t.replace(c,"defined($1)")),A.leftOperand="string"===typeof t?f(t):t,A.rightOperand="string"===typeof E?f(E):E,z.push(A)}let A=z[z.length-1];return"string"===typeof A&&(A=A.replace(c,"defined($1)")),"string"===typeof A?f(A):A}(X),z}function F(E,t,z,X){let R=E.currentLine;for(;B(E,z,X);){R=E.currentLine;const u=R.substring(0,5).toLowerCase();if("#else"===u){const z=new A;return t.children.push(z),void B(E,z,X)}if("#elif"===u){const E=K(R,5);t.children.push(E),z=E}}}function B(E,t,z){for(;E.canRead;){E.lineIndex++;const X=E.currentLine;if(X.indexOf("#")>=0){const A=e.exec(X);if(A&&A.length){switch(A[0]){case"#ifdef":{const A=new R;t.children.push(A);const u=K(X,6);A.children.push(u),F(E,A,u,z);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const A=new R;t.children.push(A);const u=K(X,7);A.children.push(u),F(E,A,u,z);break}case"#if":{const A=new R,u=K(X,3);t.children.push(A),A.children.push(u),F(E,A,u,z);break}}continue}}const u=new A;if(u.line=X,t.children.push(u),"#"===X[0]&&"d"===X[1]){const E=X.replace(";","").split(" ");u.additionalDefineKey=E[1],3===E.length&&(u.additionalDefineValue=E[2])}}return!1}function b(E,t,z,R){const u=new A,p=new X;return p.lineIndex=-1,p.lines=E.split("\n"),B(p,u,R),u.process(t,z,R)}function x(E,t){var z;const A=E.defines,X={};for(const R of A){const E=R.replace("#define","").replace(";","").trim().split(" ");X[E[0]]=E.length>1?E[1]:""}return 0===(null===(z=E.processor)||void 0===z?void 0:z.shaderLanguage)&&(X.GL_ES="true"),X.__VERSION__=E.version,X[E.platformName]="true",(0,y.h)(X,null===t||void 0===t?void 0:t.isNDCHalfZRange,null===t||void 0===t?void 0:t.useReverseDepthBuffer,null===t||void 0===t?void 0:t.useExactSrgbConversions),X}function J(E,t,z){let A;for(I.length=0;null!==(A=a.exec(E));)I.push(A);let X=String(E),R=[E],u=!1;for(const p of I){let E=p[1];if(-1!==E.indexOf("__decl__")&&(E=E.replace(L,""),t.supportsUniformBuffers&&(E=E.replace("Vertex","Ubo").replace("Fragment","Ubo")),E+="Declaration"),!t.includesShadersStore[E]){const A=t.shadersRepository+"ShadersInclude/"+E+".fx";return void V.loadFile(A,(A=>{t.includesShadersStore[E]=A,J(R.join(""),t,z)}))}{let z=t.includesShadersStore[E];if(p[2]){const E=p[3].split(",");for(let t=0;t<E.length;t+=2){const A=new RegExp(E[t],"g"),X=E[t+1];z=z.replace(A,X)}}if(p[4]){const E=p[5];if(-1!==E.indexOf("..")){const A=E.split(".."),X=parseInt(A[0]);let R=parseInt(A[1]),u=z.slice(0);z="",isNaN(R)&&(R=t.indexParameters[A[1]]);for(let E=X;E<R;E++)t.supportsUniformBuffers||(u=u.replace(mE,((E,t)=>t+"{X}"))),z+=u.replace(W,E.toString())+"\n"}else t.supportsUniformBuffers||(z=z.replace(mE,((E,t)=>t+"{X}"))),z=z.replace(W,E)}const A=[];for(const E of R){const t=E.split(p[0]);for(let E=0;E<t.length-1;E++)A.push(t[E]),A.push(z);A.push(t[t.length-1])}R=A,u=u||z.indexOf("#include<")>=0||z.indexOf("#include <")>=0}}I.length=0,X=R.join(""),u?J(X.toString(),t,z):z(X)}const V={loadFile:(E,t,z,A,X,R)=>{throw(0,d.b)("FileTools")}}},11700:(E,t,z)=>{z.d(t,{e:()=>X,g:()=>R,h:()=>p,j:()=>u,k:()=>C});var A=z(11657);z(11634);const X={};function R(E,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(t?t+"\n":"")+E}function u(E,t,z,R,u,p,C){const Z=C||X.loadFile;if(Z){return Z(E,t,z,R,u,p)}throw(0,A.b)("FileTools")}function p(E,t,z,A){if(E)return t?E.IS_NDC_HALF_ZRANGE="":delete E.IS_NDC_HALF_ZRANGE,z?E.USE_REVERSE_DEPTHBUFFER="":delete E.USE_REVERSE_DEPTHBUFFER,void(A?E.USE_EXACT_SRGB_CONVERSIONS="":delete E.USE_EXACT_SRGB_CONVERSIONS);{let E="";return t&&(E+="#define IS_NDC_HALF_ZRANGE"),z&&(E&&(E+="\n"),E+="#define USE_REVERSE_DEPTHBUFFER"),A&&(E&&(E+="\n"),E+="#define USE_EXACT_SRGB_CONVERSIONS"),E}}function C(E,t){let z=arguments.length>2&&void 0!==arguments[2]&&arguments[2],A=arguments.length>3?arguments[3]:void 0;switch(E){case 3:{const E=(ArrayBuffer,new Int8Array(t));return A&&E.set(new Int8Array(A)),E}case 0:{const E=(ArrayBuffer,new Uint8Array(t));return A&&E.set(new Uint8Array(A)),E}case 4:{const E=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(z?t/2:t);return A&&E.set(new Int16Array(A)),E}case 5:case 8:case 9:case 10:case 2:{const E=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(z?t/2:t);return A&&E.set(new Uint16Array(A)),E}case 6:{const E=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(z?t/4:t);return A&&E.set(new Int32Array(A)),E}case 7:case 11:case 12:case 13:case 14:case 15:{const E=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(z?t/4:t);return A&&E.set(new Uint32Array(A)),E}case 1:{const E=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(z?t/4:t);return A&&E.set(new Float32Array(A)),E}}const X=(ArrayBuffer,new Uint8Array(t));return A&&X.set(new Uint8Array(A)),X}},11726:(E,t,z)=>{z.d(t,{d:()=>A});class A{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersRepository:A.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.ShadersStore:A.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?A.IncludesShadersStore:A.IncludesShadersStoreWGSL}}A.ShadersRepository="src/Shaders/",A.ShadersStore={},A.IncludesShadersStore={},A.ShadersRepositoryWGSL="src/ShadersWGSL/",A.ShadersStoreWGSL={},A.IncludesShadersStoreWGSL={}},11737:(E,t,z)=>{z.d(t,{e:()=>d,i:()=>W,k:()=>O,m:()=>y,o:()=>c,p:()=>mE,s:()=>h,t:()=>Z,v:()=>H,w:()=>C,x:()=>p});class A{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.ct._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(E){E&&this.program&&E(this.program)}setEngine(E){this.ct=E}_fillEffectInformation(E,t,z,A,X,R,u,p){const C=this.ct;if(C.supportsUniformBuffers)for(const H in t)E.bindUniformBlock(H,t[H]);let Z;for(this.ct.getUniforms(this,z).forEach(((E,t)=>{A[z[t]]=E})),this._uniforms=A,Z=0;Z<X.length;Z++){null==E.getUniform(X[Z])&&(X.splice(Z,1),Z--)}X.forEach(((E,t)=>{R[E]=t}));for(const H of C.getAttributes(this,u))p.push(H)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(E,t){const z=this._valueCache[E],A=t.updateFlag;return(void 0===z||z!==A)&&(this._valueCache[E]=A,!0)}_cacheFloat2(E,t,z){let A=this._valueCache[E];if(!A||2!==A.length)return A=[t,z],this._valueCache[E]=A,!0;let X=!1;return A[0]!==t&&(A[0]=t,X=!0),A[1]!==z&&(A[1]=z,X=!0),X}_cacheFloat3(E,t,z,A){let X=this._valueCache[E];if(!X||3!==X.length)return X=[t,z,A],this._valueCache[E]=X,!0;let R=!1;return X[0]!==t&&(X[0]=t,R=!0),X[1]!==z&&(X[1]=z,R=!0),X[2]!==A&&(X[2]=A,R=!0),R}_cacheFloat4(E,t,z,A,X){let R=this._valueCache[E];if(!R||4!==R.length)return R=[t,z,A,X],this._valueCache[E]=R,!0;let u=!1;return R[0]!==t&&(R[0]=t,u=!0),R[1]!==z&&(R[1]=z,u=!0),R[2]!==A&&(R[2]=A,u=!0),R[3]!==X&&(R[3]=X,u=!0),u}setInt(E,t){const z=this._valueCache[E];void 0!==z&&z===t||this.ct.setInt(this._uniforms[E],t)&&(this._valueCache[E]=t)}setInt2(E,t,z){this._cacheFloat2(E,t,z)&&(this.ct.setInt2(this._uniforms[E],t,z)||(this._valueCache[E]=null))}setInt3(E,t,z,A){this._cacheFloat3(E,t,z,A)&&(this.ct.setInt3(this._uniforms[E],t,z,A)||(this._valueCache[E]=null))}setInt4(E,t,z,A,X){this._cacheFloat4(E,t,z,A,X)&&(this.ct.setInt4(this._uniforms[E],t,z,A,X)||(this._valueCache[E]=null))}setIntArray(E,t){this._valueCache[E]=null,this.ct.setIntArray(this._uniforms[E],t)}setIntArray2(E,t){this._valueCache[E]=null,this.ct.setIntArray2(this._uniforms[E],t)}setIntArray3(E,t){this._valueCache[E]=null,this.ct.setIntArray3(this._uniforms[E],t)}setIntArray4(E,t){this._valueCache[E]=null,this.ct.setIntArray4(this._uniforms[E],t)}setUInt(E,t){const z=this._valueCache[E];void 0!==z&&z===t||this.ct.setUInt(this._uniforms[E],t)&&(this._valueCache[E]=t)}setUInt2(E,t,z){this._cacheFloat2(E,t,z)&&(this.ct.setUInt2(this._uniforms[E],t,z)||(this._valueCache[E]=null))}setUInt3(E,t,z,A){this._cacheFloat3(E,t,z,A)&&(this.ct.setUInt3(this._uniforms[E],t,z,A)||(this._valueCache[E]=null))}setUInt4(E,t,z,A,X){this._cacheFloat4(E,t,z,A,X)&&(this.ct.setUInt4(this._uniforms[E],t,z,A,X)||(this._valueCache[E]=null))}setUIntArray(E,t){this._valueCache[E]=null,this.ct.setUIntArray(this._uniforms[E],t)}setUIntArray2(E,t){this._valueCache[E]=null,this.ct.setUIntArray2(this._uniforms[E],t)}setUIntArray3(E,t){this._valueCache[E]=null,this.ct.setUIntArray3(this._uniforms[E],t)}setUIntArray4(E,t){this._valueCache[E]=null,this.ct.setUIntArray4(this._uniforms[E],t)}setArray(E,t){this._valueCache[E]=null,this.ct.setArray(this._uniforms[E],t)}setArray2(E,t){this._valueCache[E]=null,this.ct.setArray2(this._uniforms[E],t)}setArray3(E,t){this._valueCache[E]=null,this.ct.setArray3(this._uniforms[E],t)}setArray4(E,t){this._valueCache[E]=null,this.ct.setArray4(this._uniforms[E],t)}setMatrices(E,t){t&&(this._valueCache[E]=null,this.ct.setMatrices(this._uniforms[E],t))}setMatrix(E,t){this._cacheMatrix(E,t)&&(this.ct.setMatrices(this._uniforms[E],t.upE())||(this._valueCache[E]=null))}setMatrix3x3(E,t){this._valueCache[E]=null,this.ct.setMatrix3x3(this._uniforms[E],t)}setMatrix2x2(E,t){this._valueCache[E]=null,this.ct.setMatrix2x2(this._uniforms[E],t)}setFloat(E,t){const z=this._valueCache[E];void 0!==z&&z===t||this.ct.setFloat(this._uniforms[E],t)&&(this._valueCache[E]=t)}setVector2(E,t){this._cacheFloat2(E,t.x,t.y)&&(this.ct.setFloat2(this._uniforms[E],t.x,t.y)||(this._valueCache[E]=null))}setFloat2(E,t,z){this._cacheFloat2(E,t,z)&&(this.ct.setFloat2(this._uniforms[E],t,z)||(this._valueCache[E]=null))}setVector3(E,t){this._cacheFloat3(E,t.x,t.y,t.z)&&(this.ct.setFloat3(this._uniforms[E],t.x,t.y,t.z)||(this._valueCache[E]=null))}setFloat3(E,t,z,A){this._cacheFloat3(E,t,z,A)&&(this.ct.setFloat3(this._uniforms[E],t,z,A)||(this._valueCache[E]=null))}setVector4(E,t){this._cacheFloat4(E,t.x,t.y,t.z,t.w)&&(this.ct.setFloat4(this._uniforms[E],t.x,t.y,t.z,t.w)||(this._valueCache[E]=null))}setQuaternion(E,t){this._cacheFloat4(E,t.x,t.y,t.z,t.w)&&(this.ct.setFloat4(this._uniforms[E],t.x,t.y,t.z,t.w)||(this._valueCache[E]=null))}setFloat4(E,t,z,A,X){this._cacheFloat4(E,t,z,A,X)&&(this.ct.setFloat4(this._uniforms[E],t,z,A,X)||(this._valueCache[E]=null))}setColor3(E,t){this._cacheFloat3(E,t.r,t.g,t.b)&&(this.ct.setFloat3(this._uniforms[E],t.r,t.g,t.b)||(this._valueCache[E]=null))}setColor4(E,t,z){this._cacheFloat4(E,t.r,t.g,t.b,z)&&(this.ct.setFloat4(this._uniforms[E],t.r,t.g,t.b,z)||(this._valueCache[E]=null))}setDirectColor4(E,t){this._cacheFloat4(E,t.r,t.g,t.b,t.a)&&(this.ct.setFloat4(this._uniforms[E],t.r,t.g,t.b,t.a)||(this._valueCache[E]=null))}_getVertexShaderCode(){return this.vertexShader?this.ct._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.ct._getShaderSource(this.fragmentShader):null}}var X=z(11700);const R=new WeakMap,u={_webGLVersion:2,cachedPipelines:{}};function p(E){let t=R.get(E);if(!t){if(!E)return u;t={_webGLVersion:E.TEXTURE_BINDING_3D?2:1,_context:E,parallelShaderCompile:E.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},R.set(E,t)}return t}function C(E){R.delete(E)}function Z(E,t,z,A,X,R){const u=p(A);R||(R=u._createShaderProgramInjection??d);return R(E,L(t,"vertex",A,u._contextWasLost),L(z,"fragment",A,u._contextWasLost),A,X,u.validateShaderPrograms)}function H(E,t,z,A,X){let R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6?arguments[6]:void 0;const C=p(X);u||(u=C._createShaderProgramInjection??d);const Z=C._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return u(E,a(t,"vertex",A,Z,X,C._contextWasLost),a(z,"fragment",A,Z,X,C._contextWasLost),X,R,C.validateShaderPrograms)}function h(E,t){const z=new A,X=p(E);return X.parallelShaderCompile&&!X.disableParallelShaderCompile&&(z.isParallelCompiled=!0),z.context=X._context,z}function d(E,t,z,A){let X=arguments.length>5?arguments[5]:void 0;const R=A.createProgram();if(E.program=R,!R)throw new Error("Unable to create program");return A.attachShader(R,t),A.attachShader(R,z),A.linkProgram(R),E.context=A,E.vertexShader=t,E.fragmentShader=z,E.isParallelCompiled||O(E,A,X),R}function y(E,t,z){const A=E;if(A._isDisposed)return!1;const X=p(t);return!!(X&&X.parallelShaderCompile&&X.parallelShaderCompile.COMPLETION_STATUS_KHR&&A.program&&t.getProgramParameter(A.program,X.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(O(A,t,z),!0)}function O(E,t,z){const A=E.context,X=E.vertexShader,R=E.fragmentShader,u=E.program;if(!A.getProgramParameter(u,A.LINK_STATUS)){if(!t.getShaderParameter(X,t.COMPILE_STATUS)){const z=t.getShaderInfoLog(X);if(z)throw E.vertexCompilationError=z,new Error("VERTEX SHADER "+z)}if(!t.getShaderParameter(R,t.COMPILE_STATUS)){const z=t.getShaderInfoLog(R);if(z)throw E.fragmentCompilationError=z,new Error("FRAGMENT SHADER "+z)}const z=A.getProgramInfoLog(u);if(z)throw E.programLinkError=z,new Error(z)}if(z){A.validateProgram(u);if(!A.getProgramParameter(u,A.VALIDATE_STATUS)){const t=A.getProgramInfoLog(u);if(t)throw E.programValidationError=t,new Error(t)}}A.deleteShader(X),A.deleteShader(R),E.vertexShader=void 0,E.fragmentShader=void 0,E.onCompiled&&(E.onCompiled(),E.onCompiled=void 0)}function c(E,t,z,A,X,R,u,C,h){let d=arguments.length>10?arguments[10]:void 0,y=arguments.length>11?arguments[11]:void 0,O=arguments.length>12?arguments[12]:void 0;const c=p(E.context);y||(y=c.createRawShaderProgramInjection??Z),O||(O=c.createShaderProgramInjection??H);const a=E;a.program=A?y(a,t,z,a.context,h):O(a,t,z,C,a.context,h),a.program.__SPECTOR_rebuildProgram=u,d()}function a(E,t,z,A,R,u){return L((0,X.g)(E,z,A),t,R,u)}function L(E,t,z,A){const X=z.createShader("vertex"===t?z.VERTEX_SHADER:z.FRAGMENT_SHADER);if(!X){let E=z.NO_ERROR,X=z.NO_ERROR;for(;(X=z.getError())!==z.NO_ERROR;)E=X;throw new Error(`Something went wrong while creating a gl ${t} shader object. gl error=${E}, gl isContextLost=${z.isContextLost()}, _contextWasLost=${A}`)}return z.shaderSource(X,E),z.compileShader(X),X}function mE(E,t){t.useProgram(E)}function W(E,t){const z=E;if(!z.isParallelCompiled)return void t(E);const A=z.onCompiled;z.onCompiled=()=>{null===A||void 0===A||A(),t(E)}}},11729:(E,t,z)=>{z.d(t,{e:()=>h,h:()=>y,l:()=>Z,o:()=>H});var A=z(11634),X=z(11737),R=z(11726),u=z(11640),p=z(11695),C=z(11700);function Z(E,t){return(0,X.x)(t).cachedPipelines[E]}function H(E){const t=E._name,z=E.context;if(t&&z){const E=(0,X.x)(z),A=E.cachedPipelines[t];null===A||void 0===A||A.dispose(),delete E.cachedPipelines[t]}}function h(E,t,z,X,R,u,C){let Z,H;const h=(0,A.m)()?null===u||void 0===u?void 0:u.getHostDocument():null;Z="string"===typeof t?t:t.vertexSource?"source:"+t.vertexSource:t.vertexElement?(null===h||void 0===h?void 0:h.getElementById(t.vertexElement))||t.vertexElement:t.vertex||t,H="string"===typeof t?t:t.fragmentSource?"source:"+t.fragmentSource:t.fragmentElement?(null===h||void 0===h?void 0:h.getElementById(t.fragmentElement))||t.fragmentElement:t.fragment||t;const y=[void 0,void 0],O=()=>{if(y[0]&&y[1]){E.isFragment=!0;const[A,Z]=y;(0,p.h)(Z,E,((u,Z)=>{C&&(C._fragmentSourceCodeBeforeMigration=Z),z&&(u=z("fragment",u));const H=(0,p.e)(A,u,E);E=null;const h=function(E,t,z,A){if(z){return{vertexSourceCode:(1===A?"//":"")+"#define SHADER_NAME vertex:"+(z.vertexElement||z.vertex||z.spectorName||z)+"\n"+E,fragmentSourceCode:(1===A?"//":"")+"#define SHADER_NAME fragment:"+(z.fragmentElement||z.fragment||z.spectorName||z)+"\n"+t}}return{vertexSourceCode:E,fragmentSourceCode:t}}(H.vertexCode,H.fragmentCode,t,R);null===X||void 0===X||X(h.vertexSourceCode,h.fragmentSourceCode)}),u)}};d(Z,"Vertex","",(t=>{(0,p.f)(E),(0,p.h)(t,E,((E,A)=>{C&&(C._rawVertexSourceCode=t,C._vertexSourceCodeBeforeMigration=A),z&&(E=z("vertex",E)),y[0]=E,O()}),u)}),R),d(H,"Fragment","Pixel",(E=>{C&&(C._rawFragmentSourceCode=E),y[1]=E,O()}),R)}function d(E,t,z,X,u,p){if("undefined"!==typeof HTMLElement&&E instanceof HTMLElement){return void X((0,A.b)(E))}if("source:"===E.substring(0,7))return void X(E.substring(7));if("base64:"===E.substring(0,7)){return void X(window.atob(E.substring(7)))}const Z=R.d.GetShadersStore(u);if(Z[E+t+"Shader"])return void X(Z[E+t+"Shader"]);if(z&&Z[E+z+"Shader"])return void X(Z[E+z+"Shader"]);let H;if(H="."===E[0]||"/"===E[0]||E.indexOf("http")>-1?E:R.d.GetShadersRepository(u)+E,!(p=p||C.j))throw new Error("loadFileInjection is not defined");p(H+"."+t.toLowerCase()+".fx",X)}const y=(E,t,z,A)=>{try{const R=E.context?(0,X.x)(E.context):null;R&&(R.disableParallelShaderCompile=E.disableParallelCompilation);const u=E.existingPipelineContext||t(E.shaderProcessingContext);return u._name=E.name,E.name&&R&&(R.cachedPipelines[E.name]=u),z(u,E.vertex,E.fragment,!!E.createAsRaw,"","",E.rebuildRebind,E.defines,E.transformFeedbackVaryings,"",(()=>{A(u,(()=>{var t;null===(t=E.onRenderingStateCompiled)||void 0===t||t.call(E,u)}))})),u}catch(R){throw u.d.Error("Error compiling effect"),R}}},11717:(E,t,z)=>{z.r(t),z.d(t,{Effect:()=>C});var A=z(11632),X=z(11640),R=z(11726),u=z(11729),p=z(11707);class C{static get ShadersRepository(){return R.d.ShadersRepository}static set ShadersRepository(E){R.d.ShadersRepository=E}get C(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new A.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(E,t,z){let X=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,R=arguments.length>4?arguments[4]:void 0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,Z=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,H=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,d=arguments.length>9?arguments[9]:void 0,y=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",O=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,c=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new A.b,this.onErrorObservable=new A.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=E,this._key=y;const a=this._key.replace(/\r/g,"").replace(/\n/g,"|");let L;if(t.attributes){const E=t;if(this._engine=z,this._attributesNames=E.attributes,this._uniformsNames=E.uniformsNames.concat(E.samplers),this._samplerList=E.samplers.slice(),this.defines=E.defines,this.onError=E.onError,this.onCompiled=E.onCompiled,this._fallbacks=E.fallbacks,this._indexParameters=E.indexParameters,this._transformFeedbackVaryings=E.transformFeedbackVaryings||null,this._multiTarget=!!E.multiTarget,this._shaderLanguage=E.shaderLanguage??0,this._disableParallelShaderCompilation=!!E.disableParallelShaderCompilation,E.uniformBuffersNames){this._uniformBuffersNamesList=E.uniformBuffersNames.slice();for(let t=0;t<E.uniformBuffersNames.length;t++)this._uniformBuffersNames[E.uniformBuffersNames[t]]=t}this._processFinalCode=E.processFinalCode??null,this._processCodeAfterIncludes=E.processCodeAfterIncludes??void 0,c=E.extraInitializationsAsync,L=E.existingPipelineContext}else this._engine=R,this.defines=null==p?"":p,this._uniformsNames=z.concat(X),this._samplerList=X?X.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=O,this.onError=h,this.onCompiled=H,this._indexParameters=d,this._fallbacks=Z;"WEBGL2"===this._engine.shaderPlatformName&&(L=(0,u.l)(a,this._engine._gl)??L),this._attributeLocationByName={},this.uniqueId=C._UniqueIdSeed++,L?(this._pipelineContext=L,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,c),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.C||this.dispose(!0)}))}async _processShaderCodeAsync(){let E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,A=arguments.length>3?arguments[3]:void 0;A&&await A(),this._processingContext=z||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const X={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:E??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:R.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:R.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,u.e)(X,this.name,this._processFinalCode,((E,z)=>{this._vertexSourceCode=E,this._fragmentSourceCode=z,this._prepareEffect(t)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.C||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(E){return this._attributes[E]}getAttributeLocationByName(E){return this._attributeLocationByName[E]}getAttributesCount(){return this._attributes.length}getUniformIndex(E){return this._uniformsNames.indexOf(E)}getUniform(E){return this._uniforms[E]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((E=>{this.executeWhenCompiled(E)}))}executeWhenCompiled(E){this.isReady()?E(this):(this.onCompileObservable.add((t=>{E(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(E){(0,p.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(t=>{this._processCompilationErrors(t,E)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var E;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(E=this._pipelineContext)||void 0===E?void 0:E._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var E;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(E=this._pipelineContext)||void 0===E?void 0:E._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(E,t,z,A){this._isReady=!1,this._vertexSourceCodeOverride=E,this._fragmentSourceCodeOverride=t,this.onError=(E,t)=>{A&&A(t)},this.onCompiled=()=>{var E,t;const A=this.getEngine().scenes;if(A)for(let z=0;z<A.length;z++)A[z].markAllMaterialsAsDirty(127);null===(E=(t=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===E||E.call(t,z)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(E){if(this._pipelineContext=E,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let t=0;t<this._attributesNames.length;t++){const E=this._attributesNames[t];this._attributeLocationByName[E]=this._attributes[t]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),C.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let E=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this._pipelineContext;this._isReady=!1;try{const z=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),A=z?null:this.defines,X=z?this._vertexSourceCodeOverride:this._vertexSourceCode,R=z?this._fragmentSourceCodeOverride:this._fragmentSourceCode,p=this._engine;this._pipelineContext=(0,u.h)({existingPipelineContext:E?t:null,vertex:X,fragment:R,context:"WEBGL2"===p.shaderPlatformName||"WEBGL1"===p.shaderPlatformName?p._gl:void 0,rebuildRebind:(E,t,z,A)=>this._rebuildProgram(E,t,z,A),defines:A,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:z,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:z=>{t&&!E&&this._engine._deletePipelineContext(t),z&&this._onRenderingStateCompiled(z)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(t)}catch(z){this._processCompilationErrors(z,t)}}_getShaderCodeAndErrorLine(E,t,z){const A=z?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let X=null;if(t&&E){const R=t.match(A);if(R&&2===R.length){const t=parseInt(R[1]),A=E.split("\n",-1);A.length>=t&&(X=`Offending line [${t}] in ${z?"fragment":"vertex"} code: ${A[t-1]}`)}}return[E,X]}_processCompilationErrors(E){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=E.message;const z=this._attributesNames,A=this._fallbacks;if(X.d.Error("Unable to compile effect:"),X.d.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),X.d.Error(`Attributes: ${z.join(" ")}`),X.d.Error("Defines:\n"+this.defines),C.LogShaderCodeOnCompilationError){var R,u;let E=null,t=null,z=null;var p;if(null!==(R=this._pipelineContext)&&void 0!==R&&R._getVertexShaderCode()&&([z,E]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),z&&(X.d.Error("Vertex code:"),X.d.Error(z))),null!==(u=this._pipelineContext)&&void 0!==u&&u._getFragmentShaderCode())[z,t]=this._getShaderCodeAndErrorLine(null===(p=this._pipelineContext)||void 0===p?void 0:p._getFragmentShaderCode(),this._compilationError,!0),z&&(X.d.Error("Fragment code:"),X.d.Error(z));E&&X.d.Error(E),t&&X.d.Error(t)}X.d.Error("Error: "+this._compilationError);const Z=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};t&&(this._pipelineContext=t,this._isReady=!0,Z()),A?(this._pipelineContext=null,A.hasMoreFallbacks?(this._allFallbacksProcessed=!1,X.d.Error("Trying next fallback."),this.defines=A.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,Z(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,t||Z())}get isSupported(){return""===this._compilationError}_bindTexture(E,t){this._engine._bindTexture(this._samplers[E],t,E)}setTexture(E,t){this._engine.setTexture(this._samplers[E],this._uniforms[E],t,E)}setTextureArray(E,t){const z=E+"Ex";if(-1===this._samplerList.indexOf(z+"0")){const A=this._samplerList.indexOf(E);for(let E=1;E<t.length;E++){const t=z+(E-1).toString();this._samplerList.splice(A+E,0,t)}let X=0;for(const E of this._samplerList)this._samplers[E]=X,X+=1}this._engine.setTextureArray(this._samplers[E],this._uniforms[E],t,E)}bindUniformBuffer(E,t){const z=this._uniformBuffersNames[t];void 0===z||C._BaseCache[z]===E&&this._engine._features.useUBOBindingCache||(C._BaseCache[z]=E,this._engine.bindUniformBufferBase(E,z,t))}bindUniformBlock(E,t){this._engine.bindUniformBlock(this._pipelineContext,E,t)}setInt(E,t){return this._pipelineContext.setInt(E,t),this}setInt2(E,t,z){return this._pipelineContext.setInt2(E,t,z),this}setInt3(E,t,z,A){return this._pipelineContext.setInt3(E,t,z,A),this}setInt4(E,t,z,A,X){return this._pipelineContext.setInt4(E,t,z,A,X),this}setIntArray(E,t){return this._pipelineContext.setIntArray(E,t),this}setIntArray2(E,t){return this._pipelineContext.setIntArray2(E,t),this}setIntArray3(E,t){return this._pipelineContext.setIntArray3(E,t),this}setIntArray4(E,t){return this._pipelineContext.setIntArray4(E,t),this}setUInt(E,t){return this._pipelineContext.setUInt(E,t),this}setUInt2(E,t,z){return this._pipelineContext.setUInt2(E,t,z),this}setUInt3(E,t,z,A){return this._pipelineContext.setUInt3(E,t,z,A),this}setUInt4(E,t,z,A,X){return this._pipelineContext.setUInt4(E,t,z,A,X),this}setUIntArray(E,t){return this._pipelineContext.setUIntArray(E,t),this}setUIntArray2(E,t){return this._pipelineContext.setUIntArray2(E,t),this}setUIntArray3(E,t){return this._pipelineContext.setUIntArray3(E,t),this}setUIntArray4(E,t){return this._pipelineContext.setUIntArray4(E,t),this}setFloatArray(E,t){return this._pipelineContext.setArray(E,t),this}setFloatArray2(E,t){return this._pipelineContext.setArray2(E,t),this}setFloatArray3(E,t){return this._pipelineContext.setArray3(E,t),this}setFloatArray4(E,t){return this._pipelineContext.setArray4(E,t),this}setArray(E,t){return this._pipelineContext.setArray(E,t),this}setArray2(E,t){return this._pipelineContext.setArray2(E,t),this}setArray3(E,t){return this._pipelineContext.setArray3(E,t),this}setArray4(E,t){return this._pipelineContext.setArray4(E,t),this}setMatrices(E,t){return this._pipelineContext.setMatrices(E,t),this}setMatrix(E,t){return this._pipelineContext.setMatrix(E,t),this}setMatrix3x3(E,t){return this._pipelineContext.setMatrix3x3(E,t),this}setMatrix2x2(E,t){return this._pipelineContext.setMatrix2x2(E,t),this}setFloat(E,t){return this._pipelineContext.setFloat(E,t),this}setBool(E,t){return this._pipelineContext.setInt(E,t?1:0),this}setVector2(E,t){return this._pipelineContext.setVector2(E,t),this}setFloat2(E,t,z){return this._pipelineContext.setFloat2(E,t,z),this}setVector3(E,t){return this._pipelineContext.setVector3(E,t),this}setFloat3(E,t,z,A){return this._pipelineContext.setFloat3(E,t,z,A),this}setVector4(E,t){return this._pipelineContext.setVector4(E,t),this}setQuaternion(E,t){return this._pipelineContext.setQuaternion(E,t),this}setFloat4(E,t,z,A,X){return this._pipelineContext.setFloat4(E,t,z,A,X),this}setColor3(E,t){return this._pipelineContext.setColor3(E,t),this}setColor4(E,t,z){return this._pipelineContext.setColor4(E,t,z),this}setDirectColor4(E,t){return this._pipelineContext.setDirectColor4(E,t),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(C.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,u.o)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(E,t,z){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t&&(R.d.GetShadersStore(A)[`${E}PixelShader`]=t),z&&(R.d.GetShadersStore(A)[`${E}VertexShader`]=z)}static ResetCache(){C._BaseCache={}}}C.LogShaderCodeOnCompilationError=!0,C.PersistentMode=!1,C.AutomaticallyClearCodeCache=!1,C._UniqueIdSeed=0,C._BaseCache={},C.ShadersStore=R.d.ShadersStore,C.IncludesShadersStore=R.d.IncludesShadersStore},11657:(E,t,z)=>{z.d(t,{b:()=>X});const A={};function X(E){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!A[E])return A[E]=!0,`${E} needs to be imported before as it contains a side-effect required by your code.`}},11634:(E,t,z)=>{function A(){return"undefined"!==typeof window}function X(){return"undefined"!==typeof navigator}function R(){return"undefined"!==typeof document}function u(E){let t="",z=E.firstChild;for(;z;)3===z.nodeType&&(t+=z.textContent),z=z.nextSibling;return t}z.d(t,{b:()=>u,e:()=>R,i:()=>X,m:()=>A})},11640:(E,t,z)=>{z.d(t,{d:()=>A});class A{static _CheckLimit(E,t){let z=A._LogLimitOutputs[E];return z?z.current++:(z={limit:t,current:1},A._LogLimitOutputs[E]=z),z.current<=z.limit}static _GenerateLimitMessage(E){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const z=A._LogLimitOutputs[E];if(!z||!A.MessageLimitReached)return;const X=this._Levels[t];z.current===z.limit&&A[X.name](A.MessageLimitReached.replace(/%LIMIT%/g,""+z.limit).replace(/%TYPE%/g,X.name??""))}static _AddLogEntry(E){A._LogCache=E+A._LogCache,A.OnNewCacheEntry&&A.OnNewCacheEntry(E)}static _FormatMessage(E){const t=E=>E<10?"0"+E:""+E,z=new Date;return"["+t(z.getHours())+":"+t(z.getMinutes())+":"+t(z.getSeconds())+"]: "+E}static _LogDisabled(E,t){}static _LogEnabled(){let E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,z=arguments.length>2?arguments[2]:void 0;const X=Array.isArray(t)?t[0]:t;if(void 0!==z&&!A._CheckLimit(X,z))return;const R=A._FormatMessage(X),u=this._Levels[E],p=Array.isArray(t)?t.slice(1):[];u.logFunc&&u.logFunc("BJS - "+R,...p);const C=`<div style='color:${u.color}'>${R}</div><br>`;A._AddLogEntry(C),A._GenerateLimitMessage(X,E)}static get LogCache(){return A._LogCache}static ClearLogCache(){A._LogCache="",A._LogLimitOutputs={},A.errorsCount=0}static set LogLevels(E){A.Log=A._LogDisabled,A.Warn=A._LogDisabled,A.Error=A._LogDisabled;const t=[A.MessageLogLevel,A.WarningLogLevel,A.ErrorLogLevel];for(const z of t)if((E&z)===z){const E=this._Levels[z];A[E.name]=A._LogEnabled.bind(A,z)}}}A.NoneLogLevel=0,A.MessageLogLevel=1,A.WarningLogLevel=2,A.ErrorLogLevel=4,A.AllLogLevel=7,A.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",A._LogCache="",A._LogLimitOutputs={},A._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],A.errorsCount=0,A.Log=A._LogEnabled.bind(A,A.MessageLogLevel),A.Warn=A._LogEnabled.bind(A,A.WarningLogLevel),A.Error=A._LogEnabled.bind(A,A.ErrorLogLevel)},11632:(E,t,z)=>{z.d(t,{b:()=>u});const A="undefined"!==typeof WeakRef;class X{constructor(E){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;this.initialize(E,t,z,A)}initialize(E){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0;return this.mask=E,this.skipNextObservers=t,this.target=z,this.currentTarget=A,this}}class R{constructor(E,t){let z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=E,this.mask=t,this.scope=z,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let E=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(E)}}class u{static FromPromise(E,t){const z=new u;return E.then((E=>{z.notifyObservers(E)})).catch((E=>{if(!t)throw E;t.notifyObservers(E)})),z}get observers(){return this._observers}constructor(E){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=t,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new X(0),E&&(this._onObserverAdded=E)}add(E){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],z=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!E)return null;const X=new R(E,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);X.unregisterOnNextCall=z,t?this._observers.unshift(X):this._observers.push(X),this._onObserverAdded&&this._onObserverAdded(X),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(X,this._lastNotifiedValue);const u=A?new WeakRef(this):{deref:()=>this};return X._remove=function(){let E=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=u.deref();t&&(E?t.remove(X):t._remove(X))},X}addOnce(E){return this.add(E,void 0,void 0,void 0,!0)}remove(E){if(!E)return!1;E._remove=null;return-1!==this._observers.indexOf(E)&&(this._deferUnregister(E),!0)}removeCallback(E,t){for(let z=0;z<this._observers.length;z++){const A=this._observers[z];if(!A._willBeUnregistered&&(A.callback===E&&(!t||t===A.scope)))return this._deferUnregister(A),!0}return!1}_deferUnregister(E){E._willBeUnregistered||(this._numObserversMarkedAsDeleted++,E.unregisterOnNextCall=!1,E._willBeUnregistered=!0,setTimeout((()=>{this._remove(E)}),0))}_remove(E){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!E)return!1;const z=this._observers.indexOf(E);return-1!==z&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(z,1),!0)}makeObserverTopPriority(E){this._remove(E,!1),this._observers.unshift(E)}makeObserverBottomPriority(E){this._remove(E,!1),this._observers.push(E)}notifyObservers(E){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,z=arguments.length>2?arguments[2]:void 0,A=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=E),!this._observers.length)return!0;const R=this._eventState;R.mask=t,R.target=z,R.currentTarget=A,R.skipNextObservers=!1,R.lastReturnValue=E,R.userInfo=X;for(const u of this._observers)if(!u._willBeUnregistered&&(u.mask&t&&(u.unregisterOnNextCall&&this._deferUnregister(u),u.scope?R.lastReturnValue=u.callback.apply(u.scope,[E,R]):R.lastReturnValue=u.callback(E,R)),R.skipNextObservers))return!1;return!0}notifyObserver(E,t){let z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),E._willBeUnregistered)return;const A=this._eventState;A.mask=z,A.skipNextObservers=!1,E.unregisterOnNextCall&&this._deferUnregister(E),E.callback(t,A)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const E=this._observers.pop();E&&(E._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const E=new u;return E._observers=this._observers.slice(0),E}hasSpecificMask(){let E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const t of this._observers)if(t.mask&E||t.mask===E)return!0;return!1}}},11707:(E,t,z)=>{z.d(t,{c:()=>X,e:()=>u});let A=[];class X{static SetImmediate(E){0===A.length&&setTimeout((()=>{const E=A;A=[];for(const t of E)t()}),1),A.push(E)}}function R(E,t,z){try{if(E())return t(),!0}catch(A){return null===z||void 0===z||z(A),!0}return!1}const u=function(E,t,z){let A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,u=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&R(E,t,z))return null;const p=setInterval((()=>{R(E,t,z)?clearInterval(p):(X-=A,X<0&&(clearInterval(p),null===z||void 0===z||z(new Error("Operation timed out after maximum retries. "+(u||"")),!0)))}),A);return()=>clearInterval(p)}}}]);