"use strict";(self.bbj0x35f849=self.bbj0x35f849||[]).push([[9],{11016:(N,q,C)=>{C.d(q,{e:()=>T,i:()=>j,n:()=>l,k:()=>Y,q:()=>E});class d{constructor(){this.children=[]}isValid(N){return!0}process(N,q,C){let d="";if(this.line){let C=this.line;const n=q.processor;if(n){var U,W,a,F,w,A;n.lineProcessor&&(C=n.lineProcessor(C,q.isFragment,q.processingContext));const d=(null===(U=q.processor)||void 0===U?void 0:U.attributeKeywordName)??"attribute",t=q.isFragment&&null!==(W=q.processor)&&void 0!==W&&W.varyingFragmentKeywordName?null===(a=q.processor)||void 0===a?void 0:a.varyingFragmentKeywordName:!q.isFragment&&null!==(F=q.processor)&&void 0!==F&&F.varyingVertexKeywordName?null===(w=q.processor)||void 0===w?void 0:w.varyingVertexKeywordName:"varying";if(!q.isFragment&&n.attributeProcessor&&this.line.startsWith(d))C=n.attributeProcessor(this.line,N,q.processingContext);else if(n.varyingProcessor&&(null!==(A=n.varyingCheck)&&void 0!==A&&A.call(n,this.line,q.isFragment)||!n.varyingCheck&&this.line.startsWith(t)))C=n.varyingProcessor(this.line,q.isFragment,N,q.processingContext);else if(n.uniformProcessor&&n.uniformRegexp&&n.uniformRegexp.test(this.line))q.lookForClosingBracketForUniformBuffer||(C=n.uniformProcessor(this.line,q.isFragment,N,q.processingContext));else if(n.uniformBufferProcessor&&n.uniformBufferRegexp&&n.uniformBufferRegexp.test(this.line))q.lookForClosingBracketForUniformBuffer||(C=n.uniformBufferProcessor(this.line,q.isFragment,q.processingContext),q.lookForClosingBracketForUniformBuffer=!0);else if(n.textureProcessor&&n.textureRegexp&&n.textureRegexp.test(this.line))C=n.textureProcessor(this.line,q.isFragment,N,q.processingContext);else if((n.uniformProcessor||n.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!q.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?n.uniformProcessor&&(C=n.uniformProcessor(this.line,q.isFragment,N,q.processingContext)):n.uniformBufferProcessor&&(C=n.uniformBufferProcessor(this.line,q.isFragment,q.processingContext),q.lookForClosingBracketForUniformBuffer=!0)}q.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(q.lookForClosingBracketForUniformBuffer=!1,n.endOfUniformBufferProcessor&&(C=n.endOfUniformBufferProcessor(this.line,q.isFragment,q.processingContext)))}d+=C+"\n"}for(const n of this.children)d+=n.process(N,q,C);return this.additionalDefineKey&&(N[this.additionalDefineKey]=this.additionalDefineValue||"true",C[this.additionalDefineKey]=N[this.additionalDefineKey]),d}}class U{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(N){this._lines.length=0;for(const q of N){if(!q||"\r"===q)continue;if("#"===q[0]){this._lines.push(q);continue}const N=q.trim();if(!N)continue;if(N.startsWith("//")){this._lines.push(q);continue}const C=N.indexOf(";");if(-1===C)this._lines.push(N);else if(C===N.length-1)N.length>1&&this._lines.push(N);else{const N=q.split(";");for(let q=0;q<N.length;q++){let C=N[q];C&&(C=C.trim(),C&&this._lines.push(C+(q!==N.length-1?";":"")))}}}}}class W extends d{process(N,q,C){for(let d=0;d<this.children.length;d++){const U=this.children[d];if(U.isValid(N))return U.process(N,q,C)}return""}}class a extends d{isValid(N){return this.testExpression.isTrue(N)}}class F{isTrue(N){return!0}static postfixToInfix(N){const q=[];for(const C of N)if(void 0===F._OperatorPriority[C])q.push(C);else{const N=q[q.length-1],d=q[q.length-2];q.length-=2,q.push(`(${d}${C}${N})`)}return q[q.length-1]}static infixToPostfix(N){const q=F._InfixToPostfixCache.get(N);if(q)return q.accessTime=Date.now(),q.result;if(!N.includes("&&")&&!N.includes("||")&&!N.includes(")")&&!N.includes("("))return[N];const C=[];let d=-1;const U=()=>{n=n.trim(),""!==n&&(C.push(n),n="")},W=N=>{d<F._Stack.length-1&&(F._Stack[++d]=N)},a=()=>F._Stack[d],w=()=>-1===d?"!!INVALID EXPRESSION!!":F._Stack[d--];let A=0,n="";for(;A<N.length;){const q=N.charAt(A),t=A<N.length-1?N.substring(A,2+A):"";if("("===q)n="",W(q);else if(")"===q){for(U();-1!==d&&"("!==a();)C.push(w());w()}else if(F._OperatorPriority[t]>1){for(U();-1!==d&&F._OperatorPriority[a()]>=F._OperatorPriority[t];)C.push(w());W(t),A++}else n+=q;A++}for(U();-1!==d;)"("===a()?w():C.push(w());return F._InfixToPostfixCache.size>=F.InfixToPostfixCacheLimitSize&&F.ClearCache(),F._InfixToPostfixCache.set(N,{result:C,accessTime:Date.now()}),C}static ClearCache(){const N=Array.from(F._InfixToPostfixCache.entries()).sort(((N,q)=>N[1].accessTime-q[1].accessTime));for(let q=0;q<F.InfixToPostfixCacheCleanupSize;q++)F._InfixToPostfixCache.delete(N[q][0])}}F.InfixToPostfixCacheLimitSize=5e4,F.InfixToPostfixCacheCleanupSize=25e3,F._InfixToPostfixCache=new Map,F._OperatorPriority={")":0,"(":1,"||":2,"&&":3},F._Stack=["","","","","","","","","","","","","","","","","","","",""];class w extends F{constructor(N){let q=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=N,this.not=q}isTrue(N){let q=void 0!==N[this.define];return this.not&&(q=!q),q}}class A extends F{isTrue(N){return this.leftOperand.isTrue(N)||this.rightOperand.isTrue(N)}}class n extends F{isTrue(N){return this.leftOperand.isTrue(N)&&this.rightOperand.isTrue(N)}}class t extends F{constructor(N,q,C){super(),this.define=N,this.operand=q,this.testValue=C}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(N){let q=!1;const C=parseInt(void 0!=N[this.define]?N[this.define]:this.define),d=parseInt(void 0!=N[this.testValue]?N[this.testValue]:this.testValue);if(isNaN(C)||isNaN(d))return!1;switch(this.operand){case">":q=C>d;break;case"<":q=C<d;break;case"<=":q=C<=d;break;case">=":q=C>=d;break;case"==":q=C===d;break;case"!=":q=C!==d}return q}}var V=C(10985),Z=C(11025);const J=/defined\s*?\((.+?)\)/g,Q=/defined\s*?\[(.+?)\]/g,v=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,r=/__decl__/,O=/light\{X\}.(\w*)/g,K=/\{X\}/g,i=[],I=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function j(N){N.processor&&N.processor.initializeShaders&&N.processor.initializeShaders(N.processingContext)}function l(N,q,C,d){var U;null!==(U=q.processor)&&void 0!==U&&U.preProcessShaderCode&&(N=q.processor.preProcessShaderCode(N,q.isFragment)),Y(N,q,(N=>{q.processCodeAfterIncludes&&(N=q.processCodeAfterIncludes(q.isFragment?"fragment":"vertex",N,q.defines));const U=function(N,q,C){let d=function(N,q){var C;if(null!==(C=q.processor)&&void 0!==C&&C.noPrecision)return N;const d=q.shouldUseHighPrecisionShader;-1===N.indexOf("precision highp float")?N=d?"precision highp float;\n"+N:"precision mediump float;\n"+N:d||(N=N.replace("precision highp float","precision mediump float"));return N}(N,q);if(!q.processor)return d;if(0===q.processor.shaderLanguage&&-1!==d.indexOf("#version 3")&&(d=d.replace("#version 300 es",""),!q.processor.parseGLES3))return d;const U=q.defines,W=M(q,C);q.processor.preProcessor&&(d=q.processor.preProcessor(d,U,W,q.isFragment,q.processingContext));const a={};d=P(d,W,q,a),q.processor.postProcessor&&(d=q.processor.postProcessor(d,U,q.isFragment,q.processingContext,C?{drawBuffersExtensionDisabled:!C.getCaps().drawBuffersExtension}:{},W,a));null!==C&&void 0!==C&&C._features.needShaderCodeInlining&&(d=C.inlineShaderCode(d));return d}(N,q,d);C(U,N)}))}function T(N,q,C){return C.processor&&C.processor.finalizeShaders?C.processor.finalizeShaders(N,q,C.processingContext):{vertexCode:N,fragmentCode:q}}function z(N){const q=/defined\((.+)\)/.exec(N);if(q&&q.length)return new w(q[1].trim(),"!"===N[0]);const C=["==","!=",">=","<=","<",">"];let d="",U=0;for(d of C)if(U=N.indexOf(d),U>-1)break;if(-1===U)return new w(N);const W=N.substring(0,U).trim(),a=N.substring(U+d.length).trim();return new t(W,d,a)}function p(N,q){const C=new a,d=N.substring(0,q);let U=N.substring(q);return U=U.substring(0,(U.indexOf("//")+1||U.length+1)-1).trim(),C.testExpression="#ifdef"===d?new w(U):"#ifndef"===d?new w(U,!0):function(N){N=N.replace(J,"defined[$1]");const q=F.infixToPostfix(N),C=[];for(const U of q)if("||"!==U&&"&&"!==U)C.push(U);else if(C.length>=2){let N=C[C.length-1],q=C[C.length-2];C.length-=2;const d="&&"==U?new n:new A;"string"===typeof N&&(N=N.replace(Q,"defined($1)")),"string"===typeof q&&(q=q.replace(Q,"defined($1)")),d.leftOperand="string"===typeof q?z(q):q,d.rightOperand="string"===typeof N?z(N):N,C.push(d)}let d=C[C.length-1];return"string"===typeof d&&(d=d.replace(Q,"defined($1)")),"string"===typeof d?z(d):d}(U),C}function s(N,q,C,U){let W=N.currentLine;for(;X(N,C,U);){W=N.currentLine;const a=W.substring(0,5).toLowerCase();if("#else"===a){const C=new d;return q.children.push(C),void X(N,C,U)}if("#elif"===a){const N=p(W,5);q.children.push(N),C=N}}}function X(N,q,C){for(;N.canRead;){N.lineIndex++;const U=N.currentLine;if(U.indexOf("#")>=0){const d=I.exec(U);if(d&&d.length){switch(d[0]){case"#ifdef":{const d=new W;q.children.push(d);const a=p(U,6);d.children.push(a),s(N,d,a,C);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const d=new W;q.children.push(d);const a=p(U,7);d.children.push(a),s(N,d,a,C);break}case"#if":{const d=new W,a=p(U,3);q.children.push(d),d.children.push(a),s(N,d,a,C);break}}continue}}const a=new d;if(a.line=U,q.children.push(a),"#"===U[0]&&"d"===U[1]){const N=U.replace(";","").split(" ");a.additionalDefineKey=N[1],3===N.length&&(a.additionalDefineValue=N[2])}}return!1}function P(N,q,C,W){const a=new d,F=new U;return F.lineIndex=-1,F.lines=N.split("\n"),X(F,a,W),a.process(q,C,W)}function M(N,q){var C;const d=N.defines,U={};for(const W of d){const N=W.replace("#define","").replace(";","").trim().split(" ");U[N[0]]=N.length>1?N[1]:""}return 0===(null===(C=N.processor)||void 0===C?void 0:C.shaderLanguage)&&(U.GL_ES="true"),U.__VERSION__=N.version,U[N.platformName]="true",(0,Z.g)(U,null===q||void 0===q?void 0:q.isNDCHalfZRange,null===q||void 0===q?void 0:q.useReverseDepthBuffer,null===q||void 0===q?void 0:q.useExactSrgbConversions),U}function Y(N,q,C){let d;for(i.length=0;null!==(d=v.exec(N));)i.push(d);let U=String(N),W=[N],a=!1;for(const F of i){let N=F[1];if(-1!==N.indexOf("__decl__")&&(N=N.replace(r,""),q.supportsUniformBuffers&&(N=N.replace("Vertex","Ubo").replace("Fragment","Ubo")),N+="Declaration"),!q.includesShadersStore[N]){const d=q.shadersRepository+"ShadersInclude/"+N+".fx";return void E.loadFile(d,(d=>{q.includesShadersStore[N]=d,Y(W.join(""),q,C)}))}{let C=q.includesShadersStore[N];if(F[2]){const N=F[3].split(",");for(let q=0;q<N.length;q+=2){const d=new RegExp(N[q],"g"),U=N[q+1];C=C.replace(d,U)}}if(F[4]){const N=F[5];if(-1!==N.indexOf("..")){const d=N.split(".."),U=parseInt(d[0]);let W=parseInt(d[1]),a=C.slice(0);C="",isNaN(W)&&(W=q.indexParameters[d[1]]);for(let N=U;N<W;N++)q.supportsUniformBuffers||(a=a.replace(O,((N,q)=>q+"{X}"))),C+=a.replace(K,N.toString())+"\n"}else q.supportsUniformBuffers||(C=C.replace(O,((N,q)=>q+"{X}"))),C=C.replace(K,N)}const d=[];for(const N of W){const q=N.split(F[0]);for(let N=0;N<q.length-1;N++)d.push(q[N]),d.push(C);d.push(q[q.length-1])}W=d,a=a||C.indexOf("#include<")>=0||C.indexOf("#include <")>=0}}i.length=0,U=W.join(""),a?Y(U.toString(),q,C):C(U)}const E={loadFile:(N,q,C,d,U,W)=>{throw(0,V.b)("FileTools")}}},11025:(N,q,C)=>{C.d(q,{b:()=>U,d:()=>W,g:()=>F,i:()=>a,j:()=>w});var d=C(10985);C(10953);const U={};function W(N,q){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(q?q+"\n":"")+N}function a(N,q,C,W,a,F,w){const A=w||U.loadFile;if(A){return A(N,q,C,W,a,F)}throw(0,d.b)("FileTools")}function F(N,q,C,d){if(N)return q?N.IS_NDC_HALF_ZRANGE="":delete N.IS_NDC_HALF_ZRANGE,C?N.USE_REVERSE_DEPTHBUFFER="":delete N.USE_REVERSE_DEPTHBUFFER,void(d?N.USE_EXACT_SRGB_CONVERSIONS="":delete N.USE_EXACT_SRGB_CONVERSIONS);{let N="";return q&&(N+="#define IS_NDC_HALF_ZRANGE"),C&&(N&&(N+="\n"),N+="#define USE_REVERSE_DEPTHBUFFER"),d&&(N&&(N+="\n"),N+="#define USE_EXACT_SRGB_CONVERSIONS"),N}}function w(N,q){let C=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=arguments.length>3?arguments[3]:void 0;switch(N){case 3:{const N=(ArrayBuffer,new Int8Array(q));return d&&N.set(new Int8Array(d)),N}case 0:{const N=(ArrayBuffer,new Uint8Array(q));return d&&N.set(new Uint8Array(d)),N}case 4:{const N=q instanceof ArrayBuffer?new Int16Array(q):new Int16Array(C?q/2:q);return d&&N.set(new Int16Array(d)),N}case 5:case 8:case 9:case 10:case 2:{const N=q instanceof ArrayBuffer?new Uint16Array(q):new Uint16Array(C?q/2:q);return d&&N.set(new Uint16Array(d)),N}case 6:{const N=q instanceof ArrayBuffer?new Int32Array(q):new Int32Array(C?q/4:q);return d&&N.set(new Int32Array(d)),N}case 7:case 11:case 12:case 13:case 14:case 15:{const N=q instanceof ArrayBuffer?new Uint32Array(q):new Uint32Array(C?q/4:q);return d&&N.set(new Uint32Array(d)),N}case 1:{const N=q instanceof ArrayBuffer?new Float32Array(q):new Float32Array(C?q/4:q);return d&&N.set(new Float32Array(d)),N}}const U=(ArrayBuffer,new Uint8Array(q));return d&&U.set(new Uint8Array(d)),U}},11036:(N,q,C)=>{C.d(q,{c:()=>d});class d{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?d.ShadersRepository:d.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?d.ShadersStore:d.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?d.IncludesShadersStore:d.IncludesShadersStoreWGSL}}d.ShadersRepository="src/Shaders/",d.ShadersStore={},d.IncludesShadersStore={},d.ShadersRepositoryWGSL="src/ShadersWGSL/",d.ShadersStoreWGSL={},d.IncludesShadersStoreWGSL={}},11045:(N,q,C)=>{C.d(q,{d:()=>V,f:()=>K,g:()=>J,k:()=>Z,o:()=>Q,r:()=>O,v:()=>t,y:()=>A,C:()=>n,E:()=>w,H:()=>F});class d{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Zq._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(N){N&&this.program&&N(this.program)}setEngine(N){this.Zq=N}_fillEffectInformation(N,q,C,d,U,W,a,F){const w=this.Zq;if(w.supportsUniformBuffers)for(const n in q)N.bindUniformBlock(n,q[n]);let A;for(this.Zq.getUniforms(this,C).forEach(((N,q)=>{d[C[q]]=N})),this._uniforms=d,A=0;A<U.length;A++){null==N.getUniform(U[A])&&(U.splice(A,1),A--)}U.forEach(((N,q)=>{W[N]=q}));for(const n of w.getAttributes(this,a))F.push(n)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(N,q){const C=this._valueCache[N],d=q.updateFlag;return(void 0===C||C!==d)&&(this._valueCache[N]=d,!0)}_cacheFloat2(N,q,C){let d=this._valueCache[N];if(!d||2!==d.length)return d=[q,C],this._valueCache[N]=d,!0;let U=!1;return d[0]!==q&&(d[0]=q,U=!0),d[1]!==C&&(d[1]=C,U=!0),U}_cacheFloat3(N,q,C,d){let U=this._valueCache[N];if(!U||3!==U.length)return U=[q,C,d],this._valueCache[N]=U,!0;let W=!1;return U[0]!==q&&(U[0]=q,W=!0),U[1]!==C&&(U[1]=C,W=!0),U[2]!==d&&(U[2]=d,W=!0),W}_cacheFloat4(N,q,C,d,U){let W=this._valueCache[N];if(!W||4!==W.length)return W=[q,C,d,U],this._valueCache[N]=W,!0;let a=!1;return W[0]!==q&&(W[0]=q,a=!0),W[1]!==C&&(W[1]=C,a=!0),W[2]!==d&&(W[2]=d,a=!0),W[3]!==U&&(W[3]=U,a=!0),a}setInt(N,q){const C=this._valueCache[N];void 0!==C&&C===q||this.Zq.setInt(this._uniforms[N],q)&&(this._valueCache[N]=q)}setInt2(N,q,C){this._cacheFloat2(N,q,C)&&(this.Zq.setInt2(this._uniforms[N],q,C)||(this._valueCache[N]=null))}setInt3(N,q,C,d){this._cacheFloat3(N,q,C,d)&&(this.Zq.setInt3(this._uniforms[N],q,C,d)||(this._valueCache[N]=null))}setInt4(N,q,C,d,U){this._cacheFloat4(N,q,C,d,U)&&(this.Zq.setInt4(this._uniforms[N],q,C,d,U)||(this._valueCache[N]=null))}setIntArray(N,q){this._valueCache[N]=null,this.Zq.setIntArray(this._uniforms[N],q)}setIntArray2(N,q){this._valueCache[N]=null,this.Zq.setIntArray2(this._uniforms[N],q)}setIntArray3(N,q){this._valueCache[N]=null,this.Zq.setIntArray3(this._uniforms[N],q)}setIntArray4(N,q){this._valueCache[N]=null,this.Zq.setIntArray4(this._uniforms[N],q)}setUInt(N,q){const C=this._valueCache[N];void 0!==C&&C===q||this.Zq.setUInt(this._uniforms[N],q)&&(this._valueCache[N]=q)}setUInt2(N,q,C){this._cacheFloat2(N,q,C)&&(this.Zq.setUInt2(this._uniforms[N],q,C)||(this._valueCache[N]=null))}setUInt3(N,q,C,d){this._cacheFloat3(N,q,C,d)&&(this.Zq.setUInt3(this._uniforms[N],q,C,d)||(this._valueCache[N]=null))}setUInt4(N,q,C,d,U){this._cacheFloat4(N,q,C,d,U)&&(this.Zq.setUInt4(this._uniforms[N],q,C,d,U)||(this._valueCache[N]=null))}setUIntArray(N,q){this._valueCache[N]=null,this.Zq.setUIntArray(this._uniforms[N],q)}setUIntArray2(N,q){this._valueCache[N]=null,this.Zq.setUIntArray2(this._uniforms[N],q)}setUIntArray3(N,q){this._valueCache[N]=null,this.Zq.setUIntArray3(this._uniforms[N],q)}setUIntArray4(N,q){this._valueCache[N]=null,this.Zq.setUIntArray4(this._uniforms[N],q)}setArray(N,q){this._valueCache[N]=null,this.Zq.setArray(this._uniforms[N],q)}setArray2(N,q){this._valueCache[N]=null,this.Zq.setArray2(this._uniforms[N],q)}setArray3(N,q){this._valueCache[N]=null,this.Zq.setArray3(this._uniforms[N],q)}setArray4(N,q){this._valueCache[N]=null,this.Zq.setArray4(this._uniforms[N],q)}setMatrices(N,q){q&&(this._valueCache[N]=null,this.Zq.setMatrices(this._uniforms[N],q))}setMatrix(N,q){this._cacheMatrix(N,q)&&(this.Zq.setMatrices(this._uniforms[N],q.zd())||(this._valueCache[N]=null))}setMatrix3x3(N,q){this._valueCache[N]=null,this.Zq.setMatrix3x3(this._uniforms[N],q)}setMatrix2x2(N,q){this._valueCache[N]=null,this.Zq.setMatrix2x2(this._uniforms[N],q)}setFloat(N,q){const C=this._valueCache[N];void 0!==C&&C===q||this.Zq.setFloat(this._uniforms[N],q)&&(this._valueCache[N]=q)}setVector2(N,q){this._cacheFloat2(N,q.x,q.y)&&(this.Zq.setFloat2(this._uniforms[N],q.x,q.y)||(this._valueCache[N]=null))}setFloat2(N,q,C){this._cacheFloat2(N,q,C)&&(this.Zq.setFloat2(this._uniforms[N],q,C)||(this._valueCache[N]=null))}setVector3(N,q){this._cacheFloat3(N,q.x,q.y,q.z)&&(this.Zq.setFloat3(this._uniforms[N],q.x,q.y,q.z)||(this._valueCache[N]=null))}setFloat3(N,q,C,d){this._cacheFloat3(N,q,C,d)&&(this.Zq.setFloat3(this._uniforms[N],q,C,d)||(this._valueCache[N]=null))}setVector4(N,q){this._cacheFloat4(N,q.x,q.y,q.z,q.w)&&(this.Zq.setFloat4(this._uniforms[N],q.x,q.y,q.z,q.w)||(this._valueCache[N]=null))}setQuaternion(N,q){this._cacheFloat4(N,q.x,q.y,q.z,q.w)&&(this.Zq.setFloat4(this._uniforms[N],q.x,q.y,q.z,q.w)||(this._valueCache[N]=null))}setFloat4(N,q,C,d,U){this._cacheFloat4(N,q,C,d,U)&&(this.Zq.setFloat4(this._uniforms[N],q,C,d,U)||(this._valueCache[N]=null))}setColor3(N,q){this._cacheFloat3(N,q.r,q.g,q.b)&&(this.Zq.setFloat3(this._uniforms[N],q.r,q.g,q.b)||(this._valueCache[N]=null))}setColor4(N,q,C){this._cacheFloat4(N,q.r,q.g,q.b,C)&&(this.Zq.setFloat4(this._uniforms[N],q.r,q.g,q.b,C)||(this._valueCache[N]=null))}setDirectColor4(N,q){this._cacheFloat4(N,q.r,q.g,q.b,q.a)&&(this.Zq.setFloat4(this._uniforms[N],q.r,q.g,q.b,q.a)||(this._valueCache[N]=null))}_getVertexShaderCode(){return this.vertexShader?this.Zq._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Zq._getShaderSource(this.fragmentShader):null}}var U=C(11025);const W=new WeakMap,a={_webGLVersion:2,cachedPipelines:{}};function F(N){let q=W.get(N);if(!q){if(!N)return a;q={_webGLVersion:N.TEXTURE_BINDING_3D?2:1,_context:N,parallelShaderCompile:N.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},W.set(N,q)}return q}function w(N){W.delete(N)}function A(N,q,C,d,U,W){const a=F(d);W||(W=a._createShaderProgramInjection??V);return W(N,r(q,"vertex",d,a._contextWasLost),r(C,"fragment",d,a._contextWasLost),d,U,a.validateShaderPrograms)}function n(N,q,C,d,U){let W=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6?arguments[6]:void 0;const w=F(U);a||(a=w._createShaderProgramInjection??V);const A=w._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return a(N,v(q,"vertex",d,A,U,w._contextWasLost),v(C,"fragment",d,A,U,w._contextWasLost),U,W,w.validateShaderPrograms)}function t(N,q){const C=new d,U=F(N);return U.parallelShaderCompile&&!U.disableParallelShaderCompile&&(C.isParallelCompiled=!0),C.context=U._context,C}function V(N,q,C,d){let U=arguments.length>5?arguments[5]:void 0;const W=d.createProgram();if(N.program=W,!W)throw new Error("Unable to create program");return d.attachShader(W,q),d.attachShader(W,C),d.linkProgram(W),N.context=d,N.vertexShader=q,N.fragmentShader=C,N.isParallelCompiled||J(N,d,U),W}function Z(N,q,C){const d=N;if(d._isDisposed)return!1;const U=F(q);return!!(U&&U.parallelShaderCompile&&U.parallelShaderCompile.COMPLETION_STATUS_KHR&&d.program&&q.getProgramParameter(d.program,U.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(J(d,q,C),!0)}function J(N,q,C){const d=N.context,U=N.vertexShader,W=N.fragmentShader,a=N.program;if(!d.getProgramParameter(a,d.LINK_STATUS)){if(!q.getShaderParameter(U,q.COMPILE_STATUS)){const C=q.getShaderInfoLog(U);if(C)throw N.vertexCompilationError=C,new Error("VERTEX SHADER "+C)}if(!q.getShaderParameter(W,q.COMPILE_STATUS)){const C=q.getShaderInfoLog(W);if(C)throw N.fragmentCompilationError=C,new Error("FRAGMENT SHADER "+C)}const C=d.getProgramInfoLog(a);if(C)throw N.programLinkError=C,new Error(C)}if(C){d.validateProgram(a);if(!d.getProgramParameter(a,d.VALIDATE_STATUS)){const q=d.getProgramInfoLog(a);if(q)throw N.programValidationError=q,new Error(q)}}d.deleteShader(U),d.deleteShader(W),N.vertexShader=void 0,N.fragmentShader=void 0,N.onCompiled&&(N.onCompiled(),N.onCompiled=void 0)}function Q(N,q,C,d,U,W,a,w,t){let V=arguments.length>10?arguments[10]:void 0,Z=arguments.length>11?arguments[11]:void 0,J=arguments.length>12?arguments[12]:void 0;const Q=F(N.context);Z||(Z=Q.createRawShaderProgramInjection??A),J||(J=Q.createShaderProgramInjection??n);const v=N;v.program=d?Z(v,q,C,v.context,t):J(v,q,C,w,v.context,t),v.program.__SPECTOR_rebuildProgram=a,V()}function v(N,q,C,d,W,a){return r((0,U.d)(N,C,d),q,W,a)}function r(N,q,C,d){const U=C.createShader("vertex"===q?C.VERTEX_SHADER:C.FRAGMENT_SHADER);if(!U){let N=C.NO_ERROR,U=C.NO_ERROR;for(;(U=C.getError())!==C.NO_ERROR;)N=U;throw new Error(`Something went wrong while creating a gl ${q} shader object. gl error=${N}, gl isContextLost=${C.isContextLost()}, _contextWasLost=${d}`)}return C.shaderSource(U,N),C.compileShader(U),U}function O(N,q){q.useProgram(N)}function K(N,q){const C=N;if(!C.isParallelCompiled)return void q(N);const d=C.onCompiled;C.onCompiled=()=>{null===d||void 0===d||d(),q(N)}}},11040:(N,q,C)=>{C.d(q,{d:()=>t,h:()=>Z,i:()=>A,m:()=>n});var d=C(10953),U=C(11045),W=C(11036),a=C(10962),F=C(11016),w=C(11025);function A(N,q){return(0,U.H)(q).cachedPipelines[N]}function n(N){const q=N._name,C=N.context;if(q&&C){const N=(0,U.H)(C),d=N.cachedPipelines[q];null===d||void 0===d||d.dispose(),delete N.cachedPipelines[q]}}function t(N,q,C,U,W,a,w){let A,n;const t=(0,d.k)()?null===a||void 0===a?void 0:a.getHostDocument():null;A="string"===typeof q?q:q.vertexSource?"source:"+q.vertexSource:q.vertexElement?(null===t||void 0===t?void 0:t.getElementById(q.vertexElement))||q.vertexElement:q.vertex||q,n="string"===typeof q?q:q.fragmentSource?"source:"+q.fragmentSource:q.fragmentElement?(null===t||void 0===t?void 0:t.getElementById(q.fragmentElement))||q.fragmentElement:q.fragment||q;const Z=[void 0,void 0],J=()=>{if(Z[0]&&Z[1]){N.isFragment=!0;const[d,A]=Z;(0,F.n)(A,N,((a,A)=>{w&&(w._fragmentSourceCodeBeforeMigration=A),C&&(a=C("fragment",a));const n=(0,F.e)(d,a,N);N=null;const t=function(N,q,C,d){if(C){return{vertexSourceCode:(1===d?"//":"")+"#define SHADER_NAME vertex:"+(C.vertexElement||C.vertex||C.spectorName||C)+"\n"+N,fragmentSourceCode:(1===d?"//":"")+"#define SHADER_NAME fragment:"+(C.fragmentElement||C.fragment||C.spectorName||C)+"\n"+q}}return{vertexSourceCode:N,fragmentSourceCode:q}}(n.vertexCode,n.fragmentCode,q,W);null===U||void 0===U||U(t.vertexSourceCode,t.fragmentSourceCode)}),a)}};V(A,"Vertex","",(q=>{(0,F.i)(N),(0,F.n)(q,N,((N,d)=>{w&&(w._rawVertexSourceCode=q,w._vertexSourceCodeBeforeMigration=d),C&&(N=C("vertex",N)),Z[0]=N,J()}),a)}),W),V(n,"Fragment","Pixel",(N=>{w&&(w._rawFragmentSourceCode=N),Z[1]=N,J()}),W)}function V(N,q,C,U,a,F){if("undefined"!==typeof HTMLElement&&N instanceof HTMLElement){return void U((0,d.e)(N))}if("source:"===N.substring(0,7))return void U(N.substring(7));if("base64:"===N.substring(0,7)){return void U(window.atob(N.substring(7)))}const A=W.c.GetShadersStore(a);if(A[N+q+"Shader"])return void U(A[N+q+"Shader"]);if(C&&A[N+C+"Shader"])return void U(A[N+C+"Shader"]);let n;if(n="."===N[0]||"/"===N[0]||N.indexOf("http")>-1?N:W.c.GetShadersRepository(a)+N,!(F=F||w.i))throw new Error("loadFileInjection is not defined");F(n+"."+q.toLowerCase()+".fx",U)}const Z=(N,q,C,d)=>{try{const W=N.context?(0,U.H)(N.context):null;W&&(W.disableParallelShaderCompile=N.disableParallelCompilation);const a=N.existingPipelineContext||q(N.shaderProcessingContext);return a._name=N.name,N.name&&W&&(W.cachedPipelines[N.name]=a),C(a,N.vertex,N.fragment,!!N.createAsRaw,"","",N.rebuildRebind,N.defines,N.transformFeedbackVaryings,"",(()=>{d(a,(()=>{var q;null===(q=N.onRenderingStateCompiled)||void 0===q||q.call(N,a)}))})),a}catch(W){throw a.c.Error("Error compiling effect"),W}}},11034:(N,q,C)=>{C.r(q),C.d(q,{Effect:()=>w});var d=C(10949),U=C(10962),W=C(11036),a=C(11040),F=C(11029);class w{static get ShadersRepository(){return W.c.ShadersRepository}static set ShadersRepository(N){W.c.ShadersRepository=N}get A(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new d.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(N,q,C){let U=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,W=arguments.length>4?arguments[4]:void 0,F=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,t=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,V=arguments.length>9?arguments[9]:void 0,Z=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",J=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,Q=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new d.b,this.onErrorObservable=new d.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=N,this._key=Z;const v=this._key.replace(/\r/g,"").replace(/\n/g,"|");let r;if(q.attributes){const N=q;if(this._engine=C,this._attributesNames=N.attributes,this._uniformsNames=N.uniformsNames.concat(N.samplers),this._samplerList=N.samplers.slice(),this.defines=N.defines,this.onError=N.onError,this.onCompiled=N.onCompiled,this._fallbacks=N.fallbacks,this._indexParameters=N.indexParameters,this._transformFeedbackVaryings=N.transformFeedbackVaryings||null,this._multiTarget=!!N.multiTarget,this._shaderLanguage=N.shaderLanguage??0,this._disableParallelShaderCompilation=!!N.disableParallelShaderCompilation,N.uniformBuffersNames){this._uniformBuffersNamesList=N.uniformBuffersNames.slice();for(let q=0;q<N.uniformBuffersNames.length;q++)this._uniformBuffersNames[N.uniformBuffersNames[q]]=q}this._processFinalCode=N.processFinalCode??null,this._processCodeAfterIncludes=N.processCodeAfterIncludes??void 0,Q=N.extraInitializationsAsync,r=N.existingPipelineContext}else this._engine=W,this.defines=null==F?"":F,this._uniformsNames=C.concat(U),this._samplerList=U?U.slice():[],this._attributesNames=q,this._uniformBuffersNamesList=[],this._shaderLanguage=J,this.onError=t,this.onCompiled=n,this._indexParameters=V,this._fallbacks=A;"WEBGL2"===this._engine.shaderPlatformName&&(r=(0,a.i)(v,this._engine._gl)??r),this._attributeLocationByName={},this.uniqueId=w._UniqueIdSeed++,r?(this._pipelineContext=r,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,Q),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.A||this.dispose(!0)}))}async _processShaderCodeAsync(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,q=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3?arguments[3]:void 0;d&&await d(),this._processingContext=C||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const U={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:N??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:W.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:W.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,a.d)(U,this.name,this._processFinalCode,((N,C)=>{this._vertexSourceCode=N,this._fragmentSourceCode=C,this._prepareEffect(q)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.A||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(N){return this._attributes[N]}getAttributeLocationByName(N){return this._attributeLocationByName[N]}getAttributesCount(){return this._attributes.length}getUniformIndex(N){return this._uniformsNames.indexOf(N)}getUniform(N){return this._uniforms[N]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((N=>{this.executeWhenCompiled(N)}))}executeWhenCompiled(N){this.isReady()?N(this):(this.onCompileObservable.add((q=>{N(q)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(N){(0,F.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(q=>{this._processCompilationErrors(q,N)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var N;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(N=this._pipelineContext)||void 0===N?void 0:N._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(N,q,C,d){this._isReady=!1,this._vertexSourceCodeOverride=N,this._fragmentSourceCodeOverride=q,this.onError=(N,q)=>{d&&d(q)},this.onCompiled=()=>{var N,q;const d=this.getEngine().scenes;if(d)for(let C=0;C<d.length;C++)d[C].markAllMaterialsAsDirty(127);null===(N=(q=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===N||N.call(q,C)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(N){if(this._pipelineContext=N,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let q=0;q<this._attributesNames.length;q++){const N=this._attributesNames[q];this._attributeLocationByName[N]=this._attributes[q]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),w.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const q=this._pipelineContext;this._isReady=!1;try{const C=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),d=C?null:this.defines,U=C?this._vertexSourceCodeOverride:this._vertexSourceCode,W=C?this._fragmentSourceCodeOverride:this._fragmentSourceCode,F=this._engine;this._pipelineContext=(0,a.h)({existingPipelineContext:N?q:null,vertex:U,fragment:W,context:"WEBGL2"===F.shaderPlatformName||"WEBGL1"===F.shaderPlatformName?F._gl:void 0,rebuildRebind:(N,q,C,d)=>this._rebuildProgram(N,q,C,d),defines:d,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:C,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:C=>{q&&!N&&this._engine._deletePipelineContext(q),C&&this._onRenderingStateCompiled(C)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(q)}catch(C){this._processCompilationErrors(C,q)}}_getShaderCodeAndErrorLine(N,q,C){const d=C?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let U=null;if(q&&N){const W=q.match(d);if(W&&2===W.length){const q=parseInt(W[1]),d=N.split("\n",-1);d.length>=q&&(U=`Offending line [${q}] in ${C?"fragment":"vertex"} code: ${d[q-1]}`)}}return[N,U]}_processCompilationErrors(N){let q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=N.message;const C=this._attributesNames,d=this._fallbacks;if(U.c.Error("Unable to compile effect:"),U.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),U.c.Error(`Attributes: ${C.join(" ")}`),U.c.Error("Defines:\n"+this.defines),w.LogShaderCodeOnCompilationError){var W,a;let N=null,q=null,C=null;var F;if(null!==(W=this._pipelineContext)&&void 0!==W&&W._getVertexShaderCode()&&([C,N]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),C&&(U.c.Error("Vertex code:"),U.c.Error(C))),null!==(a=this._pipelineContext)&&void 0!==a&&a._getFragmentShaderCode())[C,q]=this._getShaderCodeAndErrorLine(null===(F=this._pipelineContext)||void 0===F?void 0:F._getFragmentShaderCode(),this._compilationError,!0),C&&(U.c.Error("Fragment code:"),U.c.Error(C));N&&U.c.Error(N),q&&U.c.Error(q)}U.c.Error("Error: "+this._compilationError);const A=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};q&&(this._pipelineContext=q,this._isReady=!0,A()),d?(this._pipelineContext=null,d.hasMoreFallbacks?(this._allFallbacksProcessed=!1,U.c.Error("Trying next fallback."),this.defines=d.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,A(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,q||A())}get isSupported(){return""===this._compilationError}_bindTexture(N,q){this._engine._bindTexture(this._samplers[N],q,N)}setTexture(N,q){this._engine.setTexture(this._samplers[N],this._uniforms[N],q,N)}setTextureArray(N,q){const C=N+"Ex";if(-1===this._samplerList.indexOf(C+"0")){const d=this._samplerList.indexOf(N);for(let N=1;N<q.length;N++){const q=C+(N-1).toString();this._samplerList.splice(d+N,0,q)}let U=0;for(const N of this._samplerList)this._samplers[N]=U,U+=1}this._engine.setTextureArray(this._samplers[N],this._uniforms[N],q,N)}bindUniformBuffer(N,q){const C=this._uniformBuffersNames[q];void 0===C||w._BaseCache[C]===N&&this._engine._features.useUBOBindingCache||(w._BaseCache[C]=N,this._engine.bindUniformBufferBase(N,C,q))}bindUniformBlock(N,q){this._engine.bindUniformBlock(this._pipelineContext,N,q)}setInt(N,q){return this._pipelineContext.setInt(N,q),this}setInt2(N,q,C){return this._pipelineContext.setInt2(N,q,C),this}setInt3(N,q,C,d){return this._pipelineContext.setInt3(N,q,C,d),this}setInt4(N,q,C,d,U){return this._pipelineContext.setInt4(N,q,C,d,U),this}setIntArray(N,q){return this._pipelineContext.setIntArray(N,q),this}setIntArray2(N,q){return this._pipelineContext.setIntArray2(N,q),this}setIntArray3(N,q){return this._pipelineContext.setIntArray3(N,q),this}setIntArray4(N,q){return this._pipelineContext.setIntArray4(N,q),this}setUInt(N,q){return this._pipelineContext.setUInt(N,q),this}setUInt2(N,q,C){return this._pipelineContext.setUInt2(N,q,C),this}setUInt3(N,q,C,d){return this._pipelineContext.setUInt3(N,q,C,d),this}setUInt4(N,q,C,d,U){return this._pipelineContext.setUInt4(N,q,C,d,U),this}setUIntArray(N,q){return this._pipelineContext.setUIntArray(N,q),this}setUIntArray2(N,q){return this._pipelineContext.setUIntArray2(N,q),this}setUIntArray3(N,q){return this._pipelineContext.setUIntArray3(N,q),this}setUIntArray4(N,q){return this._pipelineContext.setUIntArray4(N,q),this}setFloatArray(N,q){return this._pipelineContext.setArray(N,q),this}setFloatArray2(N,q){return this._pipelineContext.setArray2(N,q),this}setFloatArray3(N,q){return this._pipelineContext.setArray3(N,q),this}setFloatArray4(N,q){return this._pipelineContext.setArray4(N,q),this}setArray(N,q){return this._pipelineContext.setArray(N,q),this}setArray2(N,q){return this._pipelineContext.setArray2(N,q),this}setArray3(N,q){return this._pipelineContext.setArray3(N,q),this}setArray4(N,q){return this._pipelineContext.setArray4(N,q),this}setMatrices(N,q){return this._pipelineContext.setMatrices(N,q),this}setMatrix(N,q){return this._pipelineContext.setMatrix(N,q),this}setMatrix3x3(N,q){return this._pipelineContext.setMatrix3x3(N,q),this}setMatrix2x2(N,q){return this._pipelineContext.setMatrix2x2(N,q),this}setFloat(N,q){return this._pipelineContext.setFloat(N,q),this}setBool(N,q){return this._pipelineContext.setInt(N,q?1:0),this}setVector2(N,q){return this._pipelineContext.setVector2(N,q),this}setFloat2(N,q,C){return this._pipelineContext.setFloat2(N,q,C),this}setVector3(N,q){return this._pipelineContext.setVector3(N,q),this}setFloat3(N,q,C,d){return this._pipelineContext.setFloat3(N,q,C,d),this}setVector4(N,q){return this._pipelineContext.setVector4(N,q),this}setQuaternion(N,q){return this._pipelineContext.setQuaternion(N,q),this}setFloat4(N,q,C,d,U){return this._pipelineContext.setFloat4(N,q,C,d,U),this}setColor3(N,q){return this._pipelineContext.setColor3(N,q),this}setColor4(N,q,C){return this._pipelineContext.setColor4(N,q,C),this}setDirectColor4(N,q){return this._pipelineContext.setDirectColor4(N,q),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(w.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,a.m)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(N,q,C){let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;q&&(W.c.GetShadersStore(d)[`${N}PixelShader`]=q),C&&(W.c.GetShadersStore(d)[`${N}VertexShader`]=C)}static ResetCache(){w._BaseCache={}}}w.LogShaderCodeOnCompilationError=!0,w.PersistentMode=!1,w.AutomaticallyClearCodeCache=!1,w._UniqueIdSeed=0,w._BaseCache={},w.ShadersStore=W.c.ShadersStore,w.IncludesShadersStore=W.c.IncludesShadersStore},10985:(N,q,C)=>{C.d(q,{b:()=>U});const d={};function U(N){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!d[N])return d[N]=!0,`${N} needs to be imported before as it contains a side-effect required by your code.`}},10953:(N,q,C)=>{function d(){return"undefined"!==typeof window}function U(){return"undefined"!==typeof navigator}function W(){return"undefined"!==typeof document}function a(N){let q="",C=N.firstChild;for(;C;)3===C.nodeType&&(q+=C.textContent),C=C.nextSibling;return q}C.d(q,{e:()=>a,f:()=>W,h:()=>U,k:()=>d})},10962:(N,q,C)=>{C.d(q,{c:()=>d});class d{static _CheckLimit(N,q){let C=d._LogLimitOutputs[N];return C?C.current++:(C={limit:q,current:1},d._LogLimitOutputs[N]=C),C.current<=C.limit}static _GenerateLimitMessage(N){let q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const C=d._LogLimitOutputs[N];if(!C||!d.MessageLimitReached)return;const U=this._Levels[q];C.current===C.limit&&d[U.name](d.MessageLimitReached.replace(/%LIMIT%/g,""+C.limit).replace(/%TYPE%/g,U.name??""))}static _AddLogEntry(N){d._LogCache=N+d._LogCache,d.OnNewCacheEntry&&d.OnNewCacheEntry(N)}static _FormatMessage(N){const q=N=>N<10?"0"+N:""+N,C=new Date;return"["+q(C.getHours())+":"+q(C.getMinutes())+":"+q(C.getSeconds())+"]: "+N}static _LogDisabled(N,q){}static _LogEnabled(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,q=arguments.length>1?arguments[1]:void 0,C=arguments.length>2?arguments[2]:void 0;const U=Array.isArray(q)?q[0]:q;if(void 0!==C&&!d._CheckLimit(U,C))return;const W=d._FormatMessage(U),a=this._Levels[N],F=Array.isArray(q)?q.slice(1):[];a.logFunc&&a.logFunc("BJS - "+W,...F);const w=`<div style='color:${a.color}'>${W}</div><br>`;d._AddLogEntry(w),d._GenerateLimitMessage(U,N)}static get LogCache(){return d._LogCache}static ClearLogCache(){d._LogCache="",d._LogLimitOutputs={},d.errorsCount=0}static set LogLevels(N){d.Log=d._LogDisabled,d.Warn=d._LogDisabled,d.Error=d._LogDisabled;const q=[d.MessageLogLevel,d.WarningLogLevel,d.ErrorLogLevel];for(const C of q)if((N&C)===C){const N=this._Levels[C];d[N.name]=d._LogEnabled.bind(d,C)}}}d.NoneLogLevel=0,d.MessageLogLevel=1,d.WarningLogLevel=2,d.ErrorLogLevel=4,d.AllLogLevel=7,d.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",d._LogCache="",d._LogLimitOutputs={},d._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],d.errorsCount=0,d.Log=d._LogEnabled.bind(d,d.MessageLogLevel),d.Warn=d._LogEnabled.bind(d,d.WarningLogLevel),d.Error=d._LogEnabled.bind(d,d.ErrorLogLevel)},10949:(N,q,C)=>{C.d(q,{b:()=>a});const d="undefined"!==typeof WeakRef;class U{constructor(N){let q=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0;this.initialize(N,q,C,d)}initialize(N){let q=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0;return this.mask=N,this.skipNextObservers=q,this.target=C,this.currentTarget=d,this}}class W{constructor(N,q){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=N,this.mask=q,this.scope=C,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(N)}}class a{static FromPromise(N,q){const C=new a;return N.then((N=>{C.notifyObservers(N)})).catch((N=>{if(!q)throw N;q.notifyObservers(N)})),C}get observers(){return this._observers}constructor(N){let q=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=q,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new U(0),N&&(this._onObserverAdded=N)}add(N){let q=arguments.length>2&&void 0!==arguments[2]&&arguments[2],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!N)return null;const U=new W(N,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);U.unregisterOnNextCall=C,q?this._observers.unshift(U):this._observers.push(U),this._onObserverAdded&&this._onObserverAdded(U),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(U,this._lastNotifiedValue);const a=d?new WeakRef(this):{deref:()=>this};return U._remove=function(){let N=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const q=a.deref();q&&(N?q.remove(U):q._remove(U))},U}addOnce(N){return this.add(N,void 0,void 0,void 0,!0)}remove(N){if(!N)return!1;N._remove=null;return-1!==this._observers.indexOf(N)&&(this._deferUnregister(N),!0)}removeCallback(N,q){for(let C=0;C<this._observers.length;C++){const d=this._observers[C];if(!d._willBeUnregistered&&(d.callback===N&&(!q||q===d.scope)))return this._deferUnregister(d),!0}return!1}_deferUnregister(N){N._willBeUnregistered||(this._numObserversMarkedAsDeleted++,N.unregisterOnNextCall=!1,N._willBeUnregistered=!0,setTimeout((()=>{this._remove(N)}),0))}_remove(N){let q=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!N)return!1;const C=this._observers.indexOf(N);return-1!==C&&(q&&this._numObserversMarkedAsDeleted--,this._observers.splice(C,1),!0)}makeObserverTopPriority(N){this._remove(N,!1),this._observers.unshift(N)}makeObserverBottomPriority(N){this._remove(N,!1),this._observers.push(N)}notifyObservers(N){let q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,C=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=N),!this._observers.length)return!0;const W=this._eventState;W.mask=q,W.target=C,W.currentTarget=d,W.skipNextObservers=!1,W.lastReturnValue=N,W.userInfo=U;for(const a of this._observers)if(!a._willBeUnregistered&&(a.mask&q&&(a.unregisterOnNextCall&&this._deferUnregister(a),a.scope?W.lastReturnValue=a.callback.apply(a.scope,[N,W]):W.lastReturnValue=a.callback(N,W)),W.skipNextObservers))return!1;return!0}notifyObserver(N,q){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=q),N._willBeUnregistered)return;const d=this._eventState;d.mask=C,d.skipNextObservers=!1,N.unregisterOnNextCall&&this._deferUnregister(N),N.callback(q,d)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const N=this._observers.pop();N&&(N._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const N=new a;return N._observers=this._observers.slice(0),N}hasSpecificMask(){let N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const q of this._observers)if(q.mask&N||q.mask===N)return!0;return!1}}},11029:(N,q,C)=>{C.d(q,{b:()=>U,f:()=>a});let d=[];class U{static SetImmediate(N){0===d.length&&setTimeout((()=>{const N=d;d=[];for(const q of N)q()}),1),d.push(N)}}function W(N,q,C){try{if(N())return q(),!0}catch(d){return null===C||void 0===C||C(d),!0}return!1}const a=function(N,q,C){let d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,U=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,a=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&W(N,q,C))return null;const F=setInterval((()=>{W(N,q,C)?clearInterval(F):(U-=d,U<0&&(clearInterval(F),null===C||void 0===C||C(new Error("Operation timed out after maximum retries. "+(a||"")),!0)))}),d);return()=>clearInterval(F)}}}]);