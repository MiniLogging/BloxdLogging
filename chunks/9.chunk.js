"use strict";(self["1xyrlsr8vb9"]=self["1xyrlsr8vb9"]||[]).push([[9],{12158:(I,O,C)=>{C.d(O,{c:()=>X,f:()=>c,l:()=>n,h:()=>J,o:()=>f});class j{constructor(){this.children=[]}isValid(I){return!0}process(I,O,C){let j="";if(this.line){let C=this.line;const N=O.processor;if(N){var K,i,y,S,U,p;N.lineProcessor&&(C=N.lineProcessor(C,O.isFragment,O.processingContext));const j=(null===(K=O.processor)||void 0===K?void 0:K.attributeKeywordName)??"attribute",Q=O.isFragment&&null!==(i=O.processor)&&void 0!==i&&i.varyingFragmentKeywordName?null===(y=O.processor)||void 0===y?void 0:y.varyingFragmentKeywordName:!O.isFragment&&null!==(S=O.processor)&&void 0!==S&&S.varyingVertexKeywordName?null===(U=O.processor)||void 0===U?void 0:U.varyingVertexKeywordName:"varying";if(!O.isFragment&&N.attributeProcessor&&this.line.startsWith(j))C=N.attributeProcessor(this.line,I,O.processingContext);else if(N.varyingProcessor&&(null!==(p=N.varyingCheck)&&void 0!==p&&p.call(N,this.line,O.isFragment)||!N.varyingCheck&&this.line.startsWith(Q)))C=N.varyingProcessor(this.line,O.isFragment,I,O.processingContext);else if(N.uniformProcessor&&N.uniformRegexp&&N.uniformRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(C=N.uniformProcessor(this.line,O.isFragment,I,O.processingContext));else if(N.uniformBufferProcessor&&N.uniformBufferRegexp&&N.uniformBufferRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(C=N.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0);else if(N.textureProcessor&&N.textureRegexp&&N.textureRegexp.test(this.line))C=N.textureProcessor(this.line,O.isFragment,I,O.processingContext);else if((N.uniformProcessor||N.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!O.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?N.uniformProcessor&&(C=N.uniformProcessor(this.line,O.isFragment,I,O.processingContext)):N.uniformBufferProcessor&&(C=N.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0)}O.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(O.lookForClosingBracketForUniformBuffer=!1,N.endOfUniformBufferProcessor&&(C=N.endOfUniformBufferProcessor(this.line,O.isFragment,O.processingContext)))}j+=C+"\n"}for(const N of this.children)j+=N.process(I,O,C);return this.additionalDefineKey&&(I[this.additionalDefineKey]=this.additionalDefineValue||"true",C[this.additionalDefineKey]=I[this.additionalDefineKey]),j}}class K{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(I){this._lines.length=0;for(const O of I){if(!O||"\r"===O)continue;if("#"===O[0]){this._lines.push(O);continue}const I=O.trim();if(!I)continue;if(I.startsWith("//")){this._lines.push(O);continue}const C=I.indexOf(";");if(-1===C)this._lines.push(I);else if(C===I.length-1)I.length>1&&this._lines.push(I);else{const I=O.split(";");for(let O=0;O<I.length;O++){let C=I[O];C&&(C=C.trim(),C&&this._lines.push(C+(O!==I.length-1?";":"")))}}}}}class i extends j{process(I,O,C){for(let j=0;j<this.children.length;j++){const K=this.children[j];if(K.isValid(I))return K.process(I,O,C)}return""}}class y extends j{isValid(I){return this.testExpression.isTrue(I)}}class S{isTrue(I){return!0}static postfixToInfix(I){const O=[];for(const C of I)if(void 0===S._OperatorPriority[C])O.push(C);else{const I=O[O.length-1],j=O[O.length-2];O.length-=2,O.push(`(${j}${C}${I})`)}return O[O.length-1]}static infixToPostfix(I){const O=S._InfixToPostfixCache.get(I);if(O)return O.accessTime=Date.now(),O.result;if(!I.includes("&&")&&!I.includes("||")&&!I.includes(")")&&!I.includes("("))return[I];const C=[];let j=-1;const K=()=>{N=N.trim(),""!==N&&(C.push(N),N="")},i=I=>{j<S._Stack.length-1&&(S._Stack[++j]=I)},y=()=>S._Stack[j],U=()=>-1===j?"!!INVALID EXPRESSION!!":S._Stack[j--];let p=0,N="";for(;p<I.length;){const O=I.charAt(p),Q=p<I.length-1?I.substring(p,2+p):"";if("("===O)N="",i(O);else if(")"===O){for(K();-1!==j&&"("!==y();)C.push(U());U()}else if(S._OperatorPriority[Q]>1){for(K();-1!==j&&S._OperatorPriority[y()]>=S._OperatorPriority[Q];)C.push(U());i(Q),p++}else N+=O;p++}for(K();-1!==j;)"("===y()?U():C.push(U());return S._InfixToPostfixCache.size>=S.InfixToPostfixCacheLimitSize&&S.ClearCache(),S._InfixToPostfixCache.set(I,{result:C,accessTime:Date.now()}),C}static ClearCache(){const I=Array.from(S._InfixToPostfixCache.entries()).sort(((I,O)=>I[1].accessTime-O[1].accessTime));for(let O=0;O<S.InfixToPostfixCacheCleanupSize;O++)S._InfixToPostfixCache.delete(I[O][0])}}S.InfixToPostfixCacheLimitSize=5e4,S.InfixToPostfixCacheCleanupSize=25e3,S._InfixToPostfixCache=new Map,S._OperatorPriority={")":0,"(":1,"||":2,"&&":3},S._Stack=["","","","","","","","","","","","","","","","","","","",""];class U extends S{constructor(I){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=I,this.not=O}isTrue(I){let O=void 0!==I[this.define];return this.not&&(O=!O),O}}class p extends S{isTrue(I){return this.leftOperand.isTrue(I)||this.rightOperand.isTrue(I)}}class N extends S{isTrue(I){return this.leftOperand.isTrue(I)&&this.rightOperand.isTrue(I)}}class Q extends S{constructor(I,O,C){super(),this.define=I,this.operand=O,this.testValue=C}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(I){let O=!1;const C=parseInt(void 0!=I[this.define]?I[this.define]:this.define),j=parseInt(void 0!=I[this.testValue]?I[this.testValue]:this.testValue);if(isNaN(C)||isNaN(j))return!1;switch(this.operand){case">":O=C>j;break;case"<":O=C<j;break;case"<=":O=C<=j;break;case">=":O=C>=j;break;case"==":O=C===j;break;case"!=":O=C!==j}return O}}var s=C(12126),Z=C(12160);const q=/defined\s*?\((.+?)\)/g,mI=/defined\s*?\[(.+?)\]/g,E=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,h=/__decl__/,r=/light\{X\}.(\w*)/g,W=/\{X\}/g,Y=[],o=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function c(I){I.processor&&I.processor.initializeShaders&&I.processor.initializeShaders(I.processingContext)}function n(I,O,C,j){var K;null!==(K=O.processor)&&void 0!==K&&K.preProcessShaderCode&&(I=O.processor.preProcessShaderCode(I,O.isFragment)),J(I,O,(I=>{O.processCodeAfterIncludes&&(I=O.processCodeAfterIncludes(O.isFragment?"fragment":"vertex",I,O.defines));const K=function(I,O,C){let j=function(I,O){var C;if(null!==(C=O.processor)&&void 0!==C&&C.noPrecision)return I;const j=O.shouldUseHighPrecisionShader;-1===I.indexOf("precision highp float")?I=j?"precision highp float;\n"+I:"precision mediump float;\n"+I:j||(I=I.replace("precision highp float","precision mediump float"));return I}(I,O);if(!O.processor)return j;if(0===O.processor.shaderLanguage&&-1!==j.indexOf("#version 3")&&(j=j.replace("#version 300 es",""),!O.processor.parseGLES3))return j;const K=O.defines,i=u(O,C);O.processor.preProcessor&&(j=O.processor.preProcessor(j,K,i,O.isFragment,O.processingContext));const y={};j=M(j,i,O,y),O.processor.postProcessor&&(j=O.processor.postProcessor(j,K,O.isFragment,O.processingContext,C?{drawBuffersExtensionDisabled:!C.getCaps().drawBuffersExtension}:{},i,y));null!==C&&void 0!==C&&C._features.needShaderCodeInlining&&(j=C.inlineShaderCode(j));return j}(I,O,j);C(K,I)}))}function X(I,O,C){return C.processor&&C.processor.finalizeShaders?C.processor.finalizeShaders(I,O,C.processingContext):{vertexCode:I,fragmentCode:O}}function T(I){const O=/defined\((.+)\)/.exec(I);if(O&&O.length)return new U(O[1].trim(),"!"===I[0]);const C=["==","!=",">=","<=","<",">"];let j="",K=0;for(j of C)if(K=I.indexOf(j),K>-1)break;if(-1===K)return new U(I);const i=I.substring(0,K).trim(),y=I.substring(K+j.length).trim();return new Q(i,j,y)}function H(I,O){const C=new y,j=I.substring(0,O);let K=I.substring(O);return K=K.substring(0,(K.indexOf("//")+1||K.length+1)-1).trim(),C.testExpression="#ifdef"===j?new U(K):"#ifndef"===j?new U(K,!0):function(I){I=I.replace(q,"defined[$1]");const O=S.infixToPostfix(I),C=[];for(const K of O)if("||"!==K&&"&&"!==K)C.push(K);else if(C.length>=2){let I=C[C.length-1],O=C[C.length-2];C.length-=2;const j="&&"==K?new N:new p;"string"===typeof I&&(I=I.replace(mI,"defined($1)")),"string"===typeof O&&(O=O.replace(mI,"defined($1)")),j.leftOperand="string"===typeof O?T(O):O,j.rightOperand="string"===typeof I?T(I):I,C.push(j)}let j=C[C.length-1];return"string"===typeof j&&(j=j.replace(mI,"defined($1)")),"string"===typeof j?T(j):j}(K),C}function b(I,O,C,K){let i=I.currentLine;for(;a(I,C,K);){i=I.currentLine;const y=i.substring(0,5).toLowerCase();if("#else"===y){const C=new j;return O.children.push(C),void a(I,C,K)}if("#elif"===y){const I=H(i,5);O.children.push(I),C=I}}}function a(I,O,C){for(;I.canRead;){I.lineIndex++;const K=I.currentLine;if(K.indexOf("#")>=0){const j=o.exec(K);if(j&&j.length){switch(j[0]){case"#ifdef":{const j=new i;O.children.push(j);const y=H(K,6);j.children.push(y),b(I,j,y,C);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const j=new i;O.children.push(j);const y=H(K,7);j.children.push(y),b(I,j,y,C);break}case"#if":{const j=new i,y=H(K,3);O.children.push(j),j.children.push(y),b(I,j,y,C);break}}continue}}const y=new j;if(y.line=K,O.children.push(y),"#"===K[0]&&"d"===K[1]){const I=K.replace(";","").split(" ");y.additionalDefineKey=I[1],3===I.length&&(y.additionalDefineValue=I[2])}}return!1}function M(I,O,C,i){const y=new j,S=new K;return S.lineIndex=-1,S.lines=I.split("\n"),a(S,y,i),y.process(O,C,i)}function u(I,O){var C;const j=I.defines,K={};for(const i of j){const I=i.replace("#define","").replace(";","").trim().split(" ");K[I[0]]=I.length>1?I[1]:""}return 0===(null===(C=I.processor)||void 0===C?void 0:C.shaderLanguage)&&(K.GL_ES="true"),K.__VERSION__=I.version,K[I.platformName]="true",(0,Z.g)(K,null===O||void 0===O?void 0:O.isNDCHalfZRange,null===O||void 0===O?void 0:O.jS,null===O||void 0===O?void 0:O.useExactSrgbConversions),K}function J(I,O,C){let j;for(Y.length=0;null!==(j=E.exec(I));)Y.push(j);let K=String(I),i=[I],y=!1;for(const S of Y){let I=S[1];if(-1!==I.indexOf("__decl__")&&(I=I.replace(h,""),O.supportsUniformBuffers&&(I=I.replace("Vertex","Ubo").replace("Fragment","Ubo")),I+="Declaration"),!O.includesShadersStore[I]){const j=O.shadersRepository+"ShadersInclude/"+I+".fx";return void f.loadFile(j,(j=>{O.includesShadersStore[I]=j,J(i.join(""),O,C)}))}{let C=O.includesShadersStore[I];if(S[2]){const I=S[3].split(",");for(let O=0;O<I.length;O+=2){const j=new RegExp(I[O],"g"),K=I[O+1];C=C.replace(j,K)}}if(S[4]){const I=S[5];if(-1!==I.indexOf("..")){const j=I.split(".."),K=parseInt(j[0]);let i=parseInt(j[1]),y=C.slice(0);C="",isNaN(i)&&(i=O.indexParameters[j[1]]);for(let I=K;I<i;I++)O.supportsUniformBuffers||(y=y.replace(r,((I,O)=>O+"{X}"))),C+=y.replace(W,I.toString())+"\n"}else O.supportsUniformBuffers||(C=C.replace(r,((I,O)=>O+"{X}"))),C=C.replace(W,I)}const j=[];for(const I of i){const O=I.split(S[0]);for(let I=0;I<O.length-1;I++)j.push(O[I]),j.push(C);j.push(O[O.length-1])}i=j,y=y||C.indexOf("#include<")>=0||C.indexOf("#include <")>=0}}Y.length=0,K=i.join(""),y?J(K.toString(),O,C):C(K)}const f={loadFile:(I,O,C,j,K,i)=>{throw(0,s.b)("FileTools")}}},12160:(I,O,C)=>{C.d(O,{b:()=>K,c:()=>i,g:()=>S,j:()=>y,m:()=>U});var j=C(12126);C(12095);const K={};function i(I,O){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(O?O+"\n":"")+I}function y(I,O,C,i,y,S,U){const p=U||K.loadFile;if(p){return p(I,O,C,i,y,S)}throw(0,j.b)("FileTools")}function S(I,O,C,j){if(I)return O?I.IS_NDC_HALF_ZRANGE="":delete I.IS_NDC_HALF_ZRANGE,C?I.USE_REVERSE_DEPTHBUFFER="":delete I.USE_REVERSE_DEPTHBUFFER,void(j?I.USE_EXACT_SRGB_CONVERSIONS="":delete I.USE_EXACT_SRGB_CONVERSIONS);{let I="";return O&&(I+="#define IS_NDC_HALF_ZRANGE"),C&&(I&&(I+="\n"),I+="#define USE_REVERSE_DEPTHBUFFER"),j&&(I&&(I+="\n"),I+="#define USE_EXACT_SRGB_CONVERSIONS"),I}}function U(I,O){let C=arguments.length>2&&void 0!==arguments[2]&&arguments[2],j=arguments.length>3?arguments[3]:void 0;switch(I){case 3:{const I=(ArrayBuffer,new Int8Array(O));return j&&I.set(new Int8Array(j)),I}case 0:{const I=(ArrayBuffer,new Uint8Array(O));return j&&I.set(new Uint8Array(j)),I}case 4:{const I=O instanceof ArrayBuffer?new Int16Array(O):new Int16Array(C?O/2:O);return j&&I.set(new Int16Array(j)),I}case 5:case 8:case 9:case 10:case 2:{const I=O instanceof ArrayBuffer?new Uint16Array(O):new Uint16Array(C?O/2:O);return j&&I.set(new Uint16Array(j)),I}case 6:{const I=O instanceof ArrayBuffer?new Int32Array(O):new Int32Array(C?O/4:O);return j&&I.set(new Int32Array(j)),I}case 7:case 11:case 12:case 13:case 14:case 15:{const I=O instanceof ArrayBuffer?new Uint32Array(O):new Uint32Array(C?O/4:O);return j&&I.set(new Uint32Array(j)),I}case 1:{const I=O instanceof ArrayBuffer?new Float32Array(O):new Float32Array(C?O/4:O);return j&&I.set(new Float32Array(j)),I}}const K=(ArrayBuffer,new Uint8Array(O));return j&&K.set(new Uint8Array(j)),K}},12179:(I,O,C)=>{C.d(O,{b:()=>j});class j{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.ShadersRepository:j.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.ShadersStore:j.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?j.IncludesShadersStore:j.IncludesShadersStoreWGSL}}j.ShadersRepository="src/Shaders/",j.ShadersStore={},j.IncludesShadersStore={},j.ShadersRepositoryWGSL="src/ShadersWGSL/",j.ShadersStoreWGSL={},j.IncludesShadersStoreWGSL={}},12189:(I,O,C)=>{C.d(O,{d:()=>s,g:()=>W,j:()=>q,l:()=>Z,n:()=>mI,p:()=>r,s:()=>Q,v:()=>p,z:()=>N,D:()=>U,G:()=>S});class j{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.qO._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(I){I&&this.program&&I(this.program)}setEngine(I){this.qO=I}_fillEffectInformation(I,O,C,j,K,i,y,S){const U=this.qO;if(U.supportsUniformBuffers)for(const N in O)I.bindUniformBlock(N,O[N]);let p;for(this.qO.getUniforms(this,C).forEach(((I,O)=>{j[C[O]]=I})),this._uniforms=j,p=0;p<K.length;p++){null==I.getUniform(K[p])&&(K.splice(p,1),p--)}K.forEach(((I,O)=>{i[I]=O}));for(const N of U.getAttributes(this,y))S.push(N)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(I,O){const C=this._valueCache[I],j=O.updateFlag;return(void 0===C||C!==j)&&(this._valueCache[I]=j,!0)}_cacheFloat2(I,O,C){let j=this._valueCache[I];if(!j||2!==j.length)return j=[O,C],this._valueCache[I]=j,!0;let K=!1;return j[0]!==O&&(j[0]=O,K=!0),j[1]!==C&&(j[1]=C,K=!0),K}_cacheFloat3(I,O,C,j){let K=this._valueCache[I];if(!K||3!==K.length)return K=[O,C,j],this._valueCache[I]=K,!0;let i=!1;return K[0]!==O&&(K[0]=O,i=!0),K[1]!==C&&(K[1]=C,i=!0),K[2]!==j&&(K[2]=j,i=!0),i}_cacheFloat4(I,O,C,j,K){let i=this._valueCache[I];if(!i||4!==i.length)return i=[O,C,j,K],this._valueCache[I]=i,!0;let y=!1;return i[0]!==O&&(i[0]=O,y=!0),i[1]!==C&&(i[1]=C,y=!0),i[2]!==j&&(i[2]=j,y=!0),i[3]!==K&&(i[3]=K,y=!0),y}setInt(I,O){const C=this._valueCache[I];void 0!==C&&C===O||this.qO.setInt(this._uniforms[I],O)&&(this._valueCache[I]=O)}setInt2(I,O,C){this._cacheFloat2(I,O,C)&&(this.qO.setInt2(this._uniforms[I],O,C)||(this._valueCache[I]=null))}setInt3(I,O,C,j){this._cacheFloat3(I,O,C,j)&&(this.qO.setInt3(this._uniforms[I],O,C,j)||(this._valueCache[I]=null))}setInt4(I,O,C,j,K){this._cacheFloat4(I,O,C,j,K)&&(this.qO.setInt4(this._uniforms[I],O,C,j,K)||(this._valueCache[I]=null))}setIntArray(I,O){this._valueCache[I]=null,this.qO.setIntArray(this._uniforms[I],O)}setIntArray2(I,O){this._valueCache[I]=null,this.qO.setIntArray2(this._uniforms[I],O)}setIntArray3(I,O){this._valueCache[I]=null,this.qO.setIntArray3(this._uniforms[I],O)}setIntArray4(I,O){this._valueCache[I]=null,this.qO.setIntArray4(this._uniforms[I],O)}setUInt(I,O){const C=this._valueCache[I];void 0!==C&&C===O||this.qO.setUInt(this._uniforms[I],O)&&(this._valueCache[I]=O)}setUInt2(I,O,C){this._cacheFloat2(I,O,C)&&(this.qO.setUInt2(this._uniforms[I],O,C)||(this._valueCache[I]=null))}setUInt3(I,O,C,j){this._cacheFloat3(I,O,C,j)&&(this.qO.setUInt3(this._uniforms[I],O,C,j)||(this._valueCache[I]=null))}setUInt4(I,O,C,j,K){this._cacheFloat4(I,O,C,j,K)&&(this.qO.setUInt4(this._uniforms[I],O,C,j,K)||(this._valueCache[I]=null))}setUIntArray(I,O){this._valueCache[I]=null,this.qO.setUIntArray(this._uniforms[I],O)}setUIntArray2(I,O){this._valueCache[I]=null,this.qO.setUIntArray2(this._uniforms[I],O)}setUIntArray3(I,O){this._valueCache[I]=null,this.qO.setUIntArray3(this._uniforms[I],O)}setUIntArray4(I,O){this._valueCache[I]=null,this.qO.setUIntArray4(this._uniforms[I],O)}setArray(I,O){this._valueCache[I]=null,this.qO.setArray(this._uniforms[I],O)}setArray2(I,O){this._valueCache[I]=null,this.qO.setArray2(this._uniforms[I],O)}setArray3(I,O){this._valueCache[I]=null,this.qO.setArray3(this._uniforms[I],O)}setArray4(I,O){this._valueCache[I]=null,this.qO.setArray4(this._uniforms[I],O)}setMatrices(I,O){O&&(this._valueCache[I]=null,this.qO.setMatrices(this._uniforms[I],O))}setMatrix(I,O){this._cacheMatrix(I,O)&&(this.qO.setMatrices(this._uniforms[I],O.qS())||(this._valueCache[I]=null))}setMatrix3x3(I,O){this._valueCache[I]=null,this.qO.setMatrix3x3(this._uniforms[I],O)}setMatrix2x2(I,O){this._valueCache[I]=null,this.qO.setMatrix2x2(this._uniforms[I],O)}setFloat(I,O){const C=this._valueCache[I];void 0!==C&&C===O||this.qO.setFloat(this._uniforms[I],O)&&(this._valueCache[I]=O)}setVector2(I,O){this._cacheFloat2(I,O.x,O.y)&&(this.qO.setFloat2(this._uniforms[I],O.x,O.y)||(this._valueCache[I]=null))}setFloat2(I,O,C){this._cacheFloat2(I,O,C)&&(this.qO.setFloat2(this._uniforms[I],O,C)||(this._valueCache[I]=null))}setVector3(I,O){this._cacheFloat3(I,O.x,O.y,O.z)&&(this.qO.setFloat3(this._uniforms[I],O.x,O.y,O.z)||(this._valueCache[I]=null))}setFloat3(I,O,C,j){this._cacheFloat3(I,O,C,j)&&(this.qO.setFloat3(this._uniforms[I],O,C,j)||(this._valueCache[I]=null))}setVector4(I,O){this._cacheFloat4(I,O.x,O.y,O.z,O.w)&&(this.qO.setFloat4(this._uniforms[I],O.x,O.y,O.z,O.w)||(this._valueCache[I]=null))}setQuaternion(I,O){this._cacheFloat4(I,O.x,O.y,O.z,O.w)&&(this.qO.setFloat4(this._uniforms[I],O.x,O.y,O.z,O.w)||(this._valueCache[I]=null))}setFloat4(I,O,C,j,K){this._cacheFloat4(I,O,C,j,K)&&(this.qO.setFloat4(this._uniforms[I],O,C,j,K)||(this._valueCache[I]=null))}setColor3(I,O){this._cacheFloat3(I,O.r,O.g,O.b)&&(this.qO.setFloat3(this._uniforms[I],O.r,O.g,O.b)||(this._valueCache[I]=null))}setColor4(I,O,C){this._cacheFloat4(I,O.r,O.g,O.b,C)&&(this.qO.setFloat4(this._uniforms[I],O.r,O.g,O.b,C)||(this._valueCache[I]=null))}setDirectColor4(I,O){this._cacheFloat4(I,O.r,O.g,O.b,O.a)&&(this.qO.setFloat4(this._uniforms[I],O.r,O.g,O.b,O.a)||(this._valueCache[I]=null))}_getVertexShaderCode(){return this.vertexShader?this.qO._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.qO._getShaderSource(this.fragmentShader):null}}var K=C(12160);const i=new WeakMap,y={_webGLVersion:2,cachedPipelines:{}};function S(I){let O=i.get(I);if(!O){if(!I)return y;O={_webGLVersion:I.TEXTURE_BINDING_3D?2:1,_context:I,parallelShaderCompile:I.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},i.set(I,O)}return O}function U(I){i.delete(I)}function p(I,O,C,j,K,i){const y=S(j);i||(i=y._createShaderProgramInjection??s);return i(I,h(O,"vertex",j,y._contextWasLost),h(C,"fragment",j,y._contextWasLost),j,K,y.validateShaderPrograms)}function N(I,O,C,j,K){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,y=arguments.length>6?arguments[6]:void 0;const U=S(K);y||(y=U._createShaderProgramInjection??s);const p=U._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return y(I,E(O,"vertex",j,p,K,U._contextWasLost),E(C,"fragment",j,p,K,U._contextWasLost),K,i,U.validateShaderPrograms)}function Q(I,O){const C=new j,K=S(I);return K.parallelShaderCompile&&!K.disableParallelShaderCompile&&(C.isParallelCompiled=!0),C.context=K._context,C}function s(I,O,C,j){let K=arguments.length>5?arguments[5]:void 0;const i=j.createProgram();if(I.program=i,!i)throw new Error("Unable to create program");return j.attachShader(i,O),j.attachShader(i,C),j.linkProgram(i),I.context=j,I.vertexShader=O,I.fragmentShader=C,I.isParallelCompiled||q(I,j,K),i}function Z(I,O,C){const j=I;if(j._isDisposed)return!1;const K=S(O);return!!(K&&K.parallelShaderCompile&&K.parallelShaderCompile.COMPLETION_STATUS_KHR&&j.program&&O.getProgramParameter(j.program,K.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(q(j,O,C),!0)}function q(I,O,C){const j=I.context,K=I.vertexShader,i=I.fragmentShader,y=I.program;if(!j.getProgramParameter(y,j.LINK_STATUS)){if(!O.getShaderParameter(K,O.COMPILE_STATUS)){const C=O.getShaderInfoLog(K);if(C)throw I.vertexCompilationError=C,new Error("VERTEX SHADER "+C)}if(!O.getShaderParameter(i,O.COMPILE_STATUS)){const C=O.getShaderInfoLog(i);if(C)throw I.fragmentCompilationError=C,new Error("FRAGMENT SHADER "+C)}const C=j.getProgramInfoLog(y);if(C)throw I.programLinkError=C,new Error(C)}if(C){j.validateProgram(y);if(!j.getProgramParameter(y,j.VALIDATE_STATUS)){const O=j.getProgramInfoLog(y);if(O)throw I.programValidationError=O,new Error(O)}}j.deleteShader(K),j.deleteShader(i),I.vertexShader=void 0,I.fragmentShader=void 0,I.onCompiled&&(I.onCompiled(),I.onCompiled=void 0)}function mI(I,O,C,j,K,i,y,U,Q){let s=arguments.length>10?arguments[10]:void 0,Z=arguments.length>11?arguments[11]:void 0,q=arguments.length>12?arguments[12]:void 0;const mI=S(I.context);Z||(Z=mI.createRawShaderProgramInjection??p),q||(q=mI.createShaderProgramInjection??N);const E=I;E.program=j?Z(E,O,C,E.context,Q):q(E,O,C,U,E.context,Q),E.program.__SPECTOR_rebuildProgram=y,s()}function E(I,O,C,j,i,y){return h((0,K.c)(I,C,j),O,i,y)}function h(I,O,C,j){const K=C.createShader("vertex"===O?C.VERTEX_SHADER:C.FRAGMENT_SHADER);if(!K){let I=C.NO_ERROR,K=C.NO_ERROR;for(;(K=C.getError())!==C.NO_ERROR;)I=K;throw new Error(`Something went wrong while creating a gl ${O} shader object. gl error=${I}, gl isContextLost=${C.isContextLost()}, _contextWasLost=${j}`)}return C.shaderSource(K,I),C.compileShader(K),K}function r(I,O){O.useProgram(I)}function W(I,O){const C=I;if(!C.isParallelCompiled)return void O(I);const j=C.onCompiled;C.onCompiled=()=>{null===j||void 0===j||j(),O(I)}}},12184:(I,O,C)=>{C.d(O,{d:()=>Q,g:()=>Z,i:()=>p,j:()=>N});var j=C(12095),K=C(12189),i=C(12179),y=C(12103),S=C(12158),U=C(12160);function p(I,O){return(0,K.G)(O).cachedPipelines[I]}function N(I){const O=I._name,C=I.context;if(O&&C){const I=(0,K.G)(C),j=I.cachedPipelines[O];null===j||void 0===j||j.dispose(),delete I.cachedPipelines[O]}}function Q(I,O,C,K,i,y,U){let p,N;const Q=(0,j.k)()?null===y||void 0===y?void 0:y.getHostDocument():null;p="string"===typeof O?O:O.vertexSource?"source:"+O.vertexSource:O.vertexElement?(null===Q||void 0===Q?void 0:Q.getElementById(O.vertexElement))||O.vertexElement:O.vertex||O,N="string"===typeof O?O:O.fragmentSource?"source:"+O.fragmentSource:O.fragmentElement?(null===Q||void 0===Q?void 0:Q.getElementById(O.fragmentElement))||O.fragmentElement:O.fragment||O;const Z=[void 0,void 0],q=()=>{if(Z[0]&&Z[1]){I.isFragment=!0;const[j,p]=Z;(0,S.l)(p,I,((y,p)=>{U&&(U._fragmentSourceCodeBeforeMigration=p),C&&(y=C("fragment",y));const N=(0,S.c)(j,y,I);I=null;const Q=function(I,O,C,j){if(C){return{vertexSourceCode:(1===j?"//":"")+"#define SHADER_NAME vertex:"+(C.vertexElement||C.vertex||C.spectorName||C)+"\n"+I,fragmentSourceCode:(1===j?"//":"")+"#define SHADER_NAME fragment:"+(C.fragmentElement||C.fragment||C.spectorName||C)+"\n"+O}}return{vertexSourceCode:I,fragmentSourceCode:O}}(N.vertexCode,N.fragmentCode,O,i);null===K||void 0===K||K(Q.vertexSourceCode,Q.fragmentSourceCode)}),y)}};s(p,"Vertex","",(O=>{(0,S.f)(I),(0,S.l)(O,I,((I,j)=>{U&&(U._rawVertexSourceCode=O,U._vertexSourceCodeBeforeMigration=j),C&&(I=C("vertex",I)),Z[0]=I,q()}),y)}),i),s(N,"Fragment","Pixel",(I=>{U&&(U._rawFragmentSourceCode=I),Z[1]=I,q()}),i)}function s(I,O,C,K,y,S){if("undefined"!==typeof HTMLElement&&I instanceof HTMLElement){return void K((0,j.b)(I))}if("source:"===I.substring(0,7))return void K(I.substring(7));if("base64:"===I.substring(0,7)){return void K(window.atob(I.substring(7)))}const p=i.b.GetShadersStore(y);if(p[I+O+"Shader"])return void K(p[I+O+"Shader"]);if(C&&p[I+C+"Shader"])return void K(p[I+C+"Shader"]);let N;if(N="."===I[0]||"/"===I[0]||I.indexOf("http")>-1?I:i.b.GetShadersRepository(y)+I,!(S=S||U.j))throw new Error("loadFileInjection is not defined");S(N+"."+O.toLowerCase()+".fx",K)}const Z=(I,O,C,j)=>{try{const i=I.context?(0,K.G)(I.context):null;i&&(i.disableParallelShaderCompile=I.disableParallelCompilation);const y=I.existingPipelineContext||O(I.shaderProcessingContext);return y._name=I.name,I.name&&i&&(i.cachedPipelines[I.name]=y),C(y,I.vertex,I.fragment,!!I.createAsRaw,"","",I.rebuildRebind,I.defines,I.transformFeedbackVaryings,"",(()=>{j(y,(()=>{var O;null===(O=I.onRenderingStateCompiled)||void 0===O||O.call(I,y)}))})),y}catch(i){throw y.c.Error("Error compiling effect"),i}}},12171:(I,O,C)=>{C.r(O),C.d(O,{Effect:()=>U});var j=C(12088),K=C(12103),i=C(12179),y=C(12184),S=C(12163);class U{static get ShadersRepository(){return i.b.ShadersRepository}static set ShadersRepository(I){i.b.ShadersRepository=I}get p(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new j.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(I,O,C){let K=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4?arguments[4]:void 0,S=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,N=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,Q=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9?arguments[9]:void 0,Z=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",q=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,mI=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new j.c,this.onErrorObservable=new j.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=I,this._key=Z;const E=this._key.replace(/\r/g,"").replace(/\n/g,"|");let h;if(O.attributes){const I=O;if(this._engine=C,this._attributesNames=I.attributes,this._uniformsNames=I.uniformsNames.concat(I.samplers),this._samplerList=I.samplers.slice(),this.defines=I.defines,this.onError=I.onError,this.onCompiled=I.onCompiled,this._fallbacks=I.fallbacks,this._indexParameters=I.indexParameters,this._transformFeedbackVaryings=I.transformFeedbackVaryings||null,this._multiTarget=!!I.multiTarget,this._shaderLanguage=I.shaderLanguage??0,this._disableParallelShaderCompilation=!!I.disableParallelShaderCompilation,I.uniformBuffersNames){this._uniformBuffersNamesList=I.uniformBuffersNames.slice();for(let O=0;O<I.uniformBuffersNames.length;O++)this._uniformBuffersNames[I.uniformBuffersNames[O]]=O}this._processFinalCode=I.processFinalCode??null,this._processCodeAfterIncludes=I.processCodeAfterIncludes??void 0,mI=I.extraInitializationsAsync,h=I.existingPipelineContext}else this._engine=i,this.defines=null==S?"":S,this._uniformsNames=C.concat(K),this._samplerList=K?K.slice():[],this._attributesNames=O,this._uniformBuffersNamesList=[],this._shaderLanguage=q,this.onError=Q,this.onCompiled=N,this._indexParameters=s,this._fallbacks=p;"WEBGL2"===this._engine.shaderPlatformName&&(h=(0,y.i)(E,this._engine._gl)??h),this._attributeLocationByName={},this.uniqueId=U._UniqueIdSeed++,h?(this._pipelineContext=h,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,mI),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.p||this.dispose(!0)}))}async _processShaderCodeAsync(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,j=arguments.length>3?arguments[3]:void 0;j&&await j(),this._processingContext=C||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const K={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:I??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:i.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:i.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,jS:this._engine.jS,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,y.d)(K,this.name,this._processFinalCode,((I,C)=>{this._vertexSourceCode=I,this._fragmentSourceCode=C,this._prepareEffect(O)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.p||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(I){return this._attributes[I]}getAttributeLocationByName(I){return this._attributeLocationByName[I]}getAttributesCount(){return this._attributes.length}getUniformIndex(I){return this._uniformsNames.indexOf(I)}getUniform(I){return this._uniforms[I]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((I=>{this.executeWhenCompiled(I)}))}executeWhenCompiled(I){this.isReady()?I(this):(this.onCompileObservable.add((O=>{I(O)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(I){(0,S.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(O=>{this._processCompilationErrors(O,I)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,jS:this._engine.jS,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(I,O,C,j){this._isReady=!1,this._vertexSourceCodeOverride=I,this._fragmentSourceCodeOverride=O,this.onError=(I,O)=>{j&&j(O)},this.onCompiled=()=>{var I,O;const j=this.getEngine().scenes;if(j)for(let C=0;C<j.length;C++)j[C].markAllMaterialsAsDirty(127);null===(I=(O=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===I||I.call(O,C)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(I){if(this._pipelineContext=I,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let O=0;O<this._attributesNames.length;O++){const I=this._attributesNames[O];this._attributeLocationByName[I]=this._attributes[O]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),U.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=this._pipelineContext;this._isReady=!1;try{const C=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),j=C?null:this.defines,K=C?this._vertexSourceCodeOverride:this._vertexSourceCode,i=C?this._fragmentSourceCodeOverride:this._fragmentSourceCode,S=this._engine;this._pipelineContext=(0,y.g)({existingPipelineContext:I?O:null,vertex:K,fragment:i,context:"WEBGL2"===S.shaderPlatformName||"WEBGL1"===S.shaderPlatformName?S._gl:void 0,rebuildRebind:(I,O,C,j)=>this._rebuildProgram(I,O,C,j),defines:j,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:C,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:C=>{O&&!I&&this._engine._deletePipelineContext(O),C&&this._onRenderingStateCompiled(C)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(O)}catch(C){this._processCompilationErrors(C,O)}}_getShaderCodeAndErrorLine(I,O,C){const j=C?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let K=null;if(O&&I){const i=O.match(j);if(i&&2===i.length){const O=parseInt(i[1]),j=I.split("\n",-1);j.length>=O&&(K=`Offending line [${O}] in ${C?"fragment":"vertex"} code: ${j[O-1]}`)}}return[I,K]}_processCompilationErrors(I){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=I.message;const C=this._attributesNames,j=this._fallbacks;if(K.c.Error("Unable to compile effect:"),K.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),K.c.Error(`Attributes: ${C.join(" ")}`),K.c.Error("Defines:\n"+this.defines),U.LogShaderCodeOnCompilationError){var i,y;let I=null,O=null,C=null;var S;if(null!==(i=this._pipelineContext)&&void 0!==i&&i._getVertexShaderCode()&&([C,I]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),C&&(K.c.Error("Vertex code:"),K.c.Error(C))),null!==(y=this._pipelineContext)&&void 0!==y&&y._getFragmentShaderCode())[C,O]=this._getShaderCodeAndErrorLine(null===(S=this._pipelineContext)||void 0===S?void 0:S._getFragmentShaderCode(),this._compilationError,!0),C&&(K.c.Error("Fragment code:"),K.c.Error(C));I&&K.c.Error(I),O&&K.c.Error(O)}K.c.Error("Error: "+this._compilationError);const p=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};O&&(this._pipelineContext=O,this._isReady=!0,p()),j?(this._pipelineContext=null,j.hasMoreFallbacks?(this._allFallbacksProcessed=!1,K.c.Error("Trying next fallback."),this.defines=j.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,p(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,O||p())}get isSupported(){return""===this._compilationError}_bindTexture(I,O){this._engine._bindTexture(this._samplers[I],O,I)}setTexture(I,O){this._engine.setTexture(this._samplers[I],this._uniforms[I],O,I)}setTextureArray(I,O){const C=I+"Ex";if(-1===this._samplerList.indexOf(C+"0")){const j=this._samplerList.indexOf(I);for(let I=1;I<O.length;I++){const O=C+(I-1).toString();this._samplerList.splice(j+I,0,O)}let K=0;for(const I of this._samplerList)this._samplers[I]=K,K+=1}this._engine.setTextureArray(this._samplers[I],this._uniforms[I],O,I)}bindUniformBuffer(I,O){const C=this._uniformBuffersNames[O];void 0===C||U._BaseCache[C]===I&&this._engine._features.useUBOBindingCache||(U._BaseCache[C]=I,this._engine.bindUniformBufferBase(I,C,O))}bindUniformBlock(I,O){this._engine.bindUniformBlock(this._pipelineContext,I,O)}setInt(I,O){return this._pipelineContext.setInt(I,O),this}setInt2(I,O,C){return this._pipelineContext.setInt2(I,O,C),this}setInt3(I,O,C,j){return this._pipelineContext.setInt3(I,O,C,j),this}setInt4(I,O,C,j,K){return this._pipelineContext.setInt4(I,O,C,j,K),this}setIntArray(I,O){return this._pipelineContext.setIntArray(I,O),this}setIntArray2(I,O){return this._pipelineContext.setIntArray2(I,O),this}setIntArray3(I,O){return this._pipelineContext.setIntArray3(I,O),this}setIntArray4(I,O){return this._pipelineContext.setIntArray4(I,O),this}setUInt(I,O){return this._pipelineContext.setUInt(I,O),this}setUInt2(I,O,C){return this._pipelineContext.setUInt2(I,O,C),this}setUInt3(I,O,C,j){return this._pipelineContext.setUInt3(I,O,C,j),this}setUInt4(I,O,C,j,K){return this._pipelineContext.setUInt4(I,O,C,j,K),this}setUIntArray(I,O){return this._pipelineContext.setUIntArray(I,O),this}setUIntArray2(I,O){return this._pipelineContext.setUIntArray2(I,O),this}setUIntArray3(I,O){return this._pipelineContext.setUIntArray3(I,O),this}setUIntArray4(I,O){return this._pipelineContext.setUIntArray4(I,O),this}setFloatArray(I,O){return this._pipelineContext.setArray(I,O),this}setFloatArray2(I,O){return this._pipelineContext.setArray2(I,O),this}setFloatArray3(I,O){return this._pipelineContext.setArray3(I,O),this}setFloatArray4(I,O){return this._pipelineContext.setArray4(I,O),this}setArray(I,O){return this._pipelineContext.setArray(I,O),this}setArray2(I,O){return this._pipelineContext.setArray2(I,O),this}setArray3(I,O){return this._pipelineContext.setArray3(I,O),this}setArray4(I,O){return this._pipelineContext.setArray4(I,O),this}setMatrices(I,O){return this._pipelineContext.setMatrices(I,O),this}setMatrix(I,O){return this._pipelineContext.setMatrix(I,O),this}setMatrix3x3(I,O){return this._pipelineContext.setMatrix3x3(I,O),this}setMatrix2x2(I,O){return this._pipelineContext.setMatrix2x2(I,O),this}setFloat(I,O){return this._pipelineContext.setFloat(I,O),this}setBool(I,O){return this._pipelineContext.setInt(I,O?1:0),this}setVector2(I,O){return this._pipelineContext.setVector2(I,O),this}setFloat2(I,O,C){return this._pipelineContext.setFloat2(I,O,C),this}setVector3(I,O){return this._pipelineContext.setVector3(I,O),this}setFloat3(I,O,C,j){return this._pipelineContext.setFloat3(I,O,C,j),this}setVector4(I,O){return this._pipelineContext.setVector4(I,O),this}setQuaternion(I,O){return this._pipelineContext.setQuaternion(I,O),this}setFloat4(I,O,C,j,K){return this._pipelineContext.setFloat4(I,O,C,j,K),this}setColor3(I,O){return this._pipelineContext.setColor3(I,O),this}setColor4(I,O,C){return this._pipelineContext.setColor4(I,O,C),this}setDirectColor4(I,O){return this._pipelineContext.setDirectColor4(I,O),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(U.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,y.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(I,O,C){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;O&&(i.b.GetShadersStore(j)[`${I}PixelShader`]=O),C&&(i.b.GetShadersStore(j)[`${I}VertexShader`]=C)}static ResetCache(){U._BaseCache={}}}U.LogShaderCodeOnCompilationError=!0,U.PersistentMode=!1,U.AutomaticallyClearCodeCache=!1,U._UniqueIdSeed=0,U._BaseCache={},U.ShadersStore=i.b.ShadersStore,U.IncludesShadersStore=i.b.IncludesShadersStore},12126:(I,O,C)=>{C.d(O,{b:()=>K});const j={};function K(I){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!j[I])return j[I]=!0,`${I} needs to be imported before as it contains a side-effect required by your code.`}},12095:(I,O,C)=>{function j(){return"undefined"!==typeof window}function K(){return"undefined"!==typeof navigator}function i(){return"undefined"!==typeof document}function y(I){let O="",C=I.firstChild;for(;C;)3===C.nodeType&&(O+=C.textContent),C=C.nextSibling;return O}C.d(O,{b:()=>y,f:()=>i,i:()=>K,k:()=>j})},12103:(I,O,C)=>{C.d(O,{c:()=>j});class j{static _CheckLimit(I,O){let C=j._LogLimitOutputs[I];return C?C.current++:(C={limit:O,current:1},j._LogLimitOutputs[I]=C),C.current<=C.limit}static _GenerateLimitMessage(I){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const C=j._LogLimitOutputs[I];if(!C||!j.MessageLimitReached)return;const K=this._Levels[O];C.current===C.limit&&j[K.name](j.MessageLimitReached.replace(/%LIMIT%/g,""+C.limit).replace(/%TYPE%/g,K.name??""))}static _AddLogEntry(I){j._LogCache=I+j._LogCache,j.OnNewCacheEntry&&j.OnNewCacheEntry(I)}static _FormatMessage(I){const O=I=>I<10?"0"+I:""+I,C=new Date;return"["+O(C.getHours())+":"+O(C.getMinutes())+":"+O(C.getSeconds())+"]: "+I}static _LogDisabled(I,O){}static _LogEnabled(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,O=arguments.length>1?arguments[1]:void 0,C=arguments.length>2?arguments[2]:void 0;const K=Array.isArray(O)?O[0]:O;if(void 0!==C&&!j._CheckLimit(K,C))return;const i=j._FormatMessage(K),y=this._Levels[I],S=Array.isArray(O)?O.slice(1):[];y.logFunc&&y.logFunc("BJS - "+i,...S);const U=`<div style='color:${y.color}'>${i}</div><br>`;j._AddLogEntry(U),j._GenerateLimitMessage(K,I)}static get LogCache(){return j._LogCache}static ClearLogCache(){j._LogCache="",j._LogLimitOutputs={},j.errorsCount=0}static set LogLevels(I){j.Log=j._LogDisabled,j.Warn=j._LogDisabled,j.Error=j._LogDisabled;const O=[j.MessageLogLevel,j.WarningLogLevel,j.ErrorLogLevel];for(const C of O)if((I&C)===C){const I=this._Levels[C];j[I.name]=j._LogEnabled.bind(j,C)}}}j.NoneLogLevel=0,j.MessageLogLevel=1,j.WarningLogLevel=2,j.ErrorLogLevel=4,j.AllLogLevel=7,j.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",j._LogCache="",j._LogLimitOutputs={},j._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],j.errorsCount=0,j.Log=j._LogEnabled.bind(j,j.MessageLogLevel),j.Warn=j._LogEnabled.bind(j,j.WarningLogLevel),j.Error=j._LogEnabled.bind(j,j.ErrorLogLevel)},12088:(I,O,C)=>{C.d(O,{c:()=>y});const j="undefined"!==typeof WeakRef;class K{constructor(I){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0;this.initialize(I,O,C,j)}initialize(I){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],C=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0;return this.mask=I,this.skipNextObservers=O,this.target=C,this.currentTarget=j,this}}class i{constructor(I,O){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=I,this.mask=O,this.scope=C,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(I)}}class y{static FromPromise(I,O){const C=new y;return I.then((I=>{C.notifyObservers(I)})).catch((I=>{if(!O)throw I;O.notifyObservers(I)})),C}get observers(){return this._observers}constructor(I){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=O,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new K(0),I&&(this._onObserverAdded=I)}add(I){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2],C=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!I)return null;const K=new i(I,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);K.unregisterOnNextCall=C,O?this._observers.unshift(K):this._observers.push(K),this._onObserverAdded&&this._onObserverAdded(K),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(K,this._lastNotifiedValue);const y=j?new WeakRef(this):{deref:()=>this};return K._remove=function(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=y.deref();O&&(I?O.remove(K):O._remove(K))},K}addOnce(I){return this.add(I,void 0,void 0,void 0,!0)}remove(I){if(!I)return!1;I._remove=null;return-1!==this._observers.indexOf(I)&&(this._deferUnregister(I),!0)}removeCallback(I,O){for(let C=0;C<this._observers.length;C++){const j=this._observers[C];if(!j._willBeUnregistered&&(j.callback===I&&(!O||O===j.scope)))return this._deferUnregister(j),!0}return!1}_deferUnregister(I){I._willBeUnregistered||(this._numObserversMarkedAsDeleted++,I.unregisterOnNextCall=!1,I._willBeUnregistered=!0,setTimeout((()=>{this._remove(I)}),0))}_remove(I){let O=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!I)return!1;const C=this._observers.indexOf(I);return-1!==C&&(O&&this._numObserversMarkedAsDeleted--,this._observers.splice(C,1),!0)}makeObserverTopPriority(I){this._remove(I,!1),this._observers.unshift(I)}makeObserverBottomPriority(I){this._remove(I,!1),this._observers.push(I)}notifyObservers(I){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,C=arguments.length>2?arguments[2]:void 0,j=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=I),!this._observers.length)return!0;const i=this._eventState;i.mask=O,i.target=C,i.currentTarget=j,i.skipNextObservers=!1,i.lastReturnValue=I,i.userInfo=K;for(const y of this._observers)if(!y._willBeUnregistered&&(y.mask&O&&(y.unregisterOnNextCall&&this._deferUnregister(y),y.scope?i.lastReturnValue=y.callback.apply(y.scope,[I,i]):i.lastReturnValue=y.callback(I,i)),i.skipNextObservers))return!1;return!0}notifyObserver(I,O){let C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=O),I._willBeUnregistered)return;const j=this._eventState;j.mask=C,j.skipNextObservers=!1,I.unregisterOnNextCall&&this._deferUnregister(I),I.callback(O,j)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const I=this._observers.pop();I&&(I._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const I=new y;return I._observers=this._observers.slice(0),I}hasSpecificMask(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const O of this._observers)if(O.mask&I||O.mask===I)return!0;return!1}}},12163:(I,O,C)=>{C.d(O,{e:()=>K,f:()=>y});let j=[];class K{static SetImmediate(I){0===j.length&&setTimeout((()=>{const I=j;j=[];for(const O of I)O()}),1),j.push(I)}}function i(I,O,C){try{if(I())return O(),!0}catch(j){return null===C||void 0===C||C(j),!0}return!1}const y=function(I,O,C){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,K=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,y=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&i(I,O,C))return null;const S=setInterval((()=>{i(I,O,C)?clearInterval(S):(K-=j,K<0&&(clearInterval(S),null===C||void 0===C||C(new Error("Operation timed out after maximum retries. "+(y||"")),!0)))}),j);return()=>clearInterval(S)}}}]);