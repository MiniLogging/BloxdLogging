"use strict";(self.ynu1yiqvs98=self.ynu1yiqvs98||[]).push([[9],{11021:(I,E,j)=>{j.d(E,{e:()=>G,i:()=>b,n:()=>Q,j:()=>n,q:()=>H});class e{constructor(){this.children=[]}isValid(I){return!0}process(I,E,j){let e="";if(this.line){let j=this.line;const P=E.processor;if(P){var w,z,h,t,U,R;P.lineProcessor&&(j=P.lineProcessor(j,E.isFragment,E.processingContext));const e=(null===(w=E.processor)||void 0===w?void 0:w.attributeKeywordName)??"attribute",o=E.isFragment&&null!==(z=E.processor)&&void 0!==z&&z.varyingFragmentKeywordName?null===(h=E.processor)||void 0===h?void 0:h.varyingFragmentKeywordName:!E.isFragment&&null!==(t=E.processor)&&void 0!==t&&t.varyingVertexKeywordName?null===(U=E.processor)||void 0===U?void 0:U.varyingVertexKeywordName:"varying";if(!E.isFragment&&P.attributeProcessor&&this.line.startsWith(e))j=P.attributeProcessor(this.line,I,E.processingContext);else if(P.varyingProcessor&&(null!==(R=P.varyingCheck)&&void 0!==R&&R.call(P,this.line,E.isFragment)||!P.varyingCheck&&this.line.startsWith(o)))j=P.varyingProcessor(this.line,E.isFragment,I,E.processingContext);else if(P.uniformProcessor&&P.uniformRegexp&&P.uniformRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(j=P.uniformProcessor(this.line,E.isFragment,I,E.processingContext));else if(P.uniformBufferProcessor&&P.uniformBufferRegexp&&P.uniformBufferRegexp.test(this.line))E.lookForClosingBracketForUniformBuffer||(j=P.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0);else if(P.textureProcessor&&P.textureRegexp&&P.textureRegexp.test(this.line))j=P.textureProcessor(this.line,E.isFragment,I,E.processingContext);else if((P.uniformProcessor||P.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!E.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?P.uniformProcessor&&(j=P.uniformProcessor(this.line,E.isFragment,I,E.processingContext)):P.uniformBufferProcessor&&(j=P.uniformBufferProcessor(this.line,E.isFragment,E.processingContext),E.lookForClosingBracketForUniformBuffer=!0)}E.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(E.lookForClosingBracketForUniformBuffer=!1,P.endOfUniformBufferProcessor&&(j=P.endOfUniformBufferProcessor(this.line,E.isFragment,E.processingContext)))}e+=j+"\n"}for(const P of this.children)e+=P.process(I,E,j);return this.additionalDefineKey&&(I[this.additionalDefineKey]=this.additionalDefineValue||"true",j[this.additionalDefineKey]=I[this.additionalDefineKey]),e}}class w{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(I){this._lines.length=0;for(const E of I){if(!E||"\r"===E)continue;if("#"===E[0]){this._lines.push(E);continue}const I=E.trim();if(!I)continue;if(I.startsWith("//")){this._lines.push(E);continue}const j=I.indexOf(";");if(-1===j)this._lines.push(I);else if(j===I.length-1)I.length>1&&this._lines.push(I);else{const I=E.split(";");for(let E=0;E<I.length;E++){let j=I[E];j&&(j=j.trim(),j&&this._lines.push(j+(E!==I.length-1?";":"")))}}}}}class z extends e{process(I,E,j){for(let e=0;e<this.children.length;e++){const w=this.children[e];if(w.isValid(I))return w.process(I,E,j)}return""}}class h extends e{isValid(I){return this.testExpression.isTrue(I)}}class t{isTrue(I){return!0}static postfixToInfix(I){const E=[];for(const j of I)if(void 0===t._OperatorPriority[j])E.push(j);else{const I=E[E.length-1],e=E[E.length-2];E.length-=2,E.push(`(${e}${j}${I})`)}return E[E.length-1]}static infixToPostfix(I){const E=t._InfixToPostfixCache.get(I);if(E)return E.accessTime=Date.now(),E.result;if(!I.includes("&&")&&!I.includes("||")&&!I.includes(")")&&!I.includes("("))return[I];const j=[];let e=-1;const w=()=>{P=P.trim(),""!==P&&(j.push(P),P="")},z=I=>{e<t._Stack.length-1&&(t._Stack[++e]=I)},h=()=>t._Stack[e],U=()=>-1===e?"!!INVALID EXPRESSION!!":t._Stack[e--];let R=0,P="";for(;R<I.length;){const E=I.charAt(R),o=R<I.length-1?I.substring(R,2+R):"";if("("===E)P="",z(E);else if(")"===E){for(w();-1!==e&&"("!==h();)j.push(U());U()}else if(t._OperatorPriority[o]>1){for(w();-1!==e&&t._OperatorPriority[h()]>=t._OperatorPriority[o];)j.push(U());z(o),R++}else P+=E;R++}for(w();-1!==e;)"("===h()?U():j.push(U());return t._InfixToPostfixCache.size>=t.InfixToPostfixCacheLimitSize&&t.ClearCache(),t._InfixToPostfixCache.set(I,{result:j,accessTime:Date.now()}),j}static ClearCache(){const I=Array.from(t._InfixToPostfixCache.entries()).sort(((I,E)=>I[1].accessTime-E[1].accessTime));for(let E=0;E<t.InfixToPostfixCacheCleanupSize;E++)t._InfixToPostfixCache.delete(I[E][0])}}t.InfixToPostfixCacheLimitSize=5e4,t.InfixToPostfixCacheCleanupSize=25e3,t._InfixToPostfixCache=new Map,t._OperatorPriority={")":0,"(":1,"||":2,"&&":3},t._Stack=["","","","","","","","","","","","","","","","","","","",""];class U extends t{constructor(I){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=I,this.not=E}isTrue(I){let E=void 0!==I[this.define];return this.not&&(E=!E),E}}class R extends t{isTrue(I){return this.leftOperand.isTrue(I)||this.rightOperand.isTrue(I)}}class P extends t{isTrue(I){return this.leftOperand.isTrue(I)&&this.rightOperand.isTrue(I)}}class o extends t{constructor(I,E,j){super(),this.define=I,this.operand=E,this.testValue=j}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(I){let E=!1;const j=parseInt(void 0!=I[this.define]?I[this.define]:this.define),e=parseInt(void 0!=I[this.testValue]?I[this.testValue]:this.testValue);if(isNaN(j)||isNaN(e))return!1;switch(this.operand){case">":E=j>e;break;case"<":E=j<e;break;case"<=":E=j<=e;break;case">=":E=j>=e;break;case"==":E=j===e;break;case"!=":E=j!==e}return E}}var Z=j(10986),c=j(11027);const K=/defined\s*?\((.+?)\)/g,L=/defined\s*?\[(.+?)\]/g,F=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,C=/__decl__/,X=/light\{X\}.(\w*)/g,q=/\{X\}/g,x=[],u=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function b(I){I.processor&&I.processor.initializeShaders&&I.processor.initializeShaders(I.processingContext)}function Q(I,E,j,e){var w;null!==(w=E.processor)&&void 0!==w&&w.preProcessShaderCode&&(I=E.processor.preProcessShaderCode(I,E.isFragment)),n(I,E,(I=>{E.processCodeAfterIncludes&&(I=E.processCodeAfterIncludes(E.isFragment?"fragment":"vertex",I,E.defines));const w=function(I,E,j){let e=function(I,E){var j;if(null!==(j=E.processor)&&void 0!==j&&j.noPrecision)return I;const e=E.shouldUseHighPrecisionShader;-1===I.indexOf("precision highp float")?I=e?"precision highp float;\n"+I:"precision mediump float;\n"+I:e||(I=I.replace("precision highp float","precision mediump float"));return I}(I,E);if(!E.processor)return e;if(0===E.processor.shaderLanguage&&-1!==e.indexOf("#version 3")&&(e=e.replace("#version 300 es",""),!E.processor.parseGLES3))return e;const w=E.defines,z=r(E,j);E.processor.preProcessor&&(e=E.processor.preProcessor(e,w,z,E.isFragment,E.processingContext));const h={};e=i(e,z,E,h),E.processor.postProcessor&&(e=E.processor.postProcessor(e,w,E.isFragment,E.processingContext,j?{drawBuffersExtensionDisabled:!j.getCaps().drawBuffersExtension}:{},z,h));null!==j&&void 0!==j&&j._features.needShaderCodeInlining&&(e=j.inlineShaderCode(e));return e}(I,E,e);j(w,I)}))}function G(I,E,j){return j.processor&&j.processor.finalizeShaders?j.processor.finalizeShaders(I,E,j.processingContext):{vertexCode:I,fragmentCode:E}}function y(I){const E=/defined\((.+)\)/.exec(I);if(E&&E.length)return new U(E[1].trim(),"!"===I[0]);const j=["==","!=",">=","<=","<",">"];let e="",w=0;for(e of j)if(w=I.indexOf(e),w>-1)break;if(-1===w)return new U(I);const z=I.substring(0,w).trim(),h=I.substring(w+e.length).trim();return new o(z,e,h)}function d(I,E){const j=new h,e=I.substring(0,E);let w=I.substring(E);return w=w.substring(0,(w.indexOf("//")+1||w.length+1)-1).trim(),j.testExpression="#ifdef"===e?new U(w):"#ifndef"===e?new U(w,!0):function(I){I=I.replace(K,"defined[$1]");const E=t.infixToPostfix(I),j=[];for(const w of E)if("||"!==w&&"&&"!==w)j.push(w);else if(j.length>=2){let I=j[j.length-1],E=j[j.length-2];j.length-=2;const e="&&"==w?new P:new R;"string"===typeof I&&(I=I.replace(L,"defined($1)")),"string"===typeof E&&(E=E.replace(L,"defined($1)")),e.leftOperand="string"===typeof E?y(E):E,e.rightOperand="string"===typeof I?y(I):I,j.push(e)}let e=j[j.length-1];return"string"===typeof e&&(e=e.replace(L,"defined($1)")),"string"===typeof e?y(e):e}(w),j}function a(I,E,j,w){let z=I.currentLine;for(;l(I,j,w);){z=I.currentLine;const h=z.substring(0,5).toLowerCase();if("#else"===h){const j=new e;return E.children.push(j),void l(I,j,w)}if("#elif"===h){const I=d(z,5);E.children.push(I),j=I}}}function l(I,E,j){for(;I.canRead;){I.lineIndex++;const w=I.currentLine;if(w.indexOf("#")>=0){const e=u.exec(w);if(e&&e.length){switch(e[0]){case"#ifdef":{const e=new z;E.children.push(e);const h=d(w,6);e.children.push(h),a(I,e,h,j);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const e=new z;E.children.push(e);const h=d(w,7);e.children.push(h),a(I,e,h,j);break}case"#if":{const e=new z,h=d(w,3);E.children.push(e),e.children.push(h),a(I,e,h,j);break}}continue}}const h=new e;if(h.line=w,E.children.push(h),"#"===w[0]&&"d"===w[1]){const I=w.replace(";","").split(" ");h.additionalDefineKey=I[1],3===I.length&&(h.additionalDefineValue=I[2])}}return!1}function i(I,E,j,z){const h=new e,t=new w;return t.lineIndex=-1,t.lines=I.split("\n"),l(t,h,z),h.process(E,j,z)}function r(I,E){var j;const e=I.defines,w={};for(const z of e){const I=z.replace("#define","").replace(";","").trim().split(" ");w[I[0]]=I.length>1?I[1]:""}return 0===(null===(j=I.processor)||void 0===j?void 0:j.shaderLanguage)&&(w.GL_ES="true"),w.__VERSION__=I.version,w[I.platformName]="true",(0,c.i)(w,null===E||void 0===E?void 0:E.isNDCHalfZRange,null===E||void 0===E?void 0:E.useReverseDepthBuffer,null===E||void 0===E?void 0:E.useExactSrgbConversions),w}function n(I,E,j){let e;for(x.length=0;null!==(e=F.exec(I));)x.push(e);let w=String(I),z=[I],h=!1;for(const t of x){let I=t[1];if(-1!==I.indexOf("__decl__")&&(I=I.replace(C,""),E.supportsUniformBuffers&&(I=I.replace("Vertex","Ubo").replace("Fragment","Ubo")),I+="Declaration"),!E.includesShadersStore[I]){const e=E.shadersRepository+"ShadersInclude/"+I+".fx";return void H.loadFile(e,(e=>{E.includesShadersStore[I]=e,n(z.join(""),E,j)}))}{let j=E.includesShadersStore[I];if(t[2]){const I=t[3].split(",");for(let E=0;E<I.length;E+=2){const e=new RegExp(I[E],"g"),w=I[E+1];j=j.replace(e,w)}}if(t[4]){const I=t[5];if(-1!==I.indexOf("..")){const e=I.split(".."),w=parseInt(e[0]);let z=parseInt(e[1]),h=j.slice(0);j="",isNaN(z)&&(z=E.indexParameters[e[1]]);for(let I=w;I<z;I++)E.supportsUniformBuffers||(h=h.replace(X,((I,E)=>E+"{X}"))),j+=h.replace(q,I.toString())+"\n"}else E.supportsUniformBuffers||(j=j.replace(X,((I,E)=>E+"{X}"))),j=j.replace(q,I)}const e=[];for(const I of z){const E=I.split(t[0]);for(let I=0;I<E.length-1;I++)e.push(E[I]),e.push(j);e.push(E[E.length-1])}z=e,h=h||j.indexOf("#include<")>=0||j.indexOf("#include <")>=0}}x.length=0,w=z.join(""),h?n(w.toString(),E,j):j(w)}const H={loadFile:(I,E,j,e,w,z)=>{throw(0,Z.b)("FileTools")}}},11027:(I,E,j)=>{j.d(E,{c:()=>w,e:()=>z,i:()=>t,k:()=>h,n:()=>U});var e=j(10986);j(10966);const w={};function z(I,E){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(E?E+"\n":"")+I}function h(I,E,j,z,h,t,U){const R=U||w.loadFile;if(R){return R(I,E,j,z,h,t)}throw(0,e.b)("FileTools")}function t(I,E,j,e){if(I)return E?I.IS_NDC_HALF_ZRANGE="":delete I.IS_NDC_HALF_ZRANGE,j?I.USE_REVERSE_DEPTHBUFFER="":delete I.USE_REVERSE_DEPTHBUFFER,void(e?I.USE_EXACT_SRGB_CONVERSIONS="":delete I.USE_EXACT_SRGB_CONVERSIONS);{let I="";return E&&(I+="#define IS_NDC_HALF_ZRANGE"),j&&(I&&(I+="\n"),I+="#define USE_REVERSE_DEPTHBUFFER"),e&&(I&&(I+="\n"),I+="#define USE_EXACT_SRGB_CONVERSIONS"),I}}function U(I,E){let j=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments.length>3?arguments[3]:void 0;switch(I){case 3:{const I=(ArrayBuffer,new Int8Array(E));return e&&I.set(new Int8Array(e)),I}case 0:{const I=(ArrayBuffer,new Uint8Array(E));return e&&I.set(new Uint8Array(e)),I}case 4:{const I=E instanceof ArrayBuffer?new Int16Array(E):new Int16Array(j?E/2:E);return e&&I.set(new Int16Array(e)),I}case 5:case 8:case 9:case 10:case 2:{const I=E instanceof ArrayBuffer?new Uint16Array(E):new Uint16Array(j?E/2:E);return e&&I.set(new Uint16Array(e)),I}case 6:{const I=E instanceof ArrayBuffer?new Int32Array(E):new Int32Array(j?E/4:E);return e&&I.set(new Int32Array(e)),I}case 7:case 11:case 12:case 13:case 14:case 15:{const I=E instanceof ArrayBuffer?new Uint32Array(E):new Uint32Array(j?E/4:E);return e&&I.set(new Uint32Array(e)),I}case 1:{const I=E instanceof ArrayBuffer?new Float32Array(E):new Float32Array(j?E/4:E);return e&&I.set(new Float32Array(e)),I}}const w=(ArrayBuffer,new Uint8Array(E));return e&&w.set(new Uint8Array(e)),w}},11042:(I,E,j)=>{j.d(E,{e:()=>e});class e{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.ShadersRepository:e.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.ShadersStore:e.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.IncludesShadersStore:e.IncludesShadersStoreWGSL}}e.ShadersRepository="src/Shaders/",e.ShadersStore={},e.IncludesShadersStore={},e.ShadersRepositoryWGSL="src/ShadersWGSL/",e.ShadersStoreWGSL={},e.IncludesShadersStoreWGSL={}},11047:(I,E,j)=>{j.d(E,{e:()=>Z,h:()=>q,k:()=>K,l:()=>c,m:()=>L,o:()=>X,r:()=>o,u:()=>R,y:()=>P,A:()=>U,E:()=>t});class e{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.KE._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(I){I&&this.program&&I(this.program)}setEngine(I){this.KE=I}_fillEffectInformation(I,E,j,e,w,z,h,t){const U=this.KE;if(U.supportsUniformBuffers)for(const P in E)I.bindUniformBlock(P,E[P]);let R;for(this.KE.getUniforms(this,j).forEach(((I,E)=>{e[j[E]]=I})),this._uniforms=e,R=0;R<w.length;R++){null==I.getUniform(w[R])&&(w.splice(R,1),R--)}w.forEach(((I,E)=>{z[I]=E}));for(const P of U.getAttributes(this,h))t.push(P)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(I,E){const j=this._valueCache[I],e=E.updateFlag;return(void 0===j||j!==e)&&(this._valueCache[I]=e,!0)}_cacheFloat2(I,E,j){let e=this._valueCache[I];if(!e||2!==e.length)return e=[E,j],this._valueCache[I]=e,!0;let w=!1;return e[0]!==E&&(e[0]=E,w=!0),e[1]!==j&&(e[1]=j,w=!0),w}_cacheFloat3(I,E,j,e){let w=this._valueCache[I];if(!w||3!==w.length)return w=[E,j,e],this._valueCache[I]=w,!0;let z=!1;return w[0]!==E&&(w[0]=E,z=!0),w[1]!==j&&(w[1]=j,z=!0),w[2]!==e&&(w[2]=e,z=!0),z}_cacheFloat4(I,E,j,e,w){let z=this._valueCache[I];if(!z||4!==z.length)return z=[E,j,e,w],this._valueCache[I]=z,!0;let h=!1;return z[0]!==E&&(z[0]=E,h=!0),z[1]!==j&&(z[1]=j,h=!0),z[2]!==e&&(z[2]=e,h=!0),z[3]!==w&&(z[3]=w,h=!0),h}setInt(I,E){const j=this._valueCache[I];void 0!==j&&j===E||this.KE.setInt(this._uniforms[I],E)&&(this._valueCache[I]=E)}setInt2(I,E,j){this._cacheFloat2(I,E,j)&&(this.KE.setInt2(this._uniforms[I],E,j)||(this._valueCache[I]=null))}setInt3(I,E,j,e){this._cacheFloat3(I,E,j,e)&&(this.KE.setInt3(this._uniforms[I],E,j,e)||(this._valueCache[I]=null))}setInt4(I,E,j,e,w){this._cacheFloat4(I,E,j,e,w)&&(this.KE.setInt4(this._uniforms[I],E,j,e,w)||(this._valueCache[I]=null))}setIntArray(I,E){this._valueCache[I]=null,this.KE.setIntArray(this._uniforms[I],E)}setIntArray2(I,E){this._valueCache[I]=null,this.KE.setIntArray2(this._uniforms[I],E)}setIntArray3(I,E){this._valueCache[I]=null,this.KE.setIntArray3(this._uniforms[I],E)}setIntArray4(I,E){this._valueCache[I]=null,this.KE.setIntArray4(this._uniforms[I],E)}setUInt(I,E){const j=this._valueCache[I];void 0!==j&&j===E||this.KE.setUInt(this._uniforms[I],E)&&(this._valueCache[I]=E)}setUInt2(I,E,j){this._cacheFloat2(I,E,j)&&(this.KE.setUInt2(this._uniforms[I],E,j)||(this._valueCache[I]=null))}setUInt3(I,E,j,e){this._cacheFloat3(I,E,j,e)&&(this.KE.setUInt3(this._uniforms[I],E,j,e)||(this._valueCache[I]=null))}setUInt4(I,E,j,e,w){this._cacheFloat4(I,E,j,e,w)&&(this.KE.setUInt4(this._uniforms[I],E,j,e,w)||(this._valueCache[I]=null))}setUIntArray(I,E){this._valueCache[I]=null,this.KE.setUIntArray(this._uniforms[I],E)}setUIntArray2(I,E){this._valueCache[I]=null,this.KE.setUIntArray2(this._uniforms[I],E)}setUIntArray3(I,E){this._valueCache[I]=null,this.KE.setUIntArray3(this._uniforms[I],E)}setUIntArray4(I,E){this._valueCache[I]=null,this.KE.setUIntArray4(this._uniforms[I],E)}setArray(I,E){this._valueCache[I]=null,this.KE.setArray(this._uniforms[I],E)}setArray2(I,E){this._valueCache[I]=null,this.KE.setArray2(this._uniforms[I],E)}setArray3(I,E){this._valueCache[I]=null,this.KE.setArray3(this._uniforms[I],E)}setArray4(I,E){this._valueCache[I]=null,this.KE.setArray4(this._uniforms[I],E)}setMatrices(I,E){E&&(this._valueCache[I]=null,this.KE.setMatrices(this._uniforms[I],E))}setMatrix(I,E){this._cacheMatrix(I,E)&&(this.KE.setMatrices(this._uniforms[I],E.re())||(this._valueCache[I]=null))}setMatrix3x3(I,E){this._valueCache[I]=null,this.KE.setMatrix3x3(this._uniforms[I],E)}setMatrix2x2(I,E){this._valueCache[I]=null,this.KE.setMatrix2x2(this._uniforms[I],E)}setFloat(I,E){const j=this._valueCache[I];void 0!==j&&j===E||this.KE.setFloat(this._uniforms[I],E)&&(this._valueCache[I]=E)}setVector2(I,E){this._cacheFloat2(I,E.x,E.y)&&(this.KE.setFloat2(this._uniforms[I],E.x,E.y)||(this._valueCache[I]=null))}setFloat2(I,E,j){this._cacheFloat2(I,E,j)&&(this.KE.setFloat2(this._uniforms[I],E,j)||(this._valueCache[I]=null))}setVector3(I,E){this._cacheFloat3(I,E.x,E.y,E.z)&&(this.KE.setFloat3(this._uniforms[I],E.x,E.y,E.z)||(this._valueCache[I]=null))}setFloat3(I,E,j,e){this._cacheFloat3(I,E,j,e)&&(this.KE.setFloat3(this._uniforms[I],E,j,e)||(this._valueCache[I]=null))}setVector4(I,E){this._cacheFloat4(I,E.x,E.y,E.z,E.w)&&(this.KE.setFloat4(this._uniforms[I],E.x,E.y,E.z,E.w)||(this._valueCache[I]=null))}setQuaternion(I,E){this._cacheFloat4(I,E.x,E.y,E.z,E.w)&&(this.KE.setFloat4(this._uniforms[I],E.x,E.y,E.z,E.w)||(this._valueCache[I]=null))}setFloat4(I,E,j,e,w){this._cacheFloat4(I,E,j,e,w)&&(this.KE.setFloat4(this._uniforms[I],E,j,e,w)||(this._valueCache[I]=null))}setColor3(I,E){this._cacheFloat3(I,E.r,E.g,E.b)&&(this.KE.setFloat3(this._uniforms[I],E.r,E.g,E.b)||(this._valueCache[I]=null))}setColor4(I,E,j){this._cacheFloat4(I,E.r,E.g,E.b,j)&&(this.KE.setFloat4(this._uniforms[I],E.r,E.g,E.b,j)||(this._valueCache[I]=null))}setDirectColor4(I,E){this._cacheFloat4(I,E.r,E.g,E.b,E.a)&&(this.KE.setFloat4(this._uniforms[I],E.r,E.g,E.b,E.a)||(this._valueCache[I]=null))}_getVertexShaderCode(){return this.vertexShader?this.KE._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.KE._getShaderSource(this.fragmentShader):null}}var w=j(11027);const z=new WeakMap,h={_webGLVersion:2,cachedPipelines:{}};function t(I){let E=z.get(I);if(!E){if(!I)return h;E={_webGLVersion:I.TEXTURE_BINDING_3D?2:1,_context:I,parallelShaderCompile:I.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},z.set(I,E)}return E}function U(I){z.delete(I)}function R(I,E,j,e,w,z){const h=t(e);z||(z=h._createShaderProgramInjection??Z);return z(I,C(E,"vertex",e,h._contextWasLost),C(j,"fragment",e,h._contextWasLost),e,w,h.validateShaderPrograms)}function P(I,E,j,e,w){let z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,h=arguments.length>6?arguments[6]:void 0;const U=t(w);h||(h=U._createShaderProgramInjection??Z);const R=U._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return h(I,F(E,"vertex",e,R,w,U._contextWasLost),F(j,"fragment",e,R,w,U._contextWasLost),w,z,U.validateShaderPrograms)}function o(I,E){const j=new e,w=t(I);return w.parallelShaderCompile&&!w.disableParallelShaderCompile&&(j.isParallelCompiled=!0),j.context=w._context,j}function Z(I,E,j,e){let w=arguments.length>5?arguments[5]:void 0;const z=e.createProgram();if(I.program=z,!z)throw new Error("Unable to create program");return e.attachShader(z,E),e.attachShader(z,j),e.linkProgram(z),I.context=e,I.vertexShader=E,I.fragmentShader=j,I.isParallelCompiled||K(I,e,w),z}function c(I,E,j){const e=I;if(e._isDisposed)return!1;const w=t(E);return!!(w&&w.parallelShaderCompile&&w.parallelShaderCompile.COMPLETION_STATUS_KHR&&e.program&&E.getProgramParameter(e.program,w.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(K(e,E,j),!0)}function K(I,E,j){const e=I.context,w=I.vertexShader,z=I.fragmentShader,h=I.program;if(!e.getProgramParameter(h,e.LINK_STATUS)){if(!E.getShaderParameter(w,E.COMPILE_STATUS)){const j=E.getShaderInfoLog(w);if(j)throw I.vertexCompilationError=j,new Error("VERTEX SHADER "+j)}if(!E.getShaderParameter(z,E.COMPILE_STATUS)){const j=E.getShaderInfoLog(z);if(j)throw I.fragmentCompilationError=j,new Error("FRAGMENT SHADER "+j)}const j=e.getProgramInfoLog(h);if(j)throw I.programLinkError=j,new Error(j)}if(j){e.validateProgram(h);if(!e.getProgramParameter(h,e.VALIDATE_STATUS)){const E=e.getProgramInfoLog(h);if(E)throw I.programValidationError=E,new Error(E)}}e.deleteShader(w),e.deleteShader(z),I.vertexShader=void 0,I.fragmentShader=void 0,I.onCompiled&&(I.onCompiled(),I.onCompiled=void 0)}function L(I,E,j,e,w,z,h,U,o){let Z=arguments.length>10?arguments[10]:void 0,c=arguments.length>11?arguments[11]:void 0,K=arguments.length>12?arguments[12]:void 0;const L=t(I.context);c||(c=L.createRawShaderProgramInjection??R),K||(K=L.createShaderProgramInjection??P);const F=I;F.program=e?c(F,E,j,F.context,o):K(F,E,j,U,F.context,o),F.program.__SPECTOR_rebuildProgram=h,Z()}function F(I,E,j,e,z,h){return C((0,w.e)(I,j,e),E,z,h)}function C(I,E,j,e){const w=j.createShader("vertex"===E?j.VERTEX_SHADER:j.FRAGMENT_SHADER);if(!w){let I=j.NO_ERROR,w=j.NO_ERROR;for(;(w=j.getError())!==j.NO_ERROR;)I=w;throw new Error(`Something went wrong while creating a gl ${E} shader object. gl error=${I}, gl isContextLost=${j.isContextLost()}, _contextWasLost=${e}`)}return j.shaderSource(w,I),j.compileShader(w),w}function X(I,E){E.useProgram(I)}function q(I,E){const j=I;if(!j.isParallelCompiled)return void E(I);const e=j.onCompiled;j.onCompiled=()=>{null===e||void 0===e||e(),E(I)}}},11045:(I,E,j)=>{j.d(E,{e:()=>o,g:()=>c,k:()=>R,m:()=>P});var e=j(10966),w=j(11047),z=j(11042),h=j(10974),t=j(11021),U=j(11027);function R(I,E){return(0,w.E)(E).cachedPipelines[I]}function P(I){const E=I._name,j=I.context;if(E&&j){const I=(0,w.E)(j),e=I.cachedPipelines[E];null===e||void 0===e||e.dispose(),delete I.cachedPipelines[E]}}function o(I,E,j,w,z,h,U){let R,P;const o=(0,e.j)()?null===h||void 0===h?void 0:h.getHostDocument():null;R="string"===typeof E?E:E.vertexSource?"source:"+E.vertexSource:E.vertexElement?(null===o||void 0===o?void 0:o.getElementById(E.vertexElement))||E.vertexElement:E.vertex||E,P="string"===typeof E?E:E.fragmentSource?"source:"+E.fragmentSource:E.fragmentElement?(null===o||void 0===o?void 0:o.getElementById(E.fragmentElement))||E.fragmentElement:E.fragment||E;const c=[void 0,void 0],K=()=>{if(c[0]&&c[1]){I.isFragment=!0;const[e,R]=c;(0,t.n)(R,I,((h,R)=>{U&&(U._fragmentSourceCodeBeforeMigration=R),j&&(h=j("fragment",h));const P=(0,t.e)(e,h,I);I=null;const o=function(I,E,j,e){if(j){return{vertexSourceCode:(1===e?"//":"")+"#define SHADER_NAME vertex:"+(j.vertexElement||j.vertex||j.spectorName||j)+"\n"+I,fragmentSourceCode:(1===e?"//":"")+"#define SHADER_NAME fragment:"+(j.fragmentElement||j.fragment||j.spectorName||j)+"\n"+E}}return{vertexSourceCode:I,fragmentSourceCode:E}}(P.vertexCode,P.fragmentCode,E,z);null===w||void 0===w||w(o.vertexSourceCode,o.fragmentSourceCode)}),h)}};Z(R,"Vertex","",(E=>{(0,t.i)(I),(0,t.n)(E,I,((I,e)=>{U&&(U._rawVertexSourceCode=E,U._vertexSourceCodeBeforeMigration=e),j&&(I=j("vertex",I)),c[0]=I,K()}),h)}),z),Z(P,"Fragment","Pixel",(I=>{U&&(U._rawFragmentSourceCode=I),c[1]=I,K()}),z)}function Z(I,E,j,w,h,t){if("undefined"!==typeof HTMLElement&&I instanceof HTMLElement){return void w((0,e.d)(I))}if("source:"===I.substring(0,7))return void w(I.substring(7));if("base64:"===I.substring(0,7)){return void w(window.atob(I.substring(7)))}const R=z.e.GetShadersStore(h);if(R[I+E+"Shader"])return void w(R[I+E+"Shader"]);if(j&&R[I+j+"Shader"])return void w(R[I+j+"Shader"]);let P;if(P="."===I[0]||"/"===I[0]||I.indexOf("http")>-1?I:z.e.GetShadersRepository(h)+I,!(t=t||U.k))throw new Error("loadFileInjection is not defined");t(P+"."+E.toLowerCase()+".fx",w)}const c=(I,E,j,e)=>{try{const z=I.context?(0,w.E)(I.context):null;z&&(z.disableParallelShaderCompile=I.disableParallelCompilation);const h=I.existingPipelineContext||E(I.shaderProcessingContext);return h._name=I.name,I.name&&z&&(z.cachedPipelines[I.name]=h),j(h,I.vertex,I.fragment,!!I.createAsRaw,"","",I.rebuildRebind,I.defines,I.transformFeedbackVaryings,"",(()=>{e(h,(()=>{var E;null===(E=I.onRenderingStateCompiled)||void 0===E||E.call(I,h)}))})),h}catch(z){throw h.b.Error("Error compiling effect"),z}}},11037:(I,E,j)=>{j.r(E),j.d(E,{Effect:()=>U});var e=j(10960),w=j(10974),z=j(11042),h=j(11045),t=j(11031);class U{static get ShadersRepository(){return z.e.ShadersRepository}static set ShadersRepository(I){z.e.ShadersRepository=I}get Z(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new e.e),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(I,E,j){let w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,z=arguments.length>4?arguments[4]:void 0,t=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,R=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,P=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,Z=arguments.length>9?arguments[9]:void 0,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",K=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,L=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new e.e,this.onErrorObservable=new e.e,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=I,this._key=c;const F=this._key.replace(/\r/g,"").replace(/\n/g,"|");let C;if(E.attributes){const I=E;if(this._engine=j,this._attributesNames=I.attributes,this._uniformsNames=I.uniformsNames.concat(I.samplers),this._samplerList=I.samplers.slice(),this.defines=I.defines,this.onError=I.onError,this.onCompiled=I.onCompiled,this._fallbacks=I.fallbacks,this._indexParameters=I.indexParameters,this._transformFeedbackVaryings=I.transformFeedbackVaryings||null,this._multiTarget=!!I.multiTarget,this._shaderLanguage=I.shaderLanguage??0,this._disableParallelShaderCompilation=!!I.disableParallelShaderCompilation,I.uniformBuffersNames){this._uniformBuffersNamesList=I.uniformBuffersNames.slice();for(let E=0;E<I.uniformBuffersNames.length;E++)this._uniformBuffersNames[I.uniformBuffersNames[E]]=E}this._processFinalCode=I.processFinalCode??null,this._processCodeAfterIncludes=I.processCodeAfterIncludes??void 0,L=I.extraInitializationsAsync,C=I.existingPipelineContext}else this._engine=z,this.defines=null==t?"":t,this._uniformsNames=j.concat(w),this._samplerList=w?w.slice():[],this._attributesNames=E,this._uniformBuffersNamesList=[],this._shaderLanguage=K,this.onError=o,this.onCompiled=P,this._indexParameters=Z,this._fallbacks=R;"WEBGL2"===this._engine.shaderPlatformName&&(C=(0,h.k)(F,this._engine._gl)??C),this._attributeLocationByName={},this.uniqueId=U._UniqueIdSeed++,C?(this._pipelineContext=C,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,L),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.Z||this.dispose(!0)}))}async _processShaderCodeAsync(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=arguments.length>3?arguments[3]:void 0;e&&await e(),this._processingContext=j||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const w={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:I??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:z.e.GetShadersRepository(this._shaderLanguage),includesShadersStore:z.e.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,h.e)(w,this.name,this._processFinalCode,((I,j)=>{this._vertexSourceCode=I,this._fragmentSourceCode=j,this._prepareEffect(E)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.Z||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(I){return this._attributes[I]}getAttributeLocationByName(I){return this._attributeLocationByName[I]}getAttributesCount(){return this._attributes.length}getUniformIndex(I){return this._uniformsNames.indexOf(I)}getUniform(I){return this._uniforms[I]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((I=>{this.executeWhenCompiled(I)}))}executeWhenCompiled(I){this.isReady()?I(this):(this.onCompileObservable.add((E=>{I(E)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(I){(0,t.c)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(E=>{this._processCompilationErrors(E,I)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(I,E,j,e){this._isReady=!1,this._vertexSourceCodeOverride=I,this._fragmentSourceCodeOverride=E,this.onError=(I,E)=>{e&&e(E)},this.onCompiled=()=>{var I,E;const e=this.getEngine().scenes;if(e)for(let j=0;j<e.length;j++)e[j].markAllMaterialsAsDirty(127);null===(I=(E=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===I||I.call(E,j)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(I){if(this._pipelineContext=I,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let E=0;E<this._attributesNames.length;E++){const I=this._attributesNames[E];this._attributeLocationByName[I]=this._attributes[E]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),U.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=this._pipelineContext;this._isReady=!1;try{const j=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),e=j?null:this.defines,w=j?this._vertexSourceCodeOverride:this._vertexSourceCode,z=j?this._fragmentSourceCodeOverride:this._fragmentSourceCode,t=this._engine;this._pipelineContext=(0,h.g)({existingPipelineContext:I?E:null,vertex:w,fragment:z,context:"WEBGL2"===t.shaderPlatformName||"WEBGL1"===t.shaderPlatformName?t._gl:void 0,rebuildRebind:(I,E,j,e)=>this._rebuildProgram(I,E,j,e),defines:e,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:j,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:j=>{E&&!I&&this._engine._deletePipelineContext(E),j&&this._onRenderingStateCompiled(j)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(E)}catch(j){this._processCompilationErrors(j,E)}}_getShaderCodeAndErrorLine(I,E,j){const e=j?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let w=null;if(E&&I){const z=E.match(e);if(z&&2===z.length){const E=parseInt(z[1]),e=I.split("\n",-1);e.length>=E&&(w=`Offending line [${E}] in ${j?"fragment":"vertex"} code: ${e[E-1]}`)}}return[I,w]}_processCompilationErrors(I){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=I.message;const j=this._attributesNames,e=this._fallbacks;if(w.b.Error("Unable to compile effect:"),w.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),w.b.Error(`Attributes: ${j.join(" ")}`),w.b.Error("Defines:\n"+this.defines),U.LogShaderCodeOnCompilationError){var z,h;let I=null,E=null,j=null;var t;if(null!==(z=this._pipelineContext)&&void 0!==z&&z._getVertexShaderCode()&&([j,I]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),j&&(w.b.Error("Vertex code:"),w.b.Error(j))),null!==(h=this._pipelineContext)&&void 0!==h&&h._getFragmentShaderCode())[j,E]=this._getShaderCodeAndErrorLine(null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode(),this._compilationError,!0),j&&(w.b.Error("Fragment code:"),w.b.Error(j));I&&w.b.Error(I),E&&w.b.Error(E)}w.b.Error("Error: "+this._compilationError);const R=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};E&&(this._pipelineContext=E,this._isReady=!0,R()),e?(this._pipelineContext=null,e.hasMoreFallbacks?(this._allFallbacksProcessed=!1,w.b.Error("Trying next fallback."),this.defines=e.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,R(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,E||R())}get isSupported(){return""===this._compilationError}_bindTexture(I,E){this._engine._bindTexture(this._samplers[I],E,I)}setTexture(I,E){this._engine.setTexture(this._samplers[I],this._uniforms[I],E,I)}setTextureArray(I,E){const j=I+"Ex";if(-1===this._samplerList.indexOf(j+"0")){const e=this._samplerList.indexOf(I);for(let I=1;I<E.length;I++){const E=j+(I-1).toString();this._samplerList.splice(e+I,0,E)}let w=0;for(const I of this._samplerList)this._samplers[I]=w,w+=1}this._engine.setTextureArray(this._samplers[I],this._uniforms[I],E,I)}bindUniformBuffer(I,E){const j=this._uniformBuffersNames[E];void 0===j||U._BaseCache[j]===I&&this._engine._features.useUBOBindingCache||(U._BaseCache[j]=I,this._engine.bindUniformBufferBase(I,j,E))}bindUniformBlock(I,E){this._engine.bindUniformBlock(this._pipelineContext,I,E)}setInt(I,E){return this._pipelineContext.setInt(I,E),this}setInt2(I,E,j){return this._pipelineContext.setInt2(I,E,j),this}setInt3(I,E,j,e){return this._pipelineContext.setInt3(I,E,j,e),this}setInt4(I,E,j,e,w){return this._pipelineContext.setInt4(I,E,j,e,w),this}setIntArray(I,E){return this._pipelineContext.setIntArray(I,E),this}setIntArray2(I,E){return this._pipelineContext.setIntArray2(I,E),this}setIntArray3(I,E){return this._pipelineContext.setIntArray3(I,E),this}setIntArray4(I,E){return this._pipelineContext.setIntArray4(I,E),this}setUInt(I,E){return this._pipelineContext.setUInt(I,E),this}setUInt2(I,E,j){return this._pipelineContext.setUInt2(I,E,j),this}setUInt3(I,E,j,e){return this._pipelineContext.setUInt3(I,E,j,e),this}setUInt4(I,E,j,e,w){return this._pipelineContext.setUInt4(I,E,j,e,w),this}setUIntArray(I,E){return this._pipelineContext.setUIntArray(I,E),this}setUIntArray2(I,E){return this._pipelineContext.setUIntArray2(I,E),this}setUIntArray3(I,E){return this._pipelineContext.setUIntArray3(I,E),this}setUIntArray4(I,E){return this._pipelineContext.setUIntArray4(I,E),this}setFloatArray(I,E){return this._pipelineContext.setArray(I,E),this}setFloatArray2(I,E){return this._pipelineContext.setArray2(I,E),this}setFloatArray3(I,E){return this._pipelineContext.setArray3(I,E),this}setFloatArray4(I,E){return this._pipelineContext.setArray4(I,E),this}setArray(I,E){return this._pipelineContext.setArray(I,E),this}setArray2(I,E){return this._pipelineContext.setArray2(I,E),this}setArray3(I,E){return this._pipelineContext.setArray3(I,E),this}setArray4(I,E){return this._pipelineContext.setArray4(I,E),this}setMatrices(I,E){return this._pipelineContext.setMatrices(I,E),this}setMatrix(I,E){return this._pipelineContext.setMatrix(I,E),this}setMatrix3x3(I,E){return this._pipelineContext.setMatrix3x3(I,E),this}setMatrix2x2(I,E){return this._pipelineContext.setMatrix2x2(I,E),this}setFloat(I,E){return this._pipelineContext.setFloat(I,E),this}setBool(I,E){return this._pipelineContext.setInt(I,E?1:0),this}setVector2(I,E){return this._pipelineContext.setVector2(I,E),this}setFloat2(I,E,j){return this._pipelineContext.setFloat2(I,E,j),this}setVector3(I,E){return this._pipelineContext.setVector3(I,E),this}setFloat3(I,E,j,e){return this._pipelineContext.setFloat3(I,E,j,e),this}setVector4(I,E){return this._pipelineContext.setVector4(I,E),this}setQuaternion(I,E){return this._pipelineContext.setQuaternion(I,E),this}setFloat4(I,E,j,e,w){return this._pipelineContext.setFloat4(I,E,j,e,w),this}setColor3(I,E){return this._pipelineContext.setColor3(I,E),this}setColor4(I,E,j){return this._pipelineContext.setColor4(I,E,j),this}setDirectColor4(I,E){return this._pipelineContext.setDirectColor4(I,E),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(U.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,h.m)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(I,E,j){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;E&&(z.e.GetShadersStore(e)[`${I}PixelShader`]=E),j&&(z.e.GetShadersStore(e)[`${I}VertexShader`]=j)}static ResetCache(){U._BaseCache={}}}U.LogShaderCodeOnCompilationError=!0,U.PersistentMode=!1,U.AutomaticallyClearCodeCache=!1,U._UniqueIdSeed=0,U._BaseCache={},U.ShadersStore=z.e.ShadersStore,U.IncludesShadersStore=z.e.IncludesShadersStore},10986:(I,E,j)=>{j.d(E,{b:()=>w});const e={};function w(I){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!e[I])return e[I]=!0,`${I} needs to be imported before as it contains a side-effect required by your code.`}},10966:(I,E,j)=>{function e(){return"undefined"!==typeof window}function w(){return"undefined"!==typeof navigator}function z(){return"undefined"!==typeof document}function h(I){let E="",j=I.firstChild;for(;j;)3===j.nodeType&&(E+=j.textContent),j=j.nextSibling;return E}j.d(E,{d:()=>h,e:()=>z,f:()=>w,j:()=>e})},10974:(I,E,j)=>{j.d(E,{b:()=>e});class e{static _CheckLimit(I,E){let j=e._LogLimitOutputs[I];return j?j.current++:(j={limit:E,current:1},e._LogLimitOutputs[I]=j),j.current<=j.limit}static _GenerateLimitMessage(I){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const j=e._LogLimitOutputs[I];if(!j||!e.MessageLimitReached)return;const w=this._Levels[E];j.current===j.limit&&e[w.name](e.MessageLimitReached.replace(/%LIMIT%/g,""+j.limit).replace(/%TYPE%/g,w.name??""))}static _AddLogEntry(I){e._LogCache=I+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(I)}static _FormatMessage(I){const E=I=>I<10?"0"+I:""+I,j=new Date;return"["+E(j.getHours())+":"+E(j.getMinutes())+":"+E(j.getSeconds())+"]: "+I}static _LogDisabled(I,E){}static _LogEnabled(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,E=arguments.length>1?arguments[1]:void 0,j=arguments.length>2?arguments[2]:void 0;const w=Array.isArray(E)?E[0]:E;if(void 0!==j&&!e._CheckLimit(w,j))return;const z=e._FormatMessage(w),h=this._Levels[I],t=Array.isArray(E)?E.slice(1):[];h.logFunc&&h.logFunc("BJS - "+z,...t);const U=`<div style='color:${h.color}'>${z}</div><br>`;e._AddLogEntry(U),e._GenerateLimitMessage(w,I)}static get LogCache(){return e._LogCache}static ClearLogCache(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0}static set LogLevels(I){e.Log=e._LogDisabled,e.Warn=e._LogDisabled,e.Error=e._LogDisabled;const E=[e.MessageLogLevel,e.WarningLogLevel,e.ErrorLogLevel];for(const j of E)if((I&j)===j){const I=this._Levels[j];e[I.name]=e._LogEnabled.bind(e,j)}}}e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",e._LogCache="",e._LogLimitOutputs={},e._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],e.errorsCount=0,e.Log=e._LogEnabled.bind(e,e.MessageLogLevel),e.Warn=e._LogEnabled.bind(e,e.WarningLogLevel),e.Error=e._LogEnabled.bind(e,e.ErrorLogLevel)},10960:(I,E,j)=>{j.d(E,{e:()=>h});const e="undefined"!==typeof WeakRef;class w{constructor(I){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0;this.initialize(I,E,j,e)}initialize(I){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],j=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0;return this.mask=I,this.skipNextObservers=E,this.target=j,this.currentTarget=e,this}}class z{constructor(I,E){let j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=I,this.mask=E,this.scope=j,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(I)}}class h{static FromPromise(I,E){const j=new h;return I.then((I=>{j.notifyObservers(I)})).catch((I=>{if(!E)throw I;E.notifyObservers(I)})),j}get observers(){return this._observers}constructor(I){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=E,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new w(0),I&&(this._onObserverAdded=I)}add(I){let E=arguments.length>2&&void 0!==arguments[2]&&arguments[2],j=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!I)return null;const w=new z(I,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);w.unregisterOnNextCall=j,E?this._observers.unshift(w):this._observers.push(w),this._onObserverAdded&&this._onObserverAdded(w),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(w,this._lastNotifiedValue);const h=e?new WeakRef(this):{deref:()=>this};return w._remove=function(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const E=h.deref();E&&(I?E.remove(w):E._remove(w))},w}addOnce(I){return this.add(I,void 0,void 0,void 0,!0)}remove(I){if(!I)return!1;I._remove=null;return-1!==this._observers.indexOf(I)&&(this._deferUnregister(I),!0)}removeCallback(I,E){for(let j=0;j<this._observers.length;j++){const e=this._observers[j];if(!e._willBeUnregistered&&(e.callback===I&&(!E||E===e.scope)))return this._deferUnregister(e),!0}return!1}_deferUnregister(I){I._willBeUnregistered||(this._numObserversMarkedAsDeleted++,I.unregisterOnNextCall=!1,I._willBeUnregistered=!0,setTimeout((()=>{this._remove(I)}),0))}_remove(I){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!I)return!1;const j=this._observers.indexOf(I);return-1!==j&&(E&&this._numObserversMarkedAsDeleted--,this._observers.splice(j,1),!0)}makeObserverTopPriority(I){this._remove(I,!1),this._observers.unshift(I)}makeObserverBottomPriority(I){this._remove(I,!1),this._observers.push(I)}notifyObservers(I){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,j=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0,w=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=I),!this._observers.length)return!0;const z=this._eventState;z.mask=E,z.target=j,z.currentTarget=e,z.skipNextObservers=!1,z.lastReturnValue=I,z.userInfo=w;for(const h of this._observers)if(!h._willBeUnregistered&&(h.mask&E&&(h.unregisterOnNextCall&&this._deferUnregister(h),h.scope?z.lastReturnValue=h.callback.apply(h.scope,[I,z]):z.lastReturnValue=h.callback(I,z)),z.skipNextObservers))return!1;return!0}notifyObserver(I,E){let j=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=E),I._willBeUnregistered)return;const e=this._eventState;e.mask=j,e.skipNextObservers=!1,I.unregisterOnNextCall&&this._deferUnregister(I),I.callback(E,e)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const I=this._observers.pop();I&&(I._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const I=new h;return I._observers=this._observers.slice(0),I}hasSpecificMask(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const E of this._observers)if(E.mask&I||E.mask===I)return!0;return!1}}},11031:(I,E,j)=>{j.d(E,{b:()=>w,c:()=>h});let e=[];class w{static SetImmediate(I){0===e.length&&setTimeout((()=>{const I=e;e=[];for(const E of I)E()}),1),e.push(I)}}function z(I,E,j){try{if(I())return E(),!0}catch(e){return null===j||void 0===j||j(e),!0}return!1}const h=function(I,E,j){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,h=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&z(I,E,j))return null;const t=setInterval((()=>{z(I,E,j)?clearInterval(t):(w-=e,w<0&&(clearInterval(t),null===j||void 0===j||j(new Error("Operation timed out after maximum retries. "+(h||"")),!0)))}),e);return()=>clearInterval(t)}}}]);