"use strict";(self["9x1utqq1axc"]=self["9x1utqq1axc"]||[]).push([[9],{12204:(y,c,A)=>{A.d(c,{e:()=>my,h:()=>C,o:()=>K,k:()=>u,r:()=>G});class l{constructor(){this.children=[]}isValid(y){return!0}process(y,c,A){let l="";if(this.line){let A=this.line;const q=c.processor;if(q){var w,N,p,W,h,I;q.lineProcessor&&(A=q.lineProcessor(A,c.isFragment,c.processingContext));const l=(null===(w=c.processor)||void 0===w?void 0:w.attributeKeywordName)??"attribute",o=c.isFragment&&null!==(N=c.processor)&&void 0!==N&&N.varyingFragmentKeywordName?null===(p=c.processor)||void 0===p?void 0:p.varyingFragmentKeywordName:!c.isFragment&&null!==(W=c.processor)&&void 0!==W&&W.varyingVertexKeywordName?null===(h=c.processor)||void 0===h?void 0:h.varyingVertexKeywordName:"varying";if(!c.isFragment&&q.attributeProcessor&&this.line.startsWith(l))A=q.attributeProcessor(this.line,y,c.processingContext);else if(q.varyingProcessor&&(null!==(I=q.varyingCheck)&&void 0!==I&&I.call(q,this.line,c.isFragment)||!q.varyingCheck&&this.line.startsWith(o)))A=q.varyingProcessor(this.line,c.isFragment,y,c.processingContext);else if(q.uniformProcessor&&q.uniformRegexp&&q.uniformRegexp.test(this.line))c.lookForClosingBracketForUniformBuffer||(A=q.uniformProcessor(this.line,c.isFragment,y,c.processingContext));else if(q.uniformBufferProcessor&&q.uniformBufferRegexp&&q.uniformBufferRegexp.test(this.line))c.lookForClosingBracketForUniformBuffer||(A=q.uniformBufferProcessor(this.line,c.isFragment,c.processingContext),c.lookForClosingBracketForUniformBuffer=!0);else if(q.textureProcessor&&q.textureRegexp&&q.textureRegexp.test(this.line))A=q.textureProcessor(this.line,c.isFragment,y,c.processingContext);else if((q.uniformProcessor||q.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!c.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?q.uniformProcessor&&(A=q.uniformProcessor(this.line,c.isFragment,y,c.processingContext)):q.uniformBufferProcessor&&(A=q.uniformBufferProcessor(this.line,c.isFragment,c.processingContext),c.lookForClosingBracketForUniformBuffer=!0)}c.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(c.lookForClosingBracketForUniformBuffer=!1,q.endOfUniformBufferProcessor&&(A=q.endOfUniformBufferProcessor(this.line,c.isFragment,c.processingContext)))}l+=A+"\n"}for(const q of this.children)l+=q.process(y,c,A);return this.additionalDefineKey&&(y[this.additionalDefineKey]=this.additionalDefineValue||"true",A[this.additionalDefineKey]=y[this.additionalDefineKey]),l}}class w{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(y){this._lines.length=0;for(const c of y){if(!c||"\r"===c)continue;if("#"===c[0]){this._lines.push(c);continue}const y=c.trim();if(!y)continue;if(y.startsWith("//")){this._lines.push(c);continue}const A=y.indexOf(";");if(-1===A)this._lines.push(y);else if(A===y.length-1)y.length>1&&this._lines.push(y);else{const y=c.split(";");for(let c=0;c<y.length;c++){let A=y[c];A&&(A=A.trim(),A&&this._lines.push(A+(c!==y.length-1?";":"")))}}}}}class N extends l{process(y,c,A){for(let l=0;l<this.children.length;l++){const w=this.children[l];if(w.isValid(y))return w.process(y,c,A)}return""}}class p extends l{isValid(y){return this.testExpression.isTrue(y)}}class W{isTrue(y){return!0}static postfixToInfix(y){const c=[];for(const A of y)if(void 0===W._OperatorPriority[A])c.push(A);else{const y=c[c.length-1],l=c[c.length-2];c.length-=2,c.push(`(${l}${A}${y})`)}return c[c.length-1]}static infixToPostfix(y){const c=W._InfixToPostfixCache.get(y);if(c)return c.accessTime=Date.now(),c.result;if(!y.includes("&&")&&!y.includes("||")&&!y.includes(")")&&!y.includes("("))return[y];const A=[];let l=-1;const w=()=>{q=q.trim(),""!==q&&(A.push(q),q="")},N=y=>{l<W._Stack.length-1&&(W._Stack[++l]=y)},p=()=>W._Stack[l],h=()=>-1===l?"!!INVALID EXPRESSION!!":W._Stack[l--];let I=0,q="";for(;I<y.length;){const c=y.charAt(I),o=I<y.length-1?y.substring(I,2+I):"";if("("===c)q="",N(c);else if(")"===c){for(w();-1!==l&&"("!==p();)A.push(h());h()}else if(W._OperatorPriority[o]>1){for(w();-1!==l&&W._OperatorPriority[p()]>=W._OperatorPriority[o];)A.push(h());N(o),I++}else q+=c;I++}for(w();-1!==l;)"("===p()?h():A.push(h());return W._InfixToPostfixCache.size>=W.InfixToPostfixCacheLimitSize&&W.ClearCache(),W._InfixToPostfixCache.set(y,{result:A,accessTime:Date.now()}),A}static ClearCache(){const y=Array.from(W._InfixToPostfixCache.entries()).sort(((y,c)=>y[1].accessTime-c[1].accessTime));for(let c=0;c<W.InfixToPostfixCacheCleanupSize;c++)W._InfixToPostfixCache.delete(y[c][0])}}W.InfixToPostfixCacheLimitSize=5e4,W.InfixToPostfixCacheCleanupSize=25e3,W._InfixToPostfixCache=new Map,W._OperatorPriority={")":0,"(":1,"||":2,"&&":3},W._Stack=["","","","","","","","","","","","","","","","","","","",""];class h extends W{constructor(y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=y,this.not=c}isTrue(y){let c=void 0!==y[this.define];return this.not&&(c=!c),c}}class I extends W{isTrue(y){return this.leftOperand.isTrue(y)||this.rightOperand.isTrue(y)}}class q extends W{isTrue(y){return this.leftOperand.isTrue(y)&&this.rightOperand.isTrue(y)}}class o extends W{constructor(y,c,A){super(),this.define=y,this.operand=c,this.testValue=A}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(y){let c=!1;const A=parseInt(void 0!=y[this.define]?y[this.define]:this.define),l=parseInt(void 0!=y[this.testValue]?y[this.testValue]:this.testValue);if(isNaN(A)||isNaN(l))return!1;switch(this.operand){case">":c=A>l;break;case"<":c=A<l;break;case"<=":c=A<=l;break;case">=":c=A>=l;break;case"==":c=A===l;break;case"!=":c=A!==l}return c}}var O=A(12178),L=A(12207);const i=/defined\s*?\((.+?)\)/g,H=/defined\s*?\[(.+?)\]/g,P=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,D=/__decl__/,t=/light\{X\}.(\w*)/g,s=/\{X\}/g,B=[],X=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function C(y){y.processor&&y.processor.initializeShaders&&y.processor.initializeShaders(y.processingContext)}function K(y,c,A,l){var w;null!==(w=c.processor)&&void 0!==w&&w.preProcessShaderCode&&(y=c.processor.preProcessShaderCode(y,c.isFragment)),u(y,c,(y=>{c.processCodeAfterIncludes&&(y=c.processCodeAfterIncludes(c.isFragment?"fragment":"vertex",y,c.defines));const w=function(y,c,A){let l=function(y,c){var A;if(null!==(A=c.processor)&&void 0!==A&&A.noPrecision)return y;const l=c.shouldUseHighPrecisionShader;-1===y.indexOf("precision highp float")?y=l?"precision highp float;\n"+y:"precision mediump float;\n"+y:l||(y=y.replace("precision highp float","precision mediump float"));return y}(y,c);if(!c.processor)return l;if(0===c.processor.shaderLanguage&&-1!==l.indexOf("#version 3")&&(l=l.replace("#version 300 es",""),!c.processor.parseGLES3))return l;const w=c.defines,N=a(c,A);c.processor.preProcessor&&(l=c.processor.preProcessor(l,w,N,c.isFragment,c.processingContext));const p={};l=k(l,N,c,p),c.processor.postProcessor&&(l=c.processor.postProcessor(l,w,c.isFragment,c.processingContext,A?{drawBuffersExtensionDisabled:!A.getCaps().drawBuffersExtension}:{},N,p));null!==A&&void 0!==A&&A._features.needShaderCodeInlining&&(l=A.inlineShaderCode(l));return l}(y,c,l);A(w,y)}))}function my(y,c,A){return A.processor&&A.processor.finalizeShaders?A.processor.finalizeShaders(y,c,A.processingContext):{vertexCode:y,fragmentCode:c}}function T(y){const c=/defined\((.+)\)/.exec(y);if(c&&c.length)return new h(c[1].trim(),"!"===y[0]);const A=["==","!=",">=","<=","<",">"];let l="",w=0;for(l of A)if(w=y.indexOf(l),w>-1)break;if(-1===w)return new h(y);const N=y.substring(0,w).trim(),p=y.substring(w+l.length).trim();return new o(N,l,p)}function z(y,c){const A=new p,l=y.substring(0,c);let w=y.substring(c);return w=w.substring(0,(w.indexOf("//")+1||w.length+1)-1).trim(),A.testExpression="#ifdef"===l?new h(w):"#ifndef"===l?new h(w,!0):function(y){y=y.replace(i,"defined[$1]");const c=W.infixToPostfix(y),A=[];for(const w of c)if("||"!==w&&"&&"!==w)A.push(w);else if(A.length>=2){let y=A[A.length-1],c=A[A.length-2];A.length-=2;const l="&&"==w?new q:new I;"string"===typeof y&&(y=y.replace(H,"defined($1)")),"string"===typeof c&&(c=c.replace(H,"defined($1)")),l.leftOperand="string"===typeof c?T(c):c,l.rightOperand="string"===typeof y?T(y):y,A.push(l)}let l=A[A.length-1];return"string"===typeof l&&(l=l.replace(H,"defined($1)")),"string"===typeof l?T(l):l}(w),A}function S(y,c,A,w){let N=y.currentLine;for(;M(y,A,w);){N=y.currentLine;const p=N.substring(0,5).toLowerCase();if("#else"===p){const A=new l;return c.children.push(A),void M(y,A,w)}if("#elif"===p){const y=z(N,5);c.children.push(y),A=y}}}function M(y,c,A){for(;y.canRead;){y.lineIndex++;const w=y.currentLine;if(w.indexOf("#")>=0){const l=X.exec(w);if(l&&l.length){switch(l[0]){case"#ifdef":{const l=new N;c.children.push(l);const p=z(w,6);l.children.push(p),S(y,l,p,A);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const l=new N;c.children.push(l);const p=z(w,7);l.children.push(p),S(y,l,p,A);break}case"#if":{const l=new N,p=z(w,3);c.children.push(l),l.children.push(p),S(y,l,p,A);break}}continue}}const p=new l;if(p.line=w,c.children.push(p),"#"===w[0]&&"d"===w[1]){const y=w.replace(";","").split(" ");p.additionalDefineKey=y[1],3===y.length&&(p.additionalDefineValue=y[2])}}return!1}function k(y,c,A,N){const p=new l,W=new w;return W.lineIndex=-1,W.lines=y.split("\n"),M(W,p,N),p.process(c,A,N)}function a(y,c){var A;const l=y.defines,w={};for(const N of l){const y=N.replace("#define","").replace(";","").trim().split(" ");w[y[0]]=y.length>1?y[1]:""}return 0===(null===(A=y.processor)||void 0===A?void 0:A.shaderLanguage)&&(w.GL_ES="true"),w.__VERSION__=y.version,w[y.platformName]="true",(0,L.k)(w,null===c||void 0===c?void 0:c.isNDCHalfZRange,null===c||void 0===c?void 0:c.Xc,null===c||void 0===c?void 0:c.useExactSrgbConversions),w}function u(y,c,A){let l;for(B.length=0;null!==(l=P.exec(y));)B.push(l);let w=String(y),N=[y],p=!1;for(const W of B){let y=W[1];if(-1!==y.indexOf("__decl__")&&(y=y.replace(D,""),c.supportsUniformBuffers&&(y=y.replace("Vertex","Ubo").replace("Fragment","Ubo")),y+="Declaration"),!c.includesShadersStore[y]){const l=c.shadersRepository+"ShadersInclude/"+y+".fx";return void G.loadFile(l,(l=>{c.includesShadersStore[y]=l,u(N.join(""),c,A)}))}{let A=c.includesShadersStore[y];if(W[2]){const y=W[3].split(",");for(let c=0;c<y.length;c+=2){const l=new RegExp(y[c],"g"),w=y[c+1];A=A.replace(l,w)}}if(W[4]){const y=W[5];if(-1!==y.indexOf("..")){const l=y.split(".."),w=parseInt(l[0]);let N=parseInt(l[1]),p=A.slice(0);A="",isNaN(N)&&(N=c.indexParameters[l[1]]);for(let y=w;y<N;y++)c.supportsUniformBuffers||(p=p.replace(t,((y,c)=>c+"{X}"))),A+=p.replace(s,y.toString())+"\n"}else c.supportsUniformBuffers||(A=A.replace(t,((y,c)=>c+"{X}"))),A=A.replace(s,y)}const l=[];for(const y of N){const c=y.split(W[0]);for(let y=0;y<c.length-1;y++)l.push(c[y]),l.push(A);l.push(c[c.length-1])}N=l,p=p||A.indexOf("#include<")>=0||A.indexOf("#include <")>=0}}B.length=0,w=N.join(""),p?u(w.toString(),c,A):A(w)}const G={loadFile:(y,c,A,l,w,N)=>{throw(0,O.d)("FileTools")}}},12207:(y,c,A)=>{A.d(c,{d:()=>w,g:()=>N,k:()=>W,o:()=>p,r:()=>h});var l=A(12178);A(12159);const w={};function N(y,c){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(c?c+"\n":"")+y}function p(y,c,A,N,p,W,h){const I=h||w.loadFile;if(I){return I(y,c,A,N,p,W)}throw(0,l.d)("FileTools")}function W(y,c,A,l){if(y)return c?y.IS_NDC_HALF_ZRANGE="":delete y.IS_NDC_HALF_ZRANGE,A?y.USE_REVERSE_DEPTHBUFFER="":delete y.USE_REVERSE_DEPTHBUFFER,void(l?y.USE_EXACT_SRGB_CONVERSIONS="":delete y.USE_EXACT_SRGB_CONVERSIONS);{let y="";return c&&(y+="#define IS_NDC_HALF_ZRANGE"),A&&(y&&(y+="\n"),y+="#define USE_REVERSE_DEPTHBUFFER"),l&&(y&&(y+="\n"),y+="#define USE_EXACT_SRGB_CONVERSIONS"),y}}function h(y,c){let A=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3?arguments[3]:void 0;switch(y){case 3:{const y=(ArrayBuffer,new Int8Array(c));return l&&y.set(new Int8Array(l)),y}case 0:{const y=(ArrayBuffer,new Uint8Array(c));return l&&y.set(new Uint8Array(l)),y}case 4:{const y=c instanceof ArrayBuffer?new Int16Array(c):new Int16Array(A?c/2:c);return l&&y.set(new Int16Array(l)),y}case 5:case 8:case 9:case 10:case 2:{const y=c instanceof ArrayBuffer?new Uint16Array(c):new Uint16Array(A?c/2:c);return l&&y.set(new Uint16Array(l)),y}case 6:{const y=c instanceof ArrayBuffer?new Int32Array(c):new Int32Array(A?c/4:c);return l&&y.set(new Int32Array(l)),y}case 7:case 11:case 12:case 13:case 14:case 15:{const y=c instanceof ArrayBuffer?new Uint32Array(c):new Uint32Array(A?c/4:c);return l&&y.set(new Uint32Array(l)),y}case 1:{const y=c instanceof ArrayBuffer?new Float32Array(c):new Float32Array(A?c/4:c);return l&&y.set(new Float32Array(l)),y}}const w=(ArrayBuffer,new Uint8Array(c));return l&&w.set(new Uint8Array(l)),w}},12233:(y,c,A)=>{A.d(c,{b:()=>l});class l{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.ShadersRepository:l.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.ShadersStore:l.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?l.IncludesShadersStore:l.IncludesShadersStoreWGSL}}l.ShadersRepository="src/Shaders/",l.ShadersStore={},l.IncludesShadersStore={},l.ShadersRepositoryWGSL="src/ShadersWGSL/",l.ShadersStoreWGSL={},l.IncludesShadersStoreWGSL={}},12244:(y,c,A)=>{A.d(c,{e:()=>O,i:()=>s,j:()=>i,k:()=>L,l:()=>H,m:()=>t,p:()=>o,t:()=>I,x:()=>q,B:()=>h,C:()=>W});class l{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Uc._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(y){y&&this.program&&y(this.program)}setEngine(y){this.Uc=y}_fillEffectInformation(y,c,A,l,w,N,p,W){const h=this.Uc;if(h.supportsUniformBuffers)for(const q in c)y.bindUniformBlock(q,c[q]);let I;for(this.Uc.getUniforms(this,A).forEach(((y,c)=>{l[A[c]]=y})),this._uniforms=l,I=0;I<w.length;I++){null==y.getUniform(w[I])&&(w.splice(I,1),I--)}w.forEach(((y,c)=>{N[y]=c}));for(const q of h.getAttributes(this,p))W.push(q)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(y,c){const A=this._valueCache[y],l=c.updateFlag;return(void 0===A||A!==l)&&(this._valueCache[y]=l,!0)}_cacheFloat2(y,c,A){let l=this._valueCache[y];if(!l||2!==l.length)return l=[c,A],this._valueCache[y]=l,!0;let w=!1;return l[0]!==c&&(l[0]=c,w=!0),l[1]!==A&&(l[1]=A,w=!0),w}_cacheFloat3(y,c,A,l){let w=this._valueCache[y];if(!w||3!==w.length)return w=[c,A,l],this._valueCache[y]=w,!0;let N=!1;return w[0]!==c&&(w[0]=c,N=!0),w[1]!==A&&(w[1]=A,N=!0),w[2]!==l&&(w[2]=l,N=!0),N}_cacheFloat4(y,c,A,l,w){let N=this._valueCache[y];if(!N||4!==N.length)return N=[c,A,l,w],this._valueCache[y]=N,!0;let p=!1;return N[0]!==c&&(N[0]=c,p=!0),N[1]!==A&&(N[1]=A,p=!0),N[2]!==l&&(N[2]=l,p=!0),N[3]!==w&&(N[3]=w,p=!0),p}setInt(y,c){const A=this._valueCache[y];void 0!==A&&A===c||this.Uc.setInt(this._uniforms[y],c)&&(this._valueCache[y]=c)}setInt2(y,c,A){this._cacheFloat2(y,c,A)&&(this.Uc.setInt2(this._uniforms[y],c,A)||(this._valueCache[y]=null))}setInt3(y,c,A,l){this._cacheFloat3(y,c,A,l)&&(this.Uc.setInt3(this._uniforms[y],c,A,l)||(this._valueCache[y]=null))}setInt4(y,c,A,l,w){this._cacheFloat4(y,c,A,l,w)&&(this.Uc.setInt4(this._uniforms[y],c,A,l,w)||(this._valueCache[y]=null))}setIntArray(y,c){this._valueCache[y]=null,this.Uc.setIntArray(this._uniforms[y],c)}setIntArray2(y,c){this._valueCache[y]=null,this.Uc.setIntArray2(this._uniforms[y],c)}setIntArray3(y,c){this._valueCache[y]=null,this.Uc.setIntArray3(this._uniforms[y],c)}setIntArray4(y,c){this._valueCache[y]=null,this.Uc.setIntArray4(this._uniforms[y],c)}setUInt(y,c){const A=this._valueCache[y];void 0!==A&&A===c||this.Uc.setUInt(this._uniforms[y],c)&&(this._valueCache[y]=c)}setUInt2(y,c,A){this._cacheFloat2(y,c,A)&&(this.Uc.setUInt2(this._uniforms[y],c,A)||(this._valueCache[y]=null))}setUInt3(y,c,A,l){this._cacheFloat3(y,c,A,l)&&(this.Uc.setUInt3(this._uniforms[y],c,A,l)||(this._valueCache[y]=null))}setUInt4(y,c,A,l,w){this._cacheFloat4(y,c,A,l,w)&&(this.Uc.setUInt4(this._uniforms[y],c,A,l,w)||(this._valueCache[y]=null))}setUIntArray(y,c){this._valueCache[y]=null,this.Uc.setUIntArray(this._uniforms[y],c)}setUIntArray2(y,c){this._valueCache[y]=null,this.Uc.setUIntArray2(this._uniforms[y],c)}setUIntArray3(y,c){this._valueCache[y]=null,this.Uc.setUIntArray3(this._uniforms[y],c)}setUIntArray4(y,c){this._valueCache[y]=null,this.Uc.setUIntArray4(this._uniforms[y],c)}setArray(y,c){this._valueCache[y]=null,this.Uc.setArray(this._uniforms[y],c)}setArray2(y,c){this._valueCache[y]=null,this.Uc.setArray2(this._uniforms[y],c)}setArray3(y,c){this._valueCache[y]=null,this.Uc.setArray3(this._uniforms[y],c)}setArray4(y,c){this._valueCache[y]=null,this.Uc.setArray4(this._uniforms[y],c)}setMatrices(y,c){c&&(this._valueCache[y]=null,this.Uc.setMatrices(this._uniforms[y],c))}setMatrix(y,c){this._cacheMatrix(y,c)&&(this.Uc.setMatrices(this._uniforms[y],c.fc())||(this._valueCache[y]=null))}setMatrix3x3(y,c){this._valueCache[y]=null,this.Uc.setMatrix3x3(this._uniforms[y],c)}setMatrix2x2(y,c){this._valueCache[y]=null,this.Uc.setMatrix2x2(this._uniforms[y],c)}setFloat(y,c){const A=this._valueCache[y];void 0!==A&&A===c||this.Uc.setFloat(this._uniforms[y],c)&&(this._valueCache[y]=c)}setVector2(y,c){this._cacheFloat2(y,c.x,c.y)&&(this.Uc.setFloat2(this._uniforms[y],c.x,c.y)||(this._valueCache[y]=null))}setFloat2(y,c,A){this._cacheFloat2(y,c,A)&&(this.Uc.setFloat2(this._uniforms[y],c,A)||(this._valueCache[y]=null))}setVector3(y,c){this._cacheFloat3(y,c.x,c.y,c.z)&&(this.Uc.setFloat3(this._uniforms[y],c.x,c.y,c.z)||(this._valueCache[y]=null))}setFloat3(y,c,A,l){this._cacheFloat3(y,c,A,l)&&(this.Uc.setFloat3(this._uniforms[y],c,A,l)||(this._valueCache[y]=null))}setVector4(y,c){this._cacheFloat4(y,c.x,c.y,c.z,c.w)&&(this.Uc.setFloat4(this._uniforms[y],c.x,c.y,c.z,c.w)||(this._valueCache[y]=null))}setQuaternion(y,c){this._cacheFloat4(y,c.x,c.y,c.z,c.w)&&(this.Uc.setFloat4(this._uniforms[y],c.x,c.y,c.z,c.w)||(this._valueCache[y]=null))}setFloat4(y,c,A,l,w){this._cacheFloat4(y,c,A,l,w)&&(this.Uc.setFloat4(this._uniforms[y],c,A,l,w)||(this._valueCache[y]=null))}setColor3(y,c){this._cacheFloat3(y,c.r,c.g,c.b)&&(this.Uc.setFloat3(this._uniforms[y],c.r,c.g,c.b)||(this._valueCache[y]=null))}setColor4(y,c,A){this._cacheFloat4(y,c.r,c.g,c.b,A)&&(this.Uc.setFloat4(this._uniforms[y],c.r,c.g,c.b,A)||(this._valueCache[y]=null))}setDirectColor4(y,c){this._cacheFloat4(y,c.r,c.g,c.b,c.a)&&(this.Uc.setFloat4(this._uniforms[y],c.r,c.g,c.b,c.a)||(this._valueCache[y]=null))}_getVertexShaderCode(){return this.vertexShader?this.Uc._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Uc._getShaderSource(this.fragmentShader):null}}var w=A(12207);const N=new WeakMap,p={_webGLVersion:2,cachedPipelines:{}};function W(y){let c=N.get(y);if(!c){if(!y)return p;c={_webGLVersion:y.TEXTURE_BINDING_3D?2:1,_context:y,parallelShaderCompile:y.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},N.set(y,c)}return c}function h(y){N.delete(y)}function I(y,c,A,l,w,N){const p=W(l);N||(N=p._createShaderProgramInjection??O);return N(y,D(c,"vertex",l,p._contextWasLost),D(A,"fragment",l,p._contextWasLost),l,w,p.validateShaderPrograms)}function q(y,c,A,l,w){let N=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=arguments.length>6?arguments[6]:void 0;const h=W(w);p||(p=h._createShaderProgramInjection??O);const I=h._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return p(y,P(c,"vertex",l,I,w,h._contextWasLost),P(A,"fragment",l,I,w,h._contextWasLost),w,N,h.validateShaderPrograms)}function o(y,c){const A=new l,w=W(y);return w.parallelShaderCompile&&!w.disableParallelShaderCompile&&(A.isParallelCompiled=!0),A.context=w._context,A}function O(y,c,A,l){let w=arguments.length>5?arguments[5]:void 0;const N=l.createProgram();if(y.program=N,!N)throw new Error("Unable to create program");return l.attachShader(N,c),l.attachShader(N,A),l.linkProgram(N),y.context=l,y.vertexShader=c,y.fragmentShader=A,y.isParallelCompiled||i(y,l,w),N}function L(y,c,A){const l=y;if(l._isDisposed)return!1;const w=W(c);return!!(w&&w.parallelShaderCompile&&w.parallelShaderCompile.COMPLETION_STATUS_KHR&&l.program&&c.getProgramParameter(l.program,w.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(i(l,c,A),!0)}function i(y,c,A){const l=y.context,w=y.vertexShader,N=y.fragmentShader,p=y.program;if(!l.getProgramParameter(p,l.LINK_STATUS)){if(!c.getShaderParameter(w,c.COMPILE_STATUS)){const A=c.getShaderInfoLog(w);if(A)throw y.vertexCompilationError=A,new Error("VERTEX SHADER "+A)}if(!c.getShaderParameter(N,c.COMPILE_STATUS)){const A=c.getShaderInfoLog(N);if(A)throw y.fragmentCompilationError=A,new Error("FRAGMENT SHADER "+A)}const A=l.getProgramInfoLog(p);if(A)throw y.programLinkError=A,new Error(A)}if(A){l.validateProgram(p);if(!l.getProgramParameter(p,l.VALIDATE_STATUS)){const c=l.getProgramInfoLog(p);if(c)throw y.programValidationError=c,new Error(c)}}l.deleteShader(w),l.deleteShader(N),y.vertexShader=void 0,y.fragmentShader=void 0,y.onCompiled&&(y.onCompiled(),y.onCompiled=void 0)}function H(y,c,A,l,w,N,p,h,o){let O=arguments.length>10?arguments[10]:void 0,L=arguments.length>11?arguments[11]:void 0,i=arguments.length>12?arguments[12]:void 0;const H=W(y.context);L||(L=H.createRawShaderProgramInjection??I),i||(i=H.createShaderProgramInjection??q);const P=y;P.program=l?L(P,c,A,P.context,o):i(P,c,A,h,P.context,o),P.program.__SPECTOR_rebuildProgram=p,O()}function P(y,c,A,l,N,p){return D((0,w.g)(y,A,l),c,N,p)}function D(y,c,A,l){const w=A.createShader("vertex"===c?A.VERTEX_SHADER:A.FRAGMENT_SHADER);if(!w){let y=A.NO_ERROR,w=A.NO_ERROR;for(;(w=A.getError())!==A.NO_ERROR;)y=w;throw new Error(`Something went wrong while creating a gl ${c} shader object. gl error=${y}, gl isContextLost=${A.isContextLost()}, _contextWasLost=${l}`)}return A.shaderSource(w,y),A.compileShader(w),w}function t(y,c){c.useProgram(y)}function s(y,c){const A=y;if(!A.isParallelCompiled)return void c(y);const l=A.onCompiled;A.onCompiled=()=>{null===l||void 0===l||l(),c(y)}}},12240:(y,c,A)=>{A.d(c,{c:()=>o,f:()=>L,i:()=>I,l:()=>q});var l=A(12159),w=A(12244),N=A(12233),p=A(12161),W=A(12204),h=A(12207);function I(y,c){return(0,w.C)(c).cachedPipelines[y]}function q(y){const c=y._name,A=y.context;if(c&&A){const y=(0,w.C)(A),l=y.cachedPipelines[c];null===l||void 0===l||l.dispose(),delete y.cachedPipelines[c]}}function o(y,c,A,w,N,p,h){let I,q;const o=(0,l.m)()?null===p||void 0===p?void 0:p.getHostDocument():null;I="string"===typeof c?c:c.vertexSource?"source:"+c.vertexSource:c.vertexElement?(null===o||void 0===o?void 0:o.getElementById(c.vertexElement))||c.vertexElement:c.vertex||c,q="string"===typeof c?c:c.fragmentSource?"source:"+c.fragmentSource:c.fragmentElement?(null===o||void 0===o?void 0:o.getElementById(c.fragmentElement))||c.fragmentElement:c.fragment||c;const L=[void 0,void 0],i=()=>{if(L[0]&&L[1]){y.isFragment=!0;const[l,I]=L;(0,W.o)(I,y,((p,I)=>{h&&(h._fragmentSourceCodeBeforeMigration=I),A&&(p=A("fragment",p));const q=(0,W.e)(l,p,y);y=null;const o=function(y,c,A,l){if(A){return{vertexSourceCode:(1===l?"//":"")+"#define SHADER_NAME vertex:"+(A.vertexElement||A.vertex||A.spectorName||A)+"\n"+y,fragmentSourceCode:(1===l?"//":"")+"#define SHADER_NAME fragment:"+(A.fragmentElement||A.fragment||A.spectorName||A)+"\n"+c}}return{vertexSourceCode:y,fragmentSourceCode:c}}(q.vertexCode,q.fragmentCode,c,N);null===w||void 0===w||w(o.vertexSourceCode,o.fragmentSourceCode)}),p)}};O(I,"Vertex","",(c=>{(0,W.h)(y),(0,W.o)(c,y,((y,l)=>{h&&(h._rawVertexSourceCode=c,h._vertexSourceCodeBeforeMigration=l),A&&(y=A("vertex",y)),L[0]=y,i()}),p)}),N),O(q,"Fragment","Pixel",(y=>{h&&(h._rawFragmentSourceCode=y),L[1]=y,i()}),N)}function O(y,c,A,w,p,W){if("undefined"!==typeof HTMLElement&&y instanceof HTMLElement){return void w((0,l.e)(y))}if("source:"===y.substring(0,7))return void w(y.substring(7));if("base64:"===y.substring(0,7)){return void w(window.atob(y.substring(7)))}const I=N.b.GetShadersStore(p);if(I[y+c+"Shader"])return void w(I[y+c+"Shader"]);if(A&&I[y+A+"Shader"])return void w(I[y+A+"Shader"]);let q;if(q="."===y[0]||"/"===y[0]||y.indexOf("http")>-1?y:N.b.GetShadersRepository(p)+y,!(W=W||h.o))throw new Error("loadFileInjection is not defined");W(q+"."+c.toLowerCase()+".fx",w)}const L=(y,c,A,l)=>{try{const N=y.context?(0,w.C)(y.context):null;N&&(N.disableParallelShaderCompile=y.disableParallelCompilation);const p=y.existingPipelineContext||c(y.shaderProcessingContext);return p._name=y.name,y.name&&N&&(N.cachedPipelines[y.name]=p),A(p,y.vertex,y.fragment,!!y.createAsRaw,"","",y.rebuildRebind,y.defines,y.transformFeedbackVaryings,"",(()=>{l(p,(()=>{var c;null===(c=y.onRenderingStateCompiled)||void 0===c||c.call(y,p)}))})),p}catch(N){throw p.c.Error("Error compiling effect"),N}}},12224:(y,c,A)=>{A.r(c),A.d(c,{Effect:()=>h});var l=A(12153),w=A(12161),N=A(12233),p=A(12240),W=A(12212);class h{static get ShadersRepository(){return N.b.ShadersRepository}static set ShadersRepository(y){N.b.ShadersRepository=y}get I(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new l.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(y,c,A){let w=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,N=arguments.length>4?arguments[4]:void 0,W=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,I=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,q=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,o=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,O=arguments.length>9?arguments[9]:void 0,L=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",i=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,H=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new l.d,this.onErrorObservable=new l.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=y,this._key=L;const P=this._key.replace(/\r/g,"").replace(/\n/g,"|");let D;if(c.attributes){const y=c;if(this._engine=A,this._attributesNames=y.attributes,this._uniformsNames=y.uniformsNames.concat(y.samplers),this._samplerList=y.samplers.slice(),this.defines=y.defines,this.onError=y.onError,this.onCompiled=y.onCompiled,this._fallbacks=y.fallbacks,this._indexParameters=y.indexParameters,this._transformFeedbackVaryings=y.transformFeedbackVaryings||null,this._multiTarget=!!y.multiTarget,this._shaderLanguage=y.shaderLanguage??0,this._disableParallelShaderCompilation=!!y.disableParallelShaderCompilation,y.uniformBuffersNames){this._uniformBuffersNamesList=y.uniformBuffersNames.slice();for(let c=0;c<y.uniformBuffersNames.length;c++)this._uniformBuffersNames[y.uniformBuffersNames[c]]=c}this._processFinalCode=y.processFinalCode??null,this._processCodeAfterIncludes=y.processCodeAfterIncludes??void 0,H=y.extraInitializationsAsync,D=y.existingPipelineContext}else this._engine=N,this.defines=null==W?"":W,this._uniformsNames=A.concat(w),this._samplerList=w?w.slice():[],this._attributesNames=c,this._uniformBuffersNamesList=[],this._shaderLanguage=i,this.onError=o,this.onCompiled=q,this._indexParameters=O,this._fallbacks=I;"WEBGL2"===this._engine.shaderPlatformName&&(D=(0,p.i)(P,this._engine._gl)??D),this._attributeLocationByName={},this.uniqueId=h._UniqueIdSeed++,D?(this._pipelineContext=D,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,H),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.I||this.dispose(!0)}))}async _processShaderCodeAsync(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3?arguments[3]:void 0;l&&await l(),this._processingContext=A||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const w={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:y??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:N.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:N.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,Xc:this._engine.Xc,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,p.c)(w,this.name,this._processFinalCode,((y,A)=>{this._vertexSourceCode=y,this._fragmentSourceCode=A,this._prepareEffect(c)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.I||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(y){return this._attributes[y]}getAttributeLocationByName(y){return this._attributeLocationByName[y]}getAttributesCount(){return this._attributes.length}getUniformIndex(y){return this._uniformsNames.indexOf(y)}getUniform(y){return this._uniforms[y]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((y=>{this.executeWhenCompiled(y)}))}executeWhenCompiled(y){this.isReady()?y(this):(this.onCompileObservable.add((c=>{y(c)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(y){(0,W.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(c=>{this._processCompilationErrors(c,y)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var y;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(y=this._pipelineContext)||void 0===y?void 0:y._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var y;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(y=this._pipelineContext)||void 0===y?void 0:y._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,Xc:this._engine.Xc,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(y,c,A,l){this._isReady=!1,this._vertexSourceCodeOverride=y,this._fragmentSourceCodeOverride=c,this.onError=(y,c)=>{l&&l(c)},this.onCompiled=()=>{var y,c;const l=this.getEngine().scenes;if(l)for(let A=0;A<l.length;A++)l[A].markAllMaterialsAsDirty(127);null===(y=(c=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===y||y.call(c,A)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(y){if(this._pipelineContext=y,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let c=0;c<this._attributesNames.length;c++){const y=this._attributesNames[c];this._attributeLocationByName[y]=this._attributes[c]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),h.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const c=this._pipelineContext;this._isReady=!1;try{const A=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),l=A?null:this.defines,w=A?this._vertexSourceCodeOverride:this._vertexSourceCode,N=A?this._fragmentSourceCodeOverride:this._fragmentSourceCode,W=this._engine;this._pipelineContext=(0,p.f)({existingPipelineContext:y?c:null,vertex:w,fragment:N,context:"WEBGL2"===W.shaderPlatformName||"WEBGL1"===W.shaderPlatformName?W._gl:void 0,rebuildRebind:(y,c,A,l)=>this._rebuildProgram(y,c,A,l),defines:l,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:A,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:A=>{c&&!y&&this._engine._deletePipelineContext(c),A&&this._onRenderingStateCompiled(A)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(c)}catch(A){this._processCompilationErrors(A,c)}}_getShaderCodeAndErrorLine(y,c,A){const l=A?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let w=null;if(c&&y){const N=c.match(l);if(N&&2===N.length){const c=parseInt(N[1]),l=y.split("\n",-1);l.length>=c&&(w=`Offending line [${c}] in ${A?"fragment":"vertex"} code: ${l[c-1]}`)}}return[y,w]}_processCompilationErrors(y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=y.message;const A=this._attributesNames,l=this._fallbacks;if(w.c.Error("Unable to compile effect:"),w.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),w.c.Error(`Attributes: ${A.join(" ")}`),w.c.Error("Defines:\n"+this.defines),h.LogShaderCodeOnCompilationError){var N,p;let y=null,c=null,A=null;var W;if(null!==(N=this._pipelineContext)&&void 0!==N&&N._getVertexShaderCode()&&([A,y]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),A&&(w.c.Error("Vertex code:"),w.c.Error(A))),null!==(p=this._pipelineContext)&&void 0!==p&&p._getFragmentShaderCode())[A,c]=this._getShaderCodeAndErrorLine(null===(W=this._pipelineContext)||void 0===W?void 0:W._getFragmentShaderCode(),this._compilationError,!0),A&&(w.c.Error("Fragment code:"),w.c.Error(A));y&&w.c.Error(y),c&&w.c.Error(c)}w.c.Error("Error: "+this._compilationError);const I=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};c&&(this._pipelineContext=c,this._isReady=!0,I()),l?(this._pipelineContext=null,l.hasMoreFallbacks?(this._allFallbacksProcessed=!1,w.c.Error("Trying next fallback."),this.defines=l.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,I(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,c||I())}get isSupported(){return""===this._compilationError}_bindTexture(y,c){this._engine._bindTexture(this._samplers[y],c,y)}setTexture(y,c){this._engine.setTexture(this._samplers[y],this._uniforms[y],c,y)}setTextureArray(y,c){const A=y+"Ex";if(-1===this._samplerList.indexOf(A+"0")){const l=this._samplerList.indexOf(y);for(let y=1;y<c.length;y++){const c=A+(y-1).toString();this._samplerList.splice(l+y,0,c)}let w=0;for(const y of this._samplerList)this._samplers[y]=w,w+=1}this._engine.setTextureArray(this._samplers[y],this._uniforms[y],c,y)}bindUniformBuffer(y,c){const A=this._uniformBuffersNames[c];void 0===A||h._BaseCache[A]===y&&this._engine._features.useUBOBindingCache||(h._BaseCache[A]=y,this._engine.bindUniformBufferBase(y,A,c))}bindUniformBlock(y,c){this._engine.bindUniformBlock(this._pipelineContext,y,c)}setInt(y,c){return this._pipelineContext.setInt(y,c),this}setInt2(y,c,A){return this._pipelineContext.setInt2(y,c,A),this}setInt3(y,c,A,l){return this._pipelineContext.setInt3(y,c,A,l),this}setInt4(y,c,A,l,w){return this._pipelineContext.setInt4(y,c,A,l,w),this}setIntArray(y,c){return this._pipelineContext.setIntArray(y,c),this}setIntArray2(y,c){return this._pipelineContext.setIntArray2(y,c),this}setIntArray3(y,c){return this._pipelineContext.setIntArray3(y,c),this}setIntArray4(y,c){return this._pipelineContext.setIntArray4(y,c),this}setUInt(y,c){return this._pipelineContext.setUInt(y,c),this}setUInt2(y,c,A){return this._pipelineContext.setUInt2(y,c,A),this}setUInt3(y,c,A,l){return this._pipelineContext.setUInt3(y,c,A,l),this}setUInt4(y,c,A,l,w){return this._pipelineContext.setUInt4(y,c,A,l,w),this}setUIntArray(y,c){return this._pipelineContext.setUIntArray(y,c),this}setUIntArray2(y,c){return this._pipelineContext.setUIntArray2(y,c),this}setUIntArray3(y,c){return this._pipelineContext.setUIntArray3(y,c),this}setUIntArray4(y,c){return this._pipelineContext.setUIntArray4(y,c),this}setFloatArray(y,c){return this._pipelineContext.setArray(y,c),this}setFloatArray2(y,c){return this._pipelineContext.setArray2(y,c),this}setFloatArray3(y,c){return this._pipelineContext.setArray3(y,c),this}setFloatArray4(y,c){return this._pipelineContext.setArray4(y,c),this}setArray(y,c){return this._pipelineContext.setArray(y,c),this}setArray2(y,c){return this._pipelineContext.setArray2(y,c),this}setArray3(y,c){return this._pipelineContext.setArray3(y,c),this}setArray4(y,c){return this._pipelineContext.setArray4(y,c),this}setMatrices(y,c){return this._pipelineContext.setMatrices(y,c),this}setMatrix(y,c){return this._pipelineContext.setMatrix(y,c),this}setMatrix3x3(y,c){return this._pipelineContext.setMatrix3x3(y,c),this}setMatrix2x2(y,c){return this._pipelineContext.setMatrix2x2(y,c),this}setFloat(y,c){return this._pipelineContext.setFloat(y,c),this}setBool(y,c){return this._pipelineContext.setInt(y,c?1:0),this}setVector2(y,c){return this._pipelineContext.setVector2(y,c),this}setFloat2(y,c,A){return this._pipelineContext.setFloat2(y,c,A),this}setVector3(y,c){return this._pipelineContext.setVector3(y,c),this}setFloat3(y,c,A,l){return this._pipelineContext.setFloat3(y,c,A,l),this}setVector4(y,c){return this._pipelineContext.setVector4(y,c),this}setQuaternion(y,c){return this._pipelineContext.setQuaternion(y,c),this}setFloat4(y,c,A,l,w){return this._pipelineContext.setFloat4(y,c,A,l,w),this}setColor3(y,c){return this._pipelineContext.setColor3(y,c),this}setColor4(y,c,A){return this._pipelineContext.setColor4(y,c,A),this}setDirectColor4(y,c){return this._pipelineContext.setDirectColor4(y,c),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(h.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,p.l)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(y,c,A){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;c&&(N.b.GetShadersStore(l)[`${y}PixelShader`]=c),A&&(N.b.GetShadersStore(l)[`${y}VertexShader`]=A)}static ResetCache(){h._BaseCache={}}}h.LogShaderCodeOnCompilationError=!0,h.PersistentMode=!1,h.AutomaticallyClearCodeCache=!1,h._UniqueIdSeed=0,h._BaseCache={},h.ShadersStore=N.b.ShadersStore,h.IncludesShadersStore=N.b.IncludesShadersStore},12178:(y,c,A)=>{A.d(c,{d:()=>w});const l={};function w(y){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!l[y])return l[y]=!0,`${y} needs to be imported before as it contains a side-effect required by your code.`}},12159:(y,c,A)=>{function l(){return"undefined"!==typeof window}function w(){return"undefined"!==typeof navigator}function N(){return"undefined"!==typeof document}function p(y){let c="",A=y.firstChild;for(;A;)3===A.nodeType&&(c+=A.textContent),A=A.nextSibling;return c}A.d(c,{e:()=>p,h:()=>N,j:()=>w,m:()=>l})},12161:(y,c,A)=>{A.d(c,{c:()=>l});class l{static _CheckLimit(y,c){let A=l._LogLimitOutputs[y];return A?A.current++:(A={limit:c,current:1},l._LogLimitOutputs[y]=A),A.current<=A.limit}static _GenerateLimitMessage(y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const A=l._LogLimitOutputs[y];if(!A||!l.MessageLimitReached)return;const w=this._Levels[c];A.current===A.limit&&l[w.name](l.MessageLimitReached.replace(/%LIMIT%/g,""+A.limit).replace(/%TYPE%/g,w.name??""))}static _AddLogEntry(y){l._LogCache=y+l._LogCache,l.OnNewCacheEntry&&l.OnNewCacheEntry(y)}static _FormatMessage(y){const c=y=>y<10?"0"+y:""+y,A=new Date;return"["+c(A.getHours())+":"+c(A.getMinutes())+":"+c(A.getSeconds())+"]: "+y}static _LogDisabled(y,c){}static _LogEnabled(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,c=arguments.length>1?arguments[1]:void 0,A=arguments.length>2?arguments[2]:void 0;const w=Array.isArray(c)?c[0]:c;if(void 0!==A&&!l._CheckLimit(w,A))return;const N=l._FormatMessage(w),p=this._Levels[y],W=Array.isArray(c)?c.slice(1):[];p.logFunc&&p.logFunc("BJS - "+N,...W);const h=`<div style='color:${p.color}'>${N}</div><br>`;l._AddLogEntry(h),l._GenerateLimitMessage(w,y)}static get LogCache(){return l._LogCache}static ClearLogCache(){l._LogCache="",l._LogLimitOutputs={},l.errorsCount=0}static set LogLevels(y){l.Log=l._LogDisabled,l.Warn=l._LogDisabled,l.Error=l._LogDisabled;const c=[l.MessageLogLevel,l.WarningLogLevel,l.ErrorLogLevel];for(const A of c)if((y&A)===A){const y=this._Levels[A];l[y.name]=l._LogEnabled.bind(l,A)}}}l.NoneLogLevel=0,l.MessageLogLevel=1,l.WarningLogLevel=2,l.ErrorLogLevel=4,l.AllLogLevel=7,l.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",l._LogCache="",l._LogLimitOutputs={},l._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],l.errorsCount=0,l.Log=l._LogEnabled.bind(l,l.MessageLogLevel),l.Warn=l._LogEnabled.bind(l,l.WarningLogLevel),l.Error=l._LogEnabled.bind(l,l.ErrorLogLevel)},12153:(y,c,A)=>{A.d(c,{d:()=>p});const l="undefined"!==typeof WeakRef;class w{constructor(y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],A=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;this.initialize(y,c,A,l)}initialize(y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],A=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0;return this.mask=y,this.skipNextObservers=c,this.target=A,this.currentTarget=l,this}}class N{constructor(y,c){let A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=y,this.mask=c,this.scope=A,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(y)}}class p{static FromPromise(y,c){const A=new p;return y.then((y=>{A.notifyObservers(y)})).catch((y=>{if(!c)throw y;c.notifyObservers(y)})),A}get observers(){return this._observers}constructor(y){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=c,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new w(0),y&&(this._onObserverAdded=y)}add(y){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],A=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!y)return null;const w=new N(y,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);w.unregisterOnNextCall=A,c?this._observers.unshift(w):this._observers.push(w),this._onObserverAdded&&this._onObserverAdded(w),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(w,this._lastNotifiedValue);const p=l?new WeakRef(this):{deref:()=>this};return w._remove=function(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const c=p.deref();c&&(y?c.remove(w):c._remove(w))},w}addOnce(y){return this.add(y,void 0,void 0,void 0,!0)}remove(y){if(!y)return!1;y._remove=null;return-1!==this._observers.indexOf(y)&&(this._deferUnregister(y),!0)}removeCallback(y,c){for(let A=0;A<this._observers.length;A++){const l=this._observers[A];if(!l._willBeUnregistered&&(l.callback===y&&(!c||c===l.scope)))return this._deferUnregister(l),!0}return!1}_deferUnregister(y){y._willBeUnregistered||(this._numObserversMarkedAsDeleted++,y.unregisterOnNextCall=!1,y._willBeUnregistered=!0,setTimeout((()=>{this._remove(y)}),0))}_remove(y){let c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!y)return!1;const A=this._observers.indexOf(y);return-1!==A&&(c&&this._numObserversMarkedAsDeleted--,this._observers.splice(A,1),!0)}makeObserverTopPriority(y){this._remove(y,!1),this._observers.unshift(y)}makeObserverBottomPriority(y){this._remove(y,!1),this._observers.push(y)}notifyObservers(y){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,A=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,w=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=y),!this._observers.length)return!0;const N=this._eventState;N.mask=c,N.target=A,N.currentTarget=l,N.skipNextObservers=!1,N.lastReturnValue=y,N.userInfo=w;for(const p of this._observers)if(!p._willBeUnregistered&&(p.mask&c&&(p.unregisterOnNextCall&&this._deferUnregister(p),p.scope?N.lastReturnValue=p.callback.apply(p.scope,[y,N]):N.lastReturnValue=p.callback(y,N)),N.skipNextObservers))return!1;return!0}notifyObserver(y,c){let A=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=c),y._willBeUnregistered)return;const l=this._eventState;l.mask=A,l.skipNextObservers=!1,y.unregisterOnNextCall&&this._deferUnregister(y),y.callback(c,l)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const y=this._observers.pop();y&&(y._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const y=new p;return y._observers=this._observers.slice(0),y}hasSpecificMask(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const c of this._observers)if(c.mask&y||c.mask===y)return!0;return!1}}},12212:(y,c,A)=>{A.d(c,{c:()=>w,e:()=>p});let l=[];class w{static SetImmediate(y){0===l.length&&setTimeout((()=>{const y=l;l=[];for(const c of y)c()}),1),l.push(y)}}function N(y,c,A){try{if(y())return c(),!0}catch(l){return null===A||void 0===A||A(l),!0}return!1}const p=function(y,c,A){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,p=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&N(y,c,A))return null;const W=setInterval((()=>{N(y,c,A)?clearInterval(W):(w-=l,w<0&&(clearInterval(W),null===A||void 0===A||A(new Error("Operation timed out after maximum retries. "+(p||"")),!0)))}),l);return()=>clearInterval(W)}}}]);