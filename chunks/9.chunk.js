"use strict";(self.wy695la1oic=self.wy695la1oic||[]).push([[9],{11251:(S,v,D)=>{D.d(v,{b:()=>W,c:()=>d,f:()=>x,e:()=>X,h:()=>a});class z{constructor(){this.children=[]}isValid(S){return!0}process(S,v,D){let z="";if(this.line){let D=this.line;const h=v.processor;if(h){var e,N,m,B,g,E;h.lineProcessor&&(D=h.lineProcessor(D,v.isFragment,v.processingContext));const z=(null===(e=v.processor)||void 0===e?void 0:e.attributeKeywordName)??"attribute",A=v.isFragment&&null!==(N=v.processor)&&void 0!==N&&N.varyingFragmentKeywordName?null===(m=v.processor)||void 0===m?void 0:m.varyingFragmentKeywordName:!v.isFragment&&null!==(B=v.processor)&&void 0!==B&&B.varyingVertexKeywordName?null===(g=v.processor)||void 0===g?void 0:g.varyingVertexKeywordName:"varying";if(!v.isFragment&&h.attributeProcessor&&this.line.startsWith(z))D=h.attributeProcessor(this.line,S,v.processingContext);else if(h.varyingProcessor&&(null!==(E=h.varyingCheck)&&void 0!==E&&E.call(h,this.line,v.isFragment)||!h.varyingCheck&&this.line.startsWith(A)))D=h.varyingProcessor(this.line,v.isFragment,S,v.processingContext);else if(h.uniformProcessor&&h.uniformRegexp&&h.uniformRegexp.test(this.line))v.lookForClosingBracketForUniformBuffer||(D=h.uniformProcessor(this.line,v.isFragment,S,v.processingContext));else if(h.uniformBufferProcessor&&h.uniformBufferRegexp&&h.uniformBufferRegexp.test(this.line))v.lookForClosingBracketForUniformBuffer||(D=h.uniformBufferProcessor(this.line,v.isFragment,v.processingContext),v.lookForClosingBracketForUniformBuffer=!0);else if(h.textureProcessor&&h.textureRegexp&&h.textureRegexp.test(this.line))D=h.textureProcessor(this.line,v.isFragment,S,v.processingContext);else if((h.uniformProcessor||h.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!v.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?h.uniformProcessor&&(D=h.uniformProcessor(this.line,v.isFragment,S,v.processingContext)):h.uniformBufferProcessor&&(D=h.uniformBufferProcessor(this.line,v.isFragment,v.processingContext),v.lookForClosingBracketForUniformBuffer=!0)}v.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(v.lookForClosingBracketForUniformBuffer=!1,h.endOfUniformBufferProcessor&&(D=h.endOfUniformBufferProcessor(this.line,v.isFragment,v.processingContext)))}z+=D+"\n"}for(const h of this.children)z+=h.process(S,v,D);return this.additionalDefineKey&&(S[this.additionalDefineKey]=this.additionalDefineValue||"true",D[this.additionalDefineKey]=S[this.additionalDefineKey]),z}}class e{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(S){this._lines.length=0;for(const v of S){if(!v||"\r"===v)continue;if("#"===v[0]){this._lines.push(v);continue}const S=v.trim();if(!S)continue;if(S.startsWith("//")){this._lines.push(v);continue}const D=S.indexOf(";");if(-1===D)this._lines.push(S);else if(D===S.length-1)S.length>1&&this._lines.push(S);else{const S=v.split(";");for(let v=0;v<S.length;v++){let D=S[v];D&&(D=D.trim(),D&&this._lines.push(D+(v!==S.length-1?";":"")))}}}}}class N extends z{process(S,v,D){for(let z=0;z<this.children.length;z++){const e=this.children[z];if(e.isValid(S))return e.process(S,v,D)}return""}}class m extends z{isValid(S){return this.testExpression.isTrue(S)}}class B{isTrue(S){return!0}static postfixToInfix(S){const v=[];for(const D of S)if(void 0===B._OperatorPriority[D])v.push(D);else{const S=v[v.length-1],z=v[v.length-2];v.length-=2,v.push(`(${z}${D}${S})`)}return v[v.length-1]}static infixToPostfix(S){const v=B._InfixToPostfixCache.get(S);if(v)return v.accessTime=Date.now(),v.result;if(!S.includes("&&")&&!S.includes("||")&&!S.includes(")")&&!S.includes("("))return[S];const D=[];let z=-1;const e=()=>{h=h.trim(),""!==h&&(D.push(h),h="")},N=S=>{z<B._Stack.length-1&&(B._Stack[++z]=S)},m=()=>B._Stack[z],g=()=>-1===z?"!!INVALID EXPRESSION!!":B._Stack[z--];let E=0,h="";for(;E<S.length;){const v=S.charAt(E),A=E<S.length-1?S.substring(E,2+E):"";if("("===v)h="",N(v);else if(")"===v){for(e();-1!==z&&"("!==m();)D.push(g());g()}else if(B._OperatorPriority[A]>1){for(e();-1!==z&&B._OperatorPriority[m()]>=B._OperatorPriority[A];)D.push(g());N(A),E++}else h+=v;E++}for(e();-1!==z;)"("===m()?g():D.push(g());return B._InfixToPostfixCache.size>=B.InfixToPostfixCacheLimitSize&&B.ClearCache(),B._InfixToPostfixCache.set(S,{result:D,accessTime:Date.now()}),D}static ClearCache(){const S=Array.from(B._InfixToPostfixCache.entries()).sort(((S,v)=>S[1].accessTime-v[1].accessTime));for(let v=0;v<B.InfixToPostfixCacheCleanupSize;v++)B._InfixToPostfixCache.delete(S[v][0])}}B.InfixToPostfixCacheLimitSize=5e4,B.InfixToPostfixCacheCleanupSize=25e3,B._InfixToPostfixCache=new Map,B._OperatorPriority={")":0,"(":1,"||":2,"&&":3},B._Stack=["","","","","","","","","","","","","","","","","","","",""];class g extends B{constructor(S){let v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=S,this.not=v}isTrue(S){let v=void 0!==S[this.define];return this.not&&(v=!v),v}}class E extends B{isTrue(S){return this.leftOperand.isTrue(S)||this.rightOperand.isTrue(S)}}class h extends B{isTrue(S){return this.leftOperand.isTrue(S)&&this.rightOperand.isTrue(S)}}class A extends B{constructor(S,v,D){super(),this.define=S,this.operand=v,this.testValue=D}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(S){let v=!1;const D=parseInt(void 0!=S[this.define]?S[this.define]:this.define),z=parseInt(void 0!=S[this.testValue]?S[this.testValue]:this.testValue);if(isNaN(D)||isNaN(z))return!1;switch(this.operand){case">":v=D>z;break;case"<":v=D<z;break;case"<=":v=D<=z;break;case">=":v=D>=z;break;case"==":v=D===z;break;case"!=":v=D!==z}return v}}var w=D(11207),n=D(11254);const R=/defined\s*?\((.+?)\)/g,O=/defined\s*?\[(.+?)\]/g,I=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,K=/__decl__/,q=/light\{X\}.(\w*)/g,u=/\{X\}/g,s=[],r=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function d(S){S.processor&&S.processor.initializeShaders&&S.processor.initializeShaders(S.processingContext)}function x(S,v,D,z){var e;null!==(e=v.processor)&&void 0!==e&&e.preProcessShaderCode&&(S=v.processor.preProcessShaderCode(S,v.isFragment)),X(S,v,(S=>{v.processCodeAfterIncludes&&(S=v.processCodeAfterIncludes(v.isFragment?"fragment":"vertex",S,v.defines));const e=function(S,v,D){let z=function(S,v){var D;if(null!==(D=v.processor)&&void 0!==D&&D.noPrecision)return S;const z=v.shouldUseHighPrecisionShader;-1===S.indexOf("precision highp float")?S=z?"precision highp float;\n"+S:"precision mediump float;\n"+S:z||(S=S.replace("precision highp float","precision mediump float"));return S}(S,v);if(!v.processor)return z;if(0===v.processor.shaderLanguage&&-1!==z.indexOf("#version 3")&&(z=z.replace("#version 300 es",""),!v.processor.parseGLES3))return z;const e=v.defines,N=t(v,D);v.processor.preProcessor&&(z=v.processor.preProcessor(z,e,N,v.isFragment,v.processingContext));const m={};z=i(z,N,v,m),v.processor.postProcessor&&(z=v.processor.postProcessor(z,e,v.isFragment,v.processingContext,D?{drawBuffersExtensionDisabled:!D.getCaps().drawBuffersExtension}:{},N,m));null!==D&&void 0!==D&&D._features.needShaderCodeInlining&&(z=D.inlineShaderCode(z));return z}(S,v,z);D(e,S)}))}function W(S,v,D){return D.processor&&D.processor.finalizeShaders?D.processor.finalizeShaders(S,v,D.processingContext):{vertexCode:S,fragmentCode:v}}function p(S){const v=/defined\((.+)\)/.exec(S);if(v&&v.length)return new g(v[1].trim(),"!"===S[0]);const D=["==","!=",">=","<=","<",">"];let z="",e=0;for(z of D)if(e=S.indexOf(z),e>-1)break;if(-1===e)return new g(S);const N=S.substring(0,e).trim(),m=S.substring(e+z.length).trim();return new A(N,z,m)}function b(S,v){const D=new m,z=S.substring(0,v);let e=S.substring(v);return e=e.substring(0,(e.indexOf("//")+1||e.length+1)-1).trim(),D.testExpression="#ifdef"===z?new g(e):"#ifndef"===z?new g(e,!0):function(S){S=S.replace(R,"defined[$1]");const v=B.infixToPostfix(S),D=[];for(const e of v)if("||"!==e&&"&&"!==e)D.push(e);else if(D.length>=2){let S=D[D.length-1],v=D[D.length-2];D.length-=2;const z="&&"==e?new h:new E;"string"===typeof S&&(S=S.replace(O,"defined($1)")),"string"===typeof v&&(v=v.replace(O,"defined($1)")),z.leftOperand="string"===typeof v?p(v):v,z.rightOperand="string"===typeof S?p(S):S,D.push(z)}let z=D[D.length-1];return"string"===typeof z&&(z=z.replace(O,"defined($1)")),"string"===typeof z?p(z):z}(e),D}function k(S,v,D,e){let N=S.currentLine;for(;Z(S,D,e);){N=S.currentLine;const m=N.substring(0,5).toLowerCase();if("#else"===m){const D=new z;return v.children.push(D),void Z(S,D,e)}if("#elif"===m){const S=b(N,5);v.children.push(S),D=S}}}function Z(S,v,D){for(;S.canRead;){S.lineIndex++;const e=S.currentLine;if(e.indexOf("#")>=0){const z=r.exec(e);if(z&&z.length){switch(z[0]){case"#ifdef":{const z=new N;v.children.push(z);const m=b(e,6);z.children.push(m),k(S,z,m,D);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const z=new N;v.children.push(z);const m=b(e,7);z.children.push(m),k(S,z,m,D);break}case"#if":{const z=new N,m=b(e,3);v.children.push(z),z.children.push(m),k(S,z,m,D);break}}continue}}const m=new z;if(m.line=e,v.children.push(m),"#"===e[0]&&"d"===e[1]){const S=e.replace(";","").split(" ");m.additionalDefineKey=S[1],3===S.length&&(m.additionalDefineValue=S[2])}}return!1}function i(S,v,D,N){const m=new z,B=new e;return B.lineIndex=-1,B.lines=S.split("\n"),Z(B,m,N),m.process(v,D,N)}function t(S,v){var D;const z=S.defines,e={};for(const N of z){const S=N.replace("#define","").replace(";","").trim().split(" ");e[S[0]]=S.length>1?S[1]:""}return 0===(null===(D=S.processor)||void 0===D?void 0:D.shaderLanguage)&&(e.GL_ES="true"),e.__VERSION__=S.version,e[S.platformName]="true",(0,n.j)(e,null===v||void 0===v?void 0:v.isNDCHalfZRange,null===v||void 0===v?void 0:v.useReverseDepthBuffer,null===v||void 0===v?void 0:v.useExactSrgbConversions),e}function X(S,v,D){let z;for(s.length=0;null!==(z=I.exec(S));)s.push(z);let e=String(S),N=[S],m=!1;for(const B of s){let S=B[1];if(-1!==S.indexOf("__decl__")&&(S=S.replace(K,""),v.supportsUniformBuffers&&(S=S.replace("Vertex","Ubo").replace("Fragment","Ubo")),S+="Declaration"),!v.includesShadersStore[S]){const z=v.shadersRepository+"ShadersInclude/"+S+".fx";return void a.loadFile(z,(z=>{v.includesShadersStore[S]=z,X(N.join(""),v,D)}))}{let D=v.includesShadersStore[S];if(B[2]){const S=B[3].split(",");for(let v=0;v<S.length;v+=2){const z=new RegExp(S[v],"g"),e=S[v+1];D=D.replace(z,e)}}if(B[4]){const S=B[5];if(-1!==S.indexOf("..")){const z=S.split(".."),e=parseInt(z[0]);let N=parseInt(z[1]),m=D.slice(0);D="",isNaN(N)&&(N=v.indexParameters[z[1]]);for(let S=e;S<N;S++)v.supportsUniformBuffers||(m=m.replace(q,((S,v)=>v+"{X}"))),D+=m.replace(u,S.toString())+"\n"}else v.supportsUniformBuffers||(D=D.replace(q,((S,v)=>v+"{X}"))),D=D.replace(u,S)}const z=[];for(const S of N){const v=S.split(B[0]);for(let S=0;S<v.length-1;S++)z.push(v[S]),z.push(D);z.push(v[v.length-1])}N=z,m=m||D.indexOf("#include<")>=0||D.indexOf("#include <")>=0}}s.length=0,e=N.join(""),m?X(e.toString(),v,D):D(e)}const a={loadFile:(S,v,D,z,e,N)=>{throw(0,w.e)("FileTools")}}},11254:(S,v,D)=>{D.d(v,{e:()=>e,f:()=>N,j:()=>B,m:()=>m,o:()=>g});var z=D(11207);D(11182);const e={};function N(S,v){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(v?v+"\n":"")+S}function m(S,v,D,N,m,B,g){const E=g||e.loadFile;if(E){return E(S,v,D,N,m,B)}throw(0,z.e)("FileTools")}function B(S,v,D,z){if(S)return v?S.IS_NDC_HALF_ZRANGE="":delete S.IS_NDC_HALF_ZRANGE,D?S.USE_REVERSE_DEPTHBUFFER="":delete S.USE_REVERSE_DEPTHBUFFER,void(z?S.USE_EXACT_SRGB_CONVERSIONS="":delete S.USE_EXACT_SRGB_CONVERSIONS);{let S="";return v&&(S+="#define IS_NDC_HALF_ZRANGE"),D&&(S&&(S+="\n"),S+="#define USE_REVERSE_DEPTHBUFFER"),z&&(S&&(S+="\n"),S+="#define USE_EXACT_SRGB_CONVERSIONS"),S}}function g(S,v){let D=arguments.length>2&&void 0!==arguments[2]&&arguments[2],z=arguments.length>3?arguments[3]:void 0;switch(S){case 3:{const S=(ArrayBuffer,new Int8Array(v));return z&&S.set(new Int8Array(z)),S}case 0:{const S=(ArrayBuffer,new Uint8Array(v));return z&&S.set(new Uint8Array(z)),S}case 4:{const S=v instanceof ArrayBuffer?new Int16Array(v):new Int16Array(D?v/2:v);return z&&S.set(new Int16Array(z)),S}case 5:case 8:case 9:case 10:case 2:{const S=v instanceof ArrayBuffer?new Uint16Array(v):new Uint16Array(D?v/2:v);return z&&S.set(new Uint16Array(z)),S}case 6:{const S=v instanceof ArrayBuffer?new Int32Array(v):new Int32Array(D?v/4:v);return z&&S.set(new Int32Array(z)),S}case 7:case 11:case 12:case 13:case 14:case 15:{const S=v instanceof ArrayBuffer?new Uint32Array(v):new Uint32Array(D?v/4:v);return z&&S.set(new Uint32Array(z)),S}case 1:{const S=v instanceof ArrayBuffer?new Float32Array(v):new Float32Array(D?v/4:v);return z&&S.set(new Float32Array(z)),S}}const e=(ArrayBuffer,new Uint8Array(v));return z&&e.set(new Uint8Array(z)),e}},11280:(S,v,D)=>{D.d(v,{b:()=>z});class z{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.ShadersRepository:z.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.ShadersStore:z.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?z.IncludesShadersStore:z.IncludesShadersStoreWGSL}}z.ShadersRepository="src/Shaders/",z.ShadersStore={},z.IncludesShadersStore={},z.ShadersRepositoryWGSL="src/ShadersWGSL/",z.ShadersStoreWGSL={},z.IncludesShadersStoreWGSL={}},11291:(S,v,D)=>{D.d(v,{c:()=>w,f:()=>u,h:()=>R,k:()=>n,o:()=>O,s:()=>q,u:()=>A,v:()=>E,y:()=>h,B:()=>g,F:()=>B});class z{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.nv._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(S){S&&this.program&&S(this.program)}setEngine(S){this.nv=S}_fillEffectInformation(S,v,D,z,e,N,m,B){const g=this.nv;if(g.supportsUniformBuffers)for(const h in v)S.bindUniformBlock(h,v[h]);let E;for(this.nv.getUniforms(this,D).forEach(((S,v)=>{z[D[v]]=S})),this._uniforms=z,E=0;E<e.length;E++){null==S.getUniform(e[E])&&(e.splice(E,1),E--)}e.forEach(((S,v)=>{N[S]=v}));for(const h of g.getAttributes(this,m))B.push(h)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(S,v){const D=this._valueCache[S],z=v.updateFlag;return(void 0===D||D!==z)&&(this._valueCache[S]=z,!0)}_cacheFloat2(S,v,D){let z=this._valueCache[S];if(!z||2!==z.length)return z=[v,D],this._valueCache[S]=z,!0;let e=!1;return z[0]!==v&&(z[0]=v,e=!0),z[1]!==D&&(z[1]=D,e=!0),e}_cacheFloat3(S,v,D,z){let e=this._valueCache[S];if(!e||3!==e.length)return e=[v,D,z],this._valueCache[S]=e,!0;let N=!1;return e[0]!==v&&(e[0]=v,N=!0),e[1]!==D&&(e[1]=D,N=!0),e[2]!==z&&(e[2]=z,N=!0),N}_cacheFloat4(S,v,D,z,e){let N=this._valueCache[S];if(!N||4!==N.length)return N=[v,D,z,e],this._valueCache[S]=N,!0;let m=!1;return N[0]!==v&&(N[0]=v,m=!0),N[1]!==D&&(N[1]=D,m=!0),N[2]!==z&&(N[2]=z,m=!0),N[3]!==e&&(N[3]=e,m=!0),m}setInt(S,v){const D=this._valueCache[S];void 0!==D&&D===v||this.nv.setInt(this._uniforms[S],v)&&(this._valueCache[S]=v)}setInt2(S,v,D){this._cacheFloat2(S,v,D)&&(this.nv.setInt2(this._uniforms[S],v,D)||(this._valueCache[S]=null))}setInt3(S,v,D,z){this._cacheFloat3(S,v,D,z)&&(this.nv.setInt3(this._uniforms[S],v,D,z)||(this._valueCache[S]=null))}setInt4(S,v,D,z,e){this._cacheFloat4(S,v,D,z,e)&&(this.nv.setInt4(this._uniforms[S],v,D,z,e)||(this._valueCache[S]=null))}setIntArray(S,v){this._valueCache[S]=null,this.nv.setIntArray(this._uniforms[S],v)}setIntArray2(S,v){this._valueCache[S]=null,this.nv.setIntArray2(this._uniforms[S],v)}setIntArray3(S,v){this._valueCache[S]=null,this.nv.setIntArray3(this._uniforms[S],v)}setIntArray4(S,v){this._valueCache[S]=null,this.nv.setIntArray4(this._uniforms[S],v)}setUInt(S,v){const D=this._valueCache[S];void 0!==D&&D===v||this.nv.setUInt(this._uniforms[S],v)&&(this._valueCache[S]=v)}setUInt2(S,v,D){this._cacheFloat2(S,v,D)&&(this.nv.setUInt2(this._uniforms[S],v,D)||(this._valueCache[S]=null))}setUInt3(S,v,D,z){this._cacheFloat3(S,v,D,z)&&(this.nv.setUInt3(this._uniforms[S],v,D,z)||(this._valueCache[S]=null))}setUInt4(S,v,D,z,e){this._cacheFloat4(S,v,D,z,e)&&(this.nv.setUInt4(this._uniforms[S],v,D,z,e)||(this._valueCache[S]=null))}setUIntArray(S,v){this._valueCache[S]=null,this.nv.setUIntArray(this._uniforms[S],v)}setUIntArray2(S,v){this._valueCache[S]=null,this.nv.setUIntArray2(this._uniforms[S],v)}setUIntArray3(S,v){this._valueCache[S]=null,this.nv.setUIntArray3(this._uniforms[S],v)}setUIntArray4(S,v){this._valueCache[S]=null,this.nv.setUIntArray4(this._uniforms[S],v)}setArray(S,v){this._valueCache[S]=null,this.nv.setArray(this._uniforms[S],v)}setArray2(S,v){this._valueCache[S]=null,this.nv.setArray2(this._uniforms[S],v)}setArray3(S,v){this._valueCache[S]=null,this.nv.setArray3(this._uniforms[S],v)}setArray4(S,v){this._valueCache[S]=null,this.nv.setArray4(this._uniforms[S],v)}setMatrices(S,v){v&&(this._valueCache[S]=null,this.nv.setMatrices(this._uniforms[S],v))}setMatrix(S,v){this._cacheMatrix(S,v)&&(this.nv.setMatrices(this._uniforms[S],v.Oe())||(this._valueCache[S]=null))}setMatrix3x3(S,v){this._valueCache[S]=null,this.nv.setMatrix3x3(this._uniforms[S],v)}setMatrix2x2(S,v){this._valueCache[S]=null,this.nv.setMatrix2x2(this._uniforms[S],v)}setFloat(S,v){const D=this._valueCache[S];void 0!==D&&D===v||this.nv.setFloat(this._uniforms[S],v)&&(this._valueCache[S]=v)}setVector2(S,v){this._cacheFloat2(S,v.x,v.y)&&(this.nv.setFloat2(this._uniforms[S],v.x,v.y)||(this._valueCache[S]=null))}setFloat2(S,v,D){this._cacheFloat2(S,v,D)&&(this.nv.setFloat2(this._uniforms[S],v,D)||(this._valueCache[S]=null))}setVector3(S,v){this._cacheFloat3(S,v.x,v.y,v.z)&&(this.nv.setFloat3(this._uniforms[S],v.x,v.y,v.z)||(this._valueCache[S]=null))}setFloat3(S,v,D,z){this._cacheFloat3(S,v,D,z)&&(this.nv.setFloat3(this._uniforms[S],v,D,z)||(this._valueCache[S]=null))}setVector4(S,v){this._cacheFloat4(S,v.x,v.y,v.z,v.w)&&(this.nv.setFloat4(this._uniforms[S],v.x,v.y,v.z,v.w)||(this._valueCache[S]=null))}setQuaternion(S,v){this._cacheFloat4(S,v.x,v.y,v.z,v.w)&&(this.nv.setFloat4(this._uniforms[S],v.x,v.y,v.z,v.w)||(this._valueCache[S]=null))}setFloat4(S,v,D,z,e){this._cacheFloat4(S,v,D,z,e)&&(this.nv.setFloat4(this._uniforms[S],v,D,z,e)||(this._valueCache[S]=null))}setColor3(S,v){this._cacheFloat3(S,v.r,v.g,v.b)&&(this.nv.setFloat3(this._uniforms[S],v.r,v.g,v.b)||(this._valueCache[S]=null))}setColor4(S,v,D){this._cacheFloat4(S,v.r,v.g,v.b,D)&&(this.nv.setFloat4(this._uniforms[S],v.r,v.g,v.b,D)||(this._valueCache[S]=null))}setDirectColor4(S,v){this._cacheFloat4(S,v.r,v.g,v.b,v.a)&&(this.nv.setFloat4(this._uniforms[S],v.r,v.g,v.b,v.a)||(this._valueCache[S]=null))}_getVertexShaderCode(){return this.vertexShader?this.nv._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.nv._getShaderSource(this.fragmentShader):null}}var e=D(11254);const N=new WeakMap,m={_webGLVersion:2,cachedPipelines:{}};function B(S){let v=N.get(S);if(!v){if(!S)return m;v={_webGLVersion:S.TEXTURE_BINDING_3D?2:1,_context:S,parallelShaderCompile:S.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},N.set(S,v)}return v}function g(S){N.delete(S)}function E(S,v,D,z,e,N){const m=B(z);N||(N=m._createShaderProgramInjection??w);return N(S,K(v,"vertex",z,m._contextWasLost),K(D,"fragment",z,m._contextWasLost),z,e,m.validateShaderPrograms)}function h(S,v,D,z,e){let N=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,m=arguments.length>6?arguments[6]:void 0;const g=B(e);m||(m=g._createShaderProgramInjection??w);const E=g._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return m(S,I(v,"vertex",z,E,e,g._contextWasLost),I(D,"fragment",z,E,e,g._contextWasLost),e,N,g.validateShaderPrograms)}function A(S,v){const D=new z,e=B(S);return e.parallelShaderCompile&&!e.disableParallelShaderCompile&&(D.isParallelCompiled=!0),D.context=e._context,D}function w(S,v,D,z){let e=arguments.length>5?arguments[5]:void 0;const N=z.createProgram();if(S.program=N,!N)throw new Error("Unable to create program");return z.attachShader(N,v),z.attachShader(N,D),z.linkProgram(N),S.context=z,S.vertexShader=v,S.fragmentShader=D,S.isParallelCompiled||R(S,z,e),N}function n(S,v,D){const z=S;if(z._isDisposed)return!1;const e=B(v);return!!(e&&e.parallelShaderCompile&&e.parallelShaderCompile.COMPLETION_STATUS_KHR&&z.program&&v.getProgramParameter(z.program,e.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(R(z,v,D),!0)}function R(S,v,D){const z=S.context,e=S.vertexShader,N=S.fragmentShader,m=S.program;if(!z.getProgramParameter(m,z.LINK_STATUS)){if(!v.getShaderParameter(e,v.COMPILE_STATUS)){const D=v.getShaderInfoLog(e);if(D)throw S.vertexCompilationError=D,new Error("VERTEX SHADER "+D)}if(!v.getShaderParameter(N,v.COMPILE_STATUS)){const D=v.getShaderInfoLog(N);if(D)throw S.fragmentCompilationError=D,new Error("FRAGMENT SHADER "+D)}const D=z.getProgramInfoLog(m);if(D)throw S.programLinkError=D,new Error(D)}if(D){z.validateProgram(m);if(!z.getProgramParameter(m,z.VALIDATE_STATUS)){const v=z.getProgramInfoLog(m);if(v)throw S.programValidationError=v,new Error(v)}}z.deleteShader(e),z.deleteShader(N),S.vertexShader=void 0,S.fragmentShader=void 0,S.onCompiled&&(S.onCompiled(),S.onCompiled=void 0)}function O(S,v,D,z,e,N,m,g,A){let w=arguments.length>10?arguments[10]:void 0,n=arguments.length>11?arguments[11]:void 0,R=arguments.length>12?arguments[12]:void 0;const O=B(S.context);n||(n=O.createRawShaderProgramInjection??E),R||(R=O.createShaderProgramInjection??h);const I=S;I.program=z?n(I,v,D,I.context,A):R(I,v,D,g,I.context,A),I.program.__SPECTOR_rebuildProgram=m,w()}function I(S,v,D,z,N,m){return K((0,e.f)(S,D,z),v,N,m)}function K(S,v,D,z){const e=D.createShader("vertex"===v?D.VERTEX_SHADER:D.FRAGMENT_SHADER);if(!e){let S=D.NO_ERROR,e=D.NO_ERROR;for(;(e=D.getError())!==D.NO_ERROR;)S=e;throw new Error(`Something went wrong while creating a gl ${v} shader object. gl error=${S}, gl isContextLost=${D.isContextLost()}, _contextWasLost=${z}`)}return D.shaderSource(e,S),D.compileShader(e),e}function q(S,v){v.useProgram(S)}function u(S,v){const D=S;if(!D.isParallelCompiled)return void v(S);const z=D.onCompiled;D.onCompiled=()=>{null===z||void 0===z||z(),v(S)}}},11289:(S,v,D)=>{D.d(v,{d:()=>A,e:()=>n,i:()=>E,j:()=>h});var z=D(11182),e=D(11291),N=D(11280),m=D(11190),B=D(11251),g=D(11254);function E(S,v){return(0,e.F)(v).cachedPipelines[S]}function h(S){const v=S._name,D=S.context;if(v&&D){const S=(0,e.F)(D),z=S.cachedPipelines[v];null===z||void 0===z||z.dispose(),delete S.cachedPipelines[v]}}function A(S,v,D,e,N,m,g){let E,h;const A=(0,z.j)()?null===m||void 0===m?void 0:m.getHostDocument():null;E="string"===typeof v?v:v.vertexSource?"source:"+v.vertexSource:v.vertexElement?(null===A||void 0===A?void 0:A.getElementById(v.vertexElement))||v.vertexElement:v.vertex||v,h="string"===typeof v?v:v.fragmentSource?"source:"+v.fragmentSource:v.fragmentElement?(null===A||void 0===A?void 0:A.getElementById(v.fragmentElement))||v.fragmentElement:v.fragment||v;const n=[void 0,void 0],R=()=>{if(n[0]&&n[1]){S.isFragment=!0;const[z,E]=n;(0,B.f)(E,S,((m,E)=>{g&&(g._fragmentSourceCodeBeforeMigration=E),D&&(m=D("fragment",m));const h=(0,B.b)(z,m,S);S=null;const A=function(S,v,D,z){if(D){return{vertexSourceCode:(1===z?"//":"")+"#define SHADER_NAME vertex:"+(D.vertexElement||D.vertex||D.spectorName||D)+"\n"+S,fragmentSourceCode:(1===z?"//":"")+"#define SHADER_NAME fragment:"+(D.fragmentElement||D.fragment||D.spectorName||D)+"\n"+v}}return{vertexSourceCode:S,fragmentSourceCode:v}}(h.vertexCode,h.fragmentCode,v,N);null===e||void 0===e||e(A.vertexSourceCode,A.fragmentSourceCode)}),m)}};w(E,"Vertex","",(v=>{(0,B.c)(S),(0,B.f)(v,S,((S,z)=>{g&&(g._rawVertexSourceCode=v,g._vertexSourceCodeBeforeMigration=z),D&&(S=D("vertex",S)),n[0]=S,R()}),m)}),N),w(h,"Fragment","Pixel",(S=>{g&&(g._rawFragmentSourceCode=S),n[1]=S,R()}),N)}function w(S,v,D,e,m,B){if("undefined"!==typeof HTMLElement&&S instanceof HTMLElement){return void e((0,z.b)(S))}if("source:"===S.substring(0,7))return void e(S.substring(7));if("base64:"===S.substring(0,7)){return void e(window.atob(S.substring(7)))}const E=N.b.GetShadersStore(m);if(E[S+v+"Shader"])return void e(E[S+v+"Shader"]);if(D&&E[S+D+"Shader"])return void e(E[S+D+"Shader"]);let h;if(h="."===S[0]||"/"===S[0]||S.indexOf("http")>-1?S:N.b.GetShadersRepository(m)+S,!(B=B||g.m))throw new Error("loadFileInjection is not defined");B(h+"."+v.toLowerCase()+".fx",e)}const n=(S,v,D,z)=>{try{const N=S.context?(0,e.F)(S.context):null;N&&(N.disableParallelShaderCompile=S.disableParallelCompilation);const m=S.existingPipelineContext||v(S.shaderProcessingContext);return m._name=S.name,S.name&&N&&(N.cachedPipelines[S.name]=m),D(m,S.vertex,S.fragment,!!S.createAsRaw,"","",S.rebuildRebind,S.defines,S.transformFeedbackVaryings,"",(()=>{z(m,(()=>{var v;null===(v=S.onRenderingStateCompiled)||void 0===v||v.call(S,m)}))})),m}catch(N){throw m.b.Error("Error compiling effect"),N}}},11277:(S,v,D)=>{D.r(v),D.d(v,{Effect:()=>g});var z=D(11179),e=D(11190),N=D(11280),m=D(11289),B=D(11262);class g{static get ShadersRepository(){return N.b.ShadersRepository}static set ShadersRepository(S){N.b.ShadersRepository=S}get h(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new z.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(S,v,D){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,N=arguments.length>4?arguments[4]:void 0,B=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,E=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,A=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,w=arguments.length>9?arguments[9]:void 0,n=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",R=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,O=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new z.d,this.onErrorObservable=new z.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=S,this._key=n;const I=this._key.replace(/\r/g,"").replace(/\n/g,"|");let K;if(v.attributes){const S=v;if(this._engine=D,this._attributesNames=S.attributes,this._uniformsNames=S.uniformsNames.concat(S.samplers),this._samplerList=S.samplers.slice(),this.defines=S.defines,this.onError=S.onError,this.onCompiled=S.onCompiled,this._fallbacks=S.fallbacks,this._indexParameters=S.indexParameters,this._transformFeedbackVaryings=S.transformFeedbackVaryings||null,this._multiTarget=!!S.multiTarget,this._shaderLanguage=S.shaderLanguage??0,this._disableParallelShaderCompilation=!!S.disableParallelShaderCompilation,S.uniformBuffersNames){this._uniformBuffersNamesList=S.uniformBuffersNames.slice();for(let v=0;v<S.uniformBuffersNames.length;v++)this._uniformBuffersNames[S.uniformBuffersNames[v]]=v}this._processFinalCode=S.processFinalCode??null,this._processCodeAfterIncludes=S.processCodeAfterIncludes??void 0,O=S.extraInitializationsAsync,K=S.existingPipelineContext}else this._engine=N,this.defines=null==B?"":B,this._uniformsNames=D.concat(e),this._samplerList=e?e.slice():[],this._attributesNames=v,this._uniformBuffersNamesList=[],this._shaderLanguage=R,this.onError=A,this.onCompiled=h,this._indexParameters=w,this._fallbacks=E;"WEBGL2"===this._engine.shaderPlatformName&&(K=(0,m.i)(I,this._engine._gl)??K),this._attributeLocationByName={},this.uniqueId=g._UniqueIdSeed++,K?(this._pipelineContext=K,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,O),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.h||this.dispose(!0)}))}async _processShaderCodeAsync(){let S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,v=arguments.length>1&&void 0!==arguments[1]&&arguments[1],D=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,z=arguments.length>3?arguments[3]:void 0;z&&await z(),this._processingContext=D||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const e={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:S??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:N.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:N.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,m.d)(e,this.name,this._processFinalCode,((S,D)=>{this._vertexSourceCode=S,this._fragmentSourceCode=D,this._prepareEffect(v)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.h||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(S){return this._attributes[S]}getAttributeLocationByName(S){return this._attributeLocationByName[S]}getAttributesCount(){return this._attributes.length}getUniformIndex(S){return this._uniformsNames.indexOf(S)}getUniform(S){return this._uniforms[S]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((S=>{this.executeWhenCompiled(S)}))}executeWhenCompiled(S){this.isReady()?S(this):(this.onCompileObservable.add((v=>{S(v)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(S){(0,B.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(v=>{this._processCompilationErrors(v,S)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var S;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(S=this._pipelineContext)||void 0===S?void 0:S._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var S;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(S=this._pipelineContext)||void 0===S?void 0:S._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(S,v,D,z){this._isReady=!1,this._vertexSourceCodeOverride=S,this._fragmentSourceCodeOverride=v,this.onError=(S,v)=>{z&&z(v)},this.onCompiled=()=>{var S,v;const z=this.getEngine().scenes;if(z)for(let D=0;D<z.length;D++)z[D].markAllMaterialsAsDirty(127);null===(S=(v=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===S||S.call(v,D)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(S){if(this._pipelineContext=S,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let v=0;v<this._attributesNames.length;v++){const S=this._attributesNames[v];this._attributeLocationByName[S]=this._attributes[v]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),g.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let S=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const v=this._pipelineContext;this._isReady=!1;try{const D=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),z=D?null:this.defines,e=D?this._vertexSourceCodeOverride:this._vertexSourceCode,N=D?this._fragmentSourceCodeOverride:this._fragmentSourceCode,B=this._engine;this._pipelineContext=(0,m.e)({existingPipelineContext:S?v:null,vertex:e,fragment:N,context:"WEBGL2"===B.shaderPlatformName||"WEBGL1"===B.shaderPlatformName?B._gl:void 0,rebuildRebind:(S,v,D,z)=>this._rebuildProgram(S,v,D,z),defines:z,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:D,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:D=>{v&&!S&&this._engine._deletePipelineContext(v),D&&this._onRenderingStateCompiled(D)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(v)}catch(D){this._processCompilationErrors(D,v)}}_getShaderCodeAndErrorLine(S,v,D){const z=D?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let e=null;if(v&&S){const N=v.match(z);if(N&&2===N.length){const v=parseInt(N[1]),z=S.split("\n",-1);z.length>=v&&(e=`Offending line [${v}] in ${D?"fragment":"vertex"} code: ${z[v-1]}`)}}return[S,e]}_processCompilationErrors(S){let v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=S.message;const D=this._attributesNames,z=this._fallbacks;if(e.b.Error("Unable to compile effect:"),e.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),e.b.Error(`Attributes: ${D.join(" ")}`),e.b.Error("Defines:\n"+this.defines),g.LogShaderCodeOnCompilationError){var N,m;let S=null,v=null,D=null;var B;if(null!==(N=this._pipelineContext)&&void 0!==N&&N._getVertexShaderCode()&&([D,S]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),D&&(e.b.Error("Vertex code:"),e.b.Error(D))),null!==(m=this._pipelineContext)&&void 0!==m&&m._getFragmentShaderCode())[D,v]=this._getShaderCodeAndErrorLine(null===(B=this._pipelineContext)||void 0===B?void 0:B._getFragmentShaderCode(),this._compilationError,!0),D&&(e.b.Error("Fragment code:"),e.b.Error(D));S&&e.b.Error(S),v&&e.b.Error(v)}e.b.Error("Error: "+this._compilationError);const E=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};v&&(this._pipelineContext=v,this._isReady=!0,E()),z?(this._pipelineContext=null,z.hasMoreFallbacks?(this._allFallbacksProcessed=!1,e.b.Error("Trying next fallback."),this.defines=z.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,E(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,v||E())}get isSupported(){return""===this._compilationError}_bindTexture(S,v){this._engine._bindTexture(this._samplers[S],v,S)}setTexture(S,v){this._engine.setTexture(this._samplers[S],this._uniforms[S],v,S)}setTextureArray(S,v){const D=S+"Ex";if(-1===this._samplerList.indexOf(D+"0")){const z=this._samplerList.indexOf(S);for(let S=1;S<v.length;S++){const v=D+(S-1).toString();this._samplerList.splice(z+S,0,v)}let e=0;for(const S of this._samplerList)this._samplers[S]=e,e+=1}this._engine.setTextureArray(this._samplers[S],this._uniforms[S],v,S)}bindUniformBuffer(S,v){const D=this._uniformBuffersNames[v];void 0===D||g._BaseCache[D]===S&&this._engine._features.useUBOBindingCache||(g._BaseCache[D]=S,this._engine.bindUniformBufferBase(S,D,v))}bindUniformBlock(S,v){this._engine.bindUniformBlock(this._pipelineContext,S,v)}setInt(S,v){return this._pipelineContext.setInt(S,v),this}setInt2(S,v,D){return this._pipelineContext.setInt2(S,v,D),this}setInt3(S,v,D,z){return this._pipelineContext.setInt3(S,v,D,z),this}setInt4(S,v,D,z,e){return this._pipelineContext.setInt4(S,v,D,z,e),this}setIntArray(S,v){return this._pipelineContext.setIntArray(S,v),this}setIntArray2(S,v){return this._pipelineContext.setIntArray2(S,v),this}setIntArray3(S,v){return this._pipelineContext.setIntArray3(S,v),this}setIntArray4(S,v){return this._pipelineContext.setIntArray4(S,v),this}setUInt(S,v){return this._pipelineContext.setUInt(S,v),this}setUInt2(S,v,D){return this._pipelineContext.setUInt2(S,v,D),this}setUInt3(S,v,D,z){return this._pipelineContext.setUInt3(S,v,D,z),this}setUInt4(S,v,D,z,e){return this._pipelineContext.setUInt4(S,v,D,z,e),this}setUIntArray(S,v){return this._pipelineContext.setUIntArray(S,v),this}setUIntArray2(S,v){return this._pipelineContext.setUIntArray2(S,v),this}setUIntArray3(S,v){return this._pipelineContext.setUIntArray3(S,v),this}setUIntArray4(S,v){return this._pipelineContext.setUIntArray4(S,v),this}setFloatArray(S,v){return this._pipelineContext.setArray(S,v),this}setFloatArray2(S,v){return this._pipelineContext.setArray2(S,v),this}setFloatArray3(S,v){return this._pipelineContext.setArray3(S,v),this}setFloatArray4(S,v){return this._pipelineContext.setArray4(S,v),this}setArray(S,v){return this._pipelineContext.setArray(S,v),this}setArray2(S,v){return this._pipelineContext.setArray2(S,v),this}setArray3(S,v){return this._pipelineContext.setArray3(S,v),this}setArray4(S,v){return this._pipelineContext.setArray4(S,v),this}setMatrices(S,v){return this._pipelineContext.setMatrices(S,v),this}setMatrix(S,v){return this._pipelineContext.setMatrix(S,v),this}setMatrix3x3(S,v){return this._pipelineContext.setMatrix3x3(S,v),this}setMatrix2x2(S,v){return this._pipelineContext.setMatrix2x2(S,v),this}setFloat(S,v){return this._pipelineContext.setFloat(S,v),this}setBool(S,v){return this._pipelineContext.setInt(S,v?1:0),this}setVector2(S,v){return this._pipelineContext.setVector2(S,v),this}setFloat2(S,v,D){return this._pipelineContext.setFloat2(S,v,D),this}setVector3(S,v){return this._pipelineContext.setVector3(S,v),this}setFloat3(S,v,D,z){return this._pipelineContext.setFloat3(S,v,D,z),this}setVector4(S,v){return this._pipelineContext.setVector4(S,v),this}setQuaternion(S,v){return this._pipelineContext.setQuaternion(S,v),this}setFloat4(S,v,D,z,e){return this._pipelineContext.setFloat4(S,v,D,z,e),this}setColor3(S,v){return this._pipelineContext.setColor3(S,v),this}setColor4(S,v,D){return this._pipelineContext.setColor4(S,v,D),this}setDirectColor4(S,v){return this._pipelineContext.setDirectColor4(S,v),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(g.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,m.j)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(S,v,D){let z=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;v&&(N.b.GetShadersStore(z)[`${S}PixelShader`]=v),D&&(N.b.GetShadersStore(z)[`${S}VertexShader`]=D)}static ResetCache(){g._BaseCache={}}}g.LogShaderCodeOnCompilationError=!0,g.PersistentMode=!1,g.AutomaticallyClearCodeCache=!1,g._UniqueIdSeed=0,g._BaseCache={},g.ShadersStore=N.b.ShadersStore,g.IncludesShadersStore=N.b.IncludesShadersStore},11207:(S,v,D)=>{D.d(v,{e:()=>e});const z={};function e(S){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!z[S])return z[S]=!0,`${S} needs to be imported before as it contains a side-effect required by your code.`}},11182:(S,v,D)=>{function z(){return"undefined"!==typeof window}function e(){return"undefined"!==typeof navigator}function N(){return"undefined"!==typeof document}function m(S){let v="",D=S.firstChild;for(;D;)3===D.nodeType&&(v+=D.textContent),D=D.nextSibling;return v}D.d(v,{b:()=>m,e:()=>N,i:()=>e,j:()=>z})},11190:(S,v,D)=>{D.d(v,{b:()=>z});class z{static _CheckLimit(S,v){let D=z._LogLimitOutputs[S];return D?D.current++:(D={limit:v,current:1},z._LogLimitOutputs[S]=D),D.current<=D.limit}static _GenerateLimitMessage(S){let v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const D=z._LogLimitOutputs[S];if(!D||!z.MessageLimitReached)return;const e=this._Levels[v];D.current===D.limit&&z[e.name](z.MessageLimitReached.replace(/%LIMIT%/g,""+D.limit).replace(/%TYPE%/g,e.name??""))}static _AddLogEntry(S){z._LogCache=S+z._LogCache,z.OnNewCacheEntry&&z.OnNewCacheEntry(S)}static _FormatMessage(S){const v=S=>S<10?"0"+S:""+S,D=new Date;return"["+v(D.getHours())+":"+v(D.getMinutes())+":"+v(D.getSeconds())+"]: "+S}static _LogDisabled(S,v){}static _LogEnabled(){let S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,v=arguments.length>1?arguments[1]:void 0,D=arguments.length>2?arguments[2]:void 0;const e=Array.isArray(v)?v[0]:v;if(void 0!==D&&!z._CheckLimit(e,D))return;const N=z._FormatMessage(e),m=this._Levels[S],B=Array.isArray(v)?v.slice(1):[];m.logFunc&&m.logFunc("BJS - "+N,...B);const g=`<div style='color:${m.color}'>${N}</div><br>`;z._AddLogEntry(g),z._GenerateLimitMessage(e,S)}static get LogCache(){return z._LogCache}static ClearLogCache(){z._LogCache="",z._LogLimitOutputs={},z.errorsCount=0}static set LogLevels(S){z.Log=z._LogDisabled,z.Warn=z._LogDisabled,z.Error=z._LogDisabled;const v=[z.MessageLogLevel,z.WarningLogLevel,z.ErrorLogLevel];for(const D of v)if((S&D)===D){const S=this._Levels[D];z[S.name]=z._LogEnabled.bind(z,D)}}}z.NoneLogLevel=0,z.MessageLogLevel=1,z.WarningLogLevel=2,z.ErrorLogLevel=4,z.AllLogLevel=7,z.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",z._LogCache="",z._LogLimitOutputs={},z._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],z.errorsCount=0,z.Log=z._LogEnabled.bind(z,z.MessageLogLevel),z.Warn=z._LogEnabled.bind(z,z.WarningLogLevel),z.Error=z._LogEnabled.bind(z,z.ErrorLogLevel)},11179:(S,v,D)=>{D.d(v,{d:()=>m});const z="undefined"!==typeof WeakRef;class e{constructor(S){let v=arguments.length>1&&void 0!==arguments[1]&&arguments[1],D=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0;this.initialize(S,v,D,z)}initialize(S){let v=arguments.length>1&&void 0!==arguments[1]&&arguments[1],D=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0;return this.mask=S,this.skipNextObservers=v,this.target=D,this.currentTarget=z,this}}class N{constructor(S,v){let D=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=S,this.mask=v,this.scope=D,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let S=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(S)}}class m{static FromPromise(S,v){const D=new m;return S.then((S=>{D.notifyObservers(S)})).catch((S=>{if(!v)throw S;v.notifyObservers(S)})),D}get observers(){return this._observers}constructor(S){let v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=v,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new e(0),S&&(this._onObserverAdded=S)}add(S){let v=arguments.length>2&&void 0!==arguments[2]&&arguments[2],D=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!S)return null;const e=new N(S,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);e.unregisterOnNextCall=D,v?this._observers.unshift(e):this._observers.push(e),this._onObserverAdded&&this._onObserverAdded(e),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(e,this._lastNotifiedValue);const m=z?new WeakRef(this):{deref:()=>this};return e._remove=function(){let S=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const v=m.deref();v&&(S?v.remove(e):v._remove(e))},e}addOnce(S){return this.add(S,void 0,void 0,void 0,!0)}remove(S){if(!S)return!1;S._remove=null;return-1!==this._observers.indexOf(S)&&(this._deferUnregister(S),!0)}removeCallback(S,v){for(let D=0;D<this._observers.length;D++){const z=this._observers[D];if(!z._willBeUnregistered&&(z.callback===S&&(!v||v===z.scope)))return this._deferUnregister(z),!0}return!1}_deferUnregister(S){S._willBeUnregistered||(this._numObserversMarkedAsDeleted++,S.unregisterOnNextCall=!1,S._willBeUnregistered=!0,setTimeout((()=>{this._remove(S)}),0))}_remove(S){let v=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!S)return!1;const D=this._observers.indexOf(S);return-1!==D&&(v&&this._numObserversMarkedAsDeleted--,this._observers.splice(D,1),!0)}makeObserverTopPriority(S){this._remove(S,!1),this._observers.unshift(S)}makeObserverBottomPriority(S){this._remove(S,!1),this._observers.push(S)}notifyObservers(S){let v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,D=arguments.length>2?arguments[2]:void 0,z=arguments.length>3?arguments[3]:void 0,e=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=S),!this._observers.length)return!0;const N=this._eventState;N.mask=v,N.target=D,N.currentTarget=z,N.skipNextObservers=!1,N.lastReturnValue=S,N.userInfo=e;for(const m of this._observers)if(!m._willBeUnregistered&&(m.mask&v&&(m.unregisterOnNextCall&&this._deferUnregister(m),m.scope?N.lastReturnValue=m.callback.apply(m.scope,[S,N]):N.lastReturnValue=m.callback(S,N)),N.skipNextObservers))return!1;return!0}notifyObserver(S,v){let D=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=v),S._willBeUnregistered)return;const z=this._eventState;z.mask=D,z.skipNextObservers=!1,S.unregisterOnNextCall&&this._deferUnregister(S),S.callback(v,z)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const S=this._observers.pop();S&&(S._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const S=new m;return S._observers=this._observers.slice(0),S}hasSpecificMask(){let S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const v of this._observers)if(v.mask&S||v.mask===S)return!0;return!1}}},11262:(S,v,D)=>{D.d(v,{b:()=>e,e:()=>m});let z=[];class e{static SetImmediate(S){0===z.length&&setTimeout((()=>{const S=z;z=[];for(const v of S)v()}),1),z.push(S)}}function N(S,v,D){try{if(S())return v(),!0}catch(z){return null===D||void 0===D||D(z),!0}return!1}const m=function(S,v,D){let z=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,m=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&N(S,v,D))return null;const B=setInterval((()=>{N(S,v,D)?clearInterval(B):(e-=z,e<0&&(clearInterval(B),null===D||void 0===D||D(new Error("Operation timed out after maximum retries. "+(m||"")),!0)))}),z);return()=>clearInterval(B)}}}]);