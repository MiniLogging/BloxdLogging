"use strict";(self["3gghkoft8x"]=self["3gghkoft8x"]||[]).push([[9],{12203:(y,S,I)=>{I.d(S,{e:()=>o,h:()=>C,m:()=>D,k:()=>P,p:()=>q});class V{constructor(){this.children=[]}isValid(y){return!0}process(y,S,I){let V="";if(this.line){let I=this.line;const u=S.processor;if(u){var i,A,B,d,F,J;u.lineProcessor&&(I=u.lineProcessor(I,S.isFragment,S.processingContext));const V=(null===(i=S.processor)||void 0===i?void 0:i.attributeKeywordName)??"attribute",K=S.isFragment&&null!==(A=S.processor)&&void 0!==A&&A.varyingFragmentKeywordName?null===(B=S.processor)||void 0===B?void 0:B.varyingFragmentKeywordName:!S.isFragment&&null!==(d=S.processor)&&void 0!==d&&d.varyingVertexKeywordName?null===(F=S.processor)||void 0===F?void 0:F.varyingVertexKeywordName:"varying";if(!S.isFragment&&u.attributeProcessor&&this.line.startsWith(V))I=u.attributeProcessor(this.line,y,S.processingContext);else if(u.varyingProcessor&&(null!==(J=u.varyingCheck)&&void 0!==J&&J.call(u,this.line,S.isFragment)||!u.varyingCheck&&this.line.startsWith(K)))I=u.varyingProcessor(this.line,S.isFragment,y,S.processingContext);else if(u.uniformProcessor&&u.uniformRegexp&&u.uniformRegexp.test(this.line))S.lookForClosingBracketForUniformBuffer||(I=u.uniformProcessor(this.line,S.isFragment,y,S.processingContext));else if(u.uniformBufferProcessor&&u.uniformBufferRegexp&&u.uniformBufferRegexp.test(this.line))S.lookForClosingBracketForUniformBuffer||(I=u.uniformBufferProcessor(this.line,S.isFragment,S.processingContext),S.lookForClosingBracketForUniformBuffer=!0);else if(u.textureProcessor&&u.textureRegexp&&u.textureRegexp.test(this.line))I=u.textureProcessor(this.line,S.isFragment,y,S.processingContext);else if((u.uniformProcessor||u.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!S.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?u.uniformProcessor&&(I=u.uniformProcessor(this.line,S.isFragment,y,S.processingContext)):u.uniformBufferProcessor&&(I=u.uniformBufferProcessor(this.line,S.isFragment,S.processingContext),S.lookForClosingBracketForUniformBuffer=!0)}S.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(S.lookForClosingBracketForUniformBuffer=!1,u.endOfUniformBufferProcessor&&(I=u.endOfUniformBufferProcessor(this.line,S.isFragment,S.processingContext)))}V+=I+"\n"}for(const u of this.children)V+=u.process(y,S,I);return this.additionalDefineKey&&(y[this.additionalDefineKey]=this.additionalDefineValue||"true",I[this.additionalDefineKey]=y[this.additionalDefineKey]),V}}class i{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(y){this._lines.length=0;for(const S of y){if(!S||"\r"===S)continue;if("#"===S[0]){this._lines.push(S);continue}const y=S.trim();if(!y)continue;if(y.startsWith("//")){this._lines.push(S);continue}const I=y.indexOf(";");if(-1===I)this._lines.push(y);else if(I===y.length-1)y.length>1&&this._lines.push(y);else{const y=S.split(";");for(let S=0;S<y.length;S++){let I=y[S];I&&(I=I.trim(),I&&this._lines.push(I+(S!==y.length-1?";":"")))}}}}}class A extends V{process(y,S,I){for(let V=0;V<this.children.length;V++){const i=this.children[V];if(i.isValid(y))return i.process(y,S,I)}return""}}class B extends V{isValid(y){return this.testExpression.isTrue(y)}}class d{isTrue(y){return!0}static postfixToInfix(y){const S=[];for(const I of y)if(void 0===d._OperatorPriority[I])S.push(I);else{const y=S[S.length-1],V=S[S.length-2];S.length-=2,S.push(`(${V}${I}${y})`)}return S[S.length-1]}static infixToPostfix(y){const S=d._InfixToPostfixCache.get(y);if(S)return S.accessTime=Date.now(),S.result;if(!y.includes("&&")&&!y.includes("||")&&!y.includes(")")&&!y.includes("("))return[y];const I=[];let V=-1;const i=()=>{u=u.trim(),""!==u&&(I.push(u),u="")},A=y=>{V<d._Stack.length-1&&(d._Stack[++V]=y)},B=()=>d._Stack[V],F=()=>-1===V?"!!INVALID EXPRESSION!!":d._Stack[V--];let J=0,u="";for(;J<y.length;){const S=y.charAt(J),K=J<y.length-1?y.substring(J,2+J):"";if("("===S)u="",A(S);else if(")"===S){for(i();-1!==V&&"("!==B();)I.push(F());F()}else if(d._OperatorPriority[K]>1){for(i();-1!==V&&d._OperatorPriority[B()]>=d._OperatorPriority[K];)I.push(F());A(K),J++}else u+=S;J++}for(i();-1!==V;)"("===B()?F():I.push(F());return d._InfixToPostfixCache.size>=d.InfixToPostfixCacheLimitSize&&d.ClearCache(),d._InfixToPostfixCache.set(y,{result:I,accessTime:Date.now()}),I}static ClearCache(){const y=Array.from(d._InfixToPostfixCache.entries()).sort(((y,S)=>y[1].accessTime-S[1].accessTime));for(let S=0;S<d.InfixToPostfixCacheCleanupSize;S++)d._InfixToPostfixCache.delete(y[S][0])}}d.InfixToPostfixCacheLimitSize=5e4,d.InfixToPostfixCacheCleanupSize=25e3,d._InfixToPostfixCache=new Map,d._OperatorPriority={")":0,"(":1,"||":2,"&&":3},d._Stack=["","","","","","","","","","","","","","","","","","","",""];class F extends d{constructor(y){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=y,this.not=S}isTrue(y){let S=void 0!==y[this.define];return this.not&&(S=!S),S}}class J extends d{isTrue(y){return this.leftOperand.isTrue(y)||this.rightOperand.isTrue(y)}}class u extends d{isTrue(y){return this.leftOperand.isTrue(y)&&this.rightOperand.isTrue(y)}}class K extends d{constructor(y,S,I){super(),this.define=y,this.operand=S,this.testValue=I}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(y){let S=!1;const I=parseInt(void 0!=y[this.define]?y[this.define]:this.define),V=parseInt(void 0!=y[this.testValue]?y[this.testValue]:this.testValue);if(isNaN(I)||isNaN(V))return!1;switch(this.operand){case">":S=I>V;break;case"<":S=I<V;break;case"<=":S=I<=V;break;case">=":S=I>=V;break;case"==":S=I===V;break;case"!=":S=I!==V}return S}}var G=I(12172),p=I(12211);const L=/defined\s*?\((.+?)\)/g,T=/defined\s*?\[(.+?)\]/g,l=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,j=/__decl__/,s=/light\{X\}.(\w*)/g,O=/\{X\}/g,f=[],my=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function C(y){y.processor&&y.processor.initializeShaders&&y.processor.initializeShaders(y.processingContext)}function D(y,S,I,V){var i;null!==(i=S.processor)&&void 0!==i&&i.preProcessShaderCode&&(y=S.processor.preProcessShaderCode(y,S.isFragment)),P(y,S,(y=>{S.processCodeAfterIncludes&&(y=S.processCodeAfterIncludes(S.isFragment?"fragment":"vertex",y,S.defines));const i=function(y,S,I){let V=function(y,S){var I;if(null!==(I=S.processor)&&void 0!==I&&I.noPrecision)return y;const V=S.shouldUseHighPrecisionShader;-1===y.indexOf("precision highp float")?y=V?"precision highp float;\n"+y:"precision mediump float;\n"+y:V||(y=y.replace("precision highp float","precision mediump float"));return y}(y,S);if(!S.processor)return V;if(0===S.processor.shaderLanguage&&-1!==V.indexOf("#version 3")&&(V=V.replace("#version 300 es",""),!S.processor.parseGLES3))return V;const i=S.defines,A=v(S,I);S.processor.preProcessor&&(V=S.processor.preProcessor(V,i,A,S.isFragment,S.processingContext));const B={};V=n(V,A,S,B),S.processor.postProcessor&&(V=S.processor.postProcessor(V,i,S.isFragment,S.processingContext,I?{drawBuffersExtensionDisabled:!I.getCaps().drawBuffersExtension}:{},A,B));null!==I&&void 0!==I&&I._features.needShaderCodeInlining&&(V=I.inlineShaderCode(V));return V}(y,S,V);I(i,y)}))}function o(y,S,I){return I.processor&&I.processor.finalizeShaders?I.processor.finalizeShaders(y,S,I.processingContext):{vertexCode:y,fragmentCode:S}}function E(y){const S=/defined\((.+)\)/.exec(y);if(S&&S.length)return new F(S[1].trim(),"!"===y[0]);const I=["==","!=",">=","<=","<",">"];let V="",i=0;for(V of I)if(i=y.indexOf(V),i>-1)break;if(-1===i)return new F(y);const A=y.substring(0,i).trim(),B=y.substring(i+V.length).trim();return new K(A,V,B)}function z(y,S){const I=new B,V=y.substring(0,S);let i=y.substring(S);return i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim(),I.testExpression="#ifdef"===V?new F(i):"#ifndef"===V?new F(i,!0):function(y){y=y.replace(L,"defined[$1]");const S=d.infixToPostfix(y),I=[];for(const i of S)if("||"!==i&&"&&"!==i)I.push(i);else if(I.length>=2){let y=I[I.length-1],S=I[I.length-2];I.length-=2;const V="&&"==i?new u:new J;"string"===typeof y&&(y=y.replace(T,"defined($1)")),"string"===typeof S&&(S=S.replace(T,"defined($1)")),V.leftOperand="string"===typeof S?E(S):S,V.rightOperand="string"===typeof y?E(y):y,I.push(V)}let V=I[I.length-1];return"string"===typeof V&&(V=V.replace(T,"defined($1)")),"string"===typeof V?E(V):V}(i),I}function r(y,S,I,i){let A=y.currentLine;for(;h(y,I,i);){A=y.currentLine;const B=A.substring(0,5).toLowerCase();if("#else"===B){const I=new V;return S.children.push(I),void h(y,I,i)}if("#elif"===B){const y=z(A,5);S.children.push(y),I=y}}}function h(y,S,I){for(;y.canRead;){y.lineIndex++;const i=y.currentLine;if(i.indexOf("#")>=0){const V=my.exec(i);if(V&&V.length){switch(V[0]){case"#ifdef":{const V=new A;S.children.push(V);const B=z(i,6);V.children.push(B),r(y,V,B,I);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const V=new A;S.children.push(V);const B=z(i,7);V.children.push(B),r(y,V,B,I);break}case"#if":{const V=new A,B=z(i,3);S.children.push(V),V.children.push(B),r(y,V,B,I);break}}continue}}const B=new V;if(B.line=i,S.children.push(B),"#"===i[0]&&"d"===i[1]){const y=i.replace(";","").split(" ");B.additionalDefineKey=y[1],3===y.length&&(B.additionalDefineValue=y[2])}}return!1}function n(y,S,I,A){const B=new V,d=new i;return d.lineIndex=-1,d.lines=y.split("\n"),h(d,B,A),B.process(S,I,A)}function v(y,S){var I;const V=y.defines,i={};for(const A of V){const y=A.replace("#define","").replace(";","").trim().split(" ");i[y[0]]=y.length>1?y[1]:""}return 0===(null===(I=y.processor)||void 0===I?void 0:I.shaderLanguage)&&(i.GL_ES="true"),i.__VERSION__=y.version,i[y.platformName]="true",(0,p.g)(i,null===S||void 0===S?void 0:S.isNDCHalfZRange,null===S||void 0===S?void 0:S.si,null===S||void 0===S?void 0:S.useExactSrgbConversions),i}function P(y,S,I){let V;for(f.length=0;null!==(V=l.exec(y));)f.push(V);let i=String(y),A=[y],B=!1;for(const d of f){let y=d[1];if(-1!==y.indexOf("__decl__")&&(y=y.replace(j,""),S.supportsUniformBuffers&&(y=y.replace("Vertex","Ubo").replace("Fragment","Ubo")),y+="Declaration"),!S.includesShadersStore[y]){const V=S.shadersRepository+"ShadersInclude/"+y+".fx";return void q.loadFile(V,(V=>{S.includesShadersStore[y]=V,P(A.join(""),S,I)}))}{let I=S.includesShadersStore[y];if(d[2]){const y=d[3].split(",");for(let S=0;S<y.length;S+=2){const V=new RegExp(y[S],"g"),i=y[S+1];I=I.replace(V,i)}}if(d[4]){const y=d[5];if(-1!==y.indexOf("..")){const V=y.split(".."),i=parseInt(V[0]);let A=parseInt(V[1]),B=I.slice(0);I="",isNaN(A)&&(A=S.indexParameters[V[1]]);for(let y=i;y<A;y++)S.supportsUniformBuffers||(B=B.replace(s,((y,S)=>S+"{X}"))),I+=B.replace(O,y.toString())+"\n"}else S.supportsUniformBuffers||(I=I.replace(s,((y,S)=>S+"{X}"))),I=I.replace(O,y)}const V=[];for(const y of A){const S=y.split(d[0]);for(let y=0;y<S.length-1;y++)V.push(S[y]),V.push(I);V.push(S[S.length-1])}A=V,B=B||I.indexOf("#include<")>=0||I.indexOf("#include <")>=0}}f.length=0,i=A.join(""),B?P(i.toString(),S,I):I(i)}const q={loadFile:(y,S,I,V,i,A)=>{throw(0,G.b)("FileTools")}}},12211:(y,S,I)=>{I.d(S,{b:()=>i,c:()=>A,g:()=>d,h:()=>B,j:()=>F});var V=I(12172);I(12142);const i={};function A(y,S){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(S?S+"\n":"")+y}function B(y,S,I,A,B,d,F){const J=F||i.loadFile;if(J){return J(y,S,I,A,B,d)}throw(0,V.b)("FileTools")}function d(y,S,I,V){if(y)return S?y.IS_NDC_HALF_ZRANGE="":delete y.IS_NDC_HALF_ZRANGE,I?y.USE_REVERSE_DEPTHBUFFER="":delete y.USE_REVERSE_DEPTHBUFFER,void(V?y.USE_EXACT_SRGB_CONVERSIONS="":delete y.USE_EXACT_SRGB_CONVERSIONS);{let y="";return S&&(y+="#define IS_NDC_HALF_ZRANGE"),I&&(y&&(y+="\n"),y+="#define USE_REVERSE_DEPTHBUFFER"),V&&(y&&(y+="\n"),y+="#define USE_EXACT_SRGB_CONVERSIONS"),y}}function F(y,S){let I=arguments.length>2&&void 0!==arguments[2]&&arguments[2],V=arguments.length>3?arguments[3]:void 0;switch(y){case 3:{const y=(ArrayBuffer,new Int8Array(S));return V&&y.set(new Int8Array(V)),y}case 0:{const y=(ArrayBuffer,new Uint8Array(S));return V&&y.set(new Uint8Array(V)),y}case 4:{const y=S instanceof ArrayBuffer?new Int16Array(S):new Int16Array(I?S/2:S);return V&&y.set(new Int16Array(V)),y}case 5:case 8:case 9:case 10:case 2:{const y=S instanceof ArrayBuffer?new Uint16Array(S):new Uint16Array(I?S/2:S);return V&&y.set(new Uint16Array(V)),y}case 6:{const y=S instanceof ArrayBuffer?new Int32Array(S):new Int32Array(I?S/4:S);return V&&y.set(new Int32Array(V)),y}case 7:case 11:case 12:case 13:case 14:case 15:{const y=S instanceof ArrayBuffer?new Uint32Array(S):new Uint32Array(I?S/4:S);return V&&y.set(new Uint32Array(V)),y}case 1:{const y=S instanceof ArrayBuffer?new Float32Array(S):new Float32Array(I?S/4:S);return V&&y.set(new Float32Array(V)),y}}const i=(ArrayBuffer,new Uint8Array(S));return V&&i.set(new Uint8Array(V)),i}},12240:(y,S,I)=>{I.d(S,{b:()=>V});class V{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?V.ShadersRepository:V.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?V.ShadersStore:V.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?V.IncludesShadersStore:V.IncludesShadersStoreWGSL}}V.ShadersRepository="src/Shaders/",V.ShadersStore={},V.IncludesShadersStore={},V.ShadersRepositoryWGSL="src/ShadersWGSL/",V.ShadersStoreWGSL={},V.IncludesShadersStoreWGSL={}},12251:(y,S,I)=>{I.d(S,{e:()=>G,i:()=>O,l:()=>L,p:()=>p,s:()=>T,t:()=>s,u:()=>K,v:()=>J,y:()=>u,A:()=>F,B:()=>d});class V{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.sS._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(y){y&&this.program&&y(this.program)}setEngine(y){this.sS=y}_fillEffectInformation(y,S,I,V,i,A,B,d){const F=this.sS;if(F.supportsUniformBuffers)for(const u in S)y.bindUniformBlock(u,S[u]);let J;for(this.sS.getUniforms(this,I).forEach(((y,S)=>{V[I[S]]=y})),this._uniforms=V,J=0;J<i.length;J++){null==y.getUniform(i[J])&&(i.splice(J,1),J--)}i.forEach(((y,S)=>{A[y]=S}));for(const u of F.getAttributes(this,B))d.push(u)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(y,S){const I=this._valueCache[y],V=S.updateFlag;return(void 0===I||I!==V)&&(this._valueCache[y]=V,!0)}_cacheFloat2(y,S,I){let V=this._valueCache[y];if(!V||2!==V.length)return V=[S,I],this._valueCache[y]=V,!0;let i=!1;return V[0]!==S&&(V[0]=S,i=!0),V[1]!==I&&(V[1]=I,i=!0),i}_cacheFloat3(y,S,I,V){let i=this._valueCache[y];if(!i||3!==i.length)return i=[S,I,V],this._valueCache[y]=i,!0;let A=!1;return i[0]!==S&&(i[0]=S,A=!0),i[1]!==I&&(i[1]=I,A=!0),i[2]!==V&&(i[2]=V,A=!0),A}_cacheFloat4(y,S,I,V,i){let A=this._valueCache[y];if(!A||4!==A.length)return A=[S,I,V,i],this._valueCache[y]=A,!0;let B=!1;return A[0]!==S&&(A[0]=S,B=!0),A[1]!==I&&(A[1]=I,B=!0),A[2]!==V&&(A[2]=V,B=!0),A[3]!==i&&(A[3]=i,B=!0),B}setInt(y,S){const I=this._valueCache[y];void 0!==I&&I===S||this.sS.setInt(this._uniforms[y],S)&&(this._valueCache[y]=S)}setInt2(y,S,I){this._cacheFloat2(y,S,I)&&(this.sS.setInt2(this._uniforms[y],S,I)||(this._valueCache[y]=null))}setInt3(y,S,I,V){this._cacheFloat3(y,S,I,V)&&(this.sS.setInt3(this._uniforms[y],S,I,V)||(this._valueCache[y]=null))}setInt4(y,S,I,V,i){this._cacheFloat4(y,S,I,V,i)&&(this.sS.setInt4(this._uniforms[y],S,I,V,i)||(this._valueCache[y]=null))}setIntArray(y,S){this._valueCache[y]=null,this.sS.setIntArray(this._uniforms[y],S)}setIntArray2(y,S){this._valueCache[y]=null,this.sS.setIntArray2(this._uniforms[y],S)}setIntArray3(y,S){this._valueCache[y]=null,this.sS.setIntArray3(this._uniforms[y],S)}setIntArray4(y,S){this._valueCache[y]=null,this.sS.setIntArray4(this._uniforms[y],S)}setUInt(y,S){const I=this._valueCache[y];void 0!==I&&I===S||this.sS.setUInt(this._uniforms[y],S)&&(this._valueCache[y]=S)}setUInt2(y,S,I){this._cacheFloat2(y,S,I)&&(this.sS.setUInt2(this._uniforms[y],S,I)||(this._valueCache[y]=null))}setUInt3(y,S,I,V){this._cacheFloat3(y,S,I,V)&&(this.sS.setUInt3(this._uniforms[y],S,I,V)||(this._valueCache[y]=null))}setUInt4(y,S,I,V,i){this._cacheFloat4(y,S,I,V,i)&&(this.sS.setUInt4(this._uniforms[y],S,I,V,i)||(this._valueCache[y]=null))}setUIntArray(y,S){this._valueCache[y]=null,this.sS.setUIntArray(this._uniforms[y],S)}setUIntArray2(y,S){this._valueCache[y]=null,this.sS.setUIntArray2(this._uniforms[y],S)}setUIntArray3(y,S){this._valueCache[y]=null,this.sS.setUIntArray3(this._uniforms[y],S)}setUIntArray4(y,S){this._valueCache[y]=null,this.sS.setUIntArray4(this._uniforms[y],S)}setArray(y,S){this._valueCache[y]=null,this.sS.setArray(this._uniforms[y],S)}setArray2(y,S){this._valueCache[y]=null,this.sS.setArray2(this._uniforms[y],S)}setArray3(y,S){this._valueCache[y]=null,this.sS.setArray3(this._uniforms[y],S)}setArray4(y,S){this._valueCache[y]=null,this.sS.setArray4(this._uniforms[y],S)}setMatrices(y,S){S&&(this._valueCache[y]=null,this.sS.setMatrices(this._uniforms[y],S))}setMatrix(y,S){this._cacheMatrix(y,S)&&(this.sS.setMatrices(this._uniforms[y],S.Vd())||(this._valueCache[y]=null))}setMatrix3x3(y,S){this._valueCache[y]=null,this.sS.setMatrix3x3(this._uniforms[y],S)}setMatrix2x2(y,S){this._valueCache[y]=null,this.sS.setMatrix2x2(this._uniforms[y],S)}setFloat(y,S){const I=this._valueCache[y];void 0!==I&&I===S||this.sS.setFloat(this._uniforms[y],S)&&(this._valueCache[y]=S)}setVector2(y,S){this._cacheFloat2(y,S.x,S.y)&&(this.sS.setFloat2(this._uniforms[y],S.x,S.y)||(this._valueCache[y]=null))}setFloat2(y,S,I){this._cacheFloat2(y,S,I)&&(this.sS.setFloat2(this._uniforms[y],S,I)||(this._valueCache[y]=null))}setVector3(y,S){this._cacheFloat3(y,S.x,S.y,S.z)&&(this.sS.setFloat3(this._uniforms[y],S.x,S.y,S.z)||(this._valueCache[y]=null))}setFloat3(y,S,I,V){this._cacheFloat3(y,S,I,V)&&(this.sS.setFloat3(this._uniforms[y],S,I,V)||(this._valueCache[y]=null))}setVector4(y,S){this._cacheFloat4(y,S.x,S.y,S.z,S.w)&&(this.sS.setFloat4(this._uniforms[y],S.x,S.y,S.z,S.w)||(this._valueCache[y]=null))}setQuaternion(y,S){this._cacheFloat4(y,S.x,S.y,S.z,S.w)&&(this.sS.setFloat4(this._uniforms[y],S.x,S.y,S.z,S.w)||(this._valueCache[y]=null))}setFloat4(y,S,I,V,i){this._cacheFloat4(y,S,I,V,i)&&(this.sS.setFloat4(this._uniforms[y],S,I,V,i)||(this._valueCache[y]=null))}setColor3(y,S){this._cacheFloat3(y,S.r,S.g,S.b)&&(this.sS.setFloat3(this._uniforms[y],S.r,S.g,S.b)||(this._valueCache[y]=null))}setColor4(y,S,I){this._cacheFloat4(y,S.r,S.g,S.b,I)&&(this.sS.setFloat4(this._uniforms[y],S.r,S.g,S.b,I)||(this._valueCache[y]=null))}setDirectColor4(y,S){this._cacheFloat4(y,S.r,S.g,S.b,S.a)&&(this.sS.setFloat4(this._uniforms[y],S.r,S.g,S.b,S.a)||(this._valueCache[y]=null))}_getVertexShaderCode(){return this.vertexShader?this.sS._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.sS._getShaderSource(this.fragmentShader):null}}var i=I(12211);const A=new WeakMap,B={_webGLVersion:2,cachedPipelines:{}};function d(y){let S=A.get(y);if(!S){if(!y)return B;S={_webGLVersion:y.TEXTURE_BINDING_3D?2:1,_context:y,parallelShaderCompile:y.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},A.set(y,S)}return S}function F(y){A.delete(y)}function J(y,S,I,V,i,A){const B=d(V);A||(A=B._createShaderProgramInjection??G);return A(y,j(S,"vertex",V,B._contextWasLost),j(I,"fragment",V,B._contextWasLost),V,i,B.validateShaderPrograms)}function u(y,S,I,V,i){let A=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,B=arguments.length>6?arguments[6]:void 0;const F=d(i);B||(B=F._createShaderProgramInjection??G);const J=F._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return B(y,l(S,"vertex",V,J,i,F._contextWasLost),l(I,"fragment",V,J,i,F._contextWasLost),i,A,F.validateShaderPrograms)}function K(y,S){const I=new V,i=d(y);return i.parallelShaderCompile&&!i.disableParallelShaderCompile&&(I.isParallelCompiled=!0),I.context=i._context,I}function G(y,S,I,V){let i=arguments.length>5?arguments[5]:void 0;const A=V.createProgram();if(y.program=A,!A)throw new Error("Unable to create program");return V.attachShader(A,S),V.attachShader(A,I),V.linkProgram(A),y.context=V,y.vertexShader=S,y.fragmentShader=I,y.isParallelCompiled||L(y,V,i),A}function p(y,S,I){const V=y;if(V._isDisposed)return!1;const i=d(S);return!!(i&&i.parallelShaderCompile&&i.parallelShaderCompile.COMPLETION_STATUS_KHR&&V.program&&S.getProgramParameter(V.program,i.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(L(V,S,I),!0)}function L(y,S,I){const V=y.context,i=y.vertexShader,A=y.fragmentShader,B=y.program;if(!V.getProgramParameter(B,V.LINK_STATUS)){if(!S.getShaderParameter(i,S.COMPILE_STATUS)){const I=S.getShaderInfoLog(i);if(I)throw y.vertexCompilationError=I,new Error("VERTEX SHADER "+I)}if(!S.getShaderParameter(A,S.COMPILE_STATUS)){const I=S.getShaderInfoLog(A);if(I)throw y.fragmentCompilationError=I,new Error("FRAGMENT SHADER "+I)}const I=V.getProgramInfoLog(B);if(I)throw y.programLinkError=I,new Error(I)}if(I){V.validateProgram(B);if(!V.getProgramParameter(B,V.VALIDATE_STATUS)){const S=V.getProgramInfoLog(B);if(S)throw y.programValidationError=S,new Error(S)}}V.deleteShader(i),V.deleteShader(A),y.vertexShader=void 0,y.fragmentShader=void 0,y.onCompiled&&(y.onCompiled(),y.onCompiled=void 0)}function T(y,S,I,V,i,A,B,F,K){let G=arguments.length>10?arguments[10]:void 0,p=arguments.length>11?arguments[11]:void 0,L=arguments.length>12?arguments[12]:void 0;const T=d(y.context);p||(p=T.createRawShaderProgramInjection??J),L||(L=T.createShaderProgramInjection??u);const l=y;l.program=V?p(l,S,I,l.context,K):L(l,S,I,F,l.context,K),l.program.__SPECTOR_rebuildProgram=B,G()}function l(y,S,I,V,A,B){return j((0,i.c)(y,I,V),S,A,B)}function j(y,S,I,V){const i=I.createShader("vertex"===S?I.VERTEX_SHADER:I.FRAGMENT_SHADER);if(!i){let y=I.NO_ERROR,i=I.NO_ERROR;for(;(i=I.getError())!==I.NO_ERROR;)y=i;throw new Error(`Something went wrong while creating a gl ${S} shader object. gl error=${y}, gl isContextLost=${I.isContextLost()}, _contextWasLost=${V}`)}return I.shaderSource(i,y),I.compileShader(i),i}function s(y,S){S.useProgram(y)}function O(y,S){const I=y;if(!I.isParallelCompiled)return void S(y);const V=I.onCompiled;I.onCompiled=()=>{null===V||void 0===V||V(),S(y)}}},12246:(y,S,I)=>{I.d(S,{e:()=>K,i:()=>p,j:()=>J,k:()=>u});var V=I(12142),i=I(12251),A=I(12240),B=I(12151),d=I(12203),F=I(12211);function J(y,S){return(0,i.B)(S).cachedPipelines[y]}function u(y){const S=y._name,I=y.context;if(S&&I){const y=(0,i.B)(I),V=y.cachedPipelines[S];null===V||void 0===V||V.dispose(),delete y.cachedPipelines[S]}}function K(y,S,I,i,A,B,F){let J,u;const K=(0,V.n)()?null===B||void 0===B?void 0:B.getHostDocument():null;J="string"===typeof S?S:S.vertexSource?"source:"+S.vertexSource:S.vertexElement?(null===K||void 0===K?void 0:K.getElementById(S.vertexElement))||S.vertexElement:S.vertex||S,u="string"===typeof S?S:S.fragmentSource?"source:"+S.fragmentSource:S.fragmentElement?(null===K||void 0===K?void 0:K.getElementById(S.fragmentElement))||S.fragmentElement:S.fragment||S;const p=[void 0,void 0],L=()=>{if(p[0]&&p[1]){y.isFragment=!0;const[V,J]=p;(0,d.m)(J,y,((B,J)=>{F&&(F._fragmentSourceCodeBeforeMigration=J),I&&(B=I("fragment",B));const u=(0,d.e)(V,B,y);y=null;const K=function(y,S,I,V){if(I){return{vertexSourceCode:(1===V?"//":"")+"#define SHADER_NAME vertex:"+(I.vertexElement||I.vertex||I.spectorName||I)+"\n"+y,fragmentSourceCode:(1===V?"//":"")+"#define SHADER_NAME fragment:"+(I.fragmentElement||I.fragment||I.spectorName||I)+"\n"+S}}return{vertexSourceCode:y,fragmentSourceCode:S}}(u.vertexCode,u.fragmentCode,S,A);null===i||void 0===i||i(K.vertexSourceCode,K.fragmentSourceCode)}),B)}};G(J,"Vertex","",(S=>{(0,d.h)(y),(0,d.m)(S,y,((y,V)=>{F&&(F._rawVertexSourceCode=S,F._vertexSourceCodeBeforeMigration=V),I&&(y=I("vertex",y)),p[0]=y,L()}),B)}),A),G(u,"Fragment","Pixel",(y=>{F&&(F._rawFragmentSourceCode=y),p[1]=y,L()}),A)}function G(y,S,I,i,B,d){if("undefined"!==typeof HTMLElement&&y instanceof HTMLElement){return void i((0,V.c)(y))}if("source:"===y.substring(0,7))return void i(y.substring(7));if("base64:"===y.substring(0,7)){return void i(window.atob(y.substring(7)))}const J=A.b.GetShadersStore(B);if(J[y+S+"Shader"])return void i(J[y+S+"Shader"]);if(I&&J[y+I+"Shader"])return void i(J[y+I+"Shader"]);let u;if(u="."===y[0]||"/"===y[0]||y.indexOf("http")>-1?y:A.b.GetShadersRepository(B)+y,!(d=d||F.h))throw new Error("loadFileInjection is not defined");d(u+"."+S.toLowerCase()+".fx",i)}const p=(y,S,I,V)=>{try{const A=y.context?(0,i.B)(y.context):null;A&&(A.disableParallelShaderCompile=y.disableParallelCompilation);const B=y.existingPipelineContext||S(y.shaderProcessingContext);return B._name=y.name,y.name&&A&&(A.cachedPipelines[y.name]=B),I(B,y.vertex,y.fragment,!!y.createAsRaw,"","",y.rebuildRebind,y.defines,y.transformFeedbackVaryings,"",(()=>{V(B,(()=>{var S;null===(S=y.onRenderingStateCompiled)||void 0===S||S.call(y,B)}))})),B}catch(A){throw B.b.Error("Error compiling effect"),A}}},12231:(y,S,I)=>{I.r(S),I.d(S,{Effect:()=>F});var V=I(12133),i=I(12151),A=I(12240),B=I(12246),d=I(12216);class F{static get ShadersRepository(){return A.b.ShadersRepository}static set ShadersRepository(y){A.b.ShadersRepository=y}get J(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new V.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(y,S,I){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,A=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,J=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,K=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,G=arguments.length>9?arguments[9]:void 0,p=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",L=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,T=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new V.b,this.onErrorObservable=new V.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=y,this._key=p;const l=this._key.replace(/\r/g,"").replace(/\n/g,"|");let j;if(S.attributes){const y=S;if(this._engine=I,this._attributesNames=y.attributes,this._uniformsNames=y.uniformsNames.concat(y.samplers),this._samplerList=y.samplers.slice(),this.defines=y.defines,this.onError=y.onError,this.onCompiled=y.onCompiled,this._fallbacks=y.fallbacks,this._indexParameters=y.indexParameters,this._transformFeedbackVaryings=y.transformFeedbackVaryings||null,this._multiTarget=!!y.multiTarget,this._shaderLanguage=y.shaderLanguage??0,this._disableParallelShaderCompilation=!!y.disableParallelShaderCompilation,y.uniformBuffersNames){this._uniformBuffersNamesList=y.uniformBuffersNames.slice();for(let S=0;S<y.uniformBuffersNames.length;S++)this._uniformBuffersNames[y.uniformBuffersNames[S]]=S}this._processFinalCode=y.processFinalCode??null,this._processCodeAfterIncludes=y.processCodeAfterIncludes??void 0,T=y.extraInitializationsAsync,j=y.existingPipelineContext}else this._engine=A,this.defines=null==d?"":d,this._uniformsNames=I.concat(i),this._samplerList=i?i.slice():[],this._attributesNames=S,this._uniformBuffersNamesList=[],this._shaderLanguage=L,this.onError=K,this.onCompiled=u,this._indexParameters=G,this._fallbacks=J;"WEBGL2"===this._engine.shaderPlatformName&&(j=(0,B.j)(l,this._engine._gl)??j),this._attributeLocationByName={},this.uniqueId=F._UniqueIdSeed++,j?(this._pipelineContext=j,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,T),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.J||this.dispose(!0)}))}async _processShaderCodeAsync(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,V=arguments.length>3?arguments[3]:void 0;V&&await V(),this._processingContext=I||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const i={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:y??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:A.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:A.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,si:this._engine.si,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,B.e)(i,this.name,this._processFinalCode,((y,I)=>{this._vertexSourceCode=y,this._fragmentSourceCode=I,this._prepareEffect(S)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.J||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(y){return this._attributes[y]}getAttributeLocationByName(y){return this._attributeLocationByName[y]}getAttributesCount(){return this._attributes.length}getUniformIndex(y){return this._uniformsNames.indexOf(y)}getUniform(y){return this._uniforms[y]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((y=>{this.executeWhenCompiled(y)}))}executeWhenCompiled(y){this.isReady()?y(this):(this.onCompileObservable.add((S=>{y(S)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(y){(0,d.d)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(S=>{this._processCompilationErrors(S,y)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var y;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(y=this._pipelineContext)||void 0===y?void 0:y._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var y;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(y=this._pipelineContext)||void 0===y?void 0:y._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,si:this._engine.si,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(y,S,I,V){this._isReady=!1,this._vertexSourceCodeOverride=y,this._fragmentSourceCodeOverride=S,this.onError=(y,S)=>{V&&V(S)},this.onCompiled=()=>{var y,S;const V=this.getEngine().scenes;if(V)for(let I=0;I<V.length;I++)V[I].markAllMaterialsAsDirty(127);null===(y=(S=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===y||y.call(S,I)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(y){if(this._pipelineContext=y,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let S=0;S<this._attributesNames.length;S++){const y=this._attributesNames[S];this._attributeLocationByName[y]=this._attributes[S]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),F.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const S=this._pipelineContext;this._isReady=!1;try{const I=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),V=I?null:this.defines,i=I?this._vertexSourceCodeOverride:this._vertexSourceCode,A=I?this._fragmentSourceCodeOverride:this._fragmentSourceCode,d=this._engine;this._pipelineContext=(0,B.i)({existingPipelineContext:y?S:null,vertex:i,fragment:A,context:"WEBGL2"===d.shaderPlatformName||"WEBGL1"===d.shaderPlatformName?d._gl:void 0,rebuildRebind:(y,S,I,V)=>this._rebuildProgram(y,S,I,V),defines:V,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:I,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:I=>{S&&!y&&this._engine._deletePipelineContext(S),I&&this._onRenderingStateCompiled(I)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(S)}catch(I){this._processCompilationErrors(I,S)}}_getShaderCodeAndErrorLine(y,S,I){const V=I?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let i=null;if(S&&y){const A=S.match(V);if(A&&2===A.length){const S=parseInt(A[1]),V=y.split("\n",-1);V.length>=S&&(i=`Offending line [${S}] in ${I?"fragment":"vertex"} code: ${V[S-1]}`)}}return[y,i]}_processCompilationErrors(y){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=y.message;const I=this._attributesNames,V=this._fallbacks;if(i.b.Error("Unable to compile effect:"),i.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),i.b.Error(`Attributes: ${I.join(" ")}`),i.b.Error("Defines:\n"+this.defines),F.LogShaderCodeOnCompilationError){var A,B;let y=null,S=null,I=null;var d;if(null!==(A=this._pipelineContext)&&void 0!==A&&A._getVertexShaderCode()&&([I,y]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),I&&(i.b.Error("Vertex code:"),i.b.Error(I))),null!==(B=this._pipelineContext)&&void 0!==B&&B._getFragmentShaderCode())[I,S]=this._getShaderCodeAndErrorLine(null===(d=this._pipelineContext)||void 0===d?void 0:d._getFragmentShaderCode(),this._compilationError,!0),I&&(i.b.Error("Fragment code:"),i.b.Error(I));y&&i.b.Error(y),S&&i.b.Error(S)}i.b.Error("Error: "+this._compilationError);const J=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};S&&(this._pipelineContext=S,this._isReady=!0,J()),V?(this._pipelineContext=null,V.hasMoreFallbacks?(this._allFallbacksProcessed=!1,i.b.Error("Trying next fallback."),this.defines=V.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,J(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,S||J())}get isSupported(){return""===this._compilationError}_bindTexture(y,S){this._engine._bindTexture(this._samplers[y],S,y)}setTexture(y,S){this._engine.setTexture(this._samplers[y],this._uniforms[y],S,y)}setTextureArray(y,S){const I=y+"Ex";if(-1===this._samplerList.indexOf(I+"0")){const V=this._samplerList.indexOf(y);for(let y=1;y<S.length;y++){const S=I+(y-1).toString();this._samplerList.splice(V+y,0,S)}let i=0;for(const y of this._samplerList)this._samplers[y]=i,i+=1}this._engine.setTextureArray(this._samplers[y],this._uniforms[y],S,y)}bindUniformBuffer(y,S){const I=this._uniformBuffersNames[S];void 0===I||F._BaseCache[I]===y&&this._engine._features.useUBOBindingCache||(F._BaseCache[I]=y,this._engine.bindUniformBufferBase(y,I,S))}bindUniformBlock(y,S){this._engine.bindUniformBlock(this._pipelineContext,y,S)}setInt(y,S){return this._pipelineContext.setInt(y,S),this}setInt2(y,S,I){return this._pipelineContext.setInt2(y,S,I),this}setInt3(y,S,I,V){return this._pipelineContext.setInt3(y,S,I,V),this}setInt4(y,S,I,V,i){return this._pipelineContext.setInt4(y,S,I,V,i),this}setIntArray(y,S){return this._pipelineContext.setIntArray(y,S),this}setIntArray2(y,S){return this._pipelineContext.setIntArray2(y,S),this}setIntArray3(y,S){return this._pipelineContext.setIntArray3(y,S),this}setIntArray4(y,S){return this._pipelineContext.setIntArray4(y,S),this}setUInt(y,S){return this._pipelineContext.setUInt(y,S),this}setUInt2(y,S,I){return this._pipelineContext.setUInt2(y,S,I),this}setUInt3(y,S,I,V){return this._pipelineContext.setUInt3(y,S,I,V),this}setUInt4(y,S,I,V,i){return this._pipelineContext.setUInt4(y,S,I,V,i),this}setUIntArray(y,S){return this._pipelineContext.setUIntArray(y,S),this}setUIntArray2(y,S){return this._pipelineContext.setUIntArray2(y,S),this}setUIntArray3(y,S){return this._pipelineContext.setUIntArray3(y,S),this}setUIntArray4(y,S){return this._pipelineContext.setUIntArray4(y,S),this}setFloatArray(y,S){return this._pipelineContext.setArray(y,S),this}setFloatArray2(y,S){return this._pipelineContext.setArray2(y,S),this}setFloatArray3(y,S){return this._pipelineContext.setArray3(y,S),this}setFloatArray4(y,S){return this._pipelineContext.setArray4(y,S),this}setArray(y,S){return this._pipelineContext.setArray(y,S),this}setArray2(y,S){return this._pipelineContext.setArray2(y,S),this}setArray3(y,S){return this._pipelineContext.setArray3(y,S),this}setArray4(y,S){return this._pipelineContext.setArray4(y,S),this}setMatrices(y,S){return this._pipelineContext.setMatrices(y,S),this}setMatrix(y,S){return this._pipelineContext.setMatrix(y,S),this}setMatrix3x3(y,S){return this._pipelineContext.setMatrix3x3(y,S),this}setMatrix2x2(y,S){return this._pipelineContext.setMatrix2x2(y,S),this}setFloat(y,S){return this._pipelineContext.setFloat(y,S),this}setBool(y,S){return this._pipelineContext.setInt(y,S?1:0),this}setVector2(y,S){return this._pipelineContext.setVector2(y,S),this}setFloat2(y,S,I){return this._pipelineContext.setFloat2(y,S,I),this}setVector3(y,S){return this._pipelineContext.setVector3(y,S),this}setFloat3(y,S,I,V){return this._pipelineContext.setFloat3(y,S,I,V),this}setVector4(y,S){return this._pipelineContext.setVector4(y,S),this}setQuaternion(y,S){return this._pipelineContext.setQuaternion(y,S),this}setFloat4(y,S,I,V,i){return this._pipelineContext.setFloat4(y,S,I,V,i),this}setColor3(y,S){return this._pipelineContext.setColor3(y,S),this}setColor4(y,S,I){return this._pipelineContext.setColor4(y,S,I),this}setDirectColor4(y,S){return this._pipelineContext.setDirectColor4(y,S),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(F.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,B.k)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(y,S,I){let V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;S&&(A.b.GetShadersStore(V)[`${y}PixelShader`]=S),I&&(A.b.GetShadersStore(V)[`${y}VertexShader`]=I)}static ResetCache(){F._BaseCache={}}}F.LogShaderCodeOnCompilationError=!0,F.PersistentMode=!1,F.AutomaticallyClearCodeCache=!1,F._UniqueIdSeed=0,F._BaseCache={},F.ShadersStore=A.b.ShadersStore,F.IncludesShadersStore=A.b.IncludesShadersStore},12172:(y,S,I)=>{I.d(S,{b:()=>i});const V={};function i(y){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!V[y])return V[y]=!0,`${y} needs to be imported before as it contains a side-effect required by your code.`}},12142:(y,S,I)=>{function V(){return"undefined"!==typeof window}function i(){return"undefined"!==typeof navigator}function A(){return"undefined"!==typeof document}function B(y){let S="",I=y.firstChild;for(;I;)3===I.nodeType&&(S+=I.textContent),I=I.nextSibling;return S}I.d(S,{c:()=>B,f:()=>A,j:()=>i,n:()=>V})},12151:(y,S,I)=>{I.d(S,{b:()=>V});class V{static _CheckLimit(y,S){let I=V._LogLimitOutputs[y];return I?I.current++:(I={limit:S,current:1},V._LogLimitOutputs[y]=I),I.current<=I.limit}static _GenerateLimitMessage(y){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const I=V._LogLimitOutputs[y];if(!I||!V.MessageLimitReached)return;const i=this._Levels[S];I.current===I.limit&&V[i.name](V.MessageLimitReached.replace(/%LIMIT%/g,""+I.limit).replace(/%TYPE%/g,i.name??""))}static _AddLogEntry(y){V._LogCache=y+V._LogCache,V.OnNewCacheEntry&&V.OnNewCacheEntry(y)}static _FormatMessage(y){const S=y=>y<10?"0"+y:""+y,I=new Date;return"["+S(I.getHours())+":"+S(I.getMinutes())+":"+S(I.getSeconds())+"]: "+y}static _LogDisabled(y,S){}static _LogEnabled(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,S=arguments.length>1?arguments[1]:void 0,I=arguments.length>2?arguments[2]:void 0;const i=Array.isArray(S)?S[0]:S;if(void 0!==I&&!V._CheckLimit(i,I))return;const A=V._FormatMessage(i),B=this._Levels[y],d=Array.isArray(S)?S.slice(1):[];B.logFunc&&B.logFunc("BJS - "+A,...d);const F=`<div style='color:${B.color}'>${A}</div><br>`;V._AddLogEntry(F),V._GenerateLimitMessage(i,y)}static get LogCache(){return V._LogCache}static ClearLogCache(){V._LogCache="",V._LogLimitOutputs={},V.errorsCount=0}static set LogLevels(y){V.Log=V._LogDisabled,V.Warn=V._LogDisabled,V.Error=V._LogDisabled;const S=[V.MessageLogLevel,V.WarningLogLevel,V.ErrorLogLevel];for(const I of S)if((y&I)===I){const y=this._Levels[I];V[y.name]=V._LogEnabled.bind(V,I)}}}V.NoneLogLevel=0,V.MessageLogLevel=1,V.WarningLogLevel=2,V.ErrorLogLevel=4,V.AllLogLevel=7,V.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",V._LogCache="",V._LogLimitOutputs={},V._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],V.errorsCount=0,V.Log=V._LogEnabled.bind(V,V.MessageLogLevel),V.Warn=V._LogEnabled.bind(V,V.WarningLogLevel),V.Error=V._LogEnabled.bind(V,V.ErrorLogLevel)},12133:(y,S,I)=>{I.d(S,{b:()=>B});const V="undefined"!==typeof WeakRef;class i{constructor(y){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],I=arguments.length>2?arguments[2]:void 0,V=arguments.length>3?arguments[3]:void 0;this.initialize(y,S,I,V)}initialize(y){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1],I=arguments.length>2?arguments[2]:void 0,V=arguments.length>3?arguments[3]:void 0;return this.mask=y,this.skipNextObservers=S,this.target=I,this.currentTarget=V,this}}class A{constructor(y,S){let I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=y,this.mask=S,this.scope=I,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(y)}}class B{static FromPromise(y,S){const I=new B;return y.then((y=>{I.notifyObservers(y)})).catch((y=>{if(!S)throw y;S.notifyObservers(y)})),I}get observers(){return this._observers}constructor(y){let S=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=S,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new i(0),y&&(this._onObserverAdded=y)}add(y){let S=arguments.length>2&&void 0!==arguments[2]&&arguments[2],I=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!y)return null;const i=new A(y,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);i.unregisterOnNextCall=I,S?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(i,this._lastNotifiedValue);const B=V?new WeakRef(this):{deref:()=>this};return i._remove=function(){let y=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const S=B.deref();S&&(y?S.remove(i):S._remove(i))},i}addOnce(y){return this.add(y,void 0,void 0,void 0,!0)}remove(y){if(!y)return!1;y._remove=null;return-1!==this._observers.indexOf(y)&&(this._deferUnregister(y),!0)}removeCallback(y,S){for(let I=0;I<this._observers.length;I++){const V=this._observers[I];if(!V._willBeUnregistered&&(V.callback===y&&(!S||S===V.scope)))return this._deferUnregister(V),!0}return!1}_deferUnregister(y){y._willBeUnregistered||(this._numObserversMarkedAsDeleted++,y.unregisterOnNextCall=!1,y._willBeUnregistered=!0,setTimeout((()=>{this._remove(y)}),0))}_remove(y){let S=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!y)return!1;const I=this._observers.indexOf(y);return-1!==I&&(S&&this._numObserversMarkedAsDeleted--,this._observers.splice(I,1),!0)}makeObserverTopPriority(y){this._remove(y,!1),this._observers.unshift(y)}makeObserverBottomPriority(y){this._remove(y,!1),this._observers.push(y)}notifyObservers(y){let S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,I=arguments.length>2?arguments[2]:void 0,V=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=y),!this._observers.length)return!0;const A=this._eventState;A.mask=S,A.target=I,A.currentTarget=V,A.skipNextObservers=!1,A.lastReturnValue=y,A.userInfo=i;for(const B of this._observers)if(!B._willBeUnregistered&&(B.mask&S&&(B.unregisterOnNextCall&&this._deferUnregister(B),B.scope?A.lastReturnValue=B.callback.apply(B.scope,[y,A]):A.lastReturnValue=B.callback(y,A)),A.skipNextObservers))return!1;return!0}notifyObserver(y,S){let I=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=S),y._willBeUnregistered)return;const V=this._eventState;V.mask=I,V.skipNextObservers=!1,y.unregisterOnNextCall&&this._deferUnregister(y),y.callback(S,V)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const y=this._observers.pop();y&&(y._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const y=new B;return y._observers=this._observers.slice(0),y}hasSpecificMask(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const S of this._observers)if(S.mask&y||S.mask===y)return!0;return!1}}},12216:(y,S,I)=>{I.d(S,{b:()=>i,d:()=>B});let V=[];class i{static SetImmediate(y){0===V.length&&setTimeout((()=>{const y=V;V=[];for(const S of y)S()}),1),V.push(y)}}function A(y,S,I){try{if(y())return S(),!0}catch(V){return null===I||void 0===I||I(V),!0}return!1}const B=function(y,S,I){let V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,B=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&A(y,S,I))return null;const d=setInterval((()=>{A(y,S,I)?clearInterval(d):(i-=V,i<0&&(clearInterval(d),null===I||void 0===I||I(new Error("Operation timed out after maximum retries. "+(B||"")),!0)))}),V);return()=>clearInterval(d)}}}]);