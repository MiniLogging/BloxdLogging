"use strict";(self.n4ygn1cq9vg=self.n4ygn1cq9vg||[]).push([[9],{12303:(e,d,v)=>{v.d(d,{c:()=>x,e:()=>n,k:()=>A,i:()=>S,l:()=>o});class P{constructor(){this.children=[]}isValid(e){return!0}process(e,d,v){let P="";if(this.line){let v=this.line;const V=d.processor;if(V){var p,L,B,X,z,W;V.lineProcessor&&(v=V.lineProcessor(v,d.isFragment,d.processingContext));const P=(null===(p=d.processor)||void 0===p?void 0:p.attributeKeywordName)??"attribute",k=d.isFragment&&null!==(L=d.processor)&&void 0!==L&&L.varyingFragmentKeywordName?null===(B=d.processor)||void 0===B?void 0:B.varyingFragmentKeywordName:!d.isFragment&&null!==(X=d.processor)&&void 0!==X&&X.varyingVertexKeywordName?null===(z=d.processor)||void 0===z?void 0:z.varyingVertexKeywordName:"varying";if(!d.isFragment&&V.attributeProcessor&&this.line.startsWith(P))v=V.attributeProcessor(this.line,e,d.processingContext);else if(V.varyingProcessor&&(null!==(W=V.varyingCheck)&&void 0!==W&&W.call(V,this.line,d.isFragment)||!V.varyingCheck&&this.line.startsWith(k)))v=V.varyingProcessor(this.line,d.isFragment,e,d.processingContext);else if(V.uniformProcessor&&V.uniformRegexp&&V.uniformRegexp.test(this.line))d.lookForClosingBracketForUniformBuffer||(v=V.uniformProcessor(this.line,d.isFragment,e,d.processingContext));else if(V.uniformBufferProcessor&&V.uniformBufferRegexp&&V.uniformBufferRegexp.test(this.line))d.lookForClosingBracketForUniformBuffer||(v=V.uniformBufferProcessor(this.line,d.isFragment,d.processingContext),d.lookForClosingBracketForUniformBuffer=!0);else if(V.textureProcessor&&V.textureRegexp&&V.textureRegexp.test(this.line))v=V.textureProcessor(this.line,d.isFragment,e,d.processingContext);else if((V.uniformProcessor||V.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!d.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?V.uniformProcessor&&(v=V.uniformProcessor(this.line,d.isFragment,e,d.processingContext)):V.uniformBufferProcessor&&(v=V.uniformBufferProcessor(this.line,d.isFragment,d.processingContext),d.lookForClosingBracketForUniformBuffer=!0)}d.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(d.lookForClosingBracketForUniformBuffer=!1,V.endOfUniformBufferProcessor&&(v=V.endOfUniformBufferProcessor(this.line,d.isFragment,d.processingContext)))}P+=v+"\n"}for(const V of this.children)P+=V.process(e,d,v);return this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true",v[this.additionalDefineKey]=e[this.additionalDefineKey]),P}}class p{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){this._lines.length=0;for(const d of e){if(!d||"\r"===d)continue;if("#"===d[0]){this._lines.push(d);continue}const e=d.trim();if(!e)continue;if(e.startsWith("//")){this._lines.push(d);continue}const v=e.indexOf(";");if(-1===v)this._lines.push(e);else if(v===e.length-1)e.length>1&&this._lines.push(e);else{const e=d.split(";");for(let d=0;d<e.length;d++){let v=e[d];v&&(v=v.trim(),v&&this._lines.push(v+(d!==e.length-1?";":"")))}}}}}class L extends P{process(e,d,v){for(let P=0;P<this.children.length;P++){const p=this.children[P];if(p.isValid(e))return p.process(e,d,v)}return""}}class B extends P{isValid(e){return this.testExpression.isTrue(e)}}class X{isTrue(e){return!0}static postfixToInfix(e){const d=[];for(const v of e)if(void 0===X._OperatorPriority[v])d.push(v);else{const e=d[d.length-1],P=d[d.length-2];d.length-=2,d.push(`(${P}${v}${e})`)}return d[d.length-1]}static infixToPostfix(e){const d=X._InfixToPostfixCache.get(e);if(d)return d.accessTime=Date.now(),d.result;if(!e.includes("&&")&&!e.includes("||")&&!e.includes(")")&&!e.includes("("))return[e];const v=[];let P=-1;const p=()=>{V=V.trim(),""!==V&&(v.push(V),V="")},L=e=>{P<X._Stack.length-1&&(X._Stack[++P]=e)},B=()=>X._Stack[P],z=()=>-1===P?"!!INVALID EXPRESSION!!":X._Stack[P--];let W=0,V="";for(;W<e.length;){const d=e.charAt(W),k=W<e.length-1?e.substring(W,2+W):"";if("("===d)V="",L(d);else if(")"===d){for(p();-1!==P&&"("!==B();)v.push(z());z()}else if(X._OperatorPriority[k]>1){for(p();-1!==P&&X._OperatorPriority[B()]>=X._OperatorPriority[k];)v.push(z());L(k),W++}else V+=d;W++}for(p();-1!==P;)"("===B()?z():v.push(z());return X._InfixToPostfixCache.size>=X.InfixToPostfixCacheLimitSize&&X.ClearCache(),X._InfixToPostfixCache.set(e,{result:v,accessTime:Date.now()}),v}static ClearCache(){const e=Array.from(X._InfixToPostfixCache.entries()).sort(((e,d)=>e[1].accessTime-d[1].accessTime));for(let d=0;d<X.InfixToPostfixCacheCleanupSize;d++)X._InfixToPostfixCache.delete(e[d][0])}}X.InfixToPostfixCacheLimitSize=5e4,X.InfixToPostfixCacheCleanupSize=25e3,X._InfixToPostfixCache=new Map,X._OperatorPriority={")":0,"(":1,"||":2,"&&":3},X._Stack=["","","","","","","","","","","","","","","","","","","",""];class z extends X{constructor(e){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=e,this.not=d}isTrue(e){let d=void 0!==e[this.define];return this.not&&(d=!d),d}}class W extends X{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class V extends X{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class k extends X{constructor(e,d,v){super(),this.define=e,this.operand=d,this.testValue=v}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(e){let d=!1;const v=parseInt(void 0!=e[this.define]?e[this.define]:this.define),P=parseInt(void 0!=e[this.testValue]?e[this.testValue]:this.testValue);if(isNaN(v)||isNaN(P))return!1;switch(this.operand){case">":d=v>P;break;case"<":d=v<P;break;case"<=":d=v<=P;break;case">=":d=v>=P;break;case"==":d=v===P;break;case"!=":d=v!==P}return d}}var g=v(12268),F=v(12306);const w=/defined\s*?\((.+?)\)/g,G=/defined\s*?\[(.+?)\]/g,U=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,D=/__decl__/,C=/light\{X\}.(\w*)/g,q=/\{X\}/g,h=[],l=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function n(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}function A(e,d,v,P){var p;null!==(p=d.processor)&&void 0!==p&&p.preProcessShaderCode&&(e=d.processor.preProcessShaderCode(e,d.isFragment)),S(e,d,(e=>{d.processCodeAfterIncludes&&(e=d.processCodeAfterIncludes(d.isFragment?"fragment":"vertex",e,d.defines));const p=function(e,d,v){let P=function(e,d){var v;if(null!==(v=d.processor)&&void 0!==v&&v.noPrecision)return e;const P=d.shouldUseHighPrecisionShader;-1===e.indexOf("precision highp float")?e=P?"precision highp float;\n"+e:"precision mediump float;\n"+e:P||(e=e.replace("precision highp float","precision mediump float"));return e}(e,d);if(!d.processor)return P;if(0===d.processor.shaderLanguage&&-1!==P.indexOf("#version 3")&&(P=P.replace("#version 300 es",""),!d.processor.parseGLES3))return P;const p=d.defines,L=T(d,v);d.processor.preProcessor&&(P=d.processor.preProcessor(P,p,L,d.isFragment,d.processingContext));const B={};P=f(P,L,d,B),d.processor.postProcessor&&(P=d.processor.postProcessor(P,p,d.isFragment,d.processingContext,v?{drawBuffersExtensionDisabled:!v.getCaps().drawBuffersExtension}:{},L,B));null!==v&&void 0!==v&&v._features.needShaderCodeInlining&&(P=v.inlineShaderCode(P));return P}(e,d,P);v(p,e)}))}function x(e,d,v){return v.processor&&v.processor.finalizeShaders?v.processor.finalizeShaders(e,d,v.processingContext):{vertexCode:e,fragmentCode:d}}function i(e){const d=/defined\((.+)\)/.exec(e);if(d&&d.length)return new z(d[1].trim(),"!"===e[0]);const v=["==","!=",">=","<=","<",">"];let P="",p=0;for(P of v)if(p=e.indexOf(P),p>-1)break;if(-1===p)return new z(e);const L=e.substring(0,p).trim(),B=e.substring(p+P.length).trim();return new k(L,P,B)}function me(e,d){const v=new B,P=e.substring(0,d);let p=e.substring(d);return p=p.substring(0,(p.indexOf("//")+1||p.length+1)-1).trim(),v.testExpression="#ifdef"===P?new z(p):"#ifndef"===P?new z(p,!0):function(e){e=e.replace(w,"defined[$1]");const d=X.infixToPostfix(e),v=[];for(const p of d)if("||"!==p&&"&&"!==p)v.push(p);else if(v.length>=2){let e=v[v.length-1],d=v[v.length-2];v.length-=2;const P="&&"==p?new V:new W;"string"===typeof e&&(e=e.replace(G,"defined($1)")),"string"===typeof d&&(d=d.replace(G,"defined($1)")),P.leftOperand="string"===typeof d?i(d):d,P.rightOperand="string"===typeof e?i(e):e,v.push(P)}let P=v[v.length-1];return"string"===typeof P&&(P=P.replace(G,"defined($1)")),"string"===typeof P?i(P):P}(p),v}function r(e,d,v,p){let L=e.currentLine;for(;Z(e,v,p);){L=e.currentLine;const B=L.substring(0,5).toLowerCase();if("#else"===B){const v=new P;return d.children.push(v),void Z(e,v,p)}if("#elif"===B){const e=me(L,5);d.children.push(e),v=e}}}function Z(e,d,v){for(;e.canRead;){e.lineIndex++;const p=e.currentLine;if(p.indexOf("#")>=0){const P=l.exec(p);if(P&&P.length){switch(P[0]){case"#ifdef":{const P=new L;d.children.push(P);const B=me(p,6);P.children.push(B),r(e,P,B,v);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const P=new L;d.children.push(P);const B=me(p,7);P.children.push(B),r(e,P,B,v);break}case"#if":{const P=new L,B=me(p,3);d.children.push(P),P.children.push(B),r(e,P,B,v);break}}continue}}const B=new P;if(B.line=p,d.children.push(B),"#"===p[0]&&"d"===p[1]){const e=p.replace(";","").split(" ");B.additionalDefineKey=e[1],3===e.length&&(B.additionalDefineValue=e[2])}}return!1}function f(e,d,v,L){const B=new P,X=new p;return X.lineIndex=-1,X.lines=e.split("\n"),Z(X,B,L),B.process(d,v,L)}function T(e,d){var v;const P=e.defines,p={};for(const L of P){const e=L.replace("#define","").replace(";","").trim().split(" ");p[e[0]]=e.length>1?e[1]:""}return 0===(null===(v=e.processor)||void 0===v?void 0:v.shaderLanguage)&&(p.GL_ES="true"),p.__VERSION__=e.version,p[e.platformName]="true",(0,F.h)(p,null===d||void 0===d?void 0:d.isNDCHalfZRange,null===d||void 0===d?void 0:d.Wd,null===d||void 0===d?void 0:d.useExactSrgbConversions),p}function S(e,d,v){let P;for(h.length=0;null!==(P=U.exec(e));)h.push(P);let p=String(e),L=[e],B=!1;for(const X of h){let e=X[1];if(-1!==e.indexOf("__decl__")&&(e=e.replace(D,""),d.supportsUniformBuffers&&(e=e.replace("Vertex","Ubo").replace("Fragment","Ubo")),e+="Declaration"),!d.includesShadersStore[e]){const P=d.shadersRepository+"ShadersInclude/"+e+".fx";return void o.loadFile(P,(P=>{d.includesShadersStore[e]=P,S(L.join(""),d,v)}))}{let v=d.includesShadersStore[e];if(X[2]){const e=X[3].split(",");for(let d=0;d<e.length;d+=2){const P=new RegExp(e[d],"g"),p=e[d+1];v=v.replace(P,p)}}if(X[4]){const e=X[5];if(-1!==e.indexOf("..")){const P=e.split(".."),p=parseInt(P[0]);let L=parseInt(P[1]),B=v.slice(0);v="",isNaN(L)&&(L=d.indexParameters[P[1]]);for(let e=p;e<L;e++)d.supportsUniformBuffers||(B=B.replace(C,((e,d)=>d+"{X}"))),v+=B.replace(q,e.toString())+"\n"}else d.supportsUniformBuffers||(v=v.replace(C,((e,d)=>d+"{X}"))),v=v.replace(q,e)}const P=[];for(const e of L){const d=e.split(X[0]);for(let e=0;e<d.length-1;e++)P.push(d[e]),P.push(v);P.push(d[d.length-1])}L=P,B=B||v.indexOf("#include<")>=0||v.indexOf("#include <")>=0}}h.length=0,p=L.join(""),B?S(p.toString(),d,v):v(p)}const o={loadFile:(e,d,v,P,p,L)=>{throw(0,g.e)("FileTools")}}},12306:(e,d,v)=>{v.d(d,{e:()=>p,g:()=>L,h:()=>X,k:()=>B,n:()=>z});var P=v(12268);v(12250);const p={};function L(e,d){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(d?d+"\n":"")+e}function B(e,d,v,L,B,X,z){const W=z||p.loadFile;if(W){return W(e,d,v,L,B,X)}throw(0,P.e)("FileTools")}function X(e,d,v,P){if(e)return d?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,v?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(P?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);{let e="";return d&&(e+="#define IS_NDC_HALF_ZRANGE"),v&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),P&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}function z(e,d){let v=arguments.length>2&&void 0!==arguments[2]&&arguments[2],P=arguments.length>3?arguments[3]:void 0;switch(e){case 3:{const e=(ArrayBuffer,new Int8Array(d));return P&&e.set(new Int8Array(P)),e}case 0:{const e=(ArrayBuffer,new Uint8Array(d));return P&&e.set(new Uint8Array(P)),e}case 4:{const e=d instanceof ArrayBuffer?new Int16Array(d):new Int16Array(v?d/2:d);return P&&e.set(new Int16Array(P)),e}case 5:case 8:case 9:case 10:case 2:{const e=d instanceof ArrayBuffer?new Uint16Array(d):new Uint16Array(v?d/2:d);return P&&e.set(new Uint16Array(P)),e}case 6:{const e=d instanceof ArrayBuffer?new Int32Array(d):new Int32Array(v?d/4:d);return P&&e.set(new Int32Array(P)),e}case 7:case 11:case 12:case 13:case 14:case 15:{const e=d instanceof ArrayBuffer?new Uint32Array(d):new Uint32Array(v?d/4:d);return P&&e.set(new Uint32Array(P)),e}case 1:{const e=d instanceof ArrayBuffer?new Float32Array(d):new Float32Array(v?d/4:d);return P&&e.set(new Float32Array(P)),e}}const p=(ArrayBuffer,new Uint8Array(d));return P&&p.set(new Uint8Array(P)),p}},12328:(e,d,v)=>{v.d(d,{d:()=>P});class P{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.ShadersRepository:P.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.ShadersStore:P.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?P.IncludesShadersStore:P.IncludesShadersStoreWGSL}}P.ShadersRepository="src/Shaders/",P.ShadersStore={},P.IncludesShadersStore={},P.ShadersRepositoryWGSL="src/ShadersWGSL/",P.ShadersStoreWGSL={},P.IncludesShadersStoreWGSL={}},12341:(e,d,v)=>{v.d(d,{b:()=>g,d:()=>q,e:()=>w,f:()=>F,h:()=>G,i:()=>C,k:()=>k,l:()=>W,p:()=>V,s:()=>z,u:()=>X});class P{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.Ad._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}setEngine(e){this.Ad=e}_fillEffectInformation(e,d,v,P,p,L,B,X){const z=this.Ad;if(z.supportsUniformBuffers)for(const V in d)e.bindUniformBlock(V,d[V]);let W;for(this.Ad.getUniforms(this,v).forEach(((e,d)=>{P[v[d]]=e})),this._uniforms=P,W=0;W<p.length;W++){null==e.getUniform(p[W])&&(p.splice(W,1),W--)}p.forEach(((e,d)=>{L[e]=d}));for(const V of z.getAttributes(this,B))X.push(V)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(e,d){const v=this._valueCache[e],P=d.updateFlag;return(void 0===v||v!==P)&&(this._valueCache[e]=P,!0)}_cacheFloat2(e,d,v){let P=this._valueCache[e];if(!P||2!==P.length)return P=[d,v],this._valueCache[e]=P,!0;let p=!1;return P[0]!==d&&(P[0]=d,p=!0),P[1]!==v&&(P[1]=v,p=!0),p}_cacheFloat3(e,d,v,P){let p=this._valueCache[e];if(!p||3!==p.length)return p=[d,v,P],this._valueCache[e]=p,!0;let L=!1;return p[0]!==d&&(p[0]=d,L=!0),p[1]!==v&&(p[1]=v,L=!0),p[2]!==P&&(p[2]=P,L=!0),L}_cacheFloat4(e,d,v,P,p){let L=this._valueCache[e];if(!L||4!==L.length)return L=[d,v,P,p],this._valueCache[e]=L,!0;let B=!1;return L[0]!==d&&(L[0]=d,B=!0),L[1]!==v&&(L[1]=v,B=!0),L[2]!==P&&(L[2]=P,B=!0),L[3]!==p&&(L[3]=p,B=!0),B}setInt(e,d){const v=this._valueCache[e];void 0!==v&&v===d||this.Ad.setInt(this._uniforms[e],d)&&(this._valueCache[e]=d)}setInt2(e,d,v){this._cacheFloat2(e,d,v)&&(this.Ad.setInt2(this._uniforms[e],d,v)||(this._valueCache[e]=null))}setInt3(e,d,v,P){this._cacheFloat3(e,d,v,P)&&(this.Ad.setInt3(this._uniforms[e],d,v,P)||(this._valueCache[e]=null))}setInt4(e,d,v,P,p){this._cacheFloat4(e,d,v,P,p)&&(this.Ad.setInt4(this._uniforms[e],d,v,P,p)||(this._valueCache[e]=null))}setIntArray(e,d){this._valueCache[e]=null,this.Ad.setIntArray(this._uniforms[e],d)}setIntArray2(e,d){this._valueCache[e]=null,this.Ad.setIntArray2(this._uniforms[e],d)}setIntArray3(e,d){this._valueCache[e]=null,this.Ad.setIntArray3(this._uniforms[e],d)}setIntArray4(e,d){this._valueCache[e]=null,this.Ad.setIntArray4(this._uniforms[e],d)}setUInt(e,d){const v=this._valueCache[e];void 0!==v&&v===d||this.Ad.setUInt(this._uniforms[e],d)&&(this._valueCache[e]=d)}setUInt2(e,d,v){this._cacheFloat2(e,d,v)&&(this.Ad.setUInt2(this._uniforms[e],d,v)||(this._valueCache[e]=null))}setUInt3(e,d,v,P){this._cacheFloat3(e,d,v,P)&&(this.Ad.setUInt3(this._uniforms[e],d,v,P)||(this._valueCache[e]=null))}setUInt4(e,d,v,P,p){this._cacheFloat4(e,d,v,P,p)&&(this.Ad.setUInt4(this._uniforms[e],d,v,P,p)||(this._valueCache[e]=null))}setUIntArray(e,d){this._valueCache[e]=null,this.Ad.setUIntArray(this._uniforms[e],d)}setUIntArray2(e,d){this._valueCache[e]=null,this.Ad.setUIntArray2(this._uniforms[e],d)}setUIntArray3(e,d){this._valueCache[e]=null,this.Ad.setUIntArray3(this._uniforms[e],d)}setUIntArray4(e,d){this._valueCache[e]=null,this.Ad.setUIntArray4(this._uniforms[e],d)}setArray(e,d){this._valueCache[e]=null,this.Ad.setArray(this._uniforms[e],d)}setArray2(e,d){this._valueCache[e]=null,this.Ad.setArray2(this._uniforms[e],d)}setArray3(e,d){this._valueCache[e]=null,this.Ad.setArray3(this._uniforms[e],d)}setArray4(e,d){this._valueCache[e]=null,this.Ad.setArray4(this._uniforms[e],d)}setMatrices(e,d){d&&(this._valueCache[e]=null,this.Ad.setMatrices(this._uniforms[e],d))}setMatrix(e,d){this._cacheMatrix(e,d)&&(this.Ad.setMatrices(this._uniforms[e],d.Yd())||(this._valueCache[e]=null))}setMatrix3x3(e,d){this._valueCache[e]=null,this.Ad.setMatrix3x3(this._uniforms[e],d)}setMatrix2x2(e,d){this._valueCache[e]=null,this.Ad.setMatrix2x2(this._uniforms[e],d)}setFloat(e,d){const v=this._valueCache[e];void 0!==v&&v===d||this.Ad.setFloat(this._uniforms[e],d)&&(this._valueCache[e]=d)}setVector2(e,d){this._cacheFloat2(e,d.x,d.y)&&(this.Ad.setFloat2(this._uniforms[e],d.x,d.y)||(this._valueCache[e]=null))}setFloat2(e,d,v){this._cacheFloat2(e,d,v)&&(this.Ad.setFloat2(this._uniforms[e],d,v)||(this._valueCache[e]=null))}setVector3(e,d){this._cacheFloat3(e,d.x,d.y,d.z)&&(this.Ad.setFloat3(this._uniforms[e],d.x,d.y,d.z)||(this._valueCache[e]=null))}setFloat3(e,d,v,P){this._cacheFloat3(e,d,v,P)&&(this.Ad.setFloat3(this._uniforms[e],d,v,P)||(this._valueCache[e]=null))}setVector4(e,d){this._cacheFloat4(e,d.x,d.y,d.z,d.w)&&(this.Ad.setFloat4(this._uniforms[e],d.x,d.y,d.z,d.w)||(this._valueCache[e]=null))}setQuaternion(e,d){this._cacheFloat4(e,d.x,d.y,d.z,d.w)&&(this.Ad.setFloat4(this._uniforms[e],d.x,d.y,d.z,d.w)||(this._valueCache[e]=null))}setFloat4(e,d,v,P,p){this._cacheFloat4(e,d,v,P,p)&&(this.Ad.setFloat4(this._uniforms[e],d,v,P,p)||(this._valueCache[e]=null))}setColor3(e,d){this._cacheFloat3(e,d.r,d.g,d.b)&&(this.Ad.setFloat3(this._uniforms[e],d.r,d.g,d.b)||(this._valueCache[e]=null))}setColor4(e,d,v){this._cacheFloat4(e,d.r,d.g,d.b,v)&&(this.Ad.setFloat4(this._uniforms[e],d.r,d.g,d.b,v)||(this._valueCache[e]=null))}setDirectColor4(e,d){this._cacheFloat4(e,d.r,d.g,d.b,d.a)&&(this.Ad.setFloat4(this._uniforms[e],d.r,d.g,d.b,d.a)||(this._valueCache[e]=null))}_getVertexShaderCode(){return this.vertexShader?this.Ad._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.Ad._getShaderSource(this.fragmentShader):null}}var p=v(12306);const L=new WeakMap,B={_webGLVersion:2,cachedPipelines:{}};function X(e){let d=L.get(e);if(!d){if(!e)return B;d={_webGLVersion:e.TEXTURE_BINDING_3D?2:1,_context:e,parallelShaderCompile:e.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},L.set(e,d)}return d}function z(e){L.delete(e)}function W(e,d,v,P,p,L){const B=X(P);L||(L=B._createShaderProgramInjection??g);return L(e,D(d,"vertex",P,B._contextWasLost),D(v,"fragment",P,B._contextWasLost),P,p,B.validateShaderPrograms)}function V(e,d,v,P,p){let L=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,B=arguments.length>6?arguments[6]:void 0;const z=X(p);B||(B=z._createShaderProgramInjection??g);const W=z._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return B(e,U(d,"vertex",P,W,p,z._contextWasLost),U(v,"fragment",P,W,p,z._contextWasLost),p,L,z.validateShaderPrograms)}function k(e,d){const v=new P,p=X(e);return p.parallelShaderCompile&&!p.disableParallelShaderCompile&&(v.isParallelCompiled=!0),v.context=p._context,v}function g(e,d,v,P){let p=arguments.length>5?arguments[5]:void 0;const L=P.createProgram();if(e.program=L,!L)throw new Error("Unable to create program");return P.attachShader(L,d),P.attachShader(L,v),P.linkProgram(L),e.context=P,e.vertexShader=d,e.fragmentShader=v,e.isParallelCompiled||w(e,P,p),L}function F(e,d,v){const P=e;if(P._isDisposed)return!1;const p=X(d);return!!(p&&p.parallelShaderCompile&&p.parallelShaderCompile.COMPLETION_STATUS_KHR&&P.program&&d.getProgramParameter(P.program,p.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(w(P,d,v),!0)}function w(e,d,v){const P=e.context,p=e.vertexShader,L=e.fragmentShader,B=e.program;if(!P.getProgramParameter(B,P.LINK_STATUS)){if(!d.getShaderParameter(p,d.COMPILE_STATUS)){const v=d.getShaderInfoLog(p);if(v)throw e.vertexCompilationError=v,new Error("VERTEX SHADER "+v)}if(!d.getShaderParameter(L,d.COMPILE_STATUS)){const v=d.getShaderInfoLog(L);if(v)throw e.fragmentCompilationError=v,new Error("FRAGMENT SHADER "+v)}const v=P.getProgramInfoLog(B);if(v)throw e.programLinkError=v,new Error(v)}if(v){P.validateProgram(B);if(!P.getProgramParameter(B,P.VALIDATE_STATUS)){const d=P.getProgramInfoLog(B);if(d)throw e.programValidationError=d,new Error(d)}}P.deleteShader(p),P.deleteShader(L),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)}function G(e,d,v,P,p,L,B,z,k){let g=arguments.length>10?arguments[10]:void 0,F=arguments.length>11?arguments[11]:void 0,w=arguments.length>12?arguments[12]:void 0;const G=X(e.context);F||(F=G.createRawShaderProgramInjection??W),w||(w=G.createShaderProgramInjection??V);const U=e;U.program=P?F(U,d,v,U.context,k):w(U,d,v,z,U.context,k),U.program.__SPECTOR_rebuildProgram=B,g()}function U(e,d,v,P,L,B){return D((0,p.g)(e,v,P),d,L,B)}function D(e,d,v,P){const p=v.createShader("vertex"===d?v.VERTEX_SHADER:v.FRAGMENT_SHADER);if(!p){let e=v.NO_ERROR,p=v.NO_ERROR;for(;(p=v.getError())!==v.NO_ERROR;)e=p;throw new Error(`Something went wrong while creating a gl ${d} shader object. gl error=${e}, gl isContextLost=${v.isContextLost()}, _contextWasLost=${P}`)}return v.shaderSource(p,e),v.compileShader(p),p}function C(e,d){d.useProgram(e)}function q(e,d){const v=e;if(!v.isParallelCompiled)return void d(e);const P=v.onCompiled;v.onCompiled=()=>{null===P||void 0===P||P(),d(e)}}},12334:(e,d,v)=>{v.d(d,{b:()=>k,d:()=>F,e:()=>W,i:()=>V});var P=v(12250),p=v(12341),L=v(12328),B=v(12253),X=v(12303),z=v(12306);function W(e,d){return(0,p.u)(d).cachedPipelines[e]}function V(e){const d=e._name,v=e.context;if(d&&v){const e=(0,p.u)(v),P=e.cachedPipelines[d];null===P||void 0===P||P.dispose(),delete e.cachedPipelines[d]}}function k(e,d,v,p,L,B,z){let W,V;const k=(0,P.k)()?null===B||void 0===B?void 0:B.getHostDocument():null;W="string"===typeof d?d:d.vertexSource?"source:"+d.vertexSource:d.vertexElement?(null===k||void 0===k?void 0:k.getElementById(d.vertexElement))||d.vertexElement:d.vertex||d,V="string"===typeof d?d:d.fragmentSource?"source:"+d.fragmentSource:d.fragmentElement?(null===k||void 0===k?void 0:k.getElementById(d.fragmentElement))||d.fragmentElement:d.fragment||d;const F=[void 0,void 0],w=()=>{if(F[0]&&F[1]){e.isFragment=!0;const[P,W]=F;(0,X.k)(W,e,((B,W)=>{z&&(z._fragmentSourceCodeBeforeMigration=W),v&&(B=v("fragment",B));const V=(0,X.c)(P,B,e);e=null;const k=function(e,d,v,P){if(v){return{vertexSourceCode:(1===P?"//":"")+"#define SHADER_NAME vertex:"+(v.vertexElement||v.vertex||v.spectorName||v)+"\n"+e,fragmentSourceCode:(1===P?"//":"")+"#define SHADER_NAME fragment:"+(v.fragmentElement||v.fragment||v.spectorName||v)+"\n"+d}}return{vertexSourceCode:e,fragmentSourceCode:d}}(V.vertexCode,V.fragmentCode,d,L);null===p||void 0===p||p(k.vertexSourceCode,k.fragmentSourceCode)}),B)}};g(W,"Vertex","",(d=>{(0,X.e)(e),(0,X.k)(d,e,((e,P)=>{z&&(z._rawVertexSourceCode=d,z._vertexSourceCodeBeforeMigration=P),v&&(e=v("vertex",e)),F[0]=e,w()}),B)}),L),g(V,"Fragment","Pixel",(e=>{z&&(z._rawFragmentSourceCode=e),F[1]=e,w()}),L)}function g(e,d,v,p,B,X){if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement){return void p((0,P.d)(e))}if("source:"===e.substring(0,7))return void p(e.substring(7));if("base64:"===e.substring(0,7)){return void p(window.atob(e.substring(7)))}const W=L.d.GetShadersStore(B);if(W[e+d+"Shader"])return void p(W[e+d+"Shader"]);if(v&&W[e+v+"Shader"])return void p(W[e+v+"Shader"]);let V;if(V="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:L.d.GetShadersRepository(B)+e,!(X=X||z.k))throw new Error("loadFileInjection is not defined");X(V+"."+d.toLowerCase()+".fx",p)}const F=(e,d,v,P)=>{try{const L=e.context?(0,p.u)(e.context):null;L&&(L.disableParallelShaderCompile=e.disableParallelCompilation);const B=e.existingPipelineContext||d(e.shaderProcessingContext);return B._name=e.name,e.name&&L&&(L.cachedPipelines[e.name]=B),v(B,e.vertex,e.fragment,!!e.createAsRaw,"","",e.rebuildRebind,e.defines,e.transformFeedbackVaryings,"",(()=>{P(B,(()=>{var d;null===(d=e.onRenderingStateCompiled)||void 0===d||d.call(e,B)}))})),B}catch(L){throw B.c.Error("Error compiling effect"),L}}},12321:(e,d,v)=>{v.r(d),v.d(d,{Effect:()=>z});var P=v(12248),p=v(12253),L=v(12328),B=v(12334),X=v(12314);class z{static get ShadersRepository(){return L.d.ShadersRepository}static set ShadersRepository(e){L.d.ShadersRepository=e}get W(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new P.d),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(e,d,v){let p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,L=arguments.length>4?arguments[4]:void 0,X=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,W=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,V=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,k=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,g=arguments.length>9?arguments[9]:void 0,F=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",w=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,G=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new P.d,this.onErrorObservable=new P.d,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=e,this._key=F;const U=this._key.replace(/\r/g,"").replace(/\n/g,"|");let D;if(d.attributes){const e=d;if(this._engine=v,this._attributesNames=e.attributes,this._uniformsNames=e.uniformsNames.concat(e.samplers),this._samplerList=e.samplers.slice(),this.defines=e.defines,this.onError=e.onError,this.onCompiled=e.onCompiled,this._fallbacks=e.fallbacks,this._indexParameters=e.indexParameters,this._transformFeedbackVaryings=e.transformFeedbackVaryings||null,this._multiTarget=!!e.multiTarget,this._shaderLanguage=e.shaderLanguage??0,this._disableParallelShaderCompilation=!!e.disableParallelShaderCompilation,e.uniformBuffersNames){this._uniformBuffersNamesList=e.uniformBuffersNames.slice();for(let d=0;d<e.uniformBuffersNames.length;d++)this._uniformBuffersNames[e.uniformBuffersNames[d]]=d}this._processFinalCode=e.processFinalCode??null,this._processCodeAfterIncludes=e.processCodeAfterIncludes??void 0,G=e.extraInitializationsAsync,D=e.existingPipelineContext}else this._engine=L,this.defines=null==X?"":X,this._uniformsNames=v.concat(p),this._samplerList=p?p.slice():[],this._attributesNames=d,this._uniformBuffersNamesList=[],this._shaderLanguage=w,this.onError=k,this.onCompiled=V,this._indexParameters=g,this._fallbacks=W;"WEBGL2"===this._engine.shaderPlatformName&&(D=(0,B.e)(U,this._engine._gl)??D),this._attributeLocationByName={},this.uniqueId=z._UniqueIdSeed++,D?(this._pipelineContext=D,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,G),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.W||this.dispose(!0)}))}async _processShaderCodeAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,P=arguments.length>3?arguments[3]:void 0;P&&await P(),this._processingContext=v||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const p={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:e??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:L.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:L.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,Wd:this._engine.Wd,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,B.b)(p,this.name,this._processFinalCode,((e,v)=>{this._vertexSourceCode=e,this._fragmentSourceCode=v,this._prepareEffect(d)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.W||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((e=>{this.executeWhenCompiled(e)}))}executeWhenCompiled(e){this.isReady()?e(this):(this.onCompileObservable.add((d=>{e(d)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(e){(0,X.g)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(d=>{this._processCompilationErrors(d,e)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var e;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,Wd:this._engine.Wd,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(e,d,v,P){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=d,this.onError=(e,d)=>{P&&P(d)},this.onCompiled=()=>{var e,d;const P=this.getEngine().scenes;if(P)for(let v=0;v<P.length;v++)P[v].markAllMaterialsAsDirty(127);null===(e=(d=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===e||e.call(d,v)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(e){if(this._pipelineContext=e,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let d=0;d<this._attributesNames.length;d++){const e=this._attributesNames[d];this._attributeLocationByName[e]=this._attributes[d]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),z.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const d=this._pipelineContext;this._isReady=!1;try{const v=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),P=v?null:this.defines,p=v?this._vertexSourceCodeOverride:this._vertexSourceCode,L=v?this._fragmentSourceCodeOverride:this._fragmentSourceCode,X=this._engine;this._pipelineContext=(0,B.d)({existingPipelineContext:e?d:null,vertex:p,fragment:L,context:"WEBGL2"===X.shaderPlatformName||"WEBGL1"===X.shaderPlatformName?X._gl:void 0,rebuildRebind:(e,d,v,P)=>this._rebuildProgram(e,d,v,P),defines:P,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:v,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:v=>{d&&!e&&this._engine._deletePipelineContext(d),v&&this._onRenderingStateCompiled(v)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(d)}catch(v){this._processCompilationErrors(v,d)}}_getShaderCodeAndErrorLine(e,d,v){const P=v?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let p=null;if(d&&e){const L=d.match(P);if(L&&2===L.length){const d=parseInt(L[1]),P=e.split("\n",-1);P.length>=d&&(p=`Offending line [${d}] in ${v?"fragment":"vertex"} code: ${P[d-1]}`)}}return[e,p]}_processCompilationErrors(e){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=e.message;const v=this._attributesNames,P=this._fallbacks;if(p.c.Error("Unable to compile effect:"),p.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),p.c.Error(`Attributes: ${v.join(" ")}`),p.c.Error("Defines:\n"+this.defines),z.LogShaderCodeOnCompilationError){var L,B;let e=null,d=null,v=null;var X;if(null!==(L=this._pipelineContext)&&void 0!==L&&L._getVertexShaderCode()&&([v,e]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),v&&(p.c.Error("Vertex code:"),p.c.Error(v))),null!==(B=this._pipelineContext)&&void 0!==B&&B._getFragmentShaderCode())[v,d]=this._getShaderCodeAndErrorLine(null===(X=this._pipelineContext)||void 0===X?void 0:X._getFragmentShaderCode(),this._compilationError,!0),v&&(p.c.Error("Fragment code:"),p.c.Error(v));e&&p.c.Error(e),d&&p.c.Error(d)}p.c.Error("Error: "+this._compilationError);const W=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};d&&(this._pipelineContext=d,this._isReady=!0,W()),P?(this._pipelineContext=null,P.hasMoreFallbacks?(this._allFallbacksProcessed=!1,p.c.Error("Trying next fallback."),this.defines=P.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,W(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,d||W())}get isSupported(){return""===this._compilationError}_bindTexture(e,d){this._engine._bindTexture(this._samplers[e],d,e)}setTexture(e,d){this._engine.setTexture(this._samplers[e],this._uniforms[e],d,e)}setTextureArray(e,d){const v=e+"Ex";if(-1===this._samplerList.indexOf(v+"0")){const P=this._samplerList.indexOf(e);for(let e=1;e<d.length;e++){const d=v+(e-1).toString();this._samplerList.splice(P+e,0,d)}let p=0;for(const e of this._samplerList)this._samplers[e]=p,p+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],d,e)}bindUniformBuffer(e,d){const v=this._uniformBuffersNames[d];void 0===v||z._BaseCache[v]===e&&this._engine._features.useUBOBindingCache||(z._BaseCache[v]=e,this._engine.bindUniformBufferBase(e,v,d))}bindUniformBlock(e,d){this._engine.bindUniformBlock(this._pipelineContext,e,d)}setInt(e,d){return this._pipelineContext.setInt(e,d),this}setInt2(e,d,v){return this._pipelineContext.setInt2(e,d,v),this}setInt3(e,d,v,P){return this._pipelineContext.setInt3(e,d,v,P),this}setInt4(e,d,v,P,p){return this._pipelineContext.setInt4(e,d,v,P,p),this}setIntArray(e,d){return this._pipelineContext.setIntArray(e,d),this}setIntArray2(e,d){return this._pipelineContext.setIntArray2(e,d),this}setIntArray3(e,d){return this._pipelineContext.setIntArray3(e,d),this}setIntArray4(e,d){return this._pipelineContext.setIntArray4(e,d),this}setUInt(e,d){return this._pipelineContext.setUInt(e,d),this}setUInt2(e,d,v){return this._pipelineContext.setUInt2(e,d,v),this}setUInt3(e,d,v,P){return this._pipelineContext.setUInt3(e,d,v,P),this}setUInt4(e,d,v,P,p){return this._pipelineContext.setUInt4(e,d,v,P,p),this}setUIntArray(e,d){return this._pipelineContext.setUIntArray(e,d),this}setUIntArray2(e,d){return this._pipelineContext.setUIntArray2(e,d),this}setUIntArray3(e,d){return this._pipelineContext.setUIntArray3(e,d),this}setUIntArray4(e,d){return this._pipelineContext.setUIntArray4(e,d),this}setFloatArray(e,d){return this._pipelineContext.setArray(e,d),this}setFloatArray2(e,d){return this._pipelineContext.setArray2(e,d),this}setFloatArray3(e,d){return this._pipelineContext.setArray3(e,d),this}setFloatArray4(e,d){return this._pipelineContext.setArray4(e,d),this}setArray(e,d){return this._pipelineContext.setArray(e,d),this}setArray2(e,d){return this._pipelineContext.setArray2(e,d),this}setArray3(e,d){return this._pipelineContext.setArray3(e,d),this}setArray4(e,d){return this._pipelineContext.setArray4(e,d),this}setMatrices(e,d){return this._pipelineContext.setMatrices(e,d),this}setMatrix(e,d){return this._pipelineContext.setMatrix(e,d),this}setMatrix3x3(e,d){return this._pipelineContext.setMatrix3x3(e,d),this}setMatrix2x2(e,d){return this._pipelineContext.setMatrix2x2(e,d),this}setFloat(e,d){return this._pipelineContext.setFloat(e,d),this}setBool(e,d){return this._pipelineContext.setInt(e,d?1:0),this}setVector2(e,d){return this._pipelineContext.setVector2(e,d),this}setFloat2(e,d,v){return this._pipelineContext.setFloat2(e,d,v),this}setVector3(e,d){return this._pipelineContext.setVector3(e,d),this}setFloat3(e,d,v,P){return this._pipelineContext.setFloat3(e,d,v,P),this}setVector4(e,d){return this._pipelineContext.setVector4(e,d),this}setQuaternion(e,d){return this._pipelineContext.setQuaternion(e,d),this}setFloat4(e,d,v,P,p){return this._pipelineContext.setFloat4(e,d,v,P,p),this}setColor3(e,d){return this._pipelineContext.setColor3(e,d),this}setColor4(e,d,v){return this._pipelineContext.setColor4(e,d,v),this}setDirectColor4(e,d){return this._pipelineContext.setDirectColor4(e,d),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(z.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,B.i)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(e,d,v){let P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;d&&(L.d.GetShadersStore(P)[`${e}PixelShader`]=d),v&&(L.d.GetShadersStore(P)[`${e}VertexShader`]=v)}static ResetCache(){z._BaseCache={}}}z.LogShaderCodeOnCompilationError=!0,z.PersistentMode=!1,z.AutomaticallyClearCodeCache=!1,z._UniqueIdSeed=0,z._BaseCache={},z.ShadersStore=L.d.ShadersStore,z.IncludesShadersStore=L.d.IncludesShadersStore},12268:(e,d,v)=>{v.d(d,{e:()=>p});const P={};function p(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!P[e])return P[e]=!0,`${e} needs to be imported before as it contains a side-effect required by your code.`}},12250:(e,d,v)=>{function P(){return"undefined"!==typeof window}function p(){return"undefined"!==typeof navigator}function L(){return"undefined"!==typeof document}function B(e){let d="",v=e.firstChild;for(;v;)3===v.nodeType&&(d+=v.textContent),v=v.nextSibling;return d}v.d(d,{d:()=>B,h:()=>L,j:()=>p,k:()=>P})},12253:(e,d,v)=>{v.d(d,{c:()=>P});class P{static _CheckLimit(e,d){let v=P._LogLimitOutputs[e];return v?v.current++:(v={limit:d,current:1},P._LogLimitOutputs[e]=v),v.current<=v.limit}static _GenerateLimitMessage(e){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const v=P._LogLimitOutputs[e];if(!v||!P.MessageLimitReached)return;const p=this._Levels[d];v.current===v.limit&&P[p.name](P.MessageLimitReached.replace(/%LIMIT%/g,""+v.limit).replace(/%TYPE%/g,p.name??""))}static _AddLogEntry(e){P._LogCache=e+P._LogCache,P.OnNewCacheEntry&&P.OnNewCacheEntry(e)}static _FormatMessage(e){const d=e=>e<10?"0"+e:""+e,v=new Date;return"["+d(v.getHours())+":"+d(v.getMinutes())+":"+d(v.getSeconds())+"]: "+e}static _LogDisabled(e,d){}static _LogEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,d=arguments.length>1?arguments[1]:void 0,v=arguments.length>2?arguments[2]:void 0;const p=Array.isArray(d)?d[0]:d;if(void 0!==v&&!P._CheckLimit(p,v))return;const L=P._FormatMessage(p),B=this._Levels[e],X=Array.isArray(d)?d.slice(1):[];B.logFunc&&B.logFunc("BJS - "+L,...X);const z=`<div style='color:${B.color}'>${L}</div><br>`;P._AddLogEntry(z),P._GenerateLimitMessage(p,e)}static get LogCache(){return P._LogCache}static ClearLogCache(){P._LogCache="",P._LogLimitOutputs={},P.errorsCount=0}static set LogLevels(e){P.Log=P._LogDisabled,P.Warn=P._LogDisabled,P.Error=P._LogDisabled;const d=[P.MessageLogLevel,P.WarningLogLevel,P.ErrorLogLevel];for(const v of d)if((e&v)===v){const e=this._Levels[v];P[e.name]=P._LogEnabled.bind(P,v)}}}P.NoneLogLevel=0,P.MessageLogLevel=1,P.WarningLogLevel=2,P.ErrorLogLevel=4,P.AllLogLevel=7,P.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",P._LogCache="",P._LogLimitOutputs={},P._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],P.errorsCount=0,P.Log=P._LogEnabled.bind(P,P.MessageLogLevel),P.Warn=P._LogEnabled.bind(P,P.WarningLogLevel),P.Error=P._LogEnabled.bind(P,P.ErrorLogLevel)},12248:(e,d,v)=>{v.d(d,{d:()=>B});const P="undefined"!==typeof WeakRef;class p{constructor(e){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0;this.initialize(e,d,v,P)}initialize(e){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0;return this.mask=e,this.skipNextObservers=d,this.target=v,this.currentTarget=P,this}}class L{constructor(e,d){let v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=e,this.mask=d,this.scope=v,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(e)}}class B{static FromPromise(e,d){const v=new B;return e.then((e=>{v.notifyObservers(e)})).catch((e=>{if(!d)throw e;d.notifyObservers(e)})),v}get observers(){return this._observers}constructor(e){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=d,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new p(0),e&&(this._onObserverAdded=e)}add(e){let d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],v=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;const p=new L(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);p.unregisterOnNextCall=v,d?this._observers.unshift(p):this._observers.push(p),this._onObserverAdded&&this._onObserverAdded(p),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(p,this._lastNotifiedValue);const B=P?new WeakRef(this):{deref:()=>this};return p._remove=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const d=B.deref();d&&(e?d.remove(p):d._remove(p))},p}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){if(!e)return!1;e._remove=null;return-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)}removeCallback(e,d){for(let v=0;v<this._observers.length;v++){const P=this._observers[v];if(!P._willBeUnregistered&&(P.callback===e&&(!d||d===P.scope)))return this._deferUnregister(P),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0))}_remove(e){let d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;const v=this._observers.indexOf(e);return-1!==v&&(d&&this._numObserversMarkedAsDeleted--,this._observers.splice(v,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e){let d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,v=arguments.length>2?arguments[2]:void 0,P=arguments.length>3?arguments[3]:void 0,p=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;const L=this._eventState;L.mask=d,L.target=v,L.currentTarget=P,L.skipNextObservers=!1,L.lastReturnValue=e,L.userInfo=p;for(const B of this._observers)if(!B._willBeUnregistered&&(B.mask&d&&(B.unregisterOnNextCall&&this._deferUnregister(B),B.scope?L.lastReturnValue=B.callback.apply(B.scope,[e,L]):L.lastReturnValue=B.callback(e,L)),L.skipNextObservers))return!1;return!0}notifyObserver(e,d){let v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=d),e._willBeUnregistered)return;const P=this._eventState;P.mask=v,P.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(d,P)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const e=this._observers.pop();e&&(e._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const e=new B;return e._observers=this._observers.slice(0),e}hasSpecificMask(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const d of this._observers)if(d.mask&e||d.mask===e)return!0;return!1}}},12314:(e,d,v)=>{v.d(d,{e:()=>p,g:()=>B});let P=[];class p{static SetImmediate(e){0===P.length&&setTimeout((()=>{const e=P;P=[];for(const d of e)d()}),1),P.push(e)}}function L(e,d,v){try{if(e())return d(),!0}catch(P){return null===v||void 0===v||v(P),!0}return!1}const B=function(e,d,v){let P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,B=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&L(e,d,v))return null;const X=setInterval((()=>{L(e,d,v)?clearInterval(X):(p-=P,p<0&&(clearInterval(X),null===v||void 0===v||v(new Error("Operation timed out after maximum retries. "+(B||"")),!0)))}),P);return()=>clearInterval(X)}}}]);