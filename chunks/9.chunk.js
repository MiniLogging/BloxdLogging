"use strict";(self.gpkvekif0vo=self.gpkvekif0vo||[]).push([[9],{12256:(a,O,i)=>{i.d(O,{e:()=>y,f:()=>D,l:()=>U,h:()=>A,o:()=>E});class H{constructor(){this.children=[]}isValid(a){return!0}process(a,O,i){let H="";if(this.line){let i=this.line;const P=O.processor;if(P){var b,G,q,Q,k,I;P.lineProcessor&&(i=P.lineProcessor(i,O.isFragment,O.processingContext));const H=(null===(b=O.processor)||void 0===b?void 0:b.attributeKeywordName)??"attribute",e=O.isFragment&&null!==(G=O.processor)&&void 0!==G&&G.varyingFragmentKeywordName?null===(q=O.processor)||void 0===q?void 0:q.varyingFragmentKeywordName:!O.isFragment&&null!==(Q=O.processor)&&void 0!==Q&&Q.varyingVertexKeywordName?null===(k=O.processor)||void 0===k?void 0:k.varyingVertexKeywordName:"varying";if(!O.isFragment&&P.attributeProcessor&&this.line.startsWith(H))i=P.attributeProcessor(this.line,a,O.processingContext);else if(P.varyingProcessor&&(null!==(I=P.varyingCheck)&&void 0!==I&&I.call(P,this.line,O.isFragment)||!P.varyingCheck&&this.line.startsWith(e)))i=P.varyingProcessor(this.line,O.isFragment,a,O.processingContext);else if(P.uniformProcessor&&P.uniformRegexp&&P.uniformRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(i=P.uniformProcessor(this.line,O.isFragment,a,O.processingContext));else if(P.uniformBufferProcessor&&P.uniformBufferRegexp&&P.uniformBufferRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(i=P.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0);else if(P.textureProcessor&&P.textureRegexp&&P.textureRegexp.test(this.line))i=P.textureProcessor(this.line,O.isFragment,a,O.processingContext);else if((P.uniformProcessor||P.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!O.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?P.uniformProcessor&&(i=P.uniformProcessor(this.line,O.isFragment,a,O.processingContext)):P.uniformBufferProcessor&&(i=P.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0)}O.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(O.lookForClosingBracketForUniformBuffer=!1,P.endOfUniformBufferProcessor&&(i=P.endOfUniformBufferProcessor(this.line,O.isFragment,O.processingContext)))}H+=i+"\n"}for(const P of this.children)H+=P.process(a,O,i);return this.additionalDefineKey&&(a[this.additionalDefineKey]=this.additionalDefineValue||"true",i[this.additionalDefineKey]=a[this.additionalDefineKey]),H}}class b{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(a){this._lines.length=0;for(const O of a){if(!O||"\r"===O)continue;if("#"===O[0]){this._lines.push(O);continue}const a=O.trim();if(!a)continue;if(a.startsWith("//")){this._lines.push(O);continue}const i=a.indexOf(";");if(-1===i)this._lines.push(a);else if(i===a.length-1)a.length>1&&this._lines.push(a);else{const a=O.split(";");for(let O=0;O<a.length;O++){let i=a[O];i&&(i=i.trim(),i&&this._lines.push(i+(O!==a.length-1?";":"")))}}}}}class G extends H{process(a,O,i){for(let H=0;H<this.children.length;H++){const b=this.children[H];if(b.isValid(a))return b.process(a,O,i)}return""}}class q extends H{isValid(a){return this.testExpression.isTrue(a)}}class Q{isTrue(a){return!0}static postfixToInfix(a){const O=[];for(const i of a)if(void 0===Q._OperatorPriority[i])O.push(i);else{const a=O[O.length-1],H=O[O.length-2];O.length-=2,O.push(`(${H}${i}${a})`)}return O[O.length-1]}static infixToPostfix(a){const O=Q._InfixToPostfixCache.get(a);if(O)return O.accessTime=Date.now(),O.result;if(!a.includes("&&")&&!a.includes("||")&&!a.includes(")")&&!a.includes("("))return[a];const i=[];let H=-1;const b=()=>{P=P.trim(),""!==P&&(i.push(P),P="")},G=a=>{H<Q._Stack.length-1&&(Q._Stack[++H]=a)},q=()=>Q._Stack[H],k=()=>-1===H?"!!INVALID EXPRESSION!!":Q._Stack[H--];let I=0,P="";for(;I<a.length;){const O=a.charAt(I),e=I<a.length-1?a.substring(I,2+I):"";if("("===O)P="",G(O);else if(")"===O){for(b();-1!==H&&"("!==q();)i.push(k());k()}else if(Q._OperatorPriority[e]>1){for(b();-1!==H&&Q._OperatorPriority[q()]>=Q._OperatorPriority[e];)i.push(k());G(e),I++}else P+=O;I++}for(b();-1!==H;)"("===q()?k():i.push(k());return Q._InfixToPostfixCache.size>=Q.InfixToPostfixCacheLimitSize&&Q.ClearCache(),Q._InfixToPostfixCache.set(a,{result:i,accessTime:Date.now()}),i}static ClearCache(){const a=Array.from(Q._InfixToPostfixCache.entries()).sort(((a,O)=>a[1].accessTime-O[1].accessTime));for(let O=0;O<Q.InfixToPostfixCacheCleanupSize;O++)Q._InfixToPostfixCache.delete(a[O][0])}}Q.InfixToPostfixCacheLimitSize=5e4,Q.InfixToPostfixCacheCleanupSize=25e3,Q._InfixToPostfixCache=new Map,Q._OperatorPriority={")":0,"(":1,"||":2,"&&":3},Q._Stack=["","","","","","","","","","","","","","","","","","","",""];class k extends Q{constructor(a){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=a,this.not=O}isTrue(a){let O=void 0!==a[this.define];return this.not&&(O=!O),O}}class I extends Q{isTrue(a){return this.leftOperand.isTrue(a)||this.rightOperand.isTrue(a)}}class P extends Q{isTrue(a){return this.leftOperand.isTrue(a)&&this.rightOperand.isTrue(a)}}class e extends Q{constructor(a,O,i){super(),this.define=a,this.operand=O,this.testValue=i}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(a){let O=!1;const i=parseInt(void 0!=a[this.define]?a[this.define]:this.define),H=parseInt(void 0!=a[this.testValue]?a[this.testValue]:this.testValue);if(isNaN(i)||isNaN(H))return!1;switch(this.operand){case">":O=i>H;break;case"<":O=i<H;break;case"<=":O=i<=H;break;case">=":O=i>=H;break;case"==":O=i===H;break;case"!=":O=i!==H}return O}}var h=i(12225),j=i(12259);const Z=/defined\s*?\((.+?)\)/g,F=/defined\s*?\[(.+?)\]/g,r=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,J=/__decl__/,ma=/light\{X\}.(\w*)/g,M=/\{X\}/g,C=[],n=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function D(a){a.processor&&a.processor.initializeShaders&&a.processor.initializeShaders(a.processingContext)}function U(a,O,i,H){var b;null!==(b=O.processor)&&void 0!==b&&b.preProcessShaderCode&&(a=O.processor.preProcessShaderCode(a,O.isFragment)),A(a,O,(a=>{O.processCodeAfterIncludes&&(a=O.processCodeAfterIncludes(O.isFragment?"fragment":"vertex",a,O.defines));const b=function(a,O,i){let H=function(a,O){var i;if(null!==(i=O.processor)&&void 0!==i&&i.noPrecision)return a;const H=O.shouldUseHighPrecisionShader;-1===a.indexOf("precision highp float")?a=H?"precision highp float;\n"+a:"precision mediump float;\n"+a:H||(a=a.replace("precision highp float","precision mediump float"));return a}(a,O);if(!O.processor)return H;if(0===O.processor.shaderLanguage&&-1!==H.indexOf("#version 3")&&(H=H.replace("#version 300 es",""),!O.processor.parseGLES3))return H;const b=O.defines,G=T(O,i);O.processor.preProcessor&&(H=O.processor.preProcessor(H,b,G,O.isFragment,O.processingContext));const q={};H=B(H,G,O,q),O.processor.postProcessor&&(H=O.processor.postProcessor(H,b,O.isFragment,O.processingContext,i?{drawBuffersExtensionDisabled:!i.getCaps().drawBuffersExtension}:{},G,q));null!==i&&void 0!==i&&i._features.needShaderCodeInlining&&(H=i.inlineShaderCode(H));return H}(a,O,H);i(b,a)}))}function y(a,O,i){return i.processor&&i.processor.finalizeShaders?i.processor.finalizeShaders(a,O,i.processingContext):{vertexCode:a,fragmentCode:O}}function w(a){const O=/defined\((.+)\)/.exec(a);if(O&&O.length)return new k(O[1].trim(),"!"===a[0]);const i=["==","!=",">=","<=","<",">"];let H="",b=0;for(H of i)if(b=a.indexOf(H),b>-1)break;if(-1===b)return new k(a);const G=a.substring(0,b).trim(),q=a.substring(b+H.length).trim();return new e(G,H,q)}function K(a,O){const i=new q,H=a.substring(0,O);let b=a.substring(O);return b=b.substring(0,(b.indexOf("//")+1||b.length+1)-1).trim(),i.testExpression="#ifdef"===H?new k(b):"#ifndef"===H?new k(b,!0):function(a){a=a.replace(Z,"defined[$1]");const O=Q.infixToPostfix(a),i=[];for(const b of O)if("||"!==b&&"&&"!==b)i.push(b);else if(i.length>=2){let a=i[i.length-1],O=i[i.length-2];i.length-=2;const H="&&"==b?new P:new I;"string"===typeof a&&(a=a.replace(F,"defined($1)")),"string"===typeof O&&(O=O.replace(F,"defined($1)")),H.leftOperand="string"===typeof O?w(O):O,H.rightOperand="string"===typeof a?w(a):a,i.push(H)}let H=i[i.length-1];return"string"===typeof H&&(H=H.replace(F,"defined($1)")),"string"===typeof H?w(H):H}(b),i}function S(a,O,i,b){let G=a.currentLine;for(;f(a,i,b);){G=a.currentLine;const q=G.substring(0,5).toLowerCase();if("#else"===q){const i=new H;return O.children.push(i),void f(a,i,b)}if("#elif"===q){const a=K(G,5);O.children.push(a),i=a}}}function f(a,O,i){for(;a.canRead;){a.lineIndex++;const b=a.currentLine;if(b.indexOf("#")>=0){const H=n.exec(b);if(H&&H.length){switch(H[0]){case"#ifdef":{const H=new G;O.children.push(H);const q=K(b,6);H.children.push(q),S(a,H,q,i);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const H=new G;O.children.push(H);const q=K(b,7);H.children.push(q),S(a,H,q,i);break}case"#if":{const H=new G,q=K(b,3);O.children.push(H),H.children.push(q),S(a,H,q,i);break}}continue}}const q=new H;if(q.line=b,O.children.push(q),"#"===b[0]&&"d"===b[1]){const a=b.replace(";","").split(" ");q.additionalDefineKey=a[1],3===a.length&&(q.additionalDefineValue=a[2])}}return!1}function B(a,O,i,G){const q=new H,Q=new b;return Q.lineIndex=-1,Q.lines=a.split("\n"),f(Q,q,G),q.process(O,i,G)}function T(a,O){var i;const H=a.defines,b={};for(const G of H){const a=G.replace("#define","").replace(";","").trim().split(" ");b[a[0]]=a.length>1?a[1]:""}return 0===(null===(i=a.processor)||void 0===i?void 0:i.shaderLanguage)&&(b.GL_ES="true"),b.__VERSION__=a.version,b[a.platformName]="true",(0,j.i)(b,null===O||void 0===O?void 0:O.isNDCHalfZRange,null===O||void 0===O?void 0:O.qb,null===O||void 0===O?void 0:O.useExactSrgbConversions),b}function A(a,O,i){let H;for(C.length=0;null!==(H=r.exec(a));)C.push(H);let b=String(a),G=[a],q=!1;for(const Q of C){let a=Q[1];if(-1!==a.indexOf("__decl__")&&(a=a.replace(J,""),O.supportsUniformBuffers&&(a=a.replace("Vertex","Ubo").replace("Fragment","Ubo")),a+="Declaration"),!O.includesShadersStore[a]){const H=O.shadersRepository+"ShadersInclude/"+a+".fx";return void E.loadFile(H,(H=>{O.includesShadersStore[a]=H,A(G.join(""),O,i)}))}{let i=O.includesShadersStore[a];if(Q[2]){const a=Q[3].split(",");for(let O=0;O<a.length;O+=2){const H=new RegExp(a[O],"g"),b=a[O+1];i=i.replace(H,b)}}if(Q[4]){const a=Q[5];if(-1!==a.indexOf("..")){const H=a.split(".."),b=parseInt(H[0]);let G=parseInt(H[1]),q=i.slice(0);i="",isNaN(G)&&(G=O.indexParameters[H[1]]);for(let a=b;a<G;a++)O.supportsUniformBuffers||(q=q.replace(ma,((a,O)=>O+"{X}"))),i+=q.replace(M,a.toString())+"\n"}else O.supportsUniformBuffers||(i=i.replace(ma,((a,O)=>O+"{X}"))),i=i.replace(M,a)}const H=[];for(const a of G){const O=a.split(Q[0]);for(let a=0;a<O.length-1;a++)H.push(O[a]),H.push(i);H.push(O[O.length-1])}G=H,q=q||i.indexOf("#include<")>=0||i.indexOf("#include <")>=0}}C.length=0,b=G.join(""),q?A(b.toString(),O,i):i(b)}const E={loadFile:(a,O,i,H,b,G)=>{throw(0,h.e)("FileTools")}}},12259:(a,O,i)=>{i.d(O,{d:()=>b,g:()=>G,i:()=>Q,l:()=>q,m:()=>k});var H=i(12225);i(12201);const b={};function G(a,O){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(O?O+"\n":"")+a}function q(a,O,i,G,q,Q,k){const I=k||b.loadFile;if(I){return I(a,O,i,G,q,Q)}throw(0,H.e)("FileTools")}function Q(a,O,i,H){if(a)return O?a.IS_NDC_HALF_ZRANGE="":delete a.IS_NDC_HALF_ZRANGE,i?a.USE_REVERSE_DEPTHBUFFER="":delete a.USE_REVERSE_DEPTHBUFFER,void(H?a.USE_EXACT_SRGB_CONVERSIONS="":delete a.USE_EXACT_SRGB_CONVERSIONS);{let a="";return O&&(a+="#define IS_NDC_HALF_ZRANGE"),i&&(a&&(a+="\n"),a+="#define USE_REVERSE_DEPTHBUFFER"),H&&(a&&(a+="\n"),a+="#define USE_EXACT_SRGB_CONVERSIONS"),a}}function k(a,O){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],H=arguments.length>3?arguments[3]:void 0;switch(a){case 3:{const a=(ArrayBuffer,new Int8Array(O));return H&&a.set(new Int8Array(H)),a}case 0:{const a=(ArrayBuffer,new Uint8Array(O));return H&&a.set(new Uint8Array(H)),a}case 4:{const a=O instanceof ArrayBuffer?new Int16Array(O):new Int16Array(i?O/2:O);return H&&a.set(new Int16Array(H)),a}case 5:case 8:case 9:case 10:case 2:{const a=O instanceof ArrayBuffer?new Uint16Array(O):new Uint16Array(i?O/2:O);return H&&a.set(new Uint16Array(H)),a}case 6:{const a=O instanceof ArrayBuffer?new Int32Array(O):new Int32Array(i?O/4:O);return H&&a.set(new Int32Array(H)),a}case 7:case 11:case 12:case 13:case 14:case 15:{const a=O instanceof ArrayBuffer?new Uint32Array(O):new Uint32Array(i?O/4:O);return H&&a.set(new Uint32Array(H)),a}case 1:{const a=O instanceof ArrayBuffer?new Float32Array(O):new Float32Array(i?O/4:O);return H&&a.set(new Float32Array(H)),a}}const b=(ArrayBuffer,new Uint8Array(O));return H&&b.set(new Uint8Array(H)),b}},12287:(a,O,i)=>{i.d(O,{c:()=>H});class H{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersRepository:H.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.ShadersStore:H.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?H.IncludesShadersStore:H.IncludesShadersStoreWGSL}}H.ShadersRepository="src/Shaders/",H.ShadersStore={},H.IncludesShadersStore={},H.ShadersRepositoryWGSL="src/ShadersWGSL/",H.ShadersStoreWGSL={},H.IncludesShadersStoreWGSL={}},12301:(a,O,i)=>{i.d(O,{c:()=>h,e:()=>M,f:()=>Z,g:()=>j,i:()=>F,l:()=>ma,n:()=>e,r:()=>I,v:()=>P,y:()=>k,C:()=>Q});class H{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.jO._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(a){a&&this.program&&a(this.program)}setEngine(a){this.jO=a}_fillEffectInformation(a,O,i,H,b,G,q,Q){const k=this.jO;if(k.supportsUniformBuffers)for(const P in O)a.bindUniformBlock(P,O[P]);let I;for(this.jO.getUniforms(this,i).forEach(((a,O)=>{H[i[O]]=a})),this._uniforms=H,I=0;I<b.length;I++){null==a.getUniform(b[I])&&(b.splice(I,1),I--)}b.forEach(((a,O)=>{G[a]=O}));for(const P of k.getAttributes(this,q))Q.push(P)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(a,O){const i=this._valueCache[a],H=O.updateFlag;return(void 0===i||i!==H)&&(this._valueCache[a]=H,!0)}_cacheFloat2(a,O,i){let H=this._valueCache[a];if(!H||2!==H.length)return H=[O,i],this._valueCache[a]=H,!0;let b=!1;return H[0]!==O&&(H[0]=O,b=!0),H[1]!==i&&(H[1]=i,b=!0),b}_cacheFloat3(a,O,i,H){let b=this._valueCache[a];if(!b||3!==b.length)return b=[O,i,H],this._valueCache[a]=b,!0;let G=!1;return b[0]!==O&&(b[0]=O,G=!0),b[1]!==i&&(b[1]=i,G=!0),b[2]!==H&&(b[2]=H,G=!0),G}_cacheFloat4(a,O,i,H,b){let G=this._valueCache[a];if(!G||4!==G.length)return G=[O,i,H,b],this._valueCache[a]=G,!0;let q=!1;return G[0]!==O&&(G[0]=O,q=!0),G[1]!==i&&(G[1]=i,q=!0),G[2]!==H&&(G[2]=H,q=!0),G[3]!==b&&(G[3]=b,q=!0),q}setInt(a,O){const i=this._valueCache[a];void 0!==i&&i===O||this.jO.setInt(this._uniforms[a],O)&&(this._valueCache[a]=O)}setInt2(a,O,i){this._cacheFloat2(a,O,i)&&(this.jO.setInt2(this._uniforms[a],O,i)||(this._valueCache[a]=null))}setInt3(a,O,i,H){this._cacheFloat3(a,O,i,H)&&(this.jO.setInt3(this._uniforms[a],O,i,H)||(this._valueCache[a]=null))}setInt4(a,O,i,H,b){this._cacheFloat4(a,O,i,H,b)&&(this.jO.setInt4(this._uniforms[a],O,i,H,b)||(this._valueCache[a]=null))}setIntArray(a,O){this._valueCache[a]=null,this.jO.setIntArray(this._uniforms[a],O)}setIntArray2(a,O){this._valueCache[a]=null,this.jO.setIntArray2(this._uniforms[a],O)}setIntArray3(a,O){this._valueCache[a]=null,this.jO.setIntArray3(this._uniforms[a],O)}setIntArray4(a,O){this._valueCache[a]=null,this.jO.setIntArray4(this._uniforms[a],O)}setUInt(a,O){const i=this._valueCache[a];void 0!==i&&i===O||this.jO.setUInt(this._uniforms[a],O)&&(this._valueCache[a]=O)}setUInt2(a,O,i){this._cacheFloat2(a,O,i)&&(this.jO.setUInt2(this._uniforms[a],O,i)||(this._valueCache[a]=null))}setUInt3(a,O,i,H){this._cacheFloat3(a,O,i,H)&&(this.jO.setUInt3(this._uniforms[a],O,i,H)||(this._valueCache[a]=null))}setUInt4(a,O,i,H,b){this._cacheFloat4(a,O,i,H,b)&&(this.jO.setUInt4(this._uniforms[a],O,i,H,b)||(this._valueCache[a]=null))}setUIntArray(a,O){this._valueCache[a]=null,this.jO.setUIntArray(this._uniforms[a],O)}setUIntArray2(a,O){this._valueCache[a]=null,this.jO.setUIntArray2(this._uniforms[a],O)}setUIntArray3(a,O){this._valueCache[a]=null,this.jO.setUIntArray3(this._uniforms[a],O)}setUIntArray4(a,O){this._valueCache[a]=null,this.jO.setUIntArray4(this._uniforms[a],O)}setArray(a,O){this._valueCache[a]=null,this.jO.setArray(this._uniforms[a],O)}setArray2(a,O){this._valueCache[a]=null,this.jO.setArray2(this._uniforms[a],O)}setArray3(a,O){this._valueCache[a]=null,this.jO.setArray3(this._uniforms[a],O)}setArray4(a,O){this._valueCache[a]=null,this.jO.setArray4(this._uniforms[a],O)}setMatrices(a,O){O&&(this._valueCache[a]=null,this.jO.setMatrices(this._uniforms[a],O))}setMatrix(a,O){this._cacheMatrix(a,O)&&(this.jO.setMatrices(this._uniforms[a],O.Cb())||(this._valueCache[a]=null))}setMatrix3x3(a,O){this._valueCache[a]=null,this.jO.setMatrix3x3(this._uniforms[a],O)}setMatrix2x2(a,O){this._valueCache[a]=null,this.jO.setMatrix2x2(this._uniforms[a],O)}setFloat(a,O){const i=this._valueCache[a];void 0!==i&&i===O||this.jO.setFloat(this._uniforms[a],O)&&(this._valueCache[a]=O)}setVector2(a,O){this._cacheFloat2(a,O.x,O.y)&&(this.jO.setFloat2(this._uniforms[a],O.x,O.y)||(this._valueCache[a]=null))}setFloat2(a,O,i){this._cacheFloat2(a,O,i)&&(this.jO.setFloat2(this._uniforms[a],O,i)||(this._valueCache[a]=null))}setVector3(a,O){this._cacheFloat3(a,O.x,O.y,O.z)&&(this.jO.setFloat3(this._uniforms[a],O.x,O.y,O.z)||(this._valueCache[a]=null))}setFloat3(a,O,i,H){this._cacheFloat3(a,O,i,H)&&(this.jO.setFloat3(this._uniforms[a],O,i,H)||(this._valueCache[a]=null))}setVector4(a,O){this._cacheFloat4(a,O.x,O.y,O.z,O.w)&&(this.jO.setFloat4(this._uniforms[a],O.x,O.y,O.z,O.w)||(this._valueCache[a]=null))}setQuaternion(a,O){this._cacheFloat4(a,O.x,O.y,O.z,O.w)&&(this.jO.setFloat4(this._uniforms[a],O.x,O.y,O.z,O.w)||(this._valueCache[a]=null))}setFloat4(a,O,i,H,b){this._cacheFloat4(a,O,i,H,b)&&(this.jO.setFloat4(this._uniforms[a],O,i,H,b)||(this._valueCache[a]=null))}setColor3(a,O){this._cacheFloat3(a,O.r,O.g,O.b)&&(this.jO.setFloat3(this._uniforms[a],O.r,O.g,O.b)||(this._valueCache[a]=null))}setColor4(a,O,i){this._cacheFloat4(a,O.r,O.g,O.b,i)&&(this.jO.setFloat4(this._uniforms[a],O.r,O.g,O.b,i)||(this._valueCache[a]=null))}setDirectColor4(a,O){this._cacheFloat4(a,O.r,O.g,O.b,O.a)&&(this.jO.setFloat4(this._uniforms[a],O.r,O.g,O.b,O.a)||(this._valueCache[a]=null))}_getVertexShaderCode(){return this.vertexShader?this.jO._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.jO._getShaderSource(this.fragmentShader):null}}var b=i(12259);const G=new WeakMap,q={_webGLVersion:2,cachedPipelines:{}};function Q(a){let O=G.get(a);if(!O){if(!a)return q;O={_webGLVersion:a.TEXTURE_BINDING_3D?2:1,_context:a,parallelShaderCompile:a.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},G.set(a,O)}return O}function k(a){G.delete(a)}function I(a,O,i,H,b,G){const q=Q(H);G||(G=q._createShaderProgramInjection??h);return G(a,J(O,"vertex",H,q._contextWasLost),J(i,"fragment",H,q._contextWasLost),H,b,q.validateShaderPrograms)}function P(a,O,i,H,b){let G=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,q=arguments.length>6?arguments[6]:void 0;const k=Q(b);q||(q=k._createShaderProgramInjection??h);const I=k._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return q(a,r(O,"vertex",H,I,b,k._contextWasLost),r(i,"fragment",H,I,b,k._contextWasLost),b,G,k.validateShaderPrograms)}function e(a,O){const i=new H,b=Q(a);return b.parallelShaderCompile&&!b.disableParallelShaderCompile&&(i.isParallelCompiled=!0),i.context=b._context,i}function h(a,O,i,H){let b=arguments.length>5?arguments[5]:void 0;const G=H.createProgram();if(a.program=G,!G)throw new Error("Unable to create program");return H.attachShader(G,O),H.attachShader(G,i),H.linkProgram(G),a.context=H,a.vertexShader=O,a.fragmentShader=i,a.isParallelCompiled||Z(a,H,b),G}function j(a,O,i){const H=a;if(H._isDisposed)return!1;const b=Q(O);return!!(b&&b.parallelShaderCompile&&b.parallelShaderCompile.COMPLETION_STATUS_KHR&&H.program&&O.getProgramParameter(H.program,b.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(Z(H,O,i),!0)}function Z(a,O,i){const H=a.context,b=a.vertexShader,G=a.fragmentShader,q=a.program;if(!H.getProgramParameter(q,H.LINK_STATUS)){if(!O.getShaderParameter(b,O.COMPILE_STATUS)){const i=O.getShaderInfoLog(b);if(i)throw a.vertexCompilationError=i,new Error("VERTEX SHADER "+i)}if(!O.getShaderParameter(G,O.COMPILE_STATUS)){const i=O.getShaderInfoLog(G);if(i)throw a.fragmentCompilationError=i,new Error("FRAGMENT SHADER "+i)}const i=H.getProgramInfoLog(q);if(i)throw a.programLinkError=i,new Error(i)}if(i){H.validateProgram(q);if(!H.getProgramParameter(q,H.VALIDATE_STATUS)){const O=H.getProgramInfoLog(q);if(O)throw a.programValidationError=O,new Error(O)}}H.deleteShader(b),H.deleteShader(G),a.vertexShader=void 0,a.fragmentShader=void 0,a.onCompiled&&(a.onCompiled(),a.onCompiled=void 0)}function F(a,O,i,H,b,G,q,k,e){let h=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0,Z=arguments.length>12?arguments[12]:void 0;const F=Q(a.context);j||(j=F.createRawShaderProgramInjection??I),Z||(Z=F.createShaderProgramInjection??P);const r=a;r.program=H?j(r,O,i,r.context,e):Z(r,O,i,k,r.context,e),r.program.__SPECTOR_rebuildProgram=q,h()}function r(a,O,i,H,G,q){return J((0,b.g)(a,i,H),O,G,q)}function J(a,O,i,H){const b=i.createShader("vertex"===O?i.VERTEX_SHADER:i.FRAGMENT_SHADER);if(!b){let a=i.NO_ERROR,b=i.NO_ERROR;for(;(b=i.getError())!==i.NO_ERROR;)a=b;throw new Error(`Something went wrong while creating a gl ${O} shader object. gl error=${a}, gl isContextLost=${i.isContextLost()}, _contextWasLost=${H}`)}return i.shaderSource(b,a),i.compileShader(b),b}function ma(a,O){O.useProgram(a)}function M(a,O){const i=a;if(!i.isParallelCompiled)return void O(a);const H=i.onCompiled;i.onCompiled=()=>{null===H||void 0===H||H(),O(a)}}},12293:(a,O,i)=>{i.d(O,{b:()=>e,d:()=>j,h:()=>I,i:()=>P});var H=i(12201),b=i(12301),G=i(12287),q=i(12209),Q=i(12256),k=i(12259);function I(a,O){return(0,b.C)(O).cachedPipelines[a]}function P(a){const O=a._name,i=a.context;if(O&&i){const a=(0,b.C)(i),H=a.cachedPipelines[O];null===H||void 0===H||H.dispose(),delete a.cachedPipelines[O]}}function e(a,O,i,b,G,q,k){let I,P;const e=(0,H.k)()?null===q||void 0===q?void 0:q.getHostDocument():null;I="string"===typeof O?O:O.vertexSource?"source:"+O.vertexSource:O.vertexElement?(null===e||void 0===e?void 0:e.getElementById(O.vertexElement))||O.vertexElement:O.vertex||O,P="string"===typeof O?O:O.fragmentSource?"source:"+O.fragmentSource:O.fragmentElement?(null===e||void 0===e?void 0:e.getElementById(O.fragmentElement))||O.fragmentElement:O.fragment||O;const j=[void 0,void 0],Z=()=>{if(j[0]&&j[1]){a.isFragment=!0;const[H,I]=j;(0,Q.l)(I,a,((q,I)=>{k&&(k._fragmentSourceCodeBeforeMigration=I),i&&(q=i("fragment",q));const P=(0,Q.e)(H,q,a);a=null;const e=function(a,O,i,H){if(i){return{vertexSourceCode:(1===H?"//":"")+"#define SHADER_NAME vertex:"+(i.vertexElement||i.vertex||i.spectorName||i)+"\n"+a,fragmentSourceCode:(1===H?"//":"")+"#define SHADER_NAME fragment:"+(i.fragmentElement||i.fragment||i.spectorName||i)+"\n"+O}}return{vertexSourceCode:a,fragmentSourceCode:O}}(P.vertexCode,P.fragmentCode,O,G);null===b||void 0===b||b(e.vertexSourceCode,e.fragmentSourceCode)}),q)}};h(I,"Vertex","",(O=>{(0,Q.f)(a),(0,Q.l)(O,a,((a,H)=>{k&&(k._rawVertexSourceCode=O,k._vertexSourceCodeBeforeMigration=H),i&&(a=i("vertex",a)),j[0]=a,Z()}),q)}),G),h(P,"Fragment","Pixel",(a=>{k&&(k._rawFragmentSourceCode=a),j[1]=a,Z()}),G)}function h(a,O,i,b,q,Q){if("undefined"!==typeof HTMLElement&&a instanceof HTMLElement){return void b((0,H.d)(a))}if("source:"===a.substring(0,7))return void b(a.substring(7));if("base64:"===a.substring(0,7)){return void b(window.atob(a.substring(7)))}const I=G.c.GetShadersStore(q);if(I[a+O+"Shader"])return void b(I[a+O+"Shader"]);if(i&&I[a+i+"Shader"])return void b(I[a+i+"Shader"]);let P;if(P="."===a[0]||"/"===a[0]||a.indexOf("http")>-1?a:G.c.GetShadersRepository(q)+a,!(Q=Q||k.l))throw new Error("loadFileInjection is not defined");Q(P+"."+O.toLowerCase()+".fx",b)}const j=(a,O,i,H)=>{try{const G=a.context?(0,b.C)(a.context):null;G&&(G.disableParallelShaderCompile=a.disableParallelCompilation);const q=a.existingPipelineContext||O(a.shaderProcessingContext);return q._name=a.name,a.name&&G&&(G.cachedPipelines[a.name]=q),i(q,a.vertex,a.fragment,!!a.createAsRaw,"","",a.rebuildRebind,a.defines,a.transformFeedbackVaryings,"",(()=>{H(q,(()=>{var O;null===(O=a.onRenderingStateCompiled)||void 0===O||O.call(a,q)}))})),q}catch(G){throw q.c.Error("Error compiling effect"),G}}},12281:(a,O,i)=>{i.r(O),i.d(O,{Effect:()=>k});var H=i(12193),b=i(12209),G=i(12287),q=i(12293),Q=i(12265);class k{static get ShadersRepository(){return G.c.ShadersRepository}static set ShadersRepository(a){G.c.ShadersRepository=a}get h(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new H.e),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(a,O,i){let b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,G=arguments.length>4?arguments[4]:void 0,Q=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,I=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,P=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,e=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9?arguments[9]:void 0,j=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",Z=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,F=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new H.e,this.onErrorObservable=new H.e,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=a,this._key=j;const r=this._key.replace(/\r/g,"").replace(/\n/g,"|");let J;if(O.attributes){const a=O;if(this._engine=i,this._attributesNames=a.attributes,this._uniformsNames=a.uniformsNames.concat(a.samplers),this._samplerList=a.samplers.slice(),this.defines=a.defines,this.onError=a.onError,this.onCompiled=a.onCompiled,this._fallbacks=a.fallbacks,this._indexParameters=a.indexParameters,this._transformFeedbackVaryings=a.transformFeedbackVaryings||null,this._multiTarget=!!a.multiTarget,this._shaderLanguage=a.shaderLanguage??0,this._disableParallelShaderCompilation=!!a.disableParallelShaderCompilation,a.uniformBuffersNames){this._uniformBuffersNamesList=a.uniformBuffersNames.slice();for(let O=0;O<a.uniformBuffersNames.length;O++)this._uniformBuffersNames[a.uniformBuffersNames[O]]=O}this._processFinalCode=a.processFinalCode??null,this._processCodeAfterIncludes=a.processCodeAfterIncludes??void 0,F=a.extraInitializationsAsync,J=a.existingPipelineContext}else this._engine=G,this.defines=null==Q?"":Q,this._uniformsNames=i.concat(b),this._samplerList=b?b.slice():[],this._attributesNames=O,this._uniformBuffersNamesList=[],this._shaderLanguage=Z,this.onError=e,this.onCompiled=P,this._indexParameters=h,this._fallbacks=I;"WEBGL2"===this._engine.shaderPlatformName&&(J=(0,q.h)(r,this._engine._gl)??J),this._attributeLocationByName={},this.uniqueId=k._UniqueIdSeed++,J?(this._pipelineContext=J,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,F),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.h||this.dispose(!0)}))}async _processShaderCodeAsync(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,H=arguments.length>3?arguments[3]:void 0;H&&await H(),this._processingContext=i||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const b={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:a??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:G.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:G.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,qb:this._engine.qb,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,q.b)(b,this.name,this._processFinalCode,((a,i)=>{this._vertexSourceCode=a,this._fragmentSourceCode=i,this._prepareEffect(O)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.h||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(a){return this._attributes[a]}getAttributeLocationByName(a){return this._attributeLocationByName[a]}getAttributesCount(){return this._attributes.length}getUniformIndex(a){return this._uniformsNames.indexOf(a)}getUniform(a){return this._uniforms[a]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((a=>{this.executeWhenCompiled(a)}))}executeWhenCompiled(a){this.isReady()?a(this):(this.onCompileObservable.add((O=>{a(O)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(a){(0,Q.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(O=>{this._processCompilationErrors(O,a)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var a;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(a=this._pipelineContext)||void 0===a?void 0:a._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var a;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(a=this._pipelineContext)||void 0===a?void 0:a._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,qb:this._engine.qb,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(a,O,i,H){this._isReady=!1,this._vertexSourceCodeOverride=a,this._fragmentSourceCodeOverride=O,this.onError=(a,O)=>{H&&H(O)},this.onCompiled=()=>{var a,O;const H=this.getEngine().scenes;if(H)for(let i=0;i<H.length;i++)H[i].markAllMaterialsAsDirty(127);null===(a=(O=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===a||a.call(O,i)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(a){if(this._pipelineContext=a,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let O=0;O<this._attributesNames.length;O++){const a=this._attributesNames[O];this._attributeLocationByName[a]=this._attributes[O]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),k.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=this._pipelineContext;this._isReady=!1;try{const i=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),H=i?null:this.defines,b=i?this._vertexSourceCodeOverride:this._vertexSourceCode,G=i?this._fragmentSourceCodeOverride:this._fragmentSourceCode,Q=this._engine;this._pipelineContext=(0,q.d)({existingPipelineContext:a?O:null,vertex:b,fragment:G,context:"WEBGL2"===Q.shaderPlatformName||"WEBGL1"===Q.shaderPlatformName?Q._gl:void 0,rebuildRebind:(a,O,i,H)=>this._rebuildProgram(a,O,i,H),defines:H,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:i,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:i=>{O&&!a&&this._engine._deletePipelineContext(O),i&&this._onRenderingStateCompiled(i)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(O)}catch(i){this._processCompilationErrors(i,O)}}_getShaderCodeAndErrorLine(a,O,i){const H=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let b=null;if(O&&a){const G=O.match(H);if(G&&2===G.length){const O=parseInt(G[1]),H=a.split("\n",-1);H.length>=O&&(b=`Offending line [${O}] in ${i?"fragment":"vertex"} code: ${H[O-1]}`)}}return[a,b]}_processCompilationErrors(a){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=a.message;const i=this._attributesNames,H=this._fallbacks;if(b.c.Error("Unable to compile effect:"),b.c.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),b.c.Error(`Attributes: ${i.join(" ")}`),b.c.Error("Defines:\n"+this.defines),k.LogShaderCodeOnCompilationError){var G,q;let a=null,O=null,i=null;var Q;if(null!==(G=this._pipelineContext)&&void 0!==G&&G._getVertexShaderCode()&&([i,a]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),i&&(b.c.Error("Vertex code:"),b.c.Error(i))),null!==(q=this._pipelineContext)&&void 0!==q&&q._getFragmentShaderCode())[i,O]=this._getShaderCodeAndErrorLine(null===(Q=this._pipelineContext)||void 0===Q?void 0:Q._getFragmentShaderCode(),this._compilationError,!0),i&&(b.c.Error("Fragment code:"),b.c.Error(i));a&&b.c.Error(a),O&&b.c.Error(O)}b.c.Error("Error: "+this._compilationError);const I=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};O&&(this._pipelineContext=O,this._isReady=!0,I()),H?(this._pipelineContext=null,H.hasMoreFallbacks?(this._allFallbacksProcessed=!1,b.c.Error("Trying next fallback."),this.defines=H.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,I(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,O||I())}get isSupported(){return""===this._compilationError}_bindTexture(a,O){this._engine._bindTexture(this._samplers[a],O,a)}setTexture(a,O){this._engine.setTexture(this._samplers[a],this._uniforms[a],O,a)}setTextureArray(a,O){const i=a+"Ex";if(-1===this._samplerList.indexOf(i+"0")){const H=this._samplerList.indexOf(a);for(let a=1;a<O.length;a++){const O=i+(a-1).toString();this._samplerList.splice(H+a,0,O)}let b=0;for(const a of this._samplerList)this._samplers[a]=b,b+=1}this._engine.setTextureArray(this._samplers[a],this._uniforms[a],O,a)}bindUniformBuffer(a,O){const i=this._uniformBuffersNames[O];void 0===i||k._BaseCache[i]===a&&this._engine._features.useUBOBindingCache||(k._BaseCache[i]=a,this._engine.bindUniformBufferBase(a,i,O))}bindUniformBlock(a,O){this._engine.bindUniformBlock(this._pipelineContext,a,O)}setInt(a,O){return this._pipelineContext.setInt(a,O),this}setInt2(a,O,i){return this._pipelineContext.setInt2(a,O,i),this}setInt3(a,O,i,H){return this._pipelineContext.setInt3(a,O,i,H),this}setInt4(a,O,i,H,b){return this._pipelineContext.setInt4(a,O,i,H,b),this}setIntArray(a,O){return this._pipelineContext.setIntArray(a,O),this}setIntArray2(a,O){return this._pipelineContext.setIntArray2(a,O),this}setIntArray3(a,O){return this._pipelineContext.setIntArray3(a,O),this}setIntArray4(a,O){return this._pipelineContext.setIntArray4(a,O),this}setUInt(a,O){return this._pipelineContext.setUInt(a,O),this}setUInt2(a,O,i){return this._pipelineContext.setUInt2(a,O,i),this}setUInt3(a,O,i,H){return this._pipelineContext.setUInt3(a,O,i,H),this}setUInt4(a,O,i,H,b){return this._pipelineContext.setUInt4(a,O,i,H,b),this}setUIntArray(a,O){return this._pipelineContext.setUIntArray(a,O),this}setUIntArray2(a,O){return this._pipelineContext.setUIntArray2(a,O),this}setUIntArray3(a,O){return this._pipelineContext.setUIntArray3(a,O),this}setUIntArray4(a,O){return this._pipelineContext.setUIntArray4(a,O),this}setFloatArray(a,O){return this._pipelineContext.setArray(a,O),this}setFloatArray2(a,O){return this._pipelineContext.setArray2(a,O),this}setFloatArray3(a,O){return this._pipelineContext.setArray3(a,O),this}setFloatArray4(a,O){return this._pipelineContext.setArray4(a,O),this}setArray(a,O){return this._pipelineContext.setArray(a,O),this}setArray2(a,O){return this._pipelineContext.setArray2(a,O),this}setArray3(a,O){return this._pipelineContext.setArray3(a,O),this}setArray4(a,O){return this._pipelineContext.setArray4(a,O),this}setMatrices(a,O){return this._pipelineContext.setMatrices(a,O),this}setMatrix(a,O){return this._pipelineContext.setMatrix(a,O),this}setMatrix3x3(a,O){return this._pipelineContext.setMatrix3x3(a,O),this}setMatrix2x2(a,O){return this._pipelineContext.setMatrix2x2(a,O),this}setFloat(a,O){return this._pipelineContext.setFloat(a,O),this}setBool(a,O){return this._pipelineContext.setInt(a,O?1:0),this}setVector2(a,O){return this._pipelineContext.setVector2(a,O),this}setFloat2(a,O,i){return this._pipelineContext.setFloat2(a,O,i),this}setVector3(a,O){return this._pipelineContext.setVector3(a,O),this}setFloat3(a,O,i,H){return this._pipelineContext.setFloat3(a,O,i,H),this}setVector4(a,O){return this._pipelineContext.setVector4(a,O),this}setQuaternion(a,O){return this._pipelineContext.setQuaternion(a,O),this}setFloat4(a,O,i,H,b){return this._pipelineContext.setFloat4(a,O,i,H,b),this}setColor3(a,O){return this._pipelineContext.setColor3(a,O),this}setColor4(a,O,i){return this._pipelineContext.setColor4(a,O,i),this}setDirectColor4(a,O){return this._pipelineContext.setDirectColor4(a,O),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(k.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,q.i)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(a,O,i){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;O&&(G.c.GetShadersStore(H)[`${a}PixelShader`]=O),i&&(G.c.GetShadersStore(H)[`${a}VertexShader`]=i)}static ResetCache(){k._BaseCache={}}}k.LogShaderCodeOnCompilationError=!0,k.PersistentMode=!1,k.AutomaticallyClearCodeCache=!1,k._UniqueIdSeed=0,k._BaseCache={},k.ShadersStore=G.c.ShadersStore,k.IncludesShadersStore=G.c.IncludesShadersStore},12225:(a,O,i)=>{i.d(O,{e:()=>b});const H={};function b(a){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!H[a])return H[a]=!0,`${a} needs to be imported before as it contains a side-effect required by your code.`}},12201:(a,O,i)=>{function H(){return"undefined"!==typeof window}function b(){return"undefined"!==typeof navigator}function G(){return"undefined"!==typeof document}function q(a){let O="",i=a.firstChild;for(;i;)3===i.nodeType&&(O+=i.textContent),i=i.nextSibling;return O}i.d(O,{d:()=>q,g:()=>G,j:()=>b,k:()=>H})},12209:(a,O,i)=>{i.d(O,{c:()=>H});class H{static _CheckLimit(a,O){let i=H._LogLimitOutputs[a];return i?i.current++:(i={limit:O,current:1},H._LogLimitOutputs[a]=i),i.current<=i.limit}static _GenerateLimitMessage(a){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=H._LogLimitOutputs[a];if(!i||!H.MessageLimitReached)return;const b=this._Levels[O];i.current===i.limit&&H[b.name](H.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,b.name??""))}static _AddLogEntry(a){H._LogCache=a+H._LogCache,H.OnNewCacheEntry&&H.OnNewCacheEntry(a)}static _FormatMessage(a){const O=a=>a<10?"0"+a:""+a,i=new Date;return"["+O(i.getHours())+":"+O(i.getMinutes())+":"+O(i.getSeconds())+"]: "+a}static _LogDisabled(a,O){}static _LogEnabled(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,O=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const b=Array.isArray(O)?O[0]:O;if(void 0!==i&&!H._CheckLimit(b,i))return;const G=H._FormatMessage(b),q=this._Levels[a],Q=Array.isArray(O)?O.slice(1):[];q.logFunc&&q.logFunc("BJS - "+G,...Q);const k=`<div style='color:${q.color}'>${G}</div><br>`;H._AddLogEntry(k),H._GenerateLimitMessage(b,a)}static get LogCache(){return H._LogCache}static ClearLogCache(){H._LogCache="",H._LogLimitOutputs={},H.errorsCount=0}static set LogLevels(a){H.Log=H._LogDisabled,H.Warn=H._LogDisabled,H.Error=H._LogDisabled;const O=[H.MessageLogLevel,H.WarningLogLevel,H.ErrorLogLevel];for(const i of O)if((a&i)===i){const a=this._Levels[i];H[a.name]=H._LogEnabled.bind(H,i)}}}H.NoneLogLevel=0,H.MessageLogLevel=1,H.WarningLogLevel=2,H.ErrorLogLevel=4,H.AllLogLevel=7,H.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",H._LogCache="",H._LogLimitOutputs={},H._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],H.errorsCount=0,H.Log=H._LogEnabled.bind(H,H.MessageLogLevel),H.Warn=H._LogEnabled.bind(H,H.WarningLogLevel),H.Error=H._LogEnabled.bind(H,H.ErrorLogLevel)},12193:(a,O,i)=>{i.d(O,{e:()=>q});const H="undefined"!==typeof WeakRef;class b{constructor(a){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;this.initialize(a,O,i,H)}initialize(a){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0;return this.mask=a,this.skipNextObservers=O,this.target=i,this.currentTarget=H,this}}class G{constructor(a,O){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=a,this.mask=O,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(a)}}class q{static FromPromise(a,O){const i=new q;return a.then((a=>{i.notifyObservers(a)})).catch((a=>{if(!O)throw a;O.notifyObservers(a)})),i}get observers(){return this._observers}constructor(a){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=O,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new b(0),a&&(this._onObserverAdded=a)}add(a){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!a)return null;const b=new G(a,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);b.unregisterOnNextCall=i,O?this._observers.unshift(b):this._observers.push(b),this._onObserverAdded&&this._onObserverAdded(b),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(b,this._lastNotifiedValue);const q=H?new WeakRef(this):{deref:()=>this};return b._remove=function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=q.deref();O&&(a?O.remove(b):O._remove(b))},b}addOnce(a){return this.add(a,void 0,void 0,void 0,!0)}remove(a){if(!a)return!1;a._remove=null;return-1!==this._observers.indexOf(a)&&(this._deferUnregister(a),!0)}removeCallback(a,O){for(let i=0;i<this._observers.length;i++){const H=this._observers[i];if(!H._willBeUnregistered&&(H.callback===a&&(!O||O===H.scope)))return this._deferUnregister(H),!0}return!1}_deferUnregister(a){a._willBeUnregistered||(this._numObserversMarkedAsDeleted++,a.unregisterOnNextCall=!1,a._willBeUnregistered=!0,setTimeout((()=>{this._remove(a)}),0))}_remove(a){let O=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!a)return!1;const i=this._observers.indexOf(a);return-1!==i&&(O&&this._numObserversMarkedAsDeleted--,this._observers.splice(i,1),!0)}makeObserverTopPriority(a){this._remove(a,!1),this._observers.unshift(a)}makeObserverBottomPriority(a){this._remove(a,!1),this._observers.push(a)}notifyObservers(a){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2?arguments[2]:void 0,H=arguments.length>3?arguments[3]:void 0,b=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=a),!this._observers.length)return!0;const G=this._eventState;G.mask=O,G.target=i,G.currentTarget=H,G.skipNextObservers=!1,G.lastReturnValue=a,G.userInfo=b;for(const q of this._observers)if(!q._willBeUnregistered&&(q.mask&O&&(q.unregisterOnNextCall&&this._deferUnregister(q),q.scope?G.lastReturnValue=q.callback.apply(q.scope,[a,G]):G.lastReturnValue=q.callback(a,G)),G.skipNextObservers))return!1;return!0}notifyObserver(a,O){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=O),a._willBeUnregistered)return;const H=this._eventState;H.mask=i,H.skipNextObservers=!1,a.unregisterOnNextCall&&this._deferUnregister(a),a.callback(O,H)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const a=this._observers.pop();a&&(a._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const a=new q;return a._observers=this._observers.slice(0),a}hasSpecificMask(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const O of this._observers)if(O.mask&a||O.mask===a)return!0;return!1}}},12265:(a,O,i)=>{i.d(O,{b:()=>b,f:()=>q});let H=[];class b{static SetImmediate(a){0===H.length&&setTimeout((()=>{const a=H;H=[];for(const O of a)O()}),1),H.push(a)}}function G(a,O,i){try{if(a())return O(),!0}catch(H){return null===i||void 0===i||i(H),!0}return!1}const q=function(a,O,i){let H=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,b=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,q=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&G(a,O,i))return null;const Q=setInterval((()=>{G(a,O,i)?clearInterval(Q):(b-=H,b<0&&(clearInterval(Q),null===i||void 0===i||i(new Error("Operation timed out after maximum retries. "+(q||"")),!0)))}),H);return()=>clearInterval(Q)}}}]);