"use strict";(self.agop5zpabxv=self.agop5zpabxv||[]).push([[9],{12226:(H,u,J)=>{J.d(u,{e:()=>Y,f:()=>L,m:()=>Z,j:()=>n,o:()=>V});class O{constructor(){this.children=[]}isValid(H){return!0}process(H,u,J){let O="";if(this.line){let J=this.line;const d=u.processor;if(d){var U,h,w,g,B,b;d.lineProcessor&&(J=d.lineProcessor(J,u.isFragment,u.processingContext));const O=(null===(U=u.processor)||void 0===U?void 0:U.attributeKeywordName)??"attribute",G=u.isFragment&&null!==(h=u.processor)&&void 0!==h&&h.varyingFragmentKeywordName?null===(w=u.processor)||void 0===w?void 0:w.varyingFragmentKeywordName:!u.isFragment&&null!==(g=u.processor)&&void 0!==g&&g.varyingVertexKeywordName?null===(B=u.processor)||void 0===B?void 0:B.varyingVertexKeywordName:"varying";if(!u.isFragment&&d.attributeProcessor&&this.line.startsWith(O))J=d.attributeProcessor(this.line,H,u.processingContext);else if(d.varyingProcessor&&(null!==(b=d.varyingCheck)&&void 0!==b&&b.call(d,this.line,u.isFragment)||!d.varyingCheck&&this.line.startsWith(G)))J=d.varyingProcessor(this.line,u.isFragment,H,u.processingContext);else if(d.uniformProcessor&&d.uniformRegexp&&d.uniformRegexp.test(this.line))u.lookForClosingBracketForUniformBuffer||(J=d.uniformProcessor(this.line,u.isFragment,H,u.processingContext));else if(d.uniformBufferProcessor&&d.uniformBufferRegexp&&d.uniformBufferRegexp.test(this.line))u.lookForClosingBracketForUniformBuffer||(J=d.uniformBufferProcessor(this.line,u.isFragment,u.processingContext),u.lookForClosingBracketForUniformBuffer=!0);else if(d.textureProcessor&&d.textureRegexp&&d.textureRegexp.test(this.line))J=d.textureProcessor(this.line,u.isFragment,H,u.processingContext);else if((d.uniformProcessor||d.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!u.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?d.uniformProcessor&&(J=d.uniformProcessor(this.line,u.isFragment,H,u.processingContext)):d.uniformBufferProcessor&&(J=d.uniformBufferProcessor(this.line,u.isFragment,u.processingContext),u.lookForClosingBracketForUniformBuffer=!0)}u.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(u.lookForClosingBracketForUniformBuffer=!1,d.endOfUniformBufferProcessor&&(J=d.endOfUniformBufferProcessor(this.line,u.isFragment,u.processingContext)))}O+=J+"\n"}for(const d of this.children)O+=d.process(H,u,J);return this.additionalDefineKey&&(H[this.additionalDefineKey]=this.additionalDefineValue||"true",J[this.additionalDefineKey]=H[this.additionalDefineKey]),O}}class U{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(H){this._lines.length=0;for(const u of H){if(!u||"\r"===u)continue;if("#"===u[0]){this._lines.push(u);continue}const H=u.trim();if(!H)continue;if(H.startsWith("//")){this._lines.push(u);continue}const J=H.indexOf(";");if(-1===J)this._lines.push(H);else if(J===H.length-1)H.length>1&&this._lines.push(H);else{const H=u.split(";");for(let u=0;u<H.length;u++){let J=H[u];J&&(J=J.trim(),J&&this._lines.push(J+(u!==H.length-1?";":"")))}}}}}class h extends O{process(H,u,J){for(let O=0;O<this.children.length;O++){const U=this.children[O];if(U.isValid(H))return U.process(H,u,J)}return""}}class w extends O{isValid(H){return this.testExpression.isTrue(H)}}class g{isTrue(H){return!0}static postfixToInfix(H){const u=[];for(const J of H)if(void 0===g._OperatorPriority[J])u.push(J);else{const H=u[u.length-1],O=u[u.length-2];u.length-=2,u.push(`(${O}${J}${H})`)}return u[u.length-1]}static infixToPostfix(H){const u=g._InfixToPostfixCache.get(H);if(u)return u.accessTime=Date.now(),u.result;if(!H.includes("&&")&&!H.includes("||")&&!H.includes(")")&&!H.includes("("))return[H];const J=[];let O=-1;const U=()=>{d=d.trim(),""!==d&&(J.push(d),d="")},h=H=>{O<g._Stack.length-1&&(g._Stack[++O]=H)},w=()=>g._Stack[O],B=()=>-1===O?"!!INVALID EXPRESSION!!":g._Stack[O--];let b=0,d="";for(;b<H.length;){const u=H.charAt(b),G=b<H.length-1?H.substring(b,2+b):"";if("("===u)d="",h(u);else if(")"===u){for(U();-1!==O&&"("!==w();)J.push(B());B()}else if(g._OperatorPriority[G]>1){for(U();-1!==O&&g._OperatorPriority[w()]>=g._OperatorPriority[G];)J.push(B());h(G),b++}else d+=u;b++}for(U();-1!==O;)"("===w()?B():J.push(B());return g._InfixToPostfixCache.size>=g.InfixToPostfixCacheLimitSize&&g.ClearCache(),g._InfixToPostfixCache.set(H,{result:J,accessTime:Date.now()}),J}static ClearCache(){const H=Array.from(g._InfixToPostfixCache.entries()).sort(((H,u)=>H[1].accessTime-u[1].accessTime));for(let u=0;u<g.InfixToPostfixCacheCleanupSize;u++)g._InfixToPostfixCache.delete(H[u][0])}}g.InfixToPostfixCacheLimitSize=5e4,g.InfixToPostfixCacheCleanupSize=25e3,g._InfixToPostfixCache=new Map,g._OperatorPriority={")":0,"(":1,"||":2,"&&":3},g._Stack=["","","","","","","","","","","","","","","","","","","",""];class B extends g{constructor(H){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=H,this.not=u}isTrue(H){let u=void 0!==H[this.define];return this.not&&(u=!u),u}}class b extends g{isTrue(H){return this.leftOperand.isTrue(H)||this.rightOperand.isTrue(H)}}class d extends g{isTrue(H){return this.leftOperand.isTrue(H)&&this.rightOperand.isTrue(H)}}class G extends g{constructor(H,u,J){super(),this.define=H,this.operand=u,this.testValue=J}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(H){let u=!1;const J=parseInt(void 0!=H[this.define]?H[this.define]:this.define),O=parseInt(void 0!=H[this.testValue]?H[this.testValue]:this.testValue);if(isNaN(J)||isNaN(O))return!1;switch(this.operand){case">":u=J>O;break;case"<":u=J<O;break;case"<=":u=J<=O;break;case">=":u=J>=O;break;case"==":u=J===O;break;case"!=":u=J!==O}return u}}var P=J(12199),mH=J(12235);const l=/defined\s*?\((.+?)\)/g,r=/defined\s*?\[(.+?)\]/g,p=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,a=/__decl__/,k=/light\{X\}.(\w*)/g,C=/\{X\}/g,j=[],M=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function L(H){H.processor&&H.processor.initializeShaders&&H.processor.initializeShaders(H.processingContext)}function Z(H,u,J,O){var U;null!==(U=u.processor)&&void 0!==U&&U.preProcessShaderCode&&(H=u.processor.preProcessShaderCode(H,u.isFragment)),n(H,u,(H=>{u.processCodeAfterIncludes&&(H=u.processCodeAfterIncludes(u.isFragment?"fragment":"vertex",H,u.defines));const U=function(H,u,J){let O=function(H,u){var J;if(null!==(J=u.processor)&&void 0!==J&&J.noPrecision)return H;const O=u.shouldUseHighPrecisionShader;-1===H.indexOf("precision highp float")?H=O?"precision highp float;\n"+H:"precision mediump float;\n"+H:O||(H=H.replace("precision highp float","precision mediump float"));return H}(H,u);if(!u.processor)return O;if(0===u.processor.shaderLanguage&&-1!==O.indexOf("#version 3")&&(O=O.replace("#version 300 es",""),!u.processor.parseGLES3))return O;const U=u.defines,h=c(u,J);u.processor.preProcessor&&(O=u.processor.preProcessor(O,U,h,u.isFragment,u.processingContext));const w={};O=e(O,h,u,w),u.processor.postProcessor&&(O=u.processor.postProcessor(O,U,u.isFragment,u.processingContext,J?{drawBuffersExtensionDisabled:!J.getCaps().drawBuffersExtension}:{},h,w));null!==J&&void 0!==J&&J._features.needShaderCodeInlining&&(O=J.inlineShaderCode(O));return O}(H,u,O);J(U,H)}))}function Y(H,u,J){return J.processor&&J.processor.finalizeShaders?J.processor.finalizeShaders(H,u,J.processingContext):{vertexCode:H,fragmentCode:u}}function F(H){const u=/defined\((.+)\)/.exec(H);if(u&&u.length)return new B(u[1].trim(),"!"===H[0]);const J=["==","!=",">=","<=","<",">"];let O="",U=0;for(O of J)if(U=H.indexOf(O),U>-1)break;if(-1===U)return new B(H);const h=H.substring(0,U).trim(),w=H.substring(U+O.length).trim();return new G(h,O,w)}function s(H,u){const J=new w,O=H.substring(0,u);let U=H.substring(u);return U=U.substring(0,(U.indexOf("//")+1||U.length+1)-1).trim(),J.testExpression="#ifdef"===O?new B(U):"#ifndef"===O?new B(U,!0):function(H){H=H.replace(l,"defined[$1]");const u=g.infixToPostfix(H),J=[];for(const U of u)if("||"!==U&&"&&"!==U)J.push(U);else if(J.length>=2){let H=J[J.length-1],u=J[J.length-2];J.length-=2;const O="&&"==U?new d:new b;"string"===typeof H&&(H=H.replace(r,"defined($1)")),"string"===typeof u&&(u=u.replace(r,"defined($1)")),O.leftOperand="string"===typeof u?F(u):u,O.rightOperand="string"===typeof H?F(H):H,J.push(O)}let O=J[J.length-1];return"string"===typeof O&&(O=O.replace(r,"defined($1)")),"string"===typeof O?F(O):O}(U),J}function A(H,u,J,U){let h=H.currentLine;for(;t(H,J,U);){h=H.currentLine;const w=h.substring(0,5).toLowerCase();if("#else"===w){const J=new O;return u.children.push(J),void t(H,J,U)}if("#elif"===w){const H=s(h,5);u.children.push(H),J=H}}}function t(H,u,J){for(;H.canRead;){H.lineIndex++;const U=H.currentLine;if(U.indexOf("#")>=0){const O=M.exec(U);if(O&&O.length){switch(O[0]){case"#ifdef":{const O=new h;u.children.push(O);const w=s(U,6);O.children.push(w),A(H,O,w,J);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const O=new h;u.children.push(O);const w=s(U,7);O.children.push(w),A(H,O,w,J);break}case"#if":{const O=new h,w=s(U,3);u.children.push(O),O.children.push(w),A(H,O,w,J);break}}continue}}const w=new O;if(w.line=U,u.children.push(w),"#"===U[0]&&"d"===U[1]){const H=U.replace(";","").split(" ");w.additionalDefineKey=H[1],3===H.length&&(w.additionalDefineValue=H[2])}}return!1}function e(H,u,J,h){const w=new O,g=new U;return g.lineIndex=-1,g.lines=H.split("\n"),t(g,w,h),w.process(u,J,h)}function c(H,u){var J;const O=H.defines,U={};for(const h of O){const H=h.replace("#define","").replace(";","").trim().split(" ");U[H[0]]=H.length>1?H[1]:""}return 0===(null===(J=H.processor)||void 0===J?void 0:J.shaderLanguage)&&(U.GL_ES="true"),U.__VERSION__=H.version,U[H.platformName]="true",(0,mH.j)(U,null===u||void 0===u?void 0:u.isNDCHalfZRange,null===u||void 0===u?void 0:u.rh,null===u||void 0===u?void 0:u.useExactSrgbConversions),U}function n(H,u,J){let O;for(j.length=0;null!==(O=p.exec(H));)j.push(O);let U=String(H),h=[H],w=!1;for(const g of j){let H=g[1];if(-1!==H.indexOf("__decl__")&&(H=H.replace(a,""),u.supportsUniformBuffers&&(H=H.replace("Vertex","Ubo").replace("Fragment","Ubo")),H+="Declaration"),!u.includesShadersStore[H]){const O=u.shadersRepository+"ShadersInclude/"+H+".fx";return void V.loadFile(O,(O=>{u.includesShadersStore[H]=O,n(h.join(""),u,J)}))}{let J=u.includesShadersStore[H];if(g[2]){const H=g[3].split(",");for(let u=0;u<H.length;u+=2){const O=new RegExp(H[u],"g"),U=H[u+1];J=J.replace(O,U)}}if(g[4]){const H=g[5];if(-1!==H.indexOf("..")){const O=H.split(".."),U=parseInt(O[0]);let h=parseInt(O[1]),w=J.slice(0);J="",isNaN(h)&&(h=u.indexParameters[O[1]]);for(let H=U;H<h;H++)u.supportsUniformBuffers||(w=w.replace(k,((H,u)=>u+"{X}"))),J+=w.replace(C,H.toString())+"\n"}else u.supportsUniformBuffers||(J=J.replace(k,((H,u)=>u+"{X}"))),J=J.replace(C,H)}const O=[];for(const H of h){const u=H.split(g[0]);for(let H=0;H<u.length-1;H++)O.push(u[H]),O.push(J);O.push(u[u.length-1])}h=O,w=w||J.indexOf("#include<")>=0||J.indexOf("#include <")>=0}}j.length=0,U=h.join(""),w?n(U.toString(),u,J):J(U)}const V={loadFile:(H,u,J,O,U,h)=>{throw(0,P.d)("FileTools")}}},12235:(H,u,J)=>{J.d(u,{d:()=>U,h:()=>h,j:()=>g,m:()=>w,o:()=>B});var O=J(12199);J(12178);const U={};function h(H,u){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(u?u+"\n":"")+H}function w(H,u,J,h,w,g,B){const b=B||U.loadFile;if(b){return b(H,u,J,h,w,g)}throw(0,O.d)("FileTools")}function g(H,u,J,O){if(H)return u?H.IS_NDC_HALF_ZRANGE="":delete H.IS_NDC_HALF_ZRANGE,J?H.USE_REVERSE_DEPTHBUFFER="":delete H.USE_REVERSE_DEPTHBUFFER,void(O?H.USE_EXACT_SRGB_CONVERSIONS="":delete H.USE_EXACT_SRGB_CONVERSIONS);{let H="";return u&&(H+="#define IS_NDC_HALF_ZRANGE"),J&&(H&&(H+="\n"),H+="#define USE_REVERSE_DEPTHBUFFER"),O&&(H&&(H+="\n"),H+="#define USE_EXACT_SRGB_CONVERSIONS"),H}}function B(H,u){let J=arguments.length>2&&void 0!==arguments[2]&&arguments[2],O=arguments.length>3?arguments[3]:void 0;switch(H){case 3:{const H=(ArrayBuffer,new Int8Array(u));return O&&H.set(new Int8Array(O)),H}case 0:{const H=(ArrayBuffer,new Uint8Array(u));return O&&H.set(new Uint8Array(O)),H}case 4:{const H=u instanceof ArrayBuffer?new Int16Array(u):new Int16Array(J?u/2:u);return O&&H.set(new Int16Array(O)),H}case 5:case 8:case 9:case 10:case 2:{const H=u instanceof ArrayBuffer?new Uint16Array(u):new Uint16Array(J?u/2:u);return O&&H.set(new Uint16Array(O)),H}case 6:{const H=u instanceof ArrayBuffer?new Int32Array(u):new Int32Array(J?u/4:u);return O&&H.set(new Int32Array(O)),H}case 7:case 11:case 12:case 13:case 14:case 15:{const H=u instanceof ArrayBuffer?new Uint32Array(u):new Uint32Array(J?u/4:u);return O&&H.set(new Uint32Array(O)),H}case 1:{const H=u instanceof ArrayBuffer?new Float32Array(u):new Float32Array(J?u/4:u);return O&&H.set(new Float32Array(O)),H}}const U=(ArrayBuffer,new Uint8Array(u));return O&&U.set(new Uint8Array(O)),U}},12259:(H,u,J)=>{J.d(u,{b:()=>O});class O{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?O.ShadersRepository:O.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?O.ShadersStore:O.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?O.IncludesShadersStore:O.IncludesShadersStoreWGSL}}O.ShadersRepository="src/Shaders/",O.ShadersStore={},O.IncludesShadersStore={},O.ShadersRepositoryWGSL="src/ShadersWGSL/",O.ShadersStoreWGSL={},O.IncludesShadersStoreWGSL={}},12268:(H,u,J)=>{J.d(u,{b:()=>P,f:()=>C,i:()=>l,m:()=>mH,q:()=>r,u:()=>k,v:()=>G,z:()=>b,B:()=>d,E:()=>B,F:()=>g});class O{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.mJ._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(H){H&&this.program&&H(this.program)}setEngine(H){this.mJ=H}_fillEffectInformation(H,u,J,O,U,h,w,g){const B=this.mJ;if(B.supportsUniformBuffers)for(const d in u)H.bindUniformBlock(d,u[d]);let b;for(this.mJ.getUniforms(this,J).forEach(((H,u)=>{O[J[u]]=H})),this._uniforms=O,b=0;b<U.length;b++){null==H.getUniform(U[b])&&(U.splice(b,1),b--)}U.forEach(((H,u)=>{h[H]=u}));for(const d of B.getAttributes(this,w))g.push(d)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(H,u){const J=this._valueCache[H],O=u.updateFlag;return(void 0===J||J!==O)&&(this._valueCache[H]=O,!0)}_cacheFloat2(H,u,J){let O=this._valueCache[H];if(!O||2!==O.length)return O=[u,J],this._valueCache[H]=O,!0;let U=!1;return O[0]!==u&&(O[0]=u,U=!0),O[1]!==J&&(O[1]=J,U=!0),U}_cacheFloat3(H,u,J,O){let U=this._valueCache[H];if(!U||3!==U.length)return U=[u,J,O],this._valueCache[H]=U,!0;let h=!1;return U[0]!==u&&(U[0]=u,h=!0),U[1]!==J&&(U[1]=J,h=!0),U[2]!==O&&(U[2]=O,h=!0),h}_cacheFloat4(H,u,J,O,U){let h=this._valueCache[H];if(!h||4!==h.length)return h=[u,J,O,U],this._valueCache[H]=h,!0;let w=!1;return h[0]!==u&&(h[0]=u,w=!0),h[1]!==J&&(h[1]=J,w=!0),h[2]!==O&&(h[2]=O,w=!0),h[3]!==U&&(h[3]=U,w=!0),w}setInt(H,u){const J=this._valueCache[H];void 0!==J&&J===u||this.mJ.setInt(this._uniforms[H],u)&&(this._valueCache[H]=u)}setInt2(H,u,J){this._cacheFloat2(H,u,J)&&(this.mJ.setInt2(this._uniforms[H],u,J)||(this._valueCache[H]=null))}setInt3(H,u,J,O){this._cacheFloat3(H,u,J,O)&&(this.mJ.setInt3(this._uniforms[H],u,J,O)||(this._valueCache[H]=null))}setInt4(H,u,J,O,U){this._cacheFloat4(H,u,J,O,U)&&(this.mJ.setInt4(this._uniforms[H],u,J,O,U)||(this._valueCache[H]=null))}setIntArray(H,u){this._valueCache[H]=null,this.mJ.setIntArray(this._uniforms[H],u)}setIntArray2(H,u){this._valueCache[H]=null,this.mJ.setIntArray2(this._uniforms[H],u)}setIntArray3(H,u){this._valueCache[H]=null,this.mJ.setIntArray3(this._uniforms[H],u)}setIntArray4(H,u){this._valueCache[H]=null,this.mJ.setIntArray4(this._uniforms[H],u)}setUInt(H,u){const J=this._valueCache[H];void 0!==J&&J===u||this.mJ.setUInt(this._uniforms[H],u)&&(this._valueCache[H]=u)}setUInt2(H,u,J){this._cacheFloat2(H,u,J)&&(this.mJ.setUInt2(this._uniforms[H],u,J)||(this._valueCache[H]=null))}setUInt3(H,u,J,O){this._cacheFloat3(H,u,J,O)&&(this.mJ.setUInt3(this._uniforms[H],u,J,O)||(this._valueCache[H]=null))}setUInt4(H,u,J,O,U){this._cacheFloat4(H,u,J,O,U)&&(this.mJ.setUInt4(this._uniforms[H],u,J,O,U)||(this._valueCache[H]=null))}setUIntArray(H,u){this._valueCache[H]=null,this.mJ.setUIntArray(this._uniforms[H],u)}setUIntArray2(H,u){this._valueCache[H]=null,this.mJ.setUIntArray2(this._uniforms[H],u)}setUIntArray3(H,u){this._valueCache[H]=null,this.mJ.setUIntArray3(this._uniforms[H],u)}setUIntArray4(H,u){this._valueCache[H]=null,this.mJ.setUIntArray4(this._uniforms[H],u)}setArray(H,u){this._valueCache[H]=null,this.mJ.setArray(this._uniforms[H],u)}setArray2(H,u){this._valueCache[H]=null,this.mJ.setArray2(this._uniforms[H],u)}setArray3(H,u){this._valueCache[H]=null,this.mJ.setArray3(this._uniforms[H],u)}setArray4(H,u){this._valueCache[H]=null,this.mJ.setArray4(this._uniforms[H],u)}setMatrices(H,u){u&&(this._valueCache[H]=null,this.mJ.setMatrices(this._uniforms[H],u))}setMatrix(H,u){this._cacheMatrix(H,u)&&(this.mJ.setMatrices(this._uniforms[H],u.Hg())||(this._valueCache[H]=null))}setMatrix3x3(H,u){this._valueCache[H]=null,this.mJ.setMatrix3x3(this._uniforms[H],u)}setMatrix2x2(H,u){this._valueCache[H]=null,this.mJ.setMatrix2x2(this._uniforms[H],u)}setFloat(H,u){const J=this._valueCache[H];void 0!==J&&J===u||this.mJ.setFloat(this._uniforms[H],u)&&(this._valueCache[H]=u)}setVector2(H,u){this._cacheFloat2(H,u.x,u.y)&&(this.mJ.setFloat2(this._uniforms[H],u.x,u.y)||(this._valueCache[H]=null))}setFloat2(H,u,J){this._cacheFloat2(H,u,J)&&(this.mJ.setFloat2(this._uniforms[H],u,J)||(this._valueCache[H]=null))}setVector3(H,u){this._cacheFloat3(H,u.x,u.y,u.z)&&(this.mJ.setFloat3(this._uniforms[H],u.x,u.y,u.z)||(this._valueCache[H]=null))}setFloat3(H,u,J,O){this._cacheFloat3(H,u,J,O)&&(this.mJ.setFloat3(this._uniforms[H],u,J,O)||(this._valueCache[H]=null))}setVector4(H,u){this._cacheFloat4(H,u.x,u.y,u.z,u.w)&&(this.mJ.setFloat4(this._uniforms[H],u.x,u.y,u.z,u.w)||(this._valueCache[H]=null))}setQuaternion(H,u){this._cacheFloat4(H,u.x,u.y,u.z,u.w)&&(this.mJ.setFloat4(this._uniforms[H],u.x,u.y,u.z,u.w)||(this._valueCache[H]=null))}setFloat4(H,u,J,O,U){this._cacheFloat4(H,u,J,O,U)&&(this.mJ.setFloat4(this._uniforms[H],u,J,O,U)||(this._valueCache[H]=null))}setColor3(H,u){this._cacheFloat3(H,u.r,u.g,u.b)&&(this.mJ.setFloat3(this._uniforms[H],u.r,u.g,u.b)||(this._valueCache[H]=null))}setColor4(H,u,J){this._cacheFloat4(H,u.r,u.g,u.b,J)&&(this.mJ.setFloat4(this._uniforms[H],u.r,u.g,u.b,J)||(this._valueCache[H]=null))}setDirectColor4(H,u){this._cacheFloat4(H,u.r,u.g,u.b,u.a)&&(this.mJ.setFloat4(this._uniforms[H],u.r,u.g,u.b,u.a)||(this._valueCache[H]=null))}_getVertexShaderCode(){return this.vertexShader?this.mJ._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.mJ._getShaderSource(this.fragmentShader):null}}var U=J(12235);const h=new WeakMap,w={_webGLVersion:2,cachedPipelines:{}};function g(H){let u=h.get(H);if(!u){if(!H)return w;u={_webGLVersion:H.TEXTURE_BINDING_3D?2:1,_context:H,parallelShaderCompile:H.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},h.set(H,u)}return u}function B(H){h.delete(H)}function b(H,u,J,O,U,h){const w=g(O);h||(h=w._createShaderProgramInjection??P);return h(H,a(u,"vertex",O,w._contextWasLost),a(J,"fragment",O,w._contextWasLost),O,U,w.validateShaderPrograms)}function d(H,u,J,O,U){let h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,w=arguments.length>6?arguments[6]:void 0;const B=g(U);w||(w=B._createShaderProgramInjection??P);const b=B._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return w(H,p(u,"vertex",O,b,U,B._contextWasLost),p(J,"fragment",O,b,U,B._contextWasLost),U,h,B.validateShaderPrograms)}function G(H,u){const J=new O,U=g(H);return U.parallelShaderCompile&&!U.disableParallelShaderCompile&&(J.isParallelCompiled=!0),J.context=U._context,J}function P(H,u,J,O){let U=arguments.length>5?arguments[5]:void 0;const h=O.createProgram();if(H.program=h,!h)throw new Error("Unable to create program");return O.attachShader(h,u),O.attachShader(h,J),O.linkProgram(h),H.context=O,H.vertexShader=u,H.fragmentShader=J,H.isParallelCompiled||l(H,O,U),h}function mH(H,u,J){const O=H;if(O._isDisposed)return!1;const U=g(u);return!!(U&&U.parallelShaderCompile&&U.parallelShaderCompile.COMPLETION_STATUS_KHR&&O.program&&u.getProgramParameter(O.program,U.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(l(O,u,J),!0)}function l(H,u,J){const O=H.context,U=H.vertexShader,h=H.fragmentShader,w=H.program;if(!O.getProgramParameter(w,O.LINK_STATUS)){if(!u.getShaderParameter(U,u.COMPILE_STATUS)){const J=u.getShaderInfoLog(U);if(J)throw H.vertexCompilationError=J,new Error("VERTEX SHADER "+J)}if(!u.getShaderParameter(h,u.COMPILE_STATUS)){const J=u.getShaderInfoLog(h);if(J)throw H.fragmentCompilationError=J,new Error("FRAGMENT SHADER "+J)}const J=O.getProgramInfoLog(w);if(J)throw H.programLinkError=J,new Error(J)}if(J){O.validateProgram(w);if(!O.getProgramParameter(w,O.VALIDATE_STATUS)){const u=O.getProgramInfoLog(w);if(u)throw H.programValidationError=u,new Error(u)}}O.deleteShader(U),O.deleteShader(h),H.vertexShader=void 0,H.fragmentShader=void 0,H.onCompiled&&(H.onCompiled(),H.onCompiled=void 0)}function r(H,u,J,O,U,h,w,B,G){let P=arguments.length>10?arguments[10]:void 0,mH=arguments.length>11?arguments[11]:void 0,l=arguments.length>12?arguments[12]:void 0;const r=g(H.context);mH||(mH=r.createRawShaderProgramInjection??b),l||(l=r.createShaderProgramInjection??d);const p=H;p.program=O?mH(p,u,J,p.context,G):l(p,u,J,B,p.context,G),p.program.__SPECTOR_rebuildProgram=w,P()}function p(H,u,J,O,h,w){return a((0,U.h)(H,J,O),u,h,w)}function a(H,u,J,O){const U=J.createShader("vertex"===u?J.VERTEX_SHADER:J.FRAGMENT_SHADER);if(!U){let H=J.NO_ERROR,U=J.NO_ERROR;for(;(U=J.getError())!==J.NO_ERROR;)H=U;throw new Error(`Something went wrong while creating a gl ${u} shader object. gl error=${H}, gl isContextLost=${J.isContextLost()}, _contextWasLost=${O}`)}return J.shaderSource(U,H),J.compileShader(U),U}function k(H,u){u.useProgram(H)}function C(H,u){const J=H;if(!J.isParallelCompiled)return void u(H);const O=J.onCompiled;J.onCompiled=()=>{null===O||void 0===O||O(),u(H)}}},12265:(H,u,J)=>{J.d(u,{e:()=>G,h:()=>mH,j:()=>b,l:()=>d});var O=J(12178),U=J(12268),h=J(12259),w=J(12185),g=J(12226),B=J(12235);function b(H,u){return(0,U.F)(u).cachedPipelines[H]}function d(H){const u=H._name,J=H.context;if(u&&J){const H=(0,U.F)(J),O=H.cachedPipelines[u];null===O||void 0===O||O.dispose(),delete H.cachedPipelines[u]}}function G(H,u,J,U,h,w,B){let b,d;const G=(0,O.k)()?null===w||void 0===w?void 0:w.getHostDocument():null;b="string"===typeof u?u:u.vertexSource?"source:"+u.vertexSource:u.vertexElement?(null===G||void 0===G?void 0:G.getElementById(u.vertexElement))||u.vertexElement:u.vertex||u,d="string"===typeof u?u:u.fragmentSource?"source:"+u.fragmentSource:u.fragmentElement?(null===G||void 0===G?void 0:G.getElementById(u.fragmentElement))||u.fragmentElement:u.fragment||u;const mH=[void 0,void 0],l=()=>{if(mH[0]&&mH[1]){H.isFragment=!0;const[O,b]=mH;(0,g.m)(b,H,((w,b)=>{B&&(B._fragmentSourceCodeBeforeMigration=b),J&&(w=J("fragment",w));const d=(0,g.e)(O,w,H);H=null;const G=function(H,u,J,O){if(J){return{vertexSourceCode:(1===O?"//":"")+"#define SHADER_NAME vertex:"+(J.vertexElement||J.vertex||J.spectorName||J)+"\n"+H,fragmentSourceCode:(1===O?"//":"")+"#define SHADER_NAME fragment:"+(J.fragmentElement||J.fragment||J.spectorName||J)+"\n"+u}}return{vertexSourceCode:H,fragmentSourceCode:u}}(d.vertexCode,d.fragmentCode,u,h);null===U||void 0===U||U(G.vertexSourceCode,G.fragmentSourceCode)}),w)}};P(b,"Vertex","",(u=>{(0,g.f)(H),(0,g.m)(u,H,((H,O)=>{B&&(B._rawVertexSourceCode=u,B._vertexSourceCodeBeforeMigration=O),J&&(H=J("vertex",H)),mH[0]=H,l()}),w)}),h),P(d,"Fragment","Pixel",(H=>{B&&(B._rawFragmentSourceCode=H),mH[1]=H,l()}),h)}function P(H,u,J,U,w,g){if("undefined"!==typeof HTMLElement&&H instanceof HTMLElement){return void U((0,O.b)(H))}if("source:"===H.substring(0,7))return void U(H.substring(7));if("base64:"===H.substring(0,7)){return void U(window.atob(H.substring(7)))}const b=h.b.GetShadersStore(w);if(b[H+u+"Shader"])return void U(b[H+u+"Shader"]);if(J&&b[H+J+"Shader"])return void U(b[H+J+"Shader"]);let d;if(d="."===H[0]||"/"===H[0]||H.indexOf("http")>-1?H:h.b.GetShadersRepository(w)+H,!(g=g||B.m))throw new Error("loadFileInjection is not defined");g(d+"."+u.toLowerCase()+".fx",U)}const mH=(H,u,J,O)=>{try{const h=H.context?(0,U.F)(H.context):null;h&&(h.disableParallelShaderCompile=H.disableParallelCompilation);const w=H.existingPipelineContext||u(H.shaderProcessingContext);return w._name=H.name,H.name&&h&&(h.cachedPipelines[H.name]=w),J(w,H.vertex,H.fragment,!!H.createAsRaw,"","",H.rebuildRebind,H.defines,H.transformFeedbackVaryings,"",(()=>{O(w,(()=>{var u;null===(u=H.onRenderingStateCompiled)||void 0===u||u.call(H,w)}))})),w}catch(h){throw w.b.Error("Error compiling effect"),h}}},12251:(H,u,J)=>{J.r(u),J.d(u,{Effect:()=>B});var O=J(12175),U=J(12185),h=J(12259),w=J(12265),g=J(12240);class B{static get ShadersRepository(){return h.b.ShadersRepository}static set ShadersRepository(H){h.b.ShadersRepository=H}get B(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new O.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(H,u,J){let U=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,h=arguments.length>4?arguments[4]:void 0,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,b=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,G=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,P=arguments.length>9?arguments[9]:void 0,mH=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",l=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,r=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new O.b,this.onErrorObservable=new O.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=H,this._key=mH;const p=this._key.replace(/\r/g,"").replace(/\n/g,"|");let a;if(u.attributes){const H=u;if(this._engine=J,this._attributesNames=H.attributes,this._uniformsNames=H.uniformsNames.concat(H.samplers),this._samplerList=H.samplers.slice(),this.defines=H.defines,this.onError=H.onError,this.onCompiled=H.onCompiled,this._fallbacks=H.fallbacks,this._indexParameters=H.indexParameters,this._transformFeedbackVaryings=H.transformFeedbackVaryings||null,this._multiTarget=!!H.multiTarget,this._shaderLanguage=H.shaderLanguage??0,this._disableParallelShaderCompilation=!!H.disableParallelShaderCompilation,H.uniformBuffersNames){this._uniformBuffersNamesList=H.uniformBuffersNames.slice();for(let u=0;u<H.uniformBuffersNames.length;u++)this._uniformBuffersNames[H.uniformBuffersNames[u]]=u}this._processFinalCode=H.processFinalCode??null,this._processCodeAfterIncludes=H.processCodeAfterIncludes??void 0,r=H.extraInitializationsAsync,a=H.existingPipelineContext}else this._engine=h,this.defines=null==g?"":g,this._uniformsNames=J.concat(U),this._samplerList=U?U.slice():[],this._attributesNames=u,this._uniformBuffersNamesList=[],this._shaderLanguage=l,this.onError=G,this.onCompiled=d,this._indexParameters=P,this._fallbacks=b;"WEBGL2"===this._engine.shaderPlatformName&&(a=(0,w.j)(p,this._engine._gl)??a),this._attributeLocationByName={},this.uniqueId=B._UniqueIdSeed++,a?(this._pipelineContext=a,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,r),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.B||this.dispose(!0)}))}async _processShaderCodeAsync(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,O=arguments.length>3?arguments[3]:void 0;O&&await O(),this._processingContext=J||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const U={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:H??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:h.b.GetShadersRepository(this._shaderLanguage),includesShadersStore:h.b.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,rh:this._engine.rh,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,w.e)(U,this.name,this._processFinalCode,((H,J)=>{this._vertexSourceCode=H,this._fragmentSourceCode=J,this._prepareEffect(u)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.B||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(H){return this._attributes[H]}getAttributeLocationByName(H){return this._attributeLocationByName[H]}getAttributesCount(){return this._attributes.length}getUniformIndex(H){return this._uniformsNames.indexOf(H)}getUniform(H){return this._uniforms[H]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((H=>{this.executeWhenCompiled(H)}))}executeWhenCompiled(H){this.isReady()?H(this):(this.onCompileObservable.add((u=>{H(u)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(H){(0,g.c)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(u=>{this._processCompilationErrors(u,H)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var H;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(H=this._pipelineContext)||void 0===H?void 0:H._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var H;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(H=this._pipelineContext)||void 0===H?void 0:H._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,rh:this._engine.rh,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(H,u,J,O){this._isReady=!1,this._vertexSourceCodeOverride=H,this._fragmentSourceCodeOverride=u,this.onError=(H,u)=>{O&&O(u)},this.onCompiled=()=>{var H,u;const O=this.getEngine().scenes;if(O)for(let J=0;J<O.length;J++)O[J].markAllMaterialsAsDirty(127);null===(H=(u=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===H||H.call(u,J)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(H){if(this._pipelineContext=H,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let u=0;u<this._attributesNames.length;u++){const H=this._attributesNames[u];this._attributeLocationByName[H]=this._attributes[u]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),B.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const u=this._pipelineContext;this._isReady=!1;try{const J=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),O=J?null:this.defines,U=J?this._vertexSourceCodeOverride:this._vertexSourceCode,h=J?this._fragmentSourceCodeOverride:this._fragmentSourceCode,g=this._engine;this._pipelineContext=(0,w.h)({existingPipelineContext:H?u:null,vertex:U,fragment:h,context:"WEBGL2"===g.shaderPlatformName||"WEBGL1"===g.shaderPlatformName?g._gl:void 0,rebuildRebind:(H,u,J,O)=>this._rebuildProgram(H,u,J,O),defines:O,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:J,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:J=>{u&&!H&&this._engine._deletePipelineContext(u),J&&this._onRenderingStateCompiled(J)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(u)}catch(J){this._processCompilationErrors(J,u)}}_getShaderCodeAndErrorLine(H,u,J){const O=J?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let U=null;if(u&&H){const h=u.match(O);if(h&&2===h.length){const u=parseInt(h[1]),O=H.split("\n",-1);O.length>=u&&(U=`Offending line [${u}] in ${J?"fragment":"vertex"} code: ${O[u-1]}`)}}return[H,U]}_processCompilationErrors(H){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=H.message;const J=this._attributesNames,O=this._fallbacks;if(U.b.Error("Unable to compile effect:"),U.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),U.b.Error(`Attributes: ${J.join(" ")}`),U.b.Error("Defines:\n"+this.defines),B.LogShaderCodeOnCompilationError){var h,w;let H=null,u=null,J=null;var g;if(null!==(h=this._pipelineContext)&&void 0!==h&&h._getVertexShaderCode()&&([J,H]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),J&&(U.b.Error("Vertex code:"),U.b.Error(J))),null!==(w=this._pipelineContext)&&void 0!==w&&w._getFragmentShaderCode())[J,u]=this._getShaderCodeAndErrorLine(null===(g=this._pipelineContext)||void 0===g?void 0:g._getFragmentShaderCode(),this._compilationError,!0),J&&(U.b.Error("Fragment code:"),U.b.Error(J));H&&U.b.Error(H),u&&U.b.Error(u)}U.b.Error("Error: "+this._compilationError);const b=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};u&&(this._pipelineContext=u,this._isReady=!0,b()),O?(this._pipelineContext=null,O.hasMoreFallbacks?(this._allFallbacksProcessed=!1,U.b.Error("Trying next fallback."),this.defines=O.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,b(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,u||b())}get isSupported(){return""===this._compilationError}_bindTexture(H,u){this._engine._bindTexture(this._samplers[H],u,H)}setTexture(H,u){this._engine.setTexture(this._samplers[H],this._uniforms[H],u,H)}setTextureArray(H,u){const J=H+"Ex";if(-1===this._samplerList.indexOf(J+"0")){const O=this._samplerList.indexOf(H);for(let H=1;H<u.length;H++){const u=J+(H-1).toString();this._samplerList.splice(O+H,0,u)}let U=0;for(const H of this._samplerList)this._samplers[H]=U,U+=1}this._engine.setTextureArray(this._samplers[H],this._uniforms[H],u,H)}bindUniformBuffer(H,u){const J=this._uniformBuffersNames[u];void 0===J||B._BaseCache[J]===H&&this._engine._features.useUBOBindingCache||(B._BaseCache[J]=H,this._engine.bindUniformBufferBase(H,J,u))}bindUniformBlock(H,u){this._engine.bindUniformBlock(this._pipelineContext,H,u)}setInt(H,u){return this._pipelineContext.setInt(H,u),this}setInt2(H,u,J){return this._pipelineContext.setInt2(H,u,J),this}setInt3(H,u,J,O){return this._pipelineContext.setInt3(H,u,J,O),this}setInt4(H,u,J,O,U){return this._pipelineContext.setInt4(H,u,J,O,U),this}setIntArray(H,u){return this._pipelineContext.setIntArray(H,u),this}setIntArray2(H,u){return this._pipelineContext.setIntArray2(H,u),this}setIntArray3(H,u){return this._pipelineContext.setIntArray3(H,u),this}setIntArray4(H,u){return this._pipelineContext.setIntArray4(H,u),this}setUInt(H,u){return this._pipelineContext.setUInt(H,u),this}setUInt2(H,u,J){return this._pipelineContext.setUInt2(H,u,J),this}setUInt3(H,u,J,O){return this._pipelineContext.setUInt3(H,u,J,O),this}setUInt4(H,u,J,O,U){return this._pipelineContext.setUInt4(H,u,J,O,U),this}setUIntArray(H,u){return this._pipelineContext.setUIntArray(H,u),this}setUIntArray2(H,u){return this._pipelineContext.setUIntArray2(H,u),this}setUIntArray3(H,u){return this._pipelineContext.setUIntArray3(H,u),this}setUIntArray4(H,u){return this._pipelineContext.setUIntArray4(H,u),this}setFloatArray(H,u){return this._pipelineContext.setArray(H,u),this}setFloatArray2(H,u){return this._pipelineContext.setArray2(H,u),this}setFloatArray3(H,u){return this._pipelineContext.setArray3(H,u),this}setFloatArray4(H,u){return this._pipelineContext.setArray4(H,u),this}setArray(H,u){return this._pipelineContext.setArray(H,u),this}setArray2(H,u){return this._pipelineContext.setArray2(H,u),this}setArray3(H,u){return this._pipelineContext.setArray3(H,u),this}setArray4(H,u){return this._pipelineContext.setArray4(H,u),this}setMatrices(H,u){return this._pipelineContext.setMatrices(H,u),this}setMatrix(H,u){return this._pipelineContext.setMatrix(H,u),this}setMatrix3x3(H,u){return this._pipelineContext.setMatrix3x3(H,u),this}setMatrix2x2(H,u){return this._pipelineContext.setMatrix2x2(H,u),this}setFloat(H,u){return this._pipelineContext.setFloat(H,u),this}setBool(H,u){return this._pipelineContext.setInt(H,u?1:0),this}setVector2(H,u){return this._pipelineContext.setVector2(H,u),this}setFloat2(H,u,J){return this._pipelineContext.setFloat2(H,u,J),this}setVector3(H,u){return this._pipelineContext.setVector3(H,u),this}setFloat3(H,u,J,O){return this._pipelineContext.setFloat3(H,u,J,O),this}setVector4(H,u){return this._pipelineContext.setVector4(H,u),this}setQuaternion(H,u){return this._pipelineContext.setQuaternion(H,u),this}setFloat4(H,u,J,O,U){return this._pipelineContext.setFloat4(H,u,J,O,U),this}setColor3(H,u){return this._pipelineContext.setColor3(H,u),this}setColor4(H,u,J){return this._pipelineContext.setColor4(H,u,J),this}setDirectColor4(H,u){return this._pipelineContext.setDirectColor4(H,u),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(B.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,w.l)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(H,u,J){let O=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;u&&(h.b.GetShadersStore(O)[`${H}PixelShader`]=u),J&&(h.b.GetShadersStore(O)[`${H}VertexShader`]=J)}static ResetCache(){B._BaseCache={}}}B.LogShaderCodeOnCompilationError=!0,B.PersistentMode=!1,B.AutomaticallyClearCodeCache=!1,B._UniqueIdSeed=0,B._BaseCache={},B.ShadersStore=h.b.ShadersStore,B.IncludesShadersStore=h.b.IncludesShadersStore},12199:(H,u,J)=>{J.d(u,{d:()=>U});const O={};function U(H){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!O[H])return O[H]=!0,`${H} needs to be imported before as it contains a side-effect required by your code.`}},12178:(H,u,J)=>{function O(){return"undefined"!==typeof window}function U(){return"undefined"!==typeof navigator}function h(){return"undefined"!==typeof document}function w(H){let u="",J=H.firstChild;for(;J;)3===J.nodeType&&(u+=J.textContent),J=J.nextSibling;return u}J.d(u,{b:()=>w,e:()=>h,i:()=>U,k:()=>O})},12185:(H,u,J)=>{J.d(u,{b:()=>O});class O{static _CheckLimit(H,u){let J=O._LogLimitOutputs[H];return J?J.current++:(J={limit:u,current:1},O._LogLimitOutputs[H]=J),J.current<=J.limit}static _GenerateLimitMessage(H){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const J=O._LogLimitOutputs[H];if(!J||!O.MessageLimitReached)return;const U=this._Levels[u];J.current===J.limit&&O[U.name](O.MessageLimitReached.replace(/%LIMIT%/g,""+J.limit).replace(/%TYPE%/g,U.name??""))}static _AddLogEntry(H){O._LogCache=H+O._LogCache,O.OnNewCacheEntry&&O.OnNewCacheEntry(H)}static _FormatMessage(H){const u=H=>H<10?"0"+H:""+H,J=new Date;return"["+u(J.getHours())+":"+u(J.getMinutes())+":"+u(J.getSeconds())+"]: "+H}static _LogDisabled(H,u){}static _LogEnabled(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,u=arguments.length>1?arguments[1]:void 0,J=arguments.length>2?arguments[2]:void 0;const U=Array.isArray(u)?u[0]:u;if(void 0!==J&&!O._CheckLimit(U,J))return;const h=O._FormatMessage(U),w=this._Levels[H],g=Array.isArray(u)?u.slice(1):[];w.logFunc&&w.logFunc("BJS - "+h,...g);const B=`<div style='color:${w.color}'>${h}</div><br>`;O._AddLogEntry(B),O._GenerateLimitMessage(U,H)}static get LogCache(){return O._LogCache}static ClearLogCache(){O._LogCache="",O._LogLimitOutputs={},O.errorsCount=0}static set LogLevels(H){O.Log=O._LogDisabled,O.Warn=O._LogDisabled,O.Error=O._LogDisabled;const u=[O.MessageLogLevel,O.WarningLogLevel,O.ErrorLogLevel];for(const J of u)if((H&J)===J){const H=this._Levels[J];O[H.name]=O._LogEnabled.bind(O,J)}}}O.NoneLogLevel=0,O.MessageLogLevel=1,O.WarningLogLevel=2,O.ErrorLogLevel=4,O.AllLogLevel=7,O.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",O._LogCache="",O._LogLimitOutputs={},O._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],O.errorsCount=0,O.Log=O._LogEnabled.bind(O,O.MessageLogLevel),O.Warn=O._LogEnabled.bind(O,O.WarningLogLevel),O.Error=O._LogEnabled.bind(O,O.ErrorLogLevel)},12175:(H,u,J)=>{J.d(u,{b:()=>w});const O="undefined"!==typeof WeakRef;class U{constructor(H){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=arguments.length>2?arguments[2]:void 0,O=arguments.length>3?arguments[3]:void 0;this.initialize(H,u,J,O)}initialize(H){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],J=arguments.length>2?arguments[2]:void 0,O=arguments.length>3?arguments[3]:void 0;return this.mask=H,this.skipNextObservers=u,this.target=J,this.currentTarget=O,this}}class h{constructor(H,u){let J=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=H,this.mask=u,this.scope=J,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(H)}}class w{static FromPromise(H,u){const J=new w;return H.then((H=>{J.notifyObservers(H)})).catch((H=>{if(!u)throw H;u.notifyObservers(H)})),J}get observers(){return this._observers}constructor(H){let u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=u,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new U(0),H&&(this._onObserverAdded=H)}add(H){let u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],J=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!H)return null;const U=new h(H,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);U.unregisterOnNextCall=J,u?this._observers.unshift(U):this._observers.push(U),this._onObserverAdded&&this._onObserverAdded(U),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(U,this._lastNotifiedValue);const w=O?new WeakRef(this):{deref:()=>this};return U._remove=function(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const u=w.deref();u&&(H?u.remove(U):u._remove(U))},U}addOnce(H){return this.add(H,void 0,void 0,void 0,!0)}remove(H){if(!H)return!1;H._remove=null;return-1!==this._observers.indexOf(H)&&(this._deferUnregister(H),!0)}removeCallback(H,u){for(let J=0;J<this._observers.length;J++){const O=this._observers[J];if(!O._willBeUnregistered&&(O.callback===H&&(!u||u===O.scope)))return this._deferUnregister(O),!0}return!1}_deferUnregister(H){H._willBeUnregistered||(this._numObserversMarkedAsDeleted++,H.unregisterOnNextCall=!1,H._willBeUnregistered=!0,setTimeout((()=>{this._remove(H)}),0))}_remove(H){let u=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!H)return!1;const J=this._observers.indexOf(H);return-1!==J&&(u&&this._numObserversMarkedAsDeleted--,this._observers.splice(J,1),!0)}makeObserverTopPriority(H){this._remove(H,!1),this._observers.unshift(H)}makeObserverBottomPriority(H){this._remove(H,!1),this._observers.push(H)}notifyObservers(H){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,J=arguments.length>2?arguments[2]:void 0,O=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=H),!this._observers.length)return!0;const h=this._eventState;h.mask=u,h.target=J,h.currentTarget=O,h.skipNextObservers=!1,h.lastReturnValue=H,h.userInfo=U;for(const w of this._observers)if(!w._willBeUnregistered&&(w.mask&u&&(w.unregisterOnNextCall&&this._deferUnregister(w),w.scope?h.lastReturnValue=w.callback.apply(w.scope,[H,h]):h.lastReturnValue=w.callback(H,h)),h.skipNextObservers))return!1;return!0}notifyObserver(H,u){let J=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=u),H._willBeUnregistered)return;const O=this._eventState;O.mask=J,O.skipNextObservers=!1,H.unregisterOnNextCall&&this._deferUnregister(H),H.callback(u,O)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const H=this._observers.pop();H&&(H._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const H=new w;return H._observers=this._observers.slice(0),H}hasSpecificMask(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const u of this._observers)if(u.mask&H||u.mask===H)return!0;return!1}}},12240:(H,u,J)=>{J.d(u,{b:()=>U,c:()=>w});let O=[];class U{static SetImmediate(H){0===O.length&&setTimeout((()=>{const H=O;O=[];for(const u of H)u()}),1),O.push(H)}}function h(H,u,J){try{if(H())return u(),!0}catch(O){return null===J||void 0===J||J(O),!0}return!1}const w=function(H,u,J){let O=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,U=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,w=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&h(H,u,J))return null;const g=setInterval((()=>{h(H,u,J)?clearInterval(g):(U-=O,U<0&&(clearInterval(g),null===J||void 0===J||J(new Error("Operation timed out after maximum retries. "+(w||"")),!0)))}),O);return()=>clearInterval(g)}}}]);