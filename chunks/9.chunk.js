"use strict";(self.ex92n20nlz8=self.ex92n20nlz8||[]).push([[9],{12474:(I,g,b)=>{b.d(g,{b:()=>mI,d:()=>R,j:()=>E,h:()=>O,m:()=>H});class e{constructor(){this.children=[]}isValid(I){return!0}process(I,g,b){let e="";if(this.line){let b=this.line;const G=g.processor;if(G){var c,z,M,J,o,n;G.lineProcessor&&(b=G.lineProcessor(b,g.isFragment,g.processingContext));const e=(null===(c=g.processor)||void 0===c?void 0:c.attributeKeywordName)??"attribute",D=g.isFragment&&null!==(z=g.processor)&&void 0!==z&&z.varyingFragmentKeywordName?null===(M=g.processor)||void 0===M?void 0:M.varyingFragmentKeywordName:!g.isFragment&&null!==(J=g.processor)&&void 0!==J&&J.varyingVertexKeywordName?null===(o=g.processor)||void 0===o?void 0:o.varyingVertexKeywordName:"varying";if(!g.isFragment&&G.attributeProcessor&&this.line.startsWith(e))b=G.attributeProcessor(this.line,I,g.processingContext);else if(G.varyingProcessor&&(null!==(n=G.varyingCheck)&&void 0!==n&&n.call(G,this.line,g.isFragment)||!G.varyingCheck&&this.line.startsWith(D)))b=G.varyingProcessor(this.line,g.isFragment,I,g.processingContext);else if(G.uniformProcessor&&G.uniformRegexp&&G.uniformRegexp.test(this.line))g.lookForClosingBracketForUniformBuffer||(b=G.uniformProcessor(this.line,g.isFragment,I,g.processingContext));else if(G.uniformBufferProcessor&&G.uniformBufferRegexp&&G.uniformBufferRegexp.test(this.line))g.lookForClosingBracketForUniformBuffer||(b=G.uniformBufferProcessor(this.line,g.isFragment,g.processingContext),g.lookForClosingBracketForUniformBuffer=!0);else if(G.textureProcessor&&G.textureRegexp&&G.textureRegexp.test(this.line))b=G.textureProcessor(this.line,g.isFragment,I,g.processingContext);else if((G.uniformProcessor||G.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!g.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?G.uniformProcessor&&(b=G.uniformProcessor(this.line,g.isFragment,I,g.processingContext)):G.uniformBufferProcessor&&(b=G.uniformBufferProcessor(this.line,g.isFragment,g.processingContext),g.lookForClosingBracketForUniformBuffer=!0)}g.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(g.lookForClosingBracketForUniformBuffer=!1,G.endOfUniformBufferProcessor&&(b=G.endOfUniformBufferProcessor(this.line,g.isFragment,g.processingContext)))}e+=b+"\n"}for(const G of this.children)e+=G.process(I,g,b);return this.additionalDefineKey&&(I[this.additionalDefineKey]=this.additionalDefineValue||"true",b[this.additionalDefineKey]=I[this.additionalDefineKey]),e}}class c{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(I){this._lines.length=0;for(const g of I){if(!g||"\r"===g)continue;if("#"===g[0]){this._lines.push(g);continue}const I=g.trim();if(!I)continue;if(I.startsWith("//")){this._lines.push(g);continue}const b=I.indexOf(";");if(-1===b)this._lines.push(I);else if(b===I.length-1)I.length>1&&this._lines.push(I);else{const I=g.split(";");for(let g=0;g<I.length;g++){let b=I[g];b&&(b=b.trim(),b&&this._lines.push(b+(g!==I.length-1?";":"")))}}}}}class z extends e{process(I,g,b){for(let e=0;e<this.children.length;e++){const c=this.children[e];if(c.isValid(I))return c.process(I,g,b)}return""}}class M extends e{isValid(I){return this.testExpression.isTrue(I)}}class J{isTrue(I){return!0}static postfixToInfix(I){const g=[];for(const b of I)if(void 0===J._OperatorPriority[b])g.push(b);else{const I=g[g.length-1],e=g[g.length-2];g.length-=2,g.push(`(${e}${b}${I})`)}return g[g.length-1]}static infixToPostfix(I){const g=J._InfixToPostfixCache.get(I);if(g)return g.accessTime=Date.now(),g.result;if(!I.includes("&&")&&!I.includes("||")&&!I.includes(")")&&!I.includes("("))return[I];const b=[];let e=-1;const c=()=>{G=G.trim(),""!==G&&(b.push(G),G="")},z=I=>{e<J._Stack.length-1&&(J._Stack[++e]=I)},M=()=>J._Stack[e],o=()=>-1===e?"!!INVALID EXPRESSION!!":J._Stack[e--];let n=0,G="";for(;n<I.length;){const g=I.charAt(n),D=n<I.length-1?I.substring(n,2+n):"";if("("===g)G="",z(g);else if(")"===g){for(c();-1!==e&&"("!==M();)b.push(o());o()}else if(J._OperatorPriority[D]>1){for(c();-1!==e&&J._OperatorPriority[M()]>=J._OperatorPriority[D];)b.push(o());z(D),n++}else G+=g;n++}for(c();-1!==e;)"("===M()?o():b.push(o());return J._InfixToPostfixCache.size>=J.InfixToPostfixCacheLimitSize&&J.ClearCache(),J._InfixToPostfixCache.set(I,{result:b,accessTime:Date.now()}),b}static ClearCache(){const I=Array.from(J._InfixToPostfixCache.entries()).sort(((I,g)=>I[1].accessTime-g[1].accessTime));for(let g=0;g<J.InfixToPostfixCacheCleanupSize;g++)J._InfixToPostfixCache.delete(I[g][0])}}J.InfixToPostfixCacheLimitSize=5e4,J.InfixToPostfixCacheCleanupSize=25e3,J._InfixToPostfixCache=new Map,J._OperatorPriority={")":0,"(":1,"||":2,"&&":3},J._Stack=["","","","","","","","","","","","","","","","","","","",""];class o extends J{constructor(I){let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=I,this.not=g}isTrue(I){let g=void 0!==I[this.define];return this.not&&(g=!g),g}}class n extends J{isTrue(I){return this.leftOperand.isTrue(I)||this.rightOperand.isTrue(I)}}class G extends J{isTrue(I){return this.leftOperand.isTrue(I)&&this.rightOperand.isTrue(I)}}class D extends J{constructor(I,g,b){super(),this.define=I,this.operand=g,this.testValue=b}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(I){let g=!1;const b=parseInt(void 0!=I[this.define]?I[this.define]:this.define),e=parseInt(void 0!=I[this.testValue]?I[this.testValue]:this.testValue);if(isNaN(b)||isNaN(e))return!1;switch(this.operand){case">":g=b>e;break;case"<":g=b<e;break;case"<=":g=b<=e;break;case">=":g=b>=e;break;case"==":g=b===e;break;case"!=":g=b!==e}return g}}var p=b(12437),x=b(12481);const Z=/defined\s*?\((.+?)\)/g,k=/defined\s*?\[(.+?)\]/g,S=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,f=/__decl__/,V=/light\{X\}.(\w*)/g,a=/\{X\}/g,v=[],X=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function R(I){I.processor&&I.processor.initializeShaders&&I.processor.initializeShaders(I.processingContext)}function E(I,g,b,e){var c;null!==(c=g.processor)&&void 0!==c&&c.preProcessShaderCode&&(I=g.processor.preProcessShaderCode(I,g.isFragment)),O(I,g,(I=>{g.processCodeAfterIncludes&&(I=g.processCodeAfterIncludes(g.isFragment?"fragment":"vertex",I,g.defines));const c=function(I,g,b){let e=function(I,g){var b;if(null!==(b=g.processor)&&void 0!==b&&b.noPrecision)return I;const e=g.shouldUseHighPrecisionShader;-1===I.indexOf("precision highp float")?I=e?"precision highp float;\n"+I:"precision mediump float;\n"+I:e||(I=I.replace("precision highp float","precision mediump float"));return I}(I,g);if(!g.processor)return e;if(0===g.processor.shaderLanguage&&-1!==e.indexOf("#version 3")&&(e=e.replace("#version 300 es",""),!g.processor.parseGLES3))return e;const c=g.defines,z=r(g,b);g.processor.preProcessor&&(e=g.processor.preProcessor(e,c,z,g.isFragment,g.processingContext));const M={};e=C(e,z,g,M),g.processor.postProcessor&&(e=g.processor.postProcessor(e,c,g.isFragment,g.processingContext,b?{drawBuffersExtensionDisabled:!b.getCaps().drawBuffersExtension}:{},z,M));null!==b&&void 0!==b&&b._features.needShaderCodeInlining&&(e=b.inlineShaderCode(e));return e}(I,g,e);b(c,I)}))}function mI(I,g,b){return b.processor&&b.processor.finalizeShaders?b.processor.finalizeShaders(I,g,b.processingContext):{vertexCode:I,fragmentCode:g}}function s(I){const g=/defined\((.+)\)/.exec(I);if(g&&g.length)return new o(g[1].trim(),"!"===I[0]);const b=["==","!=",">=","<=","<",">"];let e="",c=0;for(e of b)if(c=I.indexOf(e),c>-1)break;if(-1===c)return new o(I);const z=I.substring(0,c).trim(),M=I.substring(c+e.length).trim();return new D(z,e,M)}function F(I,g){const b=new M,e=I.substring(0,g);let c=I.substring(g);return c=c.substring(0,(c.indexOf("//")+1||c.length+1)-1).trim(),b.testExpression="#ifdef"===e?new o(c):"#ifndef"===e?new o(c,!0):function(I){I=I.replace(Z,"defined[$1]");const g=J.infixToPostfix(I),b=[];for(const c of g)if("||"!==c&&"&&"!==c)b.push(c);else if(b.length>=2){let I=b[b.length-1],g=b[b.length-2];b.length-=2;const e="&&"==c?new G:new n;"string"===typeof I&&(I=I.replace(k,"defined($1)")),"string"===typeof g&&(g=g.replace(k,"defined($1)")),e.leftOperand="string"===typeof g?s(g):g,e.rightOperand="string"===typeof I?s(I):I,b.push(e)}let e=b[b.length-1];return"string"===typeof e&&(e=e.replace(k,"defined($1)")),"string"===typeof e?s(e):e}(c),b}function Y(I,g,b,c){let z=I.currentLine;for(;d(I,b,c);){z=I.currentLine;const M=z.substring(0,5).toLowerCase();if("#else"===M){const b=new e;return g.children.push(b),void d(I,b,c)}if("#elif"===M){const I=F(z,5);g.children.push(I),b=I}}}function d(I,g,b){for(;I.canRead;){I.lineIndex++;const c=I.currentLine;if(c.indexOf("#")>=0){const e=X.exec(c);if(e&&e.length){switch(e[0]){case"#ifdef":{const e=new z;g.children.push(e);const M=F(c,6);e.children.push(M),Y(I,e,M,b);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const e=new z;g.children.push(e);const M=F(c,7);e.children.push(M),Y(I,e,M,b);break}case"#if":{const e=new z,M=F(c,3);g.children.push(e),e.children.push(M),Y(I,e,M,b);break}}continue}}const M=new e;if(M.line=c,g.children.push(M),"#"===c[0]&&"d"===c[1]){const I=c.replace(";","").split(" ");M.additionalDefineKey=I[1],3===I.length&&(M.additionalDefineValue=I[2])}}return!1}function C(I,g,b,z){const M=new e,J=new c;return J.lineIndex=-1,J.lines=I.split("\n"),d(J,M,z),M.process(g,b,z)}function r(I,g){var b;const e=I.defines,c={};for(const z of e){const I=z.replace("#define","").replace(";","").trim().split(" ");c[I[0]]=I.length>1?I[1]:""}return 0===(null===(b=I.processor)||void 0===b?void 0:b.shaderLanguage)&&(c.GL_ES="true"),c.__VERSION__=I.version,c[I.platformName]="true",(0,x.g)(c,null===g||void 0===g?void 0:g.isNDCHalfZRange,null===g||void 0===g?void 0:g.Fg,null===g||void 0===g?void 0:g.useExactSrgbConversions),c}function O(I,g,b){let e;for(v.length=0;null!==(e=S.exec(I));)v.push(e);let c=String(I),z=[I],M=!1;for(const J of v){let I=J[1];if(-1!==I.indexOf("__decl__")&&(I=I.replace(f,""),g.supportsUniformBuffers&&(I=I.replace("Vertex","Ubo").replace("Fragment","Ubo")),I+="Declaration"),!g.includesShadersStore[I]){const e=g.shadersRepository+"ShadersInclude/"+I+".fx";return void H.loadFile(e,(e=>{g.includesShadersStore[I]=e,O(z.join(""),g,b)}))}{let b=g.includesShadersStore[I];if(J[2]){const I=J[3].split(",");for(let g=0;g<I.length;g+=2){const e=new RegExp(I[g],"g"),c=I[g+1];b=b.replace(e,c)}}if(J[4]){const I=J[5];if(-1!==I.indexOf("..")){const e=I.split(".."),c=parseInt(e[0]);let z=parseInt(e[1]),M=b.slice(0);b="",isNaN(z)&&(z=g.indexParameters[e[1]]);for(let I=c;I<z;I++)g.supportsUniformBuffers||(M=M.replace(V,((I,g)=>g+"{X}"))),b+=M.replace(a,I.toString())+"\n"}else g.supportsUniformBuffers||(b=b.replace(V,((I,g)=>g+"{X}"))),b=b.replace(a,I)}const e=[];for(const I of z){const g=I.split(J[0]);for(let I=0;I<g.length-1;I++)e.push(g[I]),e.push(b);e.push(g[g.length-1])}z=e,M=M||b.indexOf("#include<")>=0||b.indexOf("#include <")>=0}}v.length=0,c=z.join(""),M?O(c.toString(),g,b):b(c)}const H={loadFile:(I,g,b,e,c,z)=>{throw(0,p.c)("FileTools")}}},12481:(I,g,b)=>{b.d(g,{c:()=>c,e:()=>z,g:()=>J,k:()=>M,l:()=>o});var e=b(12437);b(12417);const c={};function z(I,g){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(g?g+"\n":"")+I}function M(I,g,b,z,M,J,o){const n=o||c.loadFile;if(n){return n(I,g,b,z,M,J)}throw(0,e.c)("FileTools")}function J(I,g,b,e){if(I)return g?I.IS_NDC_HALF_ZRANGE="":delete I.IS_NDC_HALF_ZRANGE,b?I.USE_REVERSE_DEPTHBUFFER="":delete I.USE_REVERSE_DEPTHBUFFER,void(e?I.USE_EXACT_SRGB_CONVERSIONS="":delete I.USE_EXACT_SRGB_CONVERSIONS);{let I="";return g&&(I+="#define IS_NDC_HALF_ZRANGE"),b&&(I&&(I+="\n"),I+="#define USE_REVERSE_DEPTHBUFFER"),e&&(I&&(I+="\n"),I+="#define USE_EXACT_SRGB_CONVERSIONS"),I}}function o(I,g){let b=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments.length>3?arguments[3]:void 0;switch(I){case 3:{const I=(ArrayBuffer,new Int8Array(g));return e&&I.set(new Int8Array(e)),I}case 0:{const I=(ArrayBuffer,new Uint8Array(g));return e&&I.set(new Uint8Array(e)),I}case 4:{const I=g instanceof ArrayBuffer?new Int16Array(g):new Int16Array(b?g/2:g);return e&&I.set(new Int16Array(e)),I}case 5:case 8:case 9:case 10:case 2:{const I=g instanceof ArrayBuffer?new Uint16Array(g):new Uint16Array(b?g/2:g);return e&&I.set(new Uint16Array(e)),I}case 6:{const I=g instanceof ArrayBuffer?new Int32Array(g):new Int32Array(b?g/4:g);return e&&I.set(new Int32Array(e)),I}case 7:case 11:case 12:case 13:case 14:case 15:{const I=g instanceof ArrayBuffer?new Uint32Array(g):new Uint32Array(b?g/4:g);return e&&I.set(new Uint32Array(e)),I}case 1:{const I=g instanceof ArrayBuffer?new Float32Array(g):new Float32Array(b?g/4:g);return e&&I.set(new Float32Array(e)),I}}const c=(ArrayBuffer,new Uint8Array(g));return e&&c.set(new Uint8Array(e)),c}},12509:(I,g,b)=>{b.d(g,{c:()=>e});class e{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.ShadersRepository:e.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.ShadersStore:e.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?e.IncludesShadersStore:e.IncludesShadersStoreWGSL}}e.ShadersRepository="src/Shaders/",e.ShadersStore={},e.IncludesShadersStore={},e.ShadersRepositoryWGSL="src/ShadersWGSL/",e.ShadersStoreWGSL={},e.IncludesShadersStoreWGSL={}},12519:(I,g,b)=>{b.d(g,{d:()=>p,h:()=>a,i:()=>Z,l:()=>x,n:()=>k,p:()=>V,r:()=>D,s:()=>n,t:()=>G,w:()=>o,z:()=>J});class e{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.kg._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(I){I&&this.program&&I(this.program)}setEngine(I){this.kg=I}_fillEffectInformation(I,g,b,e,c,z,M,J){const o=this.kg;if(o.supportsUniformBuffers)for(const G in g)I.bindUniformBlock(G,g[G]);let n;for(this.kg.getUniforms(this,b).forEach(((I,g)=>{e[b[g]]=I})),this._uniforms=e,n=0;n<c.length;n++){null==I.getUniform(c[n])&&(c.splice(n,1),n--)}c.forEach(((I,g)=>{z[I]=g}));for(const G of o.getAttributes(this,M))J.push(G)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(I,g){const b=this._valueCache[I],e=g.updateFlag;return(void 0===b||b!==e)&&(this._valueCache[I]=e,!0)}_cacheFloat2(I,g,b){let e=this._valueCache[I];if(!e||2!==e.length)return e=[g,b],this._valueCache[I]=e,!0;let c=!1;return e[0]!==g&&(e[0]=g,c=!0),e[1]!==b&&(e[1]=b,c=!0),c}_cacheFloat3(I,g,b,e){let c=this._valueCache[I];if(!c||3!==c.length)return c=[g,b,e],this._valueCache[I]=c,!0;let z=!1;return c[0]!==g&&(c[0]=g,z=!0),c[1]!==b&&(c[1]=b,z=!0),c[2]!==e&&(c[2]=e,z=!0),z}_cacheFloat4(I,g,b,e,c){let z=this._valueCache[I];if(!z||4!==z.length)return z=[g,b,e,c],this._valueCache[I]=z,!0;let M=!1;return z[0]!==g&&(z[0]=g,M=!0),z[1]!==b&&(z[1]=b,M=!0),z[2]!==e&&(z[2]=e,M=!0),z[3]!==c&&(z[3]=c,M=!0),M}setInt(I,g){const b=this._valueCache[I];void 0!==b&&b===g||this.kg.setInt(this._uniforms[I],g)&&(this._valueCache[I]=g)}setInt2(I,g,b){this._cacheFloat2(I,g,b)&&(this.kg.setInt2(this._uniforms[I],g,b)||(this._valueCache[I]=null))}setInt3(I,g,b,e){this._cacheFloat3(I,g,b,e)&&(this.kg.setInt3(this._uniforms[I],g,b,e)||(this._valueCache[I]=null))}setInt4(I,g,b,e,c){this._cacheFloat4(I,g,b,e,c)&&(this.kg.setInt4(this._uniforms[I],g,b,e,c)||(this._valueCache[I]=null))}setIntArray(I,g){this._valueCache[I]=null,this.kg.setIntArray(this._uniforms[I],g)}setIntArray2(I,g){this._valueCache[I]=null,this.kg.setIntArray2(this._uniforms[I],g)}setIntArray3(I,g){this._valueCache[I]=null,this.kg.setIntArray3(this._uniforms[I],g)}setIntArray4(I,g){this._valueCache[I]=null,this.kg.setIntArray4(this._uniforms[I],g)}setUInt(I,g){const b=this._valueCache[I];void 0!==b&&b===g||this.kg.setUInt(this._uniforms[I],g)&&(this._valueCache[I]=g)}setUInt2(I,g,b){this._cacheFloat2(I,g,b)&&(this.kg.setUInt2(this._uniforms[I],g,b)||(this._valueCache[I]=null))}setUInt3(I,g,b,e){this._cacheFloat3(I,g,b,e)&&(this.kg.setUInt3(this._uniforms[I],g,b,e)||(this._valueCache[I]=null))}setUInt4(I,g,b,e,c){this._cacheFloat4(I,g,b,e,c)&&(this.kg.setUInt4(this._uniforms[I],g,b,e,c)||(this._valueCache[I]=null))}setUIntArray(I,g){this._valueCache[I]=null,this.kg.setUIntArray(this._uniforms[I],g)}setUIntArray2(I,g){this._valueCache[I]=null,this.kg.setUIntArray2(this._uniforms[I],g)}setUIntArray3(I,g){this._valueCache[I]=null,this.kg.setUIntArray3(this._uniforms[I],g)}setUIntArray4(I,g){this._valueCache[I]=null,this.kg.setUIntArray4(this._uniforms[I],g)}setArray(I,g){this._valueCache[I]=null,this.kg.setArray(this._uniforms[I],g)}setArray2(I,g){this._valueCache[I]=null,this.kg.setArray2(this._uniforms[I],g)}setArray3(I,g){this._valueCache[I]=null,this.kg.setArray3(this._uniforms[I],g)}setArray4(I,g){this._valueCache[I]=null,this.kg.setArray4(this._uniforms[I],g)}setMatrices(I,g){g&&(this._valueCache[I]=null,this.kg.setMatrices(this._uniforms[I],g))}setMatrix(I,g){this._cacheMatrix(I,g)&&(this.kg.setMatrices(this._uniforms[I],g.bb())||(this._valueCache[I]=null))}setMatrix3x3(I,g){this._valueCache[I]=null,this.kg.setMatrix3x3(this._uniforms[I],g)}setMatrix2x2(I,g){this._valueCache[I]=null,this.kg.setMatrix2x2(this._uniforms[I],g)}setFloat(I,g){const b=this._valueCache[I];void 0!==b&&b===g||this.kg.setFloat(this._uniforms[I],g)&&(this._valueCache[I]=g)}setVector2(I,g){this._cacheFloat2(I,g.x,g.y)&&(this.kg.setFloat2(this._uniforms[I],g.x,g.y)||(this._valueCache[I]=null))}setFloat2(I,g,b){this._cacheFloat2(I,g,b)&&(this.kg.setFloat2(this._uniforms[I],g,b)||(this._valueCache[I]=null))}setVector3(I,g){this._cacheFloat3(I,g.x,g.y,g.z)&&(this.kg.setFloat3(this._uniforms[I],g.x,g.y,g.z)||(this._valueCache[I]=null))}setFloat3(I,g,b,e){this._cacheFloat3(I,g,b,e)&&(this.kg.setFloat3(this._uniforms[I],g,b,e)||(this._valueCache[I]=null))}setVector4(I,g){this._cacheFloat4(I,g.x,g.y,g.z,g.w)&&(this.kg.setFloat4(this._uniforms[I],g.x,g.y,g.z,g.w)||(this._valueCache[I]=null))}setQuaternion(I,g){this._cacheFloat4(I,g.x,g.y,g.z,g.w)&&(this.kg.setFloat4(this._uniforms[I],g.x,g.y,g.z,g.w)||(this._valueCache[I]=null))}setFloat4(I,g,b,e,c){this._cacheFloat4(I,g,b,e,c)&&(this.kg.setFloat4(this._uniforms[I],g,b,e,c)||(this._valueCache[I]=null))}setColor3(I,g){this._cacheFloat3(I,g.r,g.g,g.b)&&(this.kg.setFloat3(this._uniforms[I],g.r,g.g,g.b)||(this._valueCache[I]=null))}setColor4(I,g,b){this._cacheFloat4(I,g.r,g.g,g.b,b)&&(this.kg.setFloat4(this._uniforms[I],g.r,g.g,g.b,b)||(this._valueCache[I]=null))}setDirectColor4(I,g){this._cacheFloat4(I,g.r,g.g,g.b,g.a)&&(this.kg.setFloat4(this._uniforms[I],g.r,g.g,g.b,g.a)||(this._valueCache[I]=null))}_getVertexShaderCode(){return this.vertexShader?this.kg._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.kg._getShaderSource(this.fragmentShader):null}}var c=b(12481);const z=new WeakMap,M={_webGLVersion:2,cachedPipelines:{}};function J(I){let g=z.get(I);if(!g){if(!I)return M;g={_webGLVersion:I.TEXTURE_BINDING_3D?2:1,_context:I,parallelShaderCompile:I.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},z.set(I,g)}return g}function o(I){z.delete(I)}function n(I,g,b,e,c,z){const M=J(e);z||(z=M._createShaderProgramInjection??p);return z(I,f(g,"vertex",e,M._contextWasLost),f(b,"fragment",e,M._contextWasLost),e,c,M.validateShaderPrograms)}function G(I,g,b,e,c){let z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,M=arguments.length>6?arguments[6]:void 0;const o=J(c);M||(M=o._createShaderProgramInjection??p);const n=o._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return M(I,S(g,"vertex",e,n,c,o._contextWasLost),S(b,"fragment",e,n,c,o._contextWasLost),c,z,o.validateShaderPrograms)}function D(I,g){const b=new e,c=J(I);return c.parallelShaderCompile&&!c.disableParallelShaderCompile&&(b.isParallelCompiled=!0),b.context=c._context,b}function p(I,g,b,e){let c=arguments.length>5?arguments[5]:void 0;const z=e.createProgram();if(I.program=z,!z)throw new Error("Unable to create program");return e.attachShader(z,g),e.attachShader(z,b),e.linkProgram(z),I.context=e,I.vertexShader=g,I.fragmentShader=b,I.isParallelCompiled||Z(I,e,c),z}function x(I,g,b){const e=I;if(e._isDisposed)return!1;const c=J(g);return!!(c&&c.parallelShaderCompile&&c.parallelShaderCompile.COMPLETION_STATUS_KHR&&e.program&&g.getProgramParameter(e.program,c.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(Z(e,g,b),!0)}function Z(I,g,b){const e=I.context,c=I.vertexShader,z=I.fragmentShader,M=I.program;if(!e.getProgramParameter(M,e.LINK_STATUS)){if(!g.getShaderParameter(c,g.COMPILE_STATUS)){const b=g.getShaderInfoLog(c);if(b)throw I.vertexCompilationError=b,new Error("VERTEX SHADER "+b)}if(!g.getShaderParameter(z,g.COMPILE_STATUS)){const b=g.getShaderInfoLog(z);if(b)throw I.fragmentCompilationError=b,new Error("FRAGMENT SHADER "+b)}const b=e.getProgramInfoLog(M);if(b)throw I.programLinkError=b,new Error(b)}if(b){e.validateProgram(M);if(!e.getProgramParameter(M,e.VALIDATE_STATUS)){const g=e.getProgramInfoLog(M);if(g)throw I.programValidationError=g,new Error(g)}}e.deleteShader(c),e.deleteShader(z),I.vertexShader=void 0,I.fragmentShader=void 0,I.onCompiled&&(I.onCompiled(),I.onCompiled=void 0)}function k(I,g,b,e,c,z,M,o,D){let p=arguments.length>10?arguments[10]:void 0,x=arguments.length>11?arguments[11]:void 0,Z=arguments.length>12?arguments[12]:void 0;const k=J(I.context);x||(x=k.createRawShaderProgramInjection??n),Z||(Z=k.createShaderProgramInjection??G);const S=I;S.program=e?x(S,g,b,S.context,D):Z(S,g,b,o,S.context,D),S.program.__SPECTOR_rebuildProgram=M,p()}function S(I,g,b,e,z,M){return f((0,c.e)(I,b,e),g,z,M)}function f(I,g,b,e){const c=b.createShader("vertex"===g?b.VERTEX_SHADER:b.FRAGMENT_SHADER);if(!c){let I=b.NO_ERROR,c=b.NO_ERROR;for(;(c=b.getError())!==b.NO_ERROR;)I=c;throw new Error(`Something went wrong while creating a gl ${g} shader object. gl error=${I}, gl isContextLost=${b.isContextLost()}, _contextWasLost=${e}`)}return b.shaderSource(c,I),b.compileShader(c),c}function V(I,g){g.useProgram(I)}function a(I,g){const b=I;if(!b.isParallelCompiled)return void g(I);const e=b.onCompiled;b.onCompiled=()=>{null===e||void 0===e||e(),g(I)}}},12514:(I,g,b)=>{b.d(g,{b:()=>D,d:()=>x,g:()=>n,h:()=>G});var e=b(12417),c=b(12519),z=b(12509),M=b(12420),J=b(12474),o=b(12481);function n(I,g){return(0,c.z)(g).cachedPipelines[I]}function G(I){const g=I._name,b=I.context;if(g&&b){const I=(0,c.z)(b),e=I.cachedPipelines[g];null===e||void 0===e||e.dispose(),delete I.cachedPipelines[g]}}function D(I,g,b,c,z,M,o){let n,G;const D=(0,e.g)()?null===M||void 0===M?void 0:M.getHostDocument():null;n="string"===typeof g?g:g.vertexSource?"source:"+g.vertexSource:g.vertexElement?(null===D||void 0===D?void 0:D.getElementById(g.vertexElement))||g.vertexElement:g.vertex||g,G="string"===typeof g?g:g.fragmentSource?"source:"+g.fragmentSource:g.fragmentElement?(null===D||void 0===D?void 0:D.getElementById(g.fragmentElement))||g.fragmentElement:g.fragment||g;const x=[void 0,void 0],Z=()=>{if(x[0]&&x[1]){I.isFragment=!0;const[e,n]=x;(0,J.j)(n,I,((M,n)=>{o&&(o._fragmentSourceCodeBeforeMigration=n),b&&(M=b("fragment",M));const G=(0,J.b)(e,M,I);I=null;const D=function(I,g,b,e){if(b){return{vertexSourceCode:(1===e?"//":"")+"#define SHADER_NAME vertex:"+(b.vertexElement||b.vertex||b.spectorName||b)+"\n"+I,fragmentSourceCode:(1===e?"//":"")+"#define SHADER_NAME fragment:"+(b.fragmentElement||b.fragment||b.spectorName||b)+"\n"+g}}return{vertexSourceCode:I,fragmentSourceCode:g}}(G.vertexCode,G.fragmentCode,g,z);null===c||void 0===c||c(D.vertexSourceCode,D.fragmentSourceCode)}),M)}};p(n,"Vertex","",(g=>{(0,J.d)(I),(0,J.j)(g,I,((I,e)=>{o&&(o._rawVertexSourceCode=g,o._vertexSourceCodeBeforeMigration=e),b&&(I=b("vertex",I)),x[0]=I,Z()}),M)}),z),p(G,"Fragment","Pixel",(I=>{o&&(o._rawFragmentSourceCode=I),x[1]=I,Z()}),z)}function p(I,g,b,c,M,J){if("undefined"!==typeof HTMLElement&&I instanceof HTMLElement){return void c((0,e.c)(I))}if("source:"===I.substring(0,7))return void c(I.substring(7));if("base64:"===I.substring(0,7)){return void c(window.atob(I.substring(7)))}const n=z.c.GetShadersStore(M);if(n[I+g+"Shader"])return void c(n[I+g+"Shader"]);if(b&&n[I+b+"Shader"])return void c(n[I+b+"Shader"]);let G;if(G="."===I[0]||"/"===I[0]||I.indexOf("http")>-1?I:z.c.GetShadersRepository(M)+I,!(J=J||o.k))throw new Error("loadFileInjection is not defined");J(G+"."+g.toLowerCase()+".fx",c)}const x=(I,g,b,e)=>{try{const z=I.context?(0,c.z)(I.context):null;z&&(z.disableParallelShaderCompile=I.disableParallelCompilation);const M=I.existingPipelineContext||g(I.shaderProcessingContext);return M._name=I.name,I.name&&z&&(z.cachedPipelines[I.name]=M),b(M,I.vertex,I.fragment,!!I.createAsRaw,"","",I.rebuildRebind,I.defines,I.transformFeedbackVaryings,"",(()=>{e(M,(()=>{var g;null===(g=I.onRenderingStateCompiled)||void 0===g||g.call(I,M)}))})),M}catch(z){throw M.b.Error("Error compiling effect"),z}}},12505:(I,g,b)=>{b.r(g),b.d(g,{Effect:()=>o});var e=b(12412),c=b(12420),z=b(12509),M=b(12514),J=b(12488);class o{static get ShadersRepository(){return z.c.ShadersRepository}static set ShadersRepository(I){z.c.ShadersRepository=I}get Z(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new e.c),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(I,g,b){let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,z=arguments.length>4?arguments[4]:void 0,J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,G=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,D=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,p=arguments.length>9?arguments[9]:void 0,x=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",Z=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,k=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new e.c,this.onErrorObservable=new e.c,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=I,this._key=x;const S=this._key.replace(/\r/g,"").replace(/\n/g,"|");let f;if(g.attributes){const I=g;if(this._engine=b,this._attributesNames=I.attributes,this._uniformsNames=I.uniformsNames.concat(I.samplers),this._samplerList=I.samplers.slice(),this.defines=I.defines,this.onError=I.onError,this.onCompiled=I.onCompiled,this._fallbacks=I.fallbacks,this._indexParameters=I.indexParameters,this._transformFeedbackVaryings=I.transformFeedbackVaryings||null,this._multiTarget=!!I.multiTarget,this._shaderLanguage=I.shaderLanguage??0,this._disableParallelShaderCompilation=!!I.disableParallelShaderCompilation,I.uniformBuffersNames){this._uniformBuffersNamesList=I.uniformBuffersNames.slice();for(let g=0;g<I.uniformBuffersNames.length;g++)this._uniformBuffersNames[I.uniformBuffersNames[g]]=g}this._processFinalCode=I.processFinalCode??null,this._processCodeAfterIncludes=I.processCodeAfterIncludes??void 0,k=I.extraInitializationsAsync,f=I.existingPipelineContext}else this._engine=z,this.defines=null==J?"":J,this._uniformsNames=b.concat(c),this._samplerList=c?c.slice():[],this._attributesNames=g,this._uniformBuffersNamesList=[],this._shaderLanguage=Z,this.onError=D,this.onCompiled=G,this._indexParameters=p,this._fallbacks=n;"WEBGL2"===this._engine.shaderPlatformName&&(f=(0,M.g)(S,this._engine._gl)??f),this._attributeLocationByName={},this.uniqueId=o._UniqueIdSeed++,f?(this._pipelineContext=f,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,k),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.Z||this.dispose(!0)}))}async _processShaderCodeAsync(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,g=arguments.length>1&&void 0!==arguments[1]&&arguments[1],b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=arguments.length>3?arguments[3]:void 0;e&&await e(),this._processingContext=b||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const c={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:I??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:z.c.GetShadersRepository(this._shaderLanguage),includesShadersStore:z.c.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,Fg:this._engine.Fg,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,M.b)(c,this.name,this._processFinalCode,((I,b)=>{this._vertexSourceCode=I,this._fragmentSourceCode=b,this._prepareEffect(g)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.Z||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(I){return this._attributes[I]}getAttributeLocationByName(I){return this._attributeLocationByName[I]}getAttributesCount(){return this._attributes.length}getUniformIndex(I){return this._uniformsNames.indexOf(I)}getUniform(I){return this._uniforms[I]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((I=>{this.executeWhenCompiled(I)}))}executeWhenCompiled(I){this.isReady()?I(this):(this.onCompileObservable.add((g=>{I(g)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(I){(0,J.e)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(g=>{this._processCompilationErrors(g,I)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var I;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(I=this._pipelineContext)||void 0===I?void 0:I._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,Fg:this._engine.Fg,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(I,g,b,e){this._isReady=!1,this._vertexSourceCodeOverride=I,this._fragmentSourceCodeOverride=g,this.onError=(I,g)=>{e&&e(g)},this.onCompiled=()=>{var I,g;const e=this.getEngine().scenes;if(e)for(let b=0;b<e.length;b++)e[b].markAllMaterialsAsDirty(127);null===(I=(g=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===I||I.call(g,b)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(I){if(this._pipelineContext=I,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let g=0;g<this._attributesNames.length;g++){const I=this._attributesNames[g];this._attributeLocationByName[I]=this._attributes[g]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),o.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const g=this._pipelineContext;this._isReady=!1;try{const b=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),e=b?null:this.defines,c=b?this._vertexSourceCodeOverride:this._vertexSourceCode,z=b?this._fragmentSourceCodeOverride:this._fragmentSourceCode,J=this._engine;this._pipelineContext=(0,M.d)({existingPipelineContext:I?g:null,vertex:c,fragment:z,context:"WEBGL2"===J.shaderPlatformName||"WEBGL1"===J.shaderPlatformName?J._gl:void 0,rebuildRebind:(I,g,b,e)=>this._rebuildProgram(I,g,b,e),defines:e,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:b,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:b=>{g&&!I&&this._engine._deletePipelineContext(g),b&&this._onRenderingStateCompiled(b)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(g)}catch(b){this._processCompilationErrors(b,g)}}_getShaderCodeAndErrorLine(I,g,b){const e=b?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let c=null;if(g&&I){const z=g.match(e);if(z&&2===z.length){const g=parseInt(z[1]),e=I.split("\n",-1);e.length>=g&&(c=`Offending line [${g}] in ${b?"fragment":"vertex"} code: ${e[g-1]}`)}}return[I,c]}_processCompilationErrors(I){let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=I.message;const b=this._attributesNames,e=this._fallbacks;if(c.b.Error("Unable to compile effect:"),c.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),c.b.Error(`Attributes: ${b.join(" ")}`),c.b.Error("Defines:\n"+this.defines),o.LogShaderCodeOnCompilationError){var z,M;let I=null,g=null,b=null;var J;if(null!==(z=this._pipelineContext)&&void 0!==z&&z._getVertexShaderCode()&&([b,I]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),b&&(c.b.Error("Vertex code:"),c.b.Error(b))),null!==(M=this._pipelineContext)&&void 0!==M&&M._getFragmentShaderCode())[b,g]=this._getShaderCodeAndErrorLine(null===(J=this._pipelineContext)||void 0===J?void 0:J._getFragmentShaderCode(),this._compilationError,!0),b&&(c.b.Error("Fragment code:"),c.b.Error(b));I&&c.b.Error(I),g&&c.b.Error(g)}c.b.Error("Error: "+this._compilationError);const n=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};g&&(this._pipelineContext=g,this._isReady=!0,n()),e?(this._pipelineContext=null,e.hasMoreFallbacks?(this._allFallbacksProcessed=!1,c.b.Error("Trying next fallback."),this.defines=e.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,n(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,g||n())}get isSupported(){return""===this._compilationError}_bindTexture(I,g){this._engine._bindTexture(this._samplers[I],g,I)}setTexture(I,g){this._engine.setTexture(this._samplers[I],this._uniforms[I],g,I)}setTextureArray(I,g){const b=I+"Ex";if(-1===this._samplerList.indexOf(b+"0")){const e=this._samplerList.indexOf(I);for(let I=1;I<g.length;I++){const g=b+(I-1).toString();this._samplerList.splice(e+I,0,g)}let c=0;for(const I of this._samplerList)this._samplers[I]=c,c+=1}this._engine.setTextureArray(this._samplers[I],this._uniforms[I],g,I)}bindUniformBuffer(I,g){const b=this._uniformBuffersNames[g];void 0===b||o._BaseCache[b]===I&&this._engine._features.useUBOBindingCache||(o._BaseCache[b]=I,this._engine.bindUniformBufferBase(I,b,g))}bindUniformBlock(I,g){this._engine.bindUniformBlock(this._pipelineContext,I,g)}setInt(I,g){return this._pipelineContext.setInt(I,g),this}setInt2(I,g,b){return this._pipelineContext.setInt2(I,g,b),this}setInt3(I,g,b,e){return this._pipelineContext.setInt3(I,g,b,e),this}setInt4(I,g,b,e,c){return this._pipelineContext.setInt4(I,g,b,e,c),this}setIntArray(I,g){return this._pipelineContext.setIntArray(I,g),this}setIntArray2(I,g){return this._pipelineContext.setIntArray2(I,g),this}setIntArray3(I,g){return this._pipelineContext.setIntArray3(I,g),this}setIntArray4(I,g){return this._pipelineContext.setIntArray4(I,g),this}setUInt(I,g){return this._pipelineContext.setUInt(I,g),this}setUInt2(I,g,b){return this._pipelineContext.setUInt2(I,g,b),this}setUInt3(I,g,b,e){return this._pipelineContext.setUInt3(I,g,b,e),this}setUInt4(I,g,b,e,c){return this._pipelineContext.setUInt4(I,g,b,e,c),this}setUIntArray(I,g){return this._pipelineContext.setUIntArray(I,g),this}setUIntArray2(I,g){return this._pipelineContext.setUIntArray2(I,g),this}setUIntArray3(I,g){return this._pipelineContext.setUIntArray3(I,g),this}setUIntArray4(I,g){return this._pipelineContext.setUIntArray4(I,g),this}setFloatArray(I,g){return this._pipelineContext.setArray(I,g),this}setFloatArray2(I,g){return this._pipelineContext.setArray2(I,g),this}setFloatArray3(I,g){return this._pipelineContext.setArray3(I,g),this}setFloatArray4(I,g){return this._pipelineContext.setArray4(I,g),this}setArray(I,g){return this._pipelineContext.setArray(I,g),this}setArray2(I,g){return this._pipelineContext.setArray2(I,g),this}setArray3(I,g){return this._pipelineContext.setArray3(I,g),this}setArray4(I,g){return this._pipelineContext.setArray4(I,g),this}setMatrices(I,g){return this._pipelineContext.setMatrices(I,g),this}setMatrix(I,g){return this._pipelineContext.setMatrix(I,g),this}setMatrix3x3(I,g){return this._pipelineContext.setMatrix3x3(I,g),this}setMatrix2x2(I,g){return this._pipelineContext.setMatrix2x2(I,g),this}setFloat(I,g){return this._pipelineContext.setFloat(I,g),this}setBool(I,g){return this._pipelineContext.setInt(I,g?1:0),this}setVector2(I,g){return this._pipelineContext.setVector2(I,g),this}setFloat2(I,g,b){return this._pipelineContext.setFloat2(I,g,b),this}setVector3(I,g){return this._pipelineContext.setVector3(I,g),this}setFloat3(I,g,b,e){return this._pipelineContext.setFloat3(I,g,b,e),this}setVector4(I,g){return this._pipelineContext.setVector4(I,g),this}setQuaternion(I,g){return this._pipelineContext.setQuaternion(I,g),this}setFloat4(I,g,b,e,c){return this._pipelineContext.setFloat4(I,g,b,e,c),this}setColor3(I,g){return this._pipelineContext.setColor3(I,g),this}setColor4(I,g,b){return this._pipelineContext.setColor4(I,g,b),this}setDirectColor4(I,g){return this._pipelineContext.setDirectColor4(I,g),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(o.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,M.h)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(I,g,b){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;g&&(z.c.GetShadersStore(e)[`${I}PixelShader`]=g),b&&(z.c.GetShadersStore(e)[`${I}VertexShader`]=b)}static ResetCache(){o._BaseCache={}}}o.LogShaderCodeOnCompilationError=!0,o.PersistentMode=!1,o.AutomaticallyClearCodeCache=!1,o._UniqueIdSeed=0,o._BaseCache={},o.ShadersStore=z.c.ShadersStore,o.IncludesShadersStore=z.c.IncludesShadersStore},12437:(I,g,b)=>{b.d(g,{c:()=>c});const e={};function c(I){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!e[I])return e[I]=!0,`${I} needs to be imported before as it contains a side-effect required by your code.`}},12417:(I,g,b)=>{function e(){return"undefined"!==typeof window}function c(){return"undefined"!==typeof navigator}function z(){return"undefined"!==typeof document}function M(I){let g="",b=I.firstChild;for(;b;)3===b.nodeType&&(g+=b.textContent),b=b.nextSibling;return g}b.d(g,{c:()=>M,d:()=>z,e:()=>c,g:()=>e})},12420:(I,g,b)=>{b.d(g,{b:()=>e});class e{static _CheckLimit(I,g){let b=e._LogLimitOutputs[I];return b?b.current++:(b={limit:g,current:1},e._LogLimitOutputs[I]=b),b.current<=b.limit}static _GenerateLimitMessage(I){let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const b=e._LogLimitOutputs[I];if(!b||!e.MessageLimitReached)return;const c=this._Levels[g];b.current===b.limit&&e[c.name](e.MessageLimitReached.replace(/%LIMIT%/g,""+b.limit).replace(/%TYPE%/g,c.name??""))}static _AddLogEntry(I){e._LogCache=I+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(I)}static _FormatMessage(I){const g=I=>I<10?"0"+I:""+I,b=new Date;return"["+g(b.getHours())+":"+g(b.getMinutes())+":"+g(b.getSeconds())+"]: "+I}static _LogDisabled(I,g){}static _LogEnabled(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,g=arguments.length>1?arguments[1]:void 0,b=arguments.length>2?arguments[2]:void 0;const c=Array.isArray(g)?g[0]:g;if(void 0!==b&&!e._CheckLimit(c,b))return;const z=e._FormatMessage(c),M=this._Levels[I],J=Array.isArray(g)?g.slice(1):[];M.logFunc&&M.logFunc("BJS - "+z,...J);const o=`<div style='color:${M.color}'>${z}</div><br>`;e._AddLogEntry(o),e._GenerateLimitMessage(c,I)}static get LogCache(){return e._LogCache}static ClearLogCache(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0}static set LogLevels(I){e.Log=e._LogDisabled,e.Warn=e._LogDisabled,e.Error=e._LogDisabled;const g=[e.MessageLogLevel,e.WarningLogLevel,e.ErrorLogLevel];for(const b of g)if((I&b)===b){const I=this._Levels[b];e[I.name]=e._LogEnabled.bind(e,b)}}}e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",e._LogCache="",e._LogLimitOutputs={},e._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],e.errorsCount=0,e.Log=e._LogEnabled.bind(e,e.MessageLogLevel),e.Warn=e._LogEnabled.bind(e,e.WarningLogLevel),e.Error=e._LogEnabled.bind(e,e.ErrorLogLevel)},12412:(I,g,b)=>{b.d(g,{c:()=>M});const e="undefined"!==typeof WeakRef;class c{constructor(I){let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1],b=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0;this.initialize(I,g,b,e)}initialize(I){let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1],b=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0;return this.mask=I,this.skipNextObservers=g,this.target=b,this.currentTarget=e,this}}class z{constructor(I,g){let b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=I,this.mask=g,this.scope=b,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(I)}}class M{static FromPromise(I,g){const b=new M;return I.then((I=>{b.notifyObservers(I)})).catch((I=>{if(!g)throw I;g.notifyObservers(I)})),b}get observers(){return this._observers}constructor(I){let g=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=g,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new c(0),I&&(this._onObserverAdded=I)}add(I){let g=arguments.length>2&&void 0!==arguments[2]&&arguments[2],b=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!I)return null;const c=new z(I,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);c.unregisterOnNextCall=b,g?this._observers.unshift(c):this._observers.push(c),this._onObserverAdded&&this._onObserverAdded(c),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(c,this._lastNotifiedValue);const M=e?new WeakRef(this):{deref:()=>this};return c._remove=function(){let I=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const g=M.deref();g&&(I?g.remove(c):g._remove(c))},c}addOnce(I){return this.add(I,void 0,void 0,void 0,!0)}remove(I){if(!I)return!1;I._remove=null;return-1!==this._observers.indexOf(I)&&(this._deferUnregister(I),!0)}removeCallback(I,g){for(let b=0;b<this._observers.length;b++){const e=this._observers[b];if(!e._willBeUnregistered&&(e.callback===I&&(!g||g===e.scope)))return this._deferUnregister(e),!0}return!1}_deferUnregister(I){I._willBeUnregistered||(this._numObserversMarkedAsDeleted++,I.unregisterOnNextCall=!1,I._willBeUnregistered=!0,setTimeout((()=>{this._remove(I)}),0))}_remove(I){let g=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!I)return!1;const b=this._observers.indexOf(I);return-1!==b&&(g&&this._numObserversMarkedAsDeleted--,this._observers.splice(b,1),!0)}makeObserverTopPriority(I){this._remove(I,!1),this._observers.unshift(I)}makeObserverBottomPriority(I){this._remove(I,!1),this._observers.push(I)}notifyObservers(I){let g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,b=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=I),!this._observers.length)return!0;const z=this._eventState;z.mask=g,z.target=b,z.currentTarget=e,z.skipNextObservers=!1,z.lastReturnValue=I,z.userInfo=c;for(const M of this._observers)if(!M._willBeUnregistered&&(M.mask&g&&(M.unregisterOnNextCall&&this._deferUnregister(M),M.scope?z.lastReturnValue=M.callback.apply(M.scope,[I,z]):z.lastReturnValue=M.callback(I,z)),z.skipNextObservers))return!1;return!0}notifyObserver(I,g){let b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=g),I._willBeUnregistered)return;const e=this._eventState;e.mask=b,e.skipNextObservers=!1,I.unregisterOnNextCall&&this._deferUnregister(I),I.callback(g,e)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const I=this._observers.pop();I&&(I._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const I=new M;return I._observers=this._observers.slice(0),I}hasSpecificMask(){let I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const g of this._observers)if(g.mask&I||g.mask===I)return!0;return!1}}},12488:(I,g,b)=>{b.d(g,{d:()=>c,e:()=>M});let e=[];class c{static SetImmediate(I){0===e.length&&setTimeout((()=>{const I=e;e=[];for(const g of I)g()}),1),e.push(I)}}function z(I,g,b){try{if(I())return g(),!0}catch(e){return null===b||void 0===b||b(e),!0}return!1}const M=function(I,g,b){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,M=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&z(I,g,b))return null;const J=setInterval((()=>{z(I,g,b)?clearInterval(J):(c-=e,c<0&&(clearInterval(J),null===b||void 0===b||b(new Error("Operation timed out after maximum retries. "+(M||"")),!0)))}),e);return()=>clearInterval(J)}}}]);