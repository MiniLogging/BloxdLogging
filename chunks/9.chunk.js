"use strict";(self.r00gjvkwa6=self.r00gjvkwa6||[]).push([[9],{11194:(H,O,S)=>{S.d(O,{d:()=>l,h:()=>F,k:()=>Y,i:()=>g,l:()=>N});class t{constructor(){this.children=[]}isValid(H){return!0}process(H,O,S){let t="";if(this.line){let S=this.line;const o=O.processor;if(o){var q,p,G,U,V,w;o.lineProcessor&&(S=o.lineProcessor(S,O.isFragment,O.processingContext));const t=(null===(q=O.processor)||void 0===q?void 0:q.attributeKeywordName)??"attribute",h=O.isFragment&&null!==(p=O.processor)&&void 0!==p&&p.varyingFragmentKeywordName?null===(G=O.processor)||void 0===G?void 0:G.varyingFragmentKeywordName:!O.isFragment&&null!==(U=O.processor)&&void 0!==U&&U.varyingVertexKeywordName?null===(V=O.processor)||void 0===V?void 0:V.varyingVertexKeywordName:"varying";if(!O.isFragment&&o.attributeProcessor&&this.line.startsWith(t))S=o.attributeProcessor(this.line,H,O.processingContext);else if(o.varyingProcessor&&(null!==(w=o.varyingCheck)&&void 0!==w&&w.call(o,this.line,O.isFragment)||!o.varyingCheck&&this.line.startsWith(h)))S=o.varyingProcessor(this.line,O.isFragment,H,O.processingContext);else if(o.uniformProcessor&&o.uniformRegexp&&o.uniformRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(S=o.uniformProcessor(this.line,O.isFragment,H,O.processingContext));else if(o.uniformBufferProcessor&&o.uniformBufferRegexp&&o.uniformBufferRegexp.test(this.line))O.lookForClosingBracketForUniformBuffer||(S=o.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0);else if(o.textureProcessor&&o.textureRegexp&&o.textureRegexp.test(this.line))S=o.textureProcessor(this.line,O.isFragment,H,O.processingContext);else if((o.uniformProcessor||o.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!O.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?o.uniformProcessor&&(S=o.uniformProcessor(this.line,O.isFragment,H,O.processingContext)):o.uniformBufferProcessor&&(S=o.uniformBufferProcessor(this.line,O.isFragment,O.processingContext),O.lookForClosingBracketForUniformBuffer=!0)}O.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(O.lookForClosingBracketForUniformBuffer=!1,o.endOfUniformBufferProcessor&&(S=o.endOfUniformBufferProcessor(this.line,O.isFragment,O.processingContext)))}t+=S+"\n"}for(const o of this.children)t+=o.process(H,O,S);return this.additionalDefineKey&&(H[this.additionalDefineKey]=this.additionalDefineValue||"true",S[this.additionalDefineKey]=H[this.additionalDefineKey]),t}}class q{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(H){this._lines.length=0;for(const O of H){if(!O||"\r"===O)continue;if("#"===O[0]){this._lines.push(O);continue}const H=O.trim();if(!H)continue;if(H.startsWith("//")){this._lines.push(O);continue}const S=H.indexOf(";");if(-1===S)this._lines.push(H);else if(S===H.length-1)H.length>1&&this._lines.push(H);else{const H=O.split(";");for(let O=0;O<H.length;O++){let S=H[O];S&&(S=S.trim(),S&&this._lines.push(S+(O!==H.length-1?";":"")))}}}}}class p extends t{process(H,O,S){for(let t=0;t<this.children.length;t++){const q=this.children[t];if(q.isValid(H))return q.process(H,O,S)}return""}}class G extends t{isValid(H){return this.testExpression.isTrue(H)}}class U{isTrue(H){return!0}static postfixToInfix(H){const O=[];for(const S of H)if(void 0===U._OperatorPriority[S])O.push(S);else{const H=O[O.length-1],t=O[O.length-2];O.length-=2,O.push(`(${t}${S}${H})`)}return O[O.length-1]}static infixToPostfix(H){const O=U._InfixToPostfixCache.get(H);if(O)return O.accessTime=Date.now(),O.result;if(!H.includes("&&")&&!H.includes("||")&&!H.includes(")")&&!H.includes("("))return[H];const S=[];let t=-1;const q=()=>{o=o.trim(),""!==o&&(S.push(o),o="")},p=H=>{t<U._Stack.length-1&&(U._Stack[++t]=H)},G=()=>U._Stack[t],V=()=>-1===t?"!!INVALID EXPRESSION!!":U._Stack[t--];let w=0,o="";for(;w<H.length;){const O=H.charAt(w),h=w<H.length-1?H.substring(w,2+w):"";if("("===O)o="",p(O);else if(")"===O){for(q();-1!==t&&"("!==G();)S.push(V());V()}else if(U._OperatorPriority[h]>1){for(q();-1!==t&&U._OperatorPriority[G()]>=U._OperatorPriority[h];)S.push(V());p(h),w++}else o+=O;w++}for(q();-1!==t;)"("===G()?V():S.push(V());return U._InfixToPostfixCache.size>=U.InfixToPostfixCacheLimitSize&&U.ClearCache(),U._InfixToPostfixCache.set(H,{result:S,accessTime:Date.now()}),S}static ClearCache(){const H=Array.from(U._InfixToPostfixCache.entries()).sort(((H,O)=>H[1].accessTime-O[1].accessTime));for(let O=0;O<U.InfixToPostfixCacheCleanupSize;O++)U._InfixToPostfixCache.delete(H[O][0])}}U.InfixToPostfixCacheLimitSize=5e4,U.InfixToPostfixCacheCleanupSize=25e3,U._InfixToPostfixCache=new Map,U._OperatorPriority={")":0,"(":1,"||":2,"&&":3},U._Stack=["","","","","","","","","","","","","","","","","","","",""];class V extends U{constructor(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=H,this.not=O}isTrue(H){let O=void 0!==H[this.define];return this.not&&(O=!O),O}}class w extends U{isTrue(H){return this.leftOperand.isTrue(H)||this.rightOperand.isTrue(H)}}class o extends U{isTrue(H){return this.leftOperand.isTrue(H)&&this.rightOperand.isTrue(H)}}class h extends U{constructor(H,O,S){super(),this.define=H,this.operand=O,this.testValue=S}toString(){return`${this.define} ${this.operand} ${this.testValue}`}isTrue(H){let O=!1;const S=parseInt(void 0!=H[this.define]?H[this.define]:this.define),t=parseInt(void 0!=H[this.testValue]?H[this.testValue]:this.testValue);if(isNaN(S)||isNaN(t))return!1;switch(this.operand){case">":O=S>t;break;case"<":O=S<t;break;case"<=":O=S<=t;break;case">=":O=S>=t;break;case"==":O=S===t;break;case"!=":O=S!==t}return O}}var a=S(11169),j=S(11200);const e=/defined\s*?\((.+?)\)/g,X=/defined\s*?\[(.+?)\]/g,E=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,y=/__decl__/,T=/light\{X\}.(\w*)/g,K=/\{X\}/g,b=[],D=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/;function F(H){H.processor&&H.processor.initializeShaders&&H.processor.initializeShaders(H.processingContext)}function Y(H,O,S,t){var q;null!==(q=O.processor)&&void 0!==q&&q.preProcessShaderCode&&(H=O.processor.preProcessShaderCode(H,O.isFragment)),g(H,O,(H=>{O.processCodeAfterIncludes&&(H=O.processCodeAfterIncludes(O.isFragment?"fragment":"vertex",H,O.defines));const q=function(H,O,S){let t=function(H,O){var S;if(null!==(S=O.processor)&&void 0!==S&&S.noPrecision)return H;const t=O.shouldUseHighPrecisionShader;-1===H.indexOf("precision highp float")?H=t?"precision highp float;\n"+H:"precision mediump float;\n"+H:t||(H=H.replace("precision highp float","precision mediump float"));return H}(H,O);if(!O.processor)return t;if(0===O.processor.shaderLanguage&&-1!==t.indexOf("#version 3")&&(t=t.replace("#version 300 es",""),!O.processor.parseGLES3))return t;const q=O.defines,p=W(O,S);O.processor.preProcessor&&(t=O.processor.preProcessor(t,q,p,O.isFragment,O.processingContext));const G={};t=r(t,p,O,G),O.processor.postProcessor&&(t=O.processor.postProcessor(t,q,O.isFragment,O.processingContext,S?{drawBuffersExtensionDisabled:!S.getCaps().drawBuffersExtension}:{},p,G));null!==S&&void 0!==S&&S._features.needShaderCodeInlining&&(t=S.inlineShaderCode(t));return t}(H,O,t);S(q,H)}))}function l(H,O,S){return S.processor&&S.processor.finalizeShaders?S.processor.finalizeShaders(H,O,S.processingContext):{vertexCode:H,fragmentCode:O}}function d(H){const O=/defined\((.+)\)/.exec(H);if(O&&O.length)return new V(O[1].trim(),"!"===H[0]);const S=["==","!=",">=","<=","<",">"];let t="",q=0;for(t of S)if(q=H.indexOf(t),q>-1)break;if(-1===q)return new V(H);const p=H.substring(0,q).trim(),G=H.substring(q+t.length).trim();return new h(p,t,G)}function v(H,O){const S=new G,t=H.substring(0,O);let q=H.substring(O);return q=q.substring(0,(q.indexOf("//")+1||q.length+1)-1).trim(),S.testExpression="#ifdef"===t?new V(q):"#ifndef"===t?new V(q,!0):function(H){H=H.replace(e,"defined[$1]");const O=U.infixToPostfix(H),S=[];for(const q of O)if("||"!==q&&"&&"!==q)S.push(q);else if(S.length>=2){let H=S[S.length-1],O=S[S.length-2];S.length-=2;const t="&&"==q?new o:new w;"string"===typeof H&&(H=H.replace(X,"defined($1)")),"string"===typeof O&&(O=O.replace(X,"defined($1)")),t.leftOperand="string"===typeof O?d(O):O,t.rightOperand="string"===typeof H?d(H):H,S.push(t)}let t=S[S.length-1];return"string"===typeof t&&(t=t.replace(X,"defined($1)")),"string"===typeof t?d(t):t}(q),S}function z(H,O,S,q){let p=H.currentLine;for(;m(H,S,q);){p=H.currentLine;const G=p.substring(0,5).toLowerCase();if("#else"===G){const S=new t;return O.children.push(S),void m(H,S,q)}if("#elif"===G){const H=v(p,5);O.children.push(H),S=H}}}function m(H,O,S){for(;H.canRead;){H.lineIndex++;const q=H.currentLine;if(q.indexOf("#")>=0){const t=D.exec(q);if(t&&t.length){switch(t[0]){case"#ifdef":{const t=new p;O.children.push(t);const G=v(q,6);t.children.push(G),z(H,t,G,S);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const t=new p;O.children.push(t);const G=v(q,7);t.children.push(G),z(H,t,G,S);break}case"#if":{const t=new p,G=v(q,3);O.children.push(t),t.children.push(G),z(H,t,G,S);break}}continue}}const G=new t;if(G.line=q,O.children.push(G),"#"===q[0]&&"d"===q[1]){const H=q.replace(";","").split(" ");G.additionalDefineKey=H[1],3===H.length&&(G.additionalDefineValue=H[2])}}return!1}function r(H,O,S,p){const G=new t,U=new q;return U.lineIndex=-1,U.lines=H.split("\n"),m(U,G,p),G.process(O,S,p)}function W(H,O){var S;const t=H.defines,q={};for(const p of t){const H=p.replace("#define","").replace(";","").trim().split(" ");q[H[0]]=H.length>1?H[1]:""}return 0===(null===(S=H.processor)||void 0===S?void 0:S.shaderLanguage)&&(q.GL_ES="true"),q.__VERSION__=H.version,q[H.platformName]="true",(0,j.j)(q,null===O||void 0===O?void 0:O.isNDCHalfZRange,null===O||void 0===O?void 0:O.useReverseDepthBuffer,null===O||void 0===O?void 0:O.useExactSrgbConversions),q}function g(H,O,S){let t;for(b.length=0;null!==(t=E.exec(H));)b.push(t);let q=String(H),p=[H],G=!1;for(const U of b){let H=U[1];if(-1!==H.indexOf("__decl__")&&(H=H.replace(y,""),O.supportsUniformBuffers&&(H=H.replace("Vertex","Ubo").replace("Fragment","Ubo")),H+="Declaration"),!O.includesShadersStore[H]){const t=O.shadersRepository+"ShadersInclude/"+H+".fx";return void N.loadFile(t,(t=>{O.includesShadersStore[H]=t,g(p.join(""),O,S)}))}{let S=O.includesShadersStore[H];if(U[2]){const H=U[3].split(",");for(let O=0;O<H.length;O+=2){const t=new RegExp(H[O],"g"),q=H[O+1];S=S.replace(t,q)}}if(U[4]){const H=U[5];if(-1!==H.indexOf("..")){const t=H.split(".."),q=parseInt(t[0]);let p=parseInt(t[1]),G=S.slice(0);S="",isNaN(p)&&(p=O.indexParameters[t[1]]);for(let H=q;H<p;H++)O.supportsUniformBuffers||(G=G.replace(T,((H,O)=>O+"{X}"))),S+=G.replace(K,H.toString())+"\n"}else O.supportsUniformBuffers||(S=S.replace(T,((H,O)=>O+"{X}"))),S=S.replace(K,H)}const t=[];for(const H of p){const O=H.split(U[0]);for(let H=0;H<O.length-1;H++)t.push(O[H]),t.push(S);t.push(O[O.length-1])}p=t,G=G||S.indexOf("#include<")>=0||S.indexOf("#include <")>=0}}b.length=0,q=p.join(""),G?g(q.toString(),O,S):S(q)}const N={loadFile:(H,O,S,t,q,p)=>{throw(0,a.b)("FileTools")}}},11200:(H,O,S)=>{S.d(O,{e:()=>q,h:()=>p,j:()=>U,l:()=>G,m:()=>V});var t=S(11169);S(11148);const q={};function p(H,O){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"")+(O?O+"\n":"")+H}function G(H,O,S,p,G,U,V){const w=V||q.loadFile;if(w){return w(H,O,S,p,G,U)}throw(0,t.b)("FileTools")}function U(H,O,S,t){if(H)return O?H.IS_NDC_HALF_ZRANGE="":delete H.IS_NDC_HALF_ZRANGE,S?H.USE_REVERSE_DEPTHBUFFER="":delete H.USE_REVERSE_DEPTHBUFFER,void(t?H.USE_EXACT_SRGB_CONVERSIONS="":delete H.USE_EXACT_SRGB_CONVERSIONS);{let H="";return O&&(H+="#define IS_NDC_HALF_ZRANGE"),S&&(H&&(H+="\n"),H+="#define USE_REVERSE_DEPTHBUFFER"),t&&(H&&(H+="\n"),H+="#define USE_EXACT_SRGB_CONVERSIONS"),H}}function V(H,O){let S=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>3?arguments[3]:void 0;switch(H){case 3:{const H=(ArrayBuffer,new Int8Array(O));return t&&H.set(new Int8Array(t)),H}case 0:{const H=(ArrayBuffer,new Uint8Array(O));return t&&H.set(new Uint8Array(t)),H}case 4:{const H=O instanceof ArrayBuffer?new Int16Array(O):new Int16Array(S?O/2:O);return t&&H.set(new Int16Array(t)),H}case 5:case 8:case 9:case 10:case 2:{const H=O instanceof ArrayBuffer?new Uint16Array(O):new Uint16Array(S?O/2:O);return t&&H.set(new Uint16Array(t)),H}case 6:{const H=O instanceof ArrayBuffer?new Int32Array(O):new Int32Array(S?O/4:O);return t&&H.set(new Int32Array(t)),H}case 7:case 11:case 12:case 13:case 14:case 15:{const H=O instanceof ArrayBuffer?new Uint32Array(O):new Uint32Array(S?O/4:O);return t&&H.set(new Uint32Array(t)),H}case 1:{const H=O instanceof ArrayBuffer?new Float32Array(O):new Float32Array(S?O/4:O);return t&&H.set(new Float32Array(t)),H}}const q=(ArrayBuffer,new Uint8Array(O));return t&&q.set(new Uint8Array(t)),q}},11223:(H,O,S)=>{S.d(O,{d:()=>t});class t{static GetShadersRepository(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?t.ShadersRepository:t.ShadersRepositoryWGSL}static GetShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?t.ShadersStore:t.ShadersStoreWGSL}static GetIncludesShadersStore(){return 0===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)?t.IncludesShadersStore:t.IncludesShadersStoreWGSL}}t.ShadersRepository="src/Shaders/",t.ShadersStore={},t.IncludesShadersStore={},t.ShadersRepositoryWGSL="src/ShadersWGSL/",t.ShadersStoreWGSL={},t.IncludesShadersStoreWGSL={}},11230:(H,O,S)=>{S.d(O,{c:()=>a,e:()=>K,f:()=>e,h:()=>j,k:()=>X,m:()=>T,n:()=>h,q:()=>w,u:()=>o,x:()=>V,y:()=>U});class t{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null,this._isDisposed=!1}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.jO._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(H){H&&this.program&&H(this.program)}setEngine(H){this.jO=H}_fillEffectInformation(H,O,S,t,q,p,G,U){const V=this.jO;if(V.supportsUniformBuffers)for(const o in O)H.bindUniformBlock(o,O[o]);let w;for(this.jO.getUniforms(this,S).forEach(((H,O)=>{t[S[O]]=H})),this._uniforms=t,w=0;w<q.length;w++){null==H.getUniform(q[w])&&(q.splice(w,1),w--)}q.forEach(((H,O)=>{p[H]=O}));for(const o of V.getAttributes(this,G))U.push(o)}dispose(){this._uniforms={},this._isDisposed=!0}_cacheMatrix(H,O){const S=this._valueCache[H],t=O.updateFlag;return(void 0===S||S!==t)&&(this._valueCache[H]=t,!0)}_cacheFloat2(H,O,S){let t=this._valueCache[H];if(!t||2!==t.length)return t=[O,S],this._valueCache[H]=t,!0;let q=!1;return t[0]!==O&&(t[0]=O,q=!0),t[1]!==S&&(t[1]=S,q=!0),q}_cacheFloat3(H,O,S,t){let q=this._valueCache[H];if(!q||3!==q.length)return q=[O,S,t],this._valueCache[H]=q,!0;let p=!1;return q[0]!==O&&(q[0]=O,p=!0),q[1]!==S&&(q[1]=S,p=!0),q[2]!==t&&(q[2]=t,p=!0),p}_cacheFloat4(H,O,S,t,q){let p=this._valueCache[H];if(!p||4!==p.length)return p=[O,S,t,q],this._valueCache[H]=p,!0;let G=!1;return p[0]!==O&&(p[0]=O,G=!0),p[1]!==S&&(p[1]=S,G=!0),p[2]!==t&&(p[2]=t,G=!0),p[3]!==q&&(p[3]=q,G=!0),G}setInt(H,O){const S=this._valueCache[H];void 0!==S&&S===O||this.jO.setInt(this._uniforms[H],O)&&(this._valueCache[H]=O)}setInt2(H,O,S){this._cacheFloat2(H,O,S)&&(this.jO.setInt2(this._uniforms[H],O,S)||(this._valueCache[H]=null))}setInt3(H,O,S,t){this._cacheFloat3(H,O,S,t)&&(this.jO.setInt3(this._uniforms[H],O,S,t)||(this._valueCache[H]=null))}setInt4(H,O,S,t,q){this._cacheFloat4(H,O,S,t,q)&&(this.jO.setInt4(this._uniforms[H],O,S,t,q)||(this._valueCache[H]=null))}setIntArray(H,O){this._valueCache[H]=null,this.jO.setIntArray(this._uniforms[H],O)}setIntArray2(H,O){this._valueCache[H]=null,this.jO.setIntArray2(this._uniforms[H],O)}setIntArray3(H,O){this._valueCache[H]=null,this.jO.setIntArray3(this._uniforms[H],O)}setIntArray4(H,O){this._valueCache[H]=null,this.jO.setIntArray4(this._uniforms[H],O)}setUInt(H,O){const S=this._valueCache[H];void 0!==S&&S===O||this.jO.setUInt(this._uniforms[H],O)&&(this._valueCache[H]=O)}setUInt2(H,O,S){this._cacheFloat2(H,O,S)&&(this.jO.setUInt2(this._uniforms[H],O,S)||(this._valueCache[H]=null))}setUInt3(H,O,S,t){this._cacheFloat3(H,O,S,t)&&(this.jO.setUInt3(this._uniforms[H],O,S,t)||(this._valueCache[H]=null))}setUInt4(H,O,S,t,q){this._cacheFloat4(H,O,S,t,q)&&(this.jO.setUInt4(this._uniforms[H],O,S,t,q)||(this._valueCache[H]=null))}setUIntArray(H,O){this._valueCache[H]=null,this.jO.setUIntArray(this._uniforms[H],O)}setUIntArray2(H,O){this._valueCache[H]=null,this.jO.setUIntArray2(this._uniforms[H],O)}setUIntArray3(H,O){this._valueCache[H]=null,this.jO.setUIntArray3(this._uniforms[H],O)}setUIntArray4(H,O){this._valueCache[H]=null,this.jO.setUIntArray4(this._uniforms[H],O)}setArray(H,O){this._valueCache[H]=null,this.jO.setArray(this._uniforms[H],O)}setArray2(H,O){this._valueCache[H]=null,this.jO.setArray2(this._uniforms[H],O)}setArray3(H,O){this._valueCache[H]=null,this.jO.setArray3(this._uniforms[H],O)}setArray4(H,O){this._valueCache[H]=null,this.jO.setArray4(this._uniforms[H],O)}setMatrices(H,O){O&&(this._valueCache[H]=null,this.jO.setMatrices(this._uniforms[H],O))}setMatrix(H,O){this._cacheMatrix(H,O)&&(this.jO.setMatrices(this._uniforms[H],O.pU())||(this._valueCache[H]=null))}setMatrix3x3(H,O){this._valueCache[H]=null,this.jO.setMatrix3x3(this._uniforms[H],O)}setMatrix2x2(H,O){this._valueCache[H]=null,this.jO.setMatrix2x2(this._uniforms[H],O)}setFloat(H,O){const S=this._valueCache[H];void 0!==S&&S===O||this.jO.setFloat(this._uniforms[H],O)&&(this._valueCache[H]=O)}setVector2(H,O){this._cacheFloat2(H,O.x,O.y)&&(this.jO.setFloat2(this._uniforms[H],O.x,O.y)||(this._valueCache[H]=null))}setFloat2(H,O,S){this._cacheFloat2(H,O,S)&&(this.jO.setFloat2(this._uniforms[H],O,S)||(this._valueCache[H]=null))}setVector3(H,O){this._cacheFloat3(H,O.x,O.y,O.z)&&(this.jO.setFloat3(this._uniforms[H],O.x,O.y,O.z)||(this._valueCache[H]=null))}setFloat3(H,O,S,t){this._cacheFloat3(H,O,S,t)&&(this.jO.setFloat3(this._uniforms[H],O,S,t)||(this._valueCache[H]=null))}setVector4(H,O){this._cacheFloat4(H,O.x,O.y,O.z,O.w)&&(this.jO.setFloat4(this._uniforms[H],O.x,O.y,O.z,O.w)||(this._valueCache[H]=null))}setQuaternion(H,O){this._cacheFloat4(H,O.x,O.y,O.z,O.w)&&(this.jO.setFloat4(this._uniforms[H],O.x,O.y,O.z,O.w)||(this._valueCache[H]=null))}setFloat4(H,O,S,t,q){this._cacheFloat4(H,O,S,t,q)&&(this.jO.setFloat4(this._uniforms[H],O,S,t,q)||(this._valueCache[H]=null))}setColor3(H,O){this._cacheFloat3(H,O.r,O.g,O.b)&&(this.jO.setFloat3(this._uniforms[H],O.r,O.g,O.b)||(this._valueCache[H]=null))}setColor4(H,O,S){this._cacheFloat4(H,O.r,O.g,O.b,S)&&(this.jO.setFloat4(this._uniforms[H],O.r,O.g,O.b,S)||(this._valueCache[H]=null))}setDirectColor4(H,O){this._cacheFloat4(H,O.r,O.g,O.b,O.a)&&(this.jO.setFloat4(this._uniforms[H],O.r,O.g,O.b,O.a)||(this._valueCache[H]=null))}_getVertexShaderCode(){return this.vertexShader?this.jO._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.jO._getShaderSource(this.fragmentShader):null}}var q=S(11200);const p=new WeakMap,G={_webGLVersion:2,cachedPipelines:{}};function U(H){let O=p.get(H);if(!O){if(!H)return G;O={_webGLVersion:H.TEXTURE_BINDING_3D?2:1,_context:H,parallelShaderCompile:H.getExtension("KHR_parallel_shader_compile")||void 0,cachedPipelines:{}},p.set(H,O)}return O}function V(H){p.delete(H)}function w(H,O,S,t,q,p){const G=U(t);p||(p=G._createShaderProgramInjection??a);return p(H,y(O,"vertex",t,G._contextWasLost),y(S,"fragment",t,G._contextWasLost),t,q,G.validateShaderPrograms)}function o(H,O,S,t,q){let p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,G=arguments.length>6?arguments[6]:void 0;const V=U(q);G||(G=V._createShaderProgramInjection??a);const w=V._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"";return G(H,E(O,"vertex",t,w,q,V._contextWasLost),E(S,"fragment",t,w,q,V._contextWasLost),q,p,V.validateShaderPrograms)}function h(H,O){const S=new t,q=U(H);return q.parallelShaderCompile&&!q.disableParallelShaderCompile&&(S.isParallelCompiled=!0),S.context=q._context,S}function a(H,O,S,t){let q=arguments.length>5?arguments[5]:void 0;const p=t.createProgram();if(H.program=p,!p)throw new Error("Unable to create program");return t.attachShader(p,O),t.attachShader(p,S),t.linkProgram(p),H.context=t,H.vertexShader=O,H.fragmentShader=S,H.isParallelCompiled||e(H,t,q),p}function j(H,O,S){const t=H;if(t._isDisposed)return!1;const q=U(O);return!!(q&&q.parallelShaderCompile&&q.parallelShaderCompile.COMPLETION_STATUS_KHR&&t.program&&O.getProgramParameter(t.program,q.parallelShaderCompile.COMPLETION_STATUS_KHR))&&(e(t,O,S),!0)}function e(H,O,S){const t=H.context,q=H.vertexShader,p=H.fragmentShader,G=H.program;if(!t.getProgramParameter(G,t.LINK_STATUS)){if(!O.getShaderParameter(q,O.COMPILE_STATUS)){const S=O.getShaderInfoLog(q);if(S)throw H.vertexCompilationError=S,new Error("VERTEX SHADER "+S)}if(!O.getShaderParameter(p,O.COMPILE_STATUS)){const S=O.getShaderInfoLog(p);if(S)throw H.fragmentCompilationError=S,new Error("FRAGMENT SHADER "+S)}const S=t.getProgramInfoLog(G);if(S)throw H.programLinkError=S,new Error(S)}if(S){t.validateProgram(G);if(!t.getProgramParameter(G,t.VALIDATE_STATUS)){const O=t.getProgramInfoLog(G);if(O)throw H.programValidationError=O,new Error(O)}}t.deleteShader(q),t.deleteShader(p),H.vertexShader=void 0,H.fragmentShader=void 0,H.onCompiled&&(H.onCompiled(),H.onCompiled=void 0)}function X(H,O,S,t,q,p,G,V,h){let a=arguments.length>10?arguments[10]:void 0,j=arguments.length>11?arguments[11]:void 0,e=arguments.length>12?arguments[12]:void 0;const X=U(H.context);j||(j=X.createRawShaderProgramInjection??w),e||(e=X.createShaderProgramInjection??o);const E=H;E.program=t?j(E,O,S,E.context,h):e(E,O,S,V,E.context,h),E.program.__SPECTOR_rebuildProgram=G,a()}function E(H,O,S,t,p,G){return y((0,q.h)(H,S,t),O,p,G)}function y(H,O,S,t){const q=S.createShader("vertex"===O?S.VERTEX_SHADER:S.FRAGMENT_SHADER);if(!q){let H=S.NO_ERROR,q=S.NO_ERROR;for(;(q=S.getError())!==S.NO_ERROR;)H=q;throw new Error(`Something went wrong while creating a gl ${O} shader object. gl error=${H}, gl isContextLost=${S.isContextLost()}, _contextWasLost=${t}`)}return S.shaderSource(q,H),S.compileShader(q),q}function T(H,O){O.useProgram(H)}function K(H,O){const S=H;if(!S.isParallelCompiled)return void O(H);const t=S.onCompiled;S.onCompiled=()=>{null===t||void 0===t||t(),O(H)}}},11228:(H,O,S)=>{S.d(O,{b:()=>h,e:()=>j,g:()=>w,i:()=>o});var t=S(11148),q=S(11230),p=S(11223),G=S(11151),U=S(11194),V=S(11200);function w(H,O){return(0,q.y)(O).cachedPipelines[H]}function o(H){const O=H._name,S=H.context;if(O&&S){const H=(0,q.y)(S),t=H.cachedPipelines[O];null===t||void 0===t||t.dispose(),delete H.cachedPipelines[O]}}function h(H,O,S,q,p,G,V){let w,o;const h=(0,t.n)()?null===G||void 0===G?void 0:G.getHostDocument():null;w="string"===typeof O?O:O.vertexSource?"source:"+O.vertexSource:O.vertexElement?(null===h||void 0===h?void 0:h.getElementById(O.vertexElement))||O.vertexElement:O.vertex||O,o="string"===typeof O?O:O.fragmentSource?"source:"+O.fragmentSource:O.fragmentElement?(null===h||void 0===h?void 0:h.getElementById(O.fragmentElement))||O.fragmentElement:O.fragment||O;const j=[void 0,void 0],e=()=>{if(j[0]&&j[1]){H.isFragment=!0;const[t,w]=j;(0,U.k)(w,H,((G,w)=>{V&&(V._fragmentSourceCodeBeforeMigration=w),S&&(G=S("fragment",G));const o=(0,U.d)(t,G,H);H=null;const h=function(H,O,S,t){if(S){return{vertexSourceCode:(1===t?"//":"")+"#define SHADER_NAME vertex:"+(S.vertexElement||S.vertex||S.spectorName||S)+"\n"+H,fragmentSourceCode:(1===t?"//":"")+"#define SHADER_NAME fragment:"+(S.fragmentElement||S.fragment||S.spectorName||S)+"\n"+O}}return{vertexSourceCode:H,fragmentSourceCode:O}}(o.vertexCode,o.fragmentCode,O,p);null===q||void 0===q||q(h.vertexSourceCode,h.fragmentSourceCode)}),G)}};a(w,"Vertex","",(O=>{(0,U.h)(H),(0,U.k)(O,H,((H,t)=>{V&&(V._rawVertexSourceCode=O,V._vertexSourceCodeBeforeMigration=t),S&&(H=S("vertex",H)),j[0]=H,e()}),G)}),p),a(o,"Fragment","Pixel",(H=>{V&&(V._rawFragmentSourceCode=H),j[1]=H,e()}),p)}function a(H,O,S,q,G,U){if("undefined"!==typeof HTMLElement&&H instanceof HTMLElement){return void q((0,t.c)(H))}if("source:"===H.substring(0,7))return void q(H.substring(7));if("base64:"===H.substring(0,7)){return void q(window.atob(H.substring(7)))}const w=p.d.GetShadersStore(G);if(w[H+O+"Shader"])return void q(w[H+O+"Shader"]);if(S&&w[H+S+"Shader"])return void q(w[H+S+"Shader"]);let o;if(o="."===H[0]||"/"===H[0]||H.indexOf("http")>-1?H:p.d.GetShadersRepository(G)+H,!(U=U||V.l))throw new Error("loadFileInjection is not defined");U(o+"."+O.toLowerCase()+".fx",q)}const j=(H,O,S,t)=>{try{const p=H.context?(0,q.y)(H.context):null;p&&(p.disableParallelShaderCompile=H.disableParallelCompilation);const G=H.existingPipelineContext||O(H.shaderProcessingContext);return G._name=H.name,H.name&&p&&(p.cachedPipelines[H.name]=G),S(G,H.vertex,H.fragment,!!H.createAsRaw,"","",H.rebuildRebind,H.defines,H.transformFeedbackVaryings,"",(()=>{t(G,(()=>{var O;null===(O=H.onRenderingStateCompiled)||void 0===O||O.call(H,G)}))})),G}catch(p){throw G.b.Error("Error compiling effect"),p}}},11216:(H,O,S)=>{S.r(O),S.d(O,{Effect:()=>V});var t=S(11140),q=S(11151),p=S(11223),G=S(11228),U=S(11205);class V{static get ShadersRepository(){return p.d.ShadersRepository}static set ShadersRepository(H){p.d.ShadersRepository=H}get G(){return this._isDisposed}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new t.b),this._onBindObservable}get shaderLanguage(){return this._shaderLanguage}constructor(H,O,S){let q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4?arguments[4]:void 0,U=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,a=arguments.length>9?arguments[9]:void 0,j=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",e=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,X=arguments.length>12?arguments[12]:void 0;this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new t.b,this.onErrorObservable=new t.b,this._onBindObservable=null,this._isDisposed=!1,this._refCount=1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._disableParallelShaderCompilation=!1,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._processCodeAfterIncludes=void 0,this._processFinalCode=null,this.name=H,this._key=j;const E=this._key.replace(/\r/g,"").replace(/\n/g,"|");let y;if(O.attributes){const H=O;if(this._engine=S,this._attributesNames=H.attributes,this._uniformsNames=H.uniformsNames.concat(H.samplers),this._samplerList=H.samplers.slice(),this.defines=H.defines,this.onError=H.onError,this.onCompiled=H.onCompiled,this._fallbacks=H.fallbacks,this._indexParameters=H.indexParameters,this._transformFeedbackVaryings=H.transformFeedbackVaryings||null,this._multiTarget=!!H.multiTarget,this._shaderLanguage=H.shaderLanguage??0,this._disableParallelShaderCompilation=!!H.disableParallelShaderCompilation,H.uniformBuffersNames){this._uniformBuffersNamesList=H.uniformBuffersNames.slice();for(let O=0;O<H.uniformBuffersNames.length;O++)this._uniformBuffersNames[H.uniformBuffersNames[O]]=O}this._processFinalCode=H.processFinalCode??null,this._processCodeAfterIncludes=H.processCodeAfterIncludes??void 0,X=H.extraInitializationsAsync,y=H.existingPipelineContext}else this._engine=p,this.defines=null==U?"":U,this._uniformsNames=S.concat(q),this._samplerList=q?q.slice():[],this._attributesNames=O,this._uniformBuffersNamesList=[],this._shaderLanguage=e,this.onError=h,this.onCompiled=o,this._indexParameters=a,this._fallbacks=w;"WEBGL2"===this._engine.shaderPlatformName&&(y=(0,G.g)(E,this._engine._gl)??y),this._attributeLocationByName={},this.uniqueId=V._UniqueIdSeed++,y?(this._pipelineContext=y,this._pipelineContext.setEngine(this._engine),this._onRenderingStateCompiled(this._pipelineContext),this._pipelineContext.program&&(this._pipelineContext.program.__SPECTOR_rebuildProgram=this._rebuildProgram.bind(this))):this._processShaderCodeAsync(null,!1,null,X),this._engine.onReleaseEffectsObservable.addOnce((()=>{this.G||this.dispose(!0)}))}async _processShaderCodeAsync(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3?arguments[3]:void 0;t&&await t(),this._processingContext=S||this._engine._getShaderProcessingContext(this._shaderLanguage,!1);const q={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:H??this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:p.d.GetShadersRepository(this._shaderLanguage),includesShadersStore:p.d.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:this._processCodeAfterIncludes};(0,G.b)(q,this.name,this._processFinalCode,((H,S)=>{this._vertexSourceCode=H,this._fragmentSourceCode=S,this._prepareEffect(O)}),this._shaderLanguage,this._engine,this)}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch{return!1}}_isReadyInternal(){return!!this._engine.G||(!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady)}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(H){return this._attributes[H]}getAttributeLocationByName(H){return this._attributeLocationByName[H]}getAttributesCount(){return this._attributes.length}getUniformIndex(H){return this._uniformsNames.indexOf(H)}getUniform(H){return this._uniforms[H]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}async whenCompiledAsync(){return await new Promise((H=>{this.executeWhenCompiled(H)}))}executeWhenCompiled(H){this.isReady()?H(this):(this.onCompileObservable.add((O=>{H(O)})),this._pipelineContext&&!this._pipelineContext.isAsync||this._checkIsReady(null))}_checkIsReady(H){(0,U.f)((()=>this._isReadyInternal()||this._isDisposed),(()=>{}),(O=>{this._processCompilationErrors(O,H)}),16,12e4,!0,` - Effect: ${"string"===typeof this.name?this.name:this.key}`)}get vertexSourceCode(){var H;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:(null===(H=this._pipelineContext)||void 0===H?void 0:H._getVertexShaderCode())??this._vertexSourceCode}get fragmentSourceCode(){var H;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:(null===(H=this._pipelineContext)||void 0===H?void 0:H._getFragmentShaderCode())??this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}getPipelineGenerationOptions(){return{platformName:this._engine.shaderPlatformName,shaderLanguage:this._shaderLanguage,shaderNameOrContent:this.name,key:this._key,defines:this.defines.split("\n"),addGlobalDefines:!1,extendedProcessingOptions:{indexParameters:this._indexParameters,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,supportsUniformBuffers:this._engine.supportsUniformBuffers},extendedCreatePipelineOptions:{transformFeedbackVaryings:this._transformFeedbackVaryings,createAsRaw:!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride)}}}_rebuildProgram(H,O,S,t){this._isReady=!1,this._vertexSourceCodeOverride=H,this._fragmentSourceCodeOverride=O,this.onError=(H,O)=>{t&&t(O)},this.onCompiled=()=>{var H,O;const t=this.getEngine().scenes;if(t)for(let S=0;S<t.length;S++)t[S].markAllMaterialsAsDirty(127);null===(H=(O=this._pipelineContext)._handlesSpectorRebuildCallback)||void 0===H||H.call(O,S)},this._fallbacks=null,this._prepareEffect()}_onRenderingStateCompiled(H){if(this._pipelineContext=H,this._pipelineContext.setEngine(this._engine),this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,this._attributesNames,this._attributes),this._attributesNames)for(let O=0;O<this._attributesNames.length;O++){const H=this._attributesNames[O];this._attributeLocationByName[H]=this._attributes[O]}this._engine.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),V.AutomaticallyClearCodeCache&&this.clearCodeCache()}_prepareEffect(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=this._pipelineContext;this._isReady=!1;try{const S=!(!this._vertexSourceCodeOverride||!this._fragmentSourceCodeOverride),t=S?null:this.defines,q=S?this._vertexSourceCodeOverride:this._vertexSourceCode,p=S?this._fragmentSourceCodeOverride:this._fragmentSourceCode,U=this._engine;this._pipelineContext=(0,G.e)({existingPipelineContext:H?O:null,vertex:q,fragment:p,context:"WEBGL2"===U.shaderPlatformName||"WEBGL1"===U.shaderPlatformName?U._gl:void 0,rebuildRebind:(H,O,S,t)=>this._rebuildProgram(H,O,S,t),defines:t,transformFeedbackVaryings:this._transformFeedbackVaryings,name:this._key.replace(/\r/g,"").replace(/\n/g,"|"),createAsRaw:S,disableParallelCompilation:this._disableParallelShaderCompilation,shaderProcessingContext:this._processingContext,onRenderingStateCompiled:S=>{O&&!H&&this._engine._deletePipelineContext(O),S&&this._onRenderingStateCompiled(S)}},this._engine.createPipelineContext.bind(this._engine),this._engine._preparePipelineContextAsync.bind(this._engine),this._engine._executeWhenRenderingStateIsCompiled.bind(this._engine)),this._pipelineContext.isAsync&&this._checkIsReady(O)}catch(S){this._processCompilationErrors(S,O)}}_getShaderCodeAndErrorLine(H,O,S){const t=S?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let q=null;if(O&&H){const p=O.match(t);if(p&&2===p.length){const O=parseInt(p[1]),t=H.split("\n",-1);t.length>=O&&(q=`Offending line [${O}] in ${S?"fragment":"vertex"} code: ${t[O-1]}`)}}return[H,q]}_processCompilationErrors(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=H.message;const S=this._attributesNames,t=this._fallbacks;if(q.b.Error("Unable to compile effect:"),q.b.Error(`Uniforms: ${this._uniformsNames.join(" ")}`),q.b.Error(`Attributes: ${S.join(" ")}`),q.b.Error("Defines:\n"+this.defines),V.LogShaderCodeOnCompilationError){var p,G;let H=null,O=null,S=null;var U;if(null!==(p=this._pipelineContext)&&void 0!==p&&p._getVertexShaderCode()&&([S,H]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),S&&(q.b.Error("Vertex code:"),q.b.Error(S))),null!==(G=this._pipelineContext)&&void 0!==G&&G._getFragmentShaderCode())[S,O]=this._getShaderCodeAndErrorLine(null===(U=this._pipelineContext)||void 0===U?void 0:U._getFragmentShaderCode(),this._compilationError,!0),S&&(q.b.Error("Fragment code:"),q.b.Error(S));H&&q.b.Error(H),O&&q.b.Error(O)}q.b.Error("Error: "+this._compilationError);const w=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this._engine.onEffectErrorObservable.notifyObservers({effect:this,errors:this._compilationError})};O&&(this._pipelineContext=O,this._isReady=!0,w()),t?(this._pipelineContext=null,t.hasMoreFallbacks?(this._allFallbacksProcessed=!1,q.b.Error("Trying next fallback."),this.defines=t.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,w(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,O||w())}get isSupported(){return""===this._compilationError}_bindTexture(H,O){this._engine._bindTexture(this._samplers[H],O,H)}setTexture(H,O){this._engine.setTexture(this._samplers[H],this._uniforms[H],O,H)}setTextureArray(H,O){const S=H+"Ex";if(-1===this._samplerList.indexOf(S+"0")){const t=this._samplerList.indexOf(H);for(let H=1;H<O.length;H++){const O=S+(H-1).toString();this._samplerList.splice(t+H,0,O)}let q=0;for(const H of this._samplerList)this._samplers[H]=q,q+=1}this._engine.setTextureArray(this._samplers[H],this._uniforms[H],O,H)}bindUniformBuffer(H,O){const S=this._uniformBuffersNames[O];void 0===S||V._BaseCache[S]===H&&this._engine._features.useUBOBindingCache||(V._BaseCache[S]=H,this._engine.bindUniformBufferBase(H,S,O))}bindUniformBlock(H,O){this._engine.bindUniformBlock(this._pipelineContext,H,O)}setInt(H,O){return this._pipelineContext.setInt(H,O),this}setInt2(H,O,S){return this._pipelineContext.setInt2(H,O,S),this}setInt3(H,O,S,t){return this._pipelineContext.setInt3(H,O,S,t),this}setInt4(H,O,S,t,q){return this._pipelineContext.setInt4(H,O,S,t,q),this}setIntArray(H,O){return this._pipelineContext.setIntArray(H,O),this}setIntArray2(H,O){return this._pipelineContext.setIntArray2(H,O),this}setIntArray3(H,O){return this._pipelineContext.setIntArray3(H,O),this}setIntArray4(H,O){return this._pipelineContext.setIntArray4(H,O),this}setUInt(H,O){return this._pipelineContext.setUInt(H,O),this}setUInt2(H,O,S){return this._pipelineContext.setUInt2(H,O,S),this}setUInt3(H,O,S,t){return this._pipelineContext.setUInt3(H,O,S,t),this}setUInt4(H,O,S,t,q){return this._pipelineContext.setUInt4(H,O,S,t,q),this}setUIntArray(H,O){return this._pipelineContext.setUIntArray(H,O),this}setUIntArray2(H,O){return this._pipelineContext.setUIntArray2(H,O),this}setUIntArray3(H,O){return this._pipelineContext.setUIntArray3(H,O),this}setUIntArray4(H,O){return this._pipelineContext.setUIntArray4(H,O),this}setFloatArray(H,O){return this._pipelineContext.setArray(H,O),this}setFloatArray2(H,O){return this._pipelineContext.setArray2(H,O),this}setFloatArray3(H,O){return this._pipelineContext.setArray3(H,O),this}setFloatArray4(H,O){return this._pipelineContext.setArray4(H,O),this}setArray(H,O){return this._pipelineContext.setArray(H,O),this}setArray2(H,O){return this._pipelineContext.setArray2(H,O),this}setArray3(H,O){return this._pipelineContext.setArray3(H,O),this}setArray4(H,O){return this._pipelineContext.setArray4(H,O),this}setMatrices(H,O){return this._pipelineContext.setMatrices(H,O),this}setMatrix(H,O){return this._pipelineContext.setMatrix(H,O),this}setMatrix3x3(H,O){return this._pipelineContext.setMatrix3x3(H,O),this}setMatrix2x2(H,O){return this._pipelineContext.setMatrix2x2(H,O),this}setFloat(H,O){return this._pipelineContext.setFloat(H,O),this}setBool(H,O){return this._pipelineContext.setInt(H,O?1:0),this}setVector2(H,O){return this._pipelineContext.setVector2(H,O),this}setFloat2(H,O,S){return this._pipelineContext.setFloat2(H,O,S),this}setVector3(H,O){return this._pipelineContext.setVector3(H,O),this}setFloat3(H,O,S,t){return this._pipelineContext.setFloat3(H,O,S,t),this}setVector4(H,O){return this._pipelineContext.setVector4(H,O),this}setQuaternion(H,O){return this._pipelineContext.setQuaternion(H,O),this}setFloat4(H,O,S,t,q){return this._pipelineContext.setFloat4(H,O,S,t,q),this}setColor3(H,O){return this._pipelineContext.setColor3(H,O),this}setColor4(H,O,S){return this._pipelineContext.setColor4(H,O,S),this}setDirectColor4(H,O){return this._pipelineContext.setDirectColor4(H,O),this}clearCodeCache(){this._vertexSourceCode="",this._fragmentSourceCode="",this._fragmentSourceCodeBeforeMigration="",this._vertexSourceCodeBeforeMigration=""}dispose(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this._refCount=0;else{if(V.PersistentMode)return;this._refCount--}this._refCount>0||this._isDisposed||(this._pipelineContext&&(0,G.i)(this._pipelineContext),this._engine._releaseEffect(this),this.clearCodeCache(),this._isDisposed=!0)}static RegisterShader(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;O&&(p.d.GetShadersStore(t)[`${H}PixelShader`]=O),S&&(p.d.GetShadersStore(t)[`${H}VertexShader`]=S)}static ResetCache(){V._BaseCache={}}}V.LogShaderCodeOnCompilationError=!0,V.PersistentMode=!1,V.AutomaticallyClearCodeCache=!1,V._UniqueIdSeed=0,V._BaseCache={},V.ShadersStore=p.d.ShadersStore,V.IncludesShadersStore=p.d.IncludesShadersStore},11169:(H,O,S)=>{S.d(O,{b:()=>q});const t={};function q(H){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||!t[H])return t[H]=!0,`${H} needs to be imported before as it contains a side-effect required by your code.`}},11148:(H,O,S)=>{function t(){return"undefined"!==typeof window}function q(){return"undefined"!==typeof navigator}function p(){return"undefined"!==typeof document}function G(H){let O="",S=H.firstChild;for(;S;)3===S.nodeType&&(O+=S.textContent),S=S.nextSibling;return O}S.d(O,{c:()=>G,f:()=>p,j:()=>q,n:()=>t})},11151:(H,O,S)=>{S.d(O,{b:()=>t});class t{static _CheckLimit(H,O){let S=t._LogLimitOutputs[H];return S?S.current++:(S={limit:O,current:1},t._LogLimitOutputs[H]=S),S.current<=S.limit}static _GenerateLimitMessage(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const S=t._LogLimitOutputs[H];if(!S||!t.MessageLimitReached)return;const q=this._Levels[O];S.current===S.limit&&t[q.name](t.MessageLimitReached.replace(/%LIMIT%/g,""+S.limit).replace(/%TYPE%/g,q.name??""))}static _AddLogEntry(H){t._LogCache=H+t._LogCache,t.OnNewCacheEntry&&t.OnNewCacheEntry(H)}static _FormatMessage(H){const O=H=>H<10?"0"+H:""+H,S=new Date;return"["+O(S.getHours())+":"+O(S.getMinutes())+":"+O(S.getSeconds())+"]: "+H}static _LogDisabled(H,O){}static _LogEnabled(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,O=arguments.length>1?arguments[1]:void 0,S=arguments.length>2?arguments[2]:void 0;const q=Array.isArray(O)?O[0]:O;if(void 0!==S&&!t._CheckLimit(q,S))return;const p=t._FormatMessage(q),G=this._Levels[H],U=Array.isArray(O)?O.slice(1):[];G.logFunc&&G.logFunc("BJS - "+p,...U);const V=`<div style='color:${G.color}'>${p}</div><br>`;t._AddLogEntry(V),t._GenerateLimitMessage(q,H)}static get LogCache(){return t._LogCache}static ClearLogCache(){t._LogCache="",t._LogLimitOutputs={},t.errorsCount=0}static set LogLevels(H){t.Log=t._LogDisabled,t.Warn=t._LogDisabled,t.Error=t._LogDisabled;const O=[t.MessageLogLevel,t.WarningLogLevel,t.ErrorLogLevel];for(const S of O)if((H&S)===S){const H=this._Levels[S];t[H.name]=t._LogEnabled.bind(t,S)}}}t.NoneLogLevel=0,t.MessageLogLevel=1,t.WarningLogLevel=2,t.ErrorLogLevel=4,t.AllLogLevel=7,t.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",t._LogCache="",t._LogLimitOutputs={},t._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],t.errorsCount=0,t.Log=t._LogEnabled.bind(t,t.MessageLogLevel),t.Warn=t._LogEnabled.bind(t,t.WarningLogLevel),t.Error=t._LogEnabled.bind(t,t.ErrorLogLevel)},11140:(H,O,S)=>{S.d(O,{b:()=>G});const t="undefined"!==typeof WeakRef;class q{constructor(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],S=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0;this.initialize(H,O,S,t)}initialize(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1],S=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0;return this.mask=H,this.skipNextObservers=O,this.target=S,this.currentTarget=t,this}}class p{constructor(H,O){let S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=H,this.mask=O,this.scope=S,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1,this._remove=null}remove(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._remove&&this._remove(H)}}class G{static FromPromise(H,O){const S=new G;return H.then((H=>{S.notifyObservers(H)})).catch((H=>{if(!O)throw H;O.notifyObservers(H)})),S}get observers(){return this._observers}constructor(H){let O=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=O,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new q(0),H&&(this._onObserverAdded=H)}add(H){let O=arguments.length>2&&void 0!==arguments[2]&&arguments[2],S=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!H)return null;const q=new p(H,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);q.unregisterOnNextCall=S,O?this._observers.unshift(q):this._observers.push(q),this._onObserverAdded&&this._onObserverAdded(q),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(q,this._lastNotifiedValue);const G=t?new WeakRef(this):{deref:()=>this};return q._remove=function(){let H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const O=G.deref();O&&(H?O.remove(q):O._remove(q))},q}addOnce(H){return this.add(H,void 0,void 0,void 0,!0)}remove(H){if(!H)return!1;H._remove=null;return-1!==this._observers.indexOf(H)&&(this._deferUnregister(H),!0)}removeCallback(H,O){for(let S=0;S<this._observers.length;S++){const t=this._observers[S];if(!t._willBeUnregistered&&(t.callback===H&&(!O||O===t.scope)))return this._deferUnregister(t),!0}return!1}_deferUnregister(H){H._willBeUnregistered||(this._numObserversMarkedAsDeleted++,H.unregisterOnNextCall=!1,H._willBeUnregistered=!0,setTimeout((()=>{this._remove(H)}),0))}_remove(H){let O=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!H)return!1;const S=this._observers.indexOf(H);return-1!==S&&(O&&this._numObserversMarkedAsDeleted--,this._observers.splice(S,1),!0)}makeObserverTopPriority(H){this._remove(H,!1),this._observers.unshift(H)}makeObserverBottomPriority(H){this._remove(H,!1),this._observers.push(H)}notifyObservers(H){let O=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,S=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=H),!this._observers.length)return!0;const p=this._eventState;p.mask=O,p.target=S,p.currentTarget=t,p.skipNextObservers=!1,p.lastReturnValue=H,p.userInfo=q;for(const G of this._observers)if(!G._willBeUnregistered&&(G.mask&O&&(G.unregisterOnNextCall&&this._deferUnregister(G),G.scope?p.lastReturnValue=G.callback.apply(G.scope,[H,p]):p.lastReturnValue=G.callback(H,p)),p.skipNextObservers))return!1;return!0}notifyObserver(H,O){let S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=O),H._willBeUnregistered)return;const t=this._eventState;t.mask=S,t.skipNextObservers=!1,H.unregisterOnNextCall&&this._deferUnregister(H),H.callback(O,t)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){for(;this._observers.length;){const H=this._observers.pop();H&&(H._remove=null)}this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const H=new G;return H._observers=this._observers.slice(0),H}hasSpecificMask(){let H=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const O of this._observers)if(O.mask&H||O.mask===H)return!0;return!1}}},11205:(H,O,S)=>{S.d(O,{b:()=>q,f:()=>G});let t=[];class q{static SetImmediate(H){0===t.length&&setTimeout((()=>{const H=t;t=[];for(const O of H)O()}),1),t.push(H)}}function p(H,O,S){try{if(H())return O(),!0}catch(t){return null===S||void 0===S||S(t),!0}return!1}const G=function(H,O,S){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16,q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e4,G=arguments.length>6?arguments[6]:void 0;if((!(arguments.length>5&&void 0!==arguments[5])||arguments[5])&&p(H,O,S))return null;const U=setInterval((()=>{p(H,O,S)?clearInterval(U):(q-=t,q<0&&(clearInterval(U),null===S||void 0===S||S(new Error("Operation timed out after maximum retries. "+(G||"")),!0)))}),t);return()=>clearInterval(U)}}}]);