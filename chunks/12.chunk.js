"use strict";(self.hmihoa2fs98=self.hmihoa2fs98||[]).push([[12,20],{11890:(b,d,P)=>{P.r(d),P.d(d,{Dispose:()=>s,DumpData:()=>Y,DumpDataAsync:()=>x,DumpFramebuffer:()=>L,DumpTools:()=>E});var G=P(11787),W=P(11484),i=P(11700),q=P(11535);let C,J=null;async function L(b,d,P,G){let W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",i=arguments.length>5?arguments[5]:void 0,q=arguments.length>6?arguments[6]:void 0;const C=await P.readPixels(0,0,b,d);Y(b,d,new Uint8Array(C.buffer),G,W,i,!0,void 0,q)}async function x(b,d,P){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",W=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],q=arguments.length>6&&void 0!==arguments[6]&&arguments[6],C=arguments.length>7?arguments[7]:void 0;return await new Promise((J=>{Y(b,d,P,(b=>J(b)),G,W,i,q,C)}))}function Y(b,d,L,x){let Y=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",E=arguments.length>5?arguments[5]:void 0,w=arguments.length>6&&void 0!==arguments[6]&&arguments[6],t=arguments.length>7&&void 0!==arguments[7]&&arguments[7],r=arguments.length>8?arguments[8]:void 0;(async function(){return J||(J=new Promise(((b,d)=>{let W,i=null;const J={Ud:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(P.bind(P,11815)).then((L=>{let{ThinEngine:x}=L;const Y=q.e.Instances.length;try{W=new OffscreenCanvas(100,100),i=new x(W,!1,J)}catch(t){var E;Y<q.e.Instances.length&&(null===(E=q.e.Instances.pop())||void 0===E||E.dispose()),W=document.createElement("canvas"),i=new x(W,!1,J)}q.e.Instances.pop(),q.e.OnEnginesDisposedObservable.add((b=>{i&&b!==i&&!i.L&&0===q.e.Instances.length&&s()})),i.getCaps().parallelShaderCompile=void 0;const w=new G.c(i);P.e(52).then(P.bind(P,14136)).then((P=>{let{passPixelShader:q}=P;if(!i)return void d("Engine is not defined");const J=new G.f({Md:i,name:q.name,fragmentShader:q.shader,samplerNames:["textureSampler"]});C={canvas:W,Md:i,renderer:w,wrapper:J},b(C)}))})).catch(d)}))),await J})().then((P=>{if(P.Md.setSize(b,d,!0),L instanceof Float32Array){const b=new Uint8Array(L.length);let d=L.length;for(;d--;){const P=L[d];b[d]=Math.round(255*(0,i.Clamp)(P))}L=b}const G=P.Md.createRawTexture(L,b,d,5,!1,!w,1);P.renderer.setViewport(),P.renderer.applyEffectWrapper(P.wrapper),P.wrapper.effect._bindTexture("textureSampler",G),P.renderer.draw(),t?W.Tools.ToBlob(P.canvas,(b=>{const d=new FileReader;d.onload=b=>{const d=b.target.result;x&&x(d)},d.readAsArrayBuffer(b)}),Y,r):W.Tools.EncodeScreenshotCanvasData(P.canvas,x,Y,E,r),G.dispose()}))}function s(){var b;C?(C.wrapper.dispose(),C.renderer.dispose(),C.Md.dispose()):null===(b=J)||void 0===b||b.then((b=>{b.wrapper.dispose(),b.renderer.dispose(),b.Md.dispose()}));J=null,C=null}const E={DumpData:Y,DumpDataAsync:x,DumpFramebuffer:L,Dispose:s};W.Tools.DumpData=Y,W.Tools.DumpDataAsync=x,W.Tools.DumpFramebuffer=L},11656:(b,d,P)=>{P.r(d),P.d(d,{CreateScreenshot:()=>Z,CreateScreenshotAsync:()=>o,CreateScreenshotUsingRenderTarget:()=>f,CreateScreenshotUsingRenderTargetAsync:()=>g,CreateScreenshotWithResizeAsync:()=>A,ScreenshotTools:()=>u});var G=P(11658),W=P(11744),i=P(11784),q=P(11639),C=P(11716),J=P(11787),L=P(11806),x=P(11681);class Y extends J.f{static _GetDefines(b){if(!b)return null;return b.extractDriverInfo().toLowerCase().indexOf("mali")>-1?"#define MALI 1\n":null}_gatherImports(b,d){b?(this._webGPUReady=!0,d.push(Promise.all([P.e(54).then(P.bind(P,14143)),P.e(55).then(P.bind(P,14149))]))):d.push(Promise.all([P.e(56).then(P.bind(P,14157)),P.e(57).then(P.bind(P,14162))]))}constructor(b){const d={...arguments.length>2?arguments[2]:void 0,name:b,Md:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||L.e.LastCreatedEngine,useShaderStore:!0,useAsPostProcess:!0,vertexShader:Y.VertexUrl,fragmentShader:Y.FragmentUrl,uniforms:Y.Uniforms};super({...d,defines:Y._GetDefines(d.Md)}),this.texelSize=new x.Vector2(0,0)}bind(){let b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super.bind(b),this._drawWrapper.effect.setFloat2("texelSize",this.texelSize.x,this.texelSize.y)}}Y.VertexUrl="fxaa",Y.FragmentUrl="fxaa",Y.Uniforms=["texelSize"];class s extends i.e{getClassName(){return"FxaaPostProcess"}constructor(b,d){let P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,W=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,q=arguments.length>5?arguments[5]:void 0,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const J={uniforms:Y.Uniforms,size:"number"===typeof d?d:void 0,camera:P,samplingMode:W||G.d.BILINEAR_SAMPLINGMODE,Md:i,reusable:q,textureType:C,...d};super(b,Y.FragmentUrl,{effectWrapper:"number"!==typeof d&&d.effectWrapper?void 0:new Y(b,i,J),...J}),this.onApplyObservable.add((b=>{this._effectWrapper.texelSize=this.texelSize}))}static _Parse(b,d,P,G){return C.c.Parse((()=>new s(b.name,b.options,d,b.renderTargetSamplingMode,P.getEngine(),b.reusable)),b,P,G)}}(0,q.f)("BABYLON.FxaaPostProcess",s);var E=P(11504),w=P(11484),t=P(11890),r=P(11898),B=P(11569);let n=null;function Z(b,d,P,G){let W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],q=arguments.length>6?arguments[6]:void 0,C=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const{height:J,width:L}=X(b,d,P);if(!J||!L)return void E.e.Error("Invalid 'size' parameter !");d.Xb().activeCamera===d?b.onEndFrameObservable.addOnce((()=>{n||(n=document.createElement("canvas")),n.width=L,n.height=J;const d=n.getContext("2d"),P=b.getRenderingCanvas();if(!d||!P)return void E.e.Error("Failed to create screenshot. Rendering context or rendering canvas is not available.");const x=P.width,Y=P.height,s=n.width,t=n.height,r=s/x,B=t/Y,Z=C?Math.max(r,B):Math.min(r,B),o=x*Z,A=Y*Z,f=(s-o)/2,g=(t-A)/2;d.drawImage(P,0,0,x,Y,f,g,o,A),i?(w.Tools.EncodeScreenshotCanvasData(n,void 0,W,void 0,q),G&&G("")):w.Tools.EncodeScreenshotCanvasData(n,G,W,void 0,q)})):f(b,d,P,(b=>{if(i){const d=new Blob([b]);w.Tools.DownloadBlob(d),G&&G("")}else G&&G(b)}),W,1,b.getCreationOptions().antialias,void 0,void 0,void 0,void 0,q)}async function o(b,d,P){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",W=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return await new Promise(((q,C)=>{Z(b,d,P,(b=>{"undefined"!==typeof b?q(b):C(new Error("Data is undefined"))}),G,void 0,W,i)}))}async function A(b,d,P,G){let W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",i=arguments.length>5?arguments[5]:void 0,q=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return await new Promise((C=>{Z(b,d,{width:P,height:G},(()=>{C()}),W,!0,i,q)}))}function f(b,d,i,q){let C=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",J=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,L=arguments.length>6&&void 0!==arguments[6]&&arguments[6],x=arguments.length>7?arguments[7]:void 0,Y=arguments.length>8&&void 0!==arguments[8]&&arguments[8],w=arguments.length>9&&void 0!==arguments[9]&&arguments[9],n=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],Z=arguments.length>11?arguments[11]:void 0,o=arguments.length>12?arguments[12]:void 0,A=arguments.length>13?arguments[13]:void 0;const{height:f,width:g,finalWidth:u,finalHeight:M}=X(b,d,i),e={width:g,height:f};if(!f||!g)return void E.e.Error("Invalid 'size' parameter !");b.skipFrameRender=!0;const R=b.getRenderWidth,U=b.getRenderHeight;b.getRenderWidth=function(){return!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&b._currentRenderTarget?b._currentRenderTarget.width:g},b.getRenderHeight=function(){return!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&b._currentRenderTarget?b._currentRenderTarget.height:f},b.onResizeObservable.hasObservers()&&b.onResizeObservable.notifyObservers(b);const H=d.Xb(),p=new W.c("screenShot",e,H,!1,!1,0,!1,G.d.BILINEAR_SAMPLINGMODE,void 0,w,void 0,void 0,void 0,J);p.renderList=H.meshes.slice(),p.samples=J,p.renderSprites=Y,p.activeCamera=d,p.forceLayerMaskCheck=n,null===o||void 0===o||o(p);const S=A||t.DumpData,l=()=>{H.incrementRenderId(),H.resetCachedMaterial(),(0,B.e)((()=>p.isReadyForRendering()&&d.isReady(!0)),(()=>{b.onEndFrameObservable.addOnce((()=>{u===g&&M===f?p.readPixels(void 0,void 0,void 0,!1).then((b=>{S(g,f,b,q,C,x,!0,void 0,Z),p.dispose()})):(b.isWebGPU?P.e(51).then(P.bind(P,14129)):P.e(52).then(P.bind(P,14136))).then((async()=>await(0,r.b)("pass",p.getInternalTexture(),H,void 0,void 0,void 0,u,M).then((d=>{b._readTexturePixels(d,u,M,-1,0,null,!0,!1,0,0).then((b=>{S(u,M,b,q,C,x,!0,void 0,Z),d.dispose()}))}))))})),H.incrementRenderId(),H.resetCachedMaterial();const G=H.activeCamera,W=H.activeCameras,i=d.outputRenderTarget,J=H.spritesEnabled;H.activeCamera=d,H.activeCameras=null,d.outputRenderTarget=p,H.spritesEnabled=Y;const L=H.meshes;H.meshes=p.renderList||H.meshes;try{H.render()}finally{H.activeCamera=G,H.activeCameras=W,d.outputRenderTarget=i,H.spritesEnabled=J,H.meshes=L,b.getRenderWidth=R,b.getRenderHeight=U,b.onResizeObservable.hasObservers()&&b.onResizeObservable.notifyObservers(b),d.getProjectionMatrix(!0),b.skipFrameRender=!1}}),(()=>{b.skipFrameRender=!1,b.getRenderWidth=R,b.getRenderHeight=U}))};if(L){const b=new s("antialiasing",1,H.activeCamera);p.addPostProcess(b),b.pd=!0,b.onEffectCreatedObservable.addOnce((b=>{b.isReady()?l():b.onCompiled=()=>{l()}}))}else l()}async function g(b,d,P){let G=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",W=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],q=arguments.length>6?arguments[6]:void 0,C=arguments.length>7&&void 0!==arguments[7]&&arguments[7],J=arguments.length>8&&void 0!==arguments[8]&&arguments[8],L=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],x=arguments.length>10?arguments[10]:void 0,Y=arguments.length>11?arguments[11]:void 0,s=arguments.length>12?arguments[12]:void 0;return await new Promise(((E,w)=>{f(b,d,P,(b=>{"undefined"!==typeof b?E(b):w(new Error("Data is undefined"))}),G,W,i,q,C,J,L,x,Y,s)}))}function X(b,d,P){let G=0,W=0,i=0,q=0;if("object"===typeof P){const C=P.precision?Math.abs(P.precision):1;P.width&&P.height?(G=P.height*C,W=P.width*C):P.width&&!P.height?(W=P.width*C,G=Math.round(W/b.getAspectRatio(d))):P.height&&!P.width?(G=P.height*C,W=Math.round(G*b.getAspectRatio(d))):(W=Math.round(b.getRenderWidth()*C),G=Math.round(W/b.getAspectRatio(d))),P.finalWidth&&P.finalHeight?(q=P.finalHeight,i=P.finalWidth):P.finalWidth&&!P.finalHeight?(i=P.finalWidth,q=Math.round(i/b.getAspectRatio(d))):P.finalHeight&&!P.finalWidth?(q=P.finalHeight,i=Math.round(q*b.getAspectRatio(d))):(i=W,q=G)}else isNaN(P)||(G=P,W=P,i=P,q=P);return W&&(W=Math.floor(W)),G&&(G=Math.floor(G)),i&&(i=Math.floor(i)),q&&(q=Math.floor(q)),{height:0|G,width:0|W,finalWidth:0|i,finalHeight:0|q}}const u={CreateScreenshot:Z,CreateScreenshotAsync:o,CreateScreenshotWithResizeAsync:A,CreateScreenshotUsingRenderTarget:f,CreateScreenshotUsingRenderTargetAsync:g};w.Tools.CreateScreenshot=Z,w.Tools.CreateScreenshotAsync=o,w.Tools.CreateScreenshotUsingRenderTarget=f,w.Tools.CreateScreenshotUsingRenderTargetAsync=g}}]);