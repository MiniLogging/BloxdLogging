"use strict";(self.webpackChunkbloxd=self.webpackChunkbloxd||[]).push([[12],{10984:(o,i,p)=>{p.r(i),p.d(i,{_ExrTextureLoader:()=>L});var b=p(1059),k=p(1008);const u=65536,j=14,z=65537,g=16384;var J,a;!function(o){o[o.NO_COMPRESSION=0]="NO_COMPRESSION",o[o.RLE_COMPRESSION=1]="RLE_COMPRESSION",o[o.ZIPS_COMPRESSION=2]="ZIPS_COMPRESSION",o[o.ZIP_COMPRESSION=3]="ZIP_COMPRESSION",o[o.PIZ_COMPRESSION=4]="PIZ_COMPRESSION",o[o.PXR24_COMPRESSION=5]="PXR24_COMPRESSION"}(J||(J={})),function(o){o[o.INCREASING_Y=0]="INCREASING_Y",o[o.DECREASING_Y=1]="DECREASING_Y"}(a||(a={}));const G=function(){const o=new ArrayBuffer(4),i=new Float32Array(o),p=new Uint32Array(o),b=new Uint32Array(512),k=new Uint32Array(512);for(let g=0;g<256;++g){const o=g-127;o<-27?(b[g]=0,b[256|g]=32768,k[g]=24,k[256|g]=24):o<-14?(b[g]=1024>>-o-14,b[256|g]=1024>>-o-14|32768,k[g]=-o-1,k[256|g]=-o-1):o<=15?(b[g]=o+15<<10,b[256|g]=o+15<<10|32768,k[g]=13,k[256|g]=13):o<128?(b[g]=31744,b[256|g]=64512,k[g]=24,k[256|g]=24):(b[g]=31744,b[256|g]=64512,k[g]=13,k[256|g]=13)}const u=new Uint32Array(2048),j=new Uint32Array(64),z=new Uint32Array(64);for(let g=1;g<1024;++g){let o=g<<13,i=0;for(;0===(8388608&o);)o<<=1,i-=8388608;o&=-8388609,i+=947912704,u[g]=o|i}for(let g=1024;g<2048;++g)u[g]=939524096+(g-1024<<13);for(let g=1;g<31;++g)j[g]=g<<23;j[31]=1199570944,j[32]=2147483648;for(let g=33;g<63;++g)j[g]=2147483648+(g-32<<23);j[63]=3347054592;for(let g=1;g<64;++g)32!==g&&(z[g]=1024);return{floatView:i,uint32View:p,baseTable:b,shiftTable:k,mantissaTable:u,exponentTable:j,offsetTable:z}}();function O(o,i){const p=new Uint8Array(o);let b=0;for(;0!=p[i.value+b];)b+=1;const k=(new TextDecoder).decode(p.slice(i.value,i.value+b));return i.value=i.value+b+1,k}function C(o,i){const p=o.getInt32(i.value,!0);return i.value+=4,p}function l(o,i){const p=o.getUint32(i.value,!0);return i.value+=4,p}function R(o,i){const p=o.getUint8(i.value);return i.value+=1,p}function E(o,i){const p=o.getUint16(i.value,!0);return i.value+=2,p}function F(o,i){const p=o[i.value];return i.value+=1,p}function e(o,i){let p;return p="getBigInt64"in DataView.prototype?Number(o.getBigInt64(i.value,!0)):o.getUint32(i.value+4,!0)+Number(o.getUint32(i.value,!0)<<32),i.value+=8,p}function W(o,i){const p=o.getFloat32(i.value,!0);return i.value+=4,p}function M(o,i){return function(o){const i=(31744&o)>>10,p=1023&o;return(o>>15?-1:1)*(i?31===i?p?NaN:1/0:Math.pow(2,i-15)*(1+p/1024):p/1024*6103515625e-14)}(E(o,i))}function T(o,i){return function(o){if(Math.abs(o)>65504)throw new Error("Value out of range.Consider using float instead of half-float.");o=(0,k.d)(o,-65504,65504),G.floatView[0]=o;const i=G.uint32View[0],p=i>>23&511;return G.baseTable[p]+((8388607&i)>>G.shiftTable[p])}(W(o,i))}function N(o,i,p,b){switch(p){case"string":case"stringvector":case"iccProfile":return function(o,i,p){const b=(new TextDecoder).decode(new Uint8Array(o).slice(i.value,i.value+p));return i.value=i.value+p,b}(o.buffer,i,b);case"chlist":return function(o,i,p){const b=i.value,k=[];for(;i.value<b+p-1;){const p=O(o.buffer,i),b=C(o,i),u=R(o,i);i.value+=3;const j=C(o,i),z=C(o,i);k.push({name:p,pixelType:b,pLinear:u,xSampling:j,ySampling:z})}return i.value+=1,k}(o,i,b);case"chromaticities":return function(o,i){return{redX:W(o,i),redY:W(o,i),greenX:W(o,i),greenY:W(o,i),blueX:W(o,i),blueY:W(o,i),whiteX:W(o,i),whiteY:W(o,i)}}(o,i);case"compression":return function(o,i){return R(o,i)}(o,i);case"box2i":return function(o,i){return{xMin:C(o,i),yMin:C(o,i),xMax:C(o,i),yMax:C(o,i)}}(o,i);case"lineOrder":return function(o,i){const p=R(o,i);return a[p]}(o,i);case"float":return W(o,i);case"v2f":return function(o,i){return[W(o,i),W(o,i)]}(o,i);case"v3f":return function(o,i){return[W(o,i),W(o,i),W(o,i)]}(o,i);case"int":return C(o,i);case"rational":return function(o,i){return[C(o,i),l(o,i)]}(o,i);case"timecode":return function(o,i){return[l(o,i),l(o,i)]}(o,i);case"preview":return i.value+=b,"skipped";default:return void(i.value+=b)}}function U(o){for(let i=1;i<o.length;i++){const p=o[i-1]+o[i]-128;o[i]=p}}function v(o,i){let p=0,b=Math.floor((o.length+1)/2),k=0;const u=o.length-1;for(;!(k>u)&&(i[k++]=o[p++],!(k>u));)i[k++]=o[b++]}function x(o,i,p,b,k){for(;p<o;)i=i<<8|F(b,k),p+=8;return{l:i>>(p-=o)&(1<<o)-1,c:i,lc:p}}function c(o,i,p,b){return{c:o=o<<8|F(p,b),lc:i+=8}}function y(o,i,p,b,k,u,j,z,g){if(o==i){if(b<8){const o=c(p,b,k,u);p=o.c,b=o.lc}let o=p>>(b-=8);if(o=new Uint8Array([o])[0],z.value+o>g)return null;const i=j[z.value-1];for(;o-- >0;)j[z.value++]=i}else{if(!(z.value<g))return null;j[z.value++]=o}return{c:p,lc:b}}const S=new Array(59);function t(o,i,p,b,k,u){const j=i;let g=0,J=0;for(;b<=k;b++){if(j.value-i.value>p)return;let z=x(6,g,J,o,j);const a=z.l;if(g=z.c,J=z.lc,u[b]=a,63==a){if(j.value-i.value>p)throw new Error("Error in HufUnpackEncTable");z=x(8,g,J,o,j);let a=z.l+6;if(g=z.c,J=z.lc,b+a>k+1)throw new Error("Error in HufUnpackEncTable");for(;a--;)u[b++]=0;b--}else if(a>=59){let o=a-59+2;if(b+o>k+1)throw new Error("Error in HufUnpackEncTable");for(;o--;)u[b++]=0;b--}}!function(o){for(let p=0;p<=58;++p)S[p]=0;for(let p=0;p<z;++p)S[o[p]]+=1;let i=0;for(let p=58;p>0;--p){const o=i+S[p]>>1;S[p]=i,i=o}for(let p=0;p<z;++p){const i=o[p];i>0&&(o[p]=i|S[i]++<<6)}}(u)}function w(o){return 63&o}function Z(o){return o>>6}function I(o,i,p,b,k,u){const J=p.value,a=l(i,p),G=l(i,p);p.value+=4;const O=l(i,p);if(p.value+=4,a<0||a>=z||G<0||G>=z)throw new Error("Wrong HUF_ENCSIZE");const C=new Array(z),R=new Array(g);!function(o){for(let i=0;i<g;i++)o[i]={},o[i].len=0,o[i].lit=0,o[i].p=null}(R);if(t(o,p,b-(p.value-J),a,G,C),O>8*(b-(p.value-J)))throw new Error("Wrong hufUncompress");!function(o,i,p,b){for(;i<=p;i++){const p=Z(o[i]),k=w(o[i]);if(p>>k)throw new Error("Invalid table entry");if(k>j){const o=b[p>>k-j];if(o.len)throw new Error("Invalid table entry");if(o.lit++,o.p){const i=o.p;o.p=new Array(o.lit);for(let p=0;p<o.lit-1;++p)o.p[p]=i[p]}else o.p=new Array(1);o.p[o.lit-1]=i}else if(k){let o=0;for(let u=1<<j-k;u>0;u--){const u=b[(p<<j-k)+o];if(u.len||u.p)throw new Error("Invalid table entry");u.len=k,u.lit=i,o++}}}}(C,a,G,R),function(o,i,p,b,k,u,z,g,J){let a=0,G=0;const O=z,C=Math.trunc(b.value+(k+7)/8);for(;b.value<C;){let k=c(a,G,p,b);for(a=k.c,G=k.lc;G>=j;){const z=i[a>>G-j&16383];if(z.len){G-=z.len;const o=y(z.lit,u,a,G,p,b,g,J,O);o&&(a=o.c,G=o.lc)}else{if(!z.p)throw new Error("hufDecode issues");let i;for(i=0;i<z.lit;i++){const j=w(o[z.p[i]]);for(;G<j&&b.value<C;)k=c(a,G,p,b),a=k.c,G=k.lc;if(G>=j&&Z(o[z.p[i]])==(a>>G-j&(1<<j)-1)){G-=j;const o=y(z.p[i],u,a,G,p,b,g,J,O);o&&(a=o.c,G=o.lc);break}}if(i==z.lit)throw new Error("HufDecode issues")}}}const l=8-k&7;for(a>>=l,G-=l;G>0;){const o=i[a<<j-G&16383];if(!o.len)throw new Error("HufDecode issues");{G-=o.len;const i=y(o.lit,u,a,G,p,b,g,J,O);i&&(a=i.c,G=i.lc)}}}(C,R,o,p,O,G,u,k,{value:0})}function Q(o){return 65535&o}function K(o){const i=Q(o);return i>32767?i-65536:i}function D(o,i){const p=K(o),b=K(i),k=p+(1&b)+(b>>1);return{a:k,b:k-b}}function X(o,i){const p=Q(o),b=Q(i),k=p-(b>>1)&65535;return{a:b+k-32768&65535,b:k}}function h(o,i,p,b,k,u,j){const z=j<16384,g=p>k?k:p;let J,a,G=1;for(;G<=g;)G<<=1;for(G>>=1,J=G,G>>=1;G>=1;){a=0;const j=a+u*(k-J),g=u*G,O=u*J,C=b*G,l=b*J;let R,E,F,e;for(;a<=j;a+=O){let k=a;const u=a+b*(p-J);for(;k<=u;k+=l){const p=k+C,b=k+g,u=b+C;if(z){let j=D(o[k+i],o[b+i]);R=j.a,F=j.b,j=D(o[p+i],o[u+i]),E=j.a,e=j.b,j=D(R,E),o[k+i]=j.a,o[p+i]=j.b,j=D(F,e),o[b+i]=j.a,o[u+i]=j.b}else{let j=X(o[k+i],o[b+i]);R=j.a,F=j.b,j=X(o[p+i],o[u+i]),E=j.a,e=j.b,j=X(R,E),o[k+i]=j.a,o[p+i]=j.b,j=X(F,e),o[b+i]=j.a,o[u+i]=j.b}}if(p&G){const p=k+g;let b;b=z?D(o[k+i],o[p+i]):X(o[k+i],o[p+i]),R=b.a,o[p+i]=b.b,o[k+i]=R}}if(k&G){let k=a;const u=a+b*(p-J);for(;k<=u;k+=l){const p=k+C;let b;b=z?D(o[k+i],o[p+i]):X(o[k+i],o[p+i]),R=b.a,o[p+i]=b.b,o[k+i]=R}}J=G,G>>=1}return a}function A(o){return new DataView(o.array.buffer,o.offset.value,o.size)}function f(o){const i=o.viewer.buffer.slice(o.offset.value,o.offset.value+o.size),p=new Uint8Array(function(o){let i=o.byteLength;const p=new Array;let b=0;const k=new DataView(o);for(;i>0;){const o=k.getInt8(b++);if(o<0){const u=-o;i-=u+1;for(let o=0;o<u;o++)p.push(k.getUint8(b++))}else{const u=o;i-=2;const j=k.getUint8(b++);for(let o=0;o<u+1;o++)p.push(j)}}return p}(i)),b=new Uint8Array(p.length);return U(p),v(p,b),new DataView(b.buffer)}function r(o){const i=o.array.slice(o.offset.value,o.offset.value+o.size),p=fflate.unzlibSync(i),b=new Uint8Array(p.length);return U(p),v(p,b),new DataView(b.buffer)}function V(o){const i=o.array.slice(o.offset.value,o.offset.value+o.size),p=fflate.unzlibSync(i),b=o.lines*o.channels*o.width,k=1==o.type?new Uint16Array(b):new Uint32Array(b);let u=0,j=0;const z=new Array(4);for(let g=0;g<o.lines;g++)for(let i=0;i<o.channels;i++){let i=0;switch(o.type){case 1:z[0]=u,z[1]=z[0]+o.width,u=z[1]+o.width;for(let b=0;b<o.width;++b){i+=p[z[0]++]<<8|p[z[1]++],k[j]=i,j++}break;case 2:z[0]=u,z[1]=z[0]+o.width,z[2]=z[1]+o.width,u=z[2]+o.width;for(let b=0;b<o.width;++b){i+=p[z[0]++]<<24|p[z[1]++]<<16|p[z[2]++]<<8,k[j]=i,j++}}}return new DataView(k.buffer)}function P(o){const i=o.viewer,p={value:o.offset.value},b=new Uint16Array(o.width*o.scanlineBlockSize*(o.channels*o.type)),k=new Uint8Array(8192);let j=0;const z=new Array(o.channels);for(let u=0;u<o.channels;u++)z[u]={},z[u].start=j,z[u].end=z[u].start,z[u].nx=o.width,z[u].ny=o.lines,z[u].size=o.type,j+=z[u].nx*z[u].ny*z[u].size;const g=E(i,p),J=E(i,p);if(J>=8192)throw new Error("Wrong PIZ_COMPRESSION BITMAP_SIZE");if(g<=J)for(let u=0;u<J-g+1;u++)k[u+g]=R(i,p);const a=new Uint16Array(u),G=function(o,i){let p=0;for(let k=0;k<u;++k)(0==k||o[k>>3]&1<<(7&k))&&(i[p++]=k);const b=p-1;for(;p<u;)i[p++]=0;return b}(k,a),O=l(i,p);I(o.array,i,p,O,b,j);for(let u=0;u<o.channels;++u){const o=z[u];for(let i=0;i<z[u].size;++i)h(b,o.start+i,o.nx,o.size,o.ny,o.nx*o.size,G)}!function(o,i,p){for(let b=0;b<p;++b)i[b]=o[i[b]]}(a,b,j);let C=0;const F=new Uint8Array(b.buffer.byteLength);for(let u=0;u<o.lines;u++)for(let i=0;i<o.channels;i++){const o=z[i],p=o.nx*o.size,k=new Uint8Array(b.buffer,2*o.end,2*p);F.set(k,C),C+=2*p,o.end+=p}return new DataView(F.buffer)}var d,q=p(1175);!function(o){o[o.Float=0]="Float",o[o.HalfFloat=1]="HalfFloat"}(d||(d={}));class B{}B.DefaultOutputType=d.HalfFloat,B.FFLATEUrl="https://unpkg.com/fflate@0.8.2";class L{constructor(){this.supportCascades=!1}loadCubeData(o,i,p,b,k){throw".exr not supported in Cube."}async loadData(o,i,p){const k=new DataView(o.buffer),u={value:0},j=function(o,i){if(20000630!=o.getUint32(0,!0))throw new Error("Incorrect OpenEXR format");const p=o.getUint8(4),k=o.getUint8(5),u={singleTile:!!(2&k),longName:!!(4&k),deepFormat:!!(8&k),multiPart:!!(16&k)};i.value=8;const j={};let z=!0;for(;z;){const p=O(o.buffer,i);if(p){const k=O(o.buffer,i),u=N(o,i,k,l(o,i));void 0===u?b.c.Warn(`Unknown header attribute type ${k}'.`):j[p]=u}else z=!1}if(0!=(-5&k))throw new Error("Unsupported file format");return{version:p,spec:u,...j}}(k,u),z=await async function(o,i,p,b){const k={size:0,viewer:i,array:new Uint8Array(i.buffer),offset:p,width:o.dataWindow.xMax-o.dataWindow.xMin+1,height:o.dataWindow.yMax-o.dataWindow.yMin+1,channels:o.channels.length,channelLineOffsets:{},scanOrder:()=>0,bytesPerLine:0,outLineWidth:0,lines:0,scanlineBlockSize:0,inputSize:null,type:0,uncompress:null,getter:()=>0,format:5,outputChannels:0,decodeChannels:{},blockCount:null,byteArray:null,linearSpace:!1,textureType:0};switch(o.compression){case J.NO_COMPRESSION:k.lines=1,k.uncompress=A;break;case J.RLE_COMPRESSION:k.lines=1,k.uncompress=f;break;case J.ZIPS_COMPRESSION:k.lines=1,k.uncompress=r,await q.h.LoadScriptAsync(B.FFLATEUrl);break;case J.ZIP_COMPRESSION:k.lines=16,k.uncompress=r,await q.h.LoadScriptAsync(B.FFLATEUrl);break;case J.PIZ_COMPRESSION:k.lines=32,k.uncompress=P;break;case J.PXR24_COMPRESSION:k.lines=16,k.uncompress=V,await q.h.LoadScriptAsync(B.FFLATEUrl);break;default:throw new Error(J[o.compression]+" is unsupported")}k.scanlineBlockSize=k.lines;const u={};for(const J of o.channels)switch(J.name){case"Y":case"R":case"G":case"B":case"A":u[J.name]=!0,k.type=J.pixelType}let j=!1;if(u.R&&u.G&&u.B)j=!u.A,k.outputChannels=4,k.decodeChannels={R:0,G:1,B:2,A:3};else{if(!u.Y)throw new Error("EXRLoader.parse: file contains unsupported data channels.");k.outputChannels=1,k.decodeChannels={Y:0}}if(1===k.type)switch(b){case d.Float:k.getter=M,k.inputSize=2;break;case d.HalfFloat:k.getter=E,k.inputSize=2}else{if(2!==k.type)throw new Error("Unsupported pixelType "+k.type+" for "+o.compression);switch(b){case d.Float:k.getter=W,k.inputSize=4;break;case d.HalfFloat:k.getter=T,k.inputSize=4}}k.blockCount=k.height/k.scanlineBlockSize;for(let J=0;J<k.blockCount;J++)e(i,p);const z=k.width*k.height*k.outputChannels;switch(b){case d.Float:k.byteArray=new Float32Array(z),k.textureType=1,j&&k.byteArray.fill(1,0,z);break;case d.HalfFloat:k.byteArray=new Uint16Array(z),k.textureType=2,j&&k.byteArray.fill(15360,0,z);break;default:throw new Error("Unsupported type: "+b)}let g=0;for(const J of o.channels)void 0!==k.decodeChannels[J.name]&&(k.channelLineOffsets[J.name]=g*k.width),g+=2*J.pixelType;return k.bytesPerLine=k.width*g,k.outLineWidth=k.width*k.outputChannels,"INCREASING_Y"===o.lineOrder?k.scanOrder=o=>o:k.scanOrder=o=>k.height-1-o,4==k.outputChannels?(k.format=5,k.linearSpace=!0):(k.format=6,k.linearSpace=!1),k}(j,k,u,B.DefaultOutputType);!function(o,i,p,b){const k={value:0};for(let u=0;u<o.height/o.scanlineBlockSize;u++){const j=C(p,b)-i.dataWindow.yMin;o.size=l(p,b),o.lines=j+o.scanlineBlockSize>o.height?o.height-j:o.scanlineBlockSize;const z=o.size<o.lines*o.bytesPerLine&&o.uncompress?o.uncompress(o):A(o);b.value+=o.size;for(let p=0;p<o.scanlineBlockSize;p++){const b=u*o.scanlineBlockSize,j=p+o.scanOrder(b);if(j>=o.height)continue;const g=p*o.bytesPerLine,J=(o.height-1-j)*o.outLineWidth;for(let p=0;p<o.channels;p++){const b=i.channels[p].name,u=o.channelLineOffsets[b],j=o.decodeChannels[b];if(void 0!==j){k.value=g+u;for(let i=0;i<o.width;i++){const p=J+i*o.outputChannels+j;o.byteArray&&(o.byteArray[p]=o.getter(z,k))}}}}}}(z,j,k,u);p(j.dataWindow.xMax-j.dataWindow.xMin+1,j.dataWindow.yMax-j.dataWindow.yMin+1,i.generateMipMaps,!1,(()=>{const o=i.getEngine();i.format=j.format,i.type=z.textureType,i.invertY=!1,i._gammaSpace=!j.linearSpace,z.byteArray&&o._uploadDataToTextureDirectly(i,z.byteArray,0,0,void 0,!0)}))}}}}]);