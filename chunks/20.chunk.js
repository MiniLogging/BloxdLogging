"use strict";(self.ynu1yiqvs98=self.ynu1yiqvs98||[]).push([[20],{11345:(I,E,j)=>{j.r(E),j.d(E,{Dispose:()=>Z,DumpData:()=>o,DumpDataAsync:()=>P,DumpFramebuffer:()=>R,DumpTools:()=>c});var e=j(11230),w=j(10953),z=j(11136),h=j(10993);let t,U=null;async function R(I,E,j,e){let w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",z=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0;const t=await j.readPixels(0,0,I,E);o(I,E,new Uint8Array(t.buffer),e,w,z,!0,void 0,h)}async function P(I,E,j){let e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",w=arguments.length>4?arguments[4]:void 0,z=arguments.length>5&&void 0!==arguments[5]&&arguments[5],h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],t=arguments.length>7?arguments[7]:void 0;return await new Promise((U=>{o(I,E,j,(I=>U(I)),e,w,z,h,t)}))}function o(I,E,R,P){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",c=arguments.length>5?arguments[5]:void 0,K=arguments.length>6&&void 0!==arguments[6]&&arguments[6],L=arguments.length>7&&void 0!==arguments[7]&&arguments[7],F=arguments.length>8?arguments[8]:void 0;(async function(){return U||(U=new Promise(((I,E)=>{let w,z=null;const U={ae:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(j.bind(j,11257)).then((R=>{let{ThinEngine:P}=R;const o=h.d.Instances.length;try{w=new OffscreenCanvas(100,100),z=new P(w,!1,U)}catch(L){var c;o<h.d.Instances.length&&(null===(c=h.d.Instances.pop())||void 0===c||c.dispose()),w=document.createElement("canvas"),z=new P(w,!1,U)}h.d.Instances.pop(),h.d.OnEnginesDisposedObservable.add((I=>{z&&I!==z&&!z.Z&&0===h.d.Instances.length&&Z()})),z.getCaps().parallelShaderCompile=void 0;const K=new e.b(z);j.e(52).then(j.bind(j,13603)).then((j=>{let{passPixelShader:h}=j;if(!z)return void E("Engine is not defined");const U=new e.e({KE:z,name:h.name,fragmentShader:h.shader,samplerNames:["textureSampler"]});t={canvas:w,KE:z,renderer:K,wrapper:U},I(t)}))})).catch(E)}))),await U})().then((j=>{if(j.KE.setSize(I,E,!0),R instanceof Float32Array){const I=new Uint8Array(R.length);let E=R.length;for(;E--;){const j=R[E];I[E]=Math.round(255*(0,z.Clamp)(j))}R=I}const e=j.KE.createRawTexture(R,I,E,5,!1,!K,1);j.renderer.setViewport(),j.renderer.applyEffectWrapper(j.wrapper),j.wrapper.effect._bindTexture("textureSampler",e),j.renderer.draw(),L?w.Tools.ToBlob(j.canvas,(I=>{const E=new FileReader;E.onload=I=>{const E=I.target.result;P&&P(E)},E.readAsArrayBuffer(I)}),o,F):w.Tools.EncodeScreenshotCanvasData(j.canvas,P,o,c,F),e.dispose()}))}function Z(){var I;t?(t.wrapper.dispose(),t.renderer.dispose(),t.KE.dispose()):null===(I=U)||void 0===I||I.then((I=>{I.wrapper.dispose(),I.renderer.dispose(),I.KE.dispose()}));U=null,t=null}const c={DumpData:o,DumpDataAsync:P,DumpFramebuffer:R,Dispose:Z};w.Tools.DumpData=o,w.Tools.DumpDataAsync=P,w.Tools.DumpFramebuffer=R}}]);