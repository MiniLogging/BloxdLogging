"use strict";(self.hwpa2z1pqte=self.hwpa2z1pqte||[]).push([[20],{13110:(h,R,l)=>{l.r(R),l.d(R,{Dispose:()=>J,DumpData:()=>c,DumpDataAsync:()=>u,DumpFramebuffer:()=>mh,DumpTools:()=>q});var j=l(13005),a=l(12689),D=l(12917),U=l(12749);let F,w=null;async function mh(h,R,l,j){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",D=arguments.length>5?arguments[5]:void 0,U=arguments.length>6?arguments[6]:void 0;const F=await l.readPixels(0,0,h,R);c(h,R,new Uint8Array(F.buffer),j,a,D,!0,void 0,U)}async function u(h,R,l){let j=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",a=arguments.length>4?arguments[4]:void 0,D=arguments.length>5&&void 0!==arguments[5]&&arguments[5],U=arguments.length>6&&void 0!==arguments[6]&&arguments[6],F=arguments.length>7?arguments[7]:void 0;return await new Promise((w=>{c(h,R,l,(h=>w(h)),j,a,D,U,F)}))}function c(h,R,mh,u){let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",q=arguments.length>5?arguments[5]:void 0,Q=arguments.length>6&&void 0!==arguments[6]&&arguments[6],Y=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8?arguments[8]:void 0;(async function(){return w||(w=new Promise(((h,R)=>{let a,D=null;const w={o:!0,depth:!1,uF:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(l.bind(l,13026)).then((mh=>{let{ThinEngine:u}=mh;const c=U.b.Instances.length;try{a=new OffscreenCanvas(100,100),D=new u(a,!1,w)}catch(Y){var q;c<U.b.Instances.length&&(null===(q=U.b.Instances.pop())||void 0===q||q.dispose()),a=document.createElement("canvas"),D=new u(a,!1,w)}U.b.Instances.pop(),U.b.OnEnginesDisposedObservable.add((h=>{D&&h!==D&&!D.mh&&0===U.b.Instances.length&&J()})),D.getCaps().parallelShaderCompile=void 0;const Q=new j.c(D);l.e(52).then(l.bind(l,15412)).then((l=>{let{passPixelShader:U}=l;if(!D)return void R("Engine is not defined");const w=new j.g({sR:D,name:U.name,fragmentShader:U.shader,samplerNames:["textureSampler"]});F={canvas:a,sR:D,renderer:Q,wrapper:w},h(F)}))})).catch(R)}))),await w})().then((l=>{if(l.sR.setSize(h,R,!0),mh instanceof Float32Array){const h=new Uint8Array(mh.length);let R=mh.length;for(;R--;){const l=mh[R];h[R]=Math.round(255*(0,D.Clamp)(l))}mh=h}const j=l.sR.createRawTexture(mh,h,R,5,!1,!Q,1);l.renderer.setViewport(),l.renderer.applyEffectWrapper(l.wrapper),l.wrapper.effect._bindTexture("textureSampler",j),l.renderer.draw(),Y?a.Tools.ToBlob(l.canvas,(h=>{const R=new FileReader;R.onload=h=>{const R=h.target.result;u&&u(R)},R.readAsArrayBuffer(h)}),c,s):a.Tools.EncodeScreenshotCanvasData(l.canvas,u,c,q,s),j.dispose()}))}function J(){var h;F?(F.wrapper.dispose(),F.renderer.dispose(),F.sR.dispose()):null===(h=w)||void 0===h||h.then((h=>{h.wrapper.dispose(),h.renderer.dispose(),h.sR.dispose()}));w=null,F=null}const q={DumpData:c,DumpDataAsync:u,DumpFramebuffer:mh,Dispose:J};a.Tools.DumpData=c,a.Tools.DumpDataAsync=u,a.Tools.DumpFramebuffer=mh}}]);