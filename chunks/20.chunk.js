"use strict";(self.fjf2z1c8il8=self.fjf2z1c8il8||[]).push([[20],{12681:(g,i,a)=>{a.r(i),a.d(i,{Dispose:()=>j,DumpData:()=>I,DumpDataAsync:()=>F,DumpFramebuffer:()=>N,DumpTools:()=>y});var n=a(12550),L=a(12277),d=a(12466),b=a(12316);let k,e=null;async function N(g,i,a,n){let L=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",d=arguments.length>5?arguments[5]:void 0,b=arguments.length>6?arguments[6]:void 0;const k=await a.readPixels(0,0,g,i);I(g,i,new Uint8Array(k.buffer),n,L,d,!0,void 0,b)}async function F(g,i,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",L=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]&&arguments[5],b=arguments.length>6&&void 0!==arguments[6]&&arguments[6],k=arguments.length>7?arguments[7]:void 0;return await new Promise((e=>{I(g,i,a,(g=>e(g)),n,L,d,b,k)}))}function I(g,i,N,F){let I=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",y=arguments.length>5?arguments[5]:void 0,B=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],D=arguments.length>8?arguments[8]:void 0;(async function(){return e||(e=new Promise(((g,i)=>{let L,d=null;const e={vd:!0,depth:!1,bd:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(a.bind(a,12578)).then((N=>{let{ThinEngine:F}=N;const I=b.c.Instances.length;try{L=new OffscreenCanvas(100,100),d=new F(L,!1,e)}catch(c){var y;I<b.c.Instances.length&&(null===(y=b.c.Instances.pop())||void 0===y||y.dispose()),L=document.createElement("canvas"),d=new F(L,!1,e)}b.c.Instances.pop(),b.c.OnEnginesDisposedObservable.add((g=>{d&&g!==d&&!d.p&&0===b.c.Instances.length&&j()})),d.getCaps().parallelShaderCompile=void 0;const B=new n.e(d);a.e(52).then(a.bind(a,15022)).then((a=>{let{passPixelShader:b}=a;if(!d)return void i("Engine is not defined");const e=new n.f({yi:d,name:b.name,fragmentShader:b.shader,samplerNames:["textureSampler"]});k={canvas:L,yi:d,renderer:B,wrapper:e},g(k)}))})).catch(i)}))),await e})().then((a=>{if(a.yi.setSize(g,i,!0),N instanceof Float32Array){const g=new Uint8Array(N.length);let i=N.length;for(;i--;){const a=N[i];g[i]=Math.round(255*(0,d.Clamp)(a))}N=g}const n=a.yi.createRawTexture(N,g,i,5,!1,!B,1);a.renderer.setViewport(),a.renderer.applyEffectWrapper(a.wrapper),a.wrapper.effect._bindTexture("textureSampler",n),a.renderer.draw(),c?L.Tools.ToBlob(a.canvas,(g=>{const i=new FileReader;i.onload=g=>{const i=g.target.result;F&&F(i)},i.readAsArrayBuffer(g)}),I,D):L.Tools.EncodeScreenshotCanvasData(a.canvas,F,I,y,D),n.dispose()}))}function j(){var g;k?(k.wrapper.dispose(),k.renderer.dispose(),k.yi.dispose()):null===(g=e)||void 0===g||g.then((g=>{g.wrapper.dispose(),g.renderer.dispose(),g.yi.dispose()}));e=null,k=null}const y={DumpData:I,DumpDataAsync:F,DumpFramebuffer:N,Dispose:j};L.Tools.DumpData=I,L.Tools.DumpDataAsync=F,L.Tools.DumpFramebuffer=N}}]);