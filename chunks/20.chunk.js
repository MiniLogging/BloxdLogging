"use strict";(self["9s4i8ue3jq"]=self["9s4i8ue3jq"]||[]).push([[20],{13027:(a,c,o)=>{o.r(c),o.d(c,{Dispose:()=>L,DumpData:()=>j,DumpDataAsync:()=>C,DumpFramebuffer:()=>T,DumpTools:()=>e});var s=o(12910),q=o(12637),t=o(12824),i=o(12680);let p,G=null;async function T(a,c,o,s){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",t=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;const p=await o.readPixels(0,0,a,c);j(a,c,new Uint8Array(p.buffer),s,q,t,!0,void 0,i)}async function C(a,c,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",q=arguments.length>4?arguments[4]:void 0,t=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],p=arguments.length>7?arguments[7]:void 0;return await new Promise((G=>{j(a,c,o,(a=>G(a)),s,q,t,i,p)}))}function j(a,c,T,C){let j=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",e=arguments.length>5?arguments[5]:void 0,g=arguments.length>6&&void 0!==arguments[6]&&arguments[6],M=arguments.length>7&&void 0!==arguments[7]&&arguments[7],N=arguments.length>8?arguments[8]:void 0;(async function(){return G||(G=new Promise(((a,c)=>{let q,t=null;const G={fc:!0,depth:!1,Nc:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(o.bind(o,12945)).then((T=>{let{ThinEngine:C}=T;const j=i.b.Instances.length;try{q=new OffscreenCanvas(100,100),t=new C(q,!1,G)}catch(M){var e;j<i.b.Instances.length&&(null===(e=i.b.Instances.pop())||void 0===e||e.dispose()),q=document.createElement("canvas"),t=new C(q,!1,G)}i.b.Instances.pop(),i.b.OnEnginesDisposedObservable.add((a=>{t&&a!==t&&!t.L&&0===i.b.Instances.length&&L()})),t.getCaps().parallelShaderCompile=void 0;const g=new s.d(t);o.e(52).then(o.bind(o,15260)).then((o=>{let{passPixelShader:i}=o;if(!t)return void c("Engine is not defined");const G=new s.h({mo:t,name:i.name,fragmentShader:i.shader,samplerNames:["textureSampler"]});p={canvas:q,mo:t,renderer:g,wrapper:G},a(p)}))})).catch(c)}))),await G})().then((o=>{if(o.mo.setSize(a,c,!0),T instanceof Float32Array){const a=new Uint8Array(T.length);let c=T.length;for(;c--;){const o=T[c];a[c]=Math.round(255*(0,t.Clamp)(o))}T=a}const s=o.mo.createRawTexture(T,a,c,5,!1,!g,1);o.renderer.setViewport(),o.renderer.applyEffectWrapper(o.wrapper),o.wrapper.effect._bindTexture("textureSampler",s),o.renderer.draw(),M?q.Tools.ToBlob(o.canvas,(a=>{const c=new FileReader;c.onload=a=>{const c=a.target.result;C&&C(c)},c.readAsArrayBuffer(a)}),j,N):q.Tools.EncodeScreenshotCanvasData(o.canvas,C,j,e,N),s.dispose()}))}function L(){var a;p?(p.wrapper.dispose(),p.renderer.dispose(),p.mo.dispose()):null===(a=G)||void 0===a||a.then((a=>{a.wrapper.dispose(),a.renderer.dispose(),a.mo.dispose()}));G=null,p=null}const e={DumpData:j,DumpDataAsync:C,DumpFramebuffer:T,Dispose:L};q.Tools.DumpData=j,q.Tools.DumpDataAsync=C,q.Tools.DumpFramebuffer=T}}]);