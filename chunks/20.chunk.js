"use strict";(self["9jl1vn4ei5r"]=self["9jl1vn4ei5r"]||[]).push([[20],{12016:(M,p,b)=>{b.r(p),b.d(p,{Dispose:()=>o,DumpData:()=>F,DumpDataAsync:()=>H,DumpFramebuffer:()=>O,DumpTools:()=>W});var Q=b(11888),q=b(11621),B=b(11806),k=b(11664);let u,T=null;async function O(M,p,b,Q){let q=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",B=arguments.length>5?arguments[5]:void 0,k=arguments.length>6?arguments[6]:void 0;const u=await b.readPixels(0,0,M,p);F(M,p,new Uint8Array(u.buffer),Q,q,B,!0,void 0,k)}async function H(M,p,b){let Q=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",q=arguments.length>4?arguments[4]:void 0,B=arguments.length>5&&void 0!==arguments[5]&&arguments[5],k=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7?arguments[7]:void 0;return await new Promise((T=>{F(M,p,b,(M=>T(M)),Q,q,B,k,u)}))}function F(M,p,O,H){let F=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",W=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],A=arguments.length>7&&void 0!==arguments[7]&&arguments[7],j=arguments.length>8?arguments[8]:void 0;(async function(){return T||(T=new Promise(((M,p)=>{let q,B=null;const T={kb:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};Promise.resolve().then(b.bind(b,11919)).then((O=>{let{ThinEngine:H}=O;const F=k.c.Instances.length;try{q=new OffscreenCanvas(100,100),B=new H(q,!1,T)}catch(A){var W;F<k.c.Instances.length&&(null===(W=k.c.Instances.pop())||void 0===W||W.dispose()),q=document.createElement("canvas"),B=new H(q,!1,T)}k.c.Instances.pop(),k.c.OnEnginesDisposedObservable.add((M=>{B&&M!==B&&!B.O&&0===k.c.Instances.length&&o()})),B.getCaps().parallelShaderCompile=void 0;const i=new Q.e(B);b.e(52).then(b.bind(b,14201)).then((b=>{let{passPixelShader:k}=b;if(!B)return void p("Engine is not defined");const T=new Q.g({Wp:B,name:k.name,fragmentShader:k.shader,samplerNames:["textureSampler"]});u={canvas:q,Wp:B,renderer:i,wrapper:T},M(u)}))})).catch(p)}))),await T})().then((b=>{if(b.Wp.setSize(M,p,!0),O instanceof Float32Array){const M=new Uint8Array(O.length);let p=O.length;for(;p--;){const b=O[p];M[p]=Math.round(255*(0,B.Clamp)(b))}O=M}const Q=b.Wp.createRawTexture(O,M,p,5,!1,!i,1);b.renderer.setViewport(),b.renderer.applyEffectWrapper(b.wrapper),b.wrapper.effect._bindTexture("textureSampler",Q),b.renderer.draw(),A?q.Tools.ToBlob(b.canvas,(M=>{const p=new FileReader;p.onload=M=>{const p=M.target.result;H&&H(p)},p.readAsArrayBuffer(M)}),F,j):q.Tools.EncodeScreenshotCanvasData(b.canvas,H,F,W,j),Q.dispose()}))}function o(){var M;u?(u.wrapper.dispose(),u.renderer.dispose(),u.Wp.dispose()):null===(M=T)||void 0===M||M.then((M=>{M.wrapper.dispose(),M.renderer.dispose(),M.Wp.dispose()}));T=null,u=null}const W={DumpData:F,DumpDataAsync:H,DumpFramebuffer:O,Dispose:o};q.Tools.DumpData=F,q.Tools.DumpDataAsync=H,q.Tools.DumpFramebuffer=O}}]);