"use strict";(self["3nlrbof8msu"]=self["3nlrbof8msu"]||[]).push([[8],{12623:(t,b,Z)=>{Z.d(b,{e:()=>U});var J=Z(12585),S=Z(12557),P=Z(12632),v=Z(12658),h=Z(12570);class C{constructor(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,t&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset!==t&&(this._zOffset=t,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(t){this._zOffsetUnits!==t&&(this._zOffsetUnits=t,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(t){this._cullFace!==t&&(this._cullFace=t,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(t){this._cull!==t&&(this._cull=t,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(t){this._depthFunc!==t&&(this._depthFunc=t,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(t){this._depthMask!==t&&(this._depthMask=t,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(t){this._depthTest!==t&&(this._depthTest=t,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(t){this._frontFace!==t&&(this._frontFace=t,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(t){this.isDirty&&(this._isCullDirty&&(this.cull?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(t.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(t.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(t.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(this.zOffset,this.zOffsetUnits)):t.disable(t.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(t.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}class Y{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(t){this._func!==t&&(this._func=t,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(t){this._funcRef!==t&&(this._funcRef=t,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(t){this._funcMask!==t&&(this._funcMask=t,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(t){this._opStencilFail!==t&&(this._opStencilFail=t,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(t){this._opDepthFail!==t&&(this._opDepthFail=t,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(t){this._opStencilDepthPass!==t&&(this._opStencilDepthPass=t,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(t){this._mask!==t&&(this._mask=t,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(t){this._enabled!==t&&(this._enabled=t,this._isStencilTestDirty=!0)}constructor(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,t&&this.reset()}reset(){var t;this.stencilMaterial=void 0,null===(t=this.stencilGlobal)||void 0===t||t.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(t){var b;if(!t)return;const Z=!this.useStencilGlobalOnly&&!(null===(b=this.stencilMaterial)||void 0===b||!b.enabled);this.enabled=Z?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=Z?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=Z?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=Z?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=Z?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=Z?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=Z?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=Z?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(t.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(t.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(t.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}class g{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=g.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=g.KEEP,this.opDepthFail=g.KEEP,this.opStencilDepthPass=g.REPLACE}get stencilFunc(){return this.func}set stencilFunc(t){this.func=t}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(t){this.funcRef=t}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(t){this.funcMask=t}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(t){this.opStencilFail=t}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(t){this.opDepthFail=t}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(t){this.opStencilDepthPass=t}get stencilMask(){return this.mask}set stencilMask(t){this.mask=t}get stencilTest(){return this.enabled}set stencilTest(t){this.enabled=t}}g.ALWAYS=519,g.KEEP=7680,g.REPLACE=7681;class I{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(t){this._alphaBlend!==t&&(this._alphaBlend=t,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(t,b,Z,J){this._blendConstants[0]===t&&this._blendConstants[1]===b&&this._blendConstants[2]===Z&&this._blendConstants[3]===J||(this._blendConstants[0]=t,this._blendConstants[1]=b,this._blendConstants[2]=Z,this._blendConstants[3]=J,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(t,b,Z,J){this._blendFunctionParameters[0]===t&&this._blendFunctionParameters[1]===b&&this._blendFunctionParameters[2]===Z&&this._blendFunctionParameters[3]===J||(this._blendFunctionParameters[0]=t,this._blendFunctionParameters[1]=b,this._blendFunctionParameters[2]=Z,this._blendFunctionParameters[3]=J,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(t,b){this._blendEquationParameters[0]===t&&this._blendEquationParameters[1]===b||(this._blendEquationParameters[0]=t,this._blendEquationParameters[1]=b,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(t){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?t.enable(t.BLEND):t.disable(t.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(t.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(t.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(t.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}var r=Z(12573),M=Z(12663),T=Z(12555),a=Z(12551),k=Z(12618),u=Z(12674);function l(t,b){if((0,T.f)()){const{requestAnimationFrame:Z}=b||window;if("function"===typeof Z)return Z(t)}else if("function"===typeof requestAnimationFrame)return requestAnimationFrame(t);return setTimeout(t,16)}class U{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(t){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get Tb(){return this._useReverseDepthBuffer}set Tb(t){t!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=t,this._depthCullingState.depthFunc=t?518:515)}setColorWrite(t){t!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=t)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(t){if(t)return this.isNDCHalfZRange?t.IS_NDC_HALF_ZRANGE="":delete t.IS_NDC_HALF_ZRANGE,this.Tb?t.USE_REVERSE_DEPTHBUFFER="":delete t.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?t.USE_EXACT_SRGB_CONVERSIONS="":delete t.USE_EXACT_SRGB_CONVERSIONS);{let t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.Tb&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(t&&(t+="\n"),t+="#define USE_EXACT_SRGB_CONVERSIONS"),t}}_rebuildInternalTextures(){const t=this._internalTexturesCache.slice();for(const b of t)b._rebuild()}_rebuildRenderTargetWrappers(){const t=this._renderTargetWrapperCache.slice();for(const b of t)b._rebuild()}_rebuildEffects(){for(const t in this._compiledEffects){const b=this._compiledEffects[t];b._pipelineContext=null,b._prepareEffect()}P.Effect.ResetCache()}_rebuildGraphicsResources(){var t;this.wipeCaches(!0),this._rebuildEffects(),null===(t=this._rebuildComputeEffects)||void 0===t||t.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){S.c.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(t){setTimeout((()=>{this._clearEmptyResources();const b=this._depthCullingState.depthTest,Z=this._depthCullingState.depthFunc,J=this._depthCullingState.depthMask,S=this._stencilState.stencilTest;t(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=b,this._depthCullingState.depthFunc=Z,this._depthCullingState.depthMask=J,this._stencilState.stencilTest=S,this._flagContextRestored()}),0)}get h(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(t){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(t){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const t=new Uint8Array(4),b=[t,t,t,t,t,t];this._emptyCubeTexture=this.createRawCubeTexture(b,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(t){if(!t)return this._activeRenderLoops.length=0,void this._cancelFrame();const b=this._activeRenderLoops.indexOf(t);b>=0&&(this._activeRenderLoops.splice(b,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){const t=this._frameHandler;if(this._frameHandler=0,(0,T.f)()){const{cancelAnimationFrame:b}=this.getHostWindow()||window;if("function"===typeof b)return b(t)}else if("function"===typeof cancelAnimationFrame)return cancelAnimationFrame(t);return clearTimeout(t)}}ab(){this.onBeginFrameObservable.notifyObservers(this)}ub(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}get maxFPS(){return this._maxFPS}set maxFPS(t){this._maxFPS=t,void 0!==t&&(this._minFrameTime=t<=0?Number.MAX_VALUE:1e3/t)}_isOverFrameTime(t){if(!t||void 0===this._maxFPS)return!1;const b=t-this._lastFrameTime;return this._lastFrameTime=t,this._renderAccumulator+=b,this._renderAccumulator<this._minFrameTime||(this._renderAccumulator-=this._minFrameTime,this._renderAccumulator>this._minFrameTime&&(this._renderAccumulator=this._minFrameTime),!1)}_processFrame(t){if(this._frameHandler=0,!this._contextWasLost&&!this._isOverFrameTime(t)){let t=!0;(this.h||!this.renderEvenInBackground&&this._windowIsBackground)&&(t=!1),t&&(this.ab(),this.skipFrameRender||this._renderViews()||this._renderFrame(),this.ub())}}_renderLoop(t){this._processFrame(t),this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}}_renderViews(){return!1}_queueNewFrame(t,b){return l(t,b)}runRenderLoop(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(t){this._depthCullingState.depthTest=t}setZOffset(t){this._depthCullingState.zOffset=this.Tb?-t:t}getZOffset(){const t=this._depthCullingState.zOffset;return this.Tb?-t:t}setZOffsetUnits(t){this._depthCullingState.zOffsetUnits=this.Tb?-t:t}getZOffsetUnits(){const t=this._depthCullingState.zOffsetUnits;return this.Tb?-t:t}getHostWindow(){return(0,T.f)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(t){this._compatibilityMode=!0}_rebuildTextures(){for(const t of this.scenes)t._rebuildTextures();for(const t of this._virtualScenes)t._rebuildTextures()}_releaseRenderTargetWrapper(t){const b=this._renderTargetWrapperCache.indexOf(t);-1!==b&&this._renderTargetWrapperCache.splice(b,1)}get currentViewport(){return this._cachedViewport}setViewport(t,b,Z){const J=b||this.getRenderWidth(),S=Z||this.getRenderHeight(),P=t.x||0,v=t.y||0;this._cachedViewport=t,this._viewport(P*J,v*S,J*t.width,S*t.height)}createCanvasImage(){return document.createElement("img")}createCanvasPath2D(t){return new Path2D(t)}get description(){let t=this.name+this.version;return this._caps.parallelShaderCompile&&(t+=" - Parallel shader compilation"),t}_createTextureBase(t,b,Z,P){let v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,C=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,Y=arguments.length>7?arguments[7]:void 0,g=arguments.length>8?arguments[8]:void 0,I=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,r=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,T=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,a=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,k=arguments.length>13?arguments[13]:void 0,l=arguments.length>14?arguments[14]:void 0,E=arguments.length>15?arguments[15]:void 0;const c="data:"===(t=t||"").substring(0,5),H="blob:"===t.substring(0,5),o=c&&-1!==t.indexOf(";base64,"),O=r||new M.d(this,1);O!==r&&(O.label=t.substring(0,60));const p=t;!this._transformTextureUrl||o||r||I||(t=this._transformTextureUrl(t)),p!==t&&(O._originalUrl=p);const e=t.lastIndexOf(".");let W=a||(e>-1?t.substring(e).toLowerCase():"");W.indexOf("?")>-1&&(W=W.split("?")[0]);const j=(0,u.b)(W,k);P&&P.addPendingData(O),O.url=t,O.generateMipMaps=!b,O.samplingMode=v,O.invertY=Z,O._useSRGBBuffer=this._getUseSRGBBuffer(!!E,b),this._doNotHandleContextLost||(O._buffer=I);let V=null;h&&!r&&(V=O.onLoadedObservable.add(h)),r||this._internalTexturesCache.push(O);const n=(Z,r)=>{P&&P.removePendingData(O),t===p?(V&&O.onLoadedObservable.remove(V),J.e.UseFallbackTexture&&t!==J.e.FallbackTexture&&this._createTextureBase(J.e.FallbackTexture,b,O.invertY,P,v,null,C,Y,g,I,O),Z=(Z||"Unknown error")+(J.e.UseFallbackTexture?" - Fallback texture was used":""),O.onErrorObservable.notifyObservers({message:Z,exception:r}),C&&C(Z,r)):(S.c.Warn(`Failed to load ${t}, falling back to ${p}`),this._createTextureBase(p,b,O.invertY,P,v,h,C,Y,g,I,O,T,a,k,l,E))};if(j){const b=async t=>{(await j).loadData(t,O,((t,b,Z,J,S,h)=>{h?n("TextureLoader failed to load data"):Y(O,W,P,{width:t,height:b},O.invertY,!Z,J,(()=>(S(),!1)),v)}),l)};I?I instanceof ArrayBuffer?b(new Uint8Array(I)):ArrayBuffer.isView(I)?b(I):C&&C("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,(t=>{b(new Uint8Array(t))}),void 0,P?P.offlineProvider:void 0,!0,((t,b)=>{n("Unable to load "+(t&&t.responseURL,b))}))}else{const Z=t=>{H&&!this._doNotHandleContextLost&&(O._buffer=t),Y(O,W,P,t,O.invertY,b,!1,g,v)};!c||o?I&&("string"===typeof I.decoding||I.close)?Z(I):U._FileToolsLoadImage(t||"",Z,n,P?P.offlineProvider:null,k,O.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):"string"===typeof I||I instanceof ArrayBuffer||ArrayBuffer.isView(I)||I instanceof Blob?U._FileToolsLoadImage(I,Z,n,P?P.offlineProvider:null,k,O.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):I&&Z(I)}return O}_rebuildBuffers(){for(const t of this._uniformBuffers)t._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,T.d)()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(const t in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,t)&&(this._boundTexturesCache[t]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(t){this._name=t}static get NpmPackage(){return"babylonjs@8.13.0"}static get Version(){return"8.13.0"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(t){this._hardwareScalingLevel=t,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(t){this._doNotHandleContextLost=t}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}constructor(t,b,Z){var S,P;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new C,this._stencilStateComposer=new Y,this._stencilState=new g,this._alphaState=new I,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new a.d,this.onCanvasFocusObservable=new a.d,this.onNewSceneAddedObservable=new a.d,this.onResizeObservable=new a.d,this.onCanvasPointerOutObservable=new a.d,this.onEffectErrorObservable=new a.d,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new a.d,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=t=>this._renderLoop(t),this._lastFrameTime=0,this._renderAccumulator=0,this.skipFrameRender=!1,this.onBeforeShaderCompilationObservable=new a.d,this.onAfterShaderCompilationObservable=new a.d,this.onBeginFrameObservable=new a.d,this.onEndFrameObservable=new a.d,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new a.d,this.onContextRestoredObservable=new a.d,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.lb=new a.d,this.onReleaseEffectsObservable=new a.d,J.e.Instances.push(this),this.startTime=h.e.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,v.c.SetMatrixPrecision(!!b.useHighPrecisionMatrix),(0,T.e)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=Z??!1,b.antialias=t??b.antialias,b.deterministicLockstep=b.deterministicLockstep??!1,b.lockstepMaxSteps=b.lockstepMaxSteps??4,b.timeStep=b.timeStep??1/60,b.Ub=b.Ub??!0,this._audioContext=(null===(S=b.audioEngineOptions)||void 0===S?void 0:S.audioContext)??null,this._audioDestination=(null===(P=b.audioEngineOptions)||void 0===P?void 0:P.audioDestination)??null,this.premultipliedAlpha=b.premultipliedAlpha??!0,this._doNotHandleContextLost=!!b.doNotHandleContextLost,this._isStencilEnable=!!b.Ub,this.useExactSrgbConversions=b.useExactSrgbConversions??!1;const r=(0,T.f)()&&window.devicePixelRatio||1,M=b.limitDeviceRatio||r;Z=Z||b.adaptToDeviceRatio||!1,this._hardwareScalingLevel=Z?1/Math.min(M,r):1,this._lastDevicePixelRatio=r,this._creationOptions=b}resize(){let t,b,Z=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.adaptToDeviceRatio){const t=(0,T.f)()&&window.devicePixelRatio||1,b=this._lastDevicePixelRatio/t;this._lastDevicePixelRatio=t,this._hardwareScalingLevel*=b}if((0,T.f)()&&(0,T.d)())if(this._renderingCanvas){var J,S;const Z=null===(J=(S=this._renderingCanvas).getBoundingClientRect)||void 0===J?void 0:J.call(S);t=this._renderingCanvas.clientWidth||(null===Z||void 0===Z?void 0:Z.width)||this._renderingCanvas.width*this._hardwareScalingLevel||100,b=this._renderingCanvas.clientHeight||(null===Z||void 0===Z?void 0:Z.height)||this._renderingCanvas.height*this._hardwareScalingLevel||100}else t=window.innerWidth,b=window.innerHeight;else t=this._renderingCanvas?this._renderingCanvas.width:100,b=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(t/this._hardwareScalingLevel,b/this._hardwareScalingLevel,Z)}setSize(t,b){let Z=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(t|=0,b|=0,!Z&&this._renderingCanvas.width===t&&this._renderingCanvas.height===b)return!1;if(this._renderingCanvas.width=t,this._renderingCanvas.height=b,this.scenes){for(let t=0;t<this.scenes.length;t++){const b=this.scenes[t];for(let t=0;t<b.cameras.length;t++){b.cameras[t]._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(t,b,Z,J,S,P,v,h,C,Y,g){throw(0,r.b)("engine.rawTexture")}createRawCubeTexture(t,b,Z,J,S,P,v,h){throw(0,r.b)("engine.rawTexture")}createRawTexture3D(t,b,Z,J,S,P,v,h,C,Y,g){throw(0,r.b)("engine.rawTexture")}createRawTexture2DArray(t,b,Z,J,S,P,v,h,C,Y,g){throw(0,r.b)("engine.rawTexture")}_sharedInit(t){this._renderingCanvas=t}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const t=navigator.userAgent;this.hostInformation.isMobile=-1!==t.indexOf("Mobile")||-1!==t.indexOf("Mac")&&(0,T.d)()&&"ontouchend"in document},this._checkForMobile(),(0,T.f)()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(t){return document.createElement("video")}_reportDrawCall(){var t;let b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;null===(t=this._drawCalls)||void 0===t||t.addCount(b,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(t,b){throw new Error("createImageBitmapFromSource is not implemented")}createImageBitmap(t,b){return createImageBitmap(t,b)}resizeImageBitmap(t,b,Z){throw new Error("resizeImageBitmap is not implemented")}getFontOffset(t){throw new Error("getFontOffset is not implemented")}static _CreateCanvas(t,b){if("undefined"===typeof document)return new OffscreenCanvas(t,b);const Z=document.createElement("canvas");return Z.width=t,Z.height=b,Z}createCanvas(t,b){return U._CreateCanvas(t,b)}static _FileToolsLoadImage(t,b,Z,J,S,P,v){throw(0,r.b)("FileTools")}_loadFile(t,b,Z,J,S,P){const v=(0,k.o)(t,b,Z,J,S,P);return this._activeRequests.push(v),v.onCompleteObservable.add((()=>{const t=this._activeRequests.indexOf(v);-1!==t&&this._activeRequests.splice(t,1)})),v}static _FileToolsLoadFile(t,b,Z,J,S,P){if(k.e.loadFile)return k.e.loadFile(t,b,Z,J,S,P);throw(0,r.b)("FileTools")}dispose(){var t;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(t=this.releaseComputeEffects)||void 0===t||t.call(this),P.Effect.ResetCache();for(const Z of this._activeRequests)Z.abort();this._boundRenderFunction=null,this.lb.notifyObservers(this),this.lb.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),this.onEffectErrorObservable.clear(),(0,T.f)()&&window.removeEventListener("resize",this._checkForMobile);const b=J.e.Instances.indexOf(this);b>=0&&J.e.Instances.splice(b,1),J.e.Instances.length||(J.e.OnEnginesDisposedObservable.notifyObservers(this),J.e.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(t){throw(0,r.b)("LoadingScreen")}static MarkAllMaterialsAsDirty(t,b){for(let Z=0;Z<J.e.Instances.length;Z++){const S=J.e.Instances[Z];for(let Z=0;Z<S.scenes.length;Z++)S.scenes[Z].markAllMaterialsAsDirty(t,b)}}}U._RenderPassIdCounter=0,U._RescalePostProcessFactory=null,U.CollisionsEpsilon=.001,U.QueueNewFrame=l},12585:(t,b,Z)=>{Z.d(b,{e:()=>S});var J=Z(12551);class S{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}S.Instances=[],S.OnEnginesDisposedObservable=new J.d,S._LastCreatedScene=null,S.UseFallbackTexture=!0,S.FallbackTexture=""},12658:(t,b,Z)=>{Z.d(b,{c:()=>J});class J{static SetMatrixPrecision(t){if(J.MatrixTrackPrecisionChange=!1,t&&!J.MatrixUse64Bits&&J.MatrixTrackedMatrices)for(let b=0;b<J.MatrixTrackedMatrices.length;++b){const t=J.MatrixTrackedMatrices[b],Z=t.cb;t.cb=new Array(16);for(let b=0;b<16;++b)t.cb[b]=Z[b]}J.MatrixUse64Bits=t,J.MatrixCurrentType=J.MatrixUse64Bits?Array:Float32Array,J.MatrixTrackedMatrices=null}}J.MatrixUse64Bits=!1,J.MatrixTrackPrecisionChange=!0,J.MatrixCurrentType=Float32Array,J.MatrixTrackedMatrices=[]},12674:(t,b,Z)=>{Z.d(b,{b:()=>v});var J=Z(12557);const S=new Map;function P(t,b){(function(t){return S.delete(t)})(t)&&J.c.Warn(`Extension with the name '${t}' already exists`),S.set(t,b)}function v(t,b){"image/ktx"!==b&&"image/ktx2"!==b||(t=".ktx"),S.has(t)||(t.endsWith(".ies")&&P(".ies",(async()=>await Z.e(15).then(Z.bind(Z,15160)).then((t=>new t._IESTextureLoader)))),t.endsWith(".dds")&&P(".dds",(async()=>await Promise.all([Z.e(14),Z.e(17),Z.e(13),Z.e(19),Z.e(18),Z.e(28)]).then(Z.bind(Z,15163)).then((t=>new t._DDSTextureLoader)))),t.endsWith(".basis")&&P(".basis",(async()=>await Promise.all([Z.e(14),Z.e(17),Z.e(13),Z.e(47)]).then(Z.bind(Z,15171)).then((t=>new t._BasisTextureLoader)))),t.endsWith(".env")&&P(".env",(async()=>await Promise.all([Z.e(14),Z.e(17),Z.e(13),Z.e(19),Z.e(18),Z.e(23),Z.e(21),Z.e(45),Z.e(48)]).then(Z.bind(Z,15175)).then((t=>new t._ENVTextureLoader)))),t.endsWith(".hdr")&&P(".hdr",(async()=>await Promise.all([Z.e(14),Z.e(49)]).then(Z.bind(Z,15184)).then((t=>new t._HDRTextureLoader)))),(t.endsWith(".ktx")||t.endsWith(".ktx2"))&&(P(".ktx",(async()=>await Z.e(30).then(Z.bind(Z,15188)).then((t=>new t._KTXTextureLoader)))),P(".ktx2",(async()=>await Z.e(30).then(Z.bind(Z,15188)).then((t=>new t._KTXTextureLoader))))),t.endsWith(".tga")&&P(".tga",(async()=>await Z.e(50).then(Z.bind(Z,15196)).then((t=>new t._TGATextureLoader)))),t.endsWith(".exr")&&P(".exr",(async()=>await Z.e(16).then(Z.bind(Z,15198)).then((t=>new t._ExrTextureLoader)))));const J=S.get(t);return J?Promise.resolve(J(b)):null}},12663:(t,b,Z)=>{Z.d(b,{d:()=>v});var J,S=Z(12551),P=Z(12665);!function(t){t[t.Unknown=0]="Unknown",t[t.Url=1]="Url",t[t.Temp=2]="Temp",t[t.Raw=3]="Raw",t[t.Dynamic=4]="Dynamic",t[t.RenderTarget=5]="RenderTarget",t[t.MultiRenderTarget=6]="MultiRenderTarget",t[t.Cube=7]="Cube",t[t.CubeRaw=8]="CubeRaw",t[t.CubePrefiltered=9]="CubePrefiltered",t[t.Raw3D=10]="Raw3D",t[t.Raw2DArray=11]="Raw2DArray",t[t.DepthStencil=12]="DepthStencil",t[t.CubeRawRGBD=13]="CubeRawRGBD",t[t.Depth=14]="Depth"}(J||(J={}));class v extends P.b{get useMipMaps(){return this.generateMipMaps}set useMipMaps(t){this.generateMipMaps=t}get uniqueId(){return this._uniqueId}_setUniqueId(t){this._uniqueId=t}getEngine(){return this._engine}get source(){return this._source}constructor(t,b){let Z=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new S.d,this.onErrorObservable=new S.d,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._autoMSAAManagement=!1,this._engine=t,this._source=b,this._uniqueId=v._Counter++,Z||(this._hardwareTexture=t._createHardwareTexture())}incrementReferences(){this._references++}updateSize(t,b){let Z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,t,b,Z),this.width=t,this.height=b,this.depth=Z,this.baseWidth=t,this.baseHeight=b,this.baseDepth=Z,this._size=t*b*Z}_rebuild(){if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const t=this.onRebuildCallback(this),b=b=>{b._swapAndDie(this,!1),this.isReady=t.isReady};return void(t.isAsync?t.proxy.then(b):b(t.proxy))}let t;switch(this.source){case 2:case 12:case 14:break;case 1:return void(t=this._engine.createTexture(this._originalUrl??this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(t=>{t._swapAndDie(this,!1),this.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:t=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),t._swapAndDie(this,!1),this.isReady=!0;break;case 10:t=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),t._swapAndDie(this,!1),this.isReady=!0;break;case 11:t=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),t._swapAndDie(this,!1),this.isReady=!0;break;case 4:t=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),t._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(t=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(()=>{t._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:t=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this._originalFormat??this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),t._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return t=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(t=>{t&&t._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension),void(t._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(t){var b;let Z=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===(b=this._hardwareTexture)||void 0===b||b.setUsage(t._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),t._hardwareTexture=this._hardwareTexture,Z&&(t._isRGBD=this._isRGBD),this._lodTextureHigh&&(t._lodTextureHigh&&t._lodTextureHigh.dispose(),t._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(t._lodTextureMid&&t._lodTextureMid.dispose(),t._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(t._lodTextureLow&&t._lodTextureLow.dispose(),t._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(t._irradianceTexture&&t._irradianceTexture.dispose(),t._irradianceTexture=this._irradianceTexture);const J=this._engine.getLoadedTexturesCache();let S=J.indexOf(this);-1!==S&&J.splice(S,1),S=J.indexOf(t),-1===S&&J.push(t)}dispose(){this._references--,0===this._references&&(this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}v._Counter=0},12665:(t,b,Z)=>{Z.d(b,{b:()=>J});class J{get wrapU(){return this._cachedWrapU}set wrapU(t){this._cachedWrapU=t}get wrapV(){return this._cachedWrapV}set wrapV(t){this._cachedWrapV=t}get wrapR(){return this._cachedWrapR}set wrapR(t){this._cachedWrapR=t}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(t){this._cachedAnisotropicFilteringLevel=t}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(t){this._comparisonFunction=t}get useMipMaps(){return this._useMipMaps}set useMipMaps(t){this._useMipMaps=t}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,Z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,P=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=t,this._cachedWrapV=b,this._cachedWrapR=Z,this._cachedAnisotropicFilteringLevel=J,this.samplingMode=S,this._comparisonFunction=P,this}compareSampler(t){return this._cachedWrapU===t._cachedWrapU&&this._cachedWrapV===t._cachedWrapV&&this._cachedWrapR===t._cachedWrapR&&this._cachedAnisotropicFilteringLevel===t._cachedAnisotropicFilteringLevel&&this.samplingMode===t.samplingMode&&this._comparisonFunction===t._comparisonFunction&&this._useMipMaps===t._useMipMaps}}},12565:(t,b,Z)=>{Z.d(b,{e:()=>P});var J=Z(12557);const S=(t,b,Z)=>t?t.getClassName&&"Mesh"===t.getClassName()?null:!t.getClassName||"SubMesh"!==t.getClassName()&&"PhysicsBody"!==t.getClassName()?t.clone?t.clone():Array.isArray(t)?t.slice():Z&&"object"===typeof t?{...t}:null:t.clone(b):null;class P{static DeepCopy(t,b,Z,P){let v=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const h=function(t){const b=[];do{const Z=Object.getOwnPropertyNames(t);for(const t of Z)-1===b.indexOf(t)&&b.push(t)}while(t=Object.getPrototypeOf(t));return b}(t);for(const Y of h){if("_"===Y[0]&&(!P||-1===P.indexOf(Y)))continue;if(Y.endsWith("Observable"))continue;if(Z&&-1!==Z.indexOf(Y))continue;const h=t[Y],g=typeof h;if("function"!==g)try{if("object"===g)if(h instanceof Uint8Array)b[Y]=Uint8Array.from(h);else if(h instanceof Array){if(b[Y]=[],h.length>0)if("object"==typeof h[0])for(let t=0;t<h.length;t++){const Z=S(h[t],b,v);-1===b[Y].indexOf(Z)&&b[Y].push(Z)}else b[Y]=h.slice(0)}else b[Y]=S(h,b,v);else b[Y]=h}catch(C){J.c.Warn(C.message)}}}}},12600:(t,b,Z)=>{Z.d(b,{c:()=>J,f:()=>S,g:()=>P});class J extends Error{}J._setPrototypeOf=Object.setPrototypeOf||((t,b)=>(t.__proto__=b,t));const S={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class P extends J{constructor(t,b,Z){super(t),this.errorCode=b,this.innerError=Z,this.name="RuntimeError",J._setPrototypeOf(this,P.prototype)}}},12593:(t,b,Z)=>{Z.d(b,{c:()=>n,g:()=>U,i:()=>e,l:()=>j,p:()=>O,n:()=>k,r:()=>H,u:()=>o,y:()=>p,A:()=>E});var J=Z(12577),S=Z(12555),P=Z(12551);class v{}v.FilesToLoad={};var h=Z(12600),C=Z(12608),Y=Z(12614),g=Z(12585),I=Z(12557),r=Z(12621),M=Z(12618),T=Z(12623);const a=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class k extends h.g{constructor(t,b){super(t,h.f.LoadFileError),this.name="LoadFileError",h.c._setPrototypeOf(this,k.prototype),b instanceof J.b?this.request=b:this.file=b}}class u extends h.g{constructor(t,b){super(t,h.f.RequestFileError),this.request=b,this.name="RequestFileError",h.c._setPrototypeOf(this,u.prototype)}}class l extends h.g{constructor(t,b){super(t,h.f.ReadFileError),this.file=b,this.name="ReadFileError",h.c._setPrototypeOf(this,l.prototype)}}const U={DefaultRetryStrategy:class{static ExponentialBackoff(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return(Z,J,S)=>0!==J.status||S>=t||-1!==Z.indexOf("file:")?-1:Math.pow(2,S)*b}}.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:t=>t,ScriptBaseUrl:"",ScriptPreprocessUrl:t=>t,CleanUrl:t=>t=t.replace(/#/gm,"%23")},E=(t,b)=>{if((!t||0!==t.indexOf("data:"))&&U.CorsBehavior)if("string"===typeof U.CorsBehavior||U.CorsBehavior instanceof String)b.crossOrigin=U.CorsBehavior;else{const Z=U.CorsBehavior(t);Z&&(b.crossOrigin=Z)}},c={getRequiredSize:null},H=function(t,b,Z,S){let P,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",Y=arguments.length>5?arguments[5]:void 0,I=arguments.length>6&&void 0!==arguments[6]?arguments[6]:g.e.LastCreatedEngine;if("undefined"===typeof HTMLImageElement&&(null===I||void 0===I||!I._features.forceBitmapOverHTMLImageElement))return Z("LoadImage is only supported in web or BabylonNative environments."),null;let r=!1;t instanceof ArrayBuffer||ArrayBuffer.isView(t)?"undefined"!==typeof Blob&&"undefined"!==typeof URL?(P=URL.createObjectURL(new Blob([t],{type:h})),r=!0):P=`data:${h};base64,`+(0,C.f)(t):t instanceof Blob?(P=URL.createObjectURL(t),r=!0):(P=U.CleanUrl(t),P=U.PreprocessUrl(P));const M=b=>{if(Z){const J=P||t.toString();Z(`Error while trying to load image: ${0===J.indexOf("http")||J.length<=128?J:J.slice(0,128)+"..."}`,b)}};if(null!==I&&void 0!==I&&I._features.forceBitmapOverHTMLImageElement)return O(P,(J=>{I.createImageBitmap(new Blob([J],{type:h}),{premultiplyAlpha:"none",...Y}).then((t=>{b(t),r&&URL.revokeObjectURL(P)})).catch((b=>{Z&&Z("Error while trying to load image: "+t,b)}))}),void 0,S||void 0,!0,((t,b)=>{M(b)})),null;const T=new Image;if(c.getRequiredSize){const b=c.getRequiredSize(t);b.width&&(T.width=b.width),b.height&&(T.height=b.height)}E(P,T);const a=[],k=()=>{for(const t of a)t.target.removeEventListener(t.name,t.handler);a.length=0};a.push({target:T,name:"load",handler:()=>{k(),b(T),r&&T.src&&URL.revokeObjectURL(T.src)}}),a.push({target:T,name:"error",handler:t=>{k(),M(t),r&&T.src&&URL.revokeObjectURL(T.src)}}),a.push({target:document,name:"securitypolicyviolation",handler:t=>{if(t.blockedURI!==T.src||"Hb"===t.disposition)return;k();const b=new Error(`CSP violation of policy ${t.effectiveDirective} ${t.blockedURI}. Current policy is ${t.originalPolicy}`);g.e.UseFallbackTexture=!1,M(b),r&&T.src&&URL.revokeObjectURL(T.src),T.src=""}}),(()=>{for(const t of a)t.target.addEventListener(t.name,t.handler)})();const u="blob:"===P.substring(0,5),l="data:"===P.substring(0,5),H=()=>{u||l||!J.b.IsCustomRequestAvailable?T.src=P:O(P,((t,b,Z)=>{const J=new Blob([t],{type:!h&&Z?Z:h}),S=URL.createObjectURL(J);r=!0,T.src=S}),void 0,S||void 0,!0,((t,b)=>{M(b)}))},o=()=>{S&&S.loadImage(P,T)};if(!u&&!l&&S&&S.enableTexturesOffline)S.open(o,H);else{if(-1!==P.indexOf("file:")){const t=decodeURIComponent(P.substring(5).toLowerCase());if(v.FilesToLoad[t]&&"undefined"!==typeof URL){try{let b;try{b=URL.createObjectURL(v.FilesToLoad[t])}catch(p){b=URL.createObjectURL(v.FilesToLoad[t])}T.src=b,r=!0}catch(e){T.src=""}return T}}H()}return T},o=(t,b,Z,J,S)=>{const v=new FileReader,h={onCompleteObservable:new P.d,abort:()=>v.abort()};return v.onloadend=()=>h.onCompleteObservable.notifyObservers(h),S&&(v.onerror=()=>{S(new l(`Unable to read ${t.name}`,t))}),v.onload=t=>{b(t.target.result)},Z&&(v.onprogress=Z),J?v.readAsArrayBuffer(t):v.readAsText(t),h},O=(t,b,Z,J,S,C,Y)=>{if(t.name)return o(t,b,Z,S,C?t=>{C(void 0,t)}:void 0);const g=t;if(-1!==g.indexOf("file:")){let t=decodeURIComponent(g.substring(5).toLowerCase());0===t.indexOf("./")&&(t=t.substring(2));const J=v.FilesToLoad[t];if(J)return o(J,b,Z,S,C?t=>C(void 0,new k(t.message,t.file)):void 0)}const{match:M,type:T}=V(g);if(M){const t={onCompleteObservable:new P.d,abort:()=>()=>{}};try{const t=S?n(g):y(g);b(t,void 0,T)}catch(h){C?C(void 0,h):I.c.Error(h.message||"Failed to parse the Data URL")}return r.c.SetImmediate((()=>{t.onCompleteObservable.notifyObservers(t)})),t}return p(g,((t,Z)=>{b(t,null===Z||void 0===Z?void 0:Z.responseURL,null===Z||void 0===Z?void 0:Z.getResponseHeader("content-type"))}),Z,J,S,C?t=>{C(t.request,new k(t.message,t.request))}:void 0,Y)},p=(t,b,Z,v,h,C,Y)=>{t=U.CleanUrl(t),t=U.PreprocessUrl(t);const g=U.BaseUrl+t;let r=!1;const M={onCompleteObservable:new P.d,abort:()=>r=!0},T=()=>{let t,P=new J.b,v=null;const T=()=>{P&&(Z&&P.removeEventListener("progress",Z),t&&P.removeEventListener("readystatechange",t),P.removeEventListener("loadend",a))};let a=()=>{T(),M.onCompleteObservable.notifyObservers(M),M.onCompleteObservable.clear(),Z=void 0,t=null,a=null,C=void 0,Y=void 0,b=void 0};M.abort=()=>{r=!0,a&&a(),P&&P.readyState!==(XMLHttpRequest.DONE||4)&&P.abort(),null!==v&&(clearTimeout(v),v=null),P=null};const k=t=>{const b=t.message||"Unknown error";C&&P?C(new u(b,P)):I.c.Error(b)},l=I=>{if(P){if(P.open("GET",g),Y)try{Y(P)}catch(M){return void k(M)}h&&(P.responseType="arraybuffer"),Z&&P.addEventListener("progress",Z),a&&P.addEventListener("loadend",a),t=()=>{if(!r&&P&&P.readyState===(XMLHttpRequest.DONE||4)){if(t&&P.removeEventListener("readystatechange",t),P.status>=200&&P.status<300||0===P.status&&(!(0,S.f)()||W())){const t=h?P.response:P.responseText;if(null!==t){try{b&&b(t,P)}catch(M){k(M)}return}}const Z=U.DefaultRetryStrategy;if(Z){const t=Z(g,P,I);if(-1!==t)return T(),P=new J.b,void(v=setTimeout((()=>l(I+1)),t))}const Y=new u("Error status: "+P.status+" "+P.statusText+" - Unable to load "+g,P);C&&C(Y)}},P.addEventListener("readystatechange",t),P.send()}};l(0)};if(v&&v.enableSceneOffline){const J=t=>{t&&t.status>400?C&&C(t):T()},S=()=>{v&&v.loadFile(U.BaseUrl+t,(t=>{!r&&b&&b(t),M.onCompleteObservable.notifyObservers(M)}),Z?t=>{!r&&Z&&Z(t)}:void 0,J,h)};v.open(S,J)}else T();return M},e=t=>{const{match:b,type:Z}=V(t);if(b)return Z||void 0;const J=t.lastIndexOf(".");switch(t.substring(J+1).toLowerCase()){case"glb":return"model/gltf-binary";case"bin":return"application/octet-stream";case"pb":return"model/gltf+json";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";default:return}},W=()=>"undefined"!==typeof location&&"file:"===location.protocol,j=t=>a.test(t),V=t=>{const b=a.exec(t);if(null===b||0===b.length)return{match:!1,type:""};return{match:!0,type:b[0].replace("data:","").replace("base64,","")}};function n(t){return(0,C.b)(t.split(",")[1])}const y=t=>(0,C.d)(t.split(",")[1]);let d;T.e._FileToolsLoadImage=H,M.e.loadFile=O,Y.o.loadFile=O;((t,b,Z,J,S,P,v,h,C,Y)=>{d={DecodeBase64UrlToBinary:t,DecodeBase64UrlToString:b,DefaultRetryStrategy:Z.DefaultRetryStrategy,BaseUrl:Z.BaseUrl,CorsBehavior:Z.CorsBehavior,PreprocessUrl:Z.PreprocessUrl,IsBase64DataUrl:J,IsFileURL:S,LoadFile:P,LoadImage:v,ReadFile:h,RequestFile:C,SetCorsBehavior:Y},Object.defineProperty(d,"DefaultRetryStrategy",{get:function(){return Z.DefaultRetryStrategy},set:function(t){Z.DefaultRetryStrategy=t}}),Object.defineProperty(d,"BaseUrl",{get:function(){return Z.BaseUrl},set:function(t){Z.BaseUrl=t}}),Object.defineProperty(d,"PreprocessUrl",{get:function(){return Z.PreprocessUrl},set:function(t){Z.PreprocessUrl=t}}),Object.defineProperty(d,"CorsBehavior",{get:function(){return Z.CorsBehavior},set:function(t){Z.CorsBehavior=t}})})(n,y,U,j,W,O,H,o,p,E)},12693:(t,b,Z)=>{function J(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const b=16*Math.random()|0;return("x"===t?b:3&b|8).toString(16)}))}Z.d(b,{c:()=>J})},12681:(t,b,Z)=>{Z.d(b,{d:()=>P});var J=Z(12557),S=Z(12688);class P{static Instantiate(t){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[t])return this.RegisteredExternalClasses[t];const b=(0,S.d)(t);if(b)return b;J.c.Warn(t+" not found, you may have missed an import.");const Z=t.split(".");let P=window||this;for(let J=0,S=Z.length;J<S;J++)P=P[Z[J]];return"function"!==typeof P?null:P}}P.RegisteredExternalClasses={}},12570:(t,b,Z)=>{Z.d(b,{e:()=>S});var J=Z(12555);class S{static get Now(){return(0,J.f)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},12608:(t,b,Z)=>{Z.d(b,{b:()=>v,d:()=>P,e:()=>J,f:()=>S});const J=t=>{if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);let b="";for(let Z=0;Z<t.byteLength;Z++)b+=String.fromCharCode(t[Z]);return b},S=t=>{const b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Z,J,S,P,v,h,C,Y="",g=0;const I=ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t);for(;g<I.length;)Z=I[g++],J=g<I.length?I[g++]:Number.NaN,S=g<I.length?I[g++]:Number.NaN,P=Z>>2,v=(3&Z)<<4|J>>4,h=(15&J)<<2|S>>6,C=63&S,isNaN(J)?h=C=64:isNaN(S)&&(C=64),Y+=b.charAt(P)+b.charAt(v)+b.charAt(h)+b.charAt(C);return Y},P=t=>atob(t),v=t=>{const b=P(t),Z=b.length,J=new Uint8Array(new ArrayBuffer(Z));for(let S=0;S<Z;S++)J[S]=b.charCodeAt(S);return J.buffer}},12702:(t,b,Z)=>{function J(t){let b=1;do{b*=2}while(b<t);return b===t}function S(t,b,Z){return t*(1-Z)+b*Z}function P(t){const b=v(t),Z=h(t);return b-t>t-Z?Z:b}function v(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function h(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)-(t>>1)}function C(t,b){let Z;switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:2){case 1:Z=h(t);break;case 2:Z=P(t);break;default:Z=v(t)}return Math.min(Z,b)}Z.d(b,{e:()=>h,h:()=>C,i:()=>J,j:()=>S,k:()=>P})},12549:(t,b,Z)=>{Z.r(b),Z.d(b,{AsyncLoop:()=>l,Tools:()=>k,className:()=>u});var J=Z(12551),S=Z(12555),P=Z(12557),v=Z(12565),h=Z(12570),C=Z(12573),Y=Z(12577),g=Z(12585),I=Z(12593),r=Z(12621),M=Z(12681),T=Z(12693),a=Z(12702);class k{static get BaseUrl(){return I.g.BaseUrl}static set BaseUrl(t){I.g.BaseUrl=t}static get CleanUrl(){return I.g.CleanUrl}static set CleanUrl(t){I.g.CleanUrl=t}static IsAbsoluteUrl(t){return 0===t.indexOf("//")||-1!==t.indexOf("://")&&(-1!==t.indexOf(".")&&(-1!==t.indexOf("/")&&(!(t.indexOf(":")>t.indexOf("/"))&&(t.indexOf("://")<t.indexOf(".")||(0===t.indexOf("data:")||0===t.indexOf("blob:"))))))}static set ScriptBaseUrl(t){I.g.ScriptBaseUrl=t}static get ScriptBaseUrl(){return I.g.ScriptBaseUrl}static set CDNBaseUrl(t){k.ScriptBaseUrl=t,k.AssetBaseUrl=t}static set ScriptPreprocessUrl(t){I.g.ScriptPreprocessUrl=t}static get ScriptPreprocessUrl(){return I.g.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return I.g.DefaultRetryStrategy}static set DefaultRetryStrategy(t){I.g.DefaultRetryStrategy=t}static get CorsBehavior(){return I.g.CorsBehavior}static set CorsBehavior(t){I.g.CorsBehavior=t}static get UseFallbackTexture(){return g.e.UseFallbackTexture}static set UseFallbackTexture(t){g.e.UseFallbackTexture=t}static get RegisteredExternalClasses(){return M.d.RegisteredExternalClasses}static set RegisteredExternalClasses(t){M.d.RegisteredExternalClasses=t}static get fallbackTexture(){return g.e.FallbackTexture}static set fallbackTexture(t){g.e.FallbackTexture=t}static FetchToRef(t,b,Z,J,S,P){const v=4*((Math.abs(t)*Z%Z|0)+(Math.abs(b)*J%J|0)*Z);P.r=S[v]/255,P.g=S[v+1]/255,P.b=S[v+2]/255,P.a=S[v+3]/255}static Mix(t,b,Z){return 0}static Instantiate(t){return M.d.Instantiate(t)}static SetImmediate(t){r.c.SetImmediate(t)}static IsExponentOfTwo(t){return!0}static FloatRound(t){return Math.fround(t)}static GetFilename(t){const b=t.lastIndexOf("/");return b<0?t:t.substring(b+1)}static GetFolderPath(t){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const Z=t.lastIndexOf("/");return Z<0?b?t:"":t.substring(0,Z+1)}static ToDegrees(t){return 180*t/Math.PI}static ToRadians(t){return t*Math.PI/180}static SmoothAngleChange(t,b){let Z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;const J=this.ToRadians(t),S=this.ToRadians(b);return this.ToDegrees(Math.atan2((1-Z)*Math.sin(S)+Z*Math.sin(J),(1-Z)*Math.cos(S)+Z*Math.cos(J)))}static MakeArray(t,b){return!0===b||void 0!==t&&null!=t?Array.isArray(t)?t:[t]:null}static GetPointerPrefix(t){return(0,S.f)()&&!window.PointerEvent?"mouse":"pointer"}static SetCorsBehavior(t,b){(0,I.A)(t,b)}static SetReferrerPolicyBehavior(t,b){b.referrerPolicy=t}static get PreprocessUrl(){return I.g.PreprocessUrl}static set PreprocessUrl(t){I.g.PreprocessUrl=t}static LoadImage(t,b,Z,J,S,P){return(0,I.r)(t,b,Z,J,S,P)}static LoadFile(t,b,Z,J,S,P){return(0,I.p)(t,b,Z,J,S,P)}static async LoadFileAsync(t){let b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return await new Promise(((Z,J)=>{(0,I.p)(t,(t=>{Z(t)}),void 0,void 0,b,((t,b)=>{J(b)}))}))}static GetAssetUrl(t){if(!t)return"";if(k.AssetBaseUrl&&t.startsWith(k._DefaultAssetsUrl)){const b="/"===k.AssetBaseUrl[k.AssetBaseUrl.length-1]?k.AssetBaseUrl.substring(0,k.AssetBaseUrl.length-1):k.AssetBaseUrl;return t.replace(k._DefaultAssetsUrl,b)}return t}static GetBabylonScriptURL(t,b){if(!t)return"";if(k.ScriptBaseUrl&&t.startsWith(k._DefaultCdnUrl)){const b="/"===k.ScriptBaseUrl[k.ScriptBaseUrl.length-1]?k.ScriptBaseUrl.substring(0,k.ScriptBaseUrl.length-1):k.ScriptBaseUrl;t=t.replace(k._DefaultCdnUrl,b)}return t=k.ScriptPreprocessUrl(t),b&&(t=k.GetAbsoluteUrl(t)),t}static LoadBabylonScript(t,b,Z,J){t=k.GetBabylonScriptURL(t),k.LoadScript(t,b,Z)}static async LoadBabylonScriptAsync(t){return t=k.GetBabylonScriptURL(t),await k.LoadScriptAsync(t)}static LoadScript(t,b,Z,J){let P=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("function"===typeof importScripts){try{importScripts(t),b&&b()}catch(C){null===Z||void 0===Z||Z(`Unable to load script '${t}' in worker`,C)}return}if(!(0,S.f)())return void(null===Z||void 0===Z||Z(`Cannot load script '${t}' outside of a window or a worker`));const v=document.getElementsByTagName("head")[0],h=document.createElement("script");P?(h.setAttribute("type","module"),h.innerText=t):(h.setAttribute("type","text/javascript"),h.setAttribute("src",t)),J&&(h.id=J),h.onload=()=>{b&&b()},h.onerror=b=>{Z&&Z(`Unable to load script '${t}'`,b)},v.appendChild(h)}static async LoadScriptAsync(t,b){return await new Promise(((Z,J)=>{this.LoadScript(t,(()=>{Z()}),((t,b)=>{J(b||new Error(t))}),b)}))}static ReadFileAsDataURL(t,b,Z){const S=new FileReader,P={onCompleteObservable:new J.d,abort:()=>S.abort()};return S.onloadend=()=>{P.onCompleteObservable.notifyObservers(P)},S.onload=t=>{b(t.target.result)},S.onprogress=Z,S.readAsDataURL(t),P}static ReadFile(t,b,Z,J,S){return(0,I.u)(t,b,Z,J,S)}static FileAsURL(t){const b=new Blob([t]);return window.URL.createObjectURL(b)}static Format(t){let b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return t.toFixed(b)}static DeepCopy(t,b,Z,J){v.e.DeepCopy(t,b,Z,J)}static IsEmpty(t){for(const b in t)if(Object.prototype.hasOwnProperty.call(t,b))return!1;return!0}static RegisterTopRootEvents(t,b){for(let J=0;J<b.length;J++){const S=b[J];t.addEventListener(S.name,S.handler,!1);try{window.parent&&window.parent.addEventListener(S.name,S.handler,!1)}catch(Z){}}}static UnregisterTopRootEvents(t,b){for(let J=0;J<b.length;J++){const S=b[J];t.removeEventListener(S.name,S.handler);try{t.parent&&t.parent.removeEventListener(S.name,S.handler)}catch(Z){}}}static async DumpFramebuffer(t,b,Z,J){throw(0,C.b)("DumpTools")}static DumpData(t,b,Z,J){throw(0,C.b)("DumpTools")}static async DumpDataAsync(t,b,Z){throw(0,C.b)("DumpTools")}static _IsOffScreenCanvas(t){return void 0!==t.convertToBlob}static ToBlob(t,b){let Z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",J=arguments.length>3?arguments[3]:void 0;k._IsOffScreenCanvas(t)||t.toBlob||(t.toBlob=function(t,b,Z){setTimeout((()=>{const J=atob(this.toDataURL(b,Z).split(",")[1]),S=J.length,P=new Uint8Array(S);for(let t=0;t<S;t++)P[t]=J.charCodeAt(t);t(new Blob([P]))}))}),k._IsOffScreenCanvas(t)?t.convertToBlob({type:Z,quality:J}).then((t=>b(t))):t.toBlob((function(t){b(t)}),Z,J)}static DownloadBlob(t,b){if("download"in document.createElement("a")){if(!b){const t=new Date;b="screenshot_"+((t.getFullYear()+"-"+(t.getMonth()+1)).slice(2)+"-"+t.getDate()+"_"+t.getHours()+"-"+("0"+t.getMinutes()).slice(-2))+".png"}k.Download(t,b)}else if(t&&"undefined"!==typeof URL){const b=URL.createObjectURL(t),Z=window.open("");if(!Z)return;const J=Z.document.createElement("img");J.onload=function(){URL.revokeObjectURL(b)},J.src=b,Z.document.body.appendChild(J)}}static EncodeScreenshotCanvasData(t,b){let Z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",J=arguments.length>3?arguments[3]:void 0,S=arguments.length>4?arguments[4]:void 0;if("string"!==typeof J&&b){if(b){if(k._IsOffScreenCanvas(t))return void t.convertToBlob({type:Z,quality:S}).then((t=>{const Z=new FileReader;Z.readAsDataURL(t),Z.onloadend=()=>{const t=Z.result;b(t)}}));const J=t.toDataURL(Z,S);b(J)}}else this.ToBlob(t,(function(t){t&&k.DownloadBlob(t,J),b&&b("")}),Z,S)}static Download(t,b){if("undefined"===typeof URL)return;const Z=window.URL.createObjectURL(t),J=document.createElement("a");document.body.appendChild(J),J.style.display="none",J.href=Z,J.download=b,J.addEventListener("click",(()=>{J.parentElement&&J.parentElement.removeChild(J)})),J.click(),window.URL.revokeObjectURL(Z)}static BackCompatCameraNoPreventDefault(t){return"boolean"===typeof t[0]?t[0]:"boolean"===typeof t[1]&&t[1]}static CreateScreenshot(t,b,Z,J){throw(0,C.b)("ScreenshotTools")}static async CreateScreenshotAsync(t,b,Z){throw(0,C.b)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(t,b,Z,J){throw(0,C.b)("ScreenshotTools")}static async CreateScreenshotUsingRenderTargetAsync(t,b,Z){throw(0,C.b)("ScreenshotTools")}static RandomId(){return(0,T.c)()}static IsBase64(t){return(0,I.l)(t)}static DecodeBase64(t){return(0,I.c)(t)}static get errorsCount(){return P.c.errorsCount}static Log(t){P.c.Log(t)}static Warn(t){P.c.Warn(t)}static Error(t){P.c.Error(t)}static get LogCache(){return P.c.LogCache}static ClearLogCache(){P.c.ClearLogCache()}static set LogLevels(t){P.c.LogLevels=t}static set PerformanceLogLevel(t){return(t&k.PerformanceUserMarkLogLevel)===k.PerformanceUserMarkLogLevel?(k.StartPerformanceCounter=k._StartUserMark,void(k.EndPerformanceCounter=k._EndUserMark)):(t&k.PerformanceConsoleLogLevel)===k.PerformanceConsoleLogLevel?(k.StartPerformanceCounter=k._StartPerformanceConsole,void(k.EndPerformanceCounter=k._EndPerformanceConsole)):(k.StartPerformanceCounter=k._StartPerformanceCounterDisabled,void(k.EndPerformanceCounter=k._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(t,b){}static _EndPerformanceCounterDisabled(t,b){}static _StartUserMark(t){let b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!k._Performance){if(!(0,S.f)())return;k._Performance=window.performance}b&&k._Performance.mark&&k._Performance.mark(t+"-Begin")}static _EndUserMark(t){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&k._Performance.mark&&(k._Performance.mark(t+"-End"),k._Performance.measure(t,t+"-Begin",t+"-End"))}static _StartPerformanceConsole(t){let b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];b&&(k._StartUserMark(t,b),console.time&&console.time(t))}static _EndPerformanceConsole(t){let b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];b&&(k._EndUserMark(t,b),console.timeEnd(t))}static get Now(){return h.e.Now}static GetClassName(t){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=null;if(!b&&t.getClassName)Z=t.getClassName();else{if(t instanceof Object){Z=(b?t:Object.getPrototypeOf(t)).constructor.__bjsclassName__}Z||(Z=typeof t)}return Z}static First(t,b){for(const Z of t)if(b(Z))return Z;return null}static getFullClassName(t){let b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Z=null,J=null;if(!b&&t.getClassName)Z=t.getClassName();else{if(t instanceof Object){const S=b?t:Object.getPrototypeOf(t);Z=S.constructor.__bjsclassName__,J=S.constructor.__bjsmoduleName__}Z||(Z=typeof t)}return Z?(null!=J?J+".":"")+Z:null}static async DelayAsync(t){await new Promise((b=>{setTimeout((()=>{b()}),t)}))}static IsSafari(){return!!(0,S.e)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function u(t,b){return Z=>{Z.__bjsclassName__=t,Z.__bjsmoduleName__=null!=b?b:null}}k.AssetBaseUrl="",k.UseCustomRequestHeaders=!1,k.CustomRequestHeaders=Y.b.CustomRequestHeaders,k.GetDOMTextContent=S.c,k._DefaultCdnUrl="https://cdn.babylonjs.com",k._DefaultAssetsUrl="https://assets.babylonjs.com/core",k.GetAbsoluteUrl="object"===typeof document?t=>{const b=document.createElement("a");return b.href=t,b.href}:"function"===typeof URL&&"object"===typeof location?t=>new URL(t,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},k.NoneLogLevel=P.c.NoneLogLevel,k.MessageLogLevel=P.c.MessageLogLevel,k.WarningLogLevel=P.c.WarningLogLevel,k.ErrorLogLevel=P.c.ErrorLogLevel,k.AllLogLevel=P.c.AllLogLevel,k.IsWindowObjectExist=S.f,k.PerformanceNoneLogLevel=0,k.PerformanceUserMarkLogLevel=1,k.PerformanceConsoleLogLevel=2,k.StartPerformanceCounter=k._StartPerformanceCounterDisabled,k.EndPerformanceCounter=k._EndPerformanceCounterDisabled;class l{constructor(t,b,Z){let J=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.iterations=t,this.index=J-1,this._done=!1,this._fn=b,this._successCallback=Z}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(t,b,Z){const J=new l(t,b,Z,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0);return J.executeNext(),J}static SyncAsyncForLoop(t,b,Z,J,S){let P=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return l.Run(Math.ceil(t/b),(J=>{S&&S()?J.breakLoop():setTimeout((()=>{for(let P=0;P<b;++P){const v=J.index*b+P;if(v>=t)break;if(Z(v),S&&S()){J.breakLoop();break}}J.executeNext()}),P)}),J)}}k.Mix=a.j,k.IsExponentOfTwo=a.i,g.e.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},12688:(t,b,Z)=>{Z.d(b,{d:()=>P,f:()=>S});const J={};function S(t,b){J[t]=b}function P(t){return J[t]}},12577:(t,b,Z)=>{Z.d(b,{b:()=>J});class J{constructor(){this._xhr="undefined"!==typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(J.CustomRequestHeaders).length>0||J.CustomRequestModifiers.length>0}get requestURL(){return this._requestURL}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const t in J.CustomRequestHeaders){const b=J.CustomRequestHeaders[t];b&&this._xhr.setRequestHeader(t,b)}}_shouldSkipRequestModifications(t){return J.SkipRequestModificationForBabylonCDN&&(t.includes("preview.babylonjs.com")||t.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(t){this._xhr.onprogress=t}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(t){this._xhr.responseType=t}get timeout(){return this._xhr.timeout}set timeout(t){this._xhr.timeout=t}addEventListener(t,b,Z){this._xhr.addEventListener(t,b,Z)}removeEventListener(t,b,Z){this._xhr.removeEventListener(t,b,Z)}abort(){this._xhr.abort()}send(t){J.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)}open(t,b){for(const Z of J.CustomRequestModifiers){if(this._shouldSkipRequestModifications(b))return;b=Z(this._xhr,b)||b}b=(b=b.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=b,this._xhr.open(t,b,!0)}setRequestHeader(t,b){this._xhr.setRequestHeader(t,b)}getResponseHeader(t){return this._xhr.getResponseHeader(t)}}J.CustomRequestHeaders={},J.CustomRequestModifiers=new Array,J.SkipRequestModificationForBabylonCDN=!0}}]);