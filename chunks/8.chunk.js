"use strict";(self.u4k1rqylno=self.u4k1rqylno||[]).push([[8],{11618:(e,E,H)=>{H.d(E,{c:()=>a});var N=H(11579),u=H(11548),z=H(11627),P=H(11651),M=H(11559);class D{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}class A{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}reset(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(e){var E;if(!e)return;const H=!this.useStencilGlobalOnly&&!(null===(E=this.stencilMaterial)||void 0===E||!E.enabled);this.enabled=H?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=H?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=H?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=H?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=H?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=H?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=H?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=H?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}class C{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=C.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=C.KEEP,this.opDepthFail=C.KEEP,this.opStencilDepthPass=C.REPLACE}get stencilFunc(){return this.func}set stencilFunc(e){this.func=e}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(e){this.funcRef=e}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(e){this.funcMask=e}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(e){this.opStencilFail=e}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(e){this.opDepthFail=e}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(e){this.opStencilDepthPass=e}get stencilMask(){return this.mask}set stencilMask(e){this.mask=e}get stencilTest(){return this.enabled}set stencilTest(e){this.enabled=e}}C.ALWAYS=519,C.KEEP=7680,C.REPLACE=7681;class i{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(e,E,H,N){this._blendConstants[0]===e&&this._blendConstants[1]===E&&this._blendConstants[2]===H&&this._blendConstants[3]===N||(this._blendConstants[0]=e,this._blendConstants[1]=E,this._blendConstants[2]=H,this._blendConstants[3]=N,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(e,E,H,N){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===E&&this._blendFunctionParameters[2]===H&&this._blendFunctionParameters[3]===N||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=E,this._blendFunctionParameters[2]=H,this._blendFunctionParameters[3]=N,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(e,E){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===E||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=E,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}var V=H(11565),U=H(11660),j=H(11546),F=H(11541),h=H(11602),S=H(11674);function X(e,E){if((0,j.i)()){const{requestAnimationFrame:H}=E||window;if("function"===typeof H)return H(e)}else if("function"===typeof requestAnimationFrame)return requestAnimationFrame(e);return setTimeout(e,16)}class a{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(e){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get IP(){return this._useReverseDepthBuffer}set IP(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?518:515)}setColorWrite(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,this.IP?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?e.USE_EXACT_SRGB_CONVERSIONS="":delete e.USE_EXACT_SRGB_CONVERSIONS);{let e="";return this.isNDCHalfZRange&&(e+="#define IS_NDC_HALF_ZRANGE"),this.IP&&(e&&(e+="\n"),e+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(e&&(e+="\n"),e+="#define USE_EXACT_SRGB_CONVERSIONS"),e}}_rebuildInternalTextures(){const e=this._internalTexturesCache.slice();for(const E of e)E._rebuild()}_rebuildRenderTargetWrappers(){const e=this._renderTargetWrapperCache.slice();for(const E of e)E._rebuild()}_rebuildEffects(){for(const e in this._compiledEffects){const E=this._compiledEffects[e];E._pipelineContext=null,E._prepareEffect()}z.Effect.ResetCache()}_rebuildGraphicsResources(){var e;this.wipeCaches(!0),this._rebuildEffects(),null===(e=this._rebuildComputeEffects)||void 0===e||e.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){u.d.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(e){setTimeout((()=>{this._clearEmptyResources();const E=this._depthCullingState.depthTest,H=this._depthCullingState.depthFunc,N=this._depthCullingState.depthMask,u=this._stencilState.stencilTest;e(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=E,this._depthCullingState.depthFunc=H,this._depthCullingState.depthMask=N,this._stencilState.stencilTest=u,this._flagContextRestored()}),0)}get A(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(e){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(e){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const e=new Uint8Array(4),E=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(E,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(e){if(!e)return this._activeRenderLoops.length=0,void this._cancelFrame();const E=this._activeRenderLoops.indexOf(e);E>=0&&(this._activeRenderLoops.splice(E,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){const e=this._frameHandler;if(this._frameHandler=0,(0,j.i)()){const{cancelAnimationFrame:E}=this.getHostWindow()||window;if("function"===typeof E)return E(e)}else if("function"===typeof cancelAnimationFrame)return cancelAnimationFrame(e);return clearTimeout(e)}}tP(){this.onBeginFrameObservable.notifyObservers(this)}qP(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}get maxFPS(){return this._maxFPS}set maxFPS(e){this._maxFPS=e,void 0!==e&&(this._minFrameTime=e<=0?Number.MAX_VALUE:1e3/e)}_isOverFrameTime(e){if(!e||void 0===this._maxFPS)return!1;const E=e-this._lastFrameTime;return this._lastFrameTime=e,this._renderAccumulator+=E,this._renderAccumulator<this._minFrameTime||(this._renderAccumulator-=this._minFrameTime,this._renderAccumulator>this._minFrameTime&&(this._renderAccumulator=this._minFrameTime),!1)}_processFrame(e){if(this._frameHandler=0,!this._contextWasLost&&!this._isOverFrameTime(e)){let e=!0;(this.A||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.tP(),this.skipFrameRender||this._renderViews()||this._renderFrame(),this.qP())}}_renderLoop(e){this._processFrame(e),this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}}_renderViews(){return!1}_queueNewFrame(e,E){return X(e,E)}runRenderLoop(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(e){this._depthCullingState.depthTest=e}setZOffset(e){this._depthCullingState.zOffset=this.IP?-e:e}getZOffset(){const e=this._depthCullingState.zOffset;return this.IP?-e:e}setZOffsetUnits(e){this._depthCullingState.zOffsetUnits=this.IP?-e:e}getZOffsetUnits(){const e=this._depthCullingState.zOffsetUnits;return this.IP?-e:e}getHostWindow(){return(0,j.i)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(e){this._compatibilityMode=!0}_rebuildTextures(){for(const e of this.scenes)e._rebuildTextures();for(const e of this._virtualScenes)e._rebuildTextures()}_releaseRenderTargetWrapper(e){const E=this._renderTargetWrapperCache.indexOf(e);-1!==E&&this._renderTargetWrapperCache.splice(E,1)}get currentViewport(){return this._cachedViewport}setViewport(e,E,H){const N=E||this.getRenderWidth(),u=H||this.getRenderHeight(),z=e.x||0,P=e.y||0;this._cachedViewport=e,this._viewport(z*N,P*u,N*e.width,u*e.height)}createCanvasImage(){return document.createElement("img")}createCanvasPath2D(e){return new Path2D(e)}get description(){let e=this.name+this.version;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e}_createTextureBase(e,E,H,z){let P=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,M=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,D=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,A=arguments.length>7?arguments[7]:void 0,C=arguments.length>8?arguments[8]:void 0,i=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,V=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,j=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,F=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,h=arguments.length>13?arguments[13]:void 0,X=arguments.length>14?arguments[14]:void 0,W=arguments.length>15?arguments[15]:void 0;const r="data:"===(e=e||"").substring(0,5),Y="blob:"===e.substring(0,5),f=r&&-1!==e.indexOf(";base64,"),w=V||new U.e(this,1);w!==V&&(w.label=e.substring(0,60));const s=e;!this._transformTextureUrl||f||V||i||(e=this._transformTextureUrl(e)),s!==e&&(w._originalUrl=s);const p=e.lastIndexOf(".");let o=F||(p>-1?e.substring(p).toLowerCase():"");o.indexOf("?")>-1&&(o=o.split("?")[0]);const y=(0,S.c)(o,h);z&&z.addPendingData(w),w.url=e,w.generateMipMaps=!E,w.samplingMode=P,w.invertY=H,w._useSRGBBuffer=this._getUseSRGBBuffer(!!W,E),this._doNotHandleContextLost||(w._buffer=i);let b=null;M&&!V&&(b=w.onLoadedObservable.add(M)),V||this._internalTexturesCache.push(w);const K=(H,V)=>{z&&z.removePendingData(w),e===s?(b&&w.onLoadedObservable.remove(b),N.d.UseFallbackTexture&&e!==N.d.FallbackTexture&&this._createTextureBase(N.d.FallbackTexture,E,w.invertY,z,P,null,D,A,C,i,w),H=(H||"Unknown error")+(N.d.UseFallbackTexture?" - Fallback texture was used":""),w.onErrorObservable.notifyObservers({message:H,exception:V}),D&&D(H,V)):(u.d.Warn(`Failed to load ${e}, falling back to ${s}`),this._createTextureBase(s,E,w.invertY,z,P,M,D,A,C,i,w,j,F,h,X,W))};if(y){const E=async e=>{(await y).loadData(e,w,((e,E,H,N,u,M)=>{M?K("TextureLoader failed to load data"):A(w,o,z,{width:e,height:E},w.invertY,!H,N,(()=>(u(),!1)),P)}),X)};i?i instanceof ArrayBuffer?E(new Uint8Array(i)):ArrayBuffer.isView(i)?E(i):D&&D("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,(e=>{E(new Uint8Array(e))}),void 0,z?z.offlineProvider:void 0,!0,((e,E)=>{K("Unable to load "+(e&&e.responseURL,E))}))}else{const H=e=>{Y&&!this._doNotHandleContextLost&&(w._buffer=e),A(w,o,z,e,w.invertY,E,!1,C,P)};!r||f?i&&("string"===typeof i.decoding||i.close)?H(i):a._FileToolsLoadImage(e||"",H,K,z?z.offlineProvider:null,h,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):"string"===typeof i||i instanceof ArrayBuffer||ArrayBuffer.isView(i)||i instanceof Blob?a._FileToolsLoadImage(i,H,K,z?z.offlineProvider:null,h,w.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):i&&H(i)}return w}_rebuildBuffers(){for(const e of this._uniformBuffers)e._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,j.d)()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(const e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(e){this._name=e}static get NpmPackage(){return"babylonjs@8.13.0"}static get Version(){return"8.13.0"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(e){this._hardwareScalingLevel=e,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(e){this._doNotHandleContextLost=e}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}constructor(e,E,H){var u,z;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new D,this._stencilStateComposer=new A,this._stencilState=new C,this._alphaState=new i,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new F.d,this.onCanvasFocusObservable=new F.d,this.onNewSceneAddedObservable=new F.d,this.onResizeObservable=new F.d,this.onCanvasPointerOutObservable=new F.d,this.onEffectErrorObservable=new F.d,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new F.d,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=e=>this._renderLoop(e),this._lastFrameTime=0,this._renderAccumulator=0,this.skipFrameRender=!1,this.onBeforeShaderCompilationObservable=new F.d,this.onAfterShaderCompilationObservable=new F.d,this.onBeginFrameObservable=new F.d,this.onEndFrameObservable=new F.d,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new F.d,this.onContextRestoredObservable=new F.d,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.cP=new F.d,this.onReleaseEffectsObservable=new F.d,N.d.Instances.push(this),this.startTime=M.d.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,P.e.SetMatrixPrecision(!!E.useHighPrecisionMatrix),(0,j.e)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=H??!1,E.antialias=e??E.antialias,E.deterministicLockstep=E.deterministicLockstep??!1,E.lockstepMaxSteps=E.lockstepMaxSteps??4,E.timeStep=E.timeStep??1/60,E.nP=E.nP??!0,this._audioContext=(null===(u=E.audioEngineOptions)||void 0===u?void 0:u.audioContext)??null,this._audioDestination=(null===(z=E.audioEngineOptions)||void 0===z?void 0:z.audioDestination)??null,this.premultipliedAlpha=E.premultipliedAlpha??!0,this._doNotHandleContextLost=!!E.doNotHandleContextLost,this._isStencilEnable=!!E.nP,this.useExactSrgbConversions=E.useExactSrgbConversions??!1;const V=(0,j.i)()&&window.devicePixelRatio||1,U=E.limitDeviceRatio||V;H=H||E.adaptToDeviceRatio||!1,this._hardwareScalingLevel=H?1/Math.min(U,V):1,this._lastDevicePixelRatio=V,this._creationOptions=E}resize(){let e,E,H=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.adaptToDeviceRatio){const e=(0,j.i)()&&window.devicePixelRatio||1,E=this._lastDevicePixelRatio/e;this._lastDevicePixelRatio=e,this._hardwareScalingLevel*=E}if((0,j.i)()&&(0,j.d)())if(this._renderingCanvas){var N,u;const H=null===(N=(u=this._renderingCanvas).getBoundingClientRect)||void 0===N?void 0:N.call(u);e=this._renderingCanvas.clientWidth||(null===H||void 0===H?void 0:H.width)||this._renderingCanvas.width*this._hardwareScalingLevel||100,E=this._renderingCanvas.clientHeight||(null===H||void 0===H?void 0:H.height)||this._renderingCanvas.height*this._hardwareScalingLevel||100}else e=window.innerWidth,E=window.innerHeight;else e=this._renderingCanvas?this._renderingCanvas.width:100,E=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(e/this._hardwareScalingLevel,E/this._hardwareScalingLevel,H)}setSize(e,E){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(e|=0,E|=0,!H&&this._renderingCanvas.width===e&&this._renderingCanvas.height===E)return!1;if(this._renderingCanvas.width=e,this._renderingCanvas.height=E,this.scenes){for(let e=0;e<this.scenes.length;e++){const E=this.scenes[e];for(let e=0;e<E.cameras.length;e++){E.cameras[e]._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(e,E,H,N,u,z,P,M,D,A,C){throw(0,V.b)("engine.rawTexture")}createRawCubeTexture(e,E,H,N,u,z,P,M){throw(0,V.b)("engine.rawTexture")}createRawTexture3D(e,E,H,N,u,z,P,M,D,A,C){throw(0,V.b)("engine.rawTexture")}createRawTexture2DArray(e,E,H,N,u,z,P,M,D,A,C){throw(0,V.b)("engine.rawTexture")}_sharedInit(e){this._renderingCanvas=e}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const e=navigator.userAgent;this.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&(0,j.d)()&&"ontouchend"in document},this._checkForMobile(),(0,j.i)()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(e){return document.createElement("video")}_reportDrawCall(){var e;let E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;null===(e=this._drawCalls)||void 0===e||e.addCount(E,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(e,E){throw new Error("createImageBitmapFromSource is not implemented")}createImageBitmap(e,E){return createImageBitmap(e,E)}resizeImageBitmap(e,E,H){throw new Error("resizeImageBitmap is not implemented")}getFontOffset(e){throw new Error("getFontOffset is not implemented")}static _CreateCanvas(e,E){if("undefined"===typeof document)return new OffscreenCanvas(e,E);const H=document.createElement("canvas");return H.width=e,H.height=E,H}createCanvas(e,E){return a._CreateCanvas(e,E)}static _FileToolsLoadImage(e,E,H,N,u,z,P){throw(0,V.b)("FileTools")}_loadFile(e,E,H,N,u,z){const P=(0,h.j)(e,E,H,N,u,z);return this._activeRequests.push(P),P.onCompleteObservable.add((()=>{const e=this._activeRequests.indexOf(P);-1!==e&&this._activeRequests.splice(e,1)})),P}static _FileToolsLoadFile(e,E,H,N,u,z){if(h.b.loadFile)return h.b.loadFile(e,E,H,N,u,z);throw(0,V.b)("FileTools")}dispose(){var e;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),z.Effect.ResetCache();for(const H of this._activeRequests)H.abort();this._boundRenderFunction=null,this.cP.notifyObservers(this),this.cP.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),this.onEffectErrorObservable.clear(),(0,j.i)()&&window.removeEventListener("resize",this._checkForMobile);const E=N.d.Instances.indexOf(this);E>=0&&N.d.Instances.splice(E,1),N.d.Instances.length||(N.d.OnEnginesDisposedObservable.notifyObservers(this),N.d.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(e){throw(0,V.b)("LoadingScreen")}static MarkAllMaterialsAsDirty(e,E){for(let H=0;H<N.d.Instances.length;H++){const u=N.d.Instances[H];for(let H=0;H<u.scenes.length;H++)u.scenes[H].markAllMaterialsAsDirty(e,E)}}}a._RenderPassIdCounter=0,a._RescalePostProcessFactory=null,a.CollisionsEpsilon=.001,a.QueueNewFrame=X},11579:(e,E,H)=>{H.d(E,{d:()=>u});var N=H(11541);class u{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}u.Instances=[],u.OnEnginesDisposedObservable=new N.d,u._LastCreatedScene=null,u.UseFallbackTexture=!0,u.FallbackTexture=""},11651:(e,E,H)=>{H.d(E,{e:()=>N});class N{static SetMatrixPrecision(e){if(N.MatrixTrackPrecisionChange=!1,e&&!N.MatrixUse64Bits&&N.MatrixTrackedMatrices)for(let E=0;E<N.MatrixTrackedMatrices.length;++E){const e=N.MatrixTrackedMatrices[E],H=e.gP;e.gP=new Array(16);for(let E=0;E<16;++E)e.gP[E]=H[E]}N.MatrixUse64Bits=e,N.MatrixCurrentType=N.MatrixUse64Bits?Array:Float32Array,N.MatrixTrackedMatrices=null}}N.MatrixUse64Bits=!1,N.MatrixTrackPrecisionChange=!0,N.MatrixCurrentType=Float32Array,N.MatrixTrackedMatrices=[]},11674:(e,E,H)=>{H.d(E,{c:()=>P});var N=H(11548);const u=new Map;function z(e,E){(function(e){return u.delete(e)})(e)&&N.d.Warn(`Extension with the name '${e}' already exists`),u.set(e,E)}function P(e,E){"image/ktx"!==E&&"image/ktx2"!==E||(e=".ktx"),u.has(e)||(e.endsWith(".ies")&&z(".ies",(async()=>await H.e(15).then(H.bind(H,14123)).then((e=>new e._IESTextureLoader)))),e.endsWith(".dds")&&z(".dds",(async()=>await Promise.all([H.e(14),H.e(17),H.e(13),H.e(19),H.e(18),H.e(28)]).then(H.bind(H,14126)).then((e=>new e._DDSTextureLoader)))),e.endsWith(".basis")&&z(".basis",(async()=>await Promise.all([H.e(14),H.e(17),H.e(13),H.e(47)]).then(H.bind(H,14137)).then((e=>new e._BasisTextureLoader)))),e.endsWith(".env")&&z(".env",(async()=>await Promise.all([H.e(14),H.e(17),H.e(13),H.e(19),H.e(18),H.e(23),H.e(21),H.e(45),H.e(48)]).then(H.bind(H,14140)).then((e=>new e._ENVTextureLoader)))),e.endsWith(".hdr")&&z(".hdr",(async()=>await Promise.all([H.e(14),H.e(49)]).then(H.bind(H,14144)).then((e=>new e._HDRTextureLoader)))),(e.endsWith(".ktx")||e.endsWith(".ktx2"))&&(z(".ktx",(async()=>await H.e(30).then(H.bind(H,14151)).then((e=>new e._KTXTextureLoader)))),z(".ktx2",(async()=>await H.e(30).then(H.bind(H,14151)).then((e=>new e._KTXTextureLoader))))),e.endsWith(".tga")&&z(".tga",(async()=>await H.e(50).then(H.bind(H,14155)).then((e=>new e._TGATextureLoader)))),e.endsWith(".exr")&&z(".exr",(async()=>await H.e(16).then(H.bind(H,14160)).then((e=>new e._ExrTextureLoader)))));const N=u.get(e);return N?Promise.resolve(N(E)):null}},11660:(e,E,H)=>{H.d(E,{e:()=>P});var N,u=H(11541),z=H(11669);!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(N||(N={}));class P extends z.b{get useMipMaps(){return this.generateMipMaps}set useMipMaps(e){this.generateMipMaps=e}get uniqueId(){return this._uniqueId}_setUniqueId(e){this._uniqueId=e}getEngine(){return this._engine}get source(){return this._source}constructor(e,E){let H=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new u.d,this.onErrorObservable=new u.d,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._autoMSAAManagement=!1,this._engine=e,this._source=E,this._uniqueId=P._Counter++,H||(this._hardwareTexture=e._createHardwareTexture())}incrementReferences(){this._references++}updateSize(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,e,E,H),this.width=e,this.height=E,this.depth=H,this.baseWidth=e,this.baseHeight=E,this.baseDepth=H,this._size=e*E*H}_rebuild(){if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const e=this.onRebuildCallback(this),E=E=>{E._swapAndDie(this,!1),this.isReady=e.isReady};return void(e.isAsync?e.proxy.then(E):E(e.proxy))}let e;switch(this.source){case 2:case 12:case 14:break;case 1:return void(e=this._engine.createTexture(this._originalUrl??this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(e=>{e._swapAndDie(this,!1),this.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:e=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),e._swapAndDie(this,!1),this.isReady=!0;break;case 10:e=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case 11:e=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),e._swapAndDie(this,!1),this.isReady=!0;break;case 4:e=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),e._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(e=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(()=>{e._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:e=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this._originalFormat??this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),e._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return e=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(e=>{e&&e._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension),void(e._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(e){var E;let H=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===(E=this._hardwareTexture)||void 0===E||E.setUsage(e._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),e._hardwareTexture=this._hardwareTexture,H&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);const N=this._engine.getLoadedTexturesCache();let u=N.indexOf(this);-1!==u&&N.splice(u,1),u=N.indexOf(e),-1===u&&N.push(e)}dispose(){this._references--,0===this._references&&(this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}P._Counter=0},11669:(e,E,H)=>{H.d(E,{b:()=>N});class N{get wrapU(){return this._cachedWrapU}set wrapU(e){this._cachedWrapU=e}get wrapV(){return this._cachedWrapV}set wrapV(e){this._cachedWrapV=e}get wrapR(){return this._cachedWrapR}set wrapR(e){this._cachedWrapR=e}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(e){this._cachedAnisotropicFilteringLevel=e}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(e){this._comparisonFunction=e}get useMipMaps(){return this._useMipMaps}set useMipMaps(e){this._useMipMaps=e}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=e,this._cachedWrapV=E,this._cachedWrapR=H,this._cachedAnisotropicFilteringLevel=N,this.samplingMode=u,this._comparisonFunction=z,this}compareSampler(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}},11552:(e,E,H)=>{H.d(E,{e:()=>z});var N=H(11548);const u=(e,E,H)=>e?e.getClassName&&"Mesh"===e.getClassName()?null:!e.getClassName||"SubMesh"!==e.getClassName()&&"PhysicsBody"!==e.getClassName()?e.clone?e.clone():Array.isArray(e)?e.slice():H&&"object"===typeof e?{...e}:null:e.clone(E):null;class z{static DeepCopy(e,E,H,z){let P=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const M=function(e){const E=[];do{const H=Object.getOwnPropertyNames(e);for(const e of H)-1===E.indexOf(e)&&E.push(e)}while(e=Object.getPrototypeOf(e));return E}(e);for(const A of M){if("_"===A[0]&&(!z||-1===z.indexOf(A)))continue;if(A.endsWith("Observable"))continue;if(H&&-1!==H.indexOf(A))continue;const M=e[A],C=typeof M;if("function"!==C)try{if("object"===C)if(M instanceof Uint8Array)E[A]=Uint8Array.from(M);else if(M instanceof Array){if(E[A]=[],M.length>0)if("object"==typeof M[0])for(let e=0;e<M.length;e++){const H=u(M[e],E,P);-1===E[A].indexOf(H)&&E[A].push(H)}else E[A]=M.slice(0)}else E[A]=u(M,E,P);else E[A]=M}catch(D){N.d.Warn(D.message)}}}}},11593:(e,E,H)=>{H.d(E,{e:()=>N,h:()=>u,j:()=>z});class N extends Error{}N._setPrototypeOf=Object.setPrototypeOf||((e,E)=>(e.__proto__=E,e));const u={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class z extends N{constructor(e,E,H){super(e),this.errorCode=E,this.innerError=H,this.name="RuntimeError",N._setPrototypeOf(this,z.prototype)}}},11587:(e,E,H)=>{H.d(E,{e:()=>K,i:()=>a,l:()=>p,n:()=>y,s:()=>w,q:()=>h,w:()=>Y,z:()=>f,A:()=>s,E:()=>W});var N=H(11571),u=H(11546),z=H(11541);class P{}P.FilesToLoad={};var M=H(11593),D=H(11598),A=H(11600),C=H(11579),i=H(11548),V=H(11611),U=H(11602),j=H(11618);const F=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class h extends M.j{constructor(e,E){super(e,M.h.LoadFileError),this.name="LoadFileError",M.e._setPrototypeOf(this,h.prototype),E instanceof N.b?this.request=E:this.file=E}}class S extends M.j{constructor(e,E){super(e,M.h.RequestFileError),this.request=E,this.name="RequestFileError",M.e._setPrototypeOf(this,S.prototype)}}class X extends M.j{constructor(e,E){super(e,M.h.ReadFileError),this.file=E,this.name="ReadFileError",M.e._setPrototypeOf(this,X.prototype)}}const a={DefaultRetryStrategy:class{static ExponentialBackoff(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return(H,N,u)=>0!==N.status||u>=e||-1!==H.indexOf("file:")?-1:Math.pow(2,u)*E}}.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e,ScriptBaseUrl:"",ScriptPreprocessUrl:e=>e,CleanUrl:e=>e=e.replace(/#/gm,"%23")},W=(e,E)=>{if((!e||0!==e.indexOf("data:"))&&a.CorsBehavior)if("string"===typeof a.CorsBehavior||a.CorsBehavior instanceof String)E.crossOrigin=a.CorsBehavior;else{const H=a.CorsBehavior(e);H&&(E.crossOrigin=H)}},r={getRequiredSize:null},Y=function(e,E,H,u){let z,M=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",A=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:C.d.LastCreatedEngine;if("undefined"===typeof HTMLImageElement&&(null===i||void 0===i||!i._features.forceBitmapOverHTMLImageElement))return H("LoadImage is only supported in web or BabylonNative environments."),null;let V=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!==typeof Blob&&"undefined"!==typeof URL?(z=URL.createObjectURL(new Blob([e],{type:M})),V=!0):z=`data:${M};base64,`+(0,D.k)(e):e instanceof Blob?(z=URL.createObjectURL(e),V=!0):(z=a.CleanUrl(e),z=a.PreprocessUrl(z));const U=E=>{if(H){const N=z||e.toString();H(`Error while trying to load image: ${0===N.indexOf("http")||N.length<=128?N:N.slice(0,128)+"..."}`,E)}};if(null!==i&&void 0!==i&&i._features.forceBitmapOverHTMLImageElement)return w(z,(N=>{i.createImageBitmap(new Blob([N],{type:M}),{premultiplyAlpha:"none",...A}).then((e=>{E(e),V&&URL.revokeObjectURL(z)})).catch((E=>{H&&H("Error while trying to load image: "+e,E)}))}),void 0,u||void 0,!0,((e,E)=>{U(E)})),null;const j=new Image;if(r.getRequiredSize){const E=r.getRequiredSize(e);E.width&&(j.width=E.width),E.height&&(j.height=E.height)}W(z,j);const F=[],h=()=>{for(const e of F)e.target.removeEventListener(e.name,e.handler);F.length=0};F.push({target:j,name:"load",handler:()=>{h(),E(j),V&&j.src&&URL.revokeObjectURL(j.src)}}),F.push({target:j,name:"error",handler:e=>{h(),U(e),V&&j.src&&URL.revokeObjectURL(j.src)}}),F.push({target:document,name:"securitypolicyviolation",handler:e=>{if(e.blockedURI!==j.src||"xP"===e.disposition)return;h();const E=new Error(`CSP violation of policy ${e.effectiveDirective} ${e.blockedURI}. Current policy is ${e.originalPolicy}`);C.d.UseFallbackTexture=!1,U(E),V&&j.src&&URL.revokeObjectURL(j.src),j.src=""}}),(()=>{for(const e of F)e.target.addEventListener(e.name,e.handler)})();const S="blob:"===z.substring(0,5),X="data:"===z.substring(0,5),Y=()=>{S||X||!N.b.IsCustomRequestAvailable?j.src=z:w(z,((e,E,H)=>{const N=new Blob([e],{type:!M&&H?H:M}),u=URL.createObjectURL(N);V=!0,j.src=u}),void 0,u||void 0,!0,((e,E)=>{U(E)}))},f=()=>{u&&u.loadImage(z,j)};if(!S&&!X&&u&&u.enableTexturesOffline)u.open(f,Y);else{if(-1!==z.indexOf("file:")){const e=decodeURIComponent(z.substring(5).toLowerCase());if(P.FilesToLoad[e]&&"undefined"!==typeof URL){try{let E;try{E=URL.createObjectURL(P.FilesToLoad[e])}catch(s){E=URL.createObjectURL(P.FilesToLoad[e])}j.src=E,V=!0}catch(p){j.src=""}return j}}Y()}return j},f=(e,E,H,N,u)=>{const P=new FileReader,M={onCompleteObservable:new z.d,abort:()=>P.abort()};return P.onloadend=()=>M.onCompleteObservable.notifyObservers(M),u&&(P.onerror=()=>{u(new X(`Unable to read ${e.name}`,e))}),P.onload=e=>{E(e.target.result)},H&&(P.onprogress=H),N?P.readAsArrayBuffer(e):P.readAsText(e),M},w=(e,E,H,N,u,D,A)=>{if(e.name)return f(e,E,H,u,D?e=>{D(void 0,e)}:void 0);const C=e;if(-1!==C.indexOf("file:")){let e=decodeURIComponent(C.substring(5).toLowerCase());0===e.indexOf("./")&&(e=e.substring(2));const N=P.FilesToLoad[e];if(N)return f(N,E,H,u,D?e=>D(void 0,new h(e.message,e.file)):void 0)}const{match:U,type:j}=b(C);if(U){const e={onCompleteObservable:new z.d,abort:()=>()=>{}};try{const e=u?K(C):l(C);E(e,void 0,j)}catch(M){D?D(void 0,M):i.d.Error(M.message||"Failed to parse the Data URL")}return V.e.SetImmediate((()=>{e.onCompleteObservable.notifyObservers(e)})),e}return s(C,((e,H)=>{E(e,null===H||void 0===H?void 0:H.responseURL,null===H||void 0===H?void 0:H.getResponseHeader("content-type"))}),H,N,u,D?e=>{D(e.request,new h(e.message,e.request))}:void 0,A)},s=(e,E,H,P,M,D,A)=>{e=a.CleanUrl(e),e=a.PreprocessUrl(e);const C=a.BaseUrl+e;let V=!1;const U={onCompleteObservable:new z.d,abort:()=>V=!0},j=()=>{let e,z=new N.b,P=null;const j=()=>{z&&(H&&z.removeEventListener("progress",H),e&&z.removeEventListener("readystatechange",e),z.removeEventListener("loadend",F))};let F=()=>{j(),U.onCompleteObservable.notifyObservers(U),U.onCompleteObservable.clear(),H=void 0,e=null,F=null,D=void 0,A=void 0,E=void 0};U.abort=()=>{V=!0,F&&F(),z&&z.readyState!==(XMLHttpRequest.DONE||4)&&z.abort(),null!==P&&(clearTimeout(P),P=null),z=null};const h=e=>{const E=e.message||"Unknown error";D&&z?D(new S(E,z)):i.d.Error(E)},X=i=>{if(z){if(z.open("GET",C),A)try{A(z)}catch(U){return void h(U)}M&&(z.responseType="arraybuffer"),H&&z.addEventListener("progress",H),F&&z.addEventListener("loadend",F),e=()=>{if(!V&&z&&z.readyState===(XMLHttpRequest.DONE||4)){if(e&&z.removeEventListener("readystatechange",e),z.status>=200&&z.status<300||0===z.status&&(!(0,u.i)()||o())){const e=M?z.response:z.responseText;if(null!==e){try{E&&E(e,z)}catch(U){h(U)}return}}const H=a.DefaultRetryStrategy;if(H){const e=H(C,z,i);if(-1!==e)return j(),z=new N.b,void(P=setTimeout((()=>X(i+1)),e))}const A=new S("Error status: "+z.status+" "+z.statusText+" - Unable to load "+C,z);D&&D(A)}},z.addEventListener("readystatechange",e),z.send()}};X(0)};if(P&&P.enableSceneOffline){const N=e=>{e&&e.status>400?D&&D(e):j()},u=()=>{P&&P.loadFile(a.BaseUrl+e,(e=>{!V&&E&&E(e),U.onCompleteObservable.notifyObservers(U)}),H?e=>{!V&&H&&H(e)}:void 0,N,M)};P.open(u,N)}else j();return U},p=e=>{const{match:E,type:H}=b(e);if(E)return H||void 0;const N=e.lastIndexOf(".");switch(e.substring(N+1).toLowerCase()){case"glb":return"model/gltf-binary";case"bin":return"application/octet-stream";case"eM":return"model/gltf+json";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";default:return}},o=()=>"undefined"!==typeof location&&"file:"===location.protocol,y=e=>F.test(e),b=e=>{const E=F.exec(e);if(null===E||0===E.length)return{match:!1,type:""};return{match:!0,type:E[0].replace("data:","").replace("base64,","")}};function K(e){return(0,D.b)(e.split(",")[1])}const l=e=>(0,D.e)(e.split(",")[1]);let O;j.c._FileToolsLoadImage=Y,U.b.loadFile=w,A.l.loadFile=w;((e,E,H,N,u,z,P,M,D,A)=>{O={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:E,DefaultRetryStrategy:H.DefaultRetryStrategy,BaseUrl:H.BaseUrl,CorsBehavior:H.CorsBehavior,PreprocessUrl:H.PreprocessUrl,IsBase64DataUrl:N,IsFileURL:u,LoadFile:z,LoadImage:P,ReadFile:M,RequestFile:D,SetCorsBehavior:A},Object.defineProperty(O,"DefaultRetryStrategy",{get:function(){return H.DefaultRetryStrategy},set:function(e){H.DefaultRetryStrategy=e}}),Object.defineProperty(O,"BaseUrl",{get:function(){return H.BaseUrl},set:function(e){H.BaseUrl=e}}),Object.defineProperty(O,"PreprocessUrl",{get:function(){return H.PreprocessUrl},set:function(e){H.PreprocessUrl=e}}),Object.defineProperty(O,"CorsBehavior",{get:function(){return H.CorsBehavior},set:function(e){H.CorsBehavior=e}})})(K,l,a,y,o,w,Y,f,s,W)},11693:(e,E,H)=>{function N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const E=16*Math.random()|0;return("x"===e?E:3&E|8).toString(16)}))}H.d(E,{e:()=>N})},11681:(e,E,H)=>{H.d(E,{b:()=>z});var N=H(11548),u=H(11690);class z{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];const E=(0,u.e)(e);if(E)return E;N.d.Warn(e+" not found, you may have missed an import.");const H=e.split(".");let z=window||this;for(let N=0,u=H.length;N<u;N++)z=z[H[N]];return"function"!==typeof z?null:z}}z.RegisteredExternalClasses={}},11559:(e,E,H)=>{H.d(E,{d:()=>u});var N=H(11546);class u{static get Now(){return(0,N.i)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},11598:(e,E,H)=>{H.d(E,{b:()=>P,e:()=>z,g:()=>N,k:()=>u});const N=e=>{if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);let E="";for(let H=0;H<e.byteLength;H++)E+=String.fromCharCode(e[H]);return E},u=e=>{const E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let H,N,u,z,P,M,D,A="",C=0;const i=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);for(;C<i.length;)H=i[C++],N=C<i.length?i[C++]:Number.NaN,u=C<i.length?i[C++]:Number.NaN,z=H>>2,P=(3&H)<<4|N>>4,M=(15&N)<<2|u>>6,D=63&u,isNaN(N)?M=D=64:isNaN(u)&&(D=64),A+=E.charAt(z)+E.charAt(P)+E.charAt(M)+E.charAt(D);return A},z=e=>atob(e),P=e=>{const E=z(e),H=E.length,N=new Uint8Array(new ArrayBuffer(H));for(let u=0;u<H;u++)N[u]=E.charCodeAt(u);return N.buffer}},11697:(e,E,H)=>{function N(e){let E=1;do{E*=2}while(E<e);return E===e}function u(e,E,H){return e*(1-H)+E*H}function z(e){const E=P(e),H=M(e);return E-e>e-H?H:E}function P(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function M(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)}function D(e,E){let H;switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:2){case 1:H=M(e);break;case 2:H=z(e);break;default:H=P(e)}return Math.min(H,E)}H.d(E,{d:()=>M,g:()=>D,k:()=>N,n:()=>u,o:()=>z})},11532:(e,E,H)=>{H.r(E),H.d(E,{AsyncLoop:()=>X,Tools:()=>h,className:()=>S});var N=H(11541),u=H(11546),z=H(11548),P=H(11552),M=H(11559),D=H(11565),A=H(11571),C=H(11579),i=H(11587),V=H(11611),U=H(11681),j=H(11693),F=H(11697);class h{static get BaseUrl(){return i.i.BaseUrl}static set BaseUrl(e){i.i.BaseUrl=e}static get CleanUrl(){return i.i.CleanUrl}static set CleanUrl(e){i.i.CleanUrl=e}static IsAbsoluteUrl(e){return 0===e.indexOf("//")||-1!==e.indexOf("://")&&(-1!==e.indexOf(".")&&(-1!==e.indexOf("/")&&(!(e.indexOf(":")>e.indexOf("/"))&&(e.indexOf("://")<e.indexOf(".")||(0===e.indexOf("data:")||0===e.indexOf("blob:"))))))}static set ScriptBaseUrl(e){i.i.ScriptBaseUrl=e}static get ScriptBaseUrl(){return i.i.ScriptBaseUrl}static set CDNBaseUrl(e){h.ScriptBaseUrl=e,h.AssetBaseUrl=e}static set ScriptPreprocessUrl(e){i.i.ScriptPreprocessUrl=e}static get ScriptPreprocessUrl(){return i.i.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return i.i.DefaultRetryStrategy}static set DefaultRetryStrategy(e){i.i.DefaultRetryStrategy=e}static get CorsBehavior(){return i.i.CorsBehavior}static set CorsBehavior(e){i.i.CorsBehavior=e}static get UseFallbackTexture(){return C.d.UseFallbackTexture}static set UseFallbackTexture(e){C.d.UseFallbackTexture=e}static get RegisteredExternalClasses(){return U.b.RegisteredExternalClasses}static set RegisteredExternalClasses(e){U.b.RegisteredExternalClasses=e}static get fallbackTexture(){return C.d.FallbackTexture}static set fallbackTexture(e){C.d.FallbackTexture=e}static FetchToRef(e,E,H,N,u,z){const P=4*((Math.abs(e)*H%H|0)+(Math.abs(E)*N%N|0)*H);z.r=u[P]/255,z.g=u[P+1]/255,z.b=u[P+2]/255,z.a=u[P+3]/255}static Mix(e,E,H){return 0}static Instantiate(e){return U.b.Instantiate(e)}static SetImmediate(e){V.e.SetImmediate(e)}static IsExponentOfTwo(e){return!0}static FloatRound(e){return Math.fround(e)}static GetFilename(e){const E=e.lastIndexOf("/");return E<0?e:e.substring(E+1)}static GetFolderPath(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const H=e.lastIndexOf("/");return H<0?E?e:"":e.substring(0,H+1)}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;const N=this.ToRadians(e),u=this.ToRadians(E);return this.ToDegrees(Math.atan2((1-H)*Math.sin(u)+H*Math.sin(N),(1-H)*Math.cos(u)+H*Math.cos(N)))}static MakeArray(e,E){return!0===E||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null}static GetPointerPrefix(e){return(0,u.i)()&&!window.PointerEvent?"mouse":"pointer"}static SetCorsBehavior(e,E){(0,i.E)(e,E)}static SetReferrerPolicyBehavior(e,E){E.referrerPolicy=e}static get PreprocessUrl(){return i.i.PreprocessUrl}static set PreprocessUrl(e){i.i.PreprocessUrl=e}static LoadImage(e,E,H,N,u,z){return(0,i.w)(e,E,H,N,u,z)}static LoadFile(e,E,H,N,u,z){return(0,i.s)(e,E,H,N,u,z)}static async LoadFileAsync(e){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return await new Promise(((H,N)=>{(0,i.s)(e,(e=>{H(e)}),void 0,void 0,E,((e,E)=>{N(E)}))}))}static GetAssetUrl(e){if(!e)return"";if(h.AssetBaseUrl&&e.startsWith(h._DefaultAssetsUrl)){const E="/"===h.AssetBaseUrl[h.AssetBaseUrl.length-1]?h.AssetBaseUrl.substring(0,h.AssetBaseUrl.length-1):h.AssetBaseUrl;return e.replace(h._DefaultAssetsUrl,E)}return e}static GetBabylonScriptURL(e,E){if(!e)return"";if(h.ScriptBaseUrl&&e.startsWith(h._DefaultCdnUrl)){const E="/"===h.ScriptBaseUrl[h.ScriptBaseUrl.length-1]?h.ScriptBaseUrl.substring(0,h.ScriptBaseUrl.length-1):h.ScriptBaseUrl;e=e.replace(h._DefaultCdnUrl,E)}return e=h.ScriptPreprocessUrl(e),E&&(e=h.GetAbsoluteUrl(e)),e}static LoadBabylonScript(e,E,H,N){e=h.GetBabylonScriptURL(e),h.LoadScript(e,E,H)}static async LoadBabylonScriptAsync(e){return e=h.GetBabylonScriptURL(e),await h.LoadScriptAsync(e)}static LoadScript(e,E,H,N){let z=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("function"===typeof importScripts){try{importScripts(e),E&&E()}catch(D){null===H||void 0===H||H(`Unable to load script '${e}' in worker`,D)}return}if(!(0,u.i)())return void(null===H||void 0===H||H(`Cannot load script '${e}' outside of a window or a worker`));const P=document.getElementsByTagName("head")[0],M=document.createElement("script");z?(M.setAttribute("type","module"),M.innerText=e):(M.setAttribute("type","text/javascript"),M.setAttribute("src",e)),N&&(M.id=N),M.onload=()=>{E&&E()},M.onerror=E=>{H&&H(`Unable to load script '${e}'`,E)},P.appendChild(M)}static async LoadScriptAsync(e,E){return await new Promise(((H,N)=>{this.LoadScript(e,(()=>{H()}),((e,E)=>{N(E||new Error(e))}),E)}))}static ReadFileAsDataURL(e,E,H){const u=new FileReader,z={onCompleteObservable:new N.d,abort:()=>u.abort()};return u.onloadend=()=>{z.onCompleteObservable.notifyObservers(z)},u.onload=e=>{E(e.target.result)},u.onprogress=H,u.readAsDataURL(e),z}static ReadFile(e,E,H,N,u){return(0,i.z)(e,E,H,N,u)}static FileAsURL(e){const E=new Blob([e]);return window.URL.createObjectURL(E)}static Format(e){let E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toFixed(E)}static DeepCopy(e,E,H,N){P.e.DeepCopy(e,E,H,N)}static IsEmpty(e){for(const E in e)if(Object.prototype.hasOwnProperty.call(e,E))return!1;return!0}static RegisterTopRootEvents(e,E){for(let N=0;N<E.length;N++){const u=E[N];e.addEventListener(u.name,u.handler,!1);try{window.parent&&window.parent.addEventListener(u.name,u.handler,!1)}catch(H){}}}static UnregisterTopRootEvents(e,E){for(let N=0;N<E.length;N++){const u=E[N];e.removeEventListener(u.name,u.handler);try{e.parent&&e.parent.removeEventListener(u.name,u.handler)}catch(H){}}}static async DumpFramebuffer(e,E,H,N){throw(0,D.b)("DumpTools")}static DumpData(e,E,H,N){throw(0,D.b)("DumpTools")}static async DumpDataAsync(e,E,H){throw(0,D.b)("DumpTools")}static _IsOffScreenCanvas(e){return void 0!==e.convertToBlob}static ToBlob(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",N=arguments.length>3?arguments[3]:void 0;h._IsOffScreenCanvas(e)||e.toBlob||(e.toBlob=function(e,E,H){setTimeout((()=>{const N=atob(this.toDataURL(E,H).split(",")[1]),u=N.length,z=new Uint8Array(u);for(let e=0;e<u;e++)z[e]=N.charCodeAt(e);e(new Blob([z]))}))}),h._IsOffScreenCanvas(e)?e.convertToBlob({type:H,quality:N}).then((e=>E(e))):e.toBlob((function(e){E(e)}),H,N)}static DownloadBlob(e,E){if("download"in document.createElement("a")){if(!E){const e=new Date;E="screenshot_"+((e.getFullYear()+"-"+(e.getMonth()+1)).slice(2)+"-"+e.getDate()+"_"+e.getHours()+"-"+("0"+e.getMinutes()).slice(-2))+".png"}h.Download(e,E)}else if(e&&"undefined"!==typeof URL){const E=URL.createObjectURL(e),H=window.open("");if(!H)return;const N=H.document.createElement("img");N.onload=function(){URL.revokeObjectURL(E)},N.src=E,H.document.body.appendChild(N)}}static EncodeScreenshotCanvasData(e,E){let H=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",N=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;if("string"!==typeof N&&E){if(E){if(h._IsOffScreenCanvas(e))return void e.convertToBlob({type:H,quality:u}).then((e=>{const H=new FileReader;H.readAsDataURL(e),H.onloadend=()=>{const e=H.result;E(e)}}));const N=e.toDataURL(H,u);E(N)}}else this.ToBlob(e,(function(e){e&&h.DownloadBlob(e,N),E&&E("")}),H,u)}static Download(e,E){if("undefined"===typeof URL)return;const H=window.URL.createObjectURL(e),N=document.createElement("a");document.body.appendChild(N),N.style.display="none",N.href=H,N.download=E,N.addEventListener("click",(()=>{N.parentElement&&N.parentElement.removeChild(N)})),N.click(),window.URL.revokeObjectURL(H)}static BackCompatCameraNoPreventDefault(e){return"boolean"===typeof e[0]?e[0]:"boolean"===typeof e[1]&&e[1]}static CreateScreenshot(e,E,H,N){throw(0,D.b)("ScreenshotTools")}static async CreateScreenshotAsync(e,E,H){throw(0,D.b)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,E,H,N){throw(0,D.b)("ScreenshotTools")}static async CreateScreenshotUsingRenderTargetAsync(e,E,H){throw(0,D.b)("ScreenshotTools")}static RandomId(){return(0,j.e)()}static IsBase64(e){return(0,i.n)(e)}static DecodeBase64(e){return(0,i.e)(e)}static get errorsCount(){return z.d.errorsCount}static Log(e){z.d.Log(e)}static Warn(e){z.d.Warn(e)}static Error(e){z.d.Error(e)}static get LogCache(){return z.d.LogCache}static ClearLogCache(){z.d.ClearLogCache()}static set LogLevels(e){z.d.LogLevels=e}static set PerformanceLogLevel(e){return(e&h.PerformanceUserMarkLogLevel)===h.PerformanceUserMarkLogLevel?(h.StartPerformanceCounter=h._StartUserMark,void(h.EndPerformanceCounter=h._EndUserMark)):(e&h.PerformanceConsoleLogLevel)===h.PerformanceConsoleLogLevel?(h.StartPerformanceCounter=h._StartPerformanceConsole,void(h.EndPerformanceCounter=h._EndPerformanceConsole)):(h.StartPerformanceCounter=h._StartPerformanceCounterDisabled,void(h.EndPerformanceCounter=h._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(e,E){}static _EndPerformanceCounterDisabled(e,E){}static _StartUserMark(e){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!h._Performance){if(!(0,u.i)())return;h._Performance=window.performance}E&&h._Performance.mark&&h._Performance.mark(e+"-Begin")}static _EndUserMark(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&h._Performance.mark&&(h._Performance.mark(e+"-End"),h._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];E&&(h._StartUserMark(e,E),console.time&&console.time(e))}static _EndPerformanceConsole(e){let E=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];E&&(h._EndUserMark(e,E),console.timeEnd(e))}static get Now(){return M.d.Now}static GetClassName(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=null;if(!E&&e.getClassName)H=e.getClassName();else{if(e instanceof Object){H=(E?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__}H||(H=typeof e)}return H}static First(e,E){for(const H of e)if(E(H))return H;return null}static getFullClassName(e){let E=arguments.length>1&&void 0!==arguments[1]&&arguments[1],H=null,N=null;if(!E&&e.getClassName)H=e.getClassName();else{if(e instanceof Object){const u=E?e:Object.getPrototypeOf(e);H=u.constructor.__bjsclassName__,N=u.constructor.__bjsmoduleName__}H||(H=typeof e)}return H?(null!=N?N+".":"")+H:null}static async DelayAsync(e){await new Promise((E=>{setTimeout((()=>{E()}),e)}))}static IsSafari(){return!!(0,u.e)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function S(e,E){return H=>{H.__bjsclassName__=e,H.__bjsmoduleName__=null!=E?E:null}}h.AssetBaseUrl="",h.UseCustomRequestHeaders=!1,h.CustomRequestHeaders=A.b.CustomRequestHeaders,h.GetDOMTextContent=u.c,h._DefaultCdnUrl="https://cdn.babylonjs.com",h._DefaultAssetsUrl="https://assets.babylonjs.com/core",h.GetAbsoluteUrl="object"===typeof document?e=>{const E=document.createElement("a");return E.href=e,E.href}:"function"===typeof URL&&"object"===typeof location?e=>new URL(e,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},h.NoneLogLevel=z.d.NoneLogLevel,h.MessageLogLevel=z.d.MessageLogLevel,h.WarningLogLevel=z.d.WarningLogLevel,h.ErrorLogLevel=z.d.ErrorLogLevel,h.AllLogLevel=z.d.AllLogLevel,h.IsWindowObjectExist=u.i,h.PerformanceNoneLogLevel=0,h.PerformanceUserMarkLogLevel=1,h.PerformanceConsoleLogLevel=2,h.StartPerformanceCounter=h._StartPerformanceCounterDisabled,h.EndPerformanceCounter=h._EndPerformanceCounterDisabled;class X{constructor(e,E,H){let N=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.iterations=e,this.index=N-1,this._done=!1,this._fn=E,this._successCallback=H}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,E,H){const N=new X(e,E,H,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0);return N.executeNext(),N}static SyncAsyncForLoop(e,E,H,N,u){let z=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return X.Run(Math.ceil(e/E),(N=>{u&&u()?N.breakLoop():setTimeout((()=>{for(let z=0;z<E;++z){const P=N.index*E+z;if(P>=e)break;if(H(P),u&&u()){N.breakLoop();break}}N.executeNext()}),z)}),N)}}h.Mix=F.n,h.IsExponentOfTwo=F.k,C.d.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},11690:(e,E,H)=>{H.d(E,{e:()=>z,g:()=>u});const N={};function u(e,E){N[e]=E}function z(e){return N[e]}},11571:(e,E,H)=>{H.d(E,{b:()=>N});class N{constructor(){this._xhr="undefined"!==typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(N.CustomRequestHeaders).length>0||N.CustomRequestModifiers.length>0}get requestURL(){return this._requestURL}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const e in N.CustomRequestHeaders){const E=N.CustomRequestHeaders[e];E&&this._xhr.setRequestHeader(e,E)}}_shouldSkipRequestModifications(e){return N.SkipRequestModificationForBabylonCDN&&(e.includes("preview.babylonjs.com")||e.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(e){this._xhr.onprogress=e}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(e){this._xhr.responseType=e}get timeout(){return this._xhr.timeout}set timeout(e){this._xhr.timeout=e}addEventListener(e,E,H){this._xhr.addEventListener(e,E,H)}removeEventListener(e,E,H){this._xhr.removeEventListener(e,E,H)}abort(){this._xhr.abort()}send(e){N.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)}open(e,E){for(const H of N.CustomRequestModifiers){if(this._shouldSkipRequestModifications(E))return;E=H(this._xhr,E)||E}E=(E=E.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=E,this._xhr.open(e,E,!0)}setRequestHeader(e,E){this._xhr.setRequestHeader(e,E)}getResponseHeader(e){return this._xhr.getResponseHeader(e)}}N.CustomRequestHeaders={},N.CustomRequestModifiers=new Array,N.SkipRequestModificationForBabylonCDN=!0}}]);