"use strict";(self.ksd6jhs1yr=self.ksd6jhs1yr||[]).push([[8],{12283:(C,c,d)=>{d.d(c,{c:()=>e});var b=d(12255),X=d(12233),P=d(12289),V=d(12311),R=d(12241);class p{constructor(){let C=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,C&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(C){this._zOffset!==C&&(this._zOffset=C,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(C){this._zOffsetUnits!==C&&(this._zOffsetUnits=C,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(C){this._cullFace!==C&&(this._cullFace=C,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(C){this._cull!==C&&(this._cull=C,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(C){this._depthFunc!==C&&(this._depthFunc=C,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(C){this._depthMask!==C&&(this._depthMask=C,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(C){this._depthTest!==C&&(this._depthTest=C,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(C){this._frontFace!==C&&(this._frontFace=C,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(C){this.isDirty&&(this._isCullDirty&&(this.cull?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(C.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(C.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?C.enable(C.DEPTH_TEST):C.disable(C.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(C.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(C.enable(C.POLYGON_OFFSET_FILL),C.polygonOffset(this.zOffset,this.zOffsetUnits)):C.disable(C.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(C.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}class j{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(C){this._func!==C&&(this._func=C,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(C){this._funcRef!==C&&(this._funcRef=C,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(C){this._funcMask!==C&&(this._funcMask=C,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(C){this._opStencilFail!==C&&(this._opStencilFail=C,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(C){this._opDepthFail!==C&&(this._opDepthFail=C,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(C){this._opStencilDepthPass!==C&&(this._opStencilDepthPass=C,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(C){this._mask!==C&&(this._mask=C,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(C){this._enabled!==C&&(this._enabled=C,this._isStencilTestDirty=!0)}constructor(){let C=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,C&&this.reset()}reset(){var C;this.stencilMaterial=void 0,null===(C=this.stencilGlobal)||void 0===C||C.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(C){var c;if(!C)return;const d=!this.useStencilGlobalOnly&&!(null===(c=this.stencilMaterial)||void 0===c||!c.enabled);this.enabled=d?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=d?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=d?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=d?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=d?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=d?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=d?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=d?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?C.enable(C.STENCIL_TEST):C.disable(C.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(C.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(C.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(C.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}class g{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=g.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=g.KEEP,this.opDepthFail=g.KEEP,this.opStencilDepthPass=g.REPLACE}get stencilFunc(){return this.func}set stencilFunc(C){this.func=C}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(C){this.funcRef=C}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(C){this.funcMask=C}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(C){this.opStencilFail=C}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(C){this.opDepthFail=C}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(C){this.opStencilDepthPass=C}get stencilMask(){return this.mask}set stencilMask(C){this.mask=C}get stencilTest(){return this.enabled}set stencilTest(C){this.enabled=C}}g.ALWAYS=519,g.KEEP=7680,g.REPLACE=7681;class k{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(C){this._alphaBlend!==C&&(this._alphaBlend=C,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(C,c,d,b){this._blendConstants[0]===C&&this._blendConstants[1]===c&&this._blendConstants[2]===d&&this._blendConstants[3]===b||(this._blendConstants[0]=C,this._blendConstants[1]=c,this._blendConstants[2]=d,this._blendConstants[3]=b,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(C,c,d,b){this._blendFunctionParameters[0]===C&&this._blendFunctionParameters[1]===c&&this._blendFunctionParameters[2]===d&&this._blendFunctionParameters[3]===b||(this._blendFunctionParameters[0]=C,this._blendFunctionParameters[1]=c,this._blendFunctionParameters[2]=d,this._blendFunctionParameters[3]=b,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(C,c){this._blendEquationParameters[0]===C&&this._blendEquationParameters[1]===c||(this._blendEquationParameters[0]=C,this._blendEquationParameters[1]=c,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(C){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?C.enable(C.BLEND):C.disable(C.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(C.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(C.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(C.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}var Z=d(12243),U=d(12316),A=d(12227),u=d(12221),q=d(12274),B=d(12329);function t(C,c){if((0,A.l)()){const{requestAnimationFrame:d}=c||window;if("function"===typeof d)return d(C)}else if("function"===typeof requestAnimationFrame)return requestAnimationFrame(C);return setTimeout(C,16)}class e{get frameId(){return this._frameId}get isWebGPU(){return this._isWebGPU}_getShaderProcessor(C){return this._shaderProcessor}get shaderPlatformName(){return this._shaderPlatformName}_clearEmptyResources(){this._emptyTexture=null,this._emptyCubeTexture=null,this._emptyTexture3D=null,this._emptyTexture2DArray=null}get o(){return this._useReverseDepthBuffer}set o(C){C!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=C,this._depthCullingState.depthFunc=C?518:515)}setColorWrite(C){C!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=C)}getColorWrite(){return this._colorWrite}get depthCullingState(){return this._depthCullingState}get alphaState(){return this._alphaState}get stencilState(){return this._stencilState}get stencilStateComposer(){return this._stencilStateComposer}_getGlobalDefines(C){if(C)return this.isNDCHalfZRange?C.IS_NDC_HALF_ZRANGE="":delete C.IS_NDC_HALF_ZRANGE,this.o?C.USE_REVERSE_DEPTHBUFFER="":delete C.USE_REVERSE_DEPTHBUFFER,void(this.useExactSrgbConversions?C.USE_EXACT_SRGB_CONVERSIONS="":delete C.USE_EXACT_SRGB_CONVERSIONS);{let C="";return this.isNDCHalfZRange&&(C+="#define IS_NDC_HALF_ZRANGE"),this.o&&(C&&(C+="\n"),C+="#define USE_REVERSE_DEPTHBUFFER"),this.useExactSrgbConversions&&(C&&(C+="\n"),C+="#define USE_EXACT_SRGB_CONVERSIONS"),C}}_rebuildInternalTextures(){const C=this._internalTexturesCache.slice();for(const c of C)c._rebuild()}_rebuildRenderTargetWrappers(){const C=this._renderTargetWrapperCache.slice();for(const c of C)c._rebuild()}_rebuildEffects(){for(const C in this._compiledEffects){const c=this._compiledEffects[C];c._pipelineContext=null,c._prepareEffect()}P.Effect.ResetCache()}_rebuildGraphicsResources(){var C;this.wipeCaches(!0),this._rebuildEffects(),null===(C=this._rebuildComputeEffects)||void 0===C||C.call(this),this._rebuildBuffers(),this._rebuildInternalTextures(),this._rebuildTextures(),this._rebuildRenderTargetWrappers(),this.wipeCaches(!0)}_flagContextRestored(){X.d.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1}_restoreEngineAfterContextLost(C){setTimeout((()=>{this._clearEmptyResources();const c=this._depthCullingState.depthTest,d=this._depthCullingState.depthFunc,b=this._depthCullingState.depthMask,X=this._stencilState.stencilTest;C(),this._rebuildGraphicsResources(),this._depthCullingState.depthTest=c,this._depthCullingState.depthFunc=d,this._depthCullingState.depthMask=b,this._stencilState.stencilTest=X,this._flagContextRestored()}),0)}get Z(){return this._isDisposed}get snapshotRendering(){return!1}set snapshotRendering(C){}get snapshotRenderingMode(){return 0}set snapshotRenderingMode(C){}getClassName(){return"AbstractEngine"}get emptyTexture(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture}get emptyTexture3D(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D}get emptyTexture2DArray(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray}get emptyCubeTexture(){if(!this._emptyCubeTexture){const C=new Uint8Array(4),c=[C,C,C,C,C,C];this._emptyCubeTexture=this.createRawCubeTexture(c,1,5,0,!1,!1,1)}return this._emptyCubeTexture}get activeRenderLoops(){return this._activeRenderLoops}stopRenderLoop(C){if(!C)return this._activeRenderLoops.length=0,void this._cancelFrame();const c=this._activeRenderLoops.indexOf(C);c>=0&&(this._activeRenderLoops.splice(c,1),0==this._activeRenderLoops.length&&this._cancelFrame())}_cancelFrame(){if(0!==this._frameHandler){const C=this._frameHandler;if(this._frameHandler=0,(0,A.l)()){const{cancelAnimationFrame:c}=this.getHostWindow()||window;if("function"===typeof c)return c(C)}else if("function"===typeof cancelAnimationFrame)return cancelAnimationFrame(C);return clearTimeout(C)}}kc(){this.onBeginFrameObservable.notifyObservers(this)}Zc(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}get maxFPS(){return this._maxFPS}set maxFPS(C){this._maxFPS=C,void 0!==C&&(this._minFrameTime=C<=0?Number.MAX_VALUE:1e3/C)}_isOverFrameTime(C){if(!C||void 0===this._maxFPS)return!1;const c=C-this._lastFrameTime;return this._lastFrameTime=C,this._renderAccumulator+=c,this._renderAccumulator<this._minFrameTime||(this._renderAccumulator-=this._minFrameTime,this._renderAccumulator>this._minFrameTime&&(this._renderAccumulator=this._minFrameTime),!1)}_processFrame(C){if(this._frameHandler=0,!this._contextWasLost&&!this._isOverFrameTime(C)){let C=!0;(this.Z||!this.renderEvenInBackground&&this._windowIsBackground)&&(C=!1),C&&(this.kc(),this.skipFrameRender||this._renderViews()||this._renderFrame(),this.Zc())}}_renderLoop(C){this._processFrame(C),this._activeRenderLoops.length>0&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()))}_renderFrame(){for(let C=0;C<this._activeRenderLoops.length;C++){(0,this._activeRenderLoops[C])()}}_renderViews(){return!1}_queueNewFrame(C,c){return t(C,c)}runRenderLoop(C){-1===this._activeRenderLoops.indexOf(C)&&(this._activeRenderLoops.push(C),1===this._activeRenderLoops.length&&0===this._frameHandler&&(this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))}getDepthBuffer(){return this._depthCullingState.depthTest}setDepthBuffer(C){this._depthCullingState.depthTest=C}setZOffset(C){this._depthCullingState.zOffset=this.o?-C:C}getZOffset(){const C=this._depthCullingState.zOffset;return this.o?-C:C}setZOffsetUnits(C){this._depthCullingState.zOffsetUnits=this.o?-C:C}getZOffsetUnits(){const C=this._depthCullingState.zOffsetUnits;return this.o?-C:C}getHostWindow(){return(0,A.l)()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(C){this._compatibilityMode=!0}_rebuildTextures(){for(const C of this.scenes)C._rebuildTextures();for(const C of this._virtualScenes)C._rebuildTextures()}_releaseRenderTargetWrapper(C){const c=this._renderTargetWrapperCache.indexOf(C);-1!==c&&this._renderTargetWrapperCache.splice(c,1)}get currentViewport(){return this._cachedViewport}setViewport(C,c,d){const b=c||this.getRenderWidth(),X=d||this.getRenderHeight(),P=C.x||0,V=C.y||0;this._cachedViewport=C,this._viewport(P*b,V*X,b*C.width,X*C.height)}createCanvasImage(){return document.createElement("img")}createCanvasPath2D(C){return new Path2D(C)}get description(){let C=this.name+this.version;return this._caps.parallelShaderCompile&&(C+=" - Parallel shader compilation"),C}_createTextureBase(C,c,d,P){let V=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3,R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,j=arguments.length>7?arguments[7]:void 0,g=arguments.length>8?arguments[8]:void 0,k=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,Z=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,A=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,u=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,q=arguments.length>13?arguments[13]:void 0,t=arguments.length>14?arguments[14]:void 0,n=arguments.length>15?arguments[15]:void 0;const W="data:"===(C=C||"").substring(0,5),E="blob:"===C.substring(0,5),N=W&&-1!==C.indexOf(";base64,"),r=Z||new U.d(this,1);r!==Z&&(r.label=C.substring(0,60));const M=C;!this._transformTextureUrl||N||Z||k||(C=this._transformTextureUrl(C)),M!==C&&(r._originalUrl=M);const K=C.lastIndexOf(".");let i=u||(K>-1?C.substring(K).toLowerCase():"");i.indexOf("?")>-1&&(i=i.split("?")[0]);const h=(0,B.e)(i,q);P&&P.addPendingData(r),r.url=C,r.generateMipMaps=!c,r.samplingMode=V,r.invertY=d,r._useSRGBBuffer=this._getUseSRGBBuffer(!!n,c),this._doNotHandleContextLost||(r._buffer=k);let L=null;R&&!Z&&(L=r.onLoadedObservable.add(R)),Z||this._internalTexturesCache.push(r);const f=(d,Z)=>{P&&P.removePendingData(r),C===M?(L&&r.onLoadedObservable.remove(L),b.c.UseFallbackTexture&&C!==b.c.FallbackTexture&&this._createTextureBase(b.c.FallbackTexture,c,r.invertY,P,V,null,p,j,g,k,r),d=(d||"Unknown error")+(b.c.UseFallbackTexture?" - Fallback texture was used":""),r.onErrorObservable.notifyObservers({message:d,exception:Z}),p&&p(d,Z)):(X.d.Warn(`Failed to load ${C}, falling back to ${M}`),this._createTextureBase(M,c,r.invertY,P,V,R,p,j,g,k,r,A,u,q,t,n))};if(h){const c=async C=>{(await h).loadData(C,r,((C,c,d,b,X,R)=>{R?f("TextureLoader failed to load data"):j(r,i,P,{width:C,height:c},r.invertY,!d,b,(()=>(X(),!1)),V)}),t)};k?k instanceof ArrayBuffer?c(new Uint8Array(k)):ArrayBuffer.isView(k)?c(k):p&&p("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(C,(C=>{c(new Uint8Array(C))}),void 0,P?P.offlineProvider:void 0,!0,((C,c)=>{f("Unable to load "+(C&&C.responseURL,c))}))}else{const d=C=>{E&&!this._doNotHandleContextLost&&(r._buffer=C),j(r,i,P,C,r.invertY,c,!1,g,V)};!W||N?k&&("string"===typeof k.decoding||k.close)?d(k):e._FileToolsLoadImage(C||"",d,f,P?P.offlineProvider:null,q,r.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):"string"===typeof k||k instanceof ArrayBuffer||ArrayBuffer.isView(k)||k instanceof Blob?e._FileToolsLoadImage(k,d,f,P?P.offlineProvider:null,q,r.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0,this):k&&d(k)}return r}_rebuildBuffers(){for(const C of this._uniformBuffers)C._rebuildAfterContextLost()}get _shouldUseHighPrecisionShader(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)}getHostDocument(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:(0,A.e)()?document:null}getLoadedTexturesCache(){return this._internalTexturesCache}clearInternalTexturesCache(){this._internalTexturesCache.length=0}getCaps(){return this._caps}resetTextureCache(){for(const C in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,C)&&(this._boundTexturesCache[C]=null);this._currentTextureChannel=-1}get name(){return this._name}set name(C){this._name=C}static get NpmPackage(){return"babylonjs@8.13.0"}static get Version(){return"8.13.0"}getRenderingCanvas(){return this._renderingCanvas}getAudioContext(){return this._audioContext}getAudioDestination(){return this._audioDestination}setHardwareScalingLevel(C){this._hardwareScalingLevel=C,this.resize()}getHardwareScalingLevel(){return this._hardwareScalingLevel}get doNotHandleContextLost(){return this._doNotHandleContextLost}set doNotHandleContextLost(C){this._doNotHandleContextLost=C}get isStencilEnable(){return this._isStencilEnable}getCreationOptions(){return this._creationOptions}constructor(C,c,d){var X,P;this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new p,this._stencilStateComposer=new j,this._stencilState=new g,this._alphaState=new k,this._alphaMode=1,this._alphaEquation=0,this._activeRequests=[],this._badOS=!1,this._badDesktopOS=!1,this._compatibilityMode=!0,this._internalTexturesCache=new Array,this._currentRenderTarget=null,this._boundTexturesCache={},this._activeChannel=0,this._currentTextureChannel=-1,this._viewportCached={x:0,y:0,z:0,w:0},this._isWebGPU=!1,this.onCanvasBlurObservable=new u.b,this.onCanvasFocusObservable=new u.b,this.onNewSceneAddedObservable=new u.b,this.onResizeObservable=new u.b,this.onCanvasPointerOutObservable=new u.b,this.onEffectErrorObservable=new u.b,this.disablePerformanceMonitorInBackground=!1,this.disableVertexArrayObjects=!1,this._frameId=0,this.hostInformation={isMobile:!1},this.isFullscreen=!1,this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.currentRenderPassId=0,this.isPointerLock=!1,this.postProcesses=[],this.canvasTabIndex=1,this._contextWasLost=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this._renderTargetWrapperCache=new Array,this._compiledEffects={},this._isDisposed=!1,this.scenes=[],this._virtualScenes=new Array,this.onBeforeTextureInitObservable=new u.b,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this._frameHandler=0,this._activeRenderLoops=new Array,this._windowIsBackground=!1,this._boundRenderFunction=C=>this._renderLoop(C),this._lastFrameTime=0,this._renderAccumulator=0,this.skipFrameRender=!1,this.onBeforeShaderCompilationObservable=new u.b,this.onAfterShaderCompilationObservable=new u.b,this.onBeginFrameObservable=new u.b,this.onEndFrameObservable=new u.b,this._transformTextureUrl=null,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._highPrecisionShadersAllowed=!0,this.onContextLostObservable=new u.b,this.onContextRestoredObservable=new u.b,this._name="",this.premultipliedAlpha=!0,this.adaptToDeviceRatio=!1,this._lastDevicePixelRatio=1,this._doNotHandleContextLost=!1,this.cullBackFaces=null,this._renderPassNames=["main"],this._fps=60,this._deltaTime=0,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this.Uc=new u.b,this.onReleaseEffectsObservable=new u.b,b.c.Instances.push(this),this.startTime=R.e.Now,this._stencilStateComposer.stencilGlobal=this._stencilState,V.d.SetMatrixPrecision(!!c.useHighPrecisionMatrix),(0,A.i)()&&navigator.userAgent&&(this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),this.adaptToDeviceRatio=d??!1,c.antialias=C??c.antialias,c.deterministicLockstep=c.deterministicLockstep??!1,c.lockstepMaxSteps=c.lockstepMaxSteps??4,c.timeStep=c.timeStep??1/60,c.uc=c.uc??!0,this._audioContext=(null===(X=c.audioEngineOptions)||void 0===X?void 0:X.audioContext)??null,this._audioDestination=(null===(P=c.audioEngineOptions)||void 0===P?void 0:P.audioDestination)??null,this.premultipliedAlpha=c.premultipliedAlpha??!0,this._doNotHandleContextLost=!!c.doNotHandleContextLost,this._isStencilEnable=!!c.uc,this.useExactSrgbConversions=c.useExactSrgbConversions??!1;const Z=(0,A.l)()&&window.devicePixelRatio||1,U=c.limitDeviceRatio||Z;d=d||c.adaptToDeviceRatio||!1,this._hardwareScalingLevel=d?1/Math.min(U,Z):1,this._lastDevicePixelRatio=Z,this._creationOptions=c}resize(){let C,c,d=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.adaptToDeviceRatio){const C=(0,A.l)()&&window.devicePixelRatio||1,c=this._lastDevicePixelRatio/C;this._lastDevicePixelRatio=C,this._hardwareScalingLevel*=c}if((0,A.l)()&&(0,A.e)())if(this._renderingCanvas){var b,X;const d=null===(b=(X=this._renderingCanvas).getBoundingClientRect)||void 0===b?void 0:b.call(X);C=this._renderingCanvas.clientWidth||(null===d||void 0===d?void 0:d.width)||this._renderingCanvas.width*this._hardwareScalingLevel||100,c=this._renderingCanvas.clientHeight||(null===d||void 0===d?void 0:d.height)||this._renderingCanvas.height*this._hardwareScalingLevel||100}else C=window.innerWidth,c=window.innerHeight;else C=this._renderingCanvas?this._renderingCanvas.width:100,c=this._renderingCanvas?this._renderingCanvas.height:100;this.setSize(C/this._hardwareScalingLevel,c/this._hardwareScalingLevel,d)}setSize(C,c){let d=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(C|=0,c|=0,!d&&this._renderingCanvas.width===C&&this._renderingCanvas.height===c)return!1;if(this._renderingCanvas.width=C,this._renderingCanvas.height=c,this.scenes){for(let C=0;C<this.scenes.length;C++){const c=this.scenes[C];for(let C=0;C<c.cameras.length;C++){c.cameras[C]._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}createRawTexture(C,c,d,b,X,P,V,R,p,j,g){throw(0,Z.c)("engine.rawTexture")}createRawCubeTexture(C,c,d,b,X,P,V,R){throw(0,Z.c)("engine.rawTexture")}createRawTexture3D(C,c,d,b,X,P,V,R,p,j,g){throw(0,Z.c)("engine.rawTexture")}createRawTexture2DArray(C,c,d,b,X,P,V,R,p,j,g){throw(0,Z.c)("engine.rawTexture")}_sharedInit(C){this._renderingCanvas=C}_setupMobileChecks(){navigator&&navigator.userAgent&&(this._checkForMobile=()=>{const C=navigator.userAgent;this.hostInformation.isMobile=-1!==C.indexOf("Mobile")||-1!==C.indexOf("Mac")&&(0,A.e)()&&"ontouchend"in document},this._checkForMobile(),(0,A.l)()&&window.addEventListener("resize",this._checkForMobile))}createVideoElement(C){return document.createElement("video")}_reportDrawCall(){var C;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;null===(C=this._drawCalls)||void 0===C||C.addCount(c,!1)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}_createImageBitmapFromSource(C,c){throw new Error("createImageBitmapFromSource is not implemented")}createImageBitmap(C,c){return createImageBitmap(C,c)}resizeImageBitmap(C,c,d){throw new Error("resizeImageBitmap is not implemented")}getFontOffset(C){throw new Error("getFontOffset is not implemented")}static _CreateCanvas(C,c){if("undefined"===typeof document)return new OffscreenCanvas(C,c);const d=document.createElement("canvas");return d.width=C,d.height=c,d}createCanvas(C,c){return e._CreateCanvas(C,c)}static _FileToolsLoadImage(C,c,d,b,X,P,V){throw(0,Z.c)("FileTools")}_loadFile(C,c,d,b,X,P){const V=(0,q.m)(C,c,d,b,X,P);return this._activeRequests.push(V),V.onCompleteObservable.add((()=>{const C=this._activeRequests.indexOf(V);-1!==C&&this._activeRequests.splice(C,1)})),V}static _FileToolsLoadFile(C,c,d,b,X,P){if(q.e.loadFile)return q.e.loadFile(C,c,d,b,X,P);throw(0,Z.c)("FileTools")}dispose(){var C;for(this.releaseEffects(),this._isDisposed=!0,this.stopRenderLoop(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._renderingCanvas=null,this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(;this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();null===(C=this.releaseComputeEffects)||void 0===C||C.call(this),P.Effect.ResetCache();for(const d of this._activeRequests)d.abort();this._boundRenderFunction=null,this.Uc.notifyObservers(this),this.Uc.clear(),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onNewSceneAddedObservable.clear(),this.onEffectErrorObservable.clear(),(0,A.l)()&&window.removeEventListener("resize",this._checkForMobile);const c=b.c.Instances.indexOf(this);c>=0&&b.c.Instances.splice(c,1),b.c.Instances.length||(b.c.OnEnginesDisposedObservable.notifyObservers(this),b.c.OnEnginesDisposedObservable.clear()),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}static DefaultLoadingScreenFactory(C){throw(0,Z.c)("LoadingScreen")}static MarkAllMaterialsAsDirty(C,c){for(let d=0;d<b.c.Instances.length;d++){const X=b.c.Instances[d];for(let d=0;d<X.scenes.length;d++)X.scenes[d].markAllMaterialsAsDirty(C,c)}}}e._RenderPassIdCounter=0,e._RescalePostProcessFactory=null,e.CollisionsEpsilon=.001,e.QueueNewFrame=t},12255:(C,c,d)=>{d.d(c,{c:()=>X});var b=d(12221);class X{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}X.Instances=[],X.OnEnginesDisposedObservable=new b.b,X._LastCreatedScene=null,X.UseFallbackTexture=!0,X.FallbackTexture=""},12311:(C,c,d)=>{d.d(c,{d:()=>b});class b{static SetMatrixPrecision(C){if(b.MatrixTrackPrecisionChange=!1,C&&!b.MatrixUse64Bits&&b.MatrixTrackedMatrices)for(let c=0;c<b.MatrixTrackedMatrices.length;++c){const C=b.MatrixTrackedMatrices[c],d=C.qc;C.qc=new Array(16);for(let c=0;c<16;++c)C.qc[c]=d[c]}b.MatrixUse64Bits=C,b.MatrixCurrentType=b.MatrixUse64Bits?Array:Float32Array,b.MatrixTrackedMatrices=null}}b.MatrixUse64Bits=!1,b.MatrixTrackPrecisionChange=!0,b.MatrixCurrentType=Float32Array,b.MatrixTrackedMatrices=[]},12329:(C,c,d)=>{d.d(c,{e:()=>V});var b=d(12233);const X=new Map;function P(C,c){(function(C){return X.delete(C)})(C)&&b.d.Warn(`Extension with the name '${C}' already exists`),X.set(C,c)}function V(C,c){"image/ktx"!==c&&"image/ktx2"!==c||(C=".ktx"),X.has(C)||(C.endsWith(".ies")&&P(".ies",(async()=>await d.e(15).then(d.bind(d,14877)).then((C=>new C._IESTextureLoader)))),C.endsWith(".dds")&&P(".dds",(async()=>await Promise.all([d.e(14),d.e(17),d.e(13),d.e(19),d.e(18),d.e(28)]).then(d.bind(d,14881)).then((C=>new C._DDSTextureLoader)))),C.endsWith(".basis")&&P(".basis",(async()=>await Promise.all([d.e(14),d.e(17),d.e(13),d.e(47)]).then(d.bind(d,14892)).then((C=>new C._BasisTextureLoader)))),C.endsWith(".env")&&P(".env",(async()=>await Promise.all([d.e(14),d.e(17),d.e(13),d.e(19),d.e(18),d.e(23),d.e(21),d.e(45),d.e(48)]).then(d.bind(d,14898)).then((C=>new C._ENVTextureLoader)))),C.endsWith(".hdr")&&P(".hdr",(async()=>await Promise.all([d.e(14),d.e(49)]).then(d.bind(d,14900)).then((C=>new C._HDRTextureLoader)))),(C.endsWith(".ktx")||C.endsWith(".ktx2"))&&(P(".ktx",(async()=>await d.e(30).then(d.bind(d,14904)).then((C=>new C._KTXTextureLoader)))),P(".ktx2",(async()=>await d.e(30).then(d.bind(d,14904)).then((C=>new C._KTXTextureLoader))))),C.endsWith(".tga")&&P(".tga",(async()=>await d.e(50).then(d.bind(d,14909)).then((C=>new C._TGATextureLoader)))),C.endsWith(".exr")&&P(".exr",(async()=>await d.e(16).then(d.bind(d,14913)).then((C=>new C._ExrTextureLoader)))));const b=X.get(C);return b?Promise.resolve(b(c)):null}},12316:(C,c,d)=>{d.d(c,{d:()=>V});var b,X=d(12221),P=d(12320);!function(C){C[C.Unknown=0]="Unknown",C[C.Url=1]="Url",C[C.Temp=2]="Temp",C[C.Raw=3]="Raw",C[C.Dynamic=4]="Dynamic",C[C.RenderTarget=5]="RenderTarget",C[C.MultiRenderTarget=6]="MultiRenderTarget",C[C.Cube=7]="Cube",C[C.CubeRaw=8]="CubeRaw",C[C.CubePrefiltered=9]="CubePrefiltered",C[C.Raw3D=10]="Raw3D",C[C.Raw2DArray=11]="Raw2DArray",C[C.DepthStencil=12]="DepthStencil",C[C.CubeRawRGBD=13]="CubeRawRGBD",C[C.Depth=14]="Depth"}(b||(b={}));class V extends P.e{get useMipMaps(){return this.generateMipMaps}set useMipMaps(C){this.generateMipMaps=C}get uniqueId(){return this._uniqueId}_setUniqueId(C){this._uniqueId=C}getEngine(){return this._engine}get source(){return this._source}constructor(C,c){let d=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new X.b,this.onErrorObservable=new X.b,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=0,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._creationFlags=0,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._premulAlpha=!1,this._dynamicTextureSource=null,this._autoMSAAManagement=!1,this._engine=C,this._source=c,this._uniqueId=V._Counter++,d||(this._hardwareTexture=C._createHardwareTexture())}incrementReferences(){this._references++}updateSize(C,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,C,c,d),this.width=C,this.height=c,this.depth=d,this.baseWidth=C,this.baseHeight=c,this.baseDepth=d,this._size=C*c*d}_rebuild(){if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const C=this.onRebuildCallback(this),c=c=>{c._swapAndDie(this,!1),this.isReady=C.isReady};return void(C.isAsync?C.proxy.then(c):c(C.proxy))}let C;switch(this.source){case 2:case 12:case 14:break;case 1:return void(C=this._engine.createTexture(this._originalUrl??this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(C=>{C._swapAndDie(this,!1),this.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case 3:C=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,this._creationFlags,this._useSRGBBuffer),C._swapAndDie(this,!1),this.isReady=!0;break;case 10:C=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),C._swapAndDie(this,!1),this.isReady=!0;break;case 11:C=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),C._swapAndDie(this,!1),this.isReady=!0;break;case 4:C=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),C._swapAndDie(this,!1),this._dynamicTextureSource&&this._engine.updateDynamicTexture(this,this._dynamicTextureSource,this.invertY,this._premulAlpha,this.format,!0);break;case 7:return void(C=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(()=>{C._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer,ArrayBuffer.isView(this._buffer)?this._buffer:null));case 8:C=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this._originalFormat??this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),C._swapAndDie(this,!1),this.isReady=!0;break;case 13:return;case 9:return C=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(C=>{C&&C._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension),void(C._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(C){var c;let d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===(c=this._hardwareTexture)||void 0===c||c.setUsage(C._source,this.generateMipMaps,this.is2DArray,this.isCube,this.is3D,this.width,this.height,this.depth),C._hardwareTexture=this._hardwareTexture,d&&(C._isRGBD=this._isRGBD),this._lodTextureHigh&&(C._lodTextureHigh&&C._lodTextureHigh.dispose(),C._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(C._lodTextureMid&&C._lodTextureMid.dispose(),C._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(C._lodTextureLow&&C._lodTextureLow.dispose(),C._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(C._irradianceTexture&&C._irradianceTexture.dispose(),C._irradianceTexture=this._irradianceTexture);const b=this._engine.getLoadedTexturesCache();let X=b.indexOf(this);-1!==X&&b.splice(X,1),X=b.indexOf(C),-1===X&&b.push(C)}dispose(){this._references--,0===this._references&&(this.onLoadedObservable.clear(),this.onErrorObservable.clear(),this._engine._releaseTexture(this),this._hardwareTexture=null,this._dynamicTextureSource=null)}}V._Counter=0},12320:(C,c,d)=>{d.d(c,{e:()=>b});class b{get wrapU(){return this._cachedWrapU}set wrapU(C){this._cachedWrapU=C}get wrapV(){return this._cachedWrapV}set wrapV(C){this._cachedWrapV=C}get wrapR(){return this._cachedWrapR}set wrapR(C){this._cachedWrapR=C}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(C){this._cachedAnisotropicFilteringLevel=C}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(C){this._comparisonFunction=C}get useMipMaps(){return this._useMipMaps}set useMipMaps(C){this._useMipMaps=C}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(){let C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,P=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=C,this._cachedWrapV=c,this._cachedWrapR=d,this._cachedAnisotropicFilteringLevel=b,this.samplingMode=X,this._comparisonFunction=P,this}compareSampler(C){return this._cachedWrapU===C._cachedWrapU&&this._cachedWrapV===C._cachedWrapV&&this._cachedWrapR===C._cachedWrapR&&this._cachedAnisotropicFilteringLevel===C._cachedAnisotropicFilteringLevel&&this.samplingMode===C.samplingMode&&this._comparisonFunction===C._comparisonFunction&&this._useMipMaps===C._useMipMaps}}},12235:(C,c,d)=>{d.d(c,{d:()=>P});var b=d(12233);const X=(C,c,d)=>C?C.getClassName&&"Mesh"===C.getClassName()?null:!C.getClassName||"SubMesh"!==C.getClassName()&&"PhysicsBody"!==C.getClassName()?C.clone?C.clone():Array.isArray(C)?C.slice():d&&"object"===typeof C?{...C}:null:C.clone(c):null;class P{static DeepCopy(C,c,d,P){let V=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const R=function(C){const c=[];do{const d=Object.getOwnPropertyNames(C);for(const C of d)-1===c.indexOf(C)&&c.push(C)}while(C=Object.getPrototypeOf(C));return c}(C);for(const j of R){if("_"===j[0]&&(!P||-1===P.indexOf(j)))continue;if(j.endsWith("Observable"))continue;if(d&&-1!==d.indexOf(j))continue;const R=C[j],g=typeof R;if("function"!==g)try{if("object"===g)if(R instanceof Uint8Array)c[j]=Uint8Array.from(R);else if(R instanceof Array){if(c[j]=[],R.length>0)if("object"==typeof R[0])for(let C=0;C<R.length;C++){const d=X(R[C],c,V);-1===c[j].indexOf(d)&&c[j].push(d)}else c[j]=R.slice(0)}else c[j]=X(R,c,V);else c[j]=R}catch(p){b.d.Warn(p.message)}}}}},12261:(C,c,d)=>{d.d(c,{e:()=>b,h:()=>X,l:()=>P});class b extends Error{}b._setPrototypeOf=Object.setPrototypeOf||((C,c)=>(C.__proto__=c,C));const X={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class P extends b{constructor(C,c,d){super(C),this.errorCode=c,this.innerError=d,this.name="RuntimeError",b._setPrototypeOf(this,P.prototype)}}},12258:(C,c,d)=>{d.d(c,{b:()=>f,f:()=>e,h:()=>K,j:()=>h,p:()=>r,l:()=>q,t:()=>E,v:()=>N,z:()=>M,D:()=>n});var b=d(12248),X=d(12227),P=d(12221);class V{}V.FilesToLoad={};var R=d(12261),p=d(12266),j=d(12272),g=d(12255),k=d(12233),Z=d(12281),U=d(12274),A=d(12283);const u=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class q extends R.l{constructor(C,c){super(C,R.h.LoadFileError),this.name="LoadFileError",R.e._setPrototypeOf(this,q.prototype),c instanceof b.b?this.request=c:this.file=c}}class B extends R.l{constructor(C,c){super(C,R.h.RequestFileError),this.request=c,this.name="RequestFileError",R.e._setPrototypeOf(this,B.prototype)}}class t extends R.l{constructor(C,c){super(C,R.h.ReadFileError),this.file=c,this.name="ReadFileError",R.e._setPrototypeOf(this,t.prototype)}}const e={DefaultRetryStrategy:class{static ExponentialBackoff(){let C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return(d,b,X)=>0!==b.status||X>=C||-1!==d.indexOf("file:")?-1:Math.pow(2,X)*c}}.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:C=>C,ScriptBaseUrl:"",ScriptPreprocessUrl:C=>C,CleanUrl:C=>C=C.replace(/#/gm,"%23")},n=(C,c)=>{if((!C||0!==C.indexOf("data:"))&&e.CorsBehavior)if("string"===typeof e.CorsBehavior||e.CorsBehavior instanceof String)c.crossOrigin=e.CorsBehavior;else{const d=e.CorsBehavior(C);d&&(c.crossOrigin=d)}},W={getRequiredSize:null},E=function(C,c,d,X){let P,R=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",j=arguments.length>5?arguments[5]:void 0,k=arguments.length>6&&void 0!==arguments[6]?arguments[6]:g.c.LastCreatedEngine;if("undefined"===typeof HTMLImageElement&&(null===k||void 0===k||!k._features.forceBitmapOverHTMLImageElement))return d("LoadImage is only supported in web or BabylonNative environments."),null;let Z=!1;C instanceof ArrayBuffer||ArrayBuffer.isView(C)?"undefined"!==typeof Blob&&"undefined"!==typeof URL?(P=URL.createObjectURL(new Blob([C],{type:R})),Z=!0):P=`data:${R};base64,`+(0,p.g)(C):C instanceof Blob?(P=URL.createObjectURL(C),Z=!0):(P=e.CleanUrl(C),P=e.PreprocessUrl(P));const U=c=>{if(d){const b=P||C.toString();d(`Error while trying to load image: ${0===b.indexOf("http")||b.length<=128?b:b.slice(0,128)+"..."}`,c)}};if(null!==k&&void 0!==k&&k._features.forceBitmapOverHTMLImageElement)return r(P,(b=>{k.createImageBitmap(new Blob([b],{type:R}),{premultiplyAlpha:"none",...j}).then((C=>{c(C),Z&&URL.revokeObjectURL(P)})).catch((c=>{d&&d("Error while trying to load image: "+C,c)}))}),void 0,X||void 0,!0,((C,c)=>{U(c)})),null;const A=new Image;if(W.getRequiredSize){const c=W.getRequiredSize(C);c.width&&(A.width=c.width),c.height&&(A.height=c.height)}n(P,A);const u=[],q=()=>{for(const C of u)C.target.removeEventListener(C.name,C.handler);u.length=0};u.push({target:A,name:"load",handler:()=>{q(),c(A),Z&&A.src&&URL.revokeObjectURL(A.src)}}),u.push({target:A,name:"error",handler:C=>{q(),U(C),Z&&A.src&&URL.revokeObjectURL(A.src)}}),u.push({target:document,name:"securitypolicyviolation",handler:C=>{if(C.blockedURI!==A.src||"Bc"===C.disposition)return;q();const c=new Error(`CSP violation of policy ${C.effectiveDirective} ${C.blockedURI}. Current policy is ${C.originalPolicy}`);g.c.UseFallbackTexture=!1,U(c),Z&&A.src&&URL.revokeObjectURL(A.src),A.src=""}}),(()=>{for(const C of u)C.target.addEventListener(C.name,C.handler)})();const B="blob:"===P.substring(0,5),t="data:"===P.substring(0,5),E=()=>{B||t||!b.b.IsCustomRequestAvailable?A.src=P:r(P,((C,c,d)=>{const b=new Blob([C],{type:!R&&d?d:R}),X=URL.createObjectURL(b);Z=!0,A.src=X}),void 0,X||void 0,!0,((C,c)=>{U(c)}))},N=()=>{X&&X.loadImage(P,A)};if(!B&&!t&&X&&X.enableTexturesOffline)X.open(N,E);else{if(-1!==P.indexOf("file:")){const C=decodeURIComponent(P.substring(5).toLowerCase());if(V.FilesToLoad[C]&&"undefined"!==typeof URL){try{let c;try{c=URL.createObjectURL(V.FilesToLoad[C])}catch(M){c=URL.createObjectURL(V.FilesToLoad[C])}A.src=c,Z=!0}catch(K){A.src=""}return A}}E()}return A},N=(C,c,d,b,X)=>{const V=new FileReader,R={onCompleteObservable:new P.b,abort:()=>V.abort()};return V.onloadend=()=>R.onCompleteObservable.notifyObservers(R),X&&(V.onerror=()=>{X(new t(`Unable to read ${C.name}`,C))}),V.onload=C=>{c(C.target.result)},d&&(V.onprogress=d),b?V.readAsArrayBuffer(C):V.readAsText(C),R},r=(C,c,d,b,X,p,j)=>{if(C.name)return N(C,c,d,X,p?C=>{p(void 0,C)}:void 0);const g=C;if(-1!==g.indexOf("file:")){let C=decodeURIComponent(g.substring(5).toLowerCase());0===C.indexOf("./")&&(C=C.substring(2));const b=V.FilesToLoad[C];if(b)return N(b,c,d,X,p?C=>p(void 0,new q(C.message,C.file)):void 0)}const{match:U,type:A}=L(g);if(U){const C={onCompleteObservable:new P.b,abort:()=>()=>{}};try{const C=X?f(g):T(g);c(C,void 0,A)}catch(R){p?p(void 0,R):k.d.Error(R.message||"Failed to parse the Data URL")}return Z.d.SetImmediate((()=>{C.onCompleteObservable.notifyObservers(C)})),C}return M(g,((C,d)=>{c(C,null===d||void 0===d?void 0:d.responseURL,null===d||void 0===d?void 0:d.getResponseHeader("content-type"))}),d,b,X,p?C=>{p(C.request,new q(C.message,C.request))}:void 0,j)},M=(C,c,d,V,R,p,j)=>{C=e.CleanUrl(C),C=e.PreprocessUrl(C);const g=e.BaseUrl+C;let Z=!1;const U={onCompleteObservable:new P.b,abort:()=>Z=!0},A=()=>{let C,P=new b.b,V=null;const A=()=>{P&&(d&&P.removeEventListener("progress",d),C&&P.removeEventListener("readystatechange",C),P.removeEventListener("loadend",u))};let u=()=>{A(),U.onCompleteObservable.notifyObservers(U),U.onCompleteObservable.clear(),d=void 0,C=null,u=null,p=void 0,j=void 0,c=void 0};U.abort=()=>{Z=!0,u&&u(),P&&P.readyState!==(XMLHttpRequest.DONE||4)&&P.abort(),null!==V&&(clearTimeout(V),V=null),P=null};const q=C=>{const c=C.message||"Unknown error";p&&P?p(new B(c,P)):k.d.Error(c)},t=k=>{if(P){if(P.open("GET",g),j)try{j(P)}catch(U){return void q(U)}R&&(P.responseType="arraybuffer"),d&&P.addEventListener("progress",d),u&&P.addEventListener("loadend",u),C=()=>{if(!Z&&P&&P.readyState===(XMLHttpRequest.DONE||4)){if(C&&P.removeEventListener("readystatechange",C),P.status>=200&&P.status<300||0===P.status&&(!(0,X.l)()||i())){const C=R?P.response:P.responseText;if(null!==C){try{c&&c(C,P)}catch(U){q(U)}return}}const d=e.DefaultRetryStrategy;if(d){const C=d(g,P,k);if(-1!==C)return A(),P=new b.b,void(V=setTimeout((()=>t(k+1)),C))}const j=new B("Error status: "+P.status+" "+P.statusText+" - Unable to load "+g,P);p&&p(j)}},P.addEventListener("readystatechange",C),P.send()}};t(0)};if(V&&V.enableSceneOffline){const b=C=>{C&&C.status>400?p&&p(C):A()},X=()=>{V&&V.loadFile(e.BaseUrl+C,(C=>{!Z&&c&&c(C),U.onCompleteObservable.notifyObservers(U)}),d?C=>{!Z&&d&&d(C)}:void 0,b,R)};V.open(X,b)}else A();return U},K=C=>{const{match:c,type:d}=L(C);if(c)return d||void 0;const b=C.lastIndexOf(".");switch(C.substring(b+1).toLowerCase()){case"glb":return"model/gltf-binary";case"bin":return"application/octet-stream";case"ec":return"model/gltf+json";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"webp":return"image/webp";default:return}},i=()=>"undefined"!==typeof location&&"file:"===location.protocol,h=C=>u.test(C),L=C=>{const c=u.exec(C);if(null===c||0===c.length)return{match:!1,type:""};return{match:!0,type:c[0].replace("data:","").replace("base64,","")}};function f(C){return(0,p.b)(C.split(",")[1])}const T=C=>(0,p.e)(C.split(",")[1]);let z;A.c._FileToolsLoadImage=E,U.e.loadFile=r,j.k.loadFile=r;((C,c,d,b,X,P,V,R,p,j)=>{z={DecodeBase64UrlToBinary:C,DecodeBase64UrlToString:c,DefaultRetryStrategy:d.DefaultRetryStrategy,BaseUrl:d.BaseUrl,CorsBehavior:d.CorsBehavior,PreprocessUrl:d.PreprocessUrl,IsBase64DataUrl:b,IsFileURL:X,LoadFile:P,LoadImage:V,ReadFile:R,RequestFile:p,SetCorsBehavior:j},Object.defineProperty(z,"DefaultRetryStrategy",{get:function(){return d.DefaultRetryStrategy},set:function(C){d.DefaultRetryStrategy=C}}),Object.defineProperty(z,"BaseUrl",{get:function(){return d.BaseUrl},set:function(C){d.BaseUrl=C}}),Object.defineProperty(z,"PreprocessUrl",{get:function(){return d.PreprocessUrl},set:function(C){d.PreprocessUrl=C}}),Object.defineProperty(z,"CorsBehavior",{get:function(){return d.CorsBehavior},set:function(C){d.CorsBehavior=C}})})(f,T,e,h,i,r,E,N,M,n)},12352:(C,c,d)=>{function b(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(C=>{const c=16*Math.random()|0;return("x"===C?c:3&c|8).toString(16)}))}d.d(c,{c:()=>b})},12337:(C,c,d)=>{d.d(c,{b:()=>P});var b=d(12233),X=d(12345);class P{static Instantiate(C){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[C])return this.RegisteredExternalClasses[C];const c=(0,X.b)(C);if(c)return c;b.d.Warn(C+" not found, you may have missed an import.");const d=C.split(".");let P=window||this;for(let b=0,X=d.length;b<X;b++)P=P[d[b]];return"function"!==typeof P?null:P}}P.RegisteredExternalClasses={}},12241:(C,c,d)=>{d.d(c,{e:()=>X});var b=d(12227);class X{static get Now(){return(0,b.l)()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},12266:(C,c,d)=>{d.d(c,{b:()=>V,e:()=>P,f:()=>b,g:()=>X});const b=C=>{if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(C);let c="";for(let d=0;d<C.byteLength;d++)c+=String.fromCharCode(C[d]);return c},X=C=>{const c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let d,b,X,P,V,R,p,j="",g=0;const k=ArrayBuffer.isView(C)?new Uint8Array(C.buffer,C.byteOffset,C.byteLength):new Uint8Array(C);for(;g<k.length;)d=k[g++],b=g<k.length?k[g++]:Number.NaN,X=g<k.length?k[g++]:Number.NaN,P=d>>2,V=(3&d)<<4|b>>4,R=(15&b)<<2|X>>6,p=63&X,isNaN(b)?R=p=64:isNaN(X)&&(p=64),j+=c.charAt(P)+c.charAt(V)+c.charAt(R)+c.charAt(p);return j},P=C=>atob(C),V=C=>{const c=P(C),d=c.length,b=new Uint8Array(new ArrayBuffer(d));for(let X=0;X<d;X++)b[X]=c.charCodeAt(X);return b.buffer}},12361:(C,c,d)=>{function b(C){let c=1;do{c*=2}while(c<C);return c===C}function X(C,c,d){return C*(1-d)+c*d}function P(C){const c=V(C),d=R(C);return c-C>C-d?d:c}function V(C){return C--,C|=C>>1,C|=C>>2,C|=C>>4,C|=C>>8,C|=C>>16,++C}function R(C){return C|=C>>1,C|=C>>2,C|=C>>4,C|=C>>8,(C|=C>>16)-(C>>1)}function p(C,c){let d;switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:2){case 1:d=R(C);break;case 2:d=P(C);break;default:d=V(C)}return Math.min(d,c)}d.d(c,{c:()=>R,g:()=>p,h:()=>b,i:()=>X,m:()=>P})},12219:(C,c,d)=>{d.r(c),d.d(c,{AsyncLoop:()=>t,Tools:()=>q,className:()=>B});var b=d(12221),X=d(12227),P=d(12233),V=d(12235),R=d(12241),p=d(12243),j=d(12248),g=d(12255),k=d(12258),Z=d(12281),U=d(12337),A=d(12352),u=d(12361);class q{static get BaseUrl(){return k.f.BaseUrl}static set BaseUrl(C){k.f.BaseUrl=C}static get CleanUrl(){return k.f.CleanUrl}static set CleanUrl(C){k.f.CleanUrl=C}static IsAbsoluteUrl(C){return 0===C.indexOf("//")||-1!==C.indexOf("://")&&(-1!==C.indexOf(".")&&(-1!==C.indexOf("/")&&(!(C.indexOf(":")>C.indexOf("/"))&&(C.indexOf("://")<C.indexOf(".")||(0===C.indexOf("data:")||0===C.indexOf("blob:"))))))}static set ScriptBaseUrl(C){k.f.ScriptBaseUrl=C}static get ScriptBaseUrl(){return k.f.ScriptBaseUrl}static set CDNBaseUrl(C){q.ScriptBaseUrl=C,q.AssetBaseUrl=C}static set ScriptPreprocessUrl(C){k.f.ScriptPreprocessUrl=C}static get ScriptPreprocessUrl(){return k.f.ScriptPreprocessUrl}static get DefaultRetryStrategy(){return k.f.DefaultRetryStrategy}static set DefaultRetryStrategy(C){k.f.DefaultRetryStrategy=C}static get CorsBehavior(){return k.f.CorsBehavior}static set CorsBehavior(C){k.f.CorsBehavior=C}static get UseFallbackTexture(){return g.c.UseFallbackTexture}static set UseFallbackTexture(C){g.c.UseFallbackTexture=C}static get RegisteredExternalClasses(){return U.b.RegisteredExternalClasses}static set RegisteredExternalClasses(C){U.b.RegisteredExternalClasses=C}static get fallbackTexture(){return g.c.FallbackTexture}static set fallbackTexture(C){g.c.FallbackTexture=C}static FetchToRef(C,c,d,b,X,P){const V=4*((Math.abs(C)*d%d|0)+(Math.abs(c)*b%b|0)*d);P.r=X[V]/255,P.g=X[V+1]/255,P.b=X[V+2]/255,P.a=X[V+3]/255}static Mix(C,c,d){return 0}static Instantiate(C){return U.b.Instantiate(C)}static SetImmediate(C){Z.d.SetImmediate(C)}static IsExponentOfTwo(C){return!0}static FloatRound(C){return Math.fround(C)}static GetFilename(C){const c=C.lastIndexOf("/");return c<0?C:C.substring(c+1)}static GetFolderPath(C){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const d=C.lastIndexOf("/");return d<0?c?C:"":C.substring(0,d+1)}static ToDegrees(C){return 180*C/Math.PI}static ToRadians(C){return C*Math.PI/180}static SmoothAngleChange(C,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;const b=this.ToRadians(C),X=this.ToRadians(c);return this.ToDegrees(Math.atan2((1-d)*Math.sin(X)+d*Math.sin(b),(1-d)*Math.cos(X)+d*Math.cos(b)))}static MakeArray(C,c){return!0===c||void 0!==C&&null!=C?Array.isArray(C)?C:[C]:null}static GetPointerPrefix(C){return(0,X.l)()&&!window.PointerEvent?"mouse":"pointer"}static SetCorsBehavior(C,c){(0,k.D)(C,c)}static SetReferrerPolicyBehavior(C,c){c.referrerPolicy=C}static get PreprocessUrl(){return k.f.PreprocessUrl}static set PreprocessUrl(C){k.f.PreprocessUrl=C}static LoadImage(C,c,d,b,X,P){return(0,k.t)(C,c,d,b,X,P)}static LoadFile(C,c,d,b,X,P){return(0,k.p)(C,c,d,b,X,P)}static async LoadFileAsync(C){let c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return await new Promise(((d,b)=>{(0,k.p)(C,(C=>{d(C)}),void 0,void 0,c,((C,c)=>{b(c)}))}))}static GetAssetUrl(C){if(!C)return"";if(q.AssetBaseUrl&&C.startsWith(q._DefaultAssetsUrl)){const c="/"===q.AssetBaseUrl[q.AssetBaseUrl.length-1]?q.AssetBaseUrl.substring(0,q.AssetBaseUrl.length-1):q.AssetBaseUrl;return C.replace(q._DefaultAssetsUrl,c)}return C}static GetBabylonScriptURL(C,c){if(!C)return"";if(q.ScriptBaseUrl&&C.startsWith(q._DefaultCdnUrl)){const c="/"===q.ScriptBaseUrl[q.ScriptBaseUrl.length-1]?q.ScriptBaseUrl.substring(0,q.ScriptBaseUrl.length-1):q.ScriptBaseUrl;C=C.replace(q._DefaultCdnUrl,c)}return C=q.ScriptPreprocessUrl(C),c&&(C=q.GetAbsoluteUrl(C)),C}static LoadBabylonScript(C,c,d,b){C=q.GetBabylonScriptURL(C),q.LoadScript(C,c,d)}static async LoadBabylonScriptAsync(C){return C=q.GetBabylonScriptURL(C),await q.LoadScriptAsync(C)}static LoadScript(C,c,d,b){let P=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("function"===typeof importScripts){try{importScripts(C),c&&c()}catch(p){null===d||void 0===d||d(`Unable to load script '${C}' in worker`,p)}return}if(!(0,X.l)())return void(null===d||void 0===d||d(`Cannot load script '${C}' outside of a window or a worker`));const V=document.getElementsByTagName("head")[0],R=document.createElement("script");P?(R.setAttribute("type","module"),R.innerText=C):(R.setAttribute("type","text/javascript"),R.setAttribute("src",C)),b&&(R.id=b),R.onload=()=>{c&&c()},R.onerror=c=>{d&&d(`Unable to load script '${C}'`,c)},V.appendChild(R)}static async LoadScriptAsync(C,c){return await new Promise(((d,b)=>{this.LoadScript(C,(()=>{d()}),((C,c)=>{b(c||new Error(C))}),c)}))}static ReadFileAsDataURL(C,c,d){const X=new FileReader,P={onCompleteObservable:new b.b,abort:()=>X.abort()};return X.onloadend=()=>{P.onCompleteObservable.notifyObservers(P)},X.onload=C=>{c(C.target.result)},X.onprogress=d,X.readAsDataURL(C),P}static ReadFile(C,c,d,b,X){return(0,k.v)(C,c,d,b,X)}static FileAsURL(C){const c=new Blob([C]);return window.URL.createObjectURL(c)}static Format(C){let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return C.toFixed(c)}static DeepCopy(C,c,d,b){V.d.DeepCopy(C,c,d,b)}static IsEmpty(C){for(const c in C)if(Object.prototype.hasOwnProperty.call(C,c))return!1;return!0}static RegisterTopRootEvents(C,c){for(let b=0;b<c.length;b++){const X=c[b];C.addEventListener(X.name,X.handler,!1);try{window.parent&&window.parent.addEventListener(X.name,X.handler,!1)}catch(d){}}}static UnregisterTopRootEvents(C,c){for(let b=0;b<c.length;b++){const X=c[b];C.removeEventListener(X.name,X.handler);try{C.parent&&C.parent.removeEventListener(X.name,X.handler)}catch(d){}}}static async DumpFramebuffer(C,c,d,b){throw(0,p.c)("DumpTools")}static DumpData(C,c,d,b){throw(0,p.c)("DumpTools")}static async DumpDataAsync(C,c,d){throw(0,p.c)("DumpTools")}static _IsOffScreenCanvas(C){return void 0!==C.convertToBlob}static ToBlob(C,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",b=arguments.length>3?arguments[3]:void 0;q._IsOffScreenCanvas(C)||C.toBlob||(C.toBlob=function(C,c,d){setTimeout((()=>{const b=atob(this.toDataURL(c,d).split(",")[1]),X=b.length,P=new Uint8Array(X);for(let C=0;C<X;C++)P[C]=b.charCodeAt(C);C(new Blob([P]))}))}),q._IsOffScreenCanvas(C)?C.convertToBlob({type:d,quality:b}).then((C=>c(C))):C.toBlob((function(C){c(C)}),d,b)}static DownloadBlob(C,c){if("download"in document.createElement("a")){if(!c){const C=new Date;c="screenshot_"+((C.getFullYear()+"-"+(C.getMonth()+1)).slice(2)+"-"+C.getDate()+"_"+C.getHours()+"-"+("0"+C.getMinutes()).slice(-2))+".png"}q.Download(C,c)}else if(C&&"undefined"!==typeof URL){const c=URL.createObjectURL(C),d=window.open("");if(!d)return;const b=d.document.createElement("img");b.onload=function(){URL.revokeObjectURL(c)},b.src=c,d.document.body.appendChild(b)}}static EncodeScreenshotCanvasData(C,c){let d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",b=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;if("string"!==typeof b&&c){if(c){if(q._IsOffScreenCanvas(C))return void C.convertToBlob({type:d,quality:X}).then((C=>{const d=new FileReader;d.readAsDataURL(C),d.onloadend=()=>{const C=d.result;c(C)}}));const b=C.toDataURL(d,X);c(b)}}else this.ToBlob(C,(function(C){C&&q.DownloadBlob(C,b),c&&c("")}),d,X)}static Download(C,c){if("undefined"===typeof URL)return;const d=window.URL.createObjectURL(C),b=document.createElement("a");document.body.appendChild(b),b.style.display="none",b.href=d,b.download=c,b.addEventListener("click",(()=>{b.parentElement&&b.parentElement.removeChild(b)})),b.click(),window.URL.revokeObjectURL(d)}static BackCompatCameraNoPreventDefault(C){return"boolean"===typeof C[0]?C[0]:"boolean"===typeof C[1]&&C[1]}static CreateScreenshot(C,c,d,b){throw(0,p.c)("ScreenshotTools")}static async CreateScreenshotAsync(C,c,d){throw(0,p.c)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(C,c,d,b){throw(0,p.c)("ScreenshotTools")}static async CreateScreenshotUsingRenderTargetAsync(C,c,d){throw(0,p.c)("ScreenshotTools")}static RandomId(){return(0,A.c)()}static IsBase64(C){return(0,k.j)(C)}static DecodeBase64(C){return(0,k.b)(C)}static get errorsCount(){return P.d.errorsCount}static Log(C){P.d.Log(C)}static Warn(C){P.d.Warn(C)}static Error(C){P.d.Error(C)}static get LogCache(){return P.d.LogCache}static ClearLogCache(){P.d.ClearLogCache()}static set LogLevels(C){P.d.LogLevels=C}static set PerformanceLogLevel(C){return(C&q.PerformanceUserMarkLogLevel)===q.PerformanceUserMarkLogLevel?(q.StartPerformanceCounter=q._StartUserMark,void(q.EndPerformanceCounter=q._EndUserMark)):(C&q.PerformanceConsoleLogLevel)===q.PerformanceConsoleLogLevel?(q.StartPerformanceCounter=q._StartPerformanceConsole,void(q.EndPerformanceCounter=q._EndPerformanceConsole)):(q.StartPerformanceCounter=q._StartPerformanceCounterDisabled,void(q.EndPerformanceCounter=q._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(C,c){}static _EndPerformanceCounterDisabled(C,c){}static _StartUserMark(C){let c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!q._Performance){if(!(0,X.l)())return;q._Performance=window.performance}c&&q._Performance.mark&&q._Performance.mark(C+"-Begin")}static _EndUserMark(C){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&q._Performance.mark&&(q._Performance.mark(C+"-End"),q._Performance.measure(C,C+"-Begin",C+"-End"))}static _StartPerformanceConsole(C){let c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c&&(q._StartUserMark(C,c),console.time&&console.time(C))}static _EndPerformanceConsole(C){let c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c&&(q._EndUserMark(C,c),console.timeEnd(C))}static get Now(){return R.e.Now}static GetClassName(C){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=null;if(!c&&C.getClassName)d=C.getClassName();else{if(C instanceof Object){d=(c?C:Object.getPrototypeOf(C)).constructor.__bjsclassName__}d||(d=typeof C)}return d}static First(C,c){for(const d of C)if(c(d))return d;return null}static getFullClassName(C){let c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=null,b=null;if(!c&&C.getClassName)d=C.getClassName();else{if(C instanceof Object){const X=c?C:Object.getPrototypeOf(C);d=X.constructor.__bjsclassName__,b=X.constructor.__bjsmoduleName__}d||(d=typeof C)}return d?(null!=b?b+".":"")+d:null}static async DelayAsync(C){await new Promise((c=>{setTimeout((()=>{c()}),C)}))}static IsSafari(){return!!(0,X.i)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function B(C,c){return d=>{d.__bjsclassName__=C,d.__bjsmoduleName__=null!=c?c:null}}q.AssetBaseUrl="",q.UseCustomRequestHeaders=!1,q.CustomRequestHeaders=j.b.CustomRequestHeaders,q.GetDOMTextContent=X.b,q._DefaultCdnUrl="https://cdn.babylonjs.com",q._DefaultAssetsUrl="https://assets.babylonjs.com/core",q.GetAbsoluteUrl="object"===typeof document?C=>{const c=document.createElement("a");return c.href=C,c.href}:"function"===typeof URL&&"object"===typeof location?C=>new URL(C,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},q.NoneLogLevel=P.d.NoneLogLevel,q.MessageLogLevel=P.d.MessageLogLevel,q.WarningLogLevel=P.d.WarningLogLevel,q.ErrorLogLevel=P.d.ErrorLogLevel,q.AllLogLevel=P.d.AllLogLevel,q.IsWindowObjectExist=X.l,q.PerformanceNoneLogLevel=0,q.PerformanceUserMarkLogLevel=1,q.PerformanceConsoleLogLevel=2,q.StartPerformanceCounter=q._StartPerformanceCounterDisabled,q.EndPerformanceCounter=q._EndPerformanceCounterDisabled;class t{constructor(C,c,d){let b=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.iterations=C,this.index=b-1,this._done=!1,this._fn=c,this._successCallback=d}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(C,c,d){const b=new t(C,c,d,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0);return b.executeNext(),b}static SyncAsyncForLoop(C,c,d,b,X){let P=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return t.Run(Math.ceil(C/c),(b=>{X&&X()?b.breakLoop():setTimeout((()=>{for(let P=0;P<c;++P){const V=b.index*c+P;if(V>=C)break;if(d(V),X&&X()){b.breakLoop();break}}b.executeNext()}),P)}),b)}}q.Mix=u.i,q.IsExponentOfTwo=u.h,g.c.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},12345:(C,c,d)=>{d.d(c,{b:()=>P,e:()=>X});const b={};function X(C,c){b[C]=c}function P(C){return b[C]}},12248:(C,c,d)=>{d.d(c,{b:()=>b});class b{constructor(){this._xhr="undefined"!==typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}static get IsCustomRequestAvailable(){return Object.keys(b.CustomRequestHeaders).length>0||b.CustomRequestModifiers.length>0}get requestURL(){return this._requestURL}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const C in b.CustomRequestHeaders){const c=b.CustomRequestHeaders[C];c&&this._xhr.setRequestHeader(C,c)}}_shouldSkipRequestModifications(C){return b.SkipRequestModificationForBabylonCDN&&(C.includes("preview.babylonjs.com")||C.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(C){this._xhr.onprogress=C}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(C){this._xhr.responseType=C}get timeout(){return this._xhr.timeout}set timeout(C){this._xhr.timeout=C}addEventListener(C,c,d){this._xhr.addEventListener(C,c,d)}removeEventListener(C,c,d){this._xhr.removeEventListener(C,c,d)}abort(){this._xhr.abort()}send(C){b.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(C)}open(C,c){for(const d of b.CustomRequestModifiers){if(this._shouldSkipRequestModifications(c))return;c=d(this._xhr,c)||c}c=(c=c.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=c,this._xhr.open(C,c,!0)}setRequestHeader(C,c){this._xhr.setRequestHeader(C,c)}getResponseHeader(C){return this._xhr.getResponseHeader(C)}}b.CustomRequestHeaders={},b.CustomRequestModifiers=new Array,b.SkipRequestModificationForBabylonCDN=!0}}]);